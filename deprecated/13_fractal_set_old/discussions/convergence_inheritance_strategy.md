# Convergence Inheritance: Proving the Fractal Set Generator is Geometrically Ergodic

**Purpose:** This document outlines the mathematical strategy for proving that the **discrete-time Markov chain** that generates the Fractal Set inherits all convergence guarantees from the continuous N-particle Adaptive Gas SDE.

**Status:** Discussion document - proof strategy outline

**Key Insight:** The reconstruction theorem (Theorem `thm-fractal-set-reconstruction` in `00_full_set.md`) proves **informational equivalence** (the Fractal Set contains complete SDE data), but does NOT prove **dynamical equivalence** (convergence inheritance). We need to prove that the **discrete-time numerical integrator** that builds the Fractal Set is geometrically ergodic.

---

## 1. The Mathematical Problem: Distinguishing Data from Dynamics

### 1.1. What We Have Proven (from {prf:ref}`00_reference.md`)

**Theorem ({prf:ref}`thm-fractal-set-reconstruction`):** The Fractal Set $\mathcal{F} = (\mathcal{N}, E_{\text{CST}} \cup E_{\text{IG}})$ contains complete information to reconstruct:
- Full trajectories $(x_i(t_k), v_i(t_k))$ at discrete times $t_k = k \cdot \Delta t$
- All force fields $\mathbf{F}_{\text{stable}}, \mathbf{F}_{\text{adapt}}, \mathbf{F}_{\text{viscous}}$
- Diffusion tensor $\Sigma_{\text{reg}}(x,S,t)$
- Empirical measure $f_k(t)$ and localized statistics

**What this proves:** The Fractal Set is a **static snapshot** or **historical record** - a lossless encoding of the discrete-time simulation data.

**What this does NOT prove:** That the discrete-time process generating this data converges to the same long-term distribution as the continuous SDE.

### 1.2. Foundation: Already-Proven Convergence Results

From `00_reference.md`, we have the following **already established theorems** for the **continuous-time** Adaptive Gas SDE:

1. **{prf:ref}`thm-main-convergence` (Geometric Ergodicity and Convergence to QSD):**
   > "Unique QSD $\nu_{\text{QSD}}$ exists... $\|\mu_t - \nu_{\text{QSD}}\|_{\text{TV}} \leq C_{\text{conv}} e^{-\kappa_{\text{QSD}} t}$"

   This is the **main result** we want to inherit for the discrete system.

2. **{prf:ref}`thm-foster-lyapunov-main` (Foster-Lyapunov for Composed Operator):**
   > "$\mathcal{L}V_{\text{total}}(S) \leq -\kappa_{\text{total}} V_{\text{total}}(S) + C_{\text{total}}$"

   This provides the **geometric drift condition** for the continuous generator $\mathcal{L} = \mathcal{L}_{\text{kin}} + \mathcal{L}_{\text{clone}}$.

3. **{prf:ref}`lem-quantitative-keystone` (N-Uniform Quantitative Keystone Lemma):**
   > "The error-weighted cloning pressure scales linearly with the structural error. Walkers with high positional error experience proportionally high cloning pressure."

   This ensures **cloning targets high-error walkers** and is already incorporated into {prf:ref}`thm-foster-lyapunov-main`.

4. **{prf:ref}`thm-ueph` (k-Uniform Ellipticity):**
   > "The regularized metric... is uniformly elliptic with k-uniform ellipticity constants."

   This guarantees the diffusion tensor $\Sigma_{\text{reg}}$ is **non-degenerate**, crucial for hypocoercive contraction.

**Key insight:** Cloning is **already fully accounted for** in the continuous-time proofs via the Keystone Principle. We don't need to re-prove its effect - only show that discretization preserves the drift structure.

### 1.2. What We Need to Prove

**Goal:** Prove that the **discrete-time Markov chain** $\{X_k\}_{k \geq 0}$ generated by the numerical integrator (which populates the Fractal Set) is geometrically ergodic to a unique stationary distribution $\pi_h$, and that $\pi_h \to \pi$ (the continuous SDE's QSD) as $h \to 0$.

**Why this matters:**
- Convergence is a property of the **evolution operator**, not the data structure
- The Fractal Set records the path history of a stochastic process
- We must prove the **process itself** converges, not just that we can reconstruct its states

---

## 2. The Discrete-Time Markov Chain

### 2.1. Formal Setup

**Continuous SDE:** The Adaptive Gas SDE from `07_adaptative_gas.md`:

$$
\begin{aligned}
dx_i &= v_i \, dt \\
dv_i &= \left[ \mathbf{F}_{\text{stable}}(x_i) + \mathbf{F}_{\text{adapt}}(x_i, S) + \mathbf{F}_{\text{viscous}}(x_i, S) - \gamma v_i \right] dt + \Sigma_{\text{reg}}(x_i, S) \circ dW_i
\end{aligned}

$$

**State space:** $X(t) = (x_1(t), \ldots, x_N(t), v_1(t), \ldots, v_N(t)) \in \mathcal{X}^N \times \mathbb{R}^{Nd}$

**Discrete approximation:** Let $h > 0$ be the timestep. A numerical integrator (e.g., Euler-Maruyama, BAOAB, Störmer-Verlet) defines a **discrete-time Markov chain**:

$$
X_k \approx X(kh), \quad k = 0, 1, 2, \ldots

$$

with transition kernel:

$$
P_h(x, A) := \mathbb{P}(X_{k+1} \in A \mid X_k = x)

$$

### 2.2. Example: Euler-Maruyama Discretization

For the Adaptive Gas SDE, the Euler-Maruyama scheme is:

$$
\begin{aligned}
x_i^{k+1} &= x_i^k + v_i^k h \\
v_i^{k+1} &= v_i^k + \left[\mathbf{F}_{\text{stable}}(x_i^k) + \mathbf{F}_{\text{adapt}}(x_i^k, S^k) + \mathbf{F}_{\text{viscous}}(x_i^k, S^k) - \gamma v_i^k\right] h + \Sigma_{\text{reg}}(x_i^k, S^k) \sqrt{h} \, \xi_i^k
\end{aligned}

$$

where $\xi_i^k \sim \mathcal{N}(0, I)$ are i.i.d. Gaussian increments.

**Key observation:** Each CST edge in the Fractal Set corresponds to one step $X_k \to X_{k+1}$ of this Markov chain.

---

## 3. Precise Mathematical Gap and Proof Strategy

### 3.1. The Gap: Continuous Generator vs. Discrete Transition Kernel

**Continuous SDE (what we've proven):**

Let $Z_t = (X_t, V_t)$ be the full phase-space state of the N-particle swarm. The Adaptive Gas SDE has generator $\mathcal{L} = \mathcal{L}_{\text{kin}} + \mathcal{L}_{\text{clone}}$ (kinetic + cloning).

**Already proven ({prf:ref}`thm-foster-lyapunov-main`):**

$$
\mathcal{L}V_{\text{total}}(Z) \leq -\kappa_{\text{total}} V_{\text{total}}(Z) + C_{\text{total}}

$$

where $V_{\text{total}}$ is the synergistic Lyapunov function from {prf:ref}`def-full-synergistic-lyapunov-function`.

**Discrete algorithm (Fractal Set generator):**

The discrete update for one timestep $\Delta t$ is:

$$
Z_{k+1} = Z_k + \Delta t \, b(Z_k) + \sqrt{\Delta t} \, \sigma(Z_k) \xi_k

$$

where:
- $b(Z) = (\mathbf{v}, \mathbf{F}_{\text{total}}(Z))$ is the drift (velocity + total force)
- $\sigma(Z) = \text{diag}(0, \Sigma_{\text{reg}}(Z))$ is the diffusion (zero for positions, $\Sigma_{\text{reg}}$ for velocities)
- $\xi_k \sim \mathcal{N}(0, I)$ are i.i.d. Gaussian noise

This defines a discrete-time Markov chain with transition kernel:

$$
P_{\Delta t}(z, A) = \mathbb{P}(Z_{k+1} \in A \mid Z_k = z)

$$

**The mathematical gap:** We need to prove that this discrete kernel satisfies a geometric drift condition similar to the continuous one.

### 3.2. Core Proof Strategy: Bounding Discretization Error

The proof has **two key lemmas**:

#### Lemma 1: Discretization Error Bound (NEW - TO BE PROVEN)

**Statement:** Let $V = V_{\text{total}}$ be the synergistic Lyapunov function from {prf:ref}`def-full-synergistic-lyapunov-function`. Assume:
1. $V$ is $C^3$ with bounded third derivatives (follows from its construction)
2. Drift $b$ and diffusion $\sigma$ are Lipschitz (guaranteed by {prf:ref}`ax:lipschitz-fields` and {prf:ref}`prop-lipschitz-diffusion`)

Then for the one-step discrete update $Z_{k+1}$ from $Z_k = z$:

$$
\mathbb{E}[V(Z_{k+1}) \mid Z_k = z] = V(z) + \Delta t \, \mathcal{L}V(z) + E(z, \Delta t)

$$

where the error term satisfies:

$$
|E(z, \Delta t)| \leq \Delta t^2 \cdot (K_1 V(z) + K_2)

$$

for constants $K_1, K_2 > 0$ depending on:
- Lipschitz constants of $b, \sigma$
- Bounds on third derivatives of $V$

**Proof:** (Taylor expansion, detailed below in Section 8)

1. Apply Taylor's theorem to $V(Z_{k+1})$ around $Z_k = z$ up to third order
2. Substitute $\Delta Z = \Delta t \, b(z) + \sqrt{\Delta t} \, \sigma(z) \xi_k$
3. Take expectation: first-order $\sqrt{\Delta t}$ terms vanish, second-order gives $\Delta t \, \mathcal{L}V(z)$
4. Bound remainder using Lipschitz constants and coercivity of $V$

#### Lemma 2: Discrete Foster-Lyapunov Drift (FOLLOWS FROM LEMMA 1 + EXISTING RESULTS)

**Statement:** If {prf:ref}`thm-foster-lyapunov-main` holds ($\mathcal{L}V(z) \leq -\kappa_{\text{total}} V(z) + C_{\text{total}}$) and Lemma 1 holds, then for timestep:

$$
\Delta t < \Delta t_{\max} := \min\left(\tau_{\max}, \frac{1}{K_1}, \frac{\kappa_{\text{total}}}{2K_1}\right)

$$

the discrete chain satisfies:

$$
\mathbb{E}[V(Z_{k+1}) \mid Z_k = z] - V(z) \leq -\frac{\kappa_{\text{total}} \Delta t}{2} V(z) + (C_{\text{total}} + K_2) \Delta t

$$

**Proof:**

Combine Lemma 1 and {prf:ref}`thm-foster-lyapunov-main`:

$$
\begin{aligned}
\mathbb{E}[V(Z_{k+1}) \mid Z_k = z] - V(z) &= \Delta t \, \mathcal{L}V(z) + E(z, \Delta t) \\
&\leq \Delta t(-\kappa_{\text{total}} V(z) + C_{\text{total}}) + \Delta t^2(K_1 V(z) + K_2) \\
&= \Delta t V(z)(-\kappa_{\text{total}} + \Delta t K_1) + \Delta t(C_{\text{total}} + \Delta t K_2)
\end{aligned}

$$

For $\Delta t < \kappa_{\text{total}} / (2K_1)$, we have $-\kappa_{\text{total}} + \Delta t K_1 < -\kappa_{\text{total}}/2$, yielding:

$$
\mathbb{E}[\Delta V] \leq -\frac{\kappa_{\text{total}} \Delta t}{2} V(z) + (C_{\text{total}} + K_2) \Delta t \quad \blacksquare

$$

**This is the discrete drift condition we need!**

---

## 4. Additional Required Lemmas

### 4.1. Discrete Accessibility (Irreducibility)

**Lemma (Discrete Accessibility - TO BE PROVEN):** The discrete-time Markov chain $\{X_k\}_{k \geq 0}$ is $\psi$-irreducible and aperiodic.

**Proof sketch:**
- The diffusion tensor $\Sigma_{\text{reg}}(x,S)$ is uniformly elliptic (from `07_adaptative_gas.md`, Theorem 4.1)
- At each timestep, the Gaussian noise $\sqrt{h} \, \Sigma_{\text{reg}} \xi_k$ ensures positive transition probability density
- The chain can reach any open set in the state space from any starting point
- Aperiodicity follows from the continuous noise injection ∎

### 4.2. Small Set Condition

**Lemma (Small Set Existence - TO BE PROVEN):** There exists a compact set $C \subset \mathcal{X}^N \times \mathbb{R}^{Nd}$ such that:

$$
\sup_{x \in C} V(x) < \infty

$$

and the drift condition holds for all $x \notin C$.

**Proof sketch:**
- From the Lyapunov structure in `07_adaptative_gas.md`, $V$ grows at most polynomially
- Choose $C = \{x : V(x) \leq R\}$ for large enough $R$
- Verify drift condition on $C^c$ using the bounds from the continuous case ∎

---

## 5. Main Convergence Inheritance Theorem

### 5.1. Geometric Ergodicity of the Fractal Set Generator

**Theorem (Discrete Geometric Ergodicity - FOLLOWS FROM PREVIOUS LEMMAS):**

Let $\{Z_k\}_{k \geq 0}$ be the discrete-time Markov chain that generates the Fractal Set $\mathcal{F}$, defined by the Euler-Maruyama discretization with timestep $\Delta t < \Delta t_{\max}$. Then:

1. **Unique stationary distribution:** There exists a unique stationary distribution $\pi_{\Delta t}$ on $\mathcal{X}^N \times \mathbb{R}^{Nd}$

2. **Geometric convergence:** For any initial distribution $\mu_0$, the distribution $\mu_k$ of $Z_k$ satisfies:

   $$
   \|\mu_k - \pi_{\Delta t}\|_{\text{TV}} \leq M \rho^k
   $$

   where $\rho = \exp(-\kappa_{\text{total}} \Delta t / 2) < 1$ and $M$ depends on the initial condition.

**Proof:** Apply **Meyn & Tweedie (2009), Theorem 15.0.1** using:
- **Discrete drift condition:** Lemma 2 (Section 3.2) provides geometric drift
- **Irreducibility:** Lemma 4.1 (uniform ellipticity of $\Sigma_{\text{reg}}$ from {prf:ref}`thm-ueph`)
- **Small set condition:** Lemma 4.2 (coercivity of $V_{\text{total}}$ from {prf:ref}`def-full-synergistic-lyapunov-function`)

These conditions together imply geometric ergodicity ∎

### 5.2. Consistency: Convergence of Invariant Measures

**Theorem (Weak Convergence as $h \to 0$ - TO BE PROVEN):** As the timestep $h \to 0$, the stationary distribution $\pi_h$ of the discrete chain converges weakly to the quasi-stationary distribution $\pi$ of the continuous SDE:

$$
\pi_h \xrightarrow{w} \pi \quad \text{as } h \to 0

$$

**Proof sketch (requires advanced SDE approximation theory):**
1. Use weak approximation results for SDEs (e.g., Talay-Tubaro, Milstein)
2. Show that for smooth test functions $f$:
   $$
   \left| \int f \, d\pi_h - \int f \, d\pi \right| \leq C h^p
   $$
   for some $p > 0$ (order of convergence depends on integrator)
3. Apply Portmanteau theorem to extend to weak convergence ∎

**Technical challenge:** This is the most difficult part, requiring:
- High regularity of SDE coefficients
- Bounds on moments of $\pi_h$ uniform in $h$
- Potentially specialized techniques for degenerate systems

---

## 6. Fractal Set Specifics: Spinors, Antisymmetry, and Representation

### 6.1. Does the Data Representation Affect Convergence?

**Question:** Does storing data as scalars (nodes) vs. spinors (edges) affect convergence?

**Answer:** **No.** The convergence proof concerns the **state vector** $Z_t = (X_t, V_t)$ of the swarm. The choice to represent:
- Positions/velocities as spinors $\psi_x, \psi_v$
- Forces as spinor decompositions $\psi_{\mathbf{F}_{\text{stable}}}, \psi_{\mathbf{F}_{\text{adapt}}}, \ldots$

is an **implementation detail for data storage**. It does not change the mathematical dynamics of the state evolution.

**Why spinors then?** Spinor representation is critical for:
- Gauge theory formulation ({prf:ref}`12_gauge_theory_adaptive_gas.md`)
- Emergent geometry ({prf:ref}`08_emergent_geometry.md`)
- QFT interpretation ({prf:ref}`13_D_fractal_set_emergent_qft_comprehensive.md`)

But for proving convergence, we only care about the **numerical values** of $(x_i, v_i)$, not their representation.

### 6.2. The Antisymmetric Fitness Potential

**Question:** Does the directed IG graph with antisymmetric $V_{\text{clone}}(i \to j) = \Phi_j - \Phi_i$ matter?

**Answer:** The "antisymmetry" $V_{\text{clone}}(j \to i) = -V_{\text{clone}}(i \to j)$ is simply the **standard fitness difference** that drives cloning in {prf:ref}`lem-quantitative-keystone`.

**Interpretation:**
- Edge $(i \to j)$: Potential for walker $i$ to clone from walker $j$
- Value: $\Phi_j - \Phi_i$ (positive if $j$ is fitter, negative otherwise)
- Antisymmetry: The reverse potential $j \to i$ has opposite sign

This is **already handled** by the Keystone Principle - no additional proof needed. The directed graph structure is how we **represent** the pairwise cloning dynamics, but the underlying mechanism is the same as in the continuous proofs.

**Fermionic interpretation:** The antisymmetry becomes significant in the **emergent QFT limit** where it enables antisymmetric Green's functions (fermions). But for convergence, it's just fitness-driven selection.

### 6.3. Cloning Mechanism in the Proof

**Question:** How is cloning accounted for?

**Answer:** Cloning is **fully integrated** into the continuous-time proofs via:

1. **{prf:ref}`lem-quantitative-keystone`:** Proves cloning targets high-error walkers and contracts positional variance
2. **{prf:ref}`thm-foster-lyapunov-main`:** Incorporates cloning effects into the Lyapunov drift via $\mathcal{L}_{\text{clone}}$

**Our task:** Show that discretization of the **combined** SDE (kinetic + cloning) preserves this drift structure. The key is that cloning forces (viscous coupling, adaptive force) are already in the drift vector $b(Z)$, so the Taylor expansion in Lemma 1 (Section 3.2) automatically accounts for them.

**No separate cloning analysis needed** - it's baked into the force fields!

### 6.4. Summary: Convergence Inheritance for the Fractal Set

**Theorem (Complete Convergence Inheritance):**

The Fractal Set $\mathcal{F}$ is the path history of a geometrically ergodic discrete-time Markov chain. Specifically:

1. **Discrete ergodicity:** $\{Z_k\}$ converges to unique $\pi_{\Delta t}$ with rate $\rho = \exp(-\kappa_{\text{total}} \Delta t / 2)$

2. **Approximation accuracy:** $\pi_{\Delta t} \to \pi$ (continuous QSD) as $\Delta t \to 0$ (Theorem 5.2)

3. **Long-time behavior:** For large $k$:
   $$
   \|\mu_k - \pi\|_{\text{TV}} \leq M \rho^k + \mathcal{O}(\Delta t)
   $$
   where:
   - $M \rho^k$: **Convergence error** (exponentially decaying)
   - $\mathcal{O}(\Delta t)$: **Discretization error** (constant for fixed $\Delta t$)

4. **Practical implication:** The Fractal Set empirical distribution converges to the continuous SDE's QSD, up to discretization error controlled by timestep size.

**Corollary:** All convergence guarantees from the continuous Adaptive Gas SDE:
- Geometric ergodicity ({prf:ref}`thm-main-convergence`)
- Foster-Lyapunov stability ({prf:ref}`thm-foster-lyapunov-main`)
- Keystone targeting ({prf:ref}`lem-quantitative-keystone`)
- Uniform ellipticity ({prf:ref}`thm-ueph`)

are **inherited** by the discrete Fractal Set generator, with convergence rate $\rho \approx 1 - \kappa_{\text{total}} \Delta t$ for small $\Delta t$.

---

## 7. Key Technical Challenges and Open Questions

### 7.1. Smoothness Requirements

**Issue:** The Taylor expansion in the drift proof requires:
- Lyapunov function $V$ to be $C^2$ (at minimum)
- Force fields $\mathbf{F}_{\text{stable}}, \mathbf{F}_{\text{adapt}}, \mathbf{F}_{\text{viscous}}$ to be $C^1$ or $C^2$
- Diffusion tensor $\Sigma_{\text{reg}}$ to be $C^1$

**Status in Adaptive Gas:**
- Appendix A of `07_adaptative_gas.md` proves $V_{\text{fit}}$ is uniformly $C^2$ ✓
- $U(x)$ is assumed $C^2$ (confining potential) ✓
- $\Sigma_{\text{reg}} = (H + \epsilon_\Sigma I)^{-1/2}$ requires careful analysis of matrix square root smoothness

**Action needed:** Verify explicit smoothness of $\Sigma_{\text{reg}}$ using matrix calculus.

### 7.2. Timestep Constraint

**Issue:** The proof only holds for $h < h_{\max}$ where $\rho = 1 - c_1 h + O(h^2) < 1$.

**Question:** Can we quantify $h_{\max}$ explicitly in terms of system parameters $(\gamma, \epsilon_F, \nu, \epsilon_\Sigma, \ldots)$?

**Approach:** Bound the $O(h^2)$ term using:
- Hessian bounds from Appendix A
- Force field Lipschitz constants
- Lyapunov function curvature

### 7.3. Choice of Numerical Integrator

**Current assumption:** Analysis assumes Euler-Maruyama (order 0.5 weak convergence).

**Alternative integrators:**
- **BAOAB** (used in `04_convergence.md`): Splitting scheme with better energy conservation
- **Störmer-Verlet**: Symplectic integrator for Hamiltonian systems
- **Higher-order schemes**: Milstein, Runge-Kutta-type

**Question:** Does BAOAB preserve the Lyapunov structure more faithfully than Euler-Maruyama?

**Conjecture:** BAOAB's symplectic structure may allow a weaker drift condition or larger $h_{\max}$.

### 7.4. Cloning Events

**Critical issue:** The analysis above assumes continuous evolution. But the Adaptive Gas includes **cloning** - a discrete, discontinuous operation.

**Modified framework needed:**
- The Markov chain must account for both:
  1. Continuous SDE evolution between cloning events
  2. Discrete cloning jumps (with inelastic collisions)

**Approach:**
- Model as a **piecewise deterministic Markov process** (PDMP)
- Use hybrid system theory (e.g., Davis 1993)
- Prove that cloning events are "rare enough" not to destroy ergodicity
- Leverage the Keystone Principle (proven in `03_cloning.md`) to show cloning improves convergence

**Status:** This is a MAJOR gap. The current discrete drift proof does not account for cloning.

---

## 8. Detailed Proof of Lemma 1 (Discretization Error Bound)

This section provides the complete technical proof of the key lemma that bridges continuous and discrete dynamics.

**Lemma 1 (Discretization Error Bound - DETAILED PROOF):**

Let $V = V_{\text{total}}$ be the synergistic Lyapunov function. Assume $V \in C^3$ with bounded third derivatives, and $b, \sigma$ are Lipschitz. Then:

$$
\mathbb{E}[V(Z_{k+1}) \mid Z_k = z] = V(z) + \Delta t \, \mathcal{L}V(z) + E(z, \Delta t)

$$

where $|E(z, \Delta t)| \leq \Delta t^2 (K_1 V(z) + K_2)$.

**Proof:**

**Step 1: Taylor expansion to third order**

Let $Z_{k+1} = Z_k + \Delta Z$ where $\Delta Z = \Delta t \, b(Z_k) + \sqrt{\Delta t} \, \sigma(Z_k) \xi_k$.

By Taylor's theorem around $Z_k = z$:

$$
V(Z_{k+1}) = V(z) + \nabla V(z)^T \Delta Z + \frac{1}{2} \Delta Z^T (\nabla^2 V)(z) \Delta Z + R_3

$$

where $R_3$ is the third-order remainder:

$$
R_3 = \frac{1}{6} \sum_{i,j,k} \frac{\partial^3 V}{\partial z_i \partial z_j \partial z_k}(\tilde{z}) \, \Delta z_i \Delta z_j \Delta z_k

$$

for some $\tilde{z}$ on the line segment between $z$ and $Z_{k+1}$.

**Step 2: Substitute discretization**

Write $\Delta Z = \Delta t \, b + \sqrt{\Delta t} \, \sigma \xi$ (suppressing dependence on $z$ for clarity).

**First-order term:**

$$
\nabla V^T \Delta Z = \Delta t \, \nabla V^T b + \sqrt{\Delta t} \, \nabla V^T \sigma \xi

$$

**Second-order term:**

$$
\begin{aligned}
\Delta Z^T (\nabla^2 V) \Delta Z &= (\Delta t \, b + \sqrt{\Delta t} \, \sigma \xi)^T (\nabla^2 V) (\Delta t \, b + \sqrt{\Delta t} \, \sigma \xi) \\
&= \Delta t^2 \, b^T (\nabla^2 V) b + \Delta t \, (\sigma \xi)^T (\nabla^2 V) b \\
&\quad + \Delta t \, b^T (\nabla^2 V) (\sigma \xi) + \Delta t \, (\sigma \xi)^T (\nabla^2 V) (\sigma \xi)
\end{aligned}

$$

**Step 3: Take expectation**

$$
\mathbb{E}[V(Z_{k+1}) \mid Z_k = z] = V(z) + \mathbb{E}[\text{1st order}] + \mathbb{E}[\text{2nd order}] + \mathbb{E}[R_3]

$$

**First-order expectation:**

$$
\mathbb{E}[\nabla V^T \Delta Z] = \Delta t \, \nabla V^T b + \sqrt{\Delta t} \, \nabla V^T \sigma \mathbb{E}[\xi] = \Delta t \, \nabla V^T b

$$

(since $\mathbb{E}[\xi] = 0$)

**Second-order expectation:**

$$
\begin{aligned}
\mathbb{E}[\Delta Z^T (\nabla^2 V) \Delta Z] &= \Delta t^2 \, b^T (\nabla^2 V) b + \Delta t \, \mathbb{E}[(\sigma \xi)^T (\nabla^2 V) (\sigma \xi)] \\
&= \Delta t^2 \, b^T (\nabla^2 V) b + \Delta t \, \text{Tr}(\sigma^T (\nabla^2 V) \sigma)
\end{aligned}

$$

(using $\mathbb{E}[\xi \xi^T] = I$ and cyclic property of trace)

**Step 4: Recognize the generator**

The SDE generator $\mathcal{L}$ for $dZ = b \, dt + \sigma \, dW$ is:

$$
\mathcal{L}V(z) = \nabla V(z)^T b(z) + \frac{1}{2} \text{Tr}(\sigma(z)^T (\nabla^2 V)(z) \sigma(z))

$$

Therefore:

$$
\mathbb{E}[V(Z_{k+1})] = V(z) + \Delta t \, \mathcal{L}V(z) + \frac{\Delta t^2}{2} b^T (\nabla^2 V) b + \mathbb{E}[R_3]

$$

**Step 5: Bound the error terms**

Define $E(z, \Delta t) := \frac{\Delta t^2}{2} b^T (\nabla^2 V) b + \mathbb{E}[R_3]$.

**Bound on $b^T (\nabla^2 V) b$:** Since $b$ is Lipschitz with constant $L_b$, $\|b(z)\| \leq L_b(1 + \|z\|)$. The Hessian $\nabla^2 V$ is bounded by a polynomial in $V$ (from coercivity): $\|\nabla^2 V(z)\| \leq C_V (1 + V(z))$. Thus:

$$
|b^T (\nabla^2 V) b| \leq \|b\|^2 \|\nabla^2 V\| \leq L_b^2 (1 + \|z\|)^2 \cdot C_V(1 + V(z)) \leq K_1' V(z) + K_2'

$$

**Bound on $R_3$:** Using $\|\Delta Z\| \leq \Delta t \|b\| + \sqrt{\Delta t} \|\sigma\| \|\xi\|$ and third derivative bounds:

$$
\mathbb{E}[|R_3|] \leq \frac{C_3}{6} \mathbb{E}[\|\Delta Z\|^3] \leq \frac{C_3}{6} (\Delta t^{3/2} + \Delta t^{3/2}) \leq C_3 \Delta t^{3/2}

$$

**Combine:** For small $\Delta t$ such that $C_3 \Delta t^{1/2} \leq K_1''$:

$$
|E(z, \Delta t)| \leq \Delta t^2 (K_1' V(z) + K_2') + \Delta t^2 K_1'' \leq \Delta t^2 (K_1 V(z) + K_2) \quad \blacksquare

$$

---

## 9. Proof Roadmap

### Phase 1: Smoothness Verification (Prerequisite)
1. Prove $\Sigma_{\text{reg}}(x,S)$ is uniformly $C^1$ (matrix analysis)
2. Verify all force fields satisfy required regularity
3. Establish explicit bounds on derivatives

### Phase 2: Discrete Drift (Core Technical Result)
1. State Discrete Foster-Lyapunov Lemma precisely
2. Perform Taylor expansion with explicit error bounds
3. Determine $h_{\max}$ in terms of system parameters
4. Handle edge cases (e.g., near boundary, low variance)

### Phase 3: Ergodicity (Standard Theory Application)
1. Prove irreducibility and aperiodicity
2. Construct small set and verify minorization
3. Apply Meyn-Tweedie theorem to conclude geometric ergodicity

### Phase 4: Consistency (Advanced Approximation Theory)
1. Review literature on weak approximation of degenerate SDEs
2. Establish moment bounds uniform in $h$
3. Prove $\pi_h \to \pi$ using Portmanteau theorem

### Phase 5: Cloning Integration (Novel Contribution)
1. Extend framework to piecewise deterministic Markov processes
2. Analyze cloning as a jump process
3. Prove combined SDE+cloning system is geometrically ergodic
4. Show discrete version inherits this property

---

## 9. Expected Outcomes

### 9.1. If Successful

**Theorem (Complete Convergence Inheritance):** The Fractal Set representation inherits all convergence guarantees from the Adaptive Gas SDE:

1. **Geometric ergodicity** to a unique stationary distribution
2. **Exponential convergence rate** $\lambda_{\text{discrete}} = -\log \rho \approx \lambda_{\text{continuous}}$ for small $h$
3. **Foster-Lyapunov stability** with explicit drift coefficients
4. **Uniform ellipticity** preserved by discretization

**Practical implication:** Any long-time behavior proven for the SDE (e.g., concentration around fitness peaks, velocity thermalization) automatically holds for the discrete algorithm up to $O(h^p)$ discretization error.

### 9.2. If Difficulties Arise

**Potential failure mode:** Cloning may introduce pathological behavior not captured by standard PDMP theory.

**Fallback strategy:**
- Prove convergence for the "backbone" system (SDE without cloning) first
- Show cloning is a "controlled perturbation" using Keystone Principle
- Establish convergence for full system using perturbation bounds

---

## 10. References

### Standard References
1. **Meyn & Tweedie (2009).** *Markov Chains and Stochastic Stability* (2nd ed.). Cambridge University Press.
   - Theorem 15.0.1: Geometric ergodicity via drift conditions

2. **Talay & Tubaro (1990).** "Expansion of the global error for numerical schemes solving stochastic differential equations." *Stochastic Analysis and Applications*, 8(4), 483-509.
   - Weak approximation theory for SDEs

3. **Milstein (1995).** *Numerical Integration of Stochastic Differential Equations*. Springer.
   - Higher-order schemes and error analysis

4. **Davis (1993).** *Markov Models and Optimization*. Chapman & Hall.
   - Piecewise deterministic Markov processes

### Fragile Framework References
- `01_fragile_gas_framework.md`: Axioms and definitions
- `03_cloning.md`: Keystone Principle (cloning convergence)
- `04_convergence.md`: Continuous QSD convergence proof
- `07_adaptative_gas.md`: Adaptive Gas SDE and Foster-Lyapunov drift
- `13_fractal_set/00_full_set.md`: Fractal Set definition and reconstruction theorem

---

## 11. Conclusion

Proving convergence inheritance requires a **multi-layered argument**:

1. **Information layer** (DONE): Reconstruction theorem proves data completeness
2. **Dynamics layer** (TO DO): Discrete drift lemma proves process convergence
3. **Consistency layer** (TO DO): Weak convergence $\pi_h \to \pi$ as $h \to 0$
4. **Hybrid layer** (OPEN): Integration of cloning jumps into discrete theory

The critical insight is that the Fractal Set is not merely a static data structure, but the **path history of a convergent stochastic process**. The proof strategy outlined here provides a rigorous framework for establishing this convergence mathematically.

**Next steps:**
1. Verify smoothness of $\Sigma_{\text{reg}}$ (prerequisite)
2. Prove Discrete Foster-Lyapunov Lemma (core result)
3. Develop PDMP framework for cloning (novel contribution)
