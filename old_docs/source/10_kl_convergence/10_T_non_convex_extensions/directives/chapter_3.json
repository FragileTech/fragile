{
  "chapter_index": 3,
  "section_id": "## Part 3: Dobrushin Contraction for the Full Dynamics",
  "directive_count": 7,
  "hints": [
    {
      "directive_type": "definition",
      "label": "def-status-metric",
      "title": "Discrete Status-Change Metric",
      "start_line": 833,
      "end_line": 849,
      "header_lines": [
        834
      ],
      "content_start": 836,
      "content_end": 848,
      "content": "836: :label: def-status-metric\n837: \n838: For two swarm states $\\mathcal{S}_1, \\mathcal{S}_2$ with the same number of walkers $N$, define:\n839: \n840: $$\n841: d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) := n_c(\\mathcal{S}_1, \\mathcal{S}_2)\n842: $$\n843: \n844: where $n_c$ is the **number of status changes**: the number of walker indices $i$ where walker $i$ has different alive/dead status in the two swarms.\n845: \n846: Equivalently, if $\\mathbf{s}_1, \\mathbf{s}_2 \\in \\{\\text{alive}, \\text{dead}\\}^N$ are the status vectors:\n847: \n848: $$",
      "metadata": {
        "label": "def-status-metric"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "references": [],
      "raw_directive": "833: ### 3.2. The Discrete Status-Change Metric\n834: \n835: :::{prf:definition} Discrete Status-Change Metric\n836: :label: def-status-metric\n837: \n838: For two swarm states $\\mathcal{S}_1, \\mathcal{S}_2$ with the same number of walkers $N$, define:\n839: \n840: $$\n841: d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) := n_c(\\mathcal{S}_1, \\mathcal{S}_2)\n842: $$\n843: \n844: where $n_c$ is the **number of status changes**: the number of walker indices $i$ where walker $i$ has different alive/dead status in the two swarms.\n845: \n846: Equivalently, if $\\mathbf{s}_1, \\mathbf{s}_2 \\in \\{\\text{alive}, \\text{dead}\\}^N$ are the status vectors:\n847: \n848: $$\n849: d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) = \\|\\mathbf{s}_1 - \\mathbf{s}_2\\|_0 = \\sum_{i=1}^N \\mathbb{1}[\\mathbf{s}_{1,i} \\neq \\mathbf{s}_{2,i}]"
    },
    {
      "directive_type": "lemma",
      "label": "lem-softmax-lipschitz-status",
      "title": "Lipschitz Continuity of Softmax-Weighted Companion Selection",
      "start_line": 870,
      "end_line": 882,
      "header_lines": [
        871
      ],
      "content_start": 873,
      "content_end": 881,
      "content": "873: :label: lem-softmax-lipschitz-status\n874: \n875: Let $\\mathcal{S}_1, \\mathcal{S}_2$ be two swarms with $d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) = n_c$ status changes. For a walker $i$ alive in both swarms, let $\\text{Comp}_i^{(1)}, \\text{Comp}_i^{(2)}$ be the probability distributions over companions selected by the Sequential Stochastic Greedy Pairing algorithm in each swarm.\n876: \n877: For any bounded function $f: \\mathcal{X} \\times \\mathcal{V} \\to \\mathbb{R}$ with $|f| \\leq M_f$, the expected value under the softmax-weighted companion selection satisfies:\n878: \n879: $$\n880: |\\mathbb{E}_{j \\sim \\text{Comp}_i^{(1)}}[f(x_j, v_j)] - \\mathbb{E}_{j \\sim \\text{Comp}_i^{(2)}}[f(x_j, v_j)]| \\leq C_{\\text{softmax}} \\cdot \\frac{M_f \\cdot n_c}{k}\n881: $$",
      "metadata": {
        "label": "lem-softmax-lipschitz-status"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "references": [],
      "raw_directive": "870: The framework's Theorem {prf:ref}`thm-total-error-status-bound` in [01_fragile_gas_framework.md](../01_fragile_gas_framework.md) proves Lipschitz continuity for **uniform random companion selection**. However, the greedy pairing uses **softmax-weighted selection** based on algorithmic distance, so we must extend the proof to this case.\n871: \n872: :::{prf:lemma} Lipschitz Continuity of Softmax-Weighted Companion Selection\n873: :label: lem-softmax-lipschitz-status\n874: \n875: Let $\\mathcal{S}_1, \\mathcal{S}_2$ be two swarms with $d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) = n_c$ status changes. For a walker $i$ alive in both swarms, let $\\text{Comp}_i^{(1)}, \\text{Comp}_i^{(2)}$ be the probability distributions over companions selected by the Sequential Stochastic Greedy Pairing algorithm in each swarm.\n876: \n877: For any bounded function $f: \\mathcal{X} \\times \\mathcal{V} \\to \\mathbb{R}$ with $|f| \\leq M_f$, the expected value under the softmax-weighted companion selection satisfies:\n878: \n879: $$\n880: |\\mathbb{E}_{j \\sim \\text{Comp}_i^{(1)}}[f(x_j, v_j)] - \\mathbb{E}_{j \\sim \\text{Comp}_i^{(2)}}[f(x_j, v_j)]| \\leq C_{\\text{softmax}} \\cdot \\frac{M_f \\cdot n_c}{k}\n881: $$\n882: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-74",
      "title": null,
      "start_line": 884,
      "end_line": 992,
      "header_lines": [],
      "content_start": 886,
      "content_end": 991,
      "content": "886: :::{prf:proof}\n887: \n888: **Strategy**: We directly bound the difference between softmax expectations by decomposing based on common vs. differing companions.\n889: \n890: **Step 1: Setup and notation**\n891: \n892: For walker $i$ in swarm $\\mathcal{S}_s$ (where $s \\in \\{1,2\\}$), let:\n893: - $U_s$ = set of available companions at the time $i$ is processed\n894: - $w_{ij} = \\exp(-d_{\\text{alg}}(i, j)^2 / 2\\epsilon_d^2)$ = weight for companion $j$ (note: this is the **same** for any $j$ present in both swarms)\n895: - $Z_s = \\sum_{l \\in U_s} w_{il}$ = normalization constant\n896: - $P_s(j) = w_{ij} / Z_s$ = probability of selecting companion $j$\n897: \n898: The expected values are:\n899: \n900: $$\n901: \\mathbb{E}^{(s)}[f] = \\sum_{j \\in U_s} P_s(j) f(j) = \\sum_{j \\in U_s} \\frac{w_{ij}}{Z_s} f(j)\n902: $$\n903: \n904: **Step 2: Decompose by common and differing companions**\n905: \n906: Let $U_c = U_1 \\cap U_2$ be the set of common companions, and $U_1 \\setminus U_c$, $U_2 \\setminus U_c$ be the companions present in only one swarm.\n907: \n908: $$\n909: \\begin{align}\n910: \\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f] &= \\sum_{j \\in U_c} (P_1(j) - P_2(j)) f(j) \\\\\n911: &\\quad + \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) - \\sum_{j \\in U_2 \\setminus U_c} P_2(j) f(j)\n912: \\end{align}\n913: $$\n914: \n915: **Step 3: Bound the common companion term**\n916: \n917: For $j \\in U_c$, the difference in probabilities arises from different normalization constants:\n918: \n919: $$\n920: |P_1(j) - P_2(j)| = w_{ij} \\left| \\frac{1}{Z_1} - \\frac{1}{Z_2} \\right| = w_{ij} \\frac{|Z_2 - Z_1|}{Z_1 Z_2}\n921: $$\n922: \n923: **Bound on $|Z_2 - Z_1|$**: The difference in normalization is driven by the companions that differ:\n924: \n925: $$\n926: |Z_2 - Z_1| = \\left| \\sum_{l \\in U_2 \\setminus U_c} w_{il} - \\sum_{l \\in U_1 \\setminus U_c} w_{il} \\right| \\leq \\sum_{l \\in U_1 \\triangle U_2} w_{il}\n927: $$\n928: \n929: Since there are at most $n_c$ status changes, $|U_1 \\triangle U_2| \\leq n_c$. Using $w_{il} \\leq w_{\\max} = 1$:\n930: \n931: $$\n932: |Z_2 - Z_1| \\leq n_c \\cdot w_{\\max} = n_c\n933: $$\n934: \n935: **Bound on normalization denominators**: The normalization constants are bounded below by the sum over common companions:\n936: \n937: $$\n938: Z_s \\geq \\sum_{l \\in U_c} w_{il} \\geq |U_c| \\cdot w_{\\min}\n939: $$\n940: \n941: where $w_{\\min} = \\exp(-D_{\\max}^2 / 2\\epsilon_d^2)$ is the minimum possible weight. Since $|U_c| \\geq k - n_c$ (at least $k$ alive walkers, at most $n_c$ differ):\n942: \n943: $$\n944: Z_s \\geq (k - n_c) \\cdot w_{\\min}\n945: $$\n946: \n947: **Combining**: For each $j \\in U_c$:\n948: \n949: $$\n950: |P_1(j) - P_2(j)| \\leq \\frac{w_{\\max} \\cdot n_c}{(k - n_c)^2 \\cdot w_{\\min}^2} \\leq \\frac{n_c}{(k - n_c)^2 \\cdot w_{\\min}^2}\n951: $$\n952: \n953: For $n_c \\ll k$, this is $O(n_c / k^2)$. Summing over the $\\approx k$ common companions:\n954: \n955: $$\n956: \\left| \\sum_{j \\in U_c} (P_1(j) - P_2(j)) f(j) \\right| \\leq M_f \\cdot k \\cdot \\frac{n_c}{k^2 \\cdot w_{\\min}^2} = \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}^2}\n957: $$\n958: \n959: **Step 4: Bound the differing companion terms**\n960: \n961: The sets $U_1 \\setminus U_c$ and $U_2 \\setminus U_c$ each contain at most $n_c$ walkers (those whose status differs). For each term:\n962: \n963: $$\n964: \\left| \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) \\right| \\leq M_f \\cdot \\sum_{j \\in U_1 \\setminus U_c} P_1(j)\n965: $$\n966: \n967: Since $P_1(j) = w_{ij} / Z_1 \\leq w_{\\max} / (k \\cdot w_{\\min}) = 1 / (k \\cdot w_{\\min})$ and there are at most $n_c$ such terms:\n968: \n969: $$\n970: \\left| \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) \\right| \\leq M_f \\cdot n_c \\cdot \\frac{1}{k \\cdot w_{\\min}} = \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}}\n971: $$\n972: \n973: Similarly for the $U_2 \\setminus U_c$ term.\n974: \n975: **Step 5: Combine all bounds**\n976: \n977: $$\n978: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}^2} + \\frac{2 M_f \\cdot n_c}{k \\cdot w_{\\min}}\n979: $$\n980: \n981: Factoring:\n982: \n983: $$\n984: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq \\frac{M_f \\cdot n_c}{k} \\cdot \\left( \\frac{1}{w_{\\min}^2} + \\frac{2}{w_{\\min}} \\right)\n985: $$\n986: \n987: Since $w_{\\min} = \\exp(-D_{\\max}^2 / 2\\epsilon_d^2) = O(1)$ is a fixed constant (depends only on state space diameter and interaction range), we can write:\n988: \n989: $$\n990: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq C_{\\text{softmax}} \\cdot \\frac{M_f \\cdot n_c}{k}\n991: $$",
      "metadata": {},
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "references": [],
      "raw_directive": "884: :::\n885: \n886: :::{prf:proof}\n887: \n888: **Strategy**: We directly bound the difference between softmax expectations by decomposing based on common vs. differing companions.\n889: \n890: **Step 1: Setup and notation**\n891: \n892: For walker $i$ in swarm $\\mathcal{S}_s$ (where $s \\in \\{1,2\\}$), let:\n893: - $U_s$ = set of available companions at the time $i$ is processed\n894: - $w_{ij} = \\exp(-d_{\\text{alg}}(i, j)^2 / 2\\epsilon_d^2)$ = weight for companion $j$ (note: this is the **same** for any $j$ present in both swarms)\n895: - $Z_s = \\sum_{l \\in U_s} w_{il}$ = normalization constant\n896: - $P_s(j) = w_{ij} / Z_s$ = probability of selecting companion $j$\n897: \n898: The expected values are:\n899: \n900: $$\n901: \\mathbb{E}^{(s)}[f] = \\sum_{j \\in U_s} P_s(j) f(j) = \\sum_{j \\in U_s} \\frac{w_{ij}}{Z_s} f(j)\n902: $$\n903: \n904: **Step 2: Decompose by common and differing companions**\n905: \n906: Let $U_c = U_1 \\cap U_2$ be the set of common companions, and $U_1 \\setminus U_c$, $U_2 \\setminus U_c$ be the companions present in only one swarm.\n907: \n908: $$\n909: \\begin{align}\n910: \\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f] &= \\sum_{j \\in U_c} (P_1(j) - P_2(j)) f(j) \\\\\n911: &\\quad + \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) - \\sum_{j \\in U_2 \\setminus U_c} P_2(j) f(j)\n912: \\end{align}\n913: $$\n914: \n915: **Step 3: Bound the common companion term**\n916: \n917: For $j \\in U_c$, the difference in probabilities arises from different normalization constants:\n918: \n919: $$\n920: |P_1(j) - P_2(j)| = w_{ij} \\left| \\frac{1}{Z_1} - \\frac{1}{Z_2} \\right| = w_{ij} \\frac{|Z_2 - Z_1|}{Z_1 Z_2}\n921: $$\n922: \n923: **Bound on $|Z_2 - Z_1|$**: The difference in normalization is driven by the companions that differ:\n924: \n925: $$\n926: |Z_2 - Z_1| = \\left| \\sum_{l \\in U_2 \\setminus U_c} w_{il} - \\sum_{l \\in U_1 \\setminus U_c} w_{il} \\right| \\leq \\sum_{l \\in U_1 \\triangle U_2} w_{il}\n927: $$\n928: \n929: Since there are at most $n_c$ status changes, $|U_1 \\triangle U_2| \\leq n_c$. Using $w_{il} \\leq w_{\\max} = 1$:\n930: \n931: $$\n932: |Z_2 - Z_1| \\leq n_c \\cdot w_{\\max} = n_c\n933: $$\n934: \n935: **Bound on normalization denominators**: The normalization constants are bounded below by the sum over common companions:\n936: \n937: $$\n938: Z_s \\geq \\sum_{l \\in U_c} w_{il} \\geq |U_c| \\cdot w_{\\min}\n939: $$\n940: \n941: where $w_{\\min} = \\exp(-D_{\\max}^2 / 2\\epsilon_d^2)$ is the minimum possible weight. Since $|U_c| \\geq k - n_c$ (at least $k$ alive walkers, at most $n_c$ differ):\n942: \n943: $$\n944: Z_s \\geq (k - n_c) \\cdot w_{\\min}\n945: $$\n946: \n947: **Combining**: For each $j \\in U_c$:\n948: \n949: $$\n950: |P_1(j) - P_2(j)| \\leq \\frac{w_{\\max} \\cdot n_c}{(k - n_c)^2 \\cdot w_{\\min}^2} \\leq \\frac{n_c}{(k - n_c)^2 \\cdot w_{\\min}^2}\n951: $$\n952: \n953: For $n_c \\ll k$, this is $O(n_c / k^2)$. Summing over the $\\approx k$ common companions:\n954: \n955: $$\n956: \\left| \\sum_{j \\in U_c} (P_1(j) - P_2(j)) f(j) \\right| \\leq M_f \\cdot k \\cdot \\frac{n_c}{k^2 \\cdot w_{\\min}^2} = \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}^2}\n957: $$\n958: \n959: **Step 4: Bound the differing companion terms**\n960: \n961: The sets $U_1 \\setminus U_c$ and $U_2 \\setminus U_c$ each contain at most $n_c$ walkers (those whose status differs). For each term:\n962: \n963: $$\n964: \\left| \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) \\right| \\leq M_f \\cdot \\sum_{j \\in U_1 \\setminus U_c} P_1(j)\n965: $$\n966: \n967: Since $P_1(j) = w_{ij} / Z_1 \\leq w_{\\max} / (k \\cdot w_{\\min}) = 1 / (k \\cdot w_{\\min})$ and there are at most $n_c$ such terms:\n968: \n969: $$\n970: \\left| \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) \\right| \\leq M_f \\cdot n_c \\cdot \\frac{1}{k \\cdot w_{\\min}} = \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}}\n971: $$\n972: \n973: Similarly for the $U_2 \\setminus U_c$ term.\n974: \n975: **Step 5: Combine all bounds**\n976: \n977: $$\n978: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}^2} + \\frac{2 M_f \\cdot n_c}{k \\cdot w_{\\min}}\n979: $$\n980: \n981: Factoring:\n982: \n983: $$\n984: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq \\frac{M_f \\cdot n_c}{k} \\cdot \\left( \\frac{1}{w_{\\min}^2} + \\frac{2}{w_{\\min}} \\right)\n985: $$\n986: \n987: Since $w_{\\min} = \\exp(-D_{\\max}^2 / 2\\epsilon_d^2) = O(1)$ is a fixed constant (depends only on state space diameter and interaction range), we can write:\n988: \n989: $$\n990: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq C_{\\text{softmax}} \\cdot \\frac{M_f \\cdot n_c}{k}\n991: $$\n992: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-dobrushin-contraction",
      "title": "Dobrushin Contraction for Euclidean Gas",
      "start_line": 1008,
      "end_line": 1032,
      "header_lines": [
        1009
      ],
      "content_start": 1011,
      "content_end": 1031,
      "content": "1011: :label: thm-dobrushin-contraction\n1012: \n1013: Let $\\Psi_{\\text{EG}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ be the one-step Euclidean Gas operator (cloning followed by kinetic evolution). Assume:\n1014: \n1015: 1. **Confining potential**: $U$ satisfies Axiom {prf:ref}`ax-confining-complete`\n1016: 2. **Hypocoercivity**: The kinetic operator has LSI constant $\\lambda_{\\text{hypo}} = c \\cdot \\min(\\gamma, \\alpha_U/\\sigma_v^2)$ (Proposition {prf:ref}`prop-hypocoercivity-piecewise`)\n1017: 3. **Non-degeneracy**: The alive set has size $k \\geq k_{\\min} \\geq 2$ with positive probability\n1018: \n1019: Then there exists a **contraction coefficient** $\\gamma < 1$ and constant $K$ such that for any two swarms $\\mathcal{S}_1, \\mathcal{S}_2$ with at least $k_{\\min}$ alive walkers:\n1020: \n1021: $$\n1022: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2) \\mid \\mathcal{S}_1, \\mathcal{S}_2] \\leq \\gamma \\cdot d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) + K\n1023: $$\n1024: \n1025: where $\\mathcal{S}'_1, \\mathcal{S}'_2$ are the swarms after one step under a **synchronous coupling** (using identical random numbers for both evolutions).\n1026: \n1027: The contraction coefficient satisfies:\n1028: \n1029: $$\n1030: \\gamma = (1 - \\lambda_{\\text{clone}} \\cdot \\tau) \\cdot (1 + O(\\tau \\cdot \\lambda_{\\text{hypo}}))\n1031: $$",
      "metadata": {
        "label": "thm-dobrushin-contraction"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "references": [
        "ax-confining-complete",
        "prop-hypocoercivity-piecewise"
      ],
      "raw_directive": "1008: The core idea: prove that one step of the Euclidean Gas dynamics brings two swarms **closer together** in expectation, with respect to $d_{\\text{status}}$.\n1009: \n1010: :::{prf:theorem} Dobrushin Contraction for Euclidean Gas\n1011: :label: thm-dobrushin-contraction\n1012: \n1013: Let $\\Psi_{\\text{EG}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ be the one-step Euclidean Gas operator (cloning followed by kinetic evolution). Assume:\n1014: \n1015: 1. **Confining potential**: $U$ satisfies Axiom {prf:ref}`ax-confining-complete`\n1016: 2. **Hypocoercivity**: The kinetic operator has LSI constant $\\lambda_{\\text{hypo}} = c \\cdot \\min(\\gamma, \\alpha_U/\\sigma_v^2)$ (Proposition {prf:ref}`prop-hypocoercivity-piecewise`)\n1017: 3. **Non-degeneracy**: The alive set has size $k \\geq k_{\\min} \\geq 2$ with positive probability\n1018: \n1019: Then there exists a **contraction coefficient** $\\gamma < 1$ and constant $K$ such that for any two swarms $\\mathcal{S}_1, \\mathcal{S}_2$ with at least $k_{\\min}$ alive walkers:\n1020: \n1021: $$\n1022: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2) \\mid \\mathcal{S}_1, \\mathcal{S}_2] \\leq \\gamma \\cdot d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) + K\n1023: $$\n1024: \n1025: where $\\mathcal{S}'_1, \\mathcal{S}'_2$ are the swarms after one step under a **synchronous coupling** (using identical random numbers for both evolutions).\n1026: \n1027: The contraction coefficient satisfies:\n1028: \n1029: $$\n1030: \\gamma = (1 - \\lambda_{\\text{clone}} \\cdot \\tau) \\cdot (1 + O(\\tau \\cdot \\lambda_{\\text{hypo}}))\n1031: $$\n1032: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-224",
      "title": null,
      "start_line": 1034,
      "end_line": 1158,
      "header_lines": [],
      "content_start": 1036,
      "content_end": 1157,
      "content": "1036: :::{prf:proof}\n1037: \n1038: The proof proceeds in four steps:\n1039: \n1040: **Step 1: Synchronous coupling construction**\n1041: \n1042: Given two initial swarms $\\mathcal{S}_1, \\mathcal{S}_2$, we construct a **maximal coupling** that uses identical random numbers whenever possible:\n1043: \n1044: 1. **For cloning**:\n1045:    - Use the same companion pairing algorithm random seed\n1046:    - For walker $i$: if alive in both swarms, use same threshold $T_i$ for cloning decision\n1047:    - If walker $i$ clones in both swarms, use same Gaussian jitter $\\zeta_i$ for position perturbation\n1048: \n1049: 2. **For kinetic evolution**:\n1050:    - For walker $i$: if alive in both swarms, use same Langevin noise realizations $\\xi_i^{(x)}, \\xi_i^{(v)}$\n1051: \n1052: This coupling **preserves status matches**: if walker $i$ has the same status in $\\mathcal{S}_1, \\mathcal{S}_2$, and makes the same cloning decision, it will have the same status in $\\mathcal{S}'_1, \\mathcal{S}'_2$.\n1053: \n1054: **Step 2: Bound on cloning-induced status changes**\n1055: \n1056: By the synchronous coupling, status differences after cloning can only arise from:\n1057: \n1058: **A. Walkers that already differed** ($n_c$ walkers):\n1059: - These remain different after cloning\n1060: - Contribution: at most $n_c$ differences\n1061: \n1062: **B. Walkers that matched initially but made different cloning decisions**:\n1063: \n1064: For a walker $i$ that is alive in both swarms, the cloning decision differs if the fitness differs. By Lemma {prf:ref}`lem-softmax-lipschitz-status` (extending Theorem {prf:ref}`thm-total-error-status-bound` to softmax-weighted companion selection):\n1065: \n1066: $$\n1067: |P(\\text{clone in } \\mathcal{S}_1) - P(\\text{clone in } \\mathcal{S}_2)| \\leq C_{\\text{clone}} \\cdot \\frac{n_c}{k}\n1068: $$\n1069: \n1070: where $C_{\\text{clone}} = O(1)$ depends on fitness bounds.\n1071: \n1072: The expected number of walkers that make different cloning decisions is:\n1073: \n1074: $$\n1075: \\mathbb{E}[\\text{new differences from cloning}] \\leq (N - n_c) \\cdot C_{\\text{clone}} \\cdot \\frac{n_c}{k} = O\\left(\\frac{N \\cdot n_c}{k}\\right)\n1076: $$\n1077: \n1078: **C. Walkers that cloned in one swarm but died in the other**:\n1079: \n1080: The death operator affects walkers at the boundary. By the confining potential, the probability of death is:\n1081: \n1082: $$\n1083: P(\\text{death}) = O(e^{-\\alpha_U R^2 / \\sigma_v^2})\n1084: $$\n1085: \n1086: which is exponentially small. Contribution: $O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$.\n1087: \n1088: **Combined cloning bound**:\n1089: \n1090: $$\n1091: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] \\leq n_c + O\\left(\\frac{N \\cdot n_c}{k}\\right) + O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)\n1092: $$\n1093: \n1094: For large swarms with $k \\sim N$ and small death probability:\n1095: \n1096: $$\n1097: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] \\leq (1 + \\epsilon_{\\text{clone}}) \\cdot n_c\n1098: $$\n1099: \n1100: where $\\epsilon_{\\text{clone}} = O(1)$ is a small constant.\n1101: \n1102: **Step 3: Bound on kinetic-induced status changes**\n1103: \n1104: The kinetic operator (Langevin dynamics) can change status in two ways:\n1105: \n1106: **A. Walker crosses boundary** (alive \u2192 dead or vice versa):\n1107: \n1108: By the confining potential and hypocoercivity, the probability of crossing the boundary in time $\\tau$ is exponentially small:\n1109: \n1110: $$\n1111: P(\\text{boundary crossing}) \\leq C_{\\text{boundary}} \\cdot e^{-\\alpha_U R^2 / \\sigma_v^2}\n1112: $$\n1113: \n1114: Expected contribution: $O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$\n1115: \n1116: **B. Walkers with matched positions remain matched**:\n1117: \n1118: For walkers with the same status and position in both swarms, the synchronous coupling ensures they evolve identically (same noise). They remain matched.\n1119: \n1120: **C. Walkers with different positions**:\n1121: \n1122: This is where the $d_{\\text{status}}$ metric is powerful: if two walkers have the same status but different positions, we **don't count this as a difference**! The metric only cares about alive/dead status, not spatial location.\n1123: \n1124: **Combined kinetic bound**:\n1125: \n1126: $$\n1127: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2)] \\leq \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] + O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)\n1128: $$\n1129: \n1130: **Step 4: Combine to get contraction**\n1131: \n1132: Combining Steps 2 and 3:\n1133: \n1134: $$\n1135: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2)] \\leq (1 + \\epsilon_{\\text{clone}}) \\cdot n_c + K\n1136: $$\n1137: \n1138: where $K = O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$ is the constant term from boundary effects.\n1139: \n1140: For contraction, we need $1 + \\epsilon_{\\text{clone}} < 1$, which requires **cloning to reduce differences**. This happens when:\n1141: - Unfit walkers (low fitness) are more likely to die\n1142: - Fit walkers (high fitness) are more likely to clone\n1143: - The fitness landscape provides directional pressure toward convergence\n1144: \n1145: By the Keystone Principle (Lemma {prf:ref}`lem-quantitative-keystone` in [03_cloning.md](../03_cloning.md)), cloning creates a **contractive force** with strength proportional to the fitness variance. When fitness variance is non-zero (guaranteed by the non-degeneracy axioms):\n1146: \n1147: $$\n1148: \\epsilon_{\\text{clone}} = -\\lambda_{\\text{clone}} \\cdot \\tau + O(\\tau^2)\n1149: $$\n1150: \n1151: where $\\lambda_{\\text{clone}} > 0$ is the cloning rate.\n1152: \n1153: Therefore:\n1154: \n1155: $$\n1156: \\gamma = 1 - \\lambda_{\\text{clone}} \\cdot \\tau + O(\\tau^2) < 1\n1157: $$",
      "metadata": {},
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "references": [
        "lem-softmax-lipschitz-status",
        "thm-total-error-status-bound",
        "lem-quantitative-keystone"
      ],
      "raw_directive": "1034: :::\n1035: \n1036: :::{prf:proof}\n1037: \n1038: The proof proceeds in four steps:\n1039: \n1040: **Step 1: Synchronous coupling construction**\n1041: \n1042: Given two initial swarms $\\mathcal{S}_1, \\mathcal{S}_2$, we construct a **maximal coupling** that uses identical random numbers whenever possible:\n1043: \n1044: 1. **For cloning**:\n1045:    - Use the same companion pairing algorithm random seed\n1046:    - For walker $i$: if alive in both swarms, use same threshold $T_i$ for cloning decision\n1047:    - If walker $i$ clones in both swarms, use same Gaussian jitter $\\zeta_i$ for position perturbation\n1048: \n1049: 2. **For kinetic evolution**:\n1050:    - For walker $i$: if alive in both swarms, use same Langevin noise realizations $\\xi_i^{(x)}, \\xi_i^{(v)}$\n1051: \n1052: This coupling **preserves status matches**: if walker $i$ has the same status in $\\mathcal{S}_1, \\mathcal{S}_2$, and makes the same cloning decision, it will have the same status in $\\mathcal{S}'_1, \\mathcal{S}'_2$.\n1053: \n1054: **Step 2: Bound on cloning-induced status changes**\n1055: \n1056: By the synchronous coupling, status differences after cloning can only arise from:\n1057: \n1058: **A. Walkers that already differed** ($n_c$ walkers):\n1059: - These remain different after cloning\n1060: - Contribution: at most $n_c$ differences\n1061: \n1062: **B. Walkers that matched initially but made different cloning decisions**:\n1063: \n1064: For a walker $i$ that is alive in both swarms, the cloning decision differs if the fitness differs. By Lemma {prf:ref}`lem-softmax-lipschitz-status` (extending Theorem {prf:ref}`thm-total-error-status-bound` to softmax-weighted companion selection):\n1065: \n1066: $$\n1067: |P(\\text{clone in } \\mathcal{S}_1) - P(\\text{clone in } \\mathcal{S}_2)| \\leq C_{\\text{clone}} \\cdot \\frac{n_c}{k}\n1068: $$\n1069: \n1070: where $C_{\\text{clone}} = O(1)$ depends on fitness bounds.\n1071: \n1072: The expected number of walkers that make different cloning decisions is:\n1073: \n1074: $$\n1075: \\mathbb{E}[\\text{new differences from cloning}] \\leq (N - n_c) \\cdot C_{\\text{clone}} \\cdot \\frac{n_c}{k} = O\\left(\\frac{N \\cdot n_c}{k}\\right)\n1076: $$\n1077: \n1078: **C. Walkers that cloned in one swarm but died in the other**:\n1079: \n1080: The death operator affects walkers at the boundary. By the confining potential, the probability of death is:\n1081: \n1082: $$\n1083: P(\\text{death}) = O(e^{-\\alpha_U R^2 / \\sigma_v^2})\n1084: $$\n1085: \n1086: which is exponentially small. Contribution: $O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$.\n1087: \n1088: **Combined cloning bound**:\n1089: \n1090: $$\n1091: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] \\leq n_c + O\\left(\\frac{N \\cdot n_c}{k}\\right) + O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)\n1092: $$\n1093: \n1094: For large swarms with $k \\sim N$ and small death probability:\n1095: \n1096: $$\n1097: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] \\leq (1 + \\epsilon_{\\text{clone}}) \\cdot n_c\n1098: $$\n1099: \n1100: where $\\epsilon_{\\text{clone}} = O(1)$ is a small constant.\n1101: \n1102: **Step 3: Bound on kinetic-induced status changes**\n1103: \n1104: The kinetic operator (Langevin dynamics) can change status in two ways:\n1105: \n1106: **A. Walker crosses boundary** (alive \u2192 dead or vice versa):\n1107: \n1108: By the confining potential and hypocoercivity, the probability of crossing the boundary in time $\\tau$ is exponentially small:\n1109: \n1110: $$\n1111: P(\\text{boundary crossing}) \\leq C_{\\text{boundary}} \\cdot e^{-\\alpha_U R^2 / \\sigma_v^2}\n1112: $$\n1113: \n1114: Expected contribution: $O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$\n1115: \n1116: **B. Walkers with matched positions remain matched**:\n1117: \n1118: For walkers with the same status and position in both swarms, the synchronous coupling ensures they evolve identically (same noise). They remain matched.\n1119: \n1120: **C. Walkers with different positions**:\n1121: \n1122: This is where the $d_{\\text{status}}$ metric is powerful: if two walkers have the same status but different positions, we **don't count this as a difference**! The metric only cares about alive/dead status, not spatial location.\n1123: \n1124: **Combined kinetic bound**:\n1125: \n1126: $$\n1127: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2)] \\leq \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] + O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)\n1128: $$\n1129: \n1130: **Step 4: Combine to get contraction**\n1131: \n1132: Combining Steps 2 and 3:\n1133: \n1134: $$\n1135: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2)] \\leq (1 + \\epsilon_{\\text{clone}}) \\cdot n_c + K\n1136: $$\n1137: \n1138: where $K = O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$ is the constant term from boundary effects.\n1139: \n1140: For contraction, we need $1 + \\epsilon_{\\text{clone}} < 1$, which requires **cloning to reduce differences**. This happens when:\n1141: - Unfit walkers (low fitness) are more likely to die\n1142: - Fit walkers (high fitness) are more likely to clone\n1143: - The fitness landscape provides directional pressure toward convergence\n1144: \n1145: By the Keystone Principle (Lemma {prf:ref}`lem-quantitative-keystone` in [03_cloning.md](../03_cloning.md)), cloning creates a **contractive force** with strength proportional to the fitness variance. When fitness variance is non-zero (guaranteed by the non-degeneracy axioms):\n1146: \n1147: $$\n1148: \\epsilon_{\\text{clone}} = -\\lambda_{\\text{clone}} \\cdot \\tau + O(\\tau^2)\n1149: $$\n1150: \n1151: where $\\lambda_{\\text{clone}} > 0$ is the cloning rate.\n1152: \n1153: Therefore:\n1154: \n1155: $$\n1156: \\gamma = 1 - \\lambda_{\\text{clone}} \\cdot \\tau + O(\\tau^2) < 1\n1157: $$\n1158: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-exponential-convergence-status",
      "title": "Exponential Convergence in $d_{\\text{status}}$ Metric",
      "start_line": 1164,
      "end_line": 1184,
      "header_lines": [
        1165
      ],
      "content_start": 1167,
      "content_end": 1183,
      "content": "1167: :label: thm-exponential-convergence-status\n1168: \n1169: Under the assumptions of Theorem {prf:ref}`thm-dobrushin-contraction`, the Euclidean Gas has a unique quasi-stationary distribution $\\pi_{\\text{QSD}}$ on the alive state space, and for any initial swarm $\\mathcal{S}_0$ with at least $k_{\\min}$ alive walkers:\n1170: \n1171: $$\n1172: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}_t, \\pi_{\\text{QSD}})] \\leq \\gamma^t \\cdot C_0 + \\frac{K}{1 - \\gamma}\n1173: $$\n1174: \n1175: where:\n1176: - $\\mathcal{S}_t$ is the swarm at time $t$\n1177: - $C_0 = d_{\\text{status}}(\\mathcal{S}_0, \\pi_{\\text{QSD}})$ is the initial distance\n1178: - $\\gamma < 1$ is the contraction coefficient from Theorem {prf:ref}`thm-dobrushin-contraction`\n1179: - $K$ is the boundary contribution (exponentially small)\n1180: \n1181: This gives **exponential convergence** with rate:\n1182: \n1183: $$",
      "metadata": {
        "label": "thm-exponential-convergence-status"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "references": [
        "thm-dobrushin-contraction"
      ],
      "raw_directive": "1164: With the Dobrushin contraction established, we can now prove exponential convergence to a unique quasi-stationary distribution.\n1165: \n1166: :::{prf:theorem} Exponential Convergence in $d_{\\text{status}}$ Metric\n1167: :label: thm-exponential-convergence-status\n1168: \n1169: Under the assumptions of Theorem {prf:ref}`thm-dobrushin-contraction`, the Euclidean Gas has a unique quasi-stationary distribution $\\pi_{\\text{QSD}}$ on the alive state space, and for any initial swarm $\\mathcal{S}_0$ with at least $k_{\\min}$ alive walkers:\n1170: \n1171: $$\n1172: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}_t, \\pi_{\\text{QSD}})] \\leq \\gamma^t \\cdot C_0 + \\frac{K}{1 - \\gamma}\n1173: $$\n1174: \n1175: where:\n1176: - $\\mathcal{S}_t$ is the swarm at time $t$\n1177: - $C_0 = d_{\\text{status}}(\\mathcal{S}_0, \\pi_{\\text{QSD}})$ is the initial distance\n1178: - $\\gamma < 1$ is the contraction coefficient from Theorem {prf:ref}`thm-dobrushin-contraction`\n1179: - $K$ is the boundary contribution (exponentially small)\n1180: \n1181: This gives **exponential convergence** with rate:\n1182: \n1183: $$\n1184: \\lambda_{\\text{converge}} = -\\log(\\gamma) \\approx \\lambda_{\\text{clone}} \\cdot \\tau"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-376",
      "title": null,
      "start_line": 1186,
      "end_line": 1227,
      "header_lines": [],
      "content_start": 1188,
      "content_end": 1226,
      "content": "1188: :::{prf:proof}\n1189: \n1190: This is a standard application of the **Banach fixed-point theorem for Markov chains** (see Meyn & Tweedie, \"Markov Chains and Stochastic Stability\", Theorem 16.0.2).\n1191: \n1192: **Step 1: Contraction mapping**\n1193: \n1194: Define the operator $P: \\mathcal{P}(\\mathbb{S}) \\to \\mathcal{P}(\\mathbb{S})$ where $P\\mu$ is the distribution of $\\mathcal{S}'$ when $\\mathcal{S} \\sim \\mu$.\n1195: \n1196: By Theorem {prf:ref}`thm-dobrushin-contraction`, $P$ is a contraction in the $d_{\\text{status}}$ metric:\n1197: \n1198: $$\n1199: W_{d_{\\text{status}}}(P\\mu_1, P\\mu_2) \\leq \\gamma \\cdot W_{d_{\\text{status}}}(\\mu_1, \\mu_2) + K\n1200: $$\n1201: \n1202: where $W_{d_{\\text{status}}}$ is the Wasserstein-1 distance with respect to the $d_{\\text{status}}$ metric.\n1203: \n1204: **Step 2: Fixed point exists and is unique**\n1205: \n1206: By the Banach fixed-point theorem, there exists a unique distribution $\\pi_{\\text{QSD}}$ such that $P\\pi_{\\text{QSD}} = \\pi_{\\text{QSD}}$. This is the quasi-stationary distribution.\n1207: \n1208: **Step 3: Exponential approach**\n1209: \n1210: For any initial distribution $\\mu_0$, let $\\mu_t = P^t \\mu_0$. By repeated application of contraction:\n1211: \n1212: $$\n1213: W_{d_{\\text{status}}}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\gamma^t \\cdot W_{d_{\\text{status}}}(\\mu_0, \\pi_{\\text{QSD}}) + K \\sum_{i=0}^{t-1} \\gamma^i\n1214: $$\n1215: \n1216: The geometric series sums to:\n1217: \n1218: $$\n1219: \\sum_{i=0}^{t-1} \\gamma^i = \\frac{1 - \\gamma^t}{1 - \\gamma} < \\frac{1}{1 - \\gamma}\n1220: $$\n1221: \n1222: Therefore:\n1223: \n1224: $$\n1225: W_{d_{\\text{status}}}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\gamma^t \\cdot W_{d_{\\text{status}}}(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{K}{1 - \\gamma}\n1226: $$",
      "metadata": {},
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "references": [
        "thm-dobrushin-contraction"
      ],
      "raw_directive": "1186: :::\n1187: \n1188: :::{prf:proof}\n1189: \n1190: This is a standard application of the **Banach fixed-point theorem for Markov chains** (see Meyn & Tweedie, \"Markov Chains and Stochastic Stability\", Theorem 16.0.2).\n1191: \n1192: **Step 1: Contraction mapping**\n1193: \n1194: Define the operator $P: \\mathcal{P}(\\mathbb{S}) \\to \\mathcal{P}(\\mathbb{S})$ where $P\\mu$ is the distribution of $\\mathcal{S}'$ when $\\mathcal{S} \\sim \\mu$.\n1195: \n1196: By Theorem {prf:ref}`thm-dobrushin-contraction`, $P$ is a contraction in the $d_{\\text{status}}$ metric:\n1197: \n1198: $$\n1199: W_{d_{\\text{status}}}(P\\mu_1, P\\mu_2) \\leq \\gamma \\cdot W_{d_{\\text{status}}}(\\mu_1, \\mu_2) + K\n1200: $$\n1201: \n1202: where $W_{d_{\\text{status}}}$ is the Wasserstein-1 distance with respect to the $d_{\\text{status}}$ metric.\n1203: \n1204: **Step 2: Fixed point exists and is unique**\n1205: \n1206: By the Banach fixed-point theorem, there exists a unique distribution $\\pi_{\\text{QSD}}$ such that $P\\pi_{\\text{QSD}} = \\pi_{\\text{QSD}}$. This is the quasi-stationary distribution.\n1207: \n1208: **Step 3: Exponential approach**\n1209: \n1210: For any initial distribution $\\mu_0$, let $\\mu_t = P^t \\mu_0$. By repeated application of contraction:\n1211: \n1212: $$\n1213: W_{d_{\\text{status}}}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\gamma^t \\cdot W_{d_{\\text{status}}}(\\mu_0, \\pi_{\\text{QSD}}) + K \\sum_{i=0}^{t-1} \\gamma^i\n1214: $$\n1215: \n1216: The geometric series sums to:\n1217: \n1218: $$\n1219: \\sum_{i=0}^{t-1} \\gamma^i = \\frac{1 - \\gamma^t}{1 - \\gamma} < \\frac{1}{1 - \\gamma}\n1220: $$\n1221: \n1222: Therefore:\n1223: \n1224: $$\n1225: W_{d_{\\text{status}}}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\gamma^t \\cdot W_{d_{\\text{status}}}(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{K}{1 - \\gamma}\n1226: $$\n1227: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}