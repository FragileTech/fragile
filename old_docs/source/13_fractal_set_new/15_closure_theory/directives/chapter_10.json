{
  "chapter_index": 10,
  "section_id": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
  "directive_count": 14,
  "hints": [
    {
      "directive_type": "definition",
      "label": "def-scutoid-state-space",
      "title": "Scutoid State Space",
      "start_line": 1697,
      "end_line": 1708,
      "header_lines": [
        1698
      ],
      "content_start": 1700,
      "content_end": 1707,
      "content": "1700: :label: def-scutoid-state-space\n1701: \n1702: The **scutoid state space** $\\Omega_{\\text{scutoid}}$ consists of configurations of scutoid cells in the spacetime manifold $\\mathcal{M} = \\mathcal{X} \\times [0, T]$.\n1703: \n1704: A **scutoid configuration** $Z_{\\text{scutoid}}(t) = \\{\\mathcal{S}_{i,t}\\}_{i \\in \\mathcal{E}(t)}$ at time $t$ is the set of all scutoid cells with lifetimes overlapping the interval $[t, t + \\Delta t]$, where $\\mathcal{E}(t)$ is the set of active episodes.\n1705: \n1706: Each scutoid $\\mathcal{S}_{i,t}$ is characterized by:\n1707: - **Geometric data:** Volume $\\text{Vol}(\\mathcal{S}_{i,t})$, face curvatures $\\{K_{\\Sigma_k}\\}$, neighbor sets $\\mathcal{N}_i(t)$",
      "metadata": {
        "label": "def-scutoid-state-space"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [],
      "raw_directive": "1697: ### 10.2. Scutoid Renormalization Channel\n1698: \n1699: :::{prf:definition} Scutoid State Space\n1700: :label: def-scutoid-state-space\n1701: \n1702: The **scutoid state space** $\\Omega_{\\text{scutoid}}$ consists of configurations of scutoid cells in the spacetime manifold $\\mathcal{M} = \\mathcal{X} \\times [0, T]$.\n1703: \n1704: A **scutoid configuration** $Z_{\\text{scutoid}}(t) = \\{\\mathcal{S}_{i,t}\\}_{i \\in \\mathcal{E}(t)}$ at time $t$ is the set of all scutoid cells with lifetimes overlapping the interval $[t, t + \\Delta t]$, where $\\mathcal{E}(t)$ is the set of active episodes.\n1705: \n1706: Each scutoid $\\mathcal{S}_{i,t}$ is characterized by:\n1707: - **Geometric data:** Volume $\\text{Vol}(\\mathcal{S}_{i,t})$, face curvatures $\\{K_{\\Sigma_k}\\}$, neighbor sets $\\mathcal{N}_i(t)$\n1708: - **Topological data:** Cell type (prism, simple scutoid, complex scutoid), scutoid index $\\chi_{\\text{scutoid}}$"
    },
    {
      "directive_type": "definition",
      "label": "def-spatial-scutoid-blocks",
      "title": "Spatial Scutoid Blocks",
      "start_line": 1710,
      "end_line": 1728,
      "header_lines": [
        1711
      ],
      "content_start": 1713,
      "content_end": 1727,
      "content": "1713: :label: def-spatial-scutoid-blocks\n1714: \n1715: For a block size $b \\in \\mathbb{N}$ and time $t$, partition the spatial domain $\\mathcal{X}$ into non-overlapping blocks $\\{B_\\alpha\\}_{\\alpha=1}^{M}$ with characteristic length scale $ba$ (where $a$ is the micro-scale lattice spacing).\n1716: \n1717: The **scutoid block** $\\mathbb{S}_\\alpha(t)$ is the set of all scutoid cells whose **spatial center-of-mass** lies in block $B_\\alpha$:\n1718: \n1719: $$\n1720: \\mathbb{S}_\\alpha(t) = \\left\\{ \\mathcal{S}_{i,t} : \\text{CoM}(\\mathcal{S}_{i,t}) \\in B_\\alpha, \\, i \\in \\mathcal{E}(t) \\right\\}\n1721: \n1722: $$\n1723: \n1724: where the center-of-mass is defined using the spacetime metric:\n1725: \n1726: $$\n1727: \\text{CoM}(\\mathcal{S}_{i,t}) = \\frac{1}{\\text{Vol}(\\mathcal{S}_{i,t})} \\int_{\\mathcal{S}_{i,t}} x \\, \\sqrt{\\det(g_{\\text{ST}})} \\, dx^1 \\cdots dx^d \\, dt",
      "metadata": {
        "label": "def-spatial-scutoid-blocks"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [],
      "raw_directive": "1710: :::\n1711: \n1712: :::{prf:definition} Spatial Scutoid Blocks\n1713: :label: def-spatial-scutoid-blocks\n1714: \n1715: For a block size $b \\in \\mathbb{N}$ and time $t$, partition the spatial domain $\\mathcal{X}$ into non-overlapping blocks $\\{B_\\alpha\\}_{\\alpha=1}^{M}$ with characteristic length scale $ba$ (where $a$ is the micro-scale lattice spacing).\n1716: \n1717: The **scutoid block** $\\mathbb{S}_\\alpha(t)$ is the set of all scutoid cells whose **spatial center-of-mass** lies in block $B_\\alpha$:\n1718: \n1719: $$\n1720: \\mathbb{S}_\\alpha(t) = \\left\\{ \\mathcal{S}_{i,t} : \\text{CoM}(\\mathcal{S}_{i,t}) \\in B_\\alpha, \\, i \\in \\mathcal{E}(t) \\right\\}\n1721: \n1722: $$\n1723: \n1724: where the center-of-mass is defined using the spacetime metric:\n1725: \n1726: $$\n1727: \\text{CoM}(\\mathcal{S}_{i,t}) = \\frac{1}{\\text{Vol}(\\mathcal{S}_{i,t})} \\int_{\\mathcal{S}_{i,t}} x \\, \\sqrt{\\det(g_{\\text{ST}})} \\, dx^1 \\cdots dx^d \\, dt\n1728: "
    },
    {
      "directive_type": "definition",
      "label": "def-scutoid-renormalization-map",
      "title": "Scutoid Renormalization Map",
      "start_line": 1730,
      "end_line": 1761,
      "header_lines": [
        1731
      ],
      "content_start": 1733,
      "content_end": 1760,
      "content": "1733: :label: def-scutoid-renormalization-map\n1734: \n1735: The **scutoid renormalization map** $\\mathcal{R}_{\\text{scutoid},b}: \\Omega_{\\text{scutoid}} \\to \\tilde{\\Omega}_{\\text{scutoid}}$ aggregates scutoid cells within each spatial block into a single **super-scutoid** $\\tilde{\\mathcal{S}}_\\alpha(t)$.\n1736: \n1737: **Aggregation rule:** For each block $\\mathbb{S}_\\alpha(t) = \\{\\mathcal{S}_{i_1,t}, \\ldots, \\mathcal{S}_{i_{n_\\alpha},t}\\}$ containing $n_\\alpha$ scutoids, construct:\n1738: \n1739: **1. Super-Scutoid Bottom Face:**\n1740: \n1741: $$\n1742: \\tilde{F}_{\\text{bottom}}^\\alpha = \\bigcup_{i \\in \\mathbb{S}_\\alpha(t)} F_{\\text{bottom}}^i \\quad \\text{(union of all bottom faces in block)}\n1743: \n1744: $$\n1745: \n1746: **2. Super-Scutoid Top Face:**\n1747: \n1748: $$\n1749: \\tilde{F}_{\\text{top}}^\\alpha = \\bigcup_{i \\in \\mathbb{S}_\\alpha(t + \\Delta t)} F_{\\text{top}}^i \\quad \\text{(union of all top faces in block)}\n1750: \n1751: $$\n1752: \n1753: **3. Aggregate Geometric Properties:**\n1754: - **Volume:** $\\text{Vol}(\\tilde{\\mathcal{S}}_\\alpha) = \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\text{Vol}(\\mathcal{S}_{i,t})$\n1755: - **Average face curvature:** $\\tilde{K}_\\alpha = \\frac{1}{|\\mathbb{S}_\\alpha(t)|} \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\langle K_{\\Sigma}^i \\rangle$ (spatial average)\n1756: - **Effective reward:** $\\tilde{r}_\\alpha = \\frac{1}{|\\mathbb{S}_\\alpha(t)|} \\sum_{i \\in \\mathbb{S}_\\alpha(t)} r_i$\n1757: \n1758: **4. Aggregate Topological Properties:**\n1759: - **Scutoid fraction:** $\\tilde{\\phi}_\\alpha = \\frac{1}{|\\mathbb{S}_\\alpha(t)|} \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\mathbb{1}[\\text{scutoid}]_i$ (fraction of true scutoids vs. prisms)\n1760: - **Topological charge:** $\\tilde{\\chi}_\\alpha = \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\chi_{\\text{scutoid}}^i$ (total scutoid index)",
      "metadata": {
        "label": "def-scutoid-renormalization-map"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [],
      "raw_directive": "1730: :::\n1731: \n1732: :::{prf:definition} Scutoid Renormalization Map\n1733: :label: def-scutoid-renormalization-map\n1734: \n1735: The **scutoid renormalization map** $\\mathcal{R}_{\\text{scutoid},b}: \\Omega_{\\text{scutoid}} \\to \\tilde{\\Omega}_{\\text{scutoid}}$ aggregates scutoid cells within each spatial block into a single **super-scutoid** $\\tilde{\\mathcal{S}}_\\alpha(t)$.\n1736: \n1737: **Aggregation rule:** For each block $\\mathbb{S}_\\alpha(t) = \\{\\mathcal{S}_{i_1,t}, \\ldots, \\mathcal{S}_{i_{n_\\alpha},t}\\}$ containing $n_\\alpha$ scutoids, construct:\n1738: \n1739: **1. Super-Scutoid Bottom Face:**\n1740: \n1741: $$\n1742: \\tilde{F}_{\\text{bottom}}^\\alpha = \\bigcup_{i \\in \\mathbb{S}_\\alpha(t)} F_{\\text{bottom}}^i \\quad \\text{(union of all bottom faces in block)}\n1743: \n1744: $$\n1745: \n1746: **2. Super-Scutoid Top Face:**\n1747: \n1748: $$\n1749: \\tilde{F}_{\\text{top}}^\\alpha = \\bigcup_{i \\in \\mathbb{S}_\\alpha(t + \\Delta t)} F_{\\text{top}}^i \\quad \\text{(union of all top faces in block)}\n1750: \n1751: $$\n1752: \n1753: **3. Aggregate Geometric Properties:**\n1754: - **Volume:** $\\text{Vol}(\\tilde{\\mathcal{S}}_\\alpha) = \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\text{Vol}(\\mathcal{S}_{i,t})$\n1755: - **Average face curvature:** $\\tilde{K}_\\alpha = \\frac{1}{|\\mathbb{S}_\\alpha(t)|} \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\langle K_{\\Sigma}^i \\rangle$ (spatial average)\n1756: - **Effective reward:** $\\tilde{r}_\\alpha = \\frac{1}{|\\mathbb{S}_\\alpha(t)|} \\sum_{i \\in \\mathbb{S}_\\alpha(t)} r_i$\n1757: \n1758: **4. Aggregate Topological Properties:**\n1759: - **Scutoid fraction:** $\\tilde{\\phi}_\\alpha = \\frac{1}{|\\mathbb{S}_\\alpha(t)|} \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\mathbb{1}[\\text{scutoid}]_i$ (fraction of true scutoids vs. prisms)\n1760: - **Topological charge:** $\\tilde{\\chi}_\\alpha = \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\chi_{\\text{scutoid}}^i$ (total scutoid index)\n1761: "
    },
    {
      "directive_type": "remark",
      "label": "rem-deterministic-scutoid-aggregation",
      "title": "Why Deterministic Aggregation?",
      "start_line": 1763,
      "end_line": 1769,
      "header_lines": [
        1764
      ],
      "content_start": 1766,
      "content_end": 1768,
      "content": "1766: :label: rem-deterministic-scutoid-aggregation\n1767: \n1768: Following the resolution from \u00a7 4 (Round 2 fix), we use **deterministic** aggregation to ensure compatibility with Kemeny & Snell lumpability theory. The super-scutoid properties are exact sums/averages of micro-scutoid properties\u2014no sampling or stochastic noise is added.",
      "metadata": {
        "label": "rem-deterministic-scutoid-aggregation"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [
        "def-renormalization-channel-spatial"
      ],
      "raw_directive": "1763: :::\n1764: \n1765: :::{prf:remark} Why Deterministic Aggregation?\n1766: :label: rem-deterministic-scutoid-aggregation\n1767: \n1768: Following the resolution from \u00a7 4 (Round 2 fix), we use **deterministic** aggregation to ensure compatibility with Kemeny & Snell lumpability theory. The super-scutoid properties are exact sums/averages of micro-scutoid properties\u2014no sampling or stochastic noise is added.\n1769: "
    },
    {
      "directive_type": "definition",
      "label": "def-scutoid-markov-chain",
      "title": "Scutoid Markov Chain (Quotient Process)",
      "start_line": 1773,
      "end_line": 1813,
      "header_lines": [
        1774
      ],
      "content_start": 1776,
      "content_end": 1812,
      "content": "1776: :label: def-scutoid-markov-chain\n1777: \n1778: The **scutoid Markov chain** $\\{Z_{\\text{scutoid}}(k)\\}_{k \\geq 0}$ is the **quotient Markov chain** obtained by projecting the BAOAB dynamics onto the scutoid state space.\n1779: \n1780: **Construction:** Let $\\Omega_{\\text{BAOAB}} = \\mathcal{X}^N \\times \\mathbb{R}^{Nd} \\times \\mathcal{I}$ be the full state space with positions $X$, velocities $V$, and information graph $\\mathcal{I}$. The scutoid projection map $\\pi_{\\text{scutoid}}: \\Omega_{\\text{BAOAB}} \\to \\Omega_{\\text{scutoid}}$ is defined by:\n1781: \n1782: $$\n1783: \\pi_{\\text{scutoid}}(X, V, \\mathcal{I}) = \\text{Scutoid}(X, V, \\mathcal{I})\n1784: \n1785: $$\n1786: \n1787: where $\\text{Scutoid}(X, V, \\mathcal{I})$ constructs the scutoid tessellation from the walker state (Algorithm {prf:ref}`alg-scutoid-construction` in [14_scutoid_geometry_framework.md](14_scutoid_geometry_framework.md)), retaining only:\n1788: - Geometric data: Voronoi cell volumes, face curvatures, neighbor sets\n1789: - Topological data: Cell types (prism vs. scutoid), scutoid indices\n1790: - Aggregated physical data: Average rewards, fitness values\n1791: \n1792: **Quotient transition kernel:** For scutoid states $z, z' \\in \\Omega_{\\text{scutoid}}$, the transition probability is the **QSD-weighted push-forward** of the BAOAB kernel:\n1793: \n1794: $$\n1795: \\mathbb{P}_{\\text{scutoid}}(z' \\mid z) = \\sum_{(X,V,\\mathcal{I}) \\in \\pi_{\\text{scutoid}}^{-1}(z)} \\mathbb{P}_{\\text{BAOAB}}(\\pi_{\\text{scutoid}}^{-1}(z') \\mid (X, V, \\mathcal{I})) \\cdot \\frac{\\mu_{\\text{QSD}}(X, V, \\mathcal{I})}{\\mu_{\\text{QSD}}(\\pi_{\\text{scutoid}}^{-1}(z))}\n1796: \n1797: $$\n1798: \n1799: where:\n1800: - $\\pi_{\\text{scutoid}}^{-1}(z) = \\{(X, V, \\mathcal{I}) : \\pi_{\\text{scutoid}}(X, V, \\mathcal{I}) = z\\}$ is the pre-image (fiber) of scutoid state $z$\n1801: - $\\mu_{\\text{QSD}}$ is the quasi-stationary distribution of the BAOAB chain\n1802: - The sum averages over all micro-states that project to $z$, weighted by their QSD probability\n1803: \n1804: **Well-definedness:** The quotient kernel $\\mathbb{P}_{\\text{scutoid}}$ is a well-defined Markov transition kernel because:\n1805: 1. $\\mu_{\\text{QSD}}$ is stationary and positive on all accessible states (Theorem {prf:ref}`thm-qsd-existence` in [02_computational_equivalence.md](02_computational_equivalence.md))\n1806: 2. The BAOAB kernel $\\mathbb{P}_{\\text{BAOAB}}$ is time-homogeneous\n1807: 3. The scutoid projection $\\pi_{\\text{scutoid}}$ is a measurable function\n1808: \n1809: **Key property:** The scutoid Markov chain is **time-homogeneous** and **irreducible** (inheriting from BAOAB), hence has a unique quasi-stationary distribution $\\mu_{\\text{scutoid}}^{QSD}$ on the scutoid state space, given by the push-forward:\n1810: \n1811: $$\n1812: \\mu_{\\text{scutoid}}^{QSD}(z) = \\mu_{\\text{QSD}}(\\pi_{\\text{scutoid}}^{-1}(z)) = \\sum_{(X,V,\\mathcal{I}) \\in \\pi_{\\text{scutoid}}^{-1}(z)} \\mu_{\\text{QSD}}(X, V, \\mathcal{I})",
      "metadata": {
        "label": "def-scutoid-markov-chain"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [
        "alg-scutoid-construction",
        "thm-qsd-existence"
      ],
      "raw_directive": "1773: ### 10.3. Scutoid \u03b5-Machine and Causal States\n1774: \n1775: :::{prf:definition} Scutoid Markov Chain (Quotient Process)\n1776: :label: def-scutoid-markov-chain\n1777: \n1778: The **scutoid Markov chain** $\\{Z_{\\text{scutoid}}(k)\\}_{k \\geq 0}$ is the **quotient Markov chain** obtained by projecting the BAOAB dynamics onto the scutoid state space.\n1779: \n1780: **Construction:** Let $\\Omega_{\\text{BAOAB}} = \\mathcal{X}^N \\times \\mathbb{R}^{Nd} \\times \\mathcal{I}$ be the full state space with positions $X$, velocities $V$, and information graph $\\mathcal{I}$. The scutoid projection map $\\pi_{\\text{scutoid}}: \\Omega_{\\text{BAOAB}} \\to \\Omega_{\\text{scutoid}}$ is defined by:\n1781: \n1782: $$\n1783: \\pi_{\\text{scutoid}}(X, V, \\mathcal{I}) = \\text{Scutoid}(X, V, \\mathcal{I})\n1784: \n1785: $$\n1786: \n1787: where $\\text{Scutoid}(X, V, \\mathcal{I})$ constructs the scutoid tessellation from the walker state (Algorithm {prf:ref}`alg-scutoid-construction` in [14_scutoid_geometry_framework.md](14_scutoid_geometry_framework.md)), retaining only:\n1788: - Geometric data: Voronoi cell volumes, face curvatures, neighbor sets\n1789: - Topological data: Cell types (prism vs. scutoid), scutoid indices\n1790: - Aggregated physical data: Average rewards, fitness values\n1791: \n1792: **Quotient transition kernel:** For scutoid states $z, z' \\in \\Omega_{\\text{scutoid}}$, the transition probability is the **QSD-weighted push-forward** of the BAOAB kernel:\n1793: \n1794: $$\n1795: \\mathbb{P}_{\\text{scutoid}}(z' \\mid z) = \\sum_{(X,V,\\mathcal{I}) \\in \\pi_{\\text{scutoid}}^{-1}(z)} \\mathbb{P}_{\\text{BAOAB}}(\\pi_{\\text{scutoid}}^{-1}(z') \\mid (X, V, \\mathcal{I})) \\cdot \\frac{\\mu_{\\text{QSD}}(X, V, \\mathcal{I})}{\\mu_{\\text{QSD}}(\\pi_{\\text{scutoid}}^{-1}(z))}\n1796: \n1797: $$\n1798: \n1799: where:\n1800: - $\\pi_{\\text{scutoid}}^{-1}(z) = \\{(X, V, \\mathcal{I}) : \\pi_{\\text{scutoid}}(X, V, \\mathcal{I}) = z\\}$ is the pre-image (fiber) of scutoid state $z$\n1801: - $\\mu_{\\text{QSD}}$ is the quasi-stationary distribution of the BAOAB chain\n1802: - The sum averages over all micro-states that project to $z$, weighted by their QSD probability\n1803: \n1804: **Well-definedness:** The quotient kernel $\\mathbb{P}_{\\text{scutoid}}$ is a well-defined Markov transition kernel because:\n1805: 1. $\\mu_{\\text{QSD}}$ is stationary and positive on all accessible states (Theorem {prf:ref}`thm-qsd-existence` in [02_computational_equivalence.md](02_computational_equivalence.md))\n1806: 2. The BAOAB kernel $\\mathbb{P}_{\\text{BAOAB}}$ is time-homogeneous\n1807: 3. The scutoid projection $\\pi_{\\text{scutoid}}$ is a measurable function\n1808: \n1809: **Key property:** The scutoid Markov chain is **time-homogeneous** and **irreducible** (inheriting from BAOAB), hence has a unique quasi-stationary distribution $\\mu_{\\text{scutoid}}^{QSD}$ on the scutoid state space, given by the push-forward:\n1810: \n1811: $$\n1812: \\mu_{\\text{scutoid}}^{QSD}(z) = \\mu_{\\text{QSD}}(\\pi_{\\text{scutoid}}^{-1}(z)) = \\sum_{(X,V,\\mathcal{I}) \\in \\pi_{\\text{scutoid}}^{-1}(z)} \\mu_{\\text{QSD}}(X, V, \\mathcal{I})\n1813: "
    },
    {
      "directive_type": "definition",
      "label": "def-scutoid-causal-states",
      "title": "Scutoid Causal States",
      "start_line": 1815,
      "end_line": 1837,
      "header_lines": [
        1816
      ],
      "content_start": 1818,
      "content_end": 1836,
      "content": "1818: :label: def-scutoid-causal-states\n1819: \n1820: For the scutoid Markov chain, define **scutoid causal states** as equivalence classes of past scutoid configurations with identical conditional future distributions.\n1821: \n1822: Two past trajectories $\\overleftarrow{Z}_{\\text{scutoid},k} = (z_0, \\ldots, z_k)$ and $\\overleftarrow{Z}'_{\\text{scutoid},k} = (z'_0, \\ldots, z'_k)$ are causally equivalent if:\n1823: \n1824: $$\n1825: P(\\overrightarrow{Z}_{\\text{scutoid}} \\mid \\overleftarrow{Z}_{\\text{scutoid},k}) = P(\\overrightarrow{Z}_{\\text{scutoid}} \\mid \\overleftarrow{Z}'_{\\text{scutoid},k})\n1826: \n1827: $$\n1828: \n1829: By Theorem {prf:ref}`thm-causal-state-markov-reduction`, for time-homogeneous Markov processes, causal states reduce to equivalence classes of **terminal scutoid configurations** $z_k$:\n1830: \n1831: $$\n1832: \\Sigma_{\\varepsilon}^{\\text{scutoid}} = \\{ [z] : z \\in \\Omega_{\\text{scutoid}} \\}\n1833: \n1834: $$\n1835: \n1836: where $[z]$ denotes the equivalence class of configurations with the same BAOAB transition probabilities.",
      "metadata": {
        "label": "def-scutoid-causal-states"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [
        "thm-causal-state-markov-reduction"
      ],
      "raw_directive": "1815: :::\n1816: \n1817: :::{prf:definition} Scutoid Causal States\n1818: :label: def-scutoid-causal-states\n1819: \n1820: For the scutoid Markov chain, define **scutoid causal states** as equivalence classes of past scutoid configurations with identical conditional future distributions.\n1821: \n1822: Two past trajectories $\\overleftarrow{Z}_{\\text{scutoid},k} = (z_0, \\ldots, z_k)$ and $\\overleftarrow{Z}'_{\\text{scutoid},k} = (z'_0, \\ldots, z'_k)$ are causally equivalent if:\n1823: \n1824: $$\n1825: P(\\overrightarrow{Z}_{\\text{scutoid}} \\mid \\overleftarrow{Z}_{\\text{scutoid},k}) = P(\\overrightarrow{Z}_{\\text{scutoid}} \\mid \\overleftarrow{Z}'_{\\text{scutoid},k})\n1826: \n1827: $$\n1828: \n1829: By Theorem {prf:ref}`thm-causal-state-markov-reduction`, for time-homogeneous Markov processes, causal states reduce to equivalence classes of **terminal scutoid configurations** $z_k$:\n1830: \n1831: $$\n1832: \\Sigma_{\\varepsilon}^{\\text{scutoid}} = \\{ [z] : z \\in \\Omega_{\\text{scutoid}} \\}\n1833: \n1834: $$\n1835: \n1836: where $[z]$ denotes the equivalence class of configurations with the same BAOAB transition probabilities.\n1837: "
    },
    {
      "directive_type": "definition",
      "label": "def-epsilon-lumpability-scutoid",
      "title": "\u03b5-Lumpability for Scutoid Aggregation",
      "start_line": 1843,
      "end_line": 1863,
      "header_lines": [
        1844
      ],
      "content_start": 1846,
      "content_end": 1862,
      "content": "1846: :label: def-epsilon-lumpability-scutoid\n1847: \n1848: A partition of the scutoid state space induced by $\\mathcal{R}_{\\text{scutoid},b}$ is **\u03b5-lumpable** with respect to $\\mathbb{P}_{\\text{scutoid}}$ if there exists a macro-transition kernel $\\tilde{\\mathbb{P}}_{\\text{scutoid}}$ such that for all super-scutoid states $\\tilde{z}, \\tilde{z}' \\in \\tilde{\\Omega}_{\\text{scutoid}}$ and all micro-scutoid states $z \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z})$:\n1849: \n1850: $$\n1851: \\left| \\sum_{z' \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z}')} \\mathbb{P}_{\\text{scutoid}}(z' \\mid z) - \\tilde{\\mathbb{P}}_{\\text{scutoid}}(\\tilde{z}' \\mid \\tilde{z}) \\right| \\le \\varepsilon_{\\text{lump}}(b, \\xi, d)\n1852: \n1853: $$\n1854: \n1855: where $\\varepsilon_{\\text{lump}}(b, \\xi, d)$ is the **lumpability error** depending on block size $b$, correlation length $\\xi$, and dimension $d$.\n1856: \n1857: **Macro-kernel definition:** The macro-kernel $\\tilde{\\mathbb{P}}_{\\text{scutoid}}$ is defined as the **QSD-weighted average** over micro-states:\n1858: \n1859: $$\n1860: \\tilde{\\mathbb{P}}_{\\text{scutoid}}(\\tilde{z}' \\mid \\tilde{z}) = \\frac{1}{\\mu_{\\text{scutoid}}^{QSD}(\\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z}))} \\sum_{z \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z})} \\sum_{z' \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z}')} \\mathbb{P}_{\\text{scutoid}}(z' \\mid z) \\cdot \\mu_{\\text{scutoid}}^{QSD}(z)\n1861: \n1862: $$",
      "metadata": {
        "label": "def-epsilon-lumpability-scutoid"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [],
      "raw_directive": "1843: We now prove the central result: scutoid aggregation satisfies computational closure.\n1844: \n1845: :::{prf:definition} \u03b5-Lumpability for Scutoid Aggregation\n1846: :label: def-epsilon-lumpability-scutoid\n1847: \n1848: A partition of the scutoid state space induced by $\\mathcal{R}_{\\text{scutoid},b}$ is **\u03b5-lumpable** with respect to $\\mathbb{P}_{\\text{scutoid}}$ if there exists a macro-transition kernel $\\tilde{\\mathbb{P}}_{\\text{scutoid}}$ such that for all super-scutoid states $\\tilde{z}, \\tilde{z}' \\in \\tilde{\\Omega}_{\\text{scutoid}}$ and all micro-scutoid states $z \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z})$:\n1849: \n1850: $$\n1851: \\left| \\sum_{z' \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z}')} \\mathbb{P}_{\\text{scutoid}}(z' \\mid z) - \\tilde{\\mathbb{P}}_{\\text{scutoid}}(\\tilde{z}' \\mid \\tilde{z}) \\right| \\le \\varepsilon_{\\text{lump}}(b, \\xi, d)\n1852: \n1853: $$\n1854: \n1855: where $\\varepsilon_{\\text{lump}}(b, \\xi, d)$ is the **lumpability error** depending on block size $b$, correlation length $\\xi$, and dimension $d$.\n1856: \n1857: **Macro-kernel definition:** The macro-kernel $\\tilde{\\mathbb{P}}_{\\text{scutoid}}$ is defined as the **QSD-weighted average** over micro-states:\n1858: \n1859: $$\n1860: \\tilde{\\mathbb{P}}_{\\text{scutoid}}(\\tilde{z}' \\mid \\tilde{z}) = \\frac{1}{\\mu_{\\text{scutoid}}^{QSD}(\\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z}))} \\sum_{z \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z})} \\sum_{z' \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z}')} \\mathbb{P}_{\\text{scutoid}}(z' \\mid z) \\cdot \\mu_{\\text{scutoid}}^{QSD}(z)\n1861: \n1862: $$\n1863: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-scutoid-aggregation-closure",
      "title": "Scutoid Aggregation Approximate Computational Closure",
      "start_line": 1865,
      "end_line": 1900,
      "header_lines": [
        1866
      ],
      "content_start": 1868,
      "content_end": 1899,
      "content": "1868: :label: thm-scutoid-aggregation-closure\n1869: \n1870: For the scutoid renormalization map $\\mathcal{R}_{\\text{scutoid},b}$ (Definition {prf:ref}`def-scutoid-renormalization-map`) and scutoid Markov chain transition kernel $\\mathbb{P}_{\\text{scutoid}}$ (Definition {prf:ref}`def-scutoid-markov-chain`), the following holds:\n1871: \n1872: **\u03b5-Computational Closure:** The macro-scutoid \u03b5-machine (on super-scutoids $\\tilde{\\mathcal{S}}_\\alpha$) is an **approximate coarse-graining** of the micro-scutoid \u03b5-machine if the partition induced by $\\mathcal{R}_{\\text{scutoid},b}$ is **\u03b5-lumpable** with respect to $\\mathbb{P}_{\\text{scutoid}}$.\n1873: \n1874: **Quantitative error bound:** Under the sufficient conditions of Proposition {prf:ref}`prop-scutoid-lumpability-sufficient`, the lumpability error satisfies:\n1875: \n1876: $$\n1877: \\varepsilon_{\\text{lump}}(b, \\xi, d) \\le C_1 \\cdot e^{-b/\\xi} + C_2 \\cdot b^{-d/2}\n1878: \n1879: $$\n1880: \n1881: where:\n1882: - $C_1 = C_{\\text{loc}} \\cdot C_{\\text{mix}} \\cdot |\\tilde{\\Omega}_{\\text{scutoid}}|$ comes from spatial locality (exponential decay of correlations)\n1883: - $C_2 = C_{\\text{var}}^{1/2} \\cdot C_{\\text{mix}}$ comes from block independence (central limit theorem fluctuations)\n1884: - $\\xi$ is the correlation length from Lemma {prf:ref}`lem-local-lsi-spatial-decay`\n1885: \n1886: **Interpretation:** As block size $b \\to \\infty$, both error terms vanish:\n1887: - Exponential decay: $e^{-b/\\xi} \\to 0$ (spatial locality enforces independence)\n1888: - Power-law decay: $b^{-d/2} \\to 0$ (law of large numbers averages out fluctuations)\n1889: \n1890: For practical block sizes $b \\sim 5\\xi$ in $d = 3$, the error is $\\varepsilon_{\\text{lump}} \\lesssim 10^{-2}$ (1% lumpability error).\n1891: \n1892: **Connection to Computational Closure:** The \u03b5-lumpability condition ensures that the macro-scutoid transition kernel $\\tilde{\\mathbb{P}}_{\\text{scutoid}}$ is **approximately compatible** with the projection $\\mathcal{R}_{\\text{scutoid},b}$, meaning:\n1893: \n1894: $$\n1895: \\mathcal{R}_{\\text{scutoid},b} \\circ \\mathbb{P}_{\\text{scutoid}} \\approx \\tilde{\\mathbb{P}}_{\\text{scutoid}} \\circ \\mathcal{R}_{\\text{scutoid},b}\n1896: \n1897: $$\n1898: \n1899: with error controlled by $\\varepsilon_{\\text{lump}}$. This is the **commutative diagram** condition for computational closure, relaxed to \u03b5-closeness.",
      "metadata": {
        "label": "thm-scutoid-aggregation-closure"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [
        "def-scutoid-renormalization-map",
        "def-scutoid-markov-chain",
        "prop-scutoid-lumpability-sufficient",
        "lem-local-lsi-spatial-decay"
      ],
      "raw_directive": "1865: :::\n1866: \n1867: :::{prf:theorem} Scutoid Aggregation Approximate Computational Closure\n1868: :label: thm-scutoid-aggregation-closure\n1869: \n1870: For the scutoid renormalization map $\\mathcal{R}_{\\text{scutoid},b}$ (Definition {prf:ref}`def-scutoid-renormalization-map`) and scutoid Markov chain transition kernel $\\mathbb{P}_{\\text{scutoid}}$ (Definition {prf:ref}`def-scutoid-markov-chain`), the following holds:\n1871: \n1872: **\u03b5-Computational Closure:** The macro-scutoid \u03b5-machine (on super-scutoids $\\tilde{\\mathcal{S}}_\\alpha$) is an **approximate coarse-graining** of the micro-scutoid \u03b5-machine if the partition induced by $\\mathcal{R}_{\\text{scutoid},b}$ is **\u03b5-lumpable** with respect to $\\mathbb{P}_{\\text{scutoid}}$.\n1873: \n1874: **Quantitative error bound:** Under the sufficient conditions of Proposition {prf:ref}`prop-scutoid-lumpability-sufficient`, the lumpability error satisfies:\n1875: \n1876: $$\n1877: \\varepsilon_{\\text{lump}}(b, \\xi, d) \\le C_1 \\cdot e^{-b/\\xi} + C_2 \\cdot b^{-d/2}\n1878: \n1879: $$\n1880: \n1881: where:\n1882: - $C_1 = C_{\\text{loc}} \\cdot C_{\\text{mix}} \\cdot |\\tilde{\\Omega}_{\\text{scutoid}}|$ comes from spatial locality (exponential decay of correlations)\n1883: - $C_2 = C_{\\text{var}}^{1/2} \\cdot C_{\\text{mix}}$ comes from block independence (central limit theorem fluctuations)\n1884: - $\\xi$ is the correlation length from Lemma {prf:ref}`lem-local-lsi-spatial-decay`\n1885: \n1886: **Interpretation:** As block size $b \\to \\infty$, both error terms vanish:\n1887: - Exponential decay: $e^{-b/\\xi} \\to 0$ (spatial locality enforces independence)\n1888: - Power-law decay: $b^{-d/2} \\to 0$ (law of large numbers averages out fluctuations)\n1889: \n1890: For practical block sizes $b \\sim 5\\xi$ in $d = 3$, the error is $\\varepsilon_{\\text{lump}} \\lesssim 10^{-2}$ (1% lumpability error).\n1891: \n1892: **Connection to Computational Closure:** The \u03b5-lumpability condition ensures that the macro-scutoid transition kernel $\\tilde{\\mathbb{P}}_{\\text{scutoid}}$ is **approximately compatible** with the projection $\\mathcal{R}_{\\text{scutoid},b}$, meaning:\n1893: \n1894: $$\n1895: \\mathcal{R}_{\\text{scutoid},b} \\circ \\mathbb{P}_{\\text{scutoid}} \\approx \\tilde{\\mathbb{P}}_{\\text{scutoid}} \\circ \\mathcal{R}_{\\text{scutoid},b}\n1896: \n1897: $$\n1898: \n1899: with error controlled by $\\varepsilon_{\\text{lump}}$. This is the **commutative diagram** condition for computational closure, relaxed to \u03b5-closeness.\n1900: "
    },
    {
      "directive_type": "proposition",
      "label": "prop-scutoid-lumpability-sufficient",
      "title": "Quantitative \u03b5-Lumpability Bound for Scutoid Aggregation",
      "start_line": 1902,
      "end_line": 1946,
      "header_lines": [
        1903
      ],
      "content_start": 1905,
      "content_end": 1945,
      "content": "1905: :label: prop-scutoid-lumpability-sufficient\n1906: \n1907: Under the following conditions, the scutoid aggregation partition is **\u03b5-lumpable** with explicit error bound:\n1908: \n1909: **Condition 1 (Spatial Locality):** The BAOAB kernel has exponential spatial decay:\n1910: \n1911: $$\n1912: \\left| \\frac{\\partial \\mathbb{P}_{\\text{BAOAB}}}{\\partial x_j}(x_i) \\right| \\le C_{\\text{loc}} e^{-\\|x_i - x_j\\|/\\xi}\n1913: \n1914: $$\n1915: \n1916: where $\\xi$ is the correlation length from Lemma {prf:ref}`lem-local-lsi-spatial-decay` in [10_kl_convergence.md](../10_kl_convergence/10_kl_convergence.md).\n1917: \n1918: **Condition 2 (Finite Block Variance):** For block size $b$, the number of scutoids per block $n_\\alpha$ has bounded variance:\n1919: \n1920: $$\n1921: \\text{Var}(n_\\alpha) \\le C_{\\text{var}} \\cdot b^d\n1922: \n1923: $$\n1924: \n1925: **Condition 3 (QSD Regularity):** The QSD $\\mu_{\\text{scutoid}}^{QSD}$ satisfies a **local mixing condition** within blocks:\n1926: \n1927: $$\n1928: \\sup_{z_1, z_2 \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z})} \\frac{\\mu_{\\text{scutoid}}^{QSD}(z_1)}{\\mu_{\\text{scutoid}}^{QSD}(z_2)} \\le C_{\\text{mix}}\n1929: \n1930: $$\n1931: \n1932: **Quantitative lumpability error:** Under these conditions, the lumpability error satisfies:\n1933: \n1934: $$\n1935: \\varepsilon_{\\text{lump}}(b, \\xi, d) \\le C_1 \\cdot e^{-b/\\xi} + C_2 \\cdot b^{-d/2}\n1936: \n1937: $$\n1938: \n1939: where:\n1940: - $C_1 = 2 C_{\\text{loc}} \\cdot C_{\\text{mix}} \\cdot |\\tilde{\\Omega}_{\\text{scutoid}}|$ (from spatial locality)\n1941: - $C_2 = C_{\\text{var}}^{1/2} \\cdot C_{\\text{mix}}$ (from central limit theorem)\n1942: \n1943: **Interpretation:**\n1944: - **Exponential term** $e^{-b/\\xi}$: For blocks separated by $b \\gg \\xi$, inter-block transitions are exponentially suppressed, so intra-block dynamics dominate.\n1945: - **Power-law term** $b^{-d/2}$: For large blocks with $n_\\alpha \\sim b^d$ scutoids, aggregate properties fluctuate as $\\sim 1/\\sqrt{n_\\alpha} \\sim b^{-d/2}$ by central limit theorem.",
      "metadata": {
        "label": "prop-scutoid-lumpability-sufficient"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [
        "lem-local-lsi-spatial-decay"
      ],
      "raw_directive": "1902: :::\n1903: \n1904: :::{prf:proposition} Quantitative \u03b5-Lumpability Bound for Scutoid Aggregation\n1905: :label: prop-scutoid-lumpability-sufficient\n1906: \n1907: Under the following conditions, the scutoid aggregation partition is **\u03b5-lumpable** with explicit error bound:\n1908: \n1909: **Condition 1 (Spatial Locality):** The BAOAB kernel has exponential spatial decay:\n1910: \n1911: $$\n1912: \\left| \\frac{\\partial \\mathbb{P}_{\\text{BAOAB}}}{\\partial x_j}(x_i) \\right| \\le C_{\\text{loc}} e^{-\\|x_i - x_j\\|/\\xi}\n1913: \n1914: $$\n1915: \n1916: where $\\xi$ is the correlation length from Lemma {prf:ref}`lem-local-lsi-spatial-decay` in [10_kl_convergence.md](../10_kl_convergence/10_kl_convergence.md).\n1917: \n1918: **Condition 2 (Finite Block Variance):** For block size $b$, the number of scutoids per block $n_\\alpha$ has bounded variance:\n1919: \n1920: $$\n1921: \\text{Var}(n_\\alpha) \\le C_{\\text{var}} \\cdot b^d\n1922: \n1923: $$\n1924: \n1925: **Condition 3 (QSD Regularity):** The QSD $\\mu_{\\text{scutoid}}^{QSD}$ satisfies a **local mixing condition** within blocks:\n1926: \n1927: $$\n1928: \\sup_{z_1, z_2 \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z})} \\frac{\\mu_{\\text{scutoid}}^{QSD}(z_1)}{\\mu_{\\text{scutoid}}^{QSD}(z_2)} \\le C_{\\text{mix}}\n1929: \n1930: $$\n1931: \n1932: **Quantitative lumpability error:** Under these conditions, the lumpability error satisfies:\n1933: \n1934: $$\n1935: \\varepsilon_{\\text{lump}}(b, \\xi, d) \\le C_1 \\cdot e^{-b/\\xi} + C_2 \\cdot b^{-d/2}\n1936: \n1937: $$\n1938: \n1939: where:\n1940: - $C_1 = 2 C_{\\text{loc}} \\cdot C_{\\text{mix}} \\cdot |\\tilde{\\Omega}_{\\text{scutoid}}|$ (from spatial locality)\n1941: - $C_2 = C_{\\text{var}}^{1/2} \\cdot C_{\\text{mix}}$ (from central limit theorem)\n1942: \n1943: **Interpretation:**\n1944: - **Exponential term** $e^{-b/\\xi}$: For blocks separated by $b \\gg \\xi$, inter-block transitions are exponentially suppressed, so intra-block dynamics dominate.\n1945: - **Power-law term** $b^{-d/2}$: For large blocks with $n_\\alpha \\sim b^d$ scutoids, aggregate properties fluctuate as $\\sim 1/\\sqrt{n_\\alpha} \\sim b^{-d/2}$ by central limit theorem.\n1946: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-268",
      "title": null,
      "start_line": 1948,
      "end_line": 2005,
      "header_lines": [],
      "content_start": 1950,
      "content_end": 2004,
      "content": "1950: :::{prf:proof}\n1951: \n1952: We derive the \u03b5-lumpability error bound by decomposing it into spatial locality and block fluctuation contributions.\n1953: \n1954: **Step 1 (Decomposition):** For micro-scutoid states $z, z_0 \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z})$, decompose the deviation from lumpability:\n1955: \n1956: $$\n1957: \\begin{align*}\n1958: &\\left| \\sum_{z' \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z}')} \\mathbb{P}_{\\text{scutoid}}(z' \\mid z) - \\tilde{\\mathbb{P}}_{\\text{scutoid}}(\\tilde{z}' \\mid \\tilde{z}) \\right| \\\\\n1959: &\\le \\underbrace{\\left| \\sum_{z'} [\\mathbb{P}_{\\text{scutoid}}(z' \\mid z) - \\mathbb{P}_{\\text{scutoid}}(z' \\mid z_0)] \\right|}_{\\text{Term A: Spatial locality}} + \\underbrace{\\left| \\sum_{z'} \\mathbb{P}_{\\text{scutoid}}(z' \\mid z_0) - \\tilde{\\mathbb{P}}_{\\text{scutoid}}(\\tilde{z}' \\mid \\tilde{z}) \\right|}_{\\text{Term B: QSD averaging}}\n1960: \\end{align*}\n1961: \n1962: $$\n1963: \n1964: **Step 2 (Bound Term A - Spatial Locality):** For $z, z_0$ in the same block $B_\\alpha$ with size $ba$, all scutoid centers are within distance $\\lesssim ba$ of each other. By Condition 1 (exponential decay), the transition probability difference is bounded by:\n1965: \n1966: $$\n1967: \\left| \\mathbb{P}_{\\text{scutoid}}(z' \\mid z) - \\mathbb{P}_{\\text{scutoid}}(z' \\mid z_0) \\right| \\le C_{\\text{loc}} e^{-ba/\\xi} = C_{\\text{loc}} e^{-b/\\xi}\n1968: \n1969: $$\n1970: \n1971: where we used the fact that the lattice spacing $a$ is the natural length scale. Summing over all $z' \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z}')$ and all possible $\\tilde{z}'$:\n1972: \n1973: $$\n1974: \\text{Term A} \\le C_{\\text{loc}} |\\tilde{\\Omega}_{\\text{scutoid}}| e^{-b/\\xi}\n1975: \n1976: $$\n1977: \n1978: **Step 3 (Bound Term B - QSD Averaging):** Fix a reference state $z_0 \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z})$. The macro-kernel is defined as:\n1979: \n1980: $$\n1981: \\tilde{\\mathbb{P}}_{\\text{scutoid}}(\\tilde{z}' \\mid \\tilde{z}) = \\frac{1}{\\mu_{\\text{scutoid}}^{QSD}(\\mathcal{R}^{-1}(\\tilde{z}))} \\sum_{z \\in \\mathcal{R}^{-1}(\\tilde{z})} \\mu_{\\text{scutoid}}^{QSD}(z) \\sum_{z' \\in \\mathcal{R}^{-1}(\\tilde{z}')} \\mathbb{P}_{\\text{scutoid}}(z' \\mid z)\n1982: \n1983: $$\n1984: \n1985: By Condition 3 (QSD regularity), the weights $\\mu_{\\text{scutoid}}^{QSD}(z)/\\mu_{\\text{scutoid}}^{QSD}(\\mathcal{R}^{-1}(\\tilde{z}))$ are approximately uniform with ratio bounded by $C_{\\text{mix}}$. The deviation from uniformity contributes:\n1986: \n1987: $$\n1988: \\text{Term B} \\le C_{\\text{mix}} \\cdot \\frac{1}{\\sqrt{n_\\alpha}}\n1989: \n1990: $$\n1991: \n1992: where $n_\\alpha \\sim b^d$ is the expected number of scutoids per block (by Condition 2 and Poisson/CLT fluctuations). Using $\\text{Var}(n_\\alpha) \\le C_{\\text{var}} b^d$, the standard deviation is $\\sigma_{n_\\alpha} \\sim b^{d/2}$, giving:\n1993: \n1994: $$\n1995: \\text{Term B} \\le C_2 \\cdot b^{-d/2}, \\quad C_2 = C_{\\text{var}}^{1/2} \\cdot C_{\\text{mix}}\n1996: \n1997: $$\n1998: \n1999: **Step 4 (Combine):** Adding Terms A and B:\n2000: \n2001: $$\n2002: \\varepsilon_{\\text{lump}}(b, \\xi, d) \\le C_1 \\cdot e^{-b/\\xi} + C_2 \\cdot b^{-d/2}\n2003: \n2004: $$",
      "metadata": {},
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [],
      "raw_directive": "1948: :::\n1949: \n1950: :::{prf:proof}\n1951: \n1952: We derive the \u03b5-lumpability error bound by decomposing it into spatial locality and block fluctuation contributions.\n1953: \n1954: **Step 1 (Decomposition):** For micro-scutoid states $z, z_0 \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z})$, decompose the deviation from lumpability:\n1955: \n1956: $$\n1957: \\begin{align*}\n1958: &\\left| \\sum_{z' \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z}')} \\mathbb{P}_{\\text{scutoid}}(z' \\mid z) - \\tilde{\\mathbb{P}}_{\\text{scutoid}}(\\tilde{z}' \\mid \\tilde{z}) \\right| \\\\\n1959: &\\le \\underbrace{\\left| \\sum_{z'} [\\mathbb{P}_{\\text{scutoid}}(z' \\mid z) - \\mathbb{P}_{\\text{scutoid}}(z' \\mid z_0)] \\right|}_{\\text{Term A: Spatial locality}} + \\underbrace{\\left| \\sum_{z'} \\mathbb{P}_{\\text{scutoid}}(z' \\mid z_0) - \\tilde{\\mathbb{P}}_{\\text{scutoid}}(\\tilde{z}' \\mid \\tilde{z}) \\right|}_{\\text{Term B: QSD averaging}}\n1960: \\end{align*}\n1961: \n1962: $$\n1963: \n1964: **Step 2 (Bound Term A - Spatial Locality):** For $z, z_0$ in the same block $B_\\alpha$ with size $ba$, all scutoid centers are within distance $\\lesssim ba$ of each other. By Condition 1 (exponential decay), the transition probability difference is bounded by:\n1965: \n1966: $$\n1967: \\left| \\mathbb{P}_{\\text{scutoid}}(z' \\mid z) - \\mathbb{P}_{\\text{scutoid}}(z' \\mid z_0) \\right| \\le C_{\\text{loc}} e^{-ba/\\xi} = C_{\\text{loc}} e^{-b/\\xi}\n1968: \n1969: $$\n1970: \n1971: where we used the fact that the lattice spacing $a$ is the natural length scale. Summing over all $z' \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z}')$ and all possible $\\tilde{z}'$:\n1972: \n1973: $$\n1974: \\text{Term A} \\le C_{\\text{loc}} |\\tilde{\\Omega}_{\\text{scutoid}}| e^{-b/\\xi}\n1975: \n1976: $$\n1977: \n1978: **Step 3 (Bound Term B - QSD Averaging):** Fix a reference state $z_0 \\in \\mathcal{R}_{\\text{scutoid},b}^{-1}(\\tilde{z})$. The macro-kernel is defined as:\n1979: \n1980: $$\n1981: \\tilde{\\mathbb{P}}_{\\text{scutoid}}(\\tilde{z}' \\mid \\tilde{z}) = \\frac{1}{\\mu_{\\text{scutoid}}^{QSD}(\\mathcal{R}^{-1}(\\tilde{z}))} \\sum_{z \\in \\mathcal{R}^{-1}(\\tilde{z})} \\mu_{\\text{scutoid}}^{QSD}(z) \\sum_{z' \\in \\mathcal{R}^{-1}(\\tilde{z}')} \\mathbb{P}_{\\text{scutoid}}(z' \\mid z)\n1982: \n1983: $$\n1984: \n1985: By Condition 3 (QSD regularity), the weights $\\mu_{\\text{scutoid}}^{QSD}(z)/\\mu_{\\text{scutoid}}^{QSD}(\\mathcal{R}^{-1}(\\tilde{z}))$ are approximately uniform with ratio bounded by $C_{\\text{mix}}$. The deviation from uniformity contributes:\n1986: \n1987: $$\n1988: \\text{Term B} \\le C_{\\text{mix}} \\cdot \\frac{1}{\\sqrt{n_\\alpha}}\n1989: \n1990: $$\n1991: \n1992: where $n_\\alpha \\sim b^d$ is the expected number of scutoids per block (by Condition 2 and Poisson/CLT fluctuations). Using $\\text{Var}(n_\\alpha) \\le C_{\\text{var}} b^d$, the standard deviation is $\\sigma_{n_\\alpha} \\sim b^{d/2}$, giving:\n1993: \n1994: $$\n1995: \\text{Term B} \\le C_2 \\cdot b^{-d/2}, \\quad C_2 = C_{\\text{var}}^{1/2} \\cdot C_{\\text{mix}}\n1996: \n1997: $$\n1998: \n1999: **Step 4 (Combine):** Adding Terms A and B:\n2000: \n2001: $$\n2002: \\varepsilon_{\\text{lump}}(b, \\xi, d) \\le C_1 \\cdot e^{-b/\\xi} + C_2 \\cdot b^{-d/2}\n2003: \n2004: $$\n2005: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-scutoid-observable-preservation",
      "title": "Scutoid Observable Preservation with \u03b5-Lumpability Error",
      "start_line": 2009,
      "end_line": 2056,
      "header_lines": [
        2010
      ],
      "content_start": 2012,
      "content_end": 2055,
      "content": "2012: :label: thm-scutoid-observable-preservation\n2013: \n2014: Let $\\mathcal{O}: \\Omega_{\\text{scutoid}} \\to \\mathbb{R}$ be a **coarse-grainable scutoid observable**, defined as a function of aggregate properties:\n2015: \n2016: $$\n2017: \\mathcal{O}(z) = \\mathcal{O}_{\\text{coarse}}(\\text{Vol}_\\alpha, \\tilde{K}_\\alpha, \\tilde{\\phi}_\\alpha, \\ldots)\n2018: \n2019: $$\n2020: \n2021: Examples:\n2022: - **Total scutoid volume:** $\\mathcal{O}_{\\text{vol}} = \\sum_\\alpha \\text{Vol}(\\tilde{\\mathcal{S}}_\\alpha)$\n2023: - **Average curvature:** $\\mathcal{O}_{\\text{curv}} = \\frac{1}{M} \\sum_\\alpha \\tilde{K}_\\alpha$\n2024: - **Scutoid fraction:** $\\mathcal{O}_{\\text{frac}} = \\frac{1}{M} \\sum_\\alpha \\tilde{\\phi}_\\alpha$\n2025: - **Topological charge density:** $\\mathcal{O}_{\\text{topo}} = \\frac{1}{\\text{Vol}(\\mathcal{M})} \\sum_\\alpha \\tilde{\\chi}_\\alpha$\n2026: \n2027: **Observable error bound:** If the scutoid aggregation is \u03b5-lumpable (Definition {prf:ref}`def-epsilon-lumpability-scutoid`) with error $\\varepsilon_{\\text{lump}}(b, \\xi, d)$, and $\\mathcal{O}$ is Lipschitz continuous with constant $L_{\\mathcal{O}}$, then:\n2028: \n2029: $$\n2030: \\left| \\mathbb{E}_{\\mu_{\\text{scutoid}}^{QSD}}[\\mathcal{O}] - \\mathbb{E}_{\\tilde{\\mu}_{\\text{scutoid}}^{QSD}}[\\mathcal{O}_{\\text{coarse}}] \\right| \\le L_{\\mathcal{O}} \\cdot \\varepsilon_{\\text{lump}}(b, \\xi, d) + O(\\varepsilon_{\\text{lump}}^2)\n2031: \n2032: $$\n2033: \n2034: **Explicit bound:** Using Theorem {prf:ref}`thm-scutoid-aggregation-closure`, this becomes:\n2035: \n2036: $$\n2037: \\left| \\mathbb{E}_{\\mu_{\\text{scutoid}}^{QSD}}[\\mathcal{O}] - \\mathbb{E}_{\\tilde{\\mu}_{\\text{scutoid}}^{QSD}}[\\mathcal{O}_{\\text{coarse}}] \\right| \\le L_{\\mathcal{O}} \\left( C_1 e^{-b/\\xi} + C_2 b^{-d/2} \\right) + O(\\varepsilon_{\\text{lump}}^2)\n2038: \n2039: $$\n2040: \n2041: **Interpretation:** Observable errors inherit the exponential + power-law decay structure from \u03b5-lumpability, weighted by the observable's Lipschitz constant. Smooth observables (small $L_{\\mathcal{O}}$) are better preserved than discontinuous ones.\n2042: \n2043: **Proof:** The \u03b5-lumpability condition implies that the macro-transition kernel $\\tilde{\\mathbb{P}}_{\\text{scutoid}}$ is close to the quotient kernel. By the ergodic theorem for Markov chains, the stationary measures $\\mu_{\\text{scutoid}}^{QSD}$ and $\\tilde{\\mu}_{\\text{scutoid}}^{QSD}$ satisfy:\n2044: \n2045: $$\n2046: \\|\\mu_{\\text{scutoid}}^{QSD} - \\mathcal{R}_{\\text{scutoid},b}^* \\tilde{\\mu}_{\\text{scutoid}}^{QSD}\\|_{TV} \\le \\text{const} \\cdot \\varepsilon_{\\text{lump}}\n2047: \n2048: $$\n2049: \n2050: where the constant depends on the mixing time of the scutoid Markov chain. For Lipschitz observables:\n2051: \n2052: $$\n2053: |\\mathbb{E}_{\\mu}[\\mathcal{O}] - \\mathbb{E}_{\\nu}[\\mathcal{O}]| \\le L_{\\mathcal{O}} \\cdot \\|\\mu - \\nu\\|_{TV}\n2054: \n2055: $$",
      "metadata": {
        "label": "thm-scutoid-observable-preservation"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [
        "def-epsilon-lumpability-scutoid",
        "thm-scutoid-aggregation-closure"
      ],
      "raw_directive": "2009: ### 10.5. Observable Preservation and Computational Efficiency\n2010: \n2011: :::{prf:theorem} Scutoid Observable Preservation with \u03b5-Lumpability Error\n2012: :label: thm-scutoid-observable-preservation\n2013: \n2014: Let $\\mathcal{O}: \\Omega_{\\text{scutoid}} \\to \\mathbb{R}$ be a **coarse-grainable scutoid observable**, defined as a function of aggregate properties:\n2015: \n2016: $$\n2017: \\mathcal{O}(z) = \\mathcal{O}_{\\text{coarse}}(\\text{Vol}_\\alpha, \\tilde{K}_\\alpha, \\tilde{\\phi}_\\alpha, \\ldots)\n2018: \n2019: $$\n2020: \n2021: Examples:\n2022: - **Total scutoid volume:** $\\mathcal{O}_{\\text{vol}} = \\sum_\\alpha \\text{Vol}(\\tilde{\\mathcal{S}}_\\alpha)$\n2023: - **Average curvature:** $\\mathcal{O}_{\\text{curv}} = \\frac{1}{M} \\sum_\\alpha \\tilde{K}_\\alpha$\n2024: - **Scutoid fraction:** $\\mathcal{O}_{\\text{frac}} = \\frac{1}{M} \\sum_\\alpha \\tilde{\\phi}_\\alpha$\n2025: - **Topological charge density:** $\\mathcal{O}_{\\text{topo}} = \\frac{1}{\\text{Vol}(\\mathcal{M})} \\sum_\\alpha \\tilde{\\chi}_\\alpha$\n2026: \n2027: **Observable error bound:** If the scutoid aggregation is \u03b5-lumpable (Definition {prf:ref}`def-epsilon-lumpability-scutoid`) with error $\\varepsilon_{\\text{lump}}(b, \\xi, d)$, and $\\mathcal{O}$ is Lipschitz continuous with constant $L_{\\mathcal{O}}$, then:\n2028: \n2029: $$\n2030: \\left| \\mathbb{E}_{\\mu_{\\text{scutoid}}^{QSD}}[\\mathcal{O}] - \\mathbb{E}_{\\tilde{\\mu}_{\\text{scutoid}}^{QSD}}[\\mathcal{O}_{\\text{coarse}}] \\right| \\le L_{\\mathcal{O}} \\cdot \\varepsilon_{\\text{lump}}(b, \\xi, d) + O(\\varepsilon_{\\text{lump}}^2)\n2031: \n2032: $$\n2033: \n2034: **Explicit bound:** Using Theorem {prf:ref}`thm-scutoid-aggregation-closure`, this becomes:\n2035: \n2036: $$\n2037: \\left| \\mathbb{E}_{\\mu_{\\text{scutoid}}^{QSD}}[\\mathcal{O}] - \\mathbb{E}_{\\tilde{\\mu}_{\\text{scutoid}}^{QSD}}[\\mathcal{O}_{\\text{coarse}}] \\right| \\le L_{\\mathcal{O}} \\left( C_1 e^{-b/\\xi} + C_2 b^{-d/2} \\right) + O(\\varepsilon_{\\text{lump}}^2)\n2038: \n2039: $$\n2040: \n2041: **Interpretation:** Observable errors inherit the exponential + power-law decay structure from \u03b5-lumpability, weighted by the observable's Lipschitz constant. Smooth observables (small $L_{\\mathcal{O}}$) are better preserved than discontinuous ones.\n2042: \n2043: **Proof:** The \u03b5-lumpability condition implies that the macro-transition kernel $\\tilde{\\mathbb{P}}_{\\text{scutoid}}$ is close to the quotient kernel. By the ergodic theorem for Markov chains, the stationary measures $\\mu_{\\text{scutoid}}^{QSD}$ and $\\tilde{\\mu}_{\\text{scutoid}}^{QSD}$ satisfy:\n2044: \n2045: $$\n2046: \\|\\mu_{\\text{scutoid}}^{QSD} - \\mathcal{R}_{\\text{scutoid},b}^* \\tilde{\\mu}_{\\text{scutoid}}^{QSD}\\|_{TV} \\le \\text{const} \\cdot \\varepsilon_{\\text{lump}}\n2047: \n2048: $$\n2049: \n2050: where the constant depends on the mixing time of the scutoid Markov chain. For Lipschitz observables:\n2051: \n2052: $$\n2053: |\\mathbb{E}_{\\mu}[\\mathcal{O}] - \\mathbb{E}_{\\nu}[\\mathcal{O}]| \\le L_{\\mathcal{O}} \\cdot \\|\\mu - \\nu\\|_{TV}\n2054: \n2055: $$\n2056: "
    },
    {
      "directive_type": "corollary",
      "label": "cor-scutoid-computational-speedup",
      "title": "Computational Speedup from Scutoid Aggregation",
      "start_line": 2058,
      "end_line": 2083,
      "header_lines": [
        2059
      ],
      "content_start": 2061,
      "content_end": 2082,
      "content": "2061: :label: cor-scutoid-computational-speedup\n2062: \n2063: For a Fractal Gas simulation with $N$ walkers, $T/\\Delta t$ timesteps, and spatial dimension $d$:\n2064: \n2065: **Micro-scutoid tessellation:**\n2066: - Number of cells: $O(N \\cdot T/\\Delta t)$\n2067: - Storage: $O(N \\cdot T/\\Delta t \\cdot d)$ (storing vertices, faces, curvatures)\n2068: - Observable computation: $O(N \\cdot T/\\Delta t \\cdot P)$ where $P$ is observable complexity\n2069: \n2070: **Macro-scutoid tessellation** (block size $b$):\n2071: - Number of super-scutoids: $O(M \\cdot T/\\Delta t)$ where $M = (L/ba)^d$ is number of blocks\n2072: - Storage: $O(M \\cdot T/\\Delta t \\cdot d)$\n2073: - Observable computation: $O(M \\cdot T/\\Delta t \\cdot P)$\n2074: \n2075: **Speedup factor:**\n2076: \n2077: $$\n2078: \\text{Speedup} = \\frac{N}{M} = \\frac{N \\cdot (ba)^d}{L^d} = \\frac{N}{(L/ba)^d} \\sim b^d\n2079: \n2080: $$\n2081: \n2082: For $b = 4$ and $d = 3$: **64\u00d7 speedup** in storage and computation.",
      "metadata": {
        "label": "cor-scutoid-computational-speedup"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [
        "thm-scutoid-observable-preservation"
      ],
      "raw_directive": "2058: :::\n2059: \n2060: :::{prf:corollary} Computational Speedup from Scutoid Aggregation\n2061: :label: cor-scutoid-computational-speedup\n2062: \n2063: For a Fractal Gas simulation with $N$ walkers, $T/\\Delta t$ timesteps, and spatial dimension $d$:\n2064: \n2065: **Micro-scutoid tessellation:**\n2066: - Number of cells: $O(N \\cdot T/\\Delta t)$\n2067: - Storage: $O(N \\cdot T/\\Delta t \\cdot d)$ (storing vertices, faces, curvatures)\n2068: - Observable computation: $O(N \\cdot T/\\Delta t \\cdot P)$ where $P$ is observable complexity\n2069: \n2070: **Macro-scutoid tessellation** (block size $b$):\n2071: - Number of super-scutoids: $O(M \\cdot T/\\Delta t)$ where $M = (L/ba)^d$ is number of blocks\n2072: - Storage: $O(M \\cdot T/\\Delta t \\cdot d)$\n2073: - Observable computation: $O(M \\cdot T/\\Delta t \\cdot P)$\n2074: \n2075: **Speedup factor:**\n2076: \n2077: $$\n2078: \\text{Speedup} = \\frac{N}{M} = \\frac{N \\cdot (ba)^d}{L^d} = \\frac{N}{(L/ba)^d} \\sim b^d\n2079: \n2080: $$\n2081: \n2082: For $b = 4$ and $d = 3$: **64\u00d7 speedup** in storage and computation.\n2083: "
    },
    {
      "directive_type": "example",
      "label": "ex-scutoid-phase-transition",
      "title": "Scutoid Phase Transition Detection",
      "start_line": 2085,
      "end_line": 2130,
      "header_lines": [
        2086
      ],
      "content_start": 2088,
      "content_end": 2129,
      "content": "2088: :label: ex-scutoid-phase-transition\n2089: \n2090: **Problem:** Detect exploration vs. exploitation phase transitions in a long Fractal Gas run using the scutoid fraction $\\phi(t)$ as an order parameter (\u00a7 6.4 of [14_scutoid_geometry_framework.md](14_scutoid_geometry_framework.md)).\n2091: \n2092: **Setup:** Consider a 3D system ($d = 3$) with:\n2093: - Number of walkers: $N = 10^4$\n2094: - Spatial domain size: $L = 100a$ (where $a$ is the micro-lattice spacing)\n2095: - Total timesteps: $T/\\Delta t = 10^6$\n2096: - Correlation length: $\\xi \\sim 5a$\n2097: \n2098: **Naive approach:** Construct full scutoid tessellation at every timestep, compute $\\phi(t) = \\frac{1}{N} \\sum_i \\mathbb{1}[\\text{scutoid}]_i$.\n2099: - Cost: $O(N \\cdot T/\\Delta t)$ scutoid constructions\n2100: - Total cells to track: $N \\cdot T/\\Delta t = 10^4 \\times 10^6 = 10^{10}$ cells\n2101: \n2102: **Closure-based approach:** Use block aggregation with block size $b = 8$:\n2103: - Number of blocks: $M = (L/(ba))^d = (100/(8 \\cdot 1))^3 = 12.5^3 \\approx 1953$ blocks\n2104: - Compute block scutoid fractions $\\tilde{\\phi}_\\alpha(t)$ for each of the $M$ blocks\n2105: - Estimate global fraction: $\\phi(t) \\approx \\frac{1}{M} \\sum_\\alpha \\tilde{\\phi}_\\alpha(t)$\n2106: - Total super-scutoids to track: $M \\cdot T/\\Delta t \\approx 1953 \\times 10^6 \\approx 2 \\times 10^9$\n2107: - **Speedup:** $\\frac{N}{M} = \\frac{10^4}{1953} \\approx 5.1 \\times$ per timestep\n2108: - **Storage reduction:** $\\frac{10^{10}}{2 \\times 10^9} = 5 \\times$ overall\n2109: \n2110: **Alternative with larger blocks** ($b = 16$):\n2111: - Number of blocks: $M = (100/16)^3 = 6.25^3 \\approx 244$ blocks\n2112: - Total super-scutoids: $244 \\times 10^6 \\approx 2.4 \\times 10^8$\n2113: - **Speedup:** $\\frac{10^4}{244} \\approx 41 \\times$ per timestep\n2114: - **Storage reduction:** $\\frac{10^{10}}{2.4 \\times 10^8} \\approx 42 \\times$ overall\n2115: \n2116: **Error bound:** By Theorem {prf:ref}`thm-scutoid-aggregation-closure` (\u03b5-lumpability), the error is:\n2117: \n2118: $$\n2119: |\\phi(t) - \\tilde{\\phi}(t)| \\le C_1 e^{-b/\\xi} + C_2 b^{-d/2} + \\frac{C_3}{\\sqrt{M}}\n2120: \n2121: $$\n2122: \n2123: For $b = 16$, $\\xi = 5a$, $M = 244$, $d = 3$:\n2124: - Spatial locality error: $e^{-16/5} = e^{-3.2} \\approx 0.04$ (4%)\n2125: - Block fluctuation error: $16^{-3/2} = 1/64 \\approx 0.016$ (1.6%)\n2126: - Sampling error: $1/\\sqrt{244} \\approx 0.064$ (6.4%)\n2127: - **Total error:** $\\lesssim 12\\%$\n2128: \n2129: **Result:** **42\u00d7 speedup with ~12% error**\u2014acceptable for phase transition detection where we care about qualitative changes (e.g., $\\phi: 0.1 \\to 0.9$), not precise values.",
      "metadata": {
        "label": "ex-scutoid-phase-transition"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [
        "thm-scutoid-aggregation-closure"
      ],
      "raw_directive": "2085: :::\n2086: \n2087: :::{prf:example} Scutoid Phase Transition Detection\n2088: :label: ex-scutoid-phase-transition\n2089: \n2090: **Problem:** Detect exploration vs. exploitation phase transitions in a long Fractal Gas run using the scutoid fraction $\\phi(t)$ as an order parameter (\u00a7 6.4 of [14_scutoid_geometry_framework.md](14_scutoid_geometry_framework.md)).\n2091: \n2092: **Setup:** Consider a 3D system ($d = 3$) with:\n2093: - Number of walkers: $N = 10^4$\n2094: - Spatial domain size: $L = 100a$ (where $a$ is the micro-lattice spacing)\n2095: - Total timesteps: $T/\\Delta t = 10^6$\n2096: - Correlation length: $\\xi \\sim 5a$\n2097: \n2098: **Naive approach:** Construct full scutoid tessellation at every timestep, compute $\\phi(t) = \\frac{1}{N} \\sum_i \\mathbb{1}[\\text{scutoid}]_i$.\n2099: - Cost: $O(N \\cdot T/\\Delta t)$ scutoid constructions\n2100: - Total cells to track: $N \\cdot T/\\Delta t = 10^4 \\times 10^6 = 10^{10}$ cells\n2101: \n2102: **Closure-based approach:** Use block aggregation with block size $b = 8$:\n2103: - Number of blocks: $M = (L/(ba))^d = (100/(8 \\cdot 1))^3 = 12.5^3 \\approx 1953$ blocks\n2104: - Compute block scutoid fractions $\\tilde{\\phi}_\\alpha(t)$ for each of the $M$ blocks\n2105: - Estimate global fraction: $\\phi(t) \\approx \\frac{1}{M} \\sum_\\alpha \\tilde{\\phi}_\\alpha(t)$\n2106: - Total super-scutoids to track: $M \\cdot T/\\Delta t \\approx 1953 \\times 10^6 \\approx 2 \\times 10^9$\n2107: - **Speedup:** $\\frac{N}{M} = \\frac{10^4}{1953} \\approx 5.1 \\times$ per timestep\n2108: - **Storage reduction:** $\\frac{10^{10}}{2 \\times 10^9} = 5 \\times$ overall\n2109: \n2110: **Alternative with larger blocks** ($b = 16$):\n2111: - Number of blocks: $M = (100/16)^3 = 6.25^3 \\approx 244$ blocks\n2112: - Total super-scutoids: $244 \\times 10^6 \\approx 2.4 \\times 10^8$\n2113: - **Speedup:** $\\frac{10^4}{244} \\approx 41 \\times$ per timestep\n2114: - **Storage reduction:** $\\frac{10^{10}}{2.4 \\times 10^8} \\approx 42 \\times$ overall\n2115: \n2116: **Error bound:** By Theorem {prf:ref}`thm-scutoid-aggregation-closure` (\u03b5-lumpability), the error is:\n2117: \n2118: $$\n2119: |\\phi(t) - \\tilde{\\phi}(t)| \\le C_1 e^{-b/\\xi} + C_2 b^{-d/2} + \\frac{C_3}{\\sqrt{M}}\n2120: \n2121: $$\n2122: \n2123: For $b = 16$, $\\xi = 5a$, $M = 244$, $d = 3$:\n2124: - Spatial locality error: $e^{-16/5} = e^{-3.2} \\approx 0.04$ (4%)\n2125: - Block fluctuation error: $16^{-3/2} = 1/64 \\approx 0.016$ (1.6%)\n2126: - Sampling error: $1/\\sqrt{244} \\approx 0.064$ (6.4%)\n2127: - **Total error:** $\\lesssim 12\\%$\n2128: \n2129: **Result:** **42\u00d7 speedup with ~12% error**\u2014acceptable for phase transition detection where we care about qualitative changes (e.g., $\\phi: 0.1 \\to 0.9$), not precise values.\n2130: "
    },
    {
      "directive_type": "algorithm",
      "label": "alg-hierarchical-scutoid-aggregation",
      "title": "Hierarchical Scutoid Aggregation",
      "start_line": 2134,
      "end_line": 2182,
      "header_lines": [
        2135
      ],
      "content_start": 2137,
      "content_end": 2181,
      "content": "2137: :label: alg-hierarchical-scutoid-aggregation\n2138: \n2139: **Input:**\n2140: - Algorithmic log $\\mathcal{L}$ with episode data\n2141: - Target block size $b$ (aggregation factor)\n2142: - Observables to compute $\\{\\mathcal{O}_k\\}$\n2143: \n2144: **Output:**\n2145: - Macro-scutoid tessellation $\\tilde{\\mathcal{T}}$\n2146: - Observable time series $\\{\\mathcal{O}_k(t)\\}$\n2147: \n2148: **Procedure:**\n2149: \n2150: **1. Initialize spatial grid:**\n2151: - Partition domain $\\mathcal{X}$ into blocks $\\{B_\\alpha\\}_{\\alpha=1}^M$ with size $ba$\n2152: - Create block index: map each position $x \\in \\mathcal{X}$ to block $\\alpha(x)$\n2153: \n2154: **2. For each timestep** $t \\in \\{0, \\Delta t, 2\\Delta t, \\ldots, T\\}$:\n2155:    - **2a.** Compute Voronoi tessellation at micro-scale (Algorithm {prf:ref}`alg-scutoid-construction`)\n2156:    - **2b.** For each alive walker $i \\in \\mathcal{A}(t)$:\n2157:      - Compute center-of-mass $\\text{CoM}(\\mathcal{S}_{i,t})$ (can use approximation: walker position $x_i$)\n2158:      - Assign to block: $\\alpha_i = \\alpha(\\text{CoM}(\\mathcal{S}_{i,t}))$\n2159:    - **2c.** For each block $\\alpha$:\n2160:      - Aggregate scutoids: $\\mathbb{S}_\\alpha(t) = \\{\\mathcal{S}_{i,t} : \\alpha_i = \\alpha\\}$\n2161:      - Compute aggregate properties:\n2162:        - $\\text{Vol}(\\tilde{\\mathcal{S}}_\\alpha) = \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\text{Vol}(\\mathcal{S}_{i,t})$\n2163:        - $\\tilde{K}_\\alpha = \\frac{1}{|\\mathbb{S}_\\alpha(t)|} \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\langle K_{\\Sigma}^i \\rangle$\n2164:        - $\\tilde{\\phi}_\\alpha = \\frac{1}{|\\mathbb{S}_\\alpha(t)|} \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\mathbb{1}[\\text{scutoid}]_i$\n2165:        - $\\tilde{\\chi}_\\alpha = \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\chi_{\\text{scutoid}}^i$\n2166:    - **2d.** Store macro-scutoid configuration $\\tilde{Z}_{\\text{scutoid}}(t)$\n2167: \n2168: **3. Compute observables:**\n2169:    - For each observable $\\mathcal{O}_k$:\n2170:      - Evaluate $\\mathcal{O}_k(t) = \\mathcal{O}_{k,\\text{coarse}}(\\{\\tilde{\\mathcal{S}}_\\alpha(t)\\}_{\\alpha=1}^M)$\n2171:    - Store time series\n2172: \n2173: **4. Optional: Multi-scale hierarchy:**\n2174:    - Repeat steps 1-3 with larger block sizes $b_1 < b_2 < b_3 < \\ldots$\n2175:    - Compare observables across scales to verify convergence and closure\n2176: \n2177: **Complexity:**\n2178: - **Step 2a:** $O(N d \\log N)$ per timestep (Voronoi tessellation)\n2179: - **Step 2b-c:** $O(N)$ per timestep (linear scan and aggregation)\n2180: - **Step 3:** $O(M \\cdot P)$ per timestep ($M$ blocks, $P$ is observable cost)\n2181: - **Total:** $O((T/\\Delta t) \\cdot (N d \\log N + M P))$",
      "metadata": {
        "label": "alg-hierarchical-scutoid-aggregation"
      },
      "section": "## 10. Application: Scutoid Coarse-Graining via Computational Closure",
      "references": [
        "alg-scutoid-construction"
      ],
      "raw_directive": "2134: ### 10.6. Algorithm: Efficient Scutoid Aggregation\n2135: \n2136: :::{prf:algorithm} Hierarchical Scutoid Aggregation\n2137: :label: alg-hierarchical-scutoid-aggregation\n2138: \n2139: **Input:**\n2140: - Algorithmic log $\\mathcal{L}$ with episode data\n2141: - Target block size $b$ (aggregation factor)\n2142: - Observables to compute $\\{\\mathcal{O}_k\\}$\n2143: \n2144: **Output:**\n2145: - Macro-scutoid tessellation $\\tilde{\\mathcal{T}}$\n2146: - Observable time series $\\{\\mathcal{O}_k(t)\\}$\n2147: \n2148: **Procedure:**\n2149: \n2150: **1. Initialize spatial grid:**\n2151: - Partition domain $\\mathcal{X}$ into blocks $\\{B_\\alpha\\}_{\\alpha=1}^M$ with size $ba$\n2152: - Create block index: map each position $x \\in \\mathcal{X}$ to block $\\alpha(x)$\n2153: \n2154: **2. For each timestep** $t \\in \\{0, \\Delta t, 2\\Delta t, \\ldots, T\\}$:\n2155:    - **2a.** Compute Voronoi tessellation at micro-scale (Algorithm {prf:ref}`alg-scutoid-construction`)\n2156:    - **2b.** For each alive walker $i \\in \\mathcal{A}(t)$:\n2157:      - Compute center-of-mass $\\text{CoM}(\\mathcal{S}_{i,t})$ (can use approximation: walker position $x_i$)\n2158:      - Assign to block: $\\alpha_i = \\alpha(\\text{CoM}(\\mathcal{S}_{i,t}))$\n2159:    - **2c.** For each block $\\alpha$:\n2160:      - Aggregate scutoids: $\\mathbb{S}_\\alpha(t) = \\{\\mathcal{S}_{i,t} : \\alpha_i = \\alpha\\}$\n2161:      - Compute aggregate properties:\n2162:        - $\\text{Vol}(\\tilde{\\mathcal{S}}_\\alpha) = \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\text{Vol}(\\mathcal{S}_{i,t})$\n2163:        - $\\tilde{K}_\\alpha = \\frac{1}{|\\mathbb{S}_\\alpha(t)|} \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\langle K_{\\Sigma}^i \\rangle$\n2164:        - $\\tilde{\\phi}_\\alpha = \\frac{1}{|\\mathbb{S}_\\alpha(t)|} \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\mathbb{1}[\\text{scutoid}]_i$\n2165:        - $\\tilde{\\chi}_\\alpha = \\sum_{i \\in \\mathbb{S}_\\alpha(t)} \\chi_{\\text{scutoid}}^i$\n2166:    - **2d.** Store macro-scutoid configuration $\\tilde{Z}_{\\text{scutoid}}(t)$\n2167: \n2168: **3. Compute observables:**\n2169:    - For each observable $\\mathcal{O}_k$:\n2170:      - Evaluate $\\mathcal{O}_k(t) = \\mathcal{O}_{k,\\text{coarse}}(\\{\\tilde{\\mathcal{S}}_\\alpha(t)\\}_{\\alpha=1}^M)$\n2171:    - Store time series\n2172: \n2173: **4. Optional: Multi-scale hierarchy:**\n2174:    - Repeat steps 1-3 with larger block sizes $b_1 < b_2 < b_3 < \\ldots$\n2175:    - Compare observables across scales to verify convergence and closure\n2176: \n2177: **Complexity:**\n2178: - **Step 2a:** $O(N d \\log N)$ per timestep (Voronoi tessellation)\n2179: - **Step 2b-c:** $O(N)$ per timestep (linear scan and aggregation)\n2180: - **Step 3:** $O(M \\cdot P)$ per timestep ($M$ blocks, $P$ is observable cost)\n2181: - **Total:** $O((T/\\Delta t) \\cdot (N d \\log N + M P))$\n2182: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}