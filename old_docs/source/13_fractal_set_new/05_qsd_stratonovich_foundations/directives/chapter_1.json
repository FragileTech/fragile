{
  "chapter_index": 1,
  "section_id": "## 2. Stratonovich Langevin Dynamics",
  "directive_count": 2,
  "hints": [
    {
      "directive_type": "definition",
      "label": "def-adaptive-gas-stratonovich-sde",
      "title": "Adaptive Gas Langevin SDE (Stratonovich Form)",
      "start_line": 89,
      "end_line": 119,
      "header_lines": [
        90
      ],
      "content_start": 92,
      "content_end": 118,
      "content": "92: :label: def-adaptive-gas-stratonovich-sde\n93: \n94: From {prf:ref}`def-adaptive-sde` in {doc}`../07_adaptative_gas.md`, the Adaptive Gas dynamics on phase space $(x, v) \\in \\mathcal{X} \\times \\mathbb{R}^d$ is:\n95: \n96: $$\n97: \\begin{aligned}\n98: dx_i &= v_i \\, dt \\\\\n99: dv_i &= F_{\\text{total}}(x_i, \\mathcal{S}_t) \\, dt - \\gamma v_i \\, dt + \\Sigma_{\\text{reg}}(x_i) \\circ dW_i\n100: \\end{aligned}\n101: $$\n102: \n103: where:\n104: \n105: **Drift terms:**\n106: - $F_{\\text{total}}(x, \\mathcal{S}) = F_{\\text{conf}}(x) + F_{\\text{adap}}(x, \\mathcal{S})$ is the total force\n107: - $F_{\\text{conf}}(x) = -\\nabla U(x)$ from confining potential\n108: - $F_{\\text{adap}}(x, \\mathcal{S}) = \\epsilon_F \\nabla V_{\\text{fit}}[f_k, \\rho](x)$ from adaptive mean-field fitness potential\n109: - Combined: $F_{\\text{total}} = -\\nabla U_{\\text{eff}}$ where $U_{\\text{eff}}(x) = U(x) - \\epsilon_F V_{\\text{fit}}(x)$\n110: - $\\gamma v_i$ is friction (Stokes drag)\n111: \n112: **Diffusion term:**\n113: - $\\Sigma_{\\text{reg}}(x) = (H(x) + \\epsilon_\\Sigma I)^{-1/2}$ is the **regularized Hessian square root**\n114: - $H(x) = -\\nabla^2 \\Phi(x)$ is the negative fitness Hessian\n115: - $\\epsilon_\\Sigma > 0$ is regularization ensuring positive definiteness\n116: - **Metric:** $g(x) = \\Sigma_{\\text{reg}}^{-2}(x) = H(x) + \\epsilon_\\Sigma I$\n117: \n118: **Critical notation:** The **$\\circ dW_i$** denotes **Stratonovich stochastic integral**, not It\u00f4.",
      "metadata": {
        "label": "def-adaptive-gas-stratonovich-sde"
      },
      "section": "## 2. Stratonovich Langevin Dynamics",
      "raw_directive": "89: ### 2.1. Primary Formulation from Chapter 07\n90: \n91: :::{prf:definition} Adaptive Gas Langevin SDE (Stratonovich Form)\n92: :label: def-adaptive-gas-stratonovich-sde\n93: \n94: From {prf:ref}`def-adaptive-sde` in {doc}`../07_adaptative_gas.md`, the Adaptive Gas dynamics on phase space $(x, v) \\in \\mathcal{X} \\times \\mathbb{R}^d$ is:\n95: \n96: $$\n97: \\begin{aligned}\n98: dx_i &= v_i \\, dt \\\\\n99: dv_i &= F_{\\text{total}}(x_i, \\mathcal{S}_t) \\, dt - \\gamma v_i \\, dt + \\Sigma_{\\text{reg}}(x_i) \\circ dW_i\n100: \\end{aligned}\n101: $$\n102: \n103: where:\n104: \n105: **Drift terms:**\n106: - $F_{\\text{total}}(x, \\mathcal{S}) = F_{\\text{conf}}(x) + F_{\\text{adap}}(x, \\mathcal{S})$ is the total force\n107: - $F_{\\text{conf}}(x) = -\\nabla U(x)$ from confining potential\n108: - $F_{\\text{adap}}(x, \\mathcal{S}) = \\epsilon_F \\nabla V_{\\text{fit}}[f_k, \\rho](x)$ from adaptive mean-field fitness potential\n109: - Combined: $F_{\\text{total}} = -\\nabla U_{\\text{eff}}$ where $U_{\\text{eff}}(x) = U(x) - \\epsilon_F V_{\\text{fit}}(x)$\n110: - $\\gamma v_i$ is friction (Stokes drag)\n111: \n112: **Diffusion term:**\n113: - $\\Sigma_{\\text{reg}}(x) = (H(x) + \\epsilon_\\Sigma I)^{-1/2}$ is the **regularized Hessian square root**\n114: - $H(x) = -\\nabla^2 \\Phi(x)$ is the negative fitness Hessian\n115: - $\\epsilon_\\Sigma > 0$ is regularization ensuring positive definiteness\n116: - **Metric:** $g(x) = \\Sigma_{\\text{reg}}^{-2}(x) = H(x) + \\epsilon_\\Sigma I$\n117: \n118: **Critical notation:** The **$\\circ dW_i$** denotes **Stratonovich stochastic integral**, not It\u00f4.\n119: "
    },
    {
      "directive_type": "remark",
      "label": "rem-why-stratonovich-adaptive-gas",
      "title": "Physical Justification for Stratonovich Interpretation",
      "start_line": 123,
      "end_line": 164,
      "header_lines": [
        124
      ],
      "content_start": 126,
      "content_end": 163,
      "content": "126: :label: rem-why-stratonovich-adaptive-gas\n127: \n128: The Adaptive Gas uses Stratonovich (not It\u00f4) interpretation for **three fundamental reasons**:\n129: \n130: **1. Physical origin of state-dependent diffusion (Wong-Zakai theorem)**\n131: \n132: The position-dependent diffusion $\\Sigma_{\\text{reg}}(x)$ arises from **fast microscopic degrees of freedom** that are non-Markovian at small timescales. The Wong-Zakai theorem (1965) states:\n133: \n134: *If a deterministic system driven by smooth colored noise converges to white noise in the limit $\\tau_{\\text{corr}} \\to 0$, the limiting SDE is Stratonovich, not It\u00f4.*\n135: \n136: In our case: The regularized Hessian diffusion represents anisotropic thermal fluctuations from \"integrated-out\" fast variables (molecular collisions, sub-timestep dynamics). This naturally gives Stratonovich.\n137: \n138: **2. Geometric invariance (coordinate freedom)**\n139: \n140: The algorithm must give **coordinate-independent** results - the physics shouldn't depend on our choice of coordinates $x \\in \\mathcal{X}$.\n141: \n142: - **Stratonovich:** Transforms covariantly under coordinate changes (geometrically natural)\n143: - **It\u00f4:** Requires correction terms when changing coordinates\n144: \n145: Since the emergent geometry is **intrinsic** to the fitness landscape, Stratonovich is the correct choice.\n146: \n147: **3. Thermodynamic consistency (detailed balance and volume measure)**\n148: \n149: The stationary distribution of an equilibrium system must be the **Gibbs measure with respect to the natural volume element**:\n150: \n151: $$\n152: d\\mu = \\frac{1}{Z} e^{-\\beta H} dV\n153: $$\n154: \n155: where $dV$ is the **correct volume measure** on the configuration space.\n156: \n157: - **Stratonovich:** Automatically gives $dV = \\sqrt{\\det g} \\, dx$ (Riemannian volume)\n158: - **It\u00f4:** Would give $dV = dx$ (Euclidean/Lebesgue volume), which is **coordinate-dependent** and **thermodynamically inconsistent** for curved manifolds\n159: \n160: **Conclusion:** Stratonovich is not a choice - it's the **physically correct** interpretation for the Adaptive Gas.\n161: \n162: **References:**\n163: - Wong, E. & Zakai, M. (1965) \"On the convergence of ordinary integrals to stochastic integrals\", *Ann. Math. Statist.*",
      "metadata": {
        "label": "rem-why-stratonovich-adaptive-gas"
      },
      "section": "## 2. Stratonovich Langevin Dynamics",
      "raw_directive": "123: ### 2.2. Why Stratonovich is Physically Correct\n124: \n125: :::{prf:remark} Physical Justification for Stratonovich Interpretation\n126: :label: rem-why-stratonovich-adaptive-gas\n127: \n128: The Adaptive Gas uses Stratonovich (not It\u00f4) interpretation for **three fundamental reasons**:\n129: \n130: **1. Physical origin of state-dependent diffusion (Wong-Zakai theorem)**\n131: \n132: The position-dependent diffusion $\\Sigma_{\\text{reg}}(x)$ arises from **fast microscopic degrees of freedom** that are non-Markovian at small timescales. The Wong-Zakai theorem (1965) states:\n133: \n134: *If a deterministic system driven by smooth colored noise converges to white noise in the limit $\\tau_{\\text{corr}} \\to 0$, the limiting SDE is Stratonovich, not It\u00f4.*\n135: \n136: In our case: The regularized Hessian diffusion represents anisotropic thermal fluctuations from \"integrated-out\" fast variables (molecular collisions, sub-timestep dynamics). This naturally gives Stratonovich.\n137: \n138: **2. Geometric invariance (coordinate freedom)**\n139: \n140: The algorithm must give **coordinate-independent** results - the physics shouldn't depend on our choice of coordinates $x \\in \\mathcal{X}$.\n141: \n142: - **Stratonovich:** Transforms covariantly under coordinate changes (geometrically natural)\n143: - **It\u00f4:** Requires correction terms when changing coordinates\n144: \n145: Since the emergent geometry is **intrinsic** to the fitness landscape, Stratonovich is the correct choice.\n146: \n147: **3. Thermodynamic consistency (detailed balance and volume measure)**\n148: \n149: The stationary distribution of an equilibrium system must be the **Gibbs measure with respect to the natural volume element**:\n150: \n151: $$\n152: d\\mu = \\frac{1}{Z} e^{-\\beta H} dV\n153: $$\n154: \n155: where $dV$ is the **correct volume measure** on the configuration space.\n156: \n157: - **Stratonovich:** Automatically gives $dV = \\sqrt{\\det g} \\, dx$ (Riemannian volume)\n158: - **It\u00f4:** Would give $dV = dx$ (Euclidean/Lebesgue volume), which is **coordinate-dependent** and **thermodynamically inconsistent** for curved manifolds\n159: \n160: **Conclusion:** Stratonovich is not a choice - it's the **physically correct** interpretation for the Adaptive Gas.\n161: \n162: **References:**\n163: - Wong, E. & Zakai, M. (1965) \"On the convergence of ordinary integrals to stochastic integrals\", *Ann. Math. Statist.*\n164: - Klimontovich, Y.L. (1990) \"Ito, Stratonovich and kinetic forms of stochastic equations\", *Physica A*"
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}