{
  "chapter_index": 5,
  "section_id": "## 6. Consequences for Graph Laplacian Convergence",
  "directive_count": 2,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-graph-laplacian-convergence-consequence",
      "title": "Graph Laplacian Converges to Laplace-Beltrami",
      "start_line": 586,
      "end_line": 618,
      "header_lines": [
        587
      ],
      "content_start": 589,
      "content_end": 617,
      "content": "589: :label: thm-graph-laplacian-convergence-consequence\n590: \n591: Let episodes $\\{x_i\\}_{i=1}^N$ be sampled from $\\rho_{\\text{spatial}}(x) \\propto \\sqrt{\\det g(x)} e^{-U_{\\text{eff}}/T}$ (Theorem {prf:ref}`thm-qsd-spatial-marginal-detailed`).\n592: \n593: Define the **companion-weighted graph Laplacian**:\n594: \n595: $$\n596: (\\Delta_{\\text{graph}} f)(x_i) = \\frac{1}{d_i} \\sum_{j: \\text{IG neighbor}} w_{ij} \\frac{f(x_j) - f(x_i)}{\\|x_j - x_i\\|^2}\n597: $$\n598: \n599: where $w_{ij}$ are IG edge weights and $d_i = \\sum_j w_{ij}$ is weighted degree.\n600: \n601: Then as $N \\to \\infty$:\n602: \n603: $$\n604: \\frac{1}{N} \\sum_{i=1}^N (\\Delta_{\\text{graph}} f)(x_i) \\xrightarrow{p} C \\int_{\\mathcal{X}} (\\Delta_g f)(x) \\, \\rho_{\\text{spatial}}(x) \\, dx\n605: $$\n606: \n607: where $\\Delta_g$ is the **Laplace-Beltrami operator** on the Riemannian manifold $(\\mathcal{X}, g)$:\n608: \n609: $$\n610: \\Delta_g f = \\frac{1}{\\sqrt{\\det g}} \\partial_i \\left( \\sqrt{\\det g} \\, g^{ij} \\partial_j f \\right)\n611: $$\n612: \n613: **Convergence rate:** With probability $\\geq 1 - \\delta$:\n614: \n615: $$\n616: \\left| \\frac{1}{N} \\sum_i \\Delta_{\\text{graph}} f(x_i) - C \\int \\Delta_g f \\, \\rho \\, dx \\right| \\leq O(N^{-1/4} \\log(1/\\delta))\n617: $$",
      "metadata": {
        "label": "thm-graph-laplacian-convergence-consequence"
      },
      "section": "## 6. Consequences for Graph Laplacian Convergence",
      "references": [
        "thm-qsd-spatial-marginal-detailed"
      ],
      "raw_directive": "586: ### 6.1. Belkin-Niyogi Theorem Application\n587: \n588: :::{prf:theorem} Graph Laplacian Converges to Laplace-Beltrami\n589: :label: thm-graph-laplacian-convergence-consequence\n590: \n591: Let episodes $\\{x_i\\}_{i=1}^N$ be sampled from $\\rho_{\\text{spatial}}(x) \\propto \\sqrt{\\det g(x)} e^{-U_{\\text{eff}}/T}$ (Theorem {prf:ref}`thm-qsd-spatial-marginal-detailed`).\n592: \n593: Define the **companion-weighted graph Laplacian**:\n594: \n595: $$\n596: (\\Delta_{\\text{graph}} f)(x_i) = \\frac{1}{d_i} \\sum_{j: \\text{IG neighbor}} w_{ij} \\frac{f(x_j) - f(x_i)}{\\|x_j - x_i\\|^2}\n597: $$\n598: \n599: where $w_{ij}$ are IG edge weights and $d_i = \\sum_j w_{ij}$ is weighted degree.\n600: \n601: Then as $N \\to \\infty$:\n602: \n603: $$\n604: \\frac{1}{N} \\sum_{i=1}^N (\\Delta_{\\text{graph}} f)(x_i) \\xrightarrow{p} C \\int_{\\mathcal{X}} (\\Delta_g f)(x) \\, \\rho_{\\text{spatial}}(x) \\, dx\n605: $$\n606: \n607: where $\\Delta_g$ is the **Laplace-Beltrami operator** on the Riemannian manifold $(\\mathcal{X}, g)$:\n608: \n609: $$\n610: \\Delta_g f = \\frac{1}{\\sqrt{\\det g}} \\partial_i \\left( \\sqrt{\\det g} \\, g^{ij} \\partial_j f \\right)\n611: $$\n612: \n613: **Convergence rate:** With probability $\\geq 1 - \\delta$:\n614: \n615: $$\n616: \\left| \\frac{1}{N} \\sum_i \\Delta_{\\text{graph}} f(x_i) - C \\int \\Delta_g f \\, \\rho \\, dx \\right| \\leq O(N^{-1/4} \\log(1/\\delta))\n617: $$\n618: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-37",
      "title": null,
      "start_line": 620,
      "end_line": 744,
      "header_lines": [],
      "content_start": 621,
      "content_end": 743,
      "content": "621: \n622: :::{prf:proof}\n623: **Step 1: Sampling density is key**\n624: \n625: The Belkin-Niyogi theorem states that for a graph constructed from points sampled with density $\\rho(x)$ and Gaussian kernel $w_{ij} = \\exp(-\\|x_i - x_j\\|^2 / \\epsilon^2)$:\n626: \n627: $$\n628: \\Delta_{\\text{graph}} \\to C \\left( \\Delta_{\\rho} + \\text{lower order} \\right)\n629: $$\n630: \n631: where $\\Delta_{\\rho}$ is the **weighted Laplacian** on the manifold:\n632: \n633: $$\n634: \\Delta_{\\rho} f = \\frac{1}{\\rho} \\nabla \\cdot (\\rho \\nabla f)\n635: $$\n636: \n637: **Step 2: Explicit Relation Between Weighted Laplacian and Laplace-Beltrami**\n638: \n639: For sampling density $\\rho = \\sqrt{\\det g} \\, \\psi$ where $\\psi = e^{-U_{\\text{eff}}/T}$, we establish the precise relationship between the weighted Laplacian $\\Delta_{\\rho}$ and the Laplace-Beltrami operator $\\Delta_g$.\n640: \n641: **Known result from Belkin-Niyogi:** For points sampled from density $\\rho(x)$, the graph Laplacian converges to:\n642: \n643: $$\n644: \\Delta_{\\rho} f = \\frac{1}{\\rho} \\nabla \\cdot (\\rho \\nabla f) = \\Delta f + \\nabla (\\log \\rho) \\cdot \\nabla f\n645: $$\n646: \n647: where $\\Delta f = \\sum_i \\partial_i^2 f$ is the Euclidean Laplacian and $\\nabla$ denotes the Euclidean gradient.\n648: \n649: **Sub-step 2.1: Substitute the sampling density**\n650: \n651: With $\\rho = \\sqrt{\\det g} \\, \\psi$:\n652: \n653: $$\n654: \\log \\rho = \\frac{1}{2} \\log \\det g + \\log \\psi = \\frac{1}{2} \\log \\det g - \\frac{U_{\\text{eff}}}{T} + \\text{const}\n655: $$\n656: \n657: Taking the gradient:\n658: \n659: $$\n660: \\nabla (\\log \\rho) = \\frac{1}{2} \\nabla (\\log \\det g) - \\frac{1}{T} \\nabla U_{\\text{eff}}\n661: $$\n662: \n663: **Sub-step 2.2: Exact geometric identity relating weighted and Laplace-Beltrami**\n664: \n665: The relationship between the weighted Laplacian and the Laplace-Beltrami operator is given by the **exact geometric identity**:\n666: \n667: $$\n668: \\Delta_{\\rho} f = \\Delta_g f + \\langle \\nabla_g \\log(\\rho / \\sqrt{\\det g}), \\nabla_g f \\rangle_g\n669: $$\n670: \n671: where:\n672: - $\\Delta_g$ is the Laplace-Beltrami operator on the Riemannian manifold $(M, g)$\n673: - $\\nabla_g$ is the Riemannian gradient (related to Euclidean gradient by $\\nabla_g f = g^{-1} \\nabla f$)\n674: - $\\langle \\cdot, \\cdot \\rangle_g$ is the Riemannian inner product: $\\langle u, v \\rangle_g = u^T g v$\n675: \n676: This is a standard result in Riemannian geometry (see Lee, *Riemannian Manifolds*, Proposition 6.13).\n677: \n678: **Sub-step 2.3: Apply to our specific density**\n679: \n680: For our sampling density $\\rho = \\sqrt{\\det g} \\, \\psi$ where $\\psi = e^{-U_{\\text{eff}}/T}$:\n681: \n682: $$\n683: \\log \\left(\\frac{\\rho}{\\sqrt{\\det g}}\\right) = \\log \\psi = -\\frac{U_{\\text{eff}}}{T} + \\text{const}\n684: $$\n685: \n686: Taking the Riemannian gradient:\n687: \n688: $$\n689: \\nabla_g \\log(\\rho / \\sqrt{\\det g}) = \\nabla_g \\left(-\\frac{U_{\\text{eff}}}{T}\\right) = -\\frac{1}{T} \\nabla_g U_{\\text{eff}}\n690: $$\n691: \n692: where $\\nabla_g U_{\\text{eff}} = g^{-1} \\nabla U_{\\text{eff}}$ is the **covariant gradient**.\n693: \n694: **Substitute into the geometric identity:**\n695: \n696: $$\n697: \\Delta_{\\rho} f = \\Delta_g f + \\left\\langle -\\frac{1}{T} \\nabla_g U_{\\text{eff}}, \\nabla_g f \\right\\rangle_g\n698: $$\n699: \n700: $$\n701: = \\Delta_g f - \\frac{1}{T} \\left\\langle \\nabla_g U_{\\text{eff}}, \\nabla_g f \\right\\rangle_g\n702: $$\n703: \n704: Using the definition of Riemannian inner product:\n705: \n706: $$\n707: \\left\\langle \\nabla_g U_{\\text{eff}}, \\nabla_g f \\right\\rangle_g = (g^{-1} \\nabla U_{\\text{eff}})^T g (g^{-1} \\nabla f) = \\nabla U_{\\text{eff}}^T g^{-1} \\nabla f\n708: $$\n709: \n710: Therefore:\n711: \n712: $$\n713: \\boxed{\\Delta_{\\rho} f = \\Delta_g f - \\frac{1}{T} \\nabla U_{\\text{eff}}^T g^{-1} \\nabla f}\n714: $$\n715: \n716: **Key result:** This is an **exact identity** with no approximations or error terms.\n717: \n718: **Key insight:** The weighted Laplacian equals the Laplace-Beltrami operator **plus a potential gradient term**:\n719: \n720: $$\n721: \\Delta_{\\rho} f = \\Delta_g f + V_{\\text{potential}} \\cdot \\nabla f\n722: $$\n723: \n724: where $V_{\\text{potential}} = -(1/T) \\nabla U_{\\text{eff}}$.\n725: \n726: **Physical interpretation:**\n727: - The $\\sqrt{\\det g}$ factor in $\\rho$ contributes the Laplace-Beltrami operator $\\Delta_g$\n728: - The $\\psi = e^{-U_{\\text{eff}}/T}$ factor contributes a first-order potential term\n729: - This is analogous to a **Schr\u00f6dinger operator** with geometric kinetic term plus potential\n730: \n731: **Step 3: Integration against $\\rho$ dx gives Laplace-Beltrami**\n732: \n733: When we integrate both sides against test functions:\n734: \n735: $$\n736: \\int \\Delta_{\\rho} f \\cdot \\rho \\, dx = \\int \\Delta_g f \\cdot \\sqrt{\\det g} \\, dx + O(\\epsilon)\n737: $$\n738: \n739: The right-hand side is the **natural integral** of the Laplace-Beltrami operator with respect to Riemannian volume.\n740: \n741: **Step 4: Convergence rate**\n742: \n743: The rate $O(N^{-1/4})$ comes from concentration inequalities for kernel density estimation on manifolds (see Gin\u00e9 & Koltchinskii 2006 for details).",
      "metadata": {},
      "section": "## 6. Consequences for Graph Laplacian Convergence",
      "references": [],
      "raw_directive": "620: :::\n621: \n622: :::{prf:proof}\n623: **Step 1: Sampling density is key**\n624: \n625: The Belkin-Niyogi theorem states that for a graph constructed from points sampled with density $\\rho(x)$ and Gaussian kernel $w_{ij} = \\exp(-\\|x_i - x_j\\|^2 / \\epsilon^2)$:\n626: \n627: $$\n628: \\Delta_{\\text{graph}} \\to C \\left( \\Delta_{\\rho} + \\text{lower order} \\right)\n629: $$\n630: \n631: where $\\Delta_{\\rho}$ is the **weighted Laplacian** on the manifold:\n632: \n633: $$\n634: \\Delta_{\\rho} f = \\frac{1}{\\rho} \\nabla \\cdot (\\rho \\nabla f)\n635: $$\n636: \n637: **Step 2: Explicit Relation Between Weighted Laplacian and Laplace-Beltrami**\n638: \n639: For sampling density $\\rho = \\sqrt{\\det g} \\, \\psi$ where $\\psi = e^{-U_{\\text{eff}}/T}$, we establish the precise relationship between the weighted Laplacian $\\Delta_{\\rho}$ and the Laplace-Beltrami operator $\\Delta_g$.\n640: \n641: **Known result from Belkin-Niyogi:** For points sampled from density $\\rho(x)$, the graph Laplacian converges to:\n642: \n643: $$\n644: \\Delta_{\\rho} f = \\frac{1}{\\rho} \\nabla \\cdot (\\rho \\nabla f) = \\Delta f + \\nabla (\\log \\rho) \\cdot \\nabla f\n645: $$\n646: \n647: where $\\Delta f = \\sum_i \\partial_i^2 f$ is the Euclidean Laplacian and $\\nabla$ denotes the Euclidean gradient.\n648: \n649: **Sub-step 2.1: Substitute the sampling density**\n650: \n651: With $\\rho = \\sqrt{\\det g} \\, \\psi$:\n652: \n653: $$\n654: \\log \\rho = \\frac{1}{2} \\log \\det g + \\log \\psi = \\frac{1}{2} \\log \\det g - \\frac{U_{\\text{eff}}}{T} + \\text{const}\n655: $$\n656: \n657: Taking the gradient:\n658: \n659: $$\n660: \\nabla (\\log \\rho) = \\frac{1}{2} \\nabla (\\log \\det g) - \\frac{1}{T} \\nabla U_{\\text{eff}}\n661: $$\n662: \n663: **Sub-step 2.2: Exact geometric identity relating weighted and Laplace-Beltrami**\n664: \n665: The relationship between the weighted Laplacian and the Laplace-Beltrami operator is given by the **exact geometric identity**:\n666: \n667: $$\n668: \\Delta_{\\rho} f = \\Delta_g f + \\langle \\nabla_g \\log(\\rho / \\sqrt{\\det g}), \\nabla_g f \\rangle_g\n669: $$\n670: \n671: where:\n672: - $\\Delta_g$ is the Laplace-Beltrami operator on the Riemannian manifold $(M, g)$\n673: - $\\nabla_g$ is the Riemannian gradient (related to Euclidean gradient by $\\nabla_g f = g^{-1} \\nabla f$)\n674: - $\\langle \\cdot, \\cdot \\rangle_g$ is the Riemannian inner product: $\\langle u, v \\rangle_g = u^T g v$\n675: \n676: This is a standard result in Riemannian geometry (see Lee, *Riemannian Manifolds*, Proposition 6.13).\n677: \n678: **Sub-step 2.3: Apply to our specific density**\n679: \n680: For our sampling density $\\rho = \\sqrt{\\det g} \\, \\psi$ where $\\psi = e^{-U_{\\text{eff}}/T}$:\n681: \n682: $$\n683: \\log \\left(\\frac{\\rho}{\\sqrt{\\det g}}\\right) = \\log \\psi = -\\frac{U_{\\text{eff}}}{T} + \\text{const}\n684: $$\n685: \n686: Taking the Riemannian gradient:\n687: \n688: $$\n689: \\nabla_g \\log(\\rho / \\sqrt{\\det g}) = \\nabla_g \\left(-\\frac{U_{\\text{eff}}}{T}\\right) = -\\frac{1}{T} \\nabla_g U_{\\text{eff}}\n690: $$\n691: \n692: where $\\nabla_g U_{\\text{eff}} = g^{-1} \\nabla U_{\\text{eff}}$ is the **covariant gradient**.\n693: \n694: **Substitute into the geometric identity:**\n695: \n696: $$\n697: \\Delta_{\\rho} f = \\Delta_g f + \\left\\langle -\\frac{1}{T} \\nabla_g U_{\\text{eff}}, \\nabla_g f \\right\\rangle_g\n698: $$\n699: \n700: $$\n701: = \\Delta_g f - \\frac{1}{T} \\left\\langle \\nabla_g U_{\\text{eff}}, \\nabla_g f \\right\\rangle_g\n702: $$\n703: \n704: Using the definition of Riemannian inner product:\n705: \n706: $$\n707: \\left\\langle \\nabla_g U_{\\text{eff}}, \\nabla_g f \\right\\rangle_g = (g^{-1} \\nabla U_{\\text{eff}})^T g (g^{-1} \\nabla f) = \\nabla U_{\\text{eff}}^T g^{-1} \\nabla f\n708: $$\n709: \n710: Therefore:\n711: \n712: $$\n713: \\boxed{\\Delta_{\\rho} f = \\Delta_g f - \\frac{1}{T} \\nabla U_{\\text{eff}}^T g^{-1} \\nabla f}\n714: $$\n715: \n716: **Key result:** This is an **exact identity** with no approximations or error terms.\n717: \n718: **Key insight:** The weighted Laplacian equals the Laplace-Beltrami operator **plus a potential gradient term**:\n719: \n720: $$\n721: \\Delta_{\\rho} f = \\Delta_g f + V_{\\text{potential}} \\cdot \\nabla f\n722: $$\n723: \n724: where $V_{\\text{potential}} = -(1/T) \\nabla U_{\\text{eff}}$.\n725: \n726: **Physical interpretation:**\n727: - The $\\sqrt{\\det g}$ factor in $\\rho$ contributes the Laplace-Beltrami operator $\\Delta_g$\n728: - The $\\psi = e^{-U_{\\text{eff}}/T}$ factor contributes a first-order potential term\n729: - This is analogous to a **Schr\u00f6dinger operator** with geometric kinetic term plus potential\n730: \n731: **Step 3: Integration against $\\rho$ dx gives Laplace-Beltrami**\n732: \n733: When we integrate both sides against test functions:\n734: \n735: $$\n736: \\int \\Delta_{\\rho} f \\cdot \\rho \\, dx = \\int \\Delta_g f \\cdot \\sqrt{\\det g} \\, dx + O(\\epsilon)\n737: $$\n738: \n739: The right-hand side is the **natural integral** of the Laplace-Beltrami operator with respect to Riemannian volume.\n740: \n741: **Step 4: Convergence rate**\n742: \n743: The rate $O(N^{-1/4})$ comes from concentration inequalities for kernel density estimation on manifolds (see Gin\u00e9 & Koltchinskii 2006 for details).\n744: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}