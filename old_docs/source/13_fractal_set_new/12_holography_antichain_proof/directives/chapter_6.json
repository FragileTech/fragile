{
  "chapter_index": 6,
  "section_id": "## 4. Lemma 3: Riemann Sum Convergence for Surface Integrals",
  "directive_count": 2,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-surface-riemann-sum",
      "title": "Surface Measure Convergence (Corrected)",
      "start_line": 1297,
      "end_line": 1325,
      "header_lines": [
        1298
      ],
      "content_start": 1300,
      "content_end": 1324,
      "content": "1300: :label: lem-surface-riemann-sum\n1301: \n1302: Let $\\Sigma \\subset \\mathcal{X}$ be a smooth $(d-1)$-dimensional surface embedded in $\\mathcal{X}$. Let $\\mathcal{N}_\\Sigma = \\{e_i : \\text{Vor}_i \\cap \\Sigma \\neq \\emptyset\\}$ be the set of episodes whose Voronoi cells intersect $\\Sigma$.\n1303: \n1304: At QSD, as $N \\to \\infty$:\n1305: \n1306: $$\n1307: \\lim_{N \\to \\infty} \\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}} = C_d \\int_\\Sigma \\left[\\rho_{\\text{spatial}}(x)\\right]^{(d-1)/d} \\, d\\Sigma(x)\n1308: $$\n1309: \n1310: where:\n1311: - $C_d$ is a dimension-dependent constant from geometric measure theory\n1312: - $d\\Sigma(x) = \\sqrt{\\det g_\\Sigma(x)} \\, du$ is the Riemannian surface measure\n1313: \n1314: **Error bound (dimension-dependent)**: The convergence rate depends on the spatial dimension:\n1315: \n1316: $$\n1317: \\left| \\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}} - C_d \\int_\\Sigma \\left[\\rho_{\\text{spatial}}(x)\\right]^{(d-1)/d} \\, d\\Sigma(x) \\right| = \\begin{cases}\n1318: O(N^{-(d-1)/(2d)}) = O(N^{-1/4}) & d = 2 \\\\\n1319: O(N^{-1/3}) & d = 3 \\\\\n1320: O(N^{-1/d}) & d > 3\n1321: \\end{cases}\n1322: $$\n1323: \n1324: The error bound arises from a combination of geometric discretization ($O(N^{-1/d})$) and statistical fluctuations ($O(N^{-(d-1)/(2d)})$), with the **slowest-converging** (smallest exponent) term dominating in each regime.",
      "metadata": {
        "label": "lem-surface-riemann-sum"
      },
      "section": "## 4. Lemma 3: Riemann Sum Convergence for Surface Integrals",
      "raw_directive": "1297: ## 4. Lemma 3: Riemann Sum Convergence for Surface Integrals\n1298: \n1299: :::{prf:lemma} Surface Measure Convergence (Corrected)\n1300: :label: lem-surface-riemann-sum\n1301: \n1302: Let $\\Sigma \\subset \\mathcal{X}$ be a smooth $(d-1)$-dimensional surface embedded in $\\mathcal{X}$. Let $\\mathcal{N}_\\Sigma = \\{e_i : \\text{Vor}_i \\cap \\Sigma \\neq \\emptyset\\}$ be the set of episodes whose Voronoi cells intersect $\\Sigma$.\n1303: \n1304: At QSD, as $N \\to \\infty$:\n1305: \n1306: $$\n1307: \\lim_{N \\to \\infty} \\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}} = C_d \\int_\\Sigma \\left[\\rho_{\\text{spatial}}(x)\\right]^{(d-1)/d} \\, d\\Sigma(x)\n1308: $$\n1309: \n1310: where:\n1311: - $C_d$ is a dimension-dependent constant from geometric measure theory\n1312: - $d\\Sigma(x) = \\sqrt{\\det g_\\Sigma(x)} \\, du$ is the Riemannian surface measure\n1313: \n1314: **Error bound (dimension-dependent)**: The convergence rate depends on the spatial dimension:\n1315: \n1316: $$\n1317: \\left| \\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}} - C_d \\int_\\Sigma \\left[\\rho_{\\text{spatial}}(x)\\right]^{(d-1)/d} \\, d\\Sigma(x) \\right| = \\begin{cases}\n1318: O(N^{-(d-1)/(2d)}) = O(N^{-1/4}) & d = 2 \\\\\n1319: O(N^{-1/3}) & d = 3 \\\\\n1320: O(N^{-1/d}) & d > 3\n1321: \\end{cases}\n1322: $$\n1323: \n1324: The error bound arises from a combination of geometric discretization ($O(N^{-1/d})$) and statistical fluctuations ($O(N^{-(d-1)/(2d)})$), with the **slowest-converging** (smallest exponent) term dominating in each regime.\n1325: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-31",
      "title": null,
      "start_line": 1327,
      "end_line": 1548,
      "header_lines": [],
      "content_start": 1328,
      "content_end": 1547,
      "content": "1328: \n1329: :::{prf:proof}\n1330: **Step 1: Thicken the surface**\n1331: \n1332: For small $\\delta > 0$, define the **$\\delta$-thickening** of $\\Sigma$:\n1333: \n1334: $$\n1335: \\Sigma_\\delta = \\{ x \\in \\mathcal{X} : \\text{dist}(x, \\Sigma) < \\delta \\}\n1336: $$\n1337: \n1338: This is a tube of width $2\\delta$ around $\\Sigma$.\n1339: \n1340: **Step 2: Voronoi cells intersecting $\\Sigma$ lie in $\\Sigma_\\delta$**\n1341: \n1342: From Lemma {prf:ref}`lem-voronoi-diameter-scaling`, $\\text{diam}(\\text{Vor}_i) = O(N^{-1/d})$.\n1343: \n1344: Choose $\\delta = C N^{-1/d}$ with large constant $C$. Then:\n1345: \n1346: $$\n1347: \\text{Vor}_i \\cap \\Sigma \\neq \\emptyset \\quad \\Rightarrow \\quad x_i \\in \\Sigma_{C N^{-1/d}}\n1348: $$\n1349: \n1350: **Step 3: Count walkers in thickened region**\n1351: \n1352: The number of walkers in $\\Sigma_\\delta$ is approximately:\n1353: \n1354: $$\n1355: |\\mathcal{N}_\\Sigma| \\approx N \\int_{\\Sigma_\\delta} \\rho_{\\text{spatial}}(x) \\, dx\n1356: $$\n1357: \n1358: This is a standard Riemann sum approximation (see {prf:ref}`lem-sum-to-integral-episodes` from {doc}`04_rigorous_additions.md`).\n1359: \n1360: **Step 4: Relate volume integral to surface integral**\n1361: \n1362: For small $\\delta$, parameterize $\\Sigma_\\delta$ using normal coordinates $(u, s)$ where $u$ parametrizes $\\Sigma$ and $s \\in (-\\delta, \\delta)$ is the signed distance from $\\Sigma$:\n1363: \n1364: $$\n1365: \\int_{\\Sigma_\\delta} \\rho_{\\text{spatial}}(x) \\, dx = \\int_\\Sigma \\int_{-\\delta}^\\delta \\rho_{\\text{spatial}}(u + s \\mathbf{n}(u)) \\, ds \\, d\\Sigma(u)\n1366: $$\n1367: \n1368: where $\\mathbf{n}(u)$ is the unit normal to $\\Sigma$ at $u$.\n1369: \n1370: **Step 5: Taylor expand density**\n1371: \n1372: For smooth $\\rho_{\\text{spatial}}$:\n1373: \n1374: $$\n1375: \\rho_{\\text{spatial}}(u + s \\mathbf{n}) = \\rho_{\\text{spatial}}(u) + s \\, \\nabla \\rho_{\\text{spatial}}(u) \\cdot \\mathbf{n} + O(s^2)\n1376: $$\n1377: \n1378: Integrating over $s \\in (-\\delta, \\delta)$:\n1379: \n1380: $$\n1381: \\int_{-\\delta}^\\delta \\rho_{\\text{spatial}}(u + s \\mathbf{n}) \\, ds = 2\\delta \\, \\rho_{\\text{spatial}}(u) + O(\\delta^3)\n1382: $$\n1383: \n1384: (The $O(s)$ term vanishes by symmetry.)\n1385: \n1386: **Step 6: Substitute back**\n1387: \n1388: $$\n1389: \\int_{\\Sigma_\\delta} \\rho_{\\text{spatial}}(x) \\, dx = 2\\delta \\int_\\Sigma \\rho_{\\text{spatial}}(u) \\, d\\Sigma(u) + O(\\delta^3 \\text{Area}(\\Sigma))\n1390: $$\n1391: \n1392: **Step 7: DIMENSIONAL ERROR IDENTIFIED - Correcting the approach**\n1393: \n1394: The previous derivation shows that:\n1395: \n1396: $$\n1397: |\\mathcal{N}_\\Sigma| \\approx N \\cdot 2\\delta \\int_\\Sigma \\rho_{\\text{spatial}} \\, d\\Sigma = 2C N^{1-1/d} \\int_\\Sigma \\rho_{\\text{spatial}} \\, d\\Sigma\n1398: $$\n1399: \n1400: This indicates that the correct scaling is $|\\mathcal{N}_\\Sigma| \\sim N^{(d-1)/d}$, not $N$.\n1401: \n1402: **Corrected Proof (Dimensional Analysis)**:\n1403: \n1404: **Key insight**: A $(d-1)$-dimensional surface in $d$-dimensional space intersects Voronoi cells whose linear size is $\\ell \\sim N^{-1/d}$.\n1405: \n1406: **Step 1 (Corrected): Geometric scaling**\n1407: \n1408: Consider a surface $\\Sigma$ with Riemannian area $A_g(\\Sigma)$. Voronoi cells have:\n1409: - Linear size: $\\ell \\sim N^{-1/d}$\n1410: - Volume: $V_{\\text{cell}} \\sim \\ell^d \\sim N^{-1}$\n1411: - Cross-sectional area: $A_{\\text{cell}} \\sim \\ell^{d-1} \\sim N^{-(d-1)/d}$\n1412: \n1413: **Step 2 (Corrected): Surface intersection count**\n1414: \n1415: The number of Voronoi cells intersecting $\\Sigma$ is:\n1416: \n1417: $$\n1418: |\\mathcal{N}_\\Sigma| \\sim \\frac{A_g(\\Sigma)}{A_{\\text{cell}}} \\sim A_g(\\Sigma) \\cdot N^{(d-1)/d}\n1419: $$\n1420: \n1421: **Step 3 (Corrected): Account for non-uniform density**\n1422: \n1423: When $\\rho_{\\text{spatial}}(x)$ varies, the local Voronoi cell size is:\n1424: \n1425: $$\n1426: \\ell_{\\text{local}}(x) \\sim \\left[\\rho_{\\text{spatial}}(x)\\right]^{-1/d}\n1427: $$\n1428: \n1429: Therefore, the number of cells intersecting a small patch $dA$ at position $x$ is:\n1430: \n1431: $$\n1432: dN \\sim \\frac{dA}{\\ell_{\\text{local}}^{d-1}} \\sim \\left[\\rho_{\\text{spatial}}(x)\\right]^{(d-1)/d} dA\n1433: $$\n1434: \n1435: **Step 4 (Corrected): Integrate over surface**\n1436: \n1437: $$\n1438: |\\mathcal{N}_\\Sigma| \\sim \\int_\\Sigma \\left[\\rho_{\\text{spatial}}(x)\\right]^{(d-1)/d} d\\Sigma(x) \\cdot N^{(d-1)/d}\n1439: $$\n1440: \n1441: **Corrected Final Result**:\n1442: \n1443: $$\n1444: \\lim_{N \\to \\infty} \\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}} = C_d \\int_\\Sigma \\left[\\rho_{\\text{spatial}}(x)\\right]^{(d-1)/d} \\, d\\Sigma(x)\n1445: $$\n1446: \n1447: where $C_d$ is a dimension-dependent constant from geometric measure theory.\n1448: \n1449: **Step 5 (Rigorous Error Analysis): Decomposition into geometric and statistical errors**\n1450: \n1451: The total error in approximating the surface measure consists of **two independent contributions**:\n1452: \n1453: **Part A: Geometric approximation error**\n1454: \n1455: The surface $\\Sigma$ is approximated by Voronoi cells of diameter $O(N^{-1/d})$. This discretization introduces a **geometric error**:\n1456: \n1457: $$\n1458: \\varepsilon_{\\text{geom}} = O(N^{-1/d})\n1459: $$\n1460: \n1461: **Justification**: When approximating a smooth $(d-1)$-dimensional surface by cells of linear size $\\ell = O(N^{-1/d})$, the approximation error in the surface area is $O(\\ell) = O(N^{-1/d})$ per unit area. See *Schneider & Weil, \"Stochastic and Integral Geometry\", Springer, 2008, Ch. 10*.\n1462: \n1463: **Part B: Statistical sampling error**\n1464: \n1465: Even if the geometric discretization were perfect, the random placement of walkers introduces **statistical fluctuations**. The convergence to the limit follows from the **law of large numbers for spatial point processes**.\n1466: \n1467: **Theorem (Penrose 2003, Thm 1.8)**: For a Poisson point process with intensity $N \\cdot \\rho(x)$ on a manifold $\\mathcal{M}$, and a measurable set $B \\subset \\mathcal{M}$, the number of points $N_B$ satisfies:\n1468: \n1469: $$\n1470: \\frac{N_B}{N} \\to \\int_B \\rho(x) \\, dx \\quad \\text{as } N \\to \\infty\n1471: $$\n1472: \n1473: with **variance**:\n1474: \n1475: $$\n1476: \\text{Var}(N_B) = N \\int_B \\rho(x) \\, dx = \\Theta(N)\n1477: $$\n1478: \n1479: **Application to surface intersections**: The $\\delta$-thickened surface $\\Sigma_\\delta$ with $\\delta = C N^{-1/d}$ has volume:\n1480: \n1481: $$\n1482: \\text{Vol}(\\Sigma_\\delta) = \\Theta(\\delta \\cdot \\text{Area}(\\Sigma)) = \\Theta(N^{-1/d} \\cdot N^{(d-1)/d}) = \\Theta(N^{(d-2)/d})\n1483: $$\n1484: \n1485: Therefore, the expected number of points in $\\Sigma_\\delta$ is:\n1486: \n1487: $$\n1488: \\mathbb{E}[|\\mathcal{N}_\\Sigma|] = N \\cdot \\text{Vol}(\\Sigma_\\delta) \\cdot \\rho_{\\text{avg}} = \\Theta(N^{(d-1)/d})\n1489: $$\n1490: \n1491: and the **standard deviation** is:\n1492: \n1493: $$\n1494: \\sigma(|\\mathcal{N}_\\Sigma|) = \\sqrt{\\text{Var}(|\\mathcal{N}_\\Sigma|)} = \\Theta(N^{(d-1)/(2d)})\n1495: $$\n1496: \n1497: **Concentration inequality (Berry-Esseen CLT)**: By the central limit theorem for point processes (*Penrose, \"Random Geometric Graphs\", 2003, Thm 1.12*):\n1498: \n1499: $$\n1500: \\mathbb{P}\\left(\\left|\\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}} - \\mathbb{E}\\left[\\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}}\\right]\\right| > \\epsilon\\right) \\le \\frac{C}{\\epsilon^2 N^{(d-1)/d}}\n1501: $$\n1502: \n1503: The statistical error (relative to the expectation) is:\n1504: \n1505: $$\n1506: \\varepsilon_{\\text{stat}} = \\frac{\\sigma(|\\mathcal{N}_\\Sigma|)}{\\mathbb{E}[|\\mathcal{N}_\\Sigma|]} = \\frac{\\Theta(N^{(d-1)/(2d)})}{\\Theta(N^{(d-1)/d})} = \\Theta(N^{-(d-1)/(2d)})\n1507: $$\n1508: \n1509: **Part C: Combined error (corrected)**\n1510: \n1511: The total error is the sum of the geometric approximation error and the statistical sampling error:\n1512: \n1513: $$\n1514: \\varepsilon_{\\text{total}} = \\varepsilon_{\\text{geom}} + \\varepsilon_{\\text{stat}} = O(N^{-1/d}) + O(N^{-(d-1)/(2d)})\n1515: $$\n1516: \n1517: **Dimension-dependent scaling (corrected)**: The dominant error is the one that converges **slowest**, i.e., with the **smallest exponent** (closest to zero):\n1518: \n1519: 1. **For $d = 2$**: $1/d = 1/2$ vs $(d-1)/(2d) = 1/4$. Since $1/4 < 1/2$, **statistical error dominates**.\n1520: \n1521: 2. **For $d = 3$**: $1/d = 1/3$ vs $(d-1)/(2d) = 2/6 = 1/3$. Both errors are of the same order.\n1522: \n1523: 3. **For $d > 3$**: $1/d < (d-1)/(2d)$. Since $1/d$ is smaller, **geometric error dominates**.\n1524: \n1525: **General scaling**: Comparing exponents $1/d$ vs $(d-1)/(2d)$ is equivalent to comparing $2$ vs $d-1$:\n1526: - If $d = 2$: $(d-1) < 2$, so statistical error dominates (smaller exponent)\n1527: - If $d = 3$: $(d-1) = 2$, so both contribute equally\n1528: - If $d > 3$: $(d-1) > 2$, so geometric error dominates (smaller exponent)\n1529: \n1530: **Final combined error bound**: With probability $1 - O(N^{-(d-1)/d})$:\n1531: \n1532: $$\n1533: \\left|\\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}} - C_d \\int_\\Sigma \\rho^{(d-1)/d} d\\Sigma\\right| = O\\left(N^{-1/d} + N^{-(d-1)/(2d)}\\right)\n1534: $$\n1535: \n1536: which simplifies to:\n1537: \n1538: $$\n1539: = \\begin{cases}\n1540: O(N^{-(d-1)/(2d)}) = O(N^{-1/4}) & \\text{if } d = 2 \\text{ (statistical dominates)} \\\\\n1541: O(N^{-1/3}) & \\text{if } d = 3 \\text{ (equal contributions)} \\\\\n1542: O(N^{-1/d}) & \\text{if } d > 3 \\text{ (geometric dominates)}\n1543: \\end{cases}\n1544: $$\n1545: \n1546: **Rigorous justification**: This follows from **geometric measure theory** for point processes on manifolds. The $(d-1)/d$ scaling is standard for codimension-1 intersections. See:\n1547: - *Baddeley, Rubak & Turner, \"Spatial Point Patterns: Methodology and Applications with R\", 2015, Ch. 9*",
      "metadata": {},
      "section": "## 4. Lemma 3: Riemann Sum Convergence for Surface Integrals",
      "raw_directive": "1327: :::\n1328: \n1329: :::{prf:proof}\n1330: **Step 1: Thicken the surface**\n1331: \n1332: For small $\\delta > 0$, define the **$\\delta$-thickening** of $\\Sigma$:\n1333: \n1334: $$\n1335: \\Sigma_\\delta = \\{ x \\in \\mathcal{X} : \\text{dist}(x, \\Sigma) < \\delta \\}\n1336: $$\n1337: \n1338: This is a tube of width $2\\delta$ around $\\Sigma$.\n1339: \n1340: **Step 2: Voronoi cells intersecting $\\Sigma$ lie in $\\Sigma_\\delta$**\n1341: \n1342: From Lemma {prf:ref}`lem-voronoi-diameter-scaling`, $\\text{diam}(\\text{Vor}_i) = O(N^{-1/d})$.\n1343: \n1344: Choose $\\delta = C N^{-1/d}$ with large constant $C$. Then:\n1345: \n1346: $$\n1347: \\text{Vor}_i \\cap \\Sigma \\neq \\emptyset \\quad \\Rightarrow \\quad x_i \\in \\Sigma_{C N^{-1/d}}\n1348: $$\n1349: \n1350: **Step 3: Count walkers in thickened region**\n1351: \n1352: The number of walkers in $\\Sigma_\\delta$ is approximately:\n1353: \n1354: $$\n1355: |\\mathcal{N}_\\Sigma| \\approx N \\int_{\\Sigma_\\delta} \\rho_{\\text{spatial}}(x) \\, dx\n1356: $$\n1357: \n1358: This is a standard Riemann sum approximation (see {prf:ref}`lem-sum-to-integral-episodes` from {doc}`04_rigorous_additions.md`).\n1359: \n1360: **Step 4: Relate volume integral to surface integral**\n1361: \n1362: For small $\\delta$, parameterize $\\Sigma_\\delta$ using normal coordinates $(u, s)$ where $u$ parametrizes $\\Sigma$ and $s \\in (-\\delta, \\delta)$ is the signed distance from $\\Sigma$:\n1363: \n1364: $$\n1365: \\int_{\\Sigma_\\delta} \\rho_{\\text{spatial}}(x) \\, dx = \\int_\\Sigma \\int_{-\\delta}^\\delta \\rho_{\\text{spatial}}(u + s \\mathbf{n}(u)) \\, ds \\, d\\Sigma(u)\n1366: $$\n1367: \n1368: where $\\mathbf{n}(u)$ is the unit normal to $\\Sigma$ at $u$.\n1369: \n1370: **Step 5: Taylor expand density**\n1371: \n1372: For smooth $\\rho_{\\text{spatial}}$:\n1373: \n1374: $$\n1375: \\rho_{\\text{spatial}}(u + s \\mathbf{n}) = \\rho_{\\text{spatial}}(u) + s \\, \\nabla \\rho_{\\text{spatial}}(u) \\cdot \\mathbf{n} + O(s^2)\n1376: $$\n1377: \n1378: Integrating over $s \\in (-\\delta, \\delta)$:\n1379: \n1380: $$\n1381: \\int_{-\\delta}^\\delta \\rho_{\\text{spatial}}(u + s \\mathbf{n}) \\, ds = 2\\delta \\, \\rho_{\\text{spatial}}(u) + O(\\delta^3)\n1382: $$\n1383: \n1384: (The $O(s)$ term vanishes by symmetry.)\n1385: \n1386: **Step 6: Substitute back**\n1387: \n1388: $$\n1389: \\int_{\\Sigma_\\delta} \\rho_{\\text{spatial}}(x) \\, dx = 2\\delta \\int_\\Sigma \\rho_{\\text{spatial}}(u) \\, d\\Sigma(u) + O(\\delta^3 \\text{Area}(\\Sigma))\n1390: $$\n1391: \n1392: **Step 7: DIMENSIONAL ERROR IDENTIFIED - Correcting the approach**\n1393: \n1394: The previous derivation shows that:\n1395: \n1396: $$\n1397: |\\mathcal{N}_\\Sigma| \\approx N \\cdot 2\\delta \\int_\\Sigma \\rho_{\\text{spatial}} \\, d\\Sigma = 2C N^{1-1/d} \\int_\\Sigma \\rho_{\\text{spatial}} \\, d\\Sigma\n1398: $$\n1399: \n1400: This indicates that the correct scaling is $|\\mathcal{N}_\\Sigma| \\sim N^{(d-1)/d}$, not $N$.\n1401: \n1402: **Corrected Proof (Dimensional Analysis)**:\n1403: \n1404: **Key insight**: A $(d-1)$-dimensional surface in $d$-dimensional space intersects Voronoi cells whose linear size is $\\ell \\sim N^{-1/d}$.\n1405: \n1406: **Step 1 (Corrected): Geometric scaling**\n1407: \n1408: Consider a surface $\\Sigma$ with Riemannian area $A_g(\\Sigma)$. Voronoi cells have:\n1409: - Linear size: $\\ell \\sim N^{-1/d}$\n1410: - Volume: $V_{\\text{cell}} \\sim \\ell^d \\sim N^{-1}$\n1411: - Cross-sectional area: $A_{\\text{cell}} \\sim \\ell^{d-1} \\sim N^{-(d-1)/d}$\n1412: \n1413: **Step 2 (Corrected): Surface intersection count**\n1414: \n1415: The number of Voronoi cells intersecting $\\Sigma$ is:\n1416: \n1417: $$\n1418: |\\mathcal{N}_\\Sigma| \\sim \\frac{A_g(\\Sigma)}{A_{\\text{cell}}} \\sim A_g(\\Sigma) \\cdot N^{(d-1)/d}\n1419: $$\n1420: \n1421: **Step 3 (Corrected): Account for non-uniform density**\n1422: \n1423: When $\\rho_{\\text{spatial}}(x)$ varies, the local Voronoi cell size is:\n1424: \n1425: $$\n1426: \\ell_{\\text{local}}(x) \\sim \\left[\\rho_{\\text{spatial}}(x)\\right]^{-1/d}\n1427: $$\n1428: \n1429: Therefore, the number of cells intersecting a small patch $dA$ at position $x$ is:\n1430: \n1431: $$\n1432: dN \\sim \\frac{dA}{\\ell_{\\text{local}}^{d-1}} \\sim \\left[\\rho_{\\text{spatial}}(x)\\right]^{(d-1)/d} dA\n1433: $$\n1434: \n1435: **Step 4 (Corrected): Integrate over surface**\n1436: \n1437: $$\n1438: |\\mathcal{N}_\\Sigma| \\sim \\int_\\Sigma \\left[\\rho_{\\text{spatial}}(x)\\right]^{(d-1)/d} d\\Sigma(x) \\cdot N^{(d-1)/d}\n1439: $$\n1440: \n1441: **Corrected Final Result**:\n1442: \n1443: $$\n1444: \\lim_{N \\to \\infty} \\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}} = C_d \\int_\\Sigma \\left[\\rho_{\\text{spatial}}(x)\\right]^{(d-1)/d} \\, d\\Sigma(x)\n1445: $$\n1446: \n1447: where $C_d$ is a dimension-dependent constant from geometric measure theory.\n1448: \n1449: **Step 5 (Rigorous Error Analysis): Decomposition into geometric and statistical errors**\n1450: \n1451: The total error in approximating the surface measure consists of **two independent contributions**:\n1452: \n1453: **Part A: Geometric approximation error**\n1454: \n1455: The surface $\\Sigma$ is approximated by Voronoi cells of diameter $O(N^{-1/d})$. This discretization introduces a **geometric error**:\n1456: \n1457: $$\n1458: \\varepsilon_{\\text{geom}} = O(N^{-1/d})\n1459: $$\n1460: \n1461: **Justification**: When approximating a smooth $(d-1)$-dimensional surface by cells of linear size $\\ell = O(N^{-1/d})$, the approximation error in the surface area is $O(\\ell) = O(N^{-1/d})$ per unit area. See *Schneider & Weil, \"Stochastic and Integral Geometry\", Springer, 2008, Ch. 10*.\n1462: \n1463: **Part B: Statistical sampling error**\n1464: \n1465: Even if the geometric discretization were perfect, the random placement of walkers introduces **statistical fluctuations**. The convergence to the limit follows from the **law of large numbers for spatial point processes**.\n1466: \n1467: **Theorem (Penrose 2003, Thm 1.8)**: For a Poisson point process with intensity $N \\cdot \\rho(x)$ on a manifold $\\mathcal{M}$, and a measurable set $B \\subset \\mathcal{M}$, the number of points $N_B$ satisfies:\n1468: \n1469: $$\n1470: \\frac{N_B}{N} \\to \\int_B \\rho(x) \\, dx \\quad \\text{as } N \\to \\infty\n1471: $$\n1472: \n1473: with **variance**:\n1474: \n1475: $$\n1476: \\text{Var}(N_B) = N \\int_B \\rho(x) \\, dx = \\Theta(N)\n1477: $$\n1478: \n1479: **Application to surface intersections**: The $\\delta$-thickened surface $\\Sigma_\\delta$ with $\\delta = C N^{-1/d}$ has volume:\n1480: \n1481: $$\n1482: \\text{Vol}(\\Sigma_\\delta) = \\Theta(\\delta \\cdot \\text{Area}(\\Sigma)) = \\Theta(N^{-1/d} \\cdot N^{(d-1)/d}) = \\Theta(N^{(d-2)/d})\n1483: $$\n1484: \n1485: Therefore, the expected number of points in $\\Sigma_\\delta$ is:\n1486: \n1487: $$\n1488: \\mathbb{E}[|\\mathcal{N}_\\Sigma|] = N \\cdot \\text{Vol}(\\Sigma_\\delta) \\cdot \\rho_{\\text{avg}} = \\Theta(N^{(d-1)/d})\n1489: $$\n1490: \n1491: and the **standard deviation** is:\n1492: \n1493: $$\n1494: \\sigma(|\\mathcal{N}_\\Sigma|) = \\sqrt{\\text{Var}(|\\mathcal{N}_\\Sigma|)} = \\Theta(N^{(d-1)/(2d)})\n1495: $$\n1496: \n1497: **Concentration inequality (Berry-Esseen CLT)**: By the central limit theorem for point processes (*Penrose, \"Random Geometric Graphs\", 2003, Thm 1.12*):\n1498: \n1499: $$\n1500: \\mathbb{P}\\left(\\left|\\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}} - \\mathbb{E}\\left[\\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}}\\right]\\right| > \\epsilon\\right) \\le \\frac{C}{\\epsilon^2 N^{(d-1)/d}}\n1501: $$\n1502: \n1503: The statistical error (relative to the expectation) is:\n1504: \n1505: $$\n1506: \\varepsilon_{\\text{stat}} = \\frac{\\sigma(|\\mathcal{N}_\\Sigma|)}{\\mathbb{E}[|\\mathcal{N}_\\Sigma|]} = \\frac{\\Theta(N^{(d-1)/(2d)})}{\\Theta(N^{(d-1)/d})} = \\Theta(N^{-(d-1)/(2d)})\n1507: $$\n1508: \n1509: **Part C: Combined error (corrected)**\n1510: \n1511: The total error is the sum of the geometric approximation error and the statistical sampling error:\n1512: \n1513: $$\n1514: \\varepsilon_{\\text{total}} = \\varepsilon_{\\text{geom}} + \\varepsilon_{\\text{stat}} = O(N^{-1/d}) + O(N^{-(d-1)/(2d)})\n1515: $$\n1516: \n1517: **Dimension-dependent scaling (corrected)**: The dominant error is the one that converges **slowest**, i.e., with the **smallest exponent** (closest to zero):\n1518: \n1519: 1. **For $d = 2$**: $1/d = 1/2$ vs $(d-1)/(2d) = 1/4$. Since $1/4 < 1/2$, **statistical error dominates**.\n1520: \n1521: 2. **For $d = 3$**: $1/d = 1/3$ vs $(d-1)/(2d) = 2/6 = 1/3$. Both errors are of the same order.\n1522: \n1523: 3. **For $d > 3$**: $1/d < (d-1)/(2d)$. Since $1/d$ is smaller, **geometric error dominates**.\n1524: \n1525: **General scaling**: Comparing exponents $1/d$ vs $(d-1)/(2d)$ is equivalent to comparing $2$ vs $d-1$:\n1526: - If $d = 2$: $(d-1) < 2$, so statistical error dominates (smaller exponent)\n1527: - If $d = 3$: $(d-1) = 2$, so both contribute equally\n1528: - If $d > 3$: $(d-1) > 2$, so geometric error dominates (smaller exponent)\n1529: \n1530: **Final combined error bound**: With probability $1 - O(N^{-(d-1)/d})$:\n1531: \n1532: $$\n1533: \\left|\\frac{|\\mathcal{N}_\\Sigma|}{N^{(d-1)/d}} - C_d \\int_\\Sigma \\rho^{(d-1)/d} d\\Sigma\\right| = O\\left(N^{-1/d} + N^{-(d-1)/(2d)}\\right)\n1534: $$\n1535: \n1536: which simplifies to:\n1537: \n1538: $$\n1539: = \\begin{cases}\n1540: O(N^{-(d-1)/(2d)}) = O(N^{-1/4}) & \\text{if } d = 2 \\text{ (statistical dominates)} \\\\\n1541: O(N^{-1/3}) & \\text{if } d = 3 \\text{ (equal contributions)} \\\\\n1542: O(N^{-1/d}) & \\text{if } d > 3 \\text{ (geometric dominates)}\n1543: \\end{cases}\n1544: $$\n1545: \n1546: **Rigorous justification**: This follows from **geometric measure theory** for point processes on manifolds. The $(d-1)/d$ scaling is standard for codimension-1 intersections. See:\n1547: - *Baddeley, Rubak & Turner, \"Spatial Point Patterns: Methodology and Applications with R\", 2015, Ch. 9*\n1548: - *Penrose, \"Random Geometric Graphs\", Oxford, 2003, Ch. 1*"
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}