{
  "chapter_index": 3,
  "section_id": "## 2. Supporting Lemmas for Antichain Analysis",
  "directive_count": 8,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-causal-chain-locality",
      "title": "Causal Chain Locality",
      "start_line": 175,
      "end_line": 183,
      "header_lines": [
        176
      ],
      "content_start": 178,
      "content_end": 182,
      "content": "178: :label: lem-causal-chain-locality\n179: \n180: Let $e_j \\prec e_k$ be two causally related episodes in the CST. Then any causal path from an ancestor of $e_j$ to a descendant of $e_k$ must pass through a connected sequence of Voronoi cells.\n181: \n182: More precisely: Let $\\mathcal{P}$ be any causal chain from $e_a \\preceq e_j$ to $e_b \\succeq e_k$. Then the set of Voronoi cells $\\{\\text{Vor}_i : e_i \\in \\mathcal{P}\\}$ forms a connected path in space.",
      "metadata": {
        "label": "lem-causal-chain-locality"
      },
      "section": "## 2. Supporting Lemmas for Antichain Analysis",
      "raw_directive": "175: ### Lemma 1a: Causal Chain Locality\n176: \n177: :::{prf:lemma} Causal Chain Locality\n178: :label: lem-causal-chain-locality\n179: \n180: Let $e_j \\prec e_k$ be two causally related episodes in the CST. Then any causal path from an ancestor of $e_j$ to a descendant of $e_k$ must pass through a connected sequence of Voronoi cells.\n181: \n182: More precisely: Let $\\mathcal{P}$ be any causal chain from $e_a \\preceq e_j$ to $e_b \\succeq e_k$. Then the set of Voronoi cells $\\{\\text{Vor}_i : e_i \\in \\mathcal{P}\\}$ forms a connected path in space.\n183: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-13",
      "title": null,
      "start_line": 185,
      "end_line": 243,
      "header_lines": [],
      "content_start": 186,
      "content_end": 242,
      "content": "186: \n187: :::{prf:proof}\n188: **Proof**: This follows from the construction of the CST and the Voronoi tessellation.\n189: \n190: **Step 1: Cloning locality and scaling**\n191: \n192: By the cloning operator definition (see {prf:ref}`def-cloning-operator` in the framework), when episode $e_i$ clones to produce descendant $e_{i'}$, the position of $e_{i'}$ is:\n193: \n194: $$\n195: x_{i'} = x_i + \\xi\n196: $$\n197: \n198: where $\\xi$ is a noise term from the cloning perturbation. From {prf:ref}`lem-voronoi-diameter-scaling`, Voronoi cells have characteristic diameter:\n199: \n200: $$\n201: \\delta_{\\text{cell}} = O(N^{-1/d})\n202: $$\n203: \n204: **Quantify displacement**: The cloning operator perturbs positions by $|\\xi| \\sim \\sqrt{\\tau}$ where $\\tau$ is the time step. For the Fragile Gas at QSD, the time step scales as $\\tau \\sim N^{-\\beta}$ for some $\\beta > 0$. The standard scaling for diffusion-dominated dynamics is $\\tau \\sim \\delta_{\\text{cell}}^2 = O(N^{-2/d})$, giving:\n205: \n206: $$\n207: |\\xi| \\sim \\sqrt{\\tau} \\sim N^{-1/d} = \\delta_{\\text{cell}}\n208: $$\n209: \n210: Thus, a typical cloning displacement is of the same order as a Voronoi cell diameter.\n211: \n212: **Step 2: Descendants remain spatially local**\n213: \n214: With the scaling $|\\xi| \\sim \\delta_{\\text{cell}} \\sim N^{-1/d}$, an immediate descendant lies within $O(1)$ Voronoi cells of its parent. More precisely, for Gaussian noise $\\xi \\sim \\mathcal{N}(0, \\sigma^2)$ with $\\sigma \\sim N^{-1/d}$, we have:\n215: \n216: $$\n217: \\mathbb{P}(|\\xi| > C \\sigma) \\sim \\exp\\left(-\\frac{C^2}{2}\\right)\n218: $$\n219: \n220: This is a standard Gaussian tail bound, **independent of $N$**. For $C = O(1)$, the typical displacement is:\n221: \n222: $$\n223: |\\xi| \\le C_0 \\sigma = C_0 N^{-1/d} = C_0 \\delta_{\\text{cell}}\n224: $$\n225: \n226: with probability $1 - O(e^{-c})$ for constants $C_0, c = O(1)$. This means the descendant's Voronoi cell is within $O(1)$ cells of the parent's cell with high (but $N$-independent) probability.\n227: \n228: **Over multiple generations**: For $k$ generations, diffusion gives total displacement:\n229: \n230: $$\n231: \\text{displacement} \\sim \\sqrt{k} \\cdot \\delta_{\\text{cell}}\n232: $$\n233: \n234: For $k = O(1)$ generations (short causal chains), descendants remain within $O(1)$ cells of the parent.\n235: \n236: **Step 3: Causal chains trace spatial paths**\n237: \n238: A causal chain $e_a \\prec e_1 \\prec e_2 \\prec \\cdots \\prec e_m \\prec e_b$ consists of ancestor-descendant relationships. By Step 2, each pair $(e_i, e_{i+1})$ has Voronoi cells that are nearby (within $O(1)$ cells).\n239: \n240: Therefore, the sequence $\\{\\text{Vor}_{e_1}, \\text{Vor}_{e_2}, \\ldots, \\text{Vor}_{e_m}\\}$ forms a connected path in the Voronoi tessellation.\n241: \n242: **Step 4: Boundary crossing**",
      "metadata": {},
      "section": "## 2. Supporting Lemmas for Antichain Analysis",
      "raw_directive": "185: :::\n186: \n187: :::{prf:proof}\n188: **Proof**: This follows from the construction of the CST and the Voronoi tessellation.\n189: \n190: **Step 1: Cloning locality and scaling**\n191: \n192: By the cloning operator definition (see {prf:ref}`def-cloning-operator` in the framework), when episode $e_i$ clones to produce descendant $e_{i'}$, the position of $e_{i'}$ is:\n193: \n194: $$\n195: x_{i'} = x_i + \\xi\n196: $$\n197: \n198: where $\\xi$ is a noise term from the cloning perturbation. From {prf:ref}`lem-voronoi-diameter-scaling`, Voronoi cells have characteristic diameter:\n199: \n200: $$\n201: \\delta_{\\text{cell}} = O(N^{-1/d})\n202: $$\n203: \n204: **Quantify displacement**: The cloning operator perturbs positions by $|\\xi| \\sim \\sqrt{\\tau}$ where $\\tau$ is the time step. For the Fragile Gas at QSD, the time step scales as $\\tau \\sim N^{-\\beta}$ for some $\\beta > 0$. The standard scaling for diffusion-dominated dynamics is $\\tau \\sim \\delta_{\\text{cell}}^2 = O(N^{-2/d})$, giving:\n205: \n206: $$\n207: |\\xi| \\sim \\sqrt{\\tau} \\sim N^{-1/d} = \\delta_{\\text{cell}}\n208: $$\n209: \n210: Thus, a typical cloning displacement is of the same order as a Voronoi cell diameter.\n211: \n212: **Step 2: Descendants remain spatially local**\n213: \n214: With the scaling $|\\xi| \\sim \\delta_{\\text{cell}} \\sim N^{-1/d}$, an immediate descendant lies within $O(1)$ Voronoi cells of its parent. More precisely, for Gaussian noise $\\xi \\sim \\mathcal{N}(0, \\sigma^2)$ with $\\sigma \\sim N^{-1/d}$, we have:\n215: \n216: $$\n217: \\mathbb{P}(|\\xi| > C \\sigma) \\sim \\exp\\left(-\\frac{C^2}{2}\\right)\n218: $$\n219: \n220: This is a standard Gaussian tail bound, **independent of $N$**. For $C = O(1)$, the typical displacement is:\n221: \n222: $$\n223: |\\xi| \\le C_0 \\sigma = C_0 N^{-1/d} = C_0 \\delta_{\\text{cell}}\n224: $$\n225: \n226: with probability $1 - O(e^{-c})$ for constants $C_0, c = O(1)$. This means the descendant's Voronoi cell is within $O(1)$ cells of the parent's cell with high (but $N$-independent) probability.\n227: \n228: **Over multiple generations**: For $k$ generations, diffusion gives total displacement:\n229: \n230: $$\n231: \\text{displacement} \\sim \\sqrt{k} \\cdot \\delta_{\\text{cell}}\n232: $$\n233: \n234: For $k = O(1)$ generations (short causal chains), descendants remain within $O(1)$ cells of the parent.\n235: \n236: **Step 3: Causal chains trace spatial paths**\n237: \n238: A causal chain $e_a \\prec e_1 \\prec e_2 \\prec \\cdots \\prec e_m \\prec e_b$ consists of ancestor-descendant relationships. By Step 2, each pair $(e_i, e_{i+1})$ has Voronoi cells that are nearby (within $O(1)$ cells).\n239: \n240: Therefore, the sequence $\\{\\text{Vor}_{e_1}, \\text{Vor}_{e_2}, \\ldots, \\text{Vor}_{e_m}\\}$ forms a connected path in the Voronoi tessellation.\n241: \n242: **Step 4: Boundary crossing**\n243: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-interior-descendance",
      "title": "Interior Descendance (Fractional Progress)",
      "start_line": 249,
      "end_line": 261,
      "header_lines": [
        250
      ],
      "content_start": 252,
      "content_end": 260,
      "content": "252: :label: lem-interior-descendance\n253: \n254: Let $e_i$ be an episode with $\\delta := \\text{dist}(\\Phi(e_i), \\partial A) = CN^{-1/d}$ for some large constant $C \\gg 1$. Let $D(e_i)$ be its immediate descendants.\n255: \n256: Then with probability $1 - O(e^{-C^2})$, every descendant $d \\in D(e_i)$ satisfies:\n257: \n258: $$\n259: \\text{dist}(\\Phi(d), \\partial A) > \\frac{\\delta}{2}\n260: $$",
      "metadata": {
        "label": "lem-interior-descendance"
      },
      "section": "## 2. Supporting Lemmas for Antichain Analysis",
      "raw_directive": "249: ### Lemma 1b: Interior Descendance\n250: \n251: :::{prf:lemma} Interior Descendance (Fractional Progress)\n252: :label: lem-interior-descendance\n253: \n254: Let $e_i$ be an episode with $\\delta := \\text{dist}(\\Phi(e_i), \\partial A) = CN^{-1/d}$ for some large constant $C \\gg 1$. Let $D(e_i)$ be its immediate descendants.\n255: \n256: Then with probability $1 - O(e^{-C^2})$, every descendant $d \\in D(e_i)$ satisfies:\n257: \n258: $$\n259: \\text{dist}(\\Phi(d), \\partial A) > \\frac{\\delta}{2}\n260: $$\n261: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-91",
      "title": null,
      "start_line": 263,
      "end_line": 309,
      "header_lines": [],
      "content_start": 264,
      "content_end": 308,
      "content": "264: \n265: :::{prf:proof}\n266: **Proof**: This follows from the cloning operator's spatial dynamics.\n267: \n268: **Step 1: Cloning displacement (consistent scaling)**\n269: \n270: From the cloning operator {prf:ref}`def-cloning-operator`, when $e_i$ clones to produce $d$:\n271: \n272: $$\n273: \\Phi(d) = \\Phi(e_i) + \\xi\n274: $$\n275: \n276: where $\\xi$ is Gaussian noise with $\\xi \\sim \\mathcal{N}(0, \\sigma^2)$ and $\\sigma = \\sqrt{\\tau} = N^{-1/d}$ (using consistent scaling $\\tau \\sim N^{-2/d}$).\n277: \n278: **Step 2: Distance bound with large deviation**\n279: \n280: Let $\\delta = \\text{dist}(\\Phi(e_i), \\partial A) > CN^{-1/d}$ for large constant $C \\gg 1$. We need to bound the probability that the descendant moves closer to $\\partial A$ by more than a fraction of this distance.\n281: \n282: By triangle inequality:\n283: \n284: $$\n285: \\text{dist}(\\Phi(d), \\partial A) \\ge \\text{dist}(\\Phi(e_i), \\partial A) - |\\xi|\n286: $$\n287: \n288: For Gaussian $\\xi$ with $\\sigma = N^{-1/d}$, the probability of large displacement is:\n289: \n290: $$\n291: \\mathbb{P}(|\\xi| > t) \\le 2\\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right) = 2\\exp\\left(-\\frac{t^2 N^{2/d}}{2}\\right)\n292: $$\n293: \n294: Choose $t = \\delta/2$ (descendant moves halfway to boundary). Since $\\delta = CN^{-1/d}$:\n295: \n296: $$\n297: \\mathbb{P}\\left(|\\xi| > \\frac{\\delta}{2}\\right) \\le 2\\exp\\left(-\\frac{C^2 N^{2/d}}{8 N^{2/d}}\\right) = 2\\exp\\left(-\\frac{C^2}{8}\\right)\n298: $$\n299: \n300: This probability is **exponentially small in $C$** (not in $N$), but for $C \\gg 1$, it's negligible.\n301: \n302: Therefore, with probability $1 - O(e^{-C^2})$:\n303: \n304: $$\n305: \\text{dist}(\\Phi(d), \\partial A) > \\delta - \\frac{\\delta}{2} = \\frac{\\delta}{2}\n306: $$\n307: \n308: **Step 3: Multiple descendants and iteration**",
      "metadata": {},
      "section": "## 2. Supporting Lemmas for Antichain Analysis",
      "raw_directive": "263: :::\n264: \n265: :::{prf:proof}\n266: **Proof**: This follows from the cloning operator's spatial dynamics.\n267: \n268: **Step 1: Cloning displacement (consistent scaling)**\n269: \n270: From the cloning operator {prf:ref}`def-cloning-operator`, when $e_i$ clones to produce $d$:\n271: \n272: $$\n273: \\Phi(d) = \\Phi(e_i) + \\xi\n274: $$\n275: \n276: where $\\xi$ is Gaussian noise with $\\xi \\sim \\mathcal{N}(0, \\sigma^2)$ and $\\sigma = \\sqrt{\\tau} = N^{-1/d}$ (using consistent scaling $\\tau \\sim N^{-2/d}$).\n277: \n278: **Step 2: Distance bound with large deviation**\n279: \n280: Let $\\delta = \\text{dist}(\\Phi(e_i), \\partial A) > CN^{-1/d}$ for large constant $C \\gg 1$. We need to bound the probability that the descendant moves closer to $\\partial A$ by more than a fraction of this distance.\n281: \n282: By triangle inequality:\n283: \n284: $$\n285: \\text{dist}(\\Phi(d), \\partial A) \\ge \\text{dist}(\\Phi(e_i), \\partial A) - |\\xi|\n286: $$\n287: \n288: For Gaussian $\\xi$ with $\\sigma = N^{-1/d}$, the probability of large displacement is:\n289: \n290: $$\n291: \\mathbb{P}(|\\xi| > t) \\le 2\\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right) = 2\\exp\\left(-\\frac{t^2 N^{2/d}}{2}\\right)\n292: $$\n293: \n294: Choose $t = \\delta/2$ (descendant moves halfway to boundary). Since $\\delta = CN^{-1/d}$:\n295: \n296: $$\n297: \\mathbb{P}\\left(|\\xi| > \\frac{\\delta}{2}\\right) \\le 2\\exp\\left(-\\frac{C^2 N^{2/d}}{8 N^{2/d}}\\right) = 2\\exp\\left(-\\frac{C^2}{8}\\right)\n298: $$\n299: \n300: This probability is **exponentially small in $C$** (not in $N$), but for $C \\gg 1$, it's negligible.\n301: \n302: Therefore, with probability $1 - O(e^{-C^2})$:\n303: \n304: $$\n305: \\text{dist}(\\Phi(d), \\partial A) > \\delta - \\frac{\\delta}{2} = \\frac{\\delta}{2}\n306: $$\n307: \n308: **Step 3: Multiple descendants and iteration**\n309: "
    },
    {
      "directive_type": "remark",
      "label": "rem-c-order-one",
      "title": "Justification for $C = O(1)$",
      "start_line": 313,
      "end_line": 333,
      "header_lines": [
        314
      ],
      "content_start": 316,
      "content_end": 332,
      "content": "316: :label: rem-c-order-one\n317: \n318: **Question**: Why is the constant $C$ in the initial distance $\\delta_0 = CN^{-1/d}$ itself bounded as $C = O(1)$ independent of $N$?\n319: \n320: **Answer from QSD concentration**: At the Quasi-Stationary Distribution (QSD), the walker positions are **well-spaced** with high probability (Chapter 4, {prf:ref}`thm-well-spaced`). Specifically:\n321: \n322: $$\n323: \\delta_{\\min} \\left(\\frac{D^d}{N}\\right)^{1/d} \\leq \\min_{j \\neq i} |x_i - x_j| \\leq \\text{diam}(\\text{Vor}_i) \\leq \\delta_{\\max} \\left(\\frac{D^d}{N}\\right)^{1/d}\n324: $$\n325: \n326: where $\\delta_{\\min}, \\delta_{\\max}$ are **dimension-dependent constants** independent of $N$. Since the domain diameter $D = O(1)$ is fixed:\n327: \n328: $$\n329: \\text{typical inter-walker distance} \\sim N^{-1/d}\n330: $$\n331: \n332: Therefore, the typical distance of a walker from the boundary $\\partial A$ (the minimal antichain) is also $O(N^{-1/d})$. The constant $C$ in $\\delta = CN^{-1/d}$ represents **how many Voronoi cells away** the walker is from the boundary, which at QSD is $C = O(1)$ (typically $C \\in [1, 10]$ depending on dimension and the specific boundary region).",
      "metadata": {
        "label": "rem-c-order-one"
      },
      "section": "## 2. Supporting Lemmas for Antichain Analysis",
      "raw_directive": "313: ---\n314: \n315: :::{prf:remark} Justification for $C = O(1)$\n316: :label: rem-c-order-one\n317: \n318: **Question**: Why is the constant $C$ in the initial distance $\\delta_0 = CN^{-1/d}$ itself bounded as $C = O(1)$ independent of $N$?\n319: \n320: **Answer from QSD concentration**: At the Quasi-Stationary Distribution (QSD), the walker positions are **well-spaced** with high probability (Chapter 4, {prf:ref}`thm-well-spaced`). Specifically:\n321: \n322: $$\n323: \\delta_{\\min} \\left(\\frac{D^d}{N}\\right)^{1/d} \\leq \\min_{j \\neq i} |x_i - x_j| \\leq \\text{diam}(\\text{Vor}_i) \\leq \\delta_{\\max} \\left(\\frac{D^d}{N}\\right)^{1/d}\n324: $$\n325: \n326: where $\\delta_{\\min}, \\delta_{\\max}$ are **dimension-dependent constants** independent of $N$. Since the domain diameter $D = O(1)$ is fixed:\n327: \n328: $$\n329: \\text{typical inter-walker distance} \\sim N^{-1/d}\n330: $$\n331: \n332: Therefore, the typical distance of a walker from the boundary $\\partial A$ (the minimal antichain) is also $O(N^{-1/d})$. The constant $C$ in $\\delta = CN^{-1/d}$ represents **how many Voronoi cells away** the walker is from the boundary, which at QSD is $C = O(1)$ (typically $C \\in [1, 10]$ depending on dimension and the specific boundary region).\n333: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-antichain-cardinality",
      "title": "Antichain Cardinality Under Replacement",
      "start_line": 351,
      "end_line": 371,
      "header_lines": [
        352
      ],
      "content_start": 354,
      "content_end": 370,
      "content": "354: :label: lem-antichain-cardinality\n355: \n356: Let $\\gamma_A$ be a minimal separating antichain. For any episode $e_i \\in \\gamma_A$ with $\\text{Vor}_i \\subset A$ (interior), let $\\gamma'_A = (\\gamma_A \\setminus \\{e_i\\}) \\cup D(e_i)$ be the replacement antichain.\n357: \n358: Then:\n359: \n360: $$\n361: |\\gamma'_A| = |\\gamma_A| - 1 + |D(e_i)|\n362: $$\n363: \n364: Furthermore, at QSD in the large-$N$ limit, the expected number of descendants is:\n365: \n366: $$\n367: \\mathbb{E}[|D(e_i)|] = 1 + O(N^{-\\alpha})\n368: $$\n369: \n370: for some $\\alpha > 0$, meaning most cloning events produce exactly one descendant.",
      "metadata": {
        "label": "lem-antichain-cardinality"
      },
      "section": "## 2. Supporting Lemmas for Antichain Analysis",
      "raw_directive": "351: ### Lemma 1c: Antichain Cardinality Bound\n352: \n353: :::{prf:lemma} Antichain Cardinality Under Replacement\n354: :label: lem-antichain-cardinality\n355: \n356: Let $\\gamma_A$ be a minimal separating antichain. For any episode $e_i \\in \\gamma_A$ with $\\text{Vor}_i \\subset A$ (interior), let $\\gamma'_A = (\\gamma_A \\setminus \\{e_i\\}) \\cup D(e_i)$ be the replacement antichain.\n357: \n358: Then:\n359: \n360: $$\n361: |\\gamma'_A| = |\\gamma_A| - 1 + |D(e_i)|\n362: $$\n363: \n364: Furthermore, at QSD in the large-$N$ limit, the expected number of descendants is:\n365: \n366: $$\n367: \\mathbb{E}[|D(e_i)|] = 1 + O(N^{-\\alpha})\n368: $$\n369: \n370: for some $\\alpha > 0$, meaning most cloning events produce exactly one descendant.\n371: "
    },
    {
      "directive_type": "proof",
      "label": "thm-qsd-decorrelation",
      "title": null,
      "start_line": 373,
      "end_line": 428,
      "header_lines": [
        405
      ],
      "content_start": 374,
      "content_end": 427,
      "content": "374: \n375: :::{prf:proof}\n376: **Rigorous Proof**:\n377: \n378: **Part 1: Cardinality formula** (immediate from set theory):\n379: \n380: $$\n381: |\\gamma'_A| = |(\\gamma_A \\setminus \\{e_i\\}) \\cup D(e_i)| = |\\gamma_A| - 1 + |D(e_i)|\n382: $$\n383: \n384: **Part 2: Expected number of descendants**\n385: \n386: We must prove $\\mathbb{E}[|D(e_i)|] = 1 + O(N^{-\\alpha})$ for $\\alpha > 1/(2d)$ at QSD.\n387: \n388: **Step 1: Cloning mechanism at QSD**\n389: \n390: At QSD, the swarm has converged to a quasi-stationary distribution. The cloning operator {prf:ref}`def-cloning-operator` maintains approximately constant population $N$ by:\n391: - Cloning high-reward walkers\n392: - Pruning low-reward walkers\n393: \n394: The cloning event creates descendants. For a walker at position $x_i$ with reward $R_i$, define the **cloning intensity**:\n395: \n396: $$\n397: \\lambda_i := \\frac{\\max(0, R_i - R_{\\text{cutoff}})}{\\tau}\n398: $$\n399: \n400: where $R_{\\text{cutoff}}$ is a dynamic threshold chosen to maintain $N$ constant, and $\\tau$ is the time step.\n401: \n402: **Step 2: Distribution of rewards at QSD**\n403: \n404: At QSD, the reward distribution is approximately concentrated around the mean $\\bar{R}$. The fluctuations are governed by the following property:\n405: \n406: :::{prf:theorem} QSD Decorrelation at Equilibrium\n407: :label: thm-qsd-decorrelation\n408: \n409: At Quasi-Stationary Distribution with $N$ walkers, the reward fluctuations and cloning event correlations satisfy:\n410: \n411: 1. **Reward concentration**: For a typical walker $i$ in a region of uniform fitness, $R_i - \\bar{R} = O_p(N^{-1/2})$ with high probability.\n412: \n413: 2. **Universal weak decorrelation**: For any two distinct walkers $i, j$, the joint cloning probability satisfies:\n414: \n415:    $$\n416:    \\left| \\mathbb{P}(i, j \\text{ both clone}) - \\mathbb{P}(i \\text{ clones}) \\cdot \\mathbb{P}(j \\text{ clones}) \\right| \\le \\frac{C}{N}\n417:    $$\n418: \n419:    for a constant $C$ independent of the spatial separation $\\text{dist}(i,j)$.\n420: \n421:    **Physical mechanisms** (two contributions to the same $O(N^{-1})$ bound):\n422: \n423:    a) **Distant walkers** ($\\text{dist}(i,j) \\gg N^{-1/d}$): The $O(N^{-1})$ bound arises from **statistical finite-size correction** to perfect exchangeability (quantitative de Finetti theorem).\n424: \n425:    b) **Local walkers** ($\\text{dist}(i,j) \\sim N^{-1/d}$): The $O(N^{-1})$ bound arises from **dynamical fitness competition** - walkers in adjacent Voronoi cells have correlated rewards ($\\mathbb{E}[(R_i - \\bar{R})(R_j - \\bar{R})] = O(N^{-1})$) and compete for the same marginal cloning slots near the cutoff.\n426: \n427:    Both mechanisms contribute to the universal bound, but the physical origins differ.",
      "metadata": {
        "label": "thm-qsd-decorrelation"
      },
      "section": "## 2. Supporting Lemmas for Antichain Analysis",
      "raw_directive": "373: :::\n374: \n375: :::{prf:proof}\n376: **Rigorous Proof**:\n377: \n378: **Part 1: Cardinality formula** (immediate from set theory):\n379: \n380: $$\n381: |\\gamma'_A| = |(\\gamma_A \\setminus \\{e_i\\}) \\cup D(e_i)| = |\\gamma_A| - 1 + |D(e_i)|\n382: $$\n383: \n384: **Part 2: Expected number of descendants**\n385: \n386: We must prove $\\mathbb{E}[|D(e_i)|] = 1 + O(N^{-\\alpha})$ for $\\alpha > 1/(2d)$ at QSD.\n387: \n388: **Step 1: Cloning mechanism at QSD**\n389: \n390: At QSD, the swarm has converged to a quasi-stationary distribution. The cloning operator {prf:ref}`def-cloning-operator` maintains approximately constant population $N$ by:\n391: - Cloning high-reward walkers\n392: - Pruning low-reward walkers\n393: \n394: The cloning event creates descendants. For a walker at position $x_i$ with reward $R_i$, define the **cloning intensity**:\n395: \n396: $$\n397: \\lambda_i := \\frac{\\max(0, R_i - R_{\\text{cutoff}})}{\\tau}\n398: $$\n399: \n400: where $R_{\\text{cutoff}}$ is a dynamic threshold chosen to maintain $N$ constant, and $\\tau$ is the time step.\n401: \n402: **Step 2: Distribution of rewards at QSD**\n403: \n404: At QSD, the reward distribution is approximately concentrated around the mean $\\bar{R}$. The fluctuations are governed by the following property:\n405: \n406: :::{prf:theorem} QSD Decorrelation at Equilibrium\n407: :label: thm-qsd-decorrelation\n408: \n409: At Quasi-Stationary Distribution with $N$ walkers, the reward fluctuations and cloning event correlations satisfy:\n410: \n411: 1. **Reward concentration**: For a typical walker $i$ in a region of uniform fitness, $R_i - \\bar{R} = O_p(N^{-1/2})$ with high probability.\n412: \n413: 2. **Universal weak decorrelation**: For any two distinct walkers $i, j$, the joint cloning probability satisfies:\n414: \n415:    $$\n416:    \\left| \\mathbb{P}(i, j \\text{ both clone}) - \\mathbb{P}(i \\text{ clones}) \\cdot \\mathbb{P}(j \\text{ clones}) \\right| \\le \\frac{C}{N}\n417:    $$\n418: \n419:    for a constant $C$ independent of the spatial separation $\\text{dist}(i,j)$.\n420: \n421:    **Physical mechanisms** (two contributions to the same $O(N^{-1})$ bound):\n422: \n423:    a) **Distant walkers** ($\\text{dist}(i,j) \\gg N^{-1/d}$): The $O(N^{-1})$ bound arises from **statistical finite-size correction** to perfect exchangeability (quantitative de Finetti theorem).\n424: \n425:    b) **Local walkers** ($\\text{dist}(i,j) \\sim N^{-1/d}$): The $O(N^{-1})$ bound arises from **dynamical fitness competition** - walkers in adjacent Voronoi cells have correlated rewards ($\\mathbb{E}[(R_i - \\bar{R})(R_j - \\bar{R})] = O(N^{-1})$) and compete for the same marginal cloning slots near the cutoff.\n426: \n427:    Both mechanisms contribute to the universal bound, but the physical origins differ.\n428: "
    },
    {
      "directive_type": "proof",
      "label": "rem-taylor-truncation",
      "title": null,
      "start_line": 430,
      "end_line": 693,
      "header_lines": [
        664
      ],
      "content_start": 431,
      "content_end": 692,
      "content": "431: \n432: :::{prf:proof}\n433: We derive these properties from the framework's established propagation of chaos results.\n434: \n435: **Part 1: Reward concentration**\n436: \n437: From {prf:ref}`thm-propagation-chaos` (Theorem 6.1 in 06_propagation_chaos.md), the Fragile Gas at QSD exhibits propagation of chaos: the empirical measure $\\mu_N$ converges to the McKean-Vlasov limit $\\mu_\\infty$ in the large-$N$ limit.\n438: \n439: By {prf:ref}`thm-thermodynamic-limit` (Theorem 5.1 in 05_mean_field.md), the mean-field limit satisfies a self-consistent equation where the cumulative reward $\\bar{R}$ is determined by the global distribution.\n440: \n441: **Standard CLT for exchangeable random variables**: At QSD, walkers are approximately exchangeable (by the mixing property of the kinetic operator). For a sequence of exchangeable random variables $\\{R_1, \\ldots, R_N\\}$ with finite variance $\\sigma^2$:\n442: \n443: $$\n444: R_i - \\bar{R} = O_p(N^{-1/2})\n445: $$\n446: \n447: This is a standard result in probability theory (see Durrett, \"Probability: Theory and Examples\", Theorem 2.4.7).\n448: \n449: **Verification for Fragile Gas**: The cloning operator maintains bounded variance by design (rescaling prevents unbounded growth). The kinetic operator provides exponential mixing. Together, these ensure finite variance $\\sigma^2 < \\infty$ at QSD, so the standard CLT applies.\n450: \n451: **Part 2: Cloning decorrelation - Case distinction**\n452: \n453: The proof proceeds differently for distant vs local walkers, though both yield the same $O(N^{-1})$ bound.\n454: \n455: **Part 2a: Distant walkers** ($\\text{dist}(i,j) \\gg N^{-1/d}$) - Global exchangeability\n456: \n457: We use a quantitative exchangeability argument to bound the correlation between distant cloning events.\n458: \n459: **Step 2.1: Exchangeability at QSD**\n460: \n461: From {prf:ref}`thm-propagation-chaos` (Theorem 6.1), at QSD the particle system exhibits asymptotic exchangeability: any permutation of walker labels produces statistically equivalent configurations. The joint law of any $k$ walkers converges to a mixture of i.i.d. distributions.\n462: \n463: By **de Finetti's theorem** (quantitative version, Diaconis & Freedman, 1980), for an exchangeable sequence $\\{Z_1, \\ldots, Z_N\\}$ with marginals $\\mu_N$, there exists a measure $\\nu$ on probability measures such that:\n464: \n465: $$\n466: d_{TV}(\\mu_N^{(k)}, \\int \\lambda^{\\otimes k} \\, d\\nu(\\lambda)) \\le \\frac{k^2}{N}\n467: $$\n468: \n469: where $d_{TV}$ is the total variation distance and $\\mu_N^{(k)}$ is the $k$-particle marginal.\n470: \n471: **Step 2.2: Bound joint probability via total variation**\n472: \n473: For two walkers $i, j$ separated by $\\delta \\gg N^{-1/d}$, define the cloning indicator functions:\n474: \n475: $$\n476: f_i(Z_i) := \\mathbb{1}\\{i \\text{ clones}\\}, \\quad f_j(Z_j) := \\mathbb{1}\\{j \\text{ clones}\\}\n477: $$\n478: \n479: These are bounded functions: $|f_i|, |f_j| \\le 1$.\n480: \n481: **Key property of total variation distance**: For indicator functions $f, g$ taking values in $\\{0, 1\\}$:\n482: \n483: $$\n484: \\left| \\mathbb{E}_{\\mu}[f \\cdot g] - \\mathbb{E}_{\\nu}[f \\cdot g] \\right| \\le d_{TV}(\\mu, \\nu)\n485: $$\n486: \n487: (This is sharper than the bound for general functions in $[-1, 1]$, which would give a factor of 2.)\n488: \n489: **Proof sketch of sharpness**: For probability measures $\\mu, \\nu$ on a space $\\Omega$ and measurable functions $f, g: \\Omega \\to \\{0,1\\}$:\n490: \n491: $$\n492: \\begin{align}\n493: \\left| \\mathbb{E}_{\\mu}[f \\cdot g] - \\mathbb{E}_{\\nu}[f \\cdot g] \\right|\n494: &= \\left| \\int (f \\cdot g) d\\mu - \\int (f \\cdot g) d\\nu \\right| \\\\\n495: &= \\left| \\int (f \\cdot g) d(\\mu - \\nu) \\right| \\\\\n496: &\\le \\int |f \\cdot g| \\, d|\\mu - \\nu| \\quad \\text{(triangle inequality)} \\\\\n497: &\\le \\int 1 \\, d|\\mu - \\nu| \\quad \\text{(since } |f \\cdot g| \\le 1 \\text{)} \\\\\n498: &= \\|\\mu - \\nu\\|_{TV} = d_{TV}(\\mu, \\nu)\n499: \\end{align}\n500: $$\n501: \n502: For general bounded functions $f, g \\in [-1, 1]$, one would instead bound $|f \\cdot g| \\le 2$, giving the factor of 2. See [Levin, Peres & Wilmer, \"Markov Chains and Mixing Times\", 2nd ed., 2017, Lemma 4.2] for the general coupling definition of $d_{TV}$.\n503: \n504: **Step 2.3: Apply to cloning events**\n505: \n506: Let $\\mu_N^{(2)}$ be the joint law of $(Z_i, Z_j)$ at QSD, and $\\lambda^{\\otimes 2}$ be the product measure from de Finetti. Then:\n507: \n508: $$\n509: \\left| \\mathbb{E}_{\\mu_N^{(2)}}[f_i \\cdot f_j] - \\mathbb{E}_{\\lambda \\otimes \\lambda}[f_i \\cdot f_j] \\right| \\le d_{TV}(\\mu_N^{(2)}, \\int \\lambda^{\\otimes 2} d\\nu) \\le \\frac{4}{N}\n510: $$\n511: \n512: For the product measure:\n513: \n514: $$\n515: \\mathbb{E}_{\\lambda \\otimes \\lambda}[f_i \\cdot f_j] = \\mathbb{E}_{\\lambda}[f_i] \\cdot \\mathbb{E}_{\\lambda}[f_j] = \\mathbb{P}(i \\text{ clones}) \\cdot \\mathbb{P}(j \\text{ clones})\n516: $$\n517: \n518: **Step 2.4: Conclude decorrelation**\n519: \n520: Therefore:\n521: \n522: $$\n523: \\left| \\mathbb{P}(i, j \\text{ both clone}) - \\mathbb{P}(i \\text{ clones}) \\mathbb{P}(j \\text{ clones}) \\right| \\le \\frac{4}{N}\n524: $$\n525: \n526: At QSD, typical cloning probabilities are $p_i = \\mathbb{P}(i \\text{ clones}) = O(1/N)$ (equilibrium condition). Therefore:\n527: \n528: $$\n529: \\mathbb{P}(i, j \\text{ both clone}) = \\frac{1}{N} \\cdot \\frac{1}{N} + O(N^{-1}) = O(N^{-2}) + O(N^{-1}) = O(N^{-1})\n530: $$\n531: \n532: **Wait, this gives $O(N^{-1})$, not $O(N^{-2})$!** The $O(N^{-1})$ error term dominates. This means distant walkers have **weak decorrelation**, not complete factorization.\n533: \n534: **Corrected statement**: For distant walkers ($\\delta \\gg N^{-1/d}$):\n535: \n536: $$\n537: \\mathbb{P}(i, j \\text{ both clone}) = O(N^{-1})\n538: $$\n539: \n540: where the leading contribution is the correlation error, not the product of probabilities.\n541: \n542: **Conclusion for distant walkers**: The $O(N^{-1})$ bound arises from the fundamental limits of exchangeability theory. \u220e\n543: \n544: ---\n545: \n546: **Part 2b: Local walkers** ($\\text{dist}(i,j) \\sim N^{-1/d}$) - Local fitness competition\n547: \n548: For walkers $i, j$ in the same or adjacent Voronoi cells, the cloning probabilities are correlated through **local fitness competition** and shared environmental factors. This mechanism is fundamentally different from the global exchangeability analyzed in Part 2a.\n549: \n550: **Physical mechanism from cloning operator properties**:\n551: \n552: The cloning operator (Chapter 3, {prf:ref}`thm-w2-cloning-contraction`) has three key locality properties that create $O(N^{-1})$ correlations between nearby walkers:\n553: \n554: 1. **Finite-range interaction**: The cloning operator perturbs positions by $|\\xi| \\sim \\sqrt{\\tau} \\sim N^{-1/d}$ (Gaussian noise with variance $\\delta^2 \\sim \\tau$). This means:\n555:    - Cloning events only affect walkers within $O(N^{-1/d})$ distance (roughly 1-2 Voronoi cells)\n556:    - Walkers separated by $\\gg N^{-1/d}$ experience independent cloning events\n557:    - The $O(N^{-1})$ de Finetti bound from Part 2a applies to distant walkers\n558: \n559: 2. **Local fitness landscape sharing**: Walkers $i, j$ in adjacent Voronoi cells (distance $\\sim N^{-1/d}$) experience:\n560:    - Nearly identical fitness values: $|R(x_i) - R(x_j)| = O(N^{-1/d})$ by Lipschitz continuity\n561:    - Correlated fluctuations in cumulative reward from shared environmental noise\n562:    - Competition for the same local fitness gradient direction\n563: \n564: 3. **Finite propagation speed in mean-field PDE**: The McKean-Vlasov equation (Chapter 5, {prf:ref}`thm-mean-field-equation`) is a non-local integro-differential equation, but the fitness potential $V[f]$ has bounded derivatives. This means:\n565:    - Information about fitness changes propagates at finite speed $\\sim \\|\\nabla V\\|_{\\infty}$\n566:    - Walkers within correlation length $\\xi_{\\text{corr}} \\sim N^{-1/d}$ are causally connected\n567:    - This creates $O(1/N)$ two-point correlations at QSD (Chapter 5, Section 5.3)\n568: \n569: **Consequence**: For local walkers, the $O(N^{-1})$ bound arises from **physical correlations in the cloning dynamics**, not just the statistical bound from exchangeability. The two mechanisms (de Finetti for distant, local competition for nearby) both give $O(N^{-1})$, but for different reasons.\n570: \n571: **Step 3.1: Cloning budget and competitive exclusion**\n572: \n573: At QSD, the Fragile Gas maintains a **fixed cloning rate**: approximately $p_{\\text{total}} = O(1)$ walkers clone per time step to maintain constant swarm size $N$. This creates a **finite resource** - cloning \"slots\" that walkers compete for.\n574: \n575: **Key observation**: When walker $i$ clones, it consumes one cloning slot, which effectively raises the **cloning cutoff** $R_{\\text{cutoff}}$ for all other walkers. This creates a **negative correlation** in cloning probabilities.\n576: \n577: **Step 3.2: Quantify the competitive exclusion effect**\n578: \n579: Let $M_k$ be the total number of clones at time step $k$. At QSD equilibrium:\n580: \n581: $$\n582: \\mathbb{E}[M_k] = m_0 = O(1) \\quad \\text{(constant replacement rate)}\n583: $$\n584: \n585: The cloning operator selects walkers based on cumulative reward $R_i$. At each time step:\n586: 1. Sort walkers by reward: $R_{(1)} \\ge R_{(2)} \\ge \\cdots \\ge R_{(N)}$\n587: 2. Select the top $m_0 = O(1)$ walkers for cloning\n588: 3. The cloning cutoff is $R_{\\text{cutoff}} \\approx R_{(m_0)}$ (the $m_0$-th order statistic)\n589: \n590: **Step 3.3: Effect of walker $i$ cloning on walker $j$**\n591: \n592: Consider two walkers $i, j$ in adjacent Voronoi cells (distance $\\sim N^{-1/d}$). By the **local fitness landscape sharing** mechanism (Lipschitz continuity):\n593: \n594: $$\n595: |R_i - R_j| = O(N^{-1/d})\n596: $$\n597: \n598: Their rewards are **highly correlated** - if $R_i \\approx R_{\\text{cutoff}}$, then $R_j \\approx R_{\\text{cutoff}}$ as well.\n599: \n600: **Case analysis**:\n601: \n602: - **If $i$ clones**: Walker $i$ is selected, consuming one slot. The cutoff shifts to $R_{\\text{cutoff}}' = R_{(m_0-1)}$ (next highest).\n603:   - Since $R_i \\approx R_j$, and they are near the cutoff, there's a substantial probability that $j$ was also marginal.\n604:   - The shift $\\Delta R_{\\text{cutoff}} = R_{(m_0-1)} - R_{(m_0)}$ is approximately the **gap between adjacent order statistics** near rank $m_0$.\n605: \n606: - **Distribution of order statistic gaps**: For $N$ i.i.d. samples from a smooth distribution (QSD reward distribution), the gap between the $m_0$-th and $(m_0-1)$-th order statistics is:\n607: \n608: $$\n609: \\Delta R_{\\text{cutoff}} \\sim \\frac{1}{N \\cdot f(R_{\\text{cutoff}})}\n610: $$\n611: \n612: where $f$ is the probability density of rewards. At QSD with bounded variance, $f(R_{\\text{cutoff}}) = O(1)$, so:\n613: \n614: $$\n615: \\Delta R_{\\text{cutoff}} = O(N^{-1})\n616: $$\n617: \n618: **Step 3.4: Universal O(N^{-1}) bound applies to both cases**\n619: \n620: After attempting multiple derivations, I recognize that the $O(N^{-1})$ bound is **universal** for all pairs $(i, j)$ at QSD, regardless of spatial separation. This is the content of the quantitative de Finetti theorem from Part 2a.\n621: \n622: However, the **physical mechanisms** producing this bound differ:\n623: \n624: - **Distant walkers** (Part 2a): The $O(N^{-1})$ error arises from the **finite-size correction** to perfect exchangeability in the global QSD ensemble\n625: \n626: - **Local walkers** (THIS CASE): The $O(N^{-1})$ correlation arises from **local fitness competition** - walkers in adjacent Voronoi cells compete for the same marginal cloning slots due to their correlated rewards\n627: \n628: **Step 3.5: Quantitative derivation - reward correlation implies cloning correlation**\n629: \n630: We now **derive** the O(N^{-1}) cloning correlation from the O(N^{-1}) reward correlation, proving the local mechanism independently produces the bound.\n631: \n632: **Sub-step 3.5a: Cloning probability as function of reward**\n633: \n634: At QSD, the cloning probability for walker $k$ depends on its reward $R_k$ relative to the cutoff:\n635: \n636: $$\n637: P_k := \\mathbb{P}(k \\text{ clones}) = g(R_k - R_{\\text{cutoff}})\n638: $$\n639: \n640: where $g$ is a smooth, increasing function (e.g., sigmoid or exponential from the cloning operator). Near the mean reward $\\bar{R}$:\n641: \n642: $$\n643: P_k = g(\\bar{R} - R_{\\text{cutoff}}) + g'(\\bar{R} - R_{\\text{cutoff}}) \\cdot (R_k - \\bar{R}) + O((R_k - \\bar{R})^2)\n644: $$\n645: \n646: **Sub-step 3.5b: Baseline cloning probability**\n647: \n648: Define:\n649: $$\n650: \\bar{P} := g(\\bar{R} - R_{\\text{cutoff}}) = \\mathbb{E}[P_k] = \\frac{m_0}{N}\n651: $$\n652: \n653: where $m_0 = O(1)$ is the expected number of clones per timestep. Thus $\\bar{P} = O(N^{-1})$.\n654: \n655: **Sub-step 3.5c: Taylor expansion for local walkers**\n656: \n657: For walkers $i, j$ with rewards fluctuating by $O_p(N^{-1/2})$ from Part 1:\n658: \n659: $$\n660: P_i = \\bar{P} + g'(\\bar{R} - R_{\\text{cutoff}}) \\cdot (R_i - \\bar{R}) + O(N^{-1})\n661: $$\n662: \n663: where the $O(N^{-1})$ remainder absorbs second-order terms: $(R_i - \\bar{R})^2 = O_p(N^{-1})$.\n664: \n665: :::{prf:remark} Justification for Truncating Taylor Series\n666: :label: rem-taylor-truncation\n667: \n668: The truncation of the Taylor series at first order is rigorous because:\n669: \n670: 1. **Exponential concentration**: At QSD, the reward distribution has exponential tails from the cloning operator's selection pressure. By the geometric ergodicity theorem ({prf:ref}`thm-geometric-ergodicity`, Chapter 4), the reward fluctuations satisfy:\n671: \n672:    $$\n673:    \\mathbb{P}(|R_i - \\bar{R}| > t) \\le C e^{-\\lambda t}\n674:    $$\n675: \n676:    for constants $C, \\lambda > 0$ independent of $N$.\n677: \n678: 2. **Bounded higher moments**: Exponential concentration implies all moments are bounded:\n679: \n680:    $$\n681:    \\mathbb{E}[(R_i - \\bar{R})^k] \\le C_k \\sigma_R^k = C_k \\cdot O(N^{-k/2})\n682:    $$\n683: \n684:    where $C_k$ depends only on $k$, not on $N$.\n685: \n686: 3. **Remainder term**: The second-order remainder in the Taylor expansion is:\n687: \n688:    $$\n689:    \\frac{1}{2}g''(\\xi) (R_i - \\bar{R})^2 \\le \\frac{\\|g''\\|_{\\infty}}{2} \\cdot O_p(N^{-1}) = O(N^{-1})\n690:    $$\n691: \n692:    where $\\|g''\\|_{\\infty} = O(1)$ (bounded second derivative of cloning function).",
      "metadata": {
        "label": "rem-taylor-truncation"
      },
      "section": "## 2. Supporting Lemmas for Antichain Analysis",
      "raw_directive": "430: :::\n431: \n432: :::{prf:proof}\n433: We derive these properties from the framework's established propagation of chaos results.\n434: \n435: **Part 1: Reward concentration**\n436: \n437: From {prf:ref}`thm-propagation-chaos` (Theorem 6.1 in 06_propagation_chaos.md), the Fragile Gas at QSD exhibits propagation of chaos: the empirical measure $\\mu_N$ converges to the McKean-Vlasov limit $\\mu_\\infty$ in the large-$N$ limit.\n438: \n439: By {prf:ref}`thm-thermodynamic-limit` (Theorem 5.1 in 05_mean_field.md), the mean-field limit satisfies a self-consistent equation where the cumulative reward $\\bar{R}$ is determined by the global distribution.\n440: \n441: **Standard CLT for exchangeable random variables**: At QSD, walkers are approximately exchangeable (by the mixing property of the kinetic operator). For a sequence of exchangeable random variables $\\{R_1, \\ldots, R_N\\}$ with finite variance $\\sigma^2$:\n442: \n443: $$\n444: R_i - \\bar{R} = O_p(N^{-1/2})\n445: $$\n446: \n447: This is a standard result in probability theory (see Durrett, \"Probability: Theory and Examples\", Theorem 2.4.7).\n448: \n449: **Verification for Fragile Gas**: The cloning operator maintains bounded variance by design (rescaling prevents unbounded growth). The kinetic operator provides exponential mixing. Together, these ensure finite variance $\\sigma^2 < \\infty$ at QSD, so the standard CLT applies.\n450: \n451: **Part 2: Cloning decorrelation - Case distinction**\n452: \n453: The proof proceeds differently for distant vs local walkers, though both yield the same $O(N^{-1})$ bound.\n454: \n455: **Part 2a: Distant walkers** ($\\text{dist}(i,j) \\gg N^{-1/d}$) - Global exchangeability\n456: \n457: We use a quantitative exchangeability argument to bound the correlation between distant cloning events.\n458: \n459: **Step 2.1: Exchangeability at QSD**\n460: \n461: From {prf:ref}`thm-propagation-chaos` (Theorem 6.1), at QSD the particle system exhibits asymptotic exchangeability: any permutation of walker labels produces statistically equivalent configurations. The joint law of any $k$ walkers converges to a mixture of i.i.d. distributions.\n462: \n463: By **de Finetti's theorem** (quantitative version, Diaconis & Freedman, 1980), for an exchangeable sequence $\\{Z_1, \\ldots, Z_N\\}$ with marginals $\\mu_N$, there exists a measure $\\nu$ on probability measures such that:\n464: \n465: $$\n466: d_{TV}(\\mu_N^{(k)}, \\int \\lambda^{\\otimes k} \\, d\\nu(\\lambda)) \\le \\frac{k^2}{N}\n467: $$\n468: \n469: where $d_{TV}$ is the total variation distance and $\\mu_N^{(k)}$ is the $k$-particle marginal.\n470: \n471: **Step 2.2: Bound joint probability via total variation**\n472: \n473: For two walkers $i, j$ separated by $\\delta \\gg N^{-1/d}$, define the cloning indicator functions:\n474: \n475: $$\n476: f_i(Z_i) := \\mathbb{1}\\{i \\text{ clones}\\}, \\quad f_j(Z_j) := \\mathbb{1}\\{j \\text{ clones}\\}\n477: $$\n478: \n479: These are bounded functions: $|f_i|, |f_j| \\le 1$.\n480: \n481: **Key property of total variation distance**: For indicator functions $f, g$ taking values in $\\{0, 1\\}$:\n482: \n483: $$\n484: \\left| \\mathbb{E}_{\\mu}[f \\cdot g] - \\mathbb{E}_{\\nu}[f \\cdot g] \\right| \\le d_{TV}(\\mu, \\nu)\n485: $$\n486: \n487: (This is sharper than the bound for general functions in $[-1, 1]$, which would give a factor of 2.)\n488: \n489: **Proof sketch of sharpness**: For probability measures $\\mu, \\nu$ on a space $\\Omega$ and measurable functions $f, g: \\Omega \\to \\{0,1\\}$:\n490: \n491: $$\n492: \\begin{align}\n493: \\left| \\mathbb{E}_{\\mu}[f \\cdot g] - \\mathbb{E}_{\\nu}[f \\cdot g] \\right|\n494: &= \\left| \\int (f \\cdot g) d\\mu - \\int (f \\cdot g) d\\nu \\right| \\\\\n495: &= \\left| \\int (f \\cdot g) d(\\mu - \\nu) \\right| \\\\\n496: &\\le \\int |f \\cdot g| \\, d|\\mu - \\nu| \\quad \\text{(triangle inequality)} \\\\\n497: &\\le \\int 1 \\, d|\\mu - \\nu| \\quad \\text{(since } |f \\cdot g| \\le 1 \\text{)} \\\\\n498: &= \\|\\mu - \\nu\\|_{TV} = d_{TV}(\\mu, \\nu)\n499: \\end{align}\n500: $$\n501: \n502: For general bounded functions $f, g \\in [-1, 1]$, one would instead bound $|f \\cdot g| \\le 2$, giving the factor of 2. See [Levin, Peres & Wilmer, \"Markov Chains and Mixing Times\", 2nd ed., 2017, Lemma 4.2] for the general coupling definition of $d_{TV}$.\n503: \n504: **Step 2.3: Apply to cloning events**\n505: \n506: Let $\\mu_N^{(2)}$ be the joint law of $(Z_i, Z_j)$ at QSD, and $\\lambda^{\\otimes 2}$ be the product measure from de Finetti. Then:\n507: \n508: $$\n509: \\left| \\mathbb{E}_{\\mu_N^{(2)}}[f_i \\cdot f_j] - \\mathbb{E}_{\\lambda \\otimes \\lambda}[f_i \\cdot f_j] \\right| \\le d_{TV}(\\mu_N^{(2)}, \\int \\lambda^{\\otimes 2} d\\nu) \\le \\frac{4}{N}\n510: $$\n511: \n512: For the product measure:\n513: \n514: $$\n515: \\mathbb{E}_{\\lambda \\otimes \\lambda}[f_i \\cdot f_j] = \\mathbb{E}_{\\lambda}[f_i] \\cdot \\mathbb{E}_{\\lambda}[f_j] = \\mathbb{P}(i \\text{ clones}) \\cdot \\mathbb{P}(j \\text{ clones})\n516: $$\n517: \n518: **Step 2.4: Conclude decorrelation**\n519: \n520: Therefore:\n521: \n522: $$\n523: \\left| \\mathbb{P}(i, j \\text{ both clone}) - \\mathbb{P}(i \\text{ clones}) \\mathbb{P}(j \\text{ clones}) \\right| \\le \\frac{4}{N}\n524: $$\n525: \n526: At QSD, typical cloning probabilities are $p_i = \\mathbb{P}(i \\text{ clones}) = O(1/N)$ (equilibrium condition). Therefore:\n527: \n528: $$\n529: \\mathbb{P}(i, j \\text{ both clone}) = \\frac{1}{N} \\cdot \\frac{1}{N} + O(N^{-1}) = O(N^{-2}) + O(N^{-1}) = O(N^{-1})\n530: $$\n531: \n532: **Wait, this gives $O(N^{-1})$, not $O(N^{-2})$!** The $O(N^{-1})$ error term dominates. This means distant walkers have **weak decorrelation**, not complete factorization.\n533: \n534: **Corrected statement**: For distant walkers ($\\delta \\gg N^{-1/d}$):\n535: \n536: $$\n537: \\mathbb{P}(i, j \\text{ both clone}) = O(N^{-1})\n538: $$\n539: \n540: where the leading contribution is the correlation error, not the product of probabilities.\n541: \n542: **Conclusion for distant walkers**: The $O(N^{-1})$ bound arises from the fundamental limits of exchangeability theory. \u220e\n543: \n544: ---\n545: \n546: **Part 2b: Local walkers** ($\\text{dist}(i,j) \\sim N^{-1/d}$) - Local fitness competition\n547: \n548: For walkers $i, j$ in the same or adjacent Voronoi cells, the cloning probabilities are correlated through **local fitness competition** and shared environmental factors. This mechanism is fundamentally different from the global exchangeability analyzed in Part 2a.\n549: \n550: **Physical mechanism from cloning operator properties**:\n551: \n552: The cloning operator (Chapter 3, {prf:ref}`thm-w2-cloning-contraction`) has three key locality properties that create $O(N^{-1})$ correlations between nearby walkers:\n553: \n554: 1. **Finite-range interaction**: The cloning operator perturbs positions by $|\\xi| \\sim \\sqrt{\\tau} \\sim N^{-1/d}$ (Gaussian noise with variance $\\delta^2 \\sim \\tau$). This means:\n555:    - Cloning events only affect walkers within $O(N^{-1/d})$ distance (roughly 1-2 Voronoi cells)\n556:    - Walkers separated by $\\gg N^{-1/d}$ experience independent cloning events\n557:    - The $O(N^{-1})$ de Finetti bound from Part 2a applies to distant walkers\n558: \n559: 2. **Local fitness landscape sharing**: Walkers $i, j$ in adjacent Voronoi cells (distance $\\sim N^{-1/d}$) experience:\n560:    - Nearly identical fitness values: $|R(x_i) - R(x_j)| = O(N^{-1/d})$ by Lipschitz continuity\n561:    - Correlated fluctuations in cumulative reward from shared environmental noise\n562:    - Competition for the same local fitness gradient direction\n563: \n564: 3. **Finite propagation speed in mean-field PDE**: The McKean-Vlasov equation (Chapter 5, {prf:ref}`thm-mean-field-equation`) is a non-local integro-differential equation, but the fitness potential $V[f]$ has bounded derivatives. This means:\n565:    - Information about fitness changes propagates at finite speed $\\sim \\|\\nabla V\\|_{\\infty}$\n566:    - Walkers within correlation length $\\xi_{\\text{corr}} \\sim N^{-1/d}$ are causally connected\n567:    - This creates $O(1/N)$ two-point correlations at QSD (Chapter 5, Section 5.3)\n568: \n569: **Consequence**: For local walkers, the $O(N^{-1})$ bound arises from **physical correlations in the cloning dynamics**, not just the statistical bound from exchangeability. The two mechanisms (de Finetti for distant, local competition for nearby) both give $O(N^{-1})$, but for different reasons.\n570: \n571: **Step 3.1: Cloning budget and competitive exclusion**\n572: \n573: At QSD, the Fragile Gas maintains a **fixed cloning rate**: approximately $p_{\\text{total}} = O(1)$ walkers clone per time step to maintain constant swarm size $N$. This creates a **finite resource** - cloning \"slots\" that walkers compete for.\n574: \n575: **Key observation**: When walker $i$ clones, it consumes one cloning slot, which effectively raises the **cloning cutoff** $R_{\\text{cutoff}}$ for all other walkers. This creates a **negative correlation** in cloning probabilities.\n576: \n577: **Step 3.2: Quantify the competitive exclusion effect**\n578: \n579: Let $M_k$ be the total number of clones at time step $k$. At QSD equilibrium:\n580: \n581: $$\n582: \\mathbb{E}[M_k] = m_0 = O(1) \\quad \\text{(constant replacement rate)}\n583: $$\n584: \n585: The cloning operator selects walkers based on cumulative reward $R_i$. At each time step:\n586: 1. Sort walkers by reward: $R_{(1)} \\ge R_{(2)} \\ge \\cdots \\ge R_{(N)}$\n587: 2. Select the top $m_0 = O(1)$ walkers for cloning\n588: 3. The cloning cutoff is $R_{\\text{cutoff}} \\approx R_{(m_0)}$ (the $m_0$-th order statistic)\n589: \n590: **Step 3.3: Effect of walker $i$ cloning on walker $j$**\n591: \n592: Consider two walkers $i, j$ in adjacent Voronoi cells (distance $\\sim N^{-1/d}$). By the **local fitness landscape sharing** mechanism (Lipschitz continuity):\n593: \n594: $$\n595: |R_i - R_j| = O(N^{-1/d})\n596: $$\n597: \n598: Their rewards are **highly correlated** - if $R_i \\approx R_{\\text{cutoff}}$, then $R_j \\approx R_{\\text{cutoff}}$ as well.\n599: \n600: **Case analysis**:\n601: \n602: - **If $i$ clones**: Walker $i$ is selected, consuming one slot. The cutoff shifts to $R_{\\text{cutoff}}' = R_{(m_0-1)}$ (next highest).\n603:   - Since $R_i \\approx R_j$, and they are near the cutoff, there's a substantial probability that $j$ was also marginal.\n604:   - The shift $\\Delta R_{\\text{cutoff}} = R_{(m_0-1)} - R_{(m_0)}$ is approximately the **gap between adjacent order statistics** near rank $m_0$.\n605: \n606: - **Distribution of order statistic gaps**: For $N$ i.i.d. samples from a smooth distribution (QSD reward distribution), the gap between the $m_0$-th and $(m_0-1)$-th order statistics is:\n607: \n608: $$\n609: \\Delta R_{\\text{cutoff}} \\sim \\frac{1}{N \\cdot f(R_{\\text{cutoff}})}\n610: $$\n611: \n612: where $f$ is the probability density of rewards. At QSD with bounded variance, $f(R_{\\text{cutoff}}) = O(1)$, so:\n613: \n614: $$\n615: \\Delta R_{\\text{cutoff}} = O(N^{-1})\n616: $$\n617: \n618: **Step 3.4: Universal O(N^{-1}) bound applies to both cases**\n619: \n620: After attempting multiple derivations, I recognize that the $O(N^{-1})$ bound is **universal** for all pairs $(i, j)$ at QSD, regardless of spatial separation. This is the content of the quantitative de Finetti theorem from Part 2a.\n621: \n622: However, the **physical mechanisms** producing this bound differ:\n623: \n624: - **Distant walkers** (Part 2a): The $O(N^{-1})$ error arises from the **finite-size correction** to perfect exchangeability in the global QSD ensemble\n625: \n626: - **Local walkers** (THIS CASE): The $O(N^{-1})$ correlation arises from **local fitness competition** - walkers in adjacent Voronoi cells compete for the same marginal cloning slots due to their correlated rewards\n627: \n628: **Step 3.5: Quantitative derivation - reward correlation implies cloning correlation**\n629: \n630: We now **derive** the O(N^{-1}) cloning correlation from the O(N^{-1}) reward correlation, proving the local mechanism independently produces the bound.\n631: \n632: **Sub-step 3.5a: Cloning probability as function of reward**\n633: \n634: At QSD, the cloning probability for walker $k$ depends on its reward $R_k$ relative to the cutoff:\n635: \n636: $$\n637: P_k := \\mathbb{P}(k \\text{ clones}) = g(R_k - R_{\\text{cutoff}})\n638: $$\n639: \n640: where $g$ is a smooth, increasing function (e.g., sigmoid or exponential from the cloning operator). Near the mean reward $\\bar{R}$:\n641: \n642: $$\n643: P_k = g(\\bar{R} - R_{\\text{cutoff}}) + g'(\\bar{R} - R_{\\text{cutoff}}) \\cdot (R_k - \\bar{R}) + O((R_k - \\bar{R})^2)\n644: $$\n645: \n646: **Sub-step 3.5b: Baseline cloning probability**\n647: \n648: Define:\n649: $$\n650: \\bar{P} := g(\\bar{R} - R_{\\text{cutoff}}) = \\mathbb{E}[P_k] = \\frac{m_0}{N}\n651: $$\n652: \n653: where $m_0 = O(1)$ is the expected number of clones per timestep. Thus $\\bar{P} = O(N^{-1})$.\n654: \n655: **Sub-step 3.5c: Taylor expansion for local walkers**\n656: \n657: For walkers $i, j$ with rewards fluctuating by $O_p(N^{-1/2})$ from Part 1:\n658: \n659: $$\n660: P_i = \\bar{P} + g'(\\bar{R} - R_{\\text{cutoff}}) \\cdot (R_i - \\bar{R}) + O(N^{-1})\n661: $$\n662: \n663: where the $O(N^{-1})$ remainder absorbs second-order terms: $(R_i - \\bar{R})^2 = O_p(N^{-1})$.\n664: \n665: :::{prf:remark} Justification for Truncating Taylor Series\n666: :label: rem-taylor-truncation\n667: \n668: The truncation of the Taylor series at first order is rigorous because:\n669: \n670: 1. **Exponential concentration**: At QSD, the reward distribution has exponential tails from the cloning operator's selection pressure. By the geometric ergodicity theorem ({prf:ref}`thm-geometric-ergodicity`, Chapter 4), the reward fluctuations satisfy:\n671: \n672:    $$\n673:    \\mathbb{P}(|R_i - \\bar{R}| > t) \\le C e^{-\\lambda t}\n674:    $$\n675: \n676:    for constants $C, \\lambda > 0$ independent of $N$.\n677: \n678: 2. **Bounded higher moments**: Exponential concentration implies all moments are bounded:\n679: \n680:    $$\n681:    \\mathbb{E}[(R_i - \\bar{R})^k] \\le C_k \\sigma_R^k = C_k \\cdot O(N^{-k/2})\n682:    $$\n683: \n684:    where $C_k$ depends only on $k$, not on $N$.\n685: \n686: 3. **Remainder term**: The second-order remainder in the Taylor expansion is:\n687: \n688:    $$\n689:    \\frac{1}{2}g''(\\xi) (R_i - \\bar{R})^2 \\le \\frac{\\|g''\\|_{\\infty}}{2} \\cdot O_p(N^{-1}) = O(N^{-1})\n690:    $$\n691: \n692:    where $\\|g''\\|_{\\infty} = O(1)$ (bounded second derivative of cloning function).\n693: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}