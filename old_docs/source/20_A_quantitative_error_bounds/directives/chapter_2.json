{
  "chapter_index": 2,
  "section_id": "## Part II: Time Discretization Error Bounds",
  "directive_count": 8,
  "hints": [
    {
      "directive_type": "proposition",
      "label": "prop-fourth-moment-baoab",
      "title": "Fourth-Moment Uniform Bounds for BAOAB",
      "start_line": 842,
      "end_line": 852,
      "header_lines": [
        843
      ],
      "content_start": 845,
      "content_end": 851,
      "content": "845: :label: prop-fourth-moment-baoab\n846: \n847: Let $\\{Z_k\\}_{k \\geq 0}$ be the BAOAB chain with step size $\\Delta t$ initialized from the continuous-time invariant measure $\\nu^{\\text{cont}}$. Under the confinement axiom ({prf:ref}`def-confined-potential`), there exists a constant $M_4 < \\infty$ independent of $\\Delta t$ (for $\\Delta t$ sufficiently small) such that:\n848: \n849: $$\n850: \\sup_{k \\geq 0} \\mathbb{E}_{\\nu^{\\text{cont}}} [|Z_k|^4] \\leq M_4\n851: $$",
      "metadata": {
        "label": "prop-fourth-moment-baoab"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "842: Before proving weak convergence, we need uniform moment bounds for the BAOAB iterates.\n843: \n844: :::{prf:proposition} Fourth-Moment Uniform Bounds for BAOAB\n845: :label: prop-fourth-moment-baoab\n846: \n847: Let $\\{Z_k\\}_{k \\geq 0}$ be the BAOAB chain with step size $\\Delta t$ initialized from the continuous-time invariant measure $\\nu^{\\text{cont}}$. Under the confinement axiom ({prf:ref}`def-confined-potential`), there exists a constant $M_4 < \\infty$ independent of $\\Delta t$ (for $\\Delta t$ sufficiently small) such that:\n848: \n849: $$\n850: \\sup_{k \\geq 0} \\mathbb{E}_{\\nu^{\\text{cont}}} [|Z_k|^4] \\leq M_4\n851: $$\n852: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-28",
      "title": null,
      "start_line": 854,
      "end_line": 1176,
      "header_lines": [],
      "content_start": 856,
      "content_end": 1175,
      "content": "856: :::{prf:proof}\n857: \n858: The proof uses the energy bounds and geometric ergodicity of the BAOAB chain.\n859: \n860: **Step 1: Energy functional**\n861: \n862: Define the discrete-time energy:\n863: \n864: $$\n865: E(Z) := \\frac{1}{2}|v|^2 + U(x)\n866: $$\n867: \n868: From the energy bounds for the continuous-time Langevin dynamics ({prf:ref}`thm-energy-bounds`), we have:\n869: \n870: $$\n871: \\mathbb{E}_{\\nu^{\\text{cont}}} [E(Z)] = \\mathbb{E}_{\\nu^{\\text{cont}}} \\left[\\frac{1}{2}|v|^2 + U(x)\\right] < \\infty\n872: $$\n873: \n874: **Step 2: BAOAB energy evolution**\n875: \n876: The BAOAB integrator consists of:\n877: - **B step** (position): $x_{k+1/5} = x_k + \\frac{\\Delta t}{2} v_k$\n878: - **A step** (friction): $v_{k+2/5} = e^{-\\gamma \\Delta t/2} v_{k+1/5}$\n879: - **O step** (Ornstein-Uhlenbeck): $v_{k+3/5} = v_{k+2/5} + \\sqrt{1 - e^{-\\gamma \\Delta t}} \\xi_k$ where $\\xi_k \\sim \\mathcal{N}(0, \\frac{\\sigma^2}{\\gamma} I)$\n880: - **A step** (friction): $v_{k+4/5} = e^{-\\gamma \\Delta t/2} v_{k+3/5}$\n881: - **B step** (position): $x_{k+1} = x_{k+1/5} + \\frac{\\Delta t}{2} v_{k+4/5}$\n882: \n883: For the O-step (where noise is added), the expected energy change is:\n884: \n885: $$\n886: \\mathbb{E}[|v_{k+3/5}|^2] = |v_{k+2/5}|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma}\n887: $$\n888: \n889: where $d$ is the dimension.\n890: \n891: **Step 3: Energy dissipation from drift**\n892: \n893: The A-steps provide exponential friction:\n894: \n895: $$\n896: |v_{k+2/5}|^2 = e^{-\\gamma \\Delta t} |v_{k+1/5}|^2 \\leq |v_{k+1/5}|^2\n897: $$\n898: \n899: The B-steps change position but not velocity magnitude. However, they couple velocity to the potential gradient.\n900: \n901: By the confinement condition:\n902: \n903: $$\n904: \\mathbb{E}[\\Delta U] \\approx \\mathbb{E}[\\langle \\nabla U(x_k), \\Delta x_k \\rangle] = \\frac{\\Delta t}{2} \\mathbb{E}[\\langle \\nabla U(x_k), v_k \\rangle]\n905: $$\n906: \n907: For large $|x|$, confinement gives $\\langle x, \\nabla U(x) \\rangle \\geq \\kappa_{\\text{conf}} |x|^2$, providing a restoring force.\n908: \n909: **Step 4: Lyapunov bound**\n910: \n911: Combining the heating (O-step) and dissipation (friction + confinement), the energy satisfies a Lyapunov inequality:\n912: \n913: $$\n914: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_E \\Delta t) E(Z_k) + C_E \\Delta t\n915: $$\n916: \n917: for some constants $\\kappa_E, C_E > 0$ (dependent on $\\gamma, \\sigma, \\kappa_{\\text{conf}}$) when $\\Delta t$ is sufficiently small.\n918: \n919: At stationarity ($k \\to \\infty$):\n920: \n921: $$\n922: \\mathbb{E}_{\\nu^{\\Delta t}} [E(Z)] \\leq \\frac{C_E}{\\kappa_E}\n923: $$\n924: \n925: **Step 5: From energy to fourth moment (Lyapunov on $E^2$)**\n926: \n927: To rigorously bound the fourth moment, we use a Lyapunov argument on $E^2(Z) = (\\frac{1}{2}|v|^2 + U(x))^2$.\n928: \n929: **Substep 5.1: Lyapunov inequality for $E^2$**\n930: \n931: We will show:\n932: \n933: $$\n934: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_4 \\Delta t) E^2(Z_k) + C_4 \\Delta t\n935: $$\n936: \n937: for some constants $\\kappa_4, C_4 > 0$ when $\\Delta t$ is sufficiently small.\n938: \n939: **Substep 5.2: Direct analysis of $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$**\n940: \n941: We will compute $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$ by tracking the evolution through all five BAOAB substeps. Define:\n942: \n943: $$\n944: V(Z) := E^2(Z) = \\left(\\frac{1}{2}|v|^2 + U(x)\\right)^2\n945: $$\n946: \n947: Let $Z_k = (x_k, v_k)$ and track the evolution:\n948: - After B: $(x', v_k)$ where $x' = x_k + \\frac{\\Delta t}{2} v_k$\n949: - After A: $(x', v')$ where $v' = e^{-\\gamma \\Delta t/2} v_k$\n950: - After O: $(x', v'')$ where $v'' = v' + \\xi$ and $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n951: - After A: $(x', v''')$ where $v''' = e^{-\\gamma \\Delta t/2} v''$\n952: - After B: $(x_{k+1}, v''')$ where $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n953: \n954: **Substep 5.3: Expansion of $E^2(Z_{k+1})$**\n955: \n956: The energy at step $k+1$ is:\n957: \n958: $$\n959: E(Z_{k+1}) = \\frac{1}{2}|v'''|^2 + U(x_{k+1})\n960: $$\n961: \n962: Expand $U(x_{k+1})$ using Taylor expansion around $x_k$:\n963: \n964: $$\n965: U(x_{k+1}) = U(x_k) + \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n966: $$\n967: \n968: where $\\xi$ is between $x_k$ and $x_{k+1}$.\n969: \n970: Since $|x_{k+1} - x_k| = O(\\Delta t |v_k|)$, we have:\n971: \n972: $$\n973: U(x_{k+1}) = U(x_k) + O(\\Delta t |v_k| |\\nabla U(x_k)|) + O((\\Delta t)^2 |v_k|^2 \\|\\nabla^2 U\\|)\n974: $$\n975: \n976: For $|v'''|^2$, after the A-O-A composition:\n977: \n978: $$\n979: |v'''|^2 = e^{-\\gamma \\Delta t} |v_k|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma} + O(\\Delta t |v_k| |\\xi|)\n980: $$\n981: \n982: where $\\mathbb{E}[|\\xi|^2] = (1-e^{-\\gamma \\Delta t})\\frac{d\\sigma^2}{\\gamma}$.\n983: \n984: **Substep 5.4: Control of $\\mathbb{E}[V(Z_{k+1}) | Z_k]$ for large $V(Z_k)$**\n985: \n986: For large energy $E(Z_k)$, the key observation is:\n987: \n988: 1. **Dissipation from friction**: The velocity magnitude decays by factor $e^{-\\gamma \\Delta t} \\approx 1 - \\gamma \\Delta t$\n989: 2. **Heating from noise**: The noise adds energy $\\sim d\\sigma^2/(2\\gamma)$\n990: 3. **Potential growth**: The potential can increase, but confinement controls this\n991: \n992: Combining these effects, for large $E(Z_k)$:\n993: \n994: $$\n995: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq E(Z_k) - \\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n996: $$\n997: \n998: where $\\kappa_E \\sim \\gamma$ (friction) and $C_E$ accounts for noise and confinement.\n999: \n1000: For $V(Z_k) = E^2(Z_k)$, we need to control:\n1001: \n1002: $$\n1003: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = \\mathbb{E}[(E(Z_k) + \\Delta E)^2 | Z_k]\n1004: $$\n1005: \n1006: where $\\Delta E := E(Z_{k+1}) - E(Z_k)$.\n1007: \n1008: Expanding:\n1009: \n1010: $$\n1011: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = E^2(Z_k) + 2 E(Z_k) \\mathbb{E}[\\Delta E | Z_k] + \\mathbb{E}[(\\Delta E)^2 | Z_k]\n1012: $$\n1013: \n1014: **Substep 5.5: Bound the terms**\n1015: \n1016: From the first-moment analysis:\n1017: \n1018: $$\n1019: \\mathbb{E}[\\Delta E | Z_k] \\leq -\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n1020: $$\n1021: \n1022: For the second term, we need to bound the variance of the energy change. We will derive this carefully.\n1023: \n1024: **Proof of variance bound**: Recall $\\Delta E = E(Z_{k+1}) - E(Z_k)$ where the BAOAB evolution takes $Z_k = (x_k, v_k)$ to $Z_{k+1} = (x_{k+1}, v''')$ through:\n1025: - B: $x' = x_k + \\frac{\\Delta t}{2} v_k$\n1026: - A: $v' = e^{-\\gamma \\Delta t/2} v_k$\n1027: - O: $v'' = v' + \\xi$ where $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n1028: - A: $v''' = e^{-\\gamma \\Delta t/2} v''$\n1029: - B: $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n1030: \n1031: The energy change is:\n1032: \n1033: $$\n1034: \\Delta E = \\frac{1}{2}(|v'''|^2 - |v_k|^2) + (U(x_{k+1}) - U(x_k))\n1035: $$\n1036: \n1037: **Velocity contribution**: After A-O-A composition:\n1038: \n1039: $$\n1040: v''' = e^{-\\gamma \\Delta t/2}(e^{-\\gamma \\Delta t/2} v_k + \\xi) = e^{-\\gamma \\Delta t} v_k + e^{-\\gamma \\Delta t/2} \\xi\n1041: $$\n1042: \n1043: Therefore:\n1044: \n1045: $$\n1046: |v'''|^2 = e^{-2\\gamma \\Delta t} |v_k|^2 + 2 e^{-3\\gamma \\Delta t/2} \\langle v_k, \\xi \\rangle + e^{-\\gamma \\Delta t} |\\xi|^2\n1047: $$\n1048: \n1049: The variance of the velocity contribution:\n1050: \n1051: $$\n1052: \\text{Var}[\\frac{1}{2}(|v'''|^2 - |v_k|^2) | Z_k] \\leq C_v (\\Delta t)^2 |v_k|^4 + C'_v \\Delta t |v_k|^2 + C''_v \\Delta t\n1053: $$\n1054: \n1055: where we used $\\mathbb{E}[|\\xi|^2] = O(\\Delta t)$, $\\mathbb{E}[|\\xi|^4] = O((\\Delta t)^2)$, and $\\mathbb{E}[\\langle v_k, \\xi \\rangle^2] = |v_k|^2 \\mathbb{E}[|\\xi|^2] = O(\\Delta t |v_k|^2)$.\n1056: \n1057: **Potential contribution**: Using Taylor expansion:\n1058: \n1059: $$\n1060: U(x_{k+1}) - U(x_k) = \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n1061: $$\n1062: \n1063: Since $|x_{k+1} - x_k| = O(\\Delta t (|v_k| + |v'''|)) = O(\\Delta t |v_k|) + O((\\Delta t)^{3/2})$, we have:\n1064: \n1065: $$\n1066: \\text{Var}[U(x_{k+1}) - U(x_k) | Z_k] \\leq C_U (\\Delta t)^2 |v_k|^2 \\|\\nabla U\\|^2 + C'_U \\Delta t \\|\\nabla U\\|^2\n1067: $$\n1068: \n1069: **Cross-term**: The expansion $(\\Delta E)^2 = (\\Delta E_v)^2 + (\\Delta E_U)^2 + 2 \\Delta E_v \\Delta E_U$ includes a cross-term. By Cauchy-Schwarz:\n1070: \n1071: $$\n1072: 2|\\mathbb{E}[\\Delta E_v \\Delta E_U | Z_k]| \\leq 2\\sqrt{\\text{Var}[\\Delta E_v | Z_k] \\cdot \\text{Var}[\\Delta E_U | Z_k]} \\leq \\text{Var}[\\Delta E_v | Z_k] + \\text{Var}[\\Delta E_U | Z_k]\n1073: $$\n1074: \n1075: This is absorbed into the bounds for the squared terms.\n1076: \n1077: **Combine**: Using $|v_k|^2 \\leq 2 E(Z_k)$ and combining all terms (velocity, potential, and cross-term):\n1078: \n1079: $$\n1080: \\mathbb{E}[(\\Delta E)^2 | Z_k] \\leq C_{\\text{var}} \\Delta t (1 + E(Z_k))\n1081: $$\n1082: \n1083: where $C_{\\text{var}} = 2\\max\\{C_v + C_U, C'_v + C'_U, C''_v\\}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|, \\|\\nabla^2 U\\|$.\n1084: \n1085: Combining:\n1086: \n1087: $$\n1088: \\begin{align*}\n1089: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) + 2 E(Z_k) (-\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t) + C_{\\text{var}} \\Delta t (1 + E(Z_k)) \\\\\n1090: &= E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) + C_{\\text{var}} \\Delta t\n1091: \\end{align*}\n1092: $$\n1093: \n1094: **Handle the linear term using Young's inequality**: The term $(2 C_E + C_{\\text{var}}) \\Delta t E(Z_k)$ grows with $E(Z_k)$ and cannot be absorbed into a constant. We use Young's inequality: for any $\\epsilon > 0$,\n1095: \n1096: $$\n1097: E(Z_k) \\leq \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon}\n1098: $$\n1099: \n1100: Therefore:\n1101: \n1102: $$\n1103: (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) \\leq (2 C_E + C_{\\text{var}}) \\Delta t \\left[ \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon} \\right]\n1104: $$\n1105: \n1106: **Choose $\\epsilon$ to absorb into dissipation**: Set\n1107: \n1108: $$\n1109: \\epsilon := \\frac{\\kappa_E}{2 C_E + C_{\\text{var}}}\n1110: $$\n1111: \n1112: Then:\n1113: \n1114: $$\n1115: (2 C_E + C_{\\text{var}}) \\Delta t \\epsilon E^2(Z_k) = \\kappa_E \\Delta t E^2(Z_k)\n1116: $$\n1117: \n1118: Substituting back:\n1119: \n1120: $$\n1121: \\begin{align*}\n1122: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + \\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t \\cdot \\frac{1}{4\\epsilon} + C_{\\text{var}} \\Delta t \\\\\n1123: &= E^2(Z_k) - \\kappa_E \\Delta t E^2(Z_k) + \\left[ \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}} \\right] \\Delta t \\\\\n1124: &= (1 - \\kappa_E \\Delta t) E^2(Z_k) + C'_4 \\Delta t\n1125: \\end{align*}\n1126: $$\n1127: \n1128: where:\n1129: \n1130: $$\n1131: C'_4 := \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\n1132: $$\n1133: \n1134: This gives the Lyapunov inequality with $\\kappa_4 := \\kappa_E$ and $C_4 := C'_4$.\n1135: \n1136: **Substep 5.6: Stationary second moment**\n1137: \n1138: At stationarity:\n1139: \n1140: $$\n1141: \\mathbb{E}_{\\nu^{\\Delta t}} [E^2(Z)] \\leq \\frac{C_4}{\\kappa_4} = \\frac{C'_4}{\\kappa_E} = \\frac{1}{\\kappa_E}\\left[\\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\\right]\n1142: $$\n1143: \n1144: **Substep 5.7: From $E^2$ to fourth moment**\n1145: \n1146: Since $E(Z) = \\frac{1}{2}|v|^2 + U(x)$, we have:\n1147: \n1148: $$\n1149: |Z|^4 = (|x|^2 + |v|^2)^2 \\leq C_{\\text{coeff}} (|v|^4 + |x|^4)\n1150: $$\n1151: \n1152: By confinement, $U(x) \\geq \\kappa_{\\text{conf}} |x|^2 - C_{\\text{conf}}$, so:\n1153: \n1154: $$\n1155: |x|^2 \\leq \\frac{1}{\\kappa_{\\text{conf}}} (U(x) + C_{\\text{conf}}) \\leq \\frac{1}{\\kappa_{\\text{conf}}} (E(Z) + C_{\\text{conf}})\n1156: $$\n1157: \n1158: Therefore:\n1159: \n1160: $$\n1161: |x|^4 \\leq \\frac{1}{\\kappa_{\\text{conf}}^2} (E(Z) + C_{\\text{conf}})^2 \\leq \\frac{2}{\\kappa_{\\text{conf}}^2} (E^2(Z) + C_{\\text{conf}}^2)\n1162: $$\n1163: \n1164: Similarly, $|v|^4 \\leq 4 E^2(Z)$ since $|v|^2 \\leq 2 E(Z)$.\n1165: \n1166: Combining:\n1167: \n1168: $$\n1169: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq C_{\\text{coeff}} \\left( 4 \\mathbb{E}[E^2(Z)] + \\frac{2}{\\kappa_{\\text{conf}}^2} (\\mathbb{E}[E^2(Z)] + C_{\\text{conf}}^2) \\right)\n1170: $$\n1171: \n1172: $$\n1173: \\leq M_4 := C_{\\text{coeff}} \\left( 4 + \\frac{2}{\\kappa_{\\text{conf}}^2} \\right) \\frac{C_4}{\\kappa_4} + \\frac{2 C_{\\text{coeff}} C_{\\text{conf}}^2}{\\kappa_{\\text{conf}}^2}\n1174: $$\n1175: ",
      "metadata": {},
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "854: :::\n855: \n856: :::{prf:proof}\n857: \n858: The proof uses the energy bounds and geometric ergodicity of the BAOAB chain.\n859: \n860: **Step 1: Energy functional**\n861: \n862: Define the discrete-time energy:\n863: \n864: $$\n865: E(Z) := \\frac{1}{2}|v|^2 + U(x)\n866: $$\n867: \n868: From the energy bounds for the continuous-time Langevin dynamics ({prf:ref}`thm-energy-bounds`), we have:\n869: \n870: $$\n871: \\mathbb{E}_{\\nu^{\\text{cont}}} [E(Z)] = \\mathbb{E}_{\\nu^{\\text{cont}}} \\left[\\frac{1}{2}|v|^2 + U(x)\\right] < \\infty\n872: $$\n873: \n874: **Step 2: BAOAB energy evolution**\n875: \n876: The BAOAB integrator consists of:\n877: - **B step** (position): $x_{k+1/5} = x_k + \\frac{\\Delta t}{2} v_k$\n878: - **A step** (friction): $v_{k+2/5} = e^{-\\gamma \\Delta t/2} v_{k+1/5}$\n879: - **O step** (Ornstein-Uhlenbeck): $v_{k+3/5} = v_{k+2/5} + \\sqrt{1 - e^{-\\gamma \\Delta t}} \\xi_k$ where $\\xi_k \\sim \\mathcal{N}(0, \\frac{\\sigma^2}{\\gamma} I)$\n880: - **A step** (friction): $v_{k+4/5} = e^{-\\gamma \\Delta t/2} v_{k+3/5}$\n881: - **B step** (position): $x_{k+1} = x_{k+1/5} + \\frac{\\Delta t}{2} v_{k+4/5}$\n882: \n883: For the O-step (where noise is added), the expected energy change is:\n884: \n885: $$\n886: \\mathbb{E}[|v_{k+3/5}|^2] = |v_{k+2/5}|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma}\n887: $$\n888: \n889: where $d$ is the dimension.\n890: \n891: **Step 3: Energy dissipation from drift**\n892: \n893: The A-steps provide exponential friction:\n894: \n895: $$\n896: |v_{k+2/5}|^2 = e^{-\\gamma \\Delta t} |v_{k+1/5}|^2 \\leq |v_{k+1/5}|^2\n897: $$\n898: \n899: The B-steps change position but not velocity magnitude. However, they couple velocity to the potential gradient.\n900: \n901: By the confinement condition:\n902: \n903: $$\n904: \\mathbb{E}[\\Delta U] \\approx \\mathbb{E}[\\langle \\nabla U(x_k), \\Delta x_k \\rangle] = \\frac{\\Delta t}{2} \\mathbb{E}[\\langle \\nabla U(x_k), v_k \\rangle]\n905: $$\n906: \n907: For large $|x|$, confinement gives $\\langle x, \\nabla U(x) \\rangle \\geq \\kappa_{\\text{conf}} |x|^2$, providing a restoring force.\n908: \n909: **Step 4: Lyapunov bound**\n910: \n911: Combining the heating (O-step) and dissipation (friction + confinement), the energy satisfies a Lyapunov inequality:\n912: \n913: $$\n914: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_E \\Delta t) E(Z_k) + C_E \\Delta t\n915: $$\n916: \n917: for some constants $\\kappa_E, C_E > 0$ (dependent on $\\gamma, \\sigma, \\kappa_{\\text{conf}}$) when $\\Delta t$ is sufficiently small.\n918: \n919: At stationarity ($k \\to \\infty$):\n920: \n921: $$\n922: \\mathbb{E}_{\\nu^{\\Delta t}} [E(Z)] \\leq \\frac{C_E}{\\kappa_E}\n923: $$\n924: \n925: **Step 5: From energy to fourth moment (Lyapunov on $E^2$)**\n926: \n927: To rigorously bound the fourth moment, we use a Lyapunov argument on $E^2(Z) = (\\frac{1}{2}|v|^2 + U(x))^2$.\n928: \n929: **Substep 5.1: Lyapunov inequality for $E^2$**\n930: \n931: We will show:\n932: \n933: $$\n934: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_4 \\Delta t) E^2(Z_k) + C_4 \\Delta t\n935: $$\n936: \n937: for some constants $\\kappa_4, C_4 > 0$ when $\\Delta t$ is sufficiently small.\n938: \n939: **Substep 5.2: Direct analysis of $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$**\n940: \n941: We will compute $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$ by tracking the evolution through all five BAOAB substeps. Define:\n942: \n943: $$\n944: V(Z) := E^2(Z) = \\left(\\frac{1}{2}|v|^2 + U(x)\\right)^2\n945: $$\n946: \n947: Let $Z_k = (x_k, v_k)$ and track the evolution:\n948: - After B: $(x', v_k)$ where $x' = x_k + \\frac{\\Delta t}{2} v_k$\n949: - After A: $(x', v')$ where $v' = e^{-\\gamma \\Delta t/2} v_k$\n950: - After O: $(x', v'')$ where $v'' = v' + \\xi$ and $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n951: - After A: $(x', v''')$ where $v''' = e^{-\\gamma \\Delta t/2} v''$\n952: - After B: $(x_{k+1}, v''')$ where $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n953: \n954: **Substep 5.3: Expansion of $E^2(Z_{k+1})$**\n955: \n956: The energy at step $k+1$ is:\n957: \n958: $$\n959: E(Z_{k+1}) = \\frac{1}{2}|v'''|^2 + U(x_{k+1})\n960: $$\n961: \n962: Expand $U(x_{k+1})$ using Taylor expansion around $x_k$:\n963: \n964: $$\n965: U(x_{k+1}) = U(x_k) + \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n966: $$\n967: \n968: where $\\xi$ is between $x_k$ and $x_{k+1}$.\n969: \n970: Since $|x_{k+1} - x_k| = O(\\Delta t |v_k|)$, we have:\n971: \n972: $$\n973: U(x_{k+1}) = U(x_k) + O(\\Delta t |v_k| |\\nabla U(x_k)|) + O((\\Delta t)^2 |v_k|^2 \\|\\nabla^2 U\\|)\n974: $$\n975: \n976: For $|v'''|^2$, after the A-O-A composition:\n977: \n978: $$\n979: |v'''|^2 = e^{-\\gamma \\Delta t} |v_k|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma} + O(\\Delta t |v_k| |\\xi|)\n980: $$\n981: \n982: where $\\mathbb{E}[|\\xi|^2] = (1-e^{-\\gamma \\Delta t})\\frac{d\\sigma^2}{\\gamma}$.\n983: \n984: **Substep 5.4: Control of $\\mathbb{E}[V(Z_{k+1}) | Z_k]$ for large $V(Z_k)$**\n985: \n986: For large energy $E(Z_k)$, the key observation is:\n987: \n988: 1. **Dissipation from friction**: The velocity magnitude decays by factor $e^{-\\gamma \\Delta t} \\approx 1 - \\gamma \\Delta t$\n989: 2. **Heating from noise**: The noise adds energy $\\sim d\\sigma^2/(2\\gamma)$\n990: 3. **Potential growth**: The potential can increase, but confinement controls this\n991: \n992: Combining these effects, for large $E(Z_k)$:\n993: \n994: $$\n995: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq E(Z_k) - \\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n996: $$\n997: \n998: where $\\kappa_E \\sim \\gamma$ (friction) and $C_E$ accounts for noise and confinement.\n999: \n1000: For $V(Z_k) = E^2(Z_k)$, we need to control:\n1001: \n1002: $$\n1003: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = \\mathbb{E}[(E(Z_k) + \\Delta E)^2 | Z_k]\n1004: $$\n1005: \n1006: where $\\Delta E := E(Z_{k+1}) - E(Z_k)$.\n1007: \n1008: Expanding:\n1009: \n1010: $$\n1011: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = E^2(Z_k) + 2 E(Z_k) \\mathbb{E}[\\Delta E | Z_k] + \\mathbb{E}[(\\Delta E)^2 | Z_k]\n1012: $$\n1013: \n1014: **Substep 5.5: Bound the terms**\n1015: \n1016: From the first-moment analysis:\n1017: \n1018: $$\n1019: \\mathbb{E}[\\Delta E | Z_k] \\leq -\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n1020: $$\n1021: \n1022: For the second term, we need to bound the variance of the energy change. We will derive this carefully.\n1023: \n1024: **Proof of variance bound**: Recall $\\Delta E = E(Z_{k+1}) - E(Z_k)$ where the BAOAB evolution takes $Z_k = (x_k, v_k)$ to $Z_{k+1} = (x_{k+1}, v''')$ through:\n1025: - B: $x' = x_k + \\frac{\\Delta t}{2} v_k$\n1026: - A: $v' = e^{-\\gamma \\Delta t/2} v_k$\n1027: - O: $v'' = v' + \\xi$ where $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n1028: - A: $v''' = e^{-\\gamma \\Delta t/2} v''$\n1029: - B: $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n1030: \n1031: The energy change is:\n1032: \n1033: $$\n1034: \\Delta E = \\frac{1}{2}(|v'''|^2 - |v_k|^2) + (U(x_{k+1}) - U(x_k))\n1035: $$\n1036: \n1037: **Velocity contribution**: After A-O-A composition:\n1038: \n1039: $$\n1040: v''' = e^{-\\gamma \\Delta t/2}(e^{-\\gamma \\Delta t/2} v_k + \\xi) = e^{-\\gamma \\Delta t} v_k + e^{-\\gamma \\Delta t/2} \\xi\n1041: $$\n1042: \n1043: Therefore:\n1044: \n1045: $$\n1046: |v'''|^2 = e^{-2\\gamma \\Delta t} |v_k|^2 + 2 e^{-3\\gamma \\Delta t/2} \\langle v_k, \\xi \\rangle + e^{-\\gamma \\Delta t} |\\xi|^2\n1047: $$\n1048: \n1049: The variance of the velocity contribution:\n1050: \n1051: $$\n1052: \\text{Var}[\\frac{1}{2}(|v'''|^2 - |v_k|^2) | Z_k] \\leq C_v (\\Delta t)^2 |v_k|^4 + C'_v \\Delta t |v_k|^2 + C''_v \\Delta t\n1053: $$\n1054: \n1055: where we used $\\mathbb{E}[|\\xi|^2] = O(\\Delta t)$, $\\mathbb{E}[|\\xi|^4] = O((\\Delta t)^2)$, and $\\mathbb{E}[\\langle v_k, \\xi \\rangle^2] = |v_k|^2 \\mathbb{E}[|\\xi|^2] = O(\\Delta t |v_k|^2)$.\n1056: \n1057: **Potential contribution**: Using Taylor expansion:\n1058: \n1059: $$\n1060: U(x_{k+1}) - U(x_k) = \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n1061: $$\n1062: \n1063: Since $|x_{k+1} - x_k| = O(\\Delta t (|v_k| + |v'''|)) = O(\\Delta t |v_k|) + O((\\Delta t)^{3/2})$, we have:\n1064: \n1065: $$\n1066: \\text{Var}[U(x_{k+1}) - U(x_k) | Z_k] \\leq C_U (\\Delta t)^2 |v_k|^2 \\|\\nabla U\\|^2 + C'_U \\Delta t \\|\\nabla U\\|^2\n1067: $$\n1068: \n1069: **Cross-term**: The expansion $(\\Delta E)^2 = (\\Delta E_v)^2 + (\\Delta E_U)^2 + 2 \\Delta E_v \\Delta E_U$ includes a cross-term. By Cauchy-Schwarz:\n1070: \n1071: $$\n1072: 2|\\mathbb{E}[\\Delta E_v \\Delta E_U | Z_k]| \\leq 2\\sqrt{\\text{Var}[\\Delta E_v | Z_k] \\cdot \\text{Var}[\\Delta E_U | Z_k]} \\leq \\text{Var}[\\Delta E_v | Z_k] + \\text{Var}[\\Delta E_U | Z_k]\n1073: $$\n1074: \n1075: This is absorbed into the bounds for the squared terms.\n1076: \n1077: **Combine**: Using $|v_k|^2 \\leq 2 E(Z_k)$ and combining all terms (velocity, potential, and cross-term):\n1078: \n1079: $$\n1080: \\mathbb{E}[(\\Delta E)^2 | Z_k] \\leq C_{\\text{var}} \\Delta t (1 + E(Z_k))\n1081: $$\n1082: \n1083: where $C_{\\text{var}} = 2\\max\\{C_v + C_U, C'_v + C'_U, C''_v\\}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|, \\|\\nabla^2 U\\|$.\n1084: \n1085: Combining:\n1086: \n1087: $$\n1088: \\begin{align*}\n1089: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) + 2 E(Z_k) (-\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t) + C_{\\text{var}} \\Delta t (1 + E(Z_k)) \\\\\n1090: &= E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) + C_{\\text{var}} \\Delta t\n1091: \\end{align*}\n1092: $$\n1093: \n1094: **Handle the linear term using Young's inequality**: The term $(2 C_E + C_{\\text{var}}) \\Delta t E(Z_k)$ grows with $E(Z_k)$ and cannot be absorbed into a constant. We use Young's inequality: for any $\\epsilon > 0$,\n1095: \n1096: $$\n1097: E(Z_k) \\leq \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon}\n1098: $$\n1099: \n1100: Therefore:\n1101: \n1102: $$\n1103: (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) \\leq (2 C_E + C_{\\text{var}}) \\Delta t \\left[ \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon} \\right]\n1104: $$\n1105: \n1106: **Choose $\\epsilon$ to absorb into dissipation**: Set\n1107: \n1108: $$\n1109: \\epsilon := \\frac{\\kappa_E}{2 C_E + C_{\\text{var}}}\n1110: $$\n1111: \n1112: Then:\n1113: \n1114: $$\n1115: (2 C_E + C_{\\text{var}}) \\Delta t \\epsilon E^2(Z_k) = \\kappa_E \\Delta t E^2(Z_k)\n1116: $$\n1117: \n1118: Substituting back:\n1119: \n1120: $$\n1121: \\begin{align*}\n1122: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + \\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t \\cdot \\frac{1}{4\\epsilon} + C_{\\text{var}} \\Delta t \\\\\n1123: &= E^2(Z_k) - \\kappa_E \\Delta t E^2(Z_k) + \\left[ \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}} \\right] \\Delta t \\\\\n1124: &= (1 - \\kappa_E \\Delta t) E^2(Z_k) + C'_4 \\Delta t\n1125: \\end{align*}\n1126: $$\n1127: \n1128: where:\n1129: \n1130: $$\n1131: C'_4 := \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\n1132: $$\n1133: \n1134: This gives the Lyapunov inequality with $\\kappa_4 := \\kappa_E$ and $C_4 := C'_4$.\n1135: \n1136: **Substep 5.6: Stationary second moment**\n1137: \n1138: At stationarity:\n1139: \n1140: $$\n1141: \\mathbb{E}_{\\nu^{\\Delta t}} [E^2(Z)] \\leq \\frac{C_4}{\\kappa_4} = \\frac{C'_4}{\\kappa_E} = \\frac{1}{\\kappa_E}\\left[\\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\\right]\n1142: $$\n1143: \n1144: **Substep 5.7: From $E^2$ to fourth moment**\n1145: \n1146: Since $E(Z) = \\frac{1}{2}|v|^2 + U(x)$, we have:\n1147: \n1148: $$\n1149: |Z|^4 = (|x|^2 + |v|^2)^2 \\leq C_{\\text{coeff}} (|v|^4 + |x|^4)\n1150: $$\n1151: \n1152: By confinement, $U(x) \\geq \\kappa_{\\text{conf}} |x|^2 - C_{\\text{conf}}$, so:\n1153: \n1154: $$\n1155: |x|^2 \\leq \\frac{1}{\\kappa_{\\text{conf}}} (U(x) + C_{\\text{conf}}) \\leq \\frac{1}{\\kappa_{\\text{conf}}} (E(Z) + C_{\\text{conf}})\n1156: $$\n1157: \n1158: Therefore:\n1159: \n1160: $$\n1161: |x|^4 \\leq \\frac{1}{\\kappa_{\\text{conf}}^2} (E(Z) + C_{\\text{conf}})^2 \\leq \\frac{2}{\\kappa_{\\text{conf}}^2} (E^2(Z) + C_{\\text{conf}}^2)\n1162: $$\n1163: \n1164: Similarly, $|v|^4 \\leq 4 E^2(Z)$ since $|v|^2 \\leq 2 E(Z)$.\n1165: \n1166: Combining:\n1167: \n1168: $$\n1169: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq C_{\\text{coeff}} \\left( 4 \\mathbb{E}[E^2(Z)] + \\frac{2}{\\kappa_{\\text{conf}}^2} (\\mathbb{E}[E^2(Z)] + C_{\\text{conf}}^2) \\right)\n1170: $$\n1171: \n1172: $$\n1173: \\leq M_4 := C_{\\text{coeff}} \\left( 4 + \\frac{2}{\\kappa_{\\text{conf}}^2} \\right) \\frac{C_4}{\\kappa_4} + \\frac{2 C_{\\text{coeff}} C_{\\text{conf}}^2}{\\kappa_{\\text{conf}}^2}\n1174: $$\n1175: \n1176: This is finite and depends only on $\\gamma, \\sigma, \\kappa_{\\text{conf}}, d$, independent of $\\Delta t$ for $\\Delta t < \\Delta t_0$ (sufficiently small)."
    },
    {
      "directive_type": "lemma",
      "label": "lem-baoab-weak-error",
      "title": "BAOAB Second-Order Weak Convergence",
      "start_line": 1188,
      "end_line": 1213,
      "header_lines": [
        1189
      ],
      "content_start": 1191,
      "content_end": 1212,
      "content": "1191: :label: lem-baoab-weak-error\n1192: \n1193: Let $Z(t)$ be the solution of the continuous-time Langevin SDE:\n1194: \n1195: $$\n1196: \\begin{cases}\n1197: dX_t = V_t dt \\\\\n1198: dV_t = -\\nabla U(X_t) dt - \\gamma V_t dt + \\sigma dW_t\n1199: \\end{cases}\n1200: $$\n1201: \n1202: and let $Z_k$ be the BAOAB approximation with step size $\\Delta t$ starting from $Z_0 = Z(0)$. For any test function $\\phi \\in C^4(\\Omega)$ with bounded derivatives up to order 4, we have:\n1203: \n1204: $$\n1205: |\\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]| \\leq C_{\\text{weak}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2 \\cdot k\\Delta t\n1206: $$\n1207: \n1208: where $C_{\\text{weak}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4$ but not on $\\Delta t$ or $k$.\n1209: \n1210: In particular, for fixed time $T = k\\Delta t$:\n1211: \n1212: $$",
      "metadata": {
        "label": "lem-baoab-weak-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1188: Now we establish the second-order weak convergence of BAOAB for finite time.\n1189: \n1190: :::{prf:lemma} BAOAB Second-Order Weak Convergence\n1191: :label: lem-baoab-weak-error\n1192: \n1193: Let $Z(t)$ be the solution of the continuous-time Langevin SDE:\n1194: \n1195: $$\n1196: \\begin{cases}\n1197: dX_t = V_t dt \\\\\n1198: dV_t = -\\nabla U(X_t) dt - \\gamma V_t dt + \\sigma dW_t\n1199: \\end{cases}\n1200: $$\n1201: \n1202: and let $Z_k$ be the BAOAB approximation with step size $\\Delta t$ starting from $Z_0 = Z(0)$. For any test function $\\phi \\in C^4(\\Omega)$ with bounded derivatives up to order 4, we have:\n1203: \n1204: $$\n1205: |\\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]| \\leq C_{\\text{weak}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2 \\cdot k\\Delta t\n1206: $$\n1207: \n1208: where $C_{\\text{weak}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4$ but not on $\\Delta t$ or $k$.\n1209: \n1210: In particular, for fixed time $T = k\\Delta t$:\n1211: \n1212: $$\n1213: |\\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(T))]| = O((\\Delta t)^2)"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-389",
      "title": null,
      "start_line": 1215,
      "end_line": 1293,
      "header_lines": [],
      "content_start": 1217,
      "content_end": 1292,
      "content": "1217: :::{prf:proof}\n1218: \n1219: The proof uses backward error analysis and Taylor expansion of the BAOAB integrator.\n1220: \n1221: **Step 1: Local truncation error**\n1222: \n1223: The BAOAB integrator is a splitting scheme that can be written as:\n1224: \n1225: $$\n1226: Z_{k+1} = \\Phi_{\\text{BAOAB}}^{\\Delta t}(Z_k) = \\Phi_B^{\\Delta t/2} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_O^{\\Delta t} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_B^{\\Delta t/2}(Z_k)\n1227: $$\n1228: \n1229: where each $\\Phi$ corresponds to one of the sub-steps.\n1230: \n1231: By Strang splitting theory (second-order symmetric splitting), the local truncation error is $O((\\Delta t)^3)$ for a single step.\n1232: \n1233: **Step 2: Weak generator expansion**\n1234: \n1235: For a test function $\\phi \\in C^4(\\Omega)$, the weak error evolution satisfies:\n1236: \n1237: $$\n1238: \\frac{d}{dt} \\mathbb{E}[\\phi(Z_k)] = \\mathbb{E}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\phi(Z_k)]\n1239: $$\n1240: \n1241: where $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$ is the discrete-time generator.\n1242: \n1243: The continuous-time generator is:\n1244: \n1245: $$\n1246: \\mathcal{L} \\phi = v \\cdot \\nabla_x \\phi - \\nabla U(x) \\cdot \\nabla_v \\phi - \\gamma v \\cdot \\nabla_v \\phi + \\frac{\\sigma^2}{2} \\Delta_v \\phi\n1247: $$\n1248: \n1249: By backward error analysis (Bou-Rabee & Sanz-Serna 2017, Theorem 3.1), the BAOAB generator can be expanded as:\n1250: \n1251: $$\n1252: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1253: $$\n1254: \n1255: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients (depending on derivatives of $U$ up to order 3).\n1256: \n1257: **Note**: The remainder is $O((\\Delta t)^4)$, not $O((\\Delta t)^3)$, because BAOAB is a **time-symmetric** integrator. For symmetric schemes, the expansion contains only even powers of $\\Delta t$.\n1258: \n1259: **Step 3: Gronwall argument**\n1260: \n1261: Let $\\varepsilon_k := \\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]$ be the weak error at time $t_k = k\\Delta t$.\n1262: \n1263: From the generator expansion:\n1264: \n1265: $$\n1266: \\varepsilon_{k+1} = \\varepsilon_k + \\Delta t \\cdot \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] + O((\\Delta t)^2)\n1267: $$\n1268: \n1269: The generator difference contributes:\n1270: \n1271: $$\n1272: \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] = (\\Delta t)^2 \\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)] + O((\\Delta t)^4)\n1273: $$\n1274: \n1275: Using the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`):\n1276: \n1277: $$\n1278: |\\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)]| \\leq C_2 \\|\\phi\\|_{C^4} \\mathbb{E}[|Z_k|^4]^{1/2} \\leq C_2 \\|\\phi\\|_{C^4} M_4^{1/2}\n1279: $$\n1280: \n1281: Therefore:\n1282: \n1283: $$\n1284: |\\varepsilon_{k+1}| \\leq |\\varepsilon_k| + C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 + O((\\Delta t)^4)\n1285: $$\n1286: \n1287: With $\\varepsilon_0 = 0$, summing from $k=0$ to $k=K-1$ where $K\\Delta t = T$:\n1288: \n1289: $$\n1290: |\\varepsilon_K| \\leq K \\cdot C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 = C_{\\text{weak}} \\|\\phi\\|_{C^4} (\\Delta t)^2 \\cdot T\n1291: $$\n1292: ",
      "metadata": {},
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1215: :::\n1216: \n1217: :::{prf:proof}\n1218: \n1219: The proof uses backward error analysis and Taylor expansion of the BAOAB integrator.\n1220: \n1221: **Step 1: Local truncation error**\n1222: \n1223: The BAOAB integrator is a splitting scheme that can be written as:\n1224: \n1225: $$\n1226: Z_{k+1} = \\Phi_{\\text{BAOAB}}^{\\Delta t}(Z_k) = \\Phi_B^{\\Delta t/2} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_O^{\\Delta t} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_B^{\\Delta t/2}(Z_k)\n1227: $$\n1228: \n1229: where each $\\Phi$ corresponds to one of the sub-steps.\n1230: \n1231: By Strang splitting theory (second-order symmetric splitting), the local truncation error is $O((\\Delta t)^3)$ for a single step.\n1232: \n1233: **Step 2: Weak generator expansion**\n1234: \n1235: For a test function $\\phi \\in C^4(\\Omega)$, the weak error evolution satisfies:\n1236: \n1237: $$\n1238: \\frac{d}{dt} \\mathbb{E}[\\phi(Z_k)] = \\mathbb{E}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\phi(Z_k)]\n1239: $$\n1240: \n1241: where $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$ is the discrete-time generator.\n1242: \n1243: The continuous-time generator is:\n1244: \n1245: $$\n1246: \\mathcal{L} \\phi = v \\cdot \\nabla_x \\phi - \\nabla U(x) \\cdot \\nabla_v \\phi - \\gamma v \\cdot \\nabla_v \\phi + \\frac{\\sigma^2}{2} \\Delta_v \\phi\n1247: $$\n1248: \n1249: By backward error analysis (Bou-Rabee & Sanz-Serna 2017, Theorem 3.1), the BAOAB generator can be expanded as:\n1250: \n1251: $$\n1252: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1253: $$\n1254: \n1255: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients (depending on derivatives of $U$ up to order 3).\n1256: \n1257: **Note**: The remainder is $O((\\Delta t)^4)$, not $O((\\Delta t)^3)$, because BAOAB is a **time-symmetric** integrator. For symmetric schemes, the expansion contains only even powers of $\\Delta t$.\n1258: \n1259: **Step 3: Gronwall argument**\n1260: \n1261: Let $\\varepsilon_k := \\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]$ be the weak error at time $t_k = k\\Delta t$.\n1262: \n1263: From the generator expansion:\n1264: \n1265: $$\n1266: \\varepsilon_{k+1} = \\varepsilon_k + \\Delta t \\cdot \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] + O((\\Delta t)^2)\n1267: $$\n1268: \n1269: The generator difference contributes:\n1270: \n1271: $$\n1272: \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] = (\\Delta t)^2 \\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)] + O((\\Delta t)^4)\n1273: $$\n1274: \n1275: Using the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`):\n1276: \n1277: $$\n1278: |\\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)]| \\leq C_2 \\|\\phi\\|_{C^4} \\mathbb{E}[|Z_k|^4]^{1/2} \\leq C_2 \\|\\phi\\|_{C^4} M_4^{1/2}\n1279: $$\n1280: \n1281: Therefore:\n1282: \n1283: $$\n1284: |\\varepsilon_{k+1}| \\leq |\\varepsilon_k| + C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 + O((\\Delta t)^4)\n1285: $$\n1286: \n1287: With $\\varepsilon_0 = 0$, summing from $k=0$ to $k=K-1$ where $K\\Delta t = T$:\n1288: \n1289: $$\n1290: |\\varepsilon_K| \\leq K \\cdot C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 = C_{\\text{weak}} \\|\\phi\\|_{C^4} (\\Delta t)^2 \\cdot T\n1291: $$\n1292: \n1293: where $C_{\\text{weak}} = C_2 M_4^{1/2}$."
    },
    {
      "directive_type": "lemma",
      "label": "lem-baoab-invariant-measure-error",
      "title": "BAOAB Invariant Measure Error",
      "start_line": 1305,
      "end_line": 1317,
      "header_lines": [
        1306
      ],
      "content_start": 1308,
      "content_end": 1316,
      "content": "1308: :label: lem-baoab-invariant-measure-error\n1309: \n1310: Let $\\nu^{\\text{cont}}$ be the invariant measure of the continuous-time Langevin dynamics and let $\\nu^{\\Delta t}$ be the invariant measure of the BAOAB chain with step size $\\Delta t$. For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1311: \n1312: $$\n1313: \\left| \\mathbb{E}_{\\nu^{\\Delta t}} [\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}} [\\phi] \\right| \\leq C_{\\text{inv}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2\n1314: $$\n1315: \n1316: where $C_{\\text{inv}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4, \\kappa_{\\text{mix}}$ but not on $\\Delta t$.",
      "metadata": {
        "label": "lem-baoab-invariant-measure-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1305: Now we convert the finite-time weak error to an invariant measure error.\n1306: \n1307: :::{prf:lemma} BAOAB Invariant Measure Error\n1308: :label: lem-baoab-invariant-measure-error\n1309: \n1310: Let $\\nu^{\\text{cont}}$ be the invariant measure of the continuous-time Langevin dynamics and let $\\nu^{\\Delta t}$ be the invariant measure of the BAOAB chain with step size $\\Delta t$. For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1311: \n1312: $$\n1313: \\left| \\mathbb{E}_{\\nu^{\\Delta t}} [\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}} [\\phi] \\right| \\leq C_{\\text{inv}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2\n1314: $$\n1315: \n1316: where $C_{\\text{inv}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4, \\kappa_{\\text{mix}}$ but not on $\\Delta t$.\n1317: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-493",
      "title": null,
      "start_line": 1319,
      "end_line": 1480,
      "header_lines": [],
      "content_start": 1321,
      "content_end": 1479,
      "content": "1321: :::{prf:proof}\n1322: \n1323: The proof uses the Poisson equation method and exploits the symmetry of the BAOAB integrator.\n1324: \n1325: **Step 1: The Poisson equation**\n1326: \n1327: For an observable $\\phi \\in C^4$, consider the centered observable:\n1328: \n1329: $$\n1330: \\tilde{\\phi}(z) := \\phi(z) - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]\n1331: $$\n1332: \n1333: The Poisson equation for the continuous-time generator $\\mathcal{L}$ is:\n1334: \n1335: $$\n1336: \\mathcal{L} \\psi = \\tilde{\\phi}\n1337: $$\n1338: \n1339: This equation has a unique solution $\\psi \\in C^{\\infty}(\\Omega)$ under the geometric ergodicity assumption, and moreover $\\mathbb{E}_{\\nu^{\\text{cont}}}[\\psi] = 0$.\n1340: \n1341: **Step 2: Regularity of the Poisson solution**\n1342: \n1343: The key regularity result (from elliptic PDE theory applied to the hypoelliptic operator $\\mathcal{L}$) is:\n1344: \n1345: $$\n1346: \\|\\psi\\|_{C^{k+2}} \\leq \\frac{C_{\\text{reg}}}{\\kappa_{\\text{mix}}^{k+1}} \\|\\tilde{\\phi}\\|_{C^k}\n1347: $$\n1348: \n1349: For $\\phi \\in C^4$, we have:\n1350: \n1351: $$\n1352: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1353: $$\n1354: \n1355: **Step 3: Error decomposition via Poisson equation**\n1356: \n1357: The error between invariant measures can be written using $\\psi$:\n1358: \n1359: $$\n1360: \\begin{align*}\n1361: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\tilde{\\phi}] \\\\\n1362: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\quad \\text{(by Poisson equation)}\n1363: \\end{align*}\n1364: $$\n1365: \n1366: **Step 4: Key identity using invariant measure property**\n1367: \n1368: Since $\\nu^{\\Delta t}$ is the invariant measure of the discrete-time generator $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$, we have:\n1369: \n1370: $$\n1371: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] = 0\n1372: $$\n1373: \n1374: This is because for any function $g$:\n1375: \n1376: $$\n1377: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} g] = \\mathbb{E}_{\\nu^{\\Delta t}}[g(Z_1) - g(Z_0)] = 0\n1378: $$\n1379: \n1380: when $Z_0 \\sim \\nu^{\\Delta t}$ (stationarity).\n1381: \n1382: **Step 5: Apply generator difference**\n1383: \n1384: Combining Steps 3 and 4:\n1385: \n1386: $$\n1387: \\begin{align*}\n1388: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\\\\n1389: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] - \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] \\\\\n1390: &= \\mathbb{E}_{\\nu^{\\Delta t}}[(\\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}) \\psi]\n1391: \\end{align*}\n1392: $$\n1393: \n1394: **Step 6: Use backward error expansion**\n1395: \n1396: From {prf:ref}`lem-baoab-weak-error`, the generator difference satisfies:\n1397: \n1398: $$\n1399: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1400: $$\n1401: \n1402: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients.\n1403: \n1404: Therefore:\n1405: \n1406: $$\n1407: \\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = -(\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1408: $$\n1409: \n1410: **Step 7: Apply generator expansion**\n1411: \n1412: For symmetric splitting schemes like BAOAB, the generator expansion has only even powers:\n1413: \n1414: $$\n1415: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1416: $$\n1417: \n1418: Substituting into Step 5:\n1419: \n1420: $$\n1421: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] = -(\\Delta t)^2 \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi] + O((\\Delta t)^4)\n1422: $$\n1423: \n1424: **Step 8: Bound the expectation uniformly**\n1425: \n1426: The key is to show that $|\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]|$ is bounded uniformly for $\\Delta t$ sufficiently small.\n1427: \n1428: The operator $\\mathcal{L}_2$ is a fourth-order differential operator whose coefficients involve derivatives of the potential $U$ up to order 3. For a solution $\\psi$ of the Poisson equation $\\mathcal{L} \\psi = \\tilde{\\phi}$ with $\\phi \\in C^4$, the regularity result from Step 2 gives:\n1429: \n1430: $$\n1431: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1432: $$\n1433: \n1434: Under the confinement axiom, $|\\mathcal{L}_2 \\psi(Z)|$ grows at most polynomially in $|Z|$:\n1435: \n1436: $$\n1437: |\\mathcal{L}_2 \\psi(Z)| \\leq C_2 \\|\\psi\\|_{C^6} (1 + |Z|^2)\n1438: $$\n1439: \n1440: for some constant $C_2$ depending on $\\|\\nabla^2 U\\|, \\|\\nabla^3 U\\|$.\n1441: \n1442: **Step 9: Use uniform moment bounds**\n1443: \n1444: From the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`), we have:\n1445: \n1446: $$\n1447: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq M_4 < \\infty\n1448: $$\n1449: \n1450: uniformly in $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1451: \n1452: Therefore:\n1453: \n1454: $$\n1455: \\begin{align*}\n1456: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]| &\\leq \\mathbb{E}_{\\nu^{\\Delta t}}[|\\mathcal{L}_2 \\psi(Z)|] \\\\\n1457: &\\leq C_2 \\|\\psi\\|_{C^6} \\mathbb{E}_{\\nu^{\\Delta t}}[1 + |Z|^2] \\\\\n1458: &\\leq C_2 \\|\\psi\\|_{C^6} (1 + M_4^{1/2}) \\\\\n1459: &\\leq C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2})\n1460: \\end{align*}\n1461: $$\n1462: \n1463: **Step 10: Conclude**\n1464: \n1465: Combining Steps 7 and 9:\n1466: \n1467: $$\n1468: \\begin{align*}\n1469: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]| &\\leq (\\Delta t)^2 \\cdot C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2}) + O((\\Delta t)^4) \\\\\n1470: &= C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2 + O((\\Delta t)^4)\n1471: \\end{align*}\n1472: $$\n1473: \n1474: where:\n1475: \n1476: $$\n1477: C_{\\text{inv}} := \\frac{C_2 \\cdot C_{\\text{reg}} (1 + M_4^{1/2})}{\\kappa_{\\text{mix}}^5}\n1478: $$\n1479: ",
      "metadata": {},
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1319: :::\n1320: \n1321: :::{prf:proof}\n1322: \n1323: The proof uses the Poisson equation method and exploits the symmetry of the BAOAB integrator.\n1324: \n1325: **Step 1: The Poisson equation**\n1326: \n1327: For an observable $\\phi \\in C^4$, consider the centered observable:\n1328: \n1329: $$\n1330: \\tilde{\\phi}(z) := \\phi(z) - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]\n1331: $$\n1332: \n1333: The Poisson equation for the continuous-time generator $\\mathcal{L}$ is:\n1334: \n1335: $$\n1336: \\mathcal{L} \\psi = \\tilde{\\phi}\n1337: $$\n1338: \n1339: This equation has a unique solution $\\psi \\in C^{\\infty}(\\Omega)$ under the geometric ergodicity assumption, and moreover $\\mathbb{E}_{\\nu^{\\text{cont}}}[\\psi] = 0$.\n1340: \n1341: **Step 2: Regularity of the Poisson solution**\n1342: \n1343: The key regularity result (from elliptic PDE theory applied to the hypoelliptic operator $\\mathcal{L}$) is:\n1344: \n1345: $$\n1346: \\|\\psi\\|_{C^{k+2}} \\leq \\frac{C_{\\text{reg}}}{\\kappa_{\\text{mix}}^{k+1}} \\|\\tilde{\\phi}\\|_{C^k}\n1347: $$\n1348: \n1349: For $\\phi \\in C^4$, we have:\n1350: \n1351: $$\n1352: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1353: $$\n1354: \n1355: **Step 3: Error decomposition via Poisson equation**\n1356: \n1357: The error between invariant measures can be written using $\\psi$:\n1358: \n1359: $$\n1360: \\begin{align*}\n1361: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\tilde{\\phi}] \\\\\n1362: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\quad \\text{(by Poisson equation)}\n1363: \\end{align*}\n1364: $$\n1365: \n1366: **Step 4: Key identity using invariant measure property**\n1367: \n1368: Since $\\nu^{\\Delta t}$ is the invariant measure of the discrete-time generator $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$, we have:\n1369: \n1370: $$\n1371: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] = 0\n1372: $$\n1373: \n1374: This is because for any function $g$:\n1375: \n1376: $$\n1377: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} g] = \\mathbb{E}_{\\nu^{\\Delta t}}[g(Z_1) - g(Z_0)] = 0\n1378: $$\n1379: \n1380: when $Z_0 \\sim \\nu^{\\Delta t}$ (stationarity).\n1381: \n1382: **Step 5: Apply generator difference**\n1383: \n1384: Combining Steps 3 and 4:\n1385: \n1386: $$\n1387: \\begin{align*}\n1388: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\\\\n1389: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] - \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] \\\\\n1390: &= \\mathbb{E}_{\\nu^{\\Delta t}}[(\\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}) \\psi]\n1391: \\end{align*}\n1392: $$\n1393: \n1394: **Step 6: Use backward error expansion**\n1395: \n1396: From {prf:ref}`lem-baoab-weak-error`, the generator difference satisfies:\n1397: \n1398: $$\n1399: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1400: $$\n1401: \n1402: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients.\n1403: \n1404: Therefore:\n1405: \n1406: $$\n1407: \\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = -(\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1408: $$\n1409: \n1410: **Step 7: Apply generator expansion**\n1411: \n1412: For symmetric splitting schemes like BAOAB, the generator expansion has only even powers:\n1413: \n1414: $$\n1415: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1416: $$\n1417: \n1418: Substituting into Step 5:\n1419: \n1420: $$\n1421: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] = -(\\Delta t)^2 \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi] + O((\\Delta t)^4)\n1422: $$\n1423: \n1424: **Step 8: Bound the expectation uniformly**\n1425: \n1426: The key is to show that $|\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]|$ is bounded uniformly for $\\Delta t$ sufficiently small.\n1427: \n1428: The operator $\\mathcal{L}_2$ is a fourth-order differential operator whose coefficients involve derivatives of the potential $U$ up to order 3. For a solution $\\psi$ of the Poisson equation $\\mathcal{L} \\psi = \\tilde{\\phi}$ with $\\phi \\in C^4$, the regularity result from Step 2 gives:\n1429: \n1430: $$\n1431: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1432: $$\n1433: \n1434: Under the confinement axiom, $|\\mathcal{L}_2 \\psi(Z)|$ grows at most polynomially in $|Z|$:\n1435: \n1436: $$\n1437: |\\mathcal{L}_2 \\psi(Z)| \\leq C_2 \\|\\psi\\|_{C^6} (1 + |Z|^2)\n1438: $$\n1439: \n1440: for some constant $C_2$ depending on $\\|\\nabla^2 U\\|, \\|\\nabla^3 U\\|$.\n1441: \n1442: **Step 9: Use uniform moment bounds**\n1443: \n1444: From the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`), we have:\n1445: \n1446: $$\n1447: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq M_4 < \\infty\n1448: $$\n1449: \n1450: uniformly in $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1451: \n1452: Therefore:\n1453: \n1454: $$\n1455: \\begin{align*}\n1456: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]| &\\leq \\mathbb{E}_{\\nu^{\\Delta t}}[|\\mathcal{L}_2 \\psi(Z)|] \\\\\n1457: &\\leq C_2 \\|\\psi\\|_{C^6} \\mathbb{E}_{\\nu^{\\Delta t}}[1 + |Z|^2] \\\\\n1458: &\\leq C_2 \\|\\psi\\|_{C^6} (1 + M_4^{1/2}) \\\\\n1459: &\\leq C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2})\n1460: \\end{align*}\n1461: $$\n1462: \n1463: **Step 10: Conclude**\n1464: \n1465: Combining Steps 7 and 9:\n1466: \n1467: $$\n1468: \\begin{align*}\n1469: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]| &\\leq (\\Delta t)^2 \\cdot C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2}) + O((\\Delta t)^4) \\\\\n1470: &= C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2 + O((\\Delta t)^4)\n1471: \\end{align*}\n1472: $$\n1473: \n1474: where:\n1475: \n1476: $$\n1477: C_{\\text{inv}} := \\frac{C_2 \\cdot C_{\\text{reg}} (1 + M_4^{1/2})}{\\kappa_{\\text{mix}}^5}\n1478: $$\n1479: \n1480: **The key insight**: The uniform fourth-moment bounds ensure that the expectation $\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]$ is bounded uniformly in $\\Delta t$. Combined with the generator expansion having only even powers (due to BAOAB's symmetry), this gives the $O((\\Delta t)^2)$ convergence rate."
    },
    {
      "directive_type": "theorem",
      "label": "thm-langevin-baoab-discretization-error",
      "title": "Langevin-BAOAB Time Discretization Error",
      "start_line": 1500,
      "end_line": 1514,
      "header_lines": [
        1501
      ],
      "content_start": 1503,
      "content_end": 1513,
      "content": "1503: :label: thm-langevin-baoab-discretization-error\n1504: \n1505: Let $\\nu_N^{\\text{Langevin}}$ be the invariant measure of the continuous-time N-particle Langevin dynamics (without cloning) and let $\\nu_N^{\\text{BAOAB}}$ be the invariant measure of the discrete-time BAOAB chain with step size $\\Delta t$ for the same Langevin SDE. For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1506: \n1507: $$\n1508: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi] \\right| \\leq C_{\\text{BAOAB}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2\n1509: $$\n1510: \n1511: where $C_{\\text{BAOAB}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4, \\kappa_{\\text{mix}}$ but is independent of $N$ (N-uniform) and independent of $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1512: \n1513: **Important**: This theorem analyzes the **Langevin dynamics alone**, without the cloning mechanism. The complete Fragile Gas algorithm combines BAOAB integration with cloning. The full system error analysis (which will show an $O(\\Delta t)$ rate dominated by the cloning error) is deferred to Part III and Part IV.",
      "metadata": {
        "label": "thm-langevin-baoab-discretization-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1500: We now state the main result for Part II.\n1501: \n1502: :::{prf:theorem} Langevin-BAOAB Time Discretization Error\n1503: :label: thm-langevin-baoab-discretization-error\n1504: \n1505: Let $\\nu_N^{\\text{Langevin}}$ be the invariant measure of the continuous-time N-particle Langevin dynamics (without cloning) and let $\\nu_N^{\\text{BAOAB}}$ be the invariant measure of the discrete-time BAOAB chain with step size $\\Delta t$ for the same Langevin SDE. For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1506: \n1507: $$\n1508: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi] \\right| \\leq C_{\\text{BAOAB}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2\n1509: $$\n1510: \n1511: where $C_{\\text{BAOAB}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4, \\kappa_{\\text{mix}}$ but is independent of $N$ (N-uniform) and independent of $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1512: \n1513: **Important**: This theorem analyzes the **Langevin dynamics alone**, without the cloning mechanism. The complete Fragile Gas algorithm combines BAOAB integration with cloning. The full system error analysis (which will show an $O(\\Delta t)$ rate dominated by the cloning error) is deferred to Part III and Part IV.\n1514: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-690",
      "title": null,
      "start_line": 1516,
      "end_line": 1568,
      "header_lines": [],
      "content_start": 1518,
      "content_end": 1567,
      "content": "1518: :::{prf:proof}\n1519: \n1520: This follows directly from {prf:ref}`lem-baoab-invariant-measure-error` applied to each particle in the N-particle Langevin system.\n1521: \n1522: **Step 1: Single-particle Langevin dynamics**\n1523: \n1524: Each particle $i$ evolves independently via the Langevin SDE:\n1525: \n1526: $$\n1527: \\begin{cases}\n1528: dX_t^{(i)} = V_t^{(i)} dt \\\\\n1529: dV_t^{(i)} = -\\nabla U(X_t^{(i)}) dt - \\gamma V_t^{(i)} dt + \\sigma dW_t^{(i)}\n1530: \\end{cases}\n1531: $$\n1532: \n1533: where $W_t^{(i)}$ are independent Brownian motions.\n1534: \n1535: **Step 2: N-uniformity for non-interacting Langevin dynamics**\n1536: \n1537: The key observation is that **the BAOAB time discretization acts independently on each particle**.\n1538: \n1539: More precisely:\n1540: - **External potential**: The potential $U(x_i)$ is an external (fixed) potential that depends only on the position of particle $i$, not on other particles' positions.\n1541: \n1542: **Crucial clarification**: This N-uniformity analysis applies to the **Euclidean Gas** case where the potential is external. For mean-field interacting potentials (e.g., Adaptive Gas with empirical-measure-dependent potentials), a separate treatment would be required.\n1543: \n1544: - **Independent evolution**: Each particle evolves via its own independent Langevin SDE. The BAOAB discretization of this evolution has constants ($C_{\\text{weak}}, M_4, \\kappa_{\\text{mix}}$) that depend **only** on $U, \\gamma, \\sigma, d$, not on $N$ or on the positions of other particles.\n1545: \n1546: From {prf:ref}`lem-baoab-invariant-measure-error`, we have:\n1547: \n1548: $$\n1549: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)] \\right| \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1550: $$\n1551: \n1552: for each particle $i$, where $C_{\\text{inv}}$ is independent of $N$.\n1553: \n1554: **Step 3: Observable on the N-particle system**\n1555: \n1556: For an observable $\\Phi(Z) = \\frac{1}{N}\\sum_{i=1}^N \\phi(z_i)$:\n1557: \n1558: $$\n1559: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\Phi] \\right| = \\left| \\frac{1}{N} \\sum_{i=1}^N (\\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)]) \\right|\n1560: $$\n1561: \n1562: By exchangeability:\n1563: \n1564: $$\n1565: \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1566: $$\n1567: ",
      "metadata": {},
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1516: :::\n1517: \n1518: :::{prf:proof}\n1519: \n1520: This follows directly from {prf:ref}`lem-baoab-invariant-measure-error` applied to each particle in the N-particle Langevin system.\n1521: \n1522: **Step 1: Single-particle Langevin dynamics**\n1523: \n1524: Each particle $i$ evolves independently via the Langevin SDE:\n1525: \n1526: $$\n1527: \\begin{cases}\n1528: dX_t^{(i)} = V_t^{(i)} dt \\\\\n1529: dV_t^{(i)} = -\\nabla U(X_t^{(i)}) dt - \\gamma V_t^{(i)} dt + \\sigma dW_t^{(i)}\n1530: \\end{cases}\n1531: $$\n1532: \n1533: where $W_t^{(i)}$ are independent Brownian motions.\n1534: \n1535: **Step 2: N-uniformity for non-interacting Langevin dynamics**\n1536: \n1537: The key observation is that **the BAOAB time discretization acts independently on each particle**.\n1538: \n1539: More precisely:\n1540: - **External potential**: The potential $U(x_i)$ is an external (fixed) potential that depends only on the position of particle $i$, not on other particles' positions.\n1541: \n1542: **Crucial clarification**: This N-uniformity analysis applies to the **Euclidean Gas** case where the potential is external. For mean-field interacting potentials (e.g., Adaptive Gas with empirical-measure-dependent potentials), a separate treatment would be required.\n1543: \n1544: - **Independent evolution**: Each particle evolves via its own independent Langevin SDE. The BAOAB discretization of this evolution has constants ($C_{\\text{weak}}, M_4, \\kappa_{\\text{mix}}$) that depend **only** on $U, \\gamma, \\sigma, d$, not on $N$ or on the positions of other particles.\n1545: \n1546: From {prf:ref}`lem-baoab-invariant-measure-error`, we have:\n1547: \n1548: $$\n1549: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)] \\right| \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1550: $$\n1551: \n1552: for each particle $i$, where $C_{\\text{inv}}$ is independent of $N$.\n1553: \n1554: **Step 3: Observable on the N-particle system**\n1555: \n1556: For an observable $\\Phi(Z) = \\frac{1}{N}\\sum_{i=1}^N \\phi(z_i)$:\n1557: \n1558: $$\n1559: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\Phi] \\right| = \\left| \\frac{1}{N} \\sum_{i=1}^N (\\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)]) \\right|\n1560: $$\n1561: \n1562: By exchangeability:\n1563: \n1564: $$\n1565: \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1566: $$\n1567: \n1568: Setting $C_{\\text{BAOAB}} := C_{\\text{inv}}$ completes the proof."
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}