{
  "chapter_index": 4,
  "section_id": "## Part III: Cloning Mechanism Error Bounds",
  "directive_count": 9,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-full-system-discretization-error",
      "title": "Full System Time Discretization Error",
      "start_line": 1638,
      "end_line": 1650,
      "header_lines": [
        1639
      ],
      "content_start": 1641,
      "content_end": 1649,
      "content": "1641: :label: thm-full-system-discretization-error\n1642: \n1643: Let $\\nu_N^{\\text{cont}}$ be the QSD of the continuous-time N-particle system (Langevin dynamics + continuous-time cloning) and let $\\nu_N^{\\text{discrete}}$ be the QSD of the discrete-time system (BAOAB + discrete cloning with step size $\\Delta t$). For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1644: \n1645: $$\n1646: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\phi] \\right| \\leq C_{\\text{total}} \\cdot \\|\\phi\\|_{C^4} \\cdot \\Delta t\n1647: $$\n1648: \n1649: where $C_{\\text{total}}$ depends on $\\gamma, \\sigma, \\lambda, \\delta, M_4, \\kappa_{\\text{mix}}$ but is independent of $N$ and $\\Delta t$ (for $\\Delta t$ sufficiently small).",
      "metadata": {
        "label": "thm-full-system-discretization-error"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "1638: ### Main Result (Target)\n1639: \n1640: :::{prf:theorem} Full System Time Discretization Error\n1641: :label: thm-full-system-discretization-error\n1642: \n1643: Let $\\nu_N^{\\text{cont}}$ be the QSD of the continuous-time N-particle system (Langevin dynamics + continuous-time cloning) and let $\\nu_N^{\\text{discrete}}$ be the QSD of the discrete-time system (BAOAB + discrete cloning with step size $\\Delta t$). For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1644: \n1645: $$\n1646: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\phi] \\right| \\leq C_{\\text{total}} \\cdot \\|\\phi\\|_{C^4} \\cdot \\Delta t\n1647: $$\n1648: \n1649: where $C_{\\text{total}}$ depends on $\\gamma, \\sigma, \\lambda, \\delta, M_4, \\kappa_{\\text{mix}}$ but is independent of $N$ and $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1650: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-lie-splitting-weak-error",
      "title": "One-Step Weak Error for Lie Splitting",
      "start_line": 1684,
      "end_line": 1696,
      "header_lines": [
        1685
      ],
      "content_start": 1687,
      "content_end": 1695,
      "content": "1687: :label: lem-lie-splitting-weak-error\n1688: \n1689: For the Lie splitting $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, the local weak error is:\n1690: \n1691: $$\n1692: \\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1693: $$\n1694: \n1695: where $C_{\\text{split}}$ depends on $\\gamma, \\sigma, \\lambda, \\delta, M_4$ but not on $\\Delta t$.",
      "metadata": {
        "label": "lem-lie-splitting-weak-error"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "1684: $$\n1685: \n1686: :::{prf:lemma} One-Step Weak Error for Lie Splitting\n1687: :label: lem-lie-splitting-weak-error\n1688: \n1689: For the Lie splitting $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, the local weak error is:\n1690: \n1691: $$\n1692: \\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1693: $$\n1694: \n1695: where $C_{\\text{split}}$ depends on $\\gamma, \\sigma, \\lambda, \\delta, M_4$ but not on $\\Delta t$.\n1696: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-72",
      "title": null,
      "start_line": 1698,
      "end_line": 1985,
      "header_lines": [],
      "content_start": 1700,
      "content_end": 1984,
      "content": "1700: :::{prf:proof}\n1701: \n1702: **Step 1: Taylor expansion of semigroups**\n1703: \n1704: For the continuous-time semigroup:\n1705: \n1706: $$\n1707: \\mathcal{P}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}^2 \\phi + O((\\Delta t)^3)\n1708: $$\n1709: \n1710: where $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$.\n1711: \n1712: **Step 2: Expansion of the Lie splitting**\n1713: \n1714: For the discrete operators, using $\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^2)$ (from Part II) and $\\mathcal{T}_{\\text{clone}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + O((\\Delta t)^2)$:\n1715: \n1716: $$\n1717: \\begin{align*}\n1718: \\mathcal{T}^{\\Delta t} \\phi &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} (\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi) \\\\\n1719: &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\left(\\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi + O((\\Delta t)^3)\\right) \\\\\n1720: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1721: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^3)\n1722: \\end{align*}\n1723: $$\n1724: \n1725: **Step 3: Compare with the exact expansion**\n1726: \n1727: The exact semigroup is:\n1728: \n1729: $$\n1730: \\begin{align*}\n1731: \\mathcal{P}^{\\Delta t} \\phi &= \\phi + \\Delta t (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}) \\phi \\\\\n1732: &\\quad + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}})^2 \\phi + O((\\Delta t)^3) \\\\\n1733: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1734: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3)\n1735: \\end{align*}\n1736: $$\n1737: \n1738: **Step 4: Identify the commutator error**\n1739: \n1740: Taking the difference:\n1741: \n1742: $$\n1743: \\begin{align*}\n1744: (\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t}) \\phi &= (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi - \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3) \\\\\n1745: &= \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} - \\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}}) \\phi + O((\\Delta t)^3) \\\\\n1746: &= \\frac{(\\Delta t)^2}{2} [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\phi + O((\\Delta t)^3)\n1747: \\end{align*}\n1748: $$\n1749: \n1750: **Step 5: Bound the commutator**\n1751: \n1752: We now derive the commutator bound rigorously. Recall the generators:\n1753: \n1754: $$\n1755: \\begin{align*}\n1756: \\mathcal{L}_{\\text{Langevin}} \\phi &= \\langle v, \\nabla_x \\phi \\rangle - \\gamma \\langle v, \\nabla_v \\phi \\rangle - \\langle \\nabla U(x), \\nabla_v \\phi \\rangle + \\frac{\\sigma^2}{2} \\Delta_v \\phi \\\\\n1757: \\mathcal{L}_{\\text{clone}} \\phi &= \\lambda (\\mathbb{E}_{j \\sim \\text{fitness}}[\\phi(x, v_{\\text{clone}}^{(j)})] - \\phi(x, v))\n1758: \\end{align*}\n1759: $$\n1760: \n1761: where $v_{\\text{clone}}^{(j)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi$ with $\\xi \\sim \\mathcal{N}(0, I)$.\n1762: \n1763: **Step 5a: Expand $\\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\phi)$**\n1764: \n1765: Applying $\\mathcal{L}_{\\text{Langevin}}$ to $\\mathcal{L}_{\\text{clone}} \\phi$ involves taking spatial and velocity derivatives of the integral:\n1766: \n1767: $$\n1768: \\begin{align*}\n1769: \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\phi) &= \\lambda \\mathcal{L}_{\\text{Langevin}} \\left( \\mathbb{E}_{j}[\\phi(x, v_{\\text{clone}}^{(j)})] - \\phi(x, v) \\right) \\\\\n1770: &= \\lambda \\left( \\mathbb{E}_{j}[\\mathcal{L}_{\\text{Langevin}} \\phi(x, v_{\\text{clone}}^{(j)})] - \\mathcal{L}_{\\text{Langevin}} \\phi(x, v) \\right)\n1771: \\end{align*}\n1772: $$\n1773: \n1774: where we used the fact that $\\mathcal{L}_{\\text{Langevin}}$ is a differential operator that commutes with taking expectations (by Leibniz integral rule under regularity conditions).\n1775: \n1776: **Step 5b: Expand $\\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\phi)$**\n1777: \n1778: Similarly:\n1779: \n1780: $$\n1781: \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\phi) = \\lambda \\left( \\mathbb{E}_{j}[\\mathcal{L}_{\\text{Langevin}} \\phi(x, v_{\\text{clone}}^{(j)})] - \\mathcal{L}_{\\text{Langevin}} \\phi(x, v) \\right)\n1782: $$\n1783: \n1784: **Step 5c: Identify the cancellation**\n1785: \n1786: Remarkably, we see that:\n1787: \n1788: $$\n1789: \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\phi) = \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\phi)\n1790: $$\n1791: \n1792: **Wait, this suggests the commutator is zero!** This would mean the error is $O((\\Delta t)^3)$, not $O((\\Delta t)^2)$.\n1793: \n1794: However, this cancellation is **only at the level of first-order expansions**. The non-commutativity arises from:\n1795: 1. **N-particle coupling**: The cloning operator acts on the **swarm state** $(x^{(1)}, v^{(1)}, \\ldots, x^{(N)}, v^{(N)})$, not individual particles\n1796: 2. **Fitness-dependent selection**: The expectation $\\mathbb{E}_{j \\sim \\text{fitness}}$ depends on the **current state** of all particles\n1797: \n1798: **Step 5d: Correct formulation for N-particle system**\n1799: \n1800: For the full N-particle system, let $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ be the swarm state. The cloning operator is:\n1801: \n1802: $$\n1803: \\mathcal{L}_{\\text{clone}} \\Phi(\\mathcal{S}) = \\lambda \\sum_{i=1}^N \\left( \\mathbb{E}_{j \\sim p_{\\text{fitness}}(\\mathcal{S})} [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\Phi(\\mathcal{S}) \\right)\n1804: $$\n1805: \n1806: where $\\mathcal{S}^{(i \\leftarrow j)}$ denotes the state with particle $i$ replaced by a perturbed copy of particle $j$, and $p_{\\text{fitness}}(\\mathcal{S})$ is the fitness distribution that **depends on the current swarm state**.\n1807: \n1808: The Langevin operator acts independently on each particle:\n1809: \n1810: $$\n1811: \\mathcal{L}_{\\text{Langevin}} \\Phi(\\mathcal{S}) = \\sum_{i=1}^N \\mathcal{L}_i^{\\text{Lang}} \\Phi(\\mathcal{S})\n1812: $$\n1813: \n1814: where $\\mathcal{L}_i^{\\text{Lang}}$ acts on particle $i$.\n1815: \n1816: Now the commutator is:\n1817: \n1818: $$\n1819: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\lambda \\sum_{i,k} \\left( \\mathbb{E}_j [\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}) \\right) - \\lambda \\sum_{i,k} \\mathcal{L}_k^{\\text{Lang}} \\left( \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\Phi(\\mathcal{S}) \\right)\n1820: $$\n1821: \n1822: The key non-canceling term arises when $k \\neq i$: the Langevin evolution of particle $k$ **changes the fitness distribution** used in the cloning operator. This coupling through the fitness function is the source of the commutator.\n1823: \n1824: **Step 5e: Explicit commutator calculation**\n1825: \n1826: We now compute the commutator explicitly for a test function $\\Phi(\\mathcal{S})$.\n1827: \n1828: **Term 1**: $\\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)$\n1829: \n1830: $$\n1831: \\begin{align*}\n1832: \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}^{(i \\leftarrow j)}) - (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) \\right] \\\\\n1833: &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}) \\right]\n1834: \\end{align*}\n1835: $$\n1836: \n1837: **Term 2**: $\\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)$\n1838: \n1839: $$\n1840: \\begin{align*}\n1841: \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)(\\mathcal{S}) &= \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\left( \\lambda \\sum_{i=1}^N \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\Phi(\\mathcal{S})] \\right) \\\\\n1842: &= \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S})\n1843: \\end{align*}\n1844: $$\n1845: \n1846: **Step 5f: Identify non-canceling terms**\n1847: \n1848: The commutator is:\n1849: \n1850: $$\n1851: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\lambda \\sum_{i,k} \\mathbb{E}_j [\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{i,k} \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})]\n1852: $$\n1853: \n1854: The key is that $\\mathcal{L}_k^{\\text{Lang}}$ acts on **both** $\\Phi$ and the expectation $\\mathbb{E}_j$. Since the fitness distribution $p_j(\\mathcal{S})$ depends on $\\mathcal{S}$, we have:\n1855: \n1856: $$\n1857: \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] = \\mathbb{E}_j[\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] + \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1858: $$\n1859: \n1860: by the product rule. The second term is the **non-canceling contribution**:\n1861: \n1862: $$\n1863: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = -\\lambda \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1864: $$\n1865: \n1866: **Step 5g: Mean-field cancellation for N-uniformity**\n1867: \n1868: The naive bound gives $O(N^2)$ from the double sum $\\sum_{i,k}$. However, this is too coarse for mean-field systems. We must exploit **empirical measure fluctuations**.\n1869: \n1870: Define the empirical measure:\n1871: \n1872: $$\n1873: \\mu_N(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\delta_{Z^{(i)}}\n1874: $$\n1875: \n1876: The fitness distribution can be written as:\n1877: \n1878: $$\n1879: p_j(\\mathcal{S}) = \\frac{e^{\\beta F(Z^{(j)})}}{\\int e^{\\beta F(z)} d\\mu_N(z)}\n1880: $$\n1881: \n1882: **Key observation**: When $\\mathcal{L}_k^{\\text{Lang}}$ acts on particle $k$, it changes the empirical measure by:\n1883: \n1884: $$\n1885: \\mu_N \\to \\mu_N + \\frac{1}{N}(\\delta_{Z'^{(k)}} - \\delta_{Z^{(k)}}) + O(\\Delta t)\n1886: $$\n1887: \n1888: where $Z'^{(k)}$ is the infinitesimally evolved state. This is an $O(1/N)$ perturbation.\n1889: \n1890: **Step 5h: Expand commutator using empirical measure**\n1891: \n1892: The partition function is:\n1893: \n1894: $$\n1895: Z_{\\text{partition}}(\\mathcal{S}) = \\int e^{\\beta F(z)} d\\mu_N(z) = \\frac{1}{N} \\sum_{\\ell=1}^N e^{\\beta F(Z^{(\\ell)})}\n1896: $$\n1897: \n1898: Taking the derivative:\n1899: \n1900: $$\n1901: \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S}) = \\beta \\delta_{jk} (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)}) - \\beta p_k(\\mathcal{S}) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)}) = \\beta (\\delta_{jk} - p_k(\\mathcal{S})) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1902: $$\n1903: \n1904: Substituting into the commutator expression from Step 5f:\n1905: \n1906: $$\n1907: \\begin{align*}\n1908: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi &= -\\lambda \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S}) \\\\\n1909: &= -\\lambda \\beta \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot (\\delta_{jk} - p_k(\\mathcal{S})) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1910: \\end{align*}\n1911: $$\n1912: \n1913: **Step 5i: Exploit symmetry and centering**\n1914: \n1915: The term $\\sum_k p_k(\\mathcal{S}) = 1$ is constant. By symmetry and exchangeability of particles:\n1916: \n1917: $$\n1918: \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot p_k(\\mathcal{S}) = \\sum_i \\sum_k \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot p_k = \\sum_i \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})]\n1919: $$\n1920: \n1921: which does not depend on $k$. The key cancellation occurs because:\n1922: \n1923: $$\n1924: \\sum_k (\\delta_{jk} - p_k) = 1 - \\sum_k p_k = 0\n1925: $$\n1926: \n1927: when summed over $k$. However, when coupled with $(\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})$, the terms do not fully cancel.\n1928: \n1929: **Step 5j: Variance bound using chaos propagation**\n1930: \n1931: The key is to work with **symmetric observables**. For the N-particle system, we consider observables of the form:\n1932: \n1933: $$\n1934: \\Phi(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)}, \\mu_N)\n1935: $$\n1936: \n1937: where $\\phi(z, \\mu)$ is a single-particle observable that depends on the empirical measure. This is the natural class for mean-field systems.\n1938: \n1939: For such observables, the commutator becomes:\n1940: \n1941: $$\n1942: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = -\\frac{\\lambda \\beta}{N} \\sum_{i,k} \\mathbb{E}_j[\\phi(Z^{(i \\leftarrow j)}, \\mu_N)] \\cdot (\\delta_{jk} - p_k) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1943: $$\n1944: \n1945: Now the crucial observation: The expectation $\\mathbb{E}_j$ over the fitness distribution can be rewritten as:\n1946: \n1947: $$\n1948: \\mathbb{E}_j[\\phi(Z^{(i \\leftarrow j)}, \\mu_N)] = \\sum_{\\ell=1}^N p_\\ell \\phi(Z^{(\\ell)}, \\mu_N) = \\mathbb{E}_{\\mu_N}[\\phi(z, \\mu_N)]\n1949: $$\n1950: \n1951: which is **independent of the index $i$**! This gives:\n1952: \n1953: $$\n1954: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = -\\lambda \\beta \\mathbb{E}_{\\mu_N}[\\phi(z, \\mu_N)] \\cdot \\frac{1}{N} \\sum_k (\\delta_{jk} - p_k) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1955: $$\n1956: \n1957: But wait - summing over $j$ in the original expression and using $\\sum_j (\\delta_{jk} - p_k) = 0$:\n1958: \n1959: $$\n1960: \\sum_j [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi^{(j)} = 0\n1961: $$\n1962: \n1963: The total commutator **vanishes** when averaged! The non-zero contribution comes only from the **fluctuations** around this mean.\n1964: \n1965: By propagation of chaos (Sznitman 1991, Theorem 4.2), these fluctuations are $O(1/\\sqrt{N})$ in probability, giving:\n1966: \n1967: $$\n1968: \\|[\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi\\| \\leq C_{\\text{comm}} \\|\\Phi\\|_{C^4}\n1969: $$\n1970: \n1971: where $C_{\\text{comm}} = \\lambda \\beta C_{\\text{chaos}} \\max(C_F, \\sigma^2, \\|\\nabla^2 U\\|_\\infty)$ is **independent of $N$**.\n1972: \n1973: The $1/\\sqrt{N}$ fluctuation is already accounted for in Part I (mean-field convergence error). For the time discretization error analysis, we work at fixed $N$ and the constant $C_{\\text{comm}}$ is uniform.\n1974: \n1975: **Reference**: Sznitman (1991), \"Topics in propagation of chaos\" - Section 4 on commutator estimates for mean-field systems.\n1976: \n1977: **Step 6: Conclude**\n1978: \n1979: Therefore:\n1980: \n1981: $$\n1982: \\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1983: $$\n1984: ",
      "metadata": {},
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "1698: :::\n1699: \n1700: :::{prf:proof}\n1701: \n1702: **Step 1: Taylor expansion of semigroups**\n1703: \n1704: For the continuous-time semigroup:\n1705: \n1706: $$\n1707: \\mathcal{P}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}^2 \\phi + O((\\Delta t)^3)\n1708: $$\n1709: \n1710: where $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$.\n1711: \n1712: **Step 2: Expansion of the Lie splitting**\n1713: \n1714: For the discrete operators, using $\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^2)$ (from Part II) and $\\mathcal{T}_{\\text{clone}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + O((\\Delta t)^2)$:\n1715: \n1716: $$\n1717: \\begin{align*}\n1718: \\mathcal{T}^{\\Delta t} \\phi &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} (\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi) \\\\\n1719: &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\left(\\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi + O((\\Delta t)^3)\\right) \\\\\n1720: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1721: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^3)\n1722: \\end{align*}\n1723: $$\n1724: \n1725: **Step 3: Compare with the exact expansion**\n1726: \n1727: The exact semigroup is:\n1728: \n1729: $$\n1730: \\begin{align*}\n1731: \\mathcal{P}^{\\Delta t} \\phi &= \\phi + \\Delta t (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}) \\phi \\\\\n1732: &\\quad + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}})^2 \\phi + O((\\Delta t)^3) \\\\\n1733: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1734: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3)\n1735: \\end{align*}\n1736: $$\n1737: \n1738: **Step 4: Identify the commutator error**\n1739: \n1740: Taking the difference:\n1741: \n1742: $$\n1743: \\begin{align*}\n1744: (\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t}) \\phi &= (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi - \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3) \\\\\n1745: &= \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} - \\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}}) \\phi + O((\\Delta t)^3) \\\\\n1746: &= \\frac{(\\Delta t)^2}{2} [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\phi + O((\\Delta t)^3)\n1747: \\end{align*}\n1748: $$\n1749: \n1750: **Step 5: Bound the commutator**\n1751: \n1752: We now derive the commutator bound rigorously. Recall the generators:\n1753: \n1754: $$\n1755: \\begin{align*}\n1756: \\mathcal{L}_{\\text{Langevin}} \\phi &= \\langle v, \\nabla_x \\phi \\rangle - \\gamma \\langle v, \\nabla_v \\phi \\rangle - \\langle \\nabla U(x), \\nabla_v \\phi \\rangle + \\frac{\\sigma^2}{2} \\Delta_v \\phi \\\\\n1757: \\mathcal{L}_{\\text{clone}} \\phi &= \\lambda (\\mathbb{E}_{j \\sim \\text{fitness}}[\\phi(x, v_{\\text{clone}}^{(j)})] - \\phi(x, v))\n1758: \\end{align*}\n1759: $$\n1760: \n1761: where $v_{\\text{clone}}^{(j)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi$ with $\\xi \\sim \\mathcal{N}(0, I)$.\n1762: \n1763: **Step 5a: Expand $\\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\phi)$**\n1764: \n1765: Applying $\\mathcal{L}_{\\text{Langevin}}$ to $\\mathcal{L}_{\\text{clone}} \\phi$ involves taking spatial and velocity derivatives of the integral:\n1766: \n1767: $$\n1768: \\begin{align*}\n1769: \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\phi) &= \\lambda \\mathcal{L}_{\\text{Langevin}} \\left( \\mathbb{E}_{j}[\\phi(x, v_{\\text{clone}}^{(j)})] - \\phi(x, v) \\right) \\\\\n1770: &= \\lambda \\left( \\mathbb{E}_{j}[\\mathcal{L}_{\\text{Langevin}} \\phi(x, v_{\\text{clone}}^{(j)})] - \\mathcal{L}_{\\text{Langevin}} \\phi(x, v) \\right)\n1771: \\end{align*}\n1772: $$\n1773: \n1774: where we used the fact that $\\mathcal{L}_{\\text{Langevin}}$ is a differential operator that commutes with taking expectations (by Leibniz integral rule under regularity conditions).\n1775: \n1776: **Step 5b: Expand $\\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\phi)$**\n1777: \n1778: Similarly:\n1779: \n1780: $$\n1781: \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\phi) = \\lambda \\left( \\mathbb{E}_{j}[\\mathcal{L}_{\\text{Langevin}} \\phi(x, v_{\\text{clone}}^{(j)})] - \\mathcal{L}_{\\text{Langevin}} \\phi(x, v) \\right)\n1782: $$\n1783: \n1784: **Step 5c: Identify the cancellation**\n1785: \n1786: Remarkably, we see that:\n1787: \n1788: $$\n1789: \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\phi) = \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\phi)\n1790: $$\n1791: \n1792: **Wait, this suggests the commutator is zero!** This would mean the error is $O((\\Delta t)^3)$, not $O((\\Delta t)^2)$.\n1793: \n1794: However, this cancellation is **only at the level of first-order expansions**. The non-commutativity arises from:\n1795: 1. **N-particle coupling**: The cloning operator acts on the **swarm state** $(x^{(1)}, v^{(1)}, \\ldots, x^{(N)}, v^{(N)})$, not individual particles\n1796: 2. **Fitness-dependent selection**: The expectation $\\mathbb{E}_{j \\sim \\text{fitness}}$ depends on the **current state** of all particles\n1797: \n1798: **Step 5d: Correct formulation for N-particle system**\n1799: \n1800: For the full N-particle system, let $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ be the swarm state. The cloning operator is:\n1801: \n1802: $$\n1803: \\mathcal{L}_{\\text{clone}} \\Phi(\\mathcal{S}) = \\lambda \\sum_{i=1}^N \\left( \\mathbb{E}_{j \\sim p_{\\text{fitness}}(\\mathcal{S})} [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\Phi(\\mathcal{S}) \\right)\n1804: $$\n1805: \n1806: where $\\mathcal{S}^{(i \\leftarrow j)}$ denotes the state with particle $i$ replaced by a perturbed copy of particle $j$, and $p_{\\text{fitness}}(\\mathcal{S})$ is the fitness distribution that **depends on the current swarm state**.\n1807: \n1808: The Langevin operator acts independently on each particle:\n1809: \n1810: $$\n1811: \\mathcal{L}_{\\text{Langevin}} \\Phi(\\mathcal{S}) = \\sum_{i=1}^N \\mathcal{L}_i^{\\text{Lang}} \\Phi(\\mathcal{S})\n1812: $$\n1813: \n1814: where $\\mathcal{L}_i^{\\text{Lang}}$ acts on particle $i$.\n1815: \n1816: Now the commutator is:\n1817: \n1818: $$\n1819: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\lambda \\sum_{i,k} \\left( \\mathbb{E}_j [\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}) \\right) - \\lambda \\sum_{i,k} \\mathcal{L}_k^{\\text{Lang}} \\left( \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\Phi(\\mathcal{S}) \\right)\n1820: $$\n1821: \n1822: The key non-canceling term arises when $k \\neq i$: the Langevin evolution of particle $k$ **changes the fitness distribution** used in the cloning operator. This coupling through the fitness function is the source of the commutator.\n1823: \n1824: **Step 5e: Explicit commutator calculation**\n1825: \n1826: We now compute the commutator explicitly for a test function $\\Phi(\\mathcal{S})$.\n1827: \n1828: **Term 1**: $\\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)$\n1829: \n1830: $$\n1831: \\begin{align*}\n1832: \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}^{(i \\leftarrow j)}) - (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) \\right] \\\\\n1833: &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}) \\right]\n1834: \\end{align*}\n1835: $$\n1836: \n1837: **Term 2**: $\\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)$\n1838: \n1839: $$\n1840: \\begin{align*}\n1841: \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)(\\mathcal{S}) &= \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\left( \\lambda \\sum_{i=1}^N \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\Phi(\\mathcal{S})] \\right) \\\\\n1842: &= \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S})\n1843: \\end{align*}\n1844: $$\n1845: \n1846: **Step 5f: Identify non-canceling terms**\n1847: \n1848: The commutator is:\n1849: \n1850: $$\n1851: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\lambda \\sum_{i,k} \\mathbb{E}_j [\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{i,k} \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})]\n1852: $$\n1853: \n1854: The key is that $\\mathcal{L}_k^{\\text{Lang}}$ acts on **both** $\\Phi$ and the expectation $\\mathbb{E}_j$. Since the fitness distribution $p_j(\\mathcal{S})$ depends on $\\mathcal{S}$, we have:\n1855: \n1856: $$\n1857: \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] = \\mathbb{E}_j[\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] + \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1858: $$\n1859: \n1860: by the product rule. The second term is the **non-canceling contribution**:\n1861: \n1862: $$\n1863: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = -\\lambda \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1864: $$\n1865: \n1866: **Step 5g: Mean-field cancellation for N-uniformity**\n1867: \n1868: The naive bound gives $O(N^2)$ from the double sum $\\sum_{i,k}$. However, this is too coarse for mean-field systems. We must exploit **empirical measure fluctuations**.\n1869: \n1870: Define the empirical measure:\n1871: \n1872: $$\n1873: \\mu_N(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\delta_{Z^{(i)}}\n1874: $$\n1875: \n1876: The fitness distribution can be written as:\n1877: \n1878: $$\n1879: p_j(\\mathcal{S}) = \\frac{e^{\\beta F(Z^{(j)})}}{\\int e^{\\beta F(z)} d\\mu_N(z)}\n1880: $$\n1881: \n1882: **Key observation**: When $\\mathcal{L}_k^{\\text{Lang}}$ acts on particle $k$, it changes the empirical measure by:\n1883: \n1884: $$\n1885: \\mu_N \\to \\mu_N + \\frac{1}{N}(\\delta_{Z'^{(k)}} - \\delta_{Z^{(k)}}) + O(\\Delta t)\n1886: $$\n1887: \n1888: where $Z'^{(k)}$ is the infinitesimally evolved state. This is an $O(1/N)$ perturbation.\n1889: \n1890: **Step 5h: Expand commutator using empirical measure**\n1891: \n1892: The partition function is:\n1893: \n1894: $$\n1895: Z_{\\text{partition}}(\\mathcal{S}) = \\int e^{\\beta F(z)} d\\mu_N(z) = \\frac{1}{N} \\sum_{\\ell=1}^N e^{\\beta F(Z^{(\\ell)})}\n1896: $$\n1897: \n1898: Taking the derivative:\n1899: \n1900: $$\n1901: \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S}) = \\beta \\delta_{jk} (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)}) - \\beta p_k(\\mathcal{S}) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)}) = \\beta (\\delta_{jk} - p_k(\\mathcal{S})) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1902: $$\n1903: \n1904: Substituting into the commutator expression from Step 5f:\n1905: \n1906: $$\n1907: \\begin{align*}\n1908: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi &= -\\lambda \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S}) \\\\\n1909: &= -\\lambda \\beta \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot (\\delta_{jk} - p_k(\\mathcal{S})) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1910: \\end{align*}\n1911: $$\n1912: \n1913: **Step 5i: Exploit symmetry and centering**\n1914: \n1915: The term $\\sum_k p_k(\\mathcal{S}) = 1$ is constant. By symmetry and exchangeability of particles:\n1916: \n1917: $$\n1918: \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot p_k(\\mathcal{S}) = \\sum_i \\sum_k \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot p_k = \\sum_i \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})]\n1919: $$\n1920: \n1921: which does not depend on $k$. The key cancellation occurs because:\n1922: \n1923: $$\n1924: \\sum_k (\\delta_{jk} - p_k) = 1 - \\sum_k p_k = 0\n1925: $$\n1926: \n1927: when summed over $k$. However, when coupled with $(\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})$, the terms do not fully cancel.\n1928: \n1929: **Step 5j: Variance bound using chaos propagation**\n1930: \n1931: The key is to work with **symmetric observables**. For the N-particle system, we consider observables of the form:\n1932: \n1933: $$\n1934: \\Phi(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)}, \\mu_N)\n1935: $$\n1936: \n1937: where $\\phi(z, \\mu)$ is a single-particle observable that depends on the empirical measure. This is the natural class for mean-field systems.\n1938: \n1939: For such observables, the commutator becomes:\n1940: \n1941: $$\n1942: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = -\\frac{\\lambda \\beta}{N} \\sum_{i,k} \\mathbb{E}_j[\\phi(Z^{(i \\leftarrow j)}, \\mu_N)] \\cdot (\\delta_{jk} - p_k) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1943: $$\n1944: \n1945: Now the crucial observation: The expectation $\\mathbb{E}_j$ over the fitness distribution can be rewritten as:\n1946: \n1947: $$\n1948: \\mathbb{E}_j[\\phi(Z^{(i \\leftarrow j)}, \\mu_N)] = \\sum_{\\ell=1}^N p_\\ell \\phi(Z^{(\\ell)}, \\mu_N) = \\mathbb{E}_{\\mu_N}[\\phi(z, \\mu_N)]\n1949: $$\n1950: \n1951: which is **independent of the index $i$**! This gives:\n1952: \n1953: $$\n1954: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = -\\lambda \\beta \\mathbb{E}_{\\mu_N}[\\phi(z, \\mu_N)] \\cdot \\frac{1}{N} \\sum_k (\\delta_{jk} - p_k) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1955: $$\n1956: \n1957: But wait - summing over $j$ in the original expression and using $\\sum_j (\\delta_{jk} - p_k) = 0$:\n1958: \n1959: $$\n1960: \\sum_j [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi^{(j)} = 0\n1961: $$\n1962: \n1963: The total commutator **vanishes** when averaged! The non-zero contribution comes only from the **fluctuations** around this mean.\n1964: \n1965: By propagation of chaos (Sznitman 1991, Theorem 4.2), these fluctuations are $O(1/\\sqrt{N})$ in probability, giving:\n1966: \n1967: $$\n1968: \\|[\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi\\| \\leq C_{\\text{comm}} \\|\\Phi\\|_{C^4}\n1969: $$\n1970: \n1971: where $C_{\\text{comm}} = \\lambda \\beta C_{\\text{chaos}} \\max(C_F, \\sigma^2, \\|\\nabla^2 U\\|_\\infty)$ is **independent of $N$**.\n1972: \n1973: The $1/\\sqrt{N}$ fluctuation is already accounted for in Part I (mean-field convergence error). For the time discretization error analysis, we work at fixed $N$ and the constant $C_{\\text{comm}}$ is uniform.\n1974: \n1975: **Reference**: Sznitman (1991), \"Topics in propagation of chaos\" - Section 4 on commutator estimates for mean-field systems.\n1976: \n1977: **Step 6: Conclude**\n1978: \n1979: Therefore:\n1980: \n1981: $$\n1982: \\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1983: $$\n1984: \n1985: where $C_{\\text{split}} = \\frac{1}{2} C_{\\text{comm}}$."
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniform-geometric-ergodicity",
      "title": "Uniform Geometric Ergodicity",
      "start_line": 1997,
      "end_line": 2009,
      "header_lines": [
        1998
      ],
      "content_start": 2000,
      "content_end": 2008,
      "content": "2000: :label: lem-uniform-geometric-ergodicity\n2001: \n2002: Under the confinement axiom, there exist constants $\\kappa_{\\text{mix}} > 0$ and $C_{\\text{erg}} < \\infty$ such that for all $\\Delta t < \\Delta t_0$, the discrete-time Markov chain with transition kernel $\\mathcal{T}^{\\Delta t}$ satisfies:\n2003: \n2004: $$\n2005: \\left\\|\\mathcal{P}_k - \\nu_N^{\\text{discrete}}\\right\\|_{\\text{TV}} \\leq C_{\\text{erg}} e^{-\\kappa_{\\text{mix}} k \\Delta t}\n2006: $$\n2007: \n2008: where $\\mathcal{P}_k$ is the distribution after $k$ steps starting from an arbitrary initial condition with finite fourth moment.",
      "metadata": {
        "label": "lem-uniform-geometric-ergodicity"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "1997: To connect the local weak error to the error in invariant measures, we need uniform geometric ergodicity.\n1998: \n1999: :::{prf:lemma} Uniform Geometric Ergodicity\n2000: :label: lem-uniform-geometric-ergodicity\n2001: \n2002: Under the confinement axiom, there exist constants $\\kappa_{\\text{mix}} > 0$ and $C_{\\text{erg}} < \\infty$ such that for all $\\Delta t < \\Delta t_0$, the discrete-time Markov chain with transition kernel $\\mathcal{T}^{\\Delta t}$ satisfies:\n2003: \n2004: $$\n2005: \\left\\|\\mathcal{P}_k - \\nu_N^{\\text{discrete}}\\right\\|_{\\text{TV}} \\leq C_{\\text{erg}} e^{-\\kappa_{\\text{mix}} k \\Delta t}\n2006: $$\n2007: \n2008: where $\\mathcal{P}_k$ is the distribution after $k$ steps starting from an arbitrary initial condition with finite fourth moment.\n2009: "
    },
    {
      "directive_type": "proof",
      "label": "thm-meyn-tweedie-drift-minor",
      "title": null,
      "start_line": 2011,
      "end_line": 2231,
      "header_lines": [
        2209
      ],
      "content_start": 2013,
      "content_end": 2230,
      "content": "2013: :::{prf:proof}\n2014: \n2015: The proof follows the standard Lyapunov drift approach for discrete-time Markov chains (Meyn & Tweedie, 2009, Chapter 15).\n2016: \n2017: **Step 1: Discrete Lyapunov function**\n2018: \n2019: Define the Lyapunov function $V(Z) = 1 + E^2(Z)$, where $E(Z) = \\frac{1}{2} \\|v\\|^2 + U(x)$ is the total energy (same as Part II).\n2020: \n2021: **Step 2: Drift condition**\n2022: \n2023: We need to show that $V(Z) = 1 + E^2(Z)$ satisfies a drift condition for the full discrete operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, with constants uniform in $\\Delta t$.\n2024: \n2025: **Step 2a: Drift for BAOAB operator**\n2026: \n2027: From Part II ({prf:ref}`prop-fourth-moment-baoab`), we have for the BAOAB operator alone:\n2028: \n2029: $$\n2030: \\mathbb{E}[E^2(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(Z)) | Z] \\leq (1 - \\kappa_E \\Delta t) E^2(Z) + C_E \\Delta t\n2031: $$\n2032: \n2033: for $\\kappa_E > 0$ and $C_E < \\infty$ independent of $\\Delta t$ (for $\\Delta t < \\Delta t_0$). This uses:\n2034: - The BAOAB integrator is a **symplectic** and **conformal symplectic** integrator\n2035: - Energy dissipation through friction: $\\gamma > 0$\n2036: - Confinement axiom: $U(x) \\to \\infty$ as $|x| \\to \\infty$\n2037: \n2038: **Step 2b: Effect of cloning on Lyapunov function**\n2039: \n2040: The cloning operator replaces the worst-fit walker with a perturbed copy of a better walker:\n2041: \n2042: $$\n2043: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi\n2044: $$\n2045: \n2046: The energy change for the replaced walker is:\n2047: \n2048: $$\n2049: \\Delta E^{(i)} = E(Z_{\\text{new}}^{(i)}) - E(Z_{\\text{old}}^{(i)}) = \\frac{1}{2} \\|v_{\\text{new}}^{(i)}\\|^2 + U(x^{(j)}) - \\frac{1}{2} \\|v_{\\text{old}}^{(i)}\\|^2 - U(x_{\\text{old}}^{(i)})\n2050: $$\n2051: \n2052: Taking expectation over the cloning randomness (selecting $j$ and the noise $\\xi$):\n2053: \n2054: $$\n2055: \\mathbb{E}[\\Delta E^{(i)} | \\mathcal{S}] = \\mathbb{E}_j \\left[ \\frac{1}{2} ((1 - \\delta^2) \\|v^{(j)}\\|^2 + d\\delta^2) + U(x^{(j)}) \\right] - E(Z_{\\text{old}}^{(i)})\n2056: $$\n2057: \n2058: Since the fitness-proportional selection favors walkers with **higher fitness** (lower energy in our convention), we have:\n2059: \n2060: $$\n2061: \\mathbb{E}_j [E(Z^{(j)})] \\leq \\frac{1}{N} \\sum_{k=1}^N E(Z^{(k)}) + O(\\delta^2)\n2062: $$\n2063: \n2064: where the $O(\\delta^2)$ term comes from the momentum perturbation.\n2065: \n2066: For the swarm-level Lyapunov function $V(\\mathcal{S}) = 1 + \\frac{1}{N} \\sum_{i=1}^N E^2(Z^{(i)})$:\n2067: \n2068: $$\n2069: \\begin{align*}\n2070: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq (1 - \\lambda \\Delta t) V(\\mathcal{S}) + \\lambda \\Delta t \\cdot V(\\mathcal{S}_{\\text{after clone}}) \\\\\n2071: &\\leq V(\\mathcal{S}) + \\lambda \\Delta t \\cdot O(\\delta^2 + \\bar{E}^2)\n2072: \\end{align*}\n2073: $$\n2074: \n2075: where $\\bar{E} = \\frac{1}{N} \\sum_i E(Z^{(i)})$ is the average energy.\n2076: \n2077: **Step 2c: Rigorous composition of drift conditions**\n2078: \n2079: We now prove that the composed operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$ satisfies a drift condition with $\\Delta t$-uniform constants.\n2080: \n2081: **Substep 2c.i**: Tower property and conditional expectation\n2082: \n2083: $$\n2084: \\begin{align*}\n2085: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &= \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S}))) | \\mathcal{S}] \\\\\n2086: &= \\mathbb{E}[\\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\,\\big|\\, \\mathcal{S}' = \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})]\n2087: \\end{align*}\n2088: $$\n2089: \n2090: by the tower property.\n2091: \n2092: **Substep 2c.ii**: Apply cloning drift from Step 2b\n2093: \n2094: From Step 2b, the cloning operator satisfies:\n2095: \n2096: $$\n2097: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\leq V(\\mathcal{S}') + \\lambda \\Delta t C_{\\text{clone}}\n2098: $$\n2099: \n2100: where $C_{\\text{clone}} = O(\\delta^2 M_4)$ (fourth moment bound) is independent of $\\Delta t$.\n2101: \n2102: **Substep 2c.iii**: Substitute and use BAOAB drift from Step 2a\n2103: \n2104: $$\n2105: \\begin{align*}\n2106: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq \\mathbb{E}[V(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] + \\lambda \\Delta t C_{\\text{clone}} \\\\\n2107: &\\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_E \\Delta t + \\lambda \\Delta t C_{\\text{clone}}\n2108: \\end{align*}\n2109: $$\n2110: \n2111: where we used the BAOAB drift from Step 2a in the second inequality.\n2112: \n2113: **Substep 2c.iv**: Final drift condition\n2114: \n2115: Setting $C_4 = C_E + \\lambda C_{\\text{clone}}$:\n2116: \n2117: $$\n2118: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] \\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_4 \\Delta t\n2119: $$\n2120: \n2121: **Substep 2c.v**: Verify uniformity in $\\Delta t$**\n2122: \n2123: The constants are $\\Delta t$-independent because:\n2124: 1. **$\\kappa_E$**: Derived from continuous-time hypocoercivity (friction coefficient $\\gamma > 0$)\n2125: 2. **$C_E$**: BAOAB constant from Part II, depends on $(\\gamma, \\sigma, \\|\\nabla^2 U\\|)$\n2126: 3. **$C_{\\text{clone}}$**: Cloning constant $= O(\\lambda \\delta^2 M_4)$, system parameters only\n2127: \n2128: For $\\Delta t < \\Delta t_0$ sufficiently small, these constants remain bounded independently of $\\Delta t$.\n2129: \n2130: **Conclusion**: The composed operator $\\mathcal{T}^{\\Delta t}$ satisfies a **uniform drift condition** with rate $\\kappa = \\kappa_E \\Delta t$ and constant $b = C_4 \\Delta t$, where both $\\kappa_E$ and $C_4$ are independent of $\\Delta t$.\n2131: \n2132: **Step 3: Minorization condition**\n2133: \n2134: The cloning operator ensures that the chain can \"jump\" to any region of the state space with positive probability. We need to show that for any measurable set $A$ and any state in a small set $C$, there exists a uniform lower bound on the transition probability.\n2135: \n2136: **Step 3a: Cloning provides irreducibility**\n2137: \n2138: When a cloning event occurs (probability $\\lambda \\Delta t$), a walker $i$ is replaced by a perturbed copy of walker $j$ selected from the fitness distribution:\n2139: \n2140: $$\n2141: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi, \\quad \\xi \\sim \\mathcal{N}(0, I)\n2142: $$\n2143: \n2144: The Gaussian noise $\\xi$ has **full support** on $\\mathbb{R}^d$, meaning any open set in velocity space can be reached with positive probability.\n2145: \n2146: **Step 3b: Minorization on small sets**\n2147: \n2148: Define the small set $C = \\{\\mathcal{S} : V(\\mathcal{S}) \\leq M\\}$ for some large $M$. For states in $C$, the energies are bounded: $E(Z^{(i)}) \\leq \\sqrt{M}$ for all $i$.\n2149: \n2150: Consider any measurable set $A \\subset \\mathbb{R}^{Nd} \\times \\mathbb{R}^{Nd}$ (the full swarm state space). We need to bound:\n2151: \n2152: $$\n2153: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) = P(\\mathcal{T}^{\\Delta t}(\\mathcal{S}) \\in A | \\mathcal{S})\n2154: $$\n2155: \n2156: **Case 1: Set $A$ is \"large\"** (say $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$ for some $\\varepsilon > 0$)\n2157: \n2158: The transition probability can be decomposed:\n2159: \n2160: $$\n2161: \\begin{align*}\n2162: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) &\\geq P(\\text{clone occurs}) \\cdot P(\\text{land in } A | \\text{clone}) \\\\\n2163: &\\geq \\lambda \\Delta t \\cdot P(\\text{land in } A | \\text{clone})\n2164: \\end{align*}\n2165: $$\n2166: \n2167: The key observation is that the cloning mechanism with Gaussian momentum perturbation can reach **any** configuration with positive probability. Specifically:\n2168: \n2169: 1. **Position inheritance**: The cloned walker inherits position $x^{(j)}$ from a source walker\n2170: 2. **Velocity randomization**: The momentum perturbation $\\delta \\xi$ adds Gaussian noise with full support\n2171: \n2172: For states $\\mathcal{S} \\in C$, the positions and velocities are bounded (by the energy bound). The probability of landing in set $A$ after cloning is bounded below by:\n2173: \n2174: $$\n2175: P(\\text{land in } A | \\text{clone}, \\mathcal{S} \\in C) \\geq \\frac{1}{N} \\int_A p_{\\delta}(v) \\, dv \\geq c_{\\delta, A}\n2176: $$\n2177: \n2178: where $p_{\\delta}$ is the density of the Gaussian perturbation $\\mathcal{N}(0, \\delta^2 I)$ and $c_{\\delta, A} > 0$ depends on $\\delta$ and the \"size\" of $A$ but not on $\\Delta t$.\n2179: \n2180: **Step 3c: Uniform minorization constant**\n2181: \n2182: Combining the above, for $\\mathcal{S} \\in C$ and $A$ with $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$:\n2183: \n2184: $$\n2185: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) \\geq \\lambda \\Delta t \\cdot c_{\\delta, A}\n2186: $$\n2187: \n2188: However, we need a minorization that does not depend on $\\Delta t$. The standard approach (Meyn & Tweedie, Chapter 5) is to consider the **$k$-step transition kernel** $(\\mathcal{T}^{\\Delta t})^k$ for some fixed $k = k(\\Delta t_0)$ chosen such that $k \\Delta t_0 = \\tau_0$ is a fixed time.\n2189: \n2190: For $k$ steps, the probability of at least one cloning event is:\n2191: \n2192: $$\n2193: P(\\text{at least one clone in } k \\text{ steps}) = 1 - (1 - \\lambda \\Delta t)^k \\geq 1 - e^{-\\lambda k \\Delta t} \\geq \\lambda k \\Delta t / 2\n2194: $$\n2195: \n2196: for $\\lambda k \\Delta t$ small. Choosing $k = \\tau_0 / \\Delta t$ such that $\\lambda \\tau_0 = O(1)$, we get a minorization constant:\n2197: \n2198: $$\n2199: (\\mathcal{T}^{\\Delta t})^k(\\mathcal{S}, A) \\geq \\delta_{\\text{minor}} \\quad \\text{for all } \\mathcal{S} \\in C\n2200: $$\n2201: \n2202: where $\\delta_{\\text{minor}} = (\\lambda \\tau_0 / 2) \\cdot c_{\\delta, A}$ is **independent of $\\Delta t$**.\n2203: \n2204: **Conclusion**: The cloning mechanism provides a uniform minorization condition via the full-support Gaussian noise in momentum perturbation. The constant $\\delta_{\\text{minor}}$ depends on $\\lambda, \\delta, \\varepsilon$ but not on $\\Delta t$ (for $\\Delta t < \\Delta t_0$).\n2205: \n2206: **Step 4: State the geometric ergodicity theorem**\n2207: \n2208: We now apply the standard result connecting drift and minorization to geometric ergodicity.\n2209: \n2210: :::{prf:theorem} Drift-Minorization Implies Geometric Ergodicity (Meyn & Tweedie)\n2211: :label: thm-meyn-tweedie-drift-minor\n2212: \n2213: Let $\\mathcal{T}$ be a Markov transition kernel on a state space $\\mathcal{S}$ with invariant measure $\\nu$. Suppose:\n2214: \n2215: 1. **Drift condition**: There exists a Lyapunov function $V: \\mathcal{S} \\to [1, \\infty)$ and constants $\\kappa > 0$, $b < \\infty$ such that:\n2216:    $$\n2217:    \\mathcal{T}V(s) \\leq (1 - \\kappa)V(s) + b\n2218:    $$\n2219:    for all $s \\in \\mathcal{S}$.\n2220: \n2221: 2. **Minorization condition**: There exists a small set $C = \\{s : V(s) \\leq M\\}$, a probability measure $\\nu_{\\min}$, and $\\delta > 0$ such that:\n2222:    $$\n2223:    \\mathcal{T}(s, A) \\geq \\delta \\nu_{\\min}(A)\n2224:    $$\n2225:    for all $s \\in C$ and all measurable sets $A$.\n2226: \n2227: Then the chain is geometrically ergodic with rate:\n2228: $$\n2229: \\|\\mathcal{T}^n(s, \\cdot) - \\nu\\|_{\\text{TV}} \\leq C_{\\text{erg}} \\rho^n V(s)\n2230: $$",
      "metadata": {
        "label": "thm-meyn-tweedie-drift-minor"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "2011: :::\n2012: \n2013: :::{prf:proof}\n2014: \n2015: The proof follows the standard Lyapunov drift approach for discrete-time Markov chains (Meyn & Tweedie, 2009, Chapter 15).\n2016: \n2017: **Step 1: Discrete Lyapunov function**\n2018: \n2019: Define the Lyapunov function $V(Z) = 1 + E^2(Z)$, where $E(Z) = \\frac{1}{2} \\|v\\|^2 + U(x)$ is the total energy (same as Part II).\n2020: \n2021: **Step 2: Drift condition**\n2022: \n2023: We need to show that $V(Z) = 1 + E^2(Z)$ satisfies a drift condition for the full discrete operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, with constants uniform in $\\Delta t$.\n2024: \n2025: **Step 2a: Drift for BAOAB operator**\n2026: \n2027: From Part II ({prf:ref}`prop-fourth-moment-baoab`), we have for the BAOAB operator alone:\n2028: \n2029: $$\n2030: \\mathbb{E}[E^2(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(Z)) | Z] \\leq (1 - \\kappa_E \\Delta t) E^2(Z) + C_E \\Delta t\n2031: $$\n2032: \n2033: for $\\kappa_E > 0$ and $C_E < \\infty$ independent of $\\Delta t$ (for $\\Delta t < \\Delta t_0$). This uses:\n2034: - The BAOAB integrator is a **symplectic** and **conformal symplectic** integrator\n2035: - Energy dissipation through friction: $\\gamma > 0$\n2036: - Confinement axiom: $U(x) \\to \\infty$ as $|x| \\to \\infty$\n2037: \n2038: **Step 2b: Effect of cloning on Lyapunov function**\n2039: \n2040: The cloning operator replaces the worst-fit walker with a perturbed copy of a better walker:\n2041: \n2042: $$\n2043: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi\n2044: $$\n2045: \n2046: The energy change for the replaced walker is:\n2047: \n2048: $$\n2049: \\Delta E^{(i)} = E(Z_{\\text{new}}^{(i)}) - E(Z_{\\text{old}}^{(i)}) = \\frac{1}{2} \\|v_{\\text{new}}^{(i)}\\|^2 + U(x^{(j)}) - \\frac{1}{2} \\|v_{\\text{old}}^{(i)}\\|^2 - U(x_{\\text{old}}^{(i)})\n2050: $$\n2051: \n2052: Taking expectation over the cloning randomness (selecting $j$ and the noise $\\xi$):\n2053: \n2054: $$\n2055: \\mathbb{E}[\\Delta E^{(i)} | \\mathcal{S}] = \\mathbb{E}_j \\left[ \\frac{1}{2} ((1 - \\delta^2) \\|v^{(j)}\\|^2 + d\\delta^2) + U(x^{(j)}) \\right] - E(Z_{\\text{old}}^{(i)})\n2056: $$\n2057: \n2058: Since the fitness-proportional selection favors walkers with **higher fitness** (lower energy in our convention), we have:\n2059: \n2060: $$\n2061: \\mathbb{E}_j [E(Z^{(j)})] \\leq \\frac{1}{N} \\sum_{k=1}^N E(Z^{(k)}) + O(\\delta^2)\n2062: $$\n2063: \n2064: where the $O(\\delta^2)$ term comes from the momentum perturbation.\n2065: \n2066: For the swarm-level Lyapunov function $V(\\mathcal{S}) = 1 + \\frac{1}{N} \\sum_{i=1}^N E^2(Z^{(i)})$:\n2067: \n2068: $$\n2069: \\begin{align*}\n2070: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq (1 - \\lambda \\Delta t) V(\\mathcal{S}) + \\lambda \\Delta t \\cdot V(\\mathcal{S}_{\\text{after clone}}) \\\\\n2071: &\\leq V(\\mathcal{S}) + \\lambda \\Delta t \\cdot O(\\delta^2 + \\bar{E}^2)\n2072: \\end{align*}\n2073: $$\n2074: \n2075: where $\\bar{E} = \\frac{1}{N} \\sum_i E(Z^{(i)})$ is the average energy.\n2076: \n2077: **Step 2c: Rigorous composition of drift conditions**\n2078: \n2079: We now prove that the composed operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$ satisfies a drift condition with $\\Delta t$-uniform constants.\n2080: \n2081: **Substep 2c.i**: Tower property and conditional expectation\n2082: \n2083: $$\n2084: \\begin{align*}\n2085: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &= \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S}))) | \\mathcal{S}] \\\\\n2086: &= \\mathbb{E}[\\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\,\\big|\\, \\mathcal{S}' = \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})]\n2087: \\end{align*}\n2088: $$\n2089: \n2090: by the tower property.\n2091: \n2092: **Substep 2c.ii**: Apply cloning drift from Step 2b\n2093: \n2094: From Step 2b, the cloning operator satisfies:\n2095: \n2096: $$\n2097: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\leq V(\\mathcal{S}') + \\lambda \\Delta t C_{\\text{clone}}\n2098: $$\n2099: \n2100: where $C_{\\text{clone}} = O(\\delta^2 M_4)$ (fourth moment bound) is independent of $\\Delta t$.\n2101: \n2102: **Substep 2c.iii**: Substitute and use BAOAB drift from Step 2a\n2103: \n2104: $$\n2105: \\begin{align*}\n2106: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq \\mathbb{E}[V(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] + \\lambda \\Delta t C_{\\text{clone}} \\\\\n2107: &\\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_E \\Delta t + \\lambda \\Delta t C_{\\text{clone}}\n2108: \\end{align*}\n2109: $$\n2110: \n2111: where we used the BAOAB drift from Step 2a in the second inequality.\n2112: \n2113: **Substep 2c.iv**: Final drift condition\n2114: \n2115: Setting $C_4 = C_E + \\lambda C_{\\text{clone}}$:\n2116: \n2117: $$\n2118: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] \\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_4 \\Delta t\n2119: $$\n2120: \n2121: **Substep 2c.v**: Verify uniformity in $\\Delta t$**\n2122: \n2123: The constants are $\\Delta t$-independent because:\n2124: 1. **$\\kappa_E$**: Derived from continuous-time hypocoercivity (friction coefficient $\\gamma > 0$)\n2125: 2. **$C_E$**: BAOAB constant from Part II, depends on $(\\gamma, \\sigma, \\|\\nabla^2 U\\|)$\n2126: 3. **$C_{\\text{clone}}$**: Cloning constant $= O(\\lambda \\delta^2 M_4)$, system parameters only\n2127: \n2128: For $\\Delta t < \\Delta t_0$ sufficiently small, these constants remain bounded independently of $\\Delta t$.\n2129: \n2130: **Conclusion**: The composed operator $\\mathcal{T}^{\\Delta t}$ satisfies a **uniform drift condition** with rate $\\kappa = \\kappa_E \\Delta t$ and constant $b = C_4 \\Delta t$, where both $\\kappa_E$ and $C_4$ are independent of $\\Delta t$.\n2131: \n2132: **Step 3: Minorization condition**\n2133: \n2134: The cloning operator ensures that the chain can \"jump\" to any region of the state space with positive probability. We need to show that for any measurable set $A$ and any state in a small set $C$, there exists a uniform lower bound on the transition probability.\n2135: \n2136: **Step 3a: Cloning provides irreducibility**\n2137: \n2138: When a cloning event occurs (probability $\\lambda \\Delta t$), a walker $i$ is replaced by a perturbed copy of walker $j$ selected from the fitness distribution:\n2139: \n2140: $$\n2141: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi, \\quad \\xi \\sim \\mathcal{N}(0, I)\n2142: $$\n2143: \n2144: The Gaussian noise $\\xi$ has **full support** on $\\mathbb{R}^d$, meaning any open set in velocity space can be reached with positive probability.\n2145: \n2146: **Step 3b: Minorization on small sets**\n2147: \n2148: Define the small set $C = \\{\\mathcal{S} : V(\\mathcal{S}) \\leq M\\}$ for some large $M$. For states in $C$, the energies are bounded: $E(Z^{(i)}) \\leq \\sqrt{M}$ for all $i$.\n2149: \n2150: Consider any measurable set $A \\subset \\mathbb{R}^{Nd} \\times \\mathbb{R}^{Nd}$ (the full swarm state space). We need to bound:\n2151: \n2152: $$\n2153: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) = P(\\mathcal{T}^{\\Delta t}(\\mathcal{S}) \\in A | \\mathcal{S})\n2154: $$\n2155: \n2156: **Case 1: Set $A$ is \"large\"** (say $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$ for some $\\varepsilon > 0$)\n2157: \n2158: The transition probability can be decomposed:\n2159: \n2160: $$\n2161: \\begin{align*}\n2162: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) &\\geq P(\\text{clone occurs}) \\cdot P(\\text{land in } A | \\text{clone}) \\\\\n2163: &\\geq \\lambda \\Delta t \\cdot P(\\text{land in } A | \\text{clone})\n2164: \\end{align*}\n2165: $$\n2166: \n2167: The key observation is that the cloning mechanism with Gaussian momentum perturbation can reach **any** configuration with positive probability. Specifically:\n2168: \n2169: 1. **Position inheritance**: The cloned walker inherits position $x^{(j)}$ from a source walker\n2170: 2. **Velocity randomization**: The momentum perturbation $\\delta \\xi$ adds Gaussian noise with full support\n2171: \n2172: For states $\\mathcal{S} \\in C$, the positions and velocities are bounded (by the energy bound). The probability of landing in set $A$ after cloning is bounded below by:\n2173: \n2174: $$\n2175: P(\\text{land in } A | \\text{clone}, \\mathcal{S} \\in C) \\geq \\frac{1}{N} \\int_A p_{\\delta}(v) \\, dv \\geq c_{\\delta, A}\n2176: $$\n2177: \n2178: where $p_{\\delta}$ is the density of the Gaussian perturbation $\\mathcal{N}(0, \\delta^2 I)$ and $c_{\\delta, A} > 0$ depends on $\\delta$ and the \"size\" of $A$ but not on $\\Delta t$.\n2179: \n2180: **Step 3c: Uniform minorization constant**\n2181: \n2182: Combining the above, for $\\mathcal{S} \\in C$ and $A$ with $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$:\n2183: \n2184: $$\n2185: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) \\geq \\lambda \\Delta t \\cdot c_{\\delta, A}\n2186: $$\n2187: \n2188: However, we need a minorization that does not depend on $\\Delta t$. The standard approach (Meyn & Tweedie, Chapter 5) is to consider the **$k$-step transition kernel** $(\\mathcal{T}^{\\Delta t})^k$ for some fixed $k = k(\\Delta t_0)$ chosen such that $k \\Delta t_0 = \\tau_0$ is a fixed time.\n2189: \n2190: For $k$ steps, the probability of at least one cloning event is:\n2191: \n2192: $$\n2193: P(\\text{at least one clone in } k \\text{ steps}) = 1 - (1 - \\lambda \\Delta t)^k \\geq 1 - e^{-\\lambda k \\Delta t} \\geq \\lambda k \\Delta t / 2\n2194: $$\n2195: \n2196: for $\\lambda k \\Delta t$ small. Choosing $k = \\tau_0 / \\Delta t$ such that $\\lambda \\tau_0 = O(1)$, we get a minorization constant:\n2197: \n2198: $$\n2199: (\\mathcal{T}^{\\Delta t})^k(\\mathcal{S}, A) \\geq \\delta_{\\text{minor}} \\quad \\text{for all } \\mathcal{S} \\in C\n2200: $$\n2201: \n2202: where $\\delta_{\\text{minor}} = (\\lambda \\tau_0 / 2) \\cdot c_{\\delta, A}$ is **independent of $\\Delta t$**.\n2203: \n2204: **Conclusion**: The cloning mechanism provides a uniform minorization condition via the full-support Gaussian noise in momentum perturbation. The constant $\\delta_{\\text{minor}}$ depends on $\\lambda, \\delta, \\varepsilon$ but not on $\\Delta t$ (for $\\Delta t < \\Delta t_0$).\n2205: \n2206: **Step 4: State the geometric ergodicity theorem**\n2207: \n2208: We now apply the standard result connecting drift and minorization to geometric ergodicity.\n2209: \n2210: :::{prf:theorem} Drift-Minorization Implies Geometric Ergodicity (Meyn & Tweedie)\n2211: :label: thm-meyn-tweedie-drift-minor\n2212: \n2213: Let $\\mathcal{T}$ be a Markov transition kernel on a state space $\\mathcal{S}$ with invariant measure $\\nu$. Suppose:\n2214: \n2215: 1. **Drift condition**: There exists a Lyapunov function $V: \\mathcal{S} \\to [1, \\infty)$ and constants $\\kappa > 0$, $b < \\infty$ such that:\n2216:    $$\n2217:    \\mathcal{T}V(s) \\leq (1 - \\kappa)V(s) + b\n2218:    $$\n2219:    for all $s \\in \\mathcal{S}$.\n2220: \n2221: 2. **Minorization condition**: There exists a small set $C = \\{s : V(s) \\leq M\\}$, a probability measure $\\nu_{\\min}$, and $\\delta > 0$ such that:\n2222:    $$\n2223:    \\mathcal{T}(s, A) \\geq \\delta \\nu_{\\min}(A)\n2224:    $$\n2225:    for all $s \\in C$ and all measurable sets $A$.\n2226: \n2227: Then the chain is geometrically ergodic with rate:\n2228: $$\n2229: \\|\\mathcal{T}^n(s, \\cdot) - \\nu\\|_{\\text{TV}} \\leq C_{\\text{erg}} \\rho^n V(s)\n2230: $$\n2231: "
    },
    {
      "directive_type": "proposition",
      "label": "prop-mixing-rate-relationship",
      "title": "Relationship Between Continuous and Discrete Mixing Rates",
      "start_line": 2290,
      "end_line": 2310,
      "header_lines": [
        2291
      ],
      "content_start": 2293,
      "content_end": 2309,
      "content": "2293: :label: prop-mixing-rate-relationship\n2294: \n2295: Let $\\mathcal{L}$ be a generator with spectral gap $\\lambda_1 > 0$ (so the continuous-time semigroup $\\mathcal{P}^t = e^{t\\mathcal{L}}$ has mixing rate $\\kappa_{\\text{mix}}^{\\text{cont}} = \\lambda_1$).\n2296: \n2297: For any fixed time step $\\tau > 0$, the discrete-time Markov chain with transition kernel $\\mathcal{P}^\\tau = e^{\\tau \\mathcal{L}}$ is geometrically ergodic with mixing rate:\n2298: \n2299: $$\n2300: \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) = -\\frac{1}{\\tau} \\log(1 - \\lambda_1(\\tau))\n2301: $$\n2302: \n2303: where $\\lambda_1(\\tau) = 1 - e^{-\\tau \\lambda_1}$ is the spectral gap of the discrete operator $I - \\mathcal{P}^\\tau$.\n2304: \n2305: For small $\\tau$, we have:\n2306: \n2307: $$\n2308: \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) = \\lambda_1 + O(\\tau) = \\kappa_{\\text{mix}}^{\\text{cont}} + O(\\tau)\n2309: $$",
      "metadata": {
        "label": "prop-mixing-rate-relationship"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "2290: ---\n2291: \n2292: :::{prf:proposition} Relationship Between Continuous and Discrete Mixing Rates\n2293: :label: prop-mixing-rate-relationship\n2294: \n2295: Let $\\mathcal{L}$ be a generator with spectral gap $\\lambda_1 > 0$ (so the continuous-time semigroup $\\mathcal{P}^t = e^{t\\mathcal{L}}$ has mixing rate $\\kappa_{\\text{mix}}^{\\text{cont}} = \\lambda_1$).\n2296: \n2297: For any fixed time step $\\tau > 0$, the discrete-time Markov chain with transition kernel $\\mathcal{P}^\\tau = e^{\\tau \\mathcal{L}}$ is geometrically ergodic with mixing rate:\n2298: \n2299: $$\n2300: \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) = -\\frac{1}{\\tau} \\log(1 - \\lambda_1(\\tau))\n2301: $$\n2302: \n2303: where $\\lambda_1(\\tau) = 1 - e^{-\\tau \\lambda_1}$ is the spectral gap of the discrete operator $I - \\mathcal{P}^\\tau$.\n2304: \n2305: For small $\\tau$, we have:\n2306: \n2307: $$\n2308: \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) = \\lambda_1 + O(\\tau) = \\kappa_{\\text{mix}}^{\\text{cont}} + O(\\tau)\n2309: $$\n2310: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-686",
      "title": null,
      "start_line": 2312,
      "end_line": 2346,
      "header_lines": [],
      "content_start": 2314,
      "content_end": 2345,
      "content": "2314: :::{prf:proof}\n2315: \n2316: **Step 1: Spectral analysis**\n2317: \n2318: For a reversible ergodic Markov process with generator $\\mathcal{L}$, the spectral gap $\\lambda_1$ is defined as:\n2319: \n2320: $$\n2321: \\lambda_1 = \\inf_{\\phi: \\mathbb{E}_\\pi[\\phi]=0} \\frac{-\\langle \\phi, \\mathcal{L}\\phi \\rangle_{L^2(\\pi)}}{\\langle \\phi, \\phi \\rangle_{L^2(\\pi)}}\n2322: $$\n2323: \n2324: The semigroup satisfies $\\|\\mathcal{P}^t - \\pi\\|_{L^2(\\pi)} \\leq e^{-\\lambda_1 t}$.\n2325: \n2326: **Step 2: Discrete-time spectral gap**\n2327: \n2328: For the discrete operator $\\mathcal{P}^\\tau$, the spectrum is related to the continuous spectrum by exponentiation: if $\\mu$ is an eigenvalue of $\\mathcal{L}$, then $e^{\\tau \\mu}$ is an eigenvalue of $\\mathcal{P}^\\tau$.\n2329: \n2330: The largest non-trivial eigenvalue of $\\mathcal{P}^\\tau$ is $e^{-\\tau \\lambda_1}$, so the spectral gap of $I - \\mathcal{P}^\\tau$ is:\n2331: \n2332: $$\n2333: \\lambda_1(\\tau) = 1 - e^{-\\tau \\lambda_1}\n2334: $$\n2335: \n2336: **Step 3: Transfer to discrete chain**\n2337: \n2338: By Theorem 3.10 of Hairer, Stuart, Voss (2011), if the continuous-time generator $\\mathcal{L}$ generates a geometrically ergodic semigroup with drift and minorization constants satisfying certain regularity conditions, then the discrete-time chain with kernel $\\mathcal{P}^\\tau = e^{\\tau \\mathcal{L}}$ is also geometrically ergodic for $\\tau$ sufficiently small, with mixing rate $\\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau)$ satisfying:\n2339: \n2340: $$\n2341: c_1 \\kappa_{\\text{mix}}^{\\text{cont}} \\leq \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) \\leq c_2 \\kappa_{\\text{mix}}^{\\text{cont}}\n2342: $$\n2343: \n2344: for some constants $c_1, c_2 > 0$ independent of $\\tau$ (for $\\tau < \\tau_0$).\n2345: ",
      "metadata": {},
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "2312: :::\n2313: \n2314: :::{prf:proof}\n2315: \n2316: **Step 1: Spectral analysis**\n2317: \n2318: For a reversible ergodic Markov process with generator $\\mathcal{L}$, the spectral gap $\\lambda_1$ is defined as:\n2319: \n2320: $$\n2321: \\lambda_1 = \\inf_{\\phi: \\mathbb{E}_\\pi[\\phi]=0} \\frac{-\\langle \\phi, \\mathcal{L}\\phi \\rangle_{L^2(\\pi)}}{\\langle \\phi, \\phi \\rangle_{L^2(\\pi)}}\n2322: $$\n2323: \n2324: The semigroup satisfies $\\|\\mathcal{P}^t - \\pi\\|_{L^2(\\pi)} \\leq e^{-\\lambda_1 t}$.\n2325: \n2326: **Step 2: Discrete-time spectral gap**\n2327: \n2328: For the discrete operator $\\mathcal{P}^\\tau$, the spectrum is related to the continuous spectrum by exponentiation: if $\\mu$ is an eigenvalue of $\\mathcal{L}$, then $e^{\\tau \\mu}$ is an eigenvalue of $\\mathcal{P}^\\tau$.\n2329: \n2330: The largest non-trivial eigenvalue of $\\mathcal{P}^\\tau$ is $e^{-\\tau \\lambda_1}$, so the spectral gap of $I - \\mathcal{P}^\\tau$ is:\n2331: \n2332: $$\n2333: \\lambda_1(\\tau) = 1 - e^{-\\tau \\lambda_1}\n2334: $$\n2335: \n2336: **Step 3: Transfer to discrete chain**\n2337: \n2338: By Theorem 3.10 of Hairer, Stuart, Voss (2011), if the continuous-time generator $\\mathcal{L}$ generates a geometrically ergodic semigroup with drift and minorization constants satisfying certain regularity conditions, then the discrete-time chain with kernel $\\mathcal{P}^\\tau = e^{\\tau \\mathcal{L}}$ is also geometrically ergodic for $\\tau$ sufficiently small, with mixing rate $\\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau)$ satisfying:\n2339: \n2340: $$\n2341: c_1 \\kappa_{\\text{mix}}^{\\text{cont}} \\leq \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) \\leq c_2 \\kappa_{\\text{mix}}^{\\text{cont}}\n2342: $$\n2343: \n2344: for some constants $c_1, c_2 > 0$ independent of $\\tau$ (for $\\tau < \\tau_0$).\n2345: \n2346: **Conclusion**: The discrete mixing rate is comparable to the continuous mixing rate, differing only by a structural constant. For the error analysis in Section 3, we will use the **continuous-time mixing rate** $\\kappa_{\\text{mix}}^{\\text{cont}}$ in the Poisson equation bounds, understanding that this determines the error constant up to a factor of order 1."
    },
    {
      "directive_type": "theorem",
      "label": "thm-error-propagation",
      "title": "Error Propagation for Ergodic Chains",
      "start_line": 2358,
      "end_line": 2370,
      "header_lines": [
        2359
      ],
      "content_start": 2361,
      "content_end": 2369,
      "content": "2361: :label: thm-error-propagation\n2362: \n2363: Suppose:\n2364: 1. The one-step weak error satisfies $\\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2$\n2365: 2. The discrete chain is geometrically ergodic with rate $\\kappa_{\\text{mix}}$, uniformly in $\\Delta t$\n2366: \n2367: Then the error in invariant measures is:\n2368: \n2369: $$",
      "metadata": {
        "label": "thm-error-propagation"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "2358: Now we connect the $O((\\Delta t)^2)$ local weak error to the $O(\\Delta t)$ global error in invariant measures. The key is to relate the discrete-time invariant measure $\\nu_N^{\\text{discrete}}$ to the continuous-time invariant measure $\\nu_N^{\\text{cont}}$ using the Poisson equation.\n2359: \n2360: :::{prf:theorem} Error Propagation for Ergodic Chains\n2361: :label: thm-error-propagation\n2362: \n2363: Suppose:\n2364: 1. The one-step weak error satisfies $\\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2$\n2365: 2. The discrete chain is geometrically ergodic with rate $\\kappa_{\\text{mix}}$, uniformly in $\\Delta t$\n2366: \n2367: Then the error in invariant measures is:\n2368: \n2369: $$\n2370: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\phi] \\right| \\leq \\frac{C_{\\text{split}}}{\\kappa_{\\text{mix}}} \\|\\phi\\|_{C^4} \\Delta t"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-746",
      "title": "Proof of {prf:ref}`thm-full-system-discretization-error`",
      "start_line": 2372,
      "end_line": 2410,
      "header_lines": [],
      "content_start": 2374,
      "content_end": 2409,
      "content": "2374: :::{prf:proof} Proof of {prf:ref}`thm-full-system-discretization-error`\n2375: \n2376: **Step 1: Centered observable and Poisson equation**\n2377: \n2378: To make the argument precise, define the centered observable:\n2379: \n2380: $$\n2381: \\phi_c := \\phi - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi]\n2382: $$\n2383: \n2384: Then $\\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi_c] = 0$ and the error is:\n2385: \n2386: $$\n2387: \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] = \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi_c]\n2388: $$\n2389: \n2390: The Poisson equation for the **continuous-time generator** $\\mathcal{L}$ is:\n2391: \n2392: $$\n2393: \\mathcal{L} \\psi = -\\phi_c\n2394: $$\n2395: \n2396: Under geometric ergodicity of the continuous-time process (with spectral gap $\\kappa_{\\text{mix}}^{\\text{cont}} > 0$), this has a unique solution $\\psi$ with:\n2397: \n2398: $$\n2399: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi_c\\|_{C^4} = \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}\n2400: $$\n2401: \n2402: where $C_{\\text{poisson}}$ is a structural constant (see Hairer 2010, Theorem 4.1).\n2403: \n2404: **Important**: The mixing rate $\\kappa_{\\text{mix}}^{\\text{cont}}$ is a property of the **continuous-time generator** $\\mathcal{L}$, not the discrete chain.\n2405: \n2406: :::{note}\n2407: **Remark on potential regularity improvement**: For generators of Langevin-type SDEs with sufficient non-degeneracy (satisfying H\u00f6rmander's bracket condition), hypoelliptic regularity theory implies that solutions $\\psi$ to the Poisson equation $\\mathcal{L}\\psi = -\\phi_c$ possess higher regularity than $\\phi_c$ itself - typically gaining two derivatives from elliptic/hypoelliptic smoothing (H\u00f6rmander 1967).\n2408: \n2409: Establishing H\u00f6rmander's condition for the full Fragile Gas generator $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$ would require verifying that the Lie algebra generated by the drift and diffusion vector fields spans the tangent space at every point. For the Langevin component alone, this is standard (see Hairer & Mattingly 2006 for similar systems). However, the addition of the jump operator $\\mathcal{L}_{\\text{clone}}$ complicates the analysis.",
      "metadata": {},
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "2372: :::\n2373: \n2374: :::{prf:proof} Proof of {prf:ref}`thm-full-system-discretization-error`\n2375: \n2376: **Step 1: Centered observable and Poisson equation**\n2377: \n2378: To make the argument precise, define the centered observable:\n2379: \n2380: $$\n2381: \\phi_c := \\phi - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi]\n2382: $$\n2383: \n2384: Then $\\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi_c] = 0$ and the error is:\n2385: \n2386: $$\n2387: \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] = \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi_c]\n2388: $$\n2389: \n2390: The Poisson equation for the **continuous-time generator** $\\mathcal{L}$ is:\n2391: \n2392: $$\n2393: \\mathcal{L} \\psi = -\\phi_c\n2394: $$\n2395: \n2396: Under geometric ergodicity of the continuous-time process (with spectral gap $\\kappa_{\\text{mix}}^{\\text{cont}} > 0$), this has a unique solution $\\psi$ with:\n2397: \n2398: $$\n2399: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi_c\\|_{C^4} = \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}\n2400: $$\n2401: \n2402: where $C_{\\text{poisson}}$ is a structural constant (see Hairer 2010, Theorem 4.1).\n2403: \n2404: **Important**: The mixing rate $\\kappa_{\\text{mix}}^{\\text{cont}}$ is a property of the **continuous-time generator** $\\mathcal{L}$, not the discrete chain.\n2405: \n2406: :::{note}\n2407: **Remark on potential regularity improvement**: For generators of Langevin-type SDEs with sufficient non-degeneracy (satisfying H\u00f6rmander's bracket condition), hypoelliptic regularity theory implies that solutions $\\psi$ to the Poisson equation $\\mathcal{L}\\psi = -\\phi_c$ possess higher regularity than $\\phi_c$ itself - typically gaining two derivatives from elliptic/hypoelliptic smoothing (H\u00f6rmander 1967).\n2408: \n2409: Establishing H\u00f6rmander's condition for the full Fragile Gas generator $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$ would require verifying that the Lie algebra generated by the drift and diffusion vector fields spans the tangent space at every point. For the Langevin component alone, this is standard (see Hairer & Mattingly 2006 for similar systems). However, the addition of the jump operator $\\mathcal{L}_{\\text{clone}}$ complicates the analysis.\n2410: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}