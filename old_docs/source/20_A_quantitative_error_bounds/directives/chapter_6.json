{
  "chapter_index": 6,
  "section_id": "## Part IV: Total Error Bound",
  "directive_count": 7,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-total-error-bound",
      "title": "Total Error Bound for Discrete Fragile Gas",
      "start_line": 2512,
      "end_line": 2544,
      "header_lines": [
        2513
      ],
      "content_start": 2515,
      "content_end": 2543,
      "content": "2515: :label: thm-total-error-bound\n2516: \n2517: Let $\\nu_N^{\\text{discrete}}$ be the invariant measure of the fully discrete N-particle Fragile Gas with time step $\\Delta t$, and let $\\rho_0$ be the invariant measure of the continuous-time mean-field McKean-Vlasov equation.\n2518: \n2519: **Assumptions:**\n2520: 1. **N-uniform LSI** ({prf:ref}`thm-n-uniform-lsi`): The N-particle system satisfies a logarithmic Sobolev inequality with constant independent of $N$\n2521: 2. **Geometric ergodicity**: Both discrete and continuous N-particle chains mix geometrically with rates uniform in $N$ and $\\Delta t$ (for $\\Delta t < \\Delta t_0$)\n2522: 3. **Regularity**: Potential $U \\in C^4$, fitness function $F \\in C^4$, observable $\\phi \\in C^4$\n2523: 4. **Confinement**: Potential satisfies the Axiom of Confined Potential with rate $\\kappa_{\\text{conf}} > 0$\n2524: \n2525: Under these assumptions, for any single-particle observable $\\phi: \\mathcal{Z} \\to \\mathbb{R}$ with $\\|\\phi\\|_{C^4} < \\infty$, the empirical measure approximation error satisfies:\n2526: \n2527: $$\n2528: \\boxed{\n2529: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} \\left[ \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)}) \\right] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + \\frac{C_{\\text{discrete}}}{N} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2530: }\n2531: $$\n2532: \n2533: where:\n2534: - $C_{\\text{MF}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}$ is the mean-field error constant (from {prf:ref}`thm-quantitative-propagation-chaos`)\n2535: - $C_{\\text{discrete}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}$ is the time discretization constant (from {prf:ref}`thm-error-propagation`)\n2536: \n2537: **Constants depend on:**\n2538: - System parameters: $\\gamma$ (friction), $\\sigma$ (noise), $\\lambda$ (cloning rate), $\\delta$ (cloning noise), $\\beta$ (fitness weight)\n2539: - Potential: $\\|\\nabla^2 U\\|_\\infty$, $\\kappa_{\\text{conf}}$ (confinement rate)\n2540: - Fitness function: $\\|F\\|_{C^4}$, Lipschitz constants\n2541: - Mixing rate: $\\kappa_{\\text{mix}}^{\\text{cont}}$ (spectral gap of continuous generator)\n2542: \n2543: **Crucially**, both constants are **independent of $N$ and $\\Delta t$** (for $\\Delta t < \\Delta t_0$ sufficiently small).",
      "metadata": {
        "label": "thm-total-error-bound"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [
        "thm-n-uniform-lsi",
        "thm-quantitative-propagation-chaos",
        "thm-error-propagation"
      ],
      "raw_directive": "2512: ### Main Result\n2513: \n2514: :::{prf:theorem} Total Error Bound for Discrete Fragile Gas\n2515: :label: thm-total-error-bound\n2516: \n2517: Let $\\nu_N^{\\text{discrete}}$ be the invariant measure of the fully discrete N-particle Fragile Gas with time step $\\Delta t$, and let $\\rho_0$ be the invariant measure of the continuous-time mean-field McKean-Vlasov equation.\n2518: \n2519: **Assumptions:**\n2520: 1. **N-uniform LSI** ({prf:ref}`thm-n-uniform-lsi`): The N-particle system satisfies a logarithmic Sobolev inequality with constant independent of $N$\n2521: 2. **Geometric ergodicity**: Both discrete and continuous N-particle chains mix geometrically with rates uniform in $N$ and $\\Delta t$ (for $\\Delta t < \\Delta t_0$)\n2522: 3. **Regularity**: Potential $U \\in C^4$, fitness function $F \\in C^4$, observable $\\phi \\in C^4$\n2523: 4. **Confinement**: Potential satisfies the Axiom of Confined Potential with rate $\\kappa_{\\text{conf}} > 0$\n2524: \n2525: Under these assumptions, for any single-particle observable $\\phi: \\mathcal{Z} \\to \\mathbb{R}$ with $\\|\\phi\\|_{C^4} < \\infty$, the empirical measure approximation error satisfies:\n2526: \n2527: $$\n2528: \\boxed{\n2529: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} \\left[ \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)}) \\right] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + \\frac{C_{\\text{discrete}}}{N} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2530: }\n2531: $$\n2532: \n2533: where:\n2534: - $C_{\\text{MF}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}$ is the mean-field error constant (from {prf:ref}`thm-quantitative-propagation-chaos`)\n2535: - $C_{\\text{discrete}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}$ is the time discretization constant (from {prf:ref}`thm-error-propagation`)\n2536: \n2537: **Constants depend on:**\n2538: - System parameters: $\\gamma$ (friction), $\\sigma$ (noise), $\\lambda$ (cloning rate), $\\delta$ (cloning noise), $\\beta$ (fitness weight)\n2539: - Potential: $\\|\\nabla^2 U\\|_\\infty$, $\\kappa_{\\text{conf}}$ (confinement rate)\n2540: - Fitness function: $\\|F\\|_{C^4}$, Lipschitz constants\n2541: - Mixing rate: $\\kappa_{\\text{mix}}^{\\text{cont}}$ (spectral gap of continuous generator)\n2542: \n2543: **Crucially**, both constants are **independent of $N$ and $\\Delta t$** (for $\\Delta t < \\Delta t_0$ sufficiently small).\n2544: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-83",
      "title": null,
      "start_line": 2576,
      "end_line": 2722,
      "header_lines": [],
      "content_start": 2578,
      "content_end": 2721,
      "content": "2578: :::{prf:proof}\n2579: \n2580: **Step 1: Triangle inequality decomposition**\n2581: \n2582: For any observable $\\phi: \\mathcal{Z} \\to \\mathbb{R}$ (single-particle observable), define the empirical measure observable:\n2583: \n2584: $$\n2585: \\Phi(\\mathcal{S}) := \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)})\n2586: $$\n2587: \n2588: where $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ is the N-particle swarm state.\n2589: \n2590: The error can be decomposed as:\n2591: \n2592: $$\n2593: \\begin{align*}\n2594: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &= \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] + \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2595: &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right|\n2596: \\end{align*}\n2597: $$\n2598: \n2599: **Step 2: Bound the time discretization error**\n2600: \n2601: From Part III ({prf:ref}`thm-error-propagation`), the invariant measure error between discrete and continuous N-particle systems satisfies:\n2602: \n2603: $$\n2604: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Psi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Psi] \\right| \\leq C_{\\text{total}} \\|\\Psi\\|_{C^4} \\Delta t\n2605: $$\n2606: \n2607: where $C_{\\text{total}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}$.\n2608: \n2609: **Key observation:** We work with the **unnormalized** sum observable:\n2610: \n2611: $$\n2612: \\Psi(\\mathcal{S}) := \\sum_{i=1}^N \\phi(Z^{(i)})\n2613: $$\n2614: \n2615: For this observable, the $C^4$ norm relationship is:\n2616: \n2617: $$\n2618: \\|\\Psi\\|_{C^4(\\Omega^N)} = \\|\\phi\\|_{C^4(\\mathcal{Z})}\n2619: $$\n2620: \n2621: This holds because:\n2622: - Derivatives of $\\Psi$ with respect to particle $i$'s coordinates give derivatives of $\\phi(Z^{(i)})$ only\n2623: - Cross-derivatives with respect to different particles vanish (particles are independent coordinates)\n2624: - The supremum over all $i$ of $\\|\\partial_{Z^{(i)}}^\\alpha \\phi(Z^{(i)})\\|$ equals $\\|\\partial_Z^\\alpha \\phi(Z)\\|$ by symmetry\n2625: \n2626: **Substep 2.1:** Apply the error bound to the unnormalized observable $\\Psi$:\n2627: \n2628: $$\n2629: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Psi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Psi] \\right| \\leq C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t\n2630: $$\n2631: \n2632: **Substep 2.2:** Relate to the empirical observable $\\Phi = \\frac{1}{N}\\Psi$:\n2633: \n2634: By linearity of expectation:\n2635: \n2636: $$\n2637: \\mathbb{E}_{\\nu_N} [\\Phi] = \\mathbb{E}_{\\nu_N} \\left[ \\frac{1}{N}\\Psi \\right] = \\frac{1}{N} \\mathbb{E}_{\\nu_N} [\\Psi]\n2638: $$\n2639: \n2640: Therefore:\n2641: \n2642: $$\n2643: \\begin{align*}\n2644: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| &= \\frac{1}{N} \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Psi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Psi] \\right| \\\\\n2645: &\\leq \\frac{1}{N} \\cdot C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t \\\\\n2646: &= \\frac{C_{\\text{total}}}{N} \\|\\phi\\|_{C^4} \\Delta t\n2647: \\end{align*}\n2648: $$\n2649: \n2650: **Important**: The discretization error for the empirical observable has an additional factor of $\\frac{1}{N}$.\n2651: \n2652: **Step 3: Bound the mean-field error**\n2653: \n2654: From Part I ({prf:ref}`thm-quantitative-propagation-chaos`), for the continuous-time N-particle system, the empirical measure converges to the mean-field limit at rate $O(1/\\sqrt{N})$:\n2655: \n2656: $$\n2657: \\left| \\mathbb{E}_{\\bar{\\mu}_N} [\\phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{FG}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2658: $$\n2659: \n2660: where $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{Z^{(i)}}$ is the empirical measure.\n2661: \n2662: **Connection to N-particle expectations:** For the empirical observable $\\Phi(\\mathcal{S}) = \\frac{1}{N}\\sum_i \\phi(Z^{(i)})$:\n2663: \n2664: $$\n2665: \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] = \\mathbb{E}_{\\nu_N^{\\text{cont}}} \\left[ \\int \\phi(z) d\\bar{\\mu}_N(z) \\right] = \\mathbb{E}_{\\bar{\\mu}_N} [\\phi]\n2666: $$\n2667: \n2668: where the expectation is over realizations of the N-particle system drawn from $\\nu_N^{\\text{cont}}$.\n2669: \n2670: By {prf:ref}`thm-quantitative-propagation-chaos`:\n2671: \n2672: $$\n2673: \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2674: $$\n2675: \n2676: where $C_{\\text{MF}} = C_{\\text{FG}} \\sqrt{\\frac{2C_0}{\\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2}}$.\n2677: \n2678: **Step 4: Combine the bounds**\n2679: \n2680: Substituting the bounds from Steps 2 and 3 into the triangle inequality from Step 1:\n2681: \n2682: $$\n2683: \\begin{align*}\n2684: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2685: &\\leq \\frac{C_{\\text{total}}}{N} \\|\\phi\\|_{C^4} \\Delta t + \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4} \\\\\n2686: &= \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + \\frac{C_{\\text{total}}}{N} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2687: \\end{align*}\n2688: $$\n2689: \n2690: **Key observation**: The discretization term is $O(\\Delta t / N)$, which is **negligible** compared to the mean-field term $O(1/\\sqrt{N})$ for any reasonable choice of $N$ and $\\Delta t$.\n2691: \n2692: For example, with $N = 10^4$ and $\\Delta t = 0.01$:\n2693: - Mean-field error: $\\sim 1/\\sqrt{10^4} = 0.01$\n2694: - Discretization error: $\\sim 0.01/10^4 = 10^{-6}$\n2695: \n2696: Therefore, for large $N$, the **mean-field error dominates** and the time discretization contribution is negligible. This is a favorable outcome: **increasing $N$ reduces both error sources simultaneously**.\n2697: \n2698: However, for the theorem statement, we keep the full bound including both terms.\n2699: \n2700: **Step 5: Verify uniformity of constants**\n2701: \n2702: Both constants are independent of $N$ and $\\Delta t$:\n2703: \n2704: **Mean-field constant** $C_{\\text{MF}}$:\n2705: - Depends on: $\\gamma, \\sigma, \\lambda, \\delta, \\beta, \\kappa_{\\text{conf}}, \\kappa_W, C_0$\n2706: - Established in Part I using N-uniform LSI ({prf:ref}`thm-n-uniform-lsi`)\n2707: - Uniformity proven in [11_mean_field_convergence](11_mean_field_convergence/00_full.md)\n2708: \n2709: **Discretization constant** $C_{\\text{discrete}}$:\n2710: - Depends on: $C_{\\text{split}}$ (commutator bound), $C_{\\text{poisson}}$ (Poisson equation regularity), $\\kappa_{\\text{mix}}^{\\text{cont}}$ (spectral gap)\n2711: - $C_{\\text{split}}$ is N-independent by mean-field cancellation (Part III, Step 5j)\n2712: - $C_{\\text{poisson}}$ depends on generator regularity (system parameters only)\n2713: - $\\kappa_{\\text{mix}}^{\\text{cont}}$ is the continuous-time mixing rate (hypocoercivity, Part II)\n2714: - For $\\Delta t < \\Delta t_0$ sufficiently small, all constants remain bounded\n2715: \n2716: **Conclusion**: The total error bound is:\n2717: \n2718: $$\n2719: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{discrete}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2720: $$\n2721: ",
      "metadata": {},
      "section": "## Part IV: Total Error Bound",
      "references": [
        "thm-error-propagation",
        "thm-quantitative-propagation-chaos",
        "thm-n-uniform-lsi"
      ],
      "raw_directive": "2576: ---\n2577: \n2578: :::{prf:proof}\n2579: \n2580: **Step 1: Triangle inequality decomposition**\n2581: \n2582: For any observable $\\phi: \\mathcal{Z} \\to \\mathbb{R}$ (single-particle observable), define the empirical measure observable:\n2583: \n2584: $$\n2585: \\Phi(\\mathcal{S}) := \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)})\n2586: $$\n2587: \n2588: where $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ is the N-particle swarm state.\n2589: \n2590: The error can be decomposed as:\n2591: \n2592: $$\n2593: \\begin{align*}\n2594: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &= \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] + \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2595: &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right|\n2596: \\end{align*}\n2597: $$\n2598: \n2599: **Step 2: Bound the time discretization error**\n2600: \n2601: From Part III ({prf:ref}`thm-error-propagation`), the invariant measure error between discrete and continuous N-particle systems satisfies:\n2602: \n2603: $$\n2604: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Psi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Psi] \\right| \\leq C_{\\text{total}} \\|\\Psi\\|_{C^4} \\Delta t\n2605: $$\n2606: \n2607: where $C_{\\text{total}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}$.\n2608: \n2609: **Key observation:** We work with the **unnormalized** sum observable:\n2610: \n2611: $$\n2612: \\Psi(\\mathcal{S}) := \\sum_{i=1}^N \\phi(Z^{(i)})\n2613: $$\n2614: \n2615: For this observable, the $C^4$ norm relationship is:\n2616: \n2617: $$\n2618: \\|\\Psi\\|_{C^4(\\Omega^N)} = \\|\\phi\\|_{C^4(\\mathcal{Z})}\n2619: $$\n2620: \n2621: This holds because:\n2622: - Derivatives of $\\Psi$ with respect to particle $i$'s coordinates give derivatives of $\\phi(Z^{(i)})$ only\n2623: - Cross-derivatives with respect to different particles vanish (particles are independent coordinates)\n2624: - The supremum over all $i$ of $\\|\\partial_{Z^{(i)}}^\\alpha \\phi(Z^{(i)})\\|$ equals $\\|\\partial_Z^\\alpha \\phi(Z)\\|$ by symmetry\n2625: \n2626: **Substep 2.1:** Apply the error bound to the unnormalized observable $\\Psi$:\n2627: \n2628: $$\n2629: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Psi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Psi] \\right| \\leq C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t\n2630: $$\n2631: \n2632: **Substep 2.2:** Relate to the empirical observable $\\Phi = \\frac{1}{N}\\Psi$:\n2633: \n2634: By linearity of expectation:\n2635: \n2636: $$\n2637: \\mathbb{E}_{\\nu_N} [\\Phi] = \\mathbb{E}_{\\nu_N} \\left[ \\frac{1}{N}\\Psi \\right] = \\frac{1}{N} \\mathbb{E}_{\\nu_N} [\\Psi]\n2638: $$\n2639: \n2640: Therefore:\n2641: \n2642: $$\n2643: \\begin{align*}\n2644: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| &= \\frac{1}{N} \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Psi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Psi] \\right| \\\\\n2645: &\\leq \\frac{1}{N} \\cdot C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t \\\\\n2646: &= \\frac{C_{\\text{total}}}{N} \\|\\phi\\|_{C^4} \\Delta t\n2647: \\end{align*}\n2648: $$\n2649: \n2650: **Important**: The discretization error for the empirical observable has an additional factor of $\\frac{1}{N}$.\n2651: \n2652: **Step 3: Bound the mean-field error**\n2653: \n2654: From Part I ({prf:ref}`thm-quantitative-propagation-chaos`), for the continuous-time N-particle system, the empirical measure converges to the mean-field limit at rate $O(1/\\sqrt{N})$:\n2655: \n2656: $$\n2657: \\left| \\mathbb{E}_{\\bar{\\mu}_N} [\\phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{FG}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2658: $$\n2659: \n2660: where $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{Z^{(i)}}$ is the empirical measure.\n2661: \n2662: **Connection to N-particle expectations:** For the empirical observable $\\Phi(\\mathcal{S}) = \\frac{1}{N}\\sum_i \\phi(Z^{(i)})$:\n2663: \n2664: $$\n2665: \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] = \\mathbb{E}_{\\nu_N^{\\text{cont}}} \\left[ \\int \\phi(z) d\\bar{\\mu}_N(z) \\right] = \\mathbb{E}_{\\bar{\\mu}_N} [\\phi]\n2666: $$\n2667: \n2668: where the expectation is over realizations of the N-particle system drawn from $\\nu_N^{\\text{cont}}$.\n2669: \n2670: By {prf:ref}`thm-quantitative-propagation-chaos`:\n2671: \n2672: $$\n2673: \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2674: $$\n2675: \n2676: where $C_{\\text{MF}} = C_{\\text{FG}} \\sqrt{\\frac{2C_0}{\\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2}}$.\n2677: \n2678: **Step 4: Combine the bounds**\n2679: \n2680: Substituting the bounds from Steps 2 and 3 into the triangle inequality from Step 1:\n2681: \n2682: $$\n2683: \\begin{align*}\n2684: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2685: &\\leq \\frac{C_{\\text{total}}}{N} \\|\\phi\\|_{C^4} \\Delta t + \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4} \\\\\n2686: &= \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + \\frac{C_{\\text{total}}}{N} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2687: \\end{align*}\n2688: $$\n2689: \n2690: **Key observation**: The discretization term is $O(\\Delta t / N)$, which is **negligible** compared to the mean-field term $O(1/\\sqrt{N})$ for any reasonable choice of $N$ and $\\Delta t$.\n2691: \n2692: For example, with $N = 10^4$ and $\\Delta t = 0.01$:\n2693: - Mean-field error: $\\sim 1/\\sqrt{10^4} = 0.01$\n2694: - Discretization error: $\\sim 0.01/10^4 = 10^{-6}$\n2695: \n2696: Therefore, for large $N$, the **mean-field error dominates** and the time discretization contribution is negligible. This is a favorable outcome: **increasing $N$ reduces both error sources simultaneously**.\n2697: \n2698: However, for the theorem statement, we keep the full bound including both terms.\n2699: \n2700: **Step 5: Verify uniformity of constants**\n2701: \n2702: Both constants are independent of $N$ and $\\Delta t$:\n2703: \n2704: **Mean-field constant** $C_{\\text{MF}}$:\n2705: - Depends on: $\\gamma, \\sigma, \\lambda, \\delta, \\beta, \\kappa_{\\text{conf}}, \\kappa_W, C_0$\n2706: - Established in Part I using N-uniform LSI ({prf:ref}`thm-n-uniform-lsi`)\n2707: - Uniformity proven in [11_mean_field_convergence](11_mean_field_convergence/00_full.md)\n2708: \n2709: **Discretization constant** $C_{\\text{discrete}}$:\n2710: - Depends on: $C_{\\text{split}}$ (commutator bound), $C_{\\text{poisson}}$ (Poisson equation regularity), $\\kappa_{\\text{mix}}^{\\text{cont}}$ (spectral gap)\n2711: - $C_{\\text{split}}$ is N-independent by mean-field cancellation (Part III, Step 5j)\n2712: - $C_{\\text{poisson}}$ depends on generator regularity (system parameters only)\n2713: - $\\kappa_{\\text{mix}}^{\\text{cont}}$ is the continuous-time mixing rate (hypocoercivity, Part II)\n2714: - For $\\Delta t < \\Delta t_0$ sufficiently small, all constants remain bounded\n2715: \n2716: **Conclusion**: The total error bound is:\n2717: \n2718: $$\n2719: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{discrete}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2720: $$\n2721: \n2722: with constants uniform in $N$ and $\\Delta t$ (for $\\Delta t < \\Delta t_0$)."
    },
    {
      "directive_type": "remark",
      "label": "rem-rate-interpretation",
      "title": "Rate Interpretation",
      "start_line": 2728,
      "end_line": 2760,
      "header_lines": [
        2729
      ],
      "content_start": 2731,
      "content_end": 2759,
      "content": "2731: :label: rem-rate-interpretation\n2732: \n2733: The total error bound reveals two competing sources:\n2734: \n2735: 1. **Statistical error** ($O(1/\\sqrt{N})$): From finite-sample approximation of the mean-field limit\n2736:    - Dominant for small $N$ (e.g., $N = 100 \\Rightarrow$ error $\\approx 0.1 C_{\\text{MF}}$)\n2737:    - Reduced by increasing swarm size\n2738:    - Intrinsic to particle approximations (cannot be eliminated)\n2739: \n2740: 2. **Discretization error** ($O(\\Delta t)$): From operator splitting and time discretization\n2741:    - Dominant for coarse time steps\n2742:    - Reduced by decreasing $\\Delta t$\n2743:    - First-order due to non-commutativity $[\\mathcal{L}_{\\text{Langevin}}, \\mathcal{L}_{\\text{clone}}] \\neq 0$\n2744: \n2745: **Balanced regime**: To achieve overall error $\\varepsilon$, balance the two terms:\n2746: \n2747: $$\n2748: \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\approx C_{\\text{discrete}} \\Delta t \\approx \\frac{\\varepsilon}{2}\n2749: $$\n2750: \n2751: This gives the scaling relationship:\n2752: \n2753: $$\n2754: \\Delta t \\sim \\frac{1}{\\sqrt{N}}\n2755: $$\n2756: \n2757: **Example**: For $\\varepsilon = 0.01$ and $C_{\\text{MF}} \\approx C_{\\text{discrete}} \\approx 1$:\n2758: - Choose $N = 10^4$ walkers $\\Rightarrow$ statistical error $\\approx 0.01$\n2759: - Choose $\\Delta t = 0.01$ $\\Rightarrow$ discretization error $\\approx 0.01$",
      "metadata": {
        "label": "rem-rate-interpretation"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [],
      "raw_directive": "2728: ### Interpretation and Practical Implications\n2729: \n2730: :::{prf:remark} Rate Interpretation\n2731: :label: rem-rate-interpretation\n2732: \n2733: The total error bound reveals two competing sources:\n2734: \n2735: 1. **Statistical error** ($O(1/\\sqrt{N})$): From finite-sample approximation of the mean-field limit\n2736:    - Dominant for small $N$ (e.g., $N = 100 \\Rightarrow$ error $\\approx 0.1 C_{\\text{MF}}$)\n2737:    - Reduced by increasing swarm size\n2738:    - Intrinsic to particle approximations (cannot be eliminated)\n2739: \n2740: 2. **Discretization error** ($O(\\Delta t)$): From operator splitting and time discretization\n2741:    - Dominant for coarse time steps\n2742:    - Reduced by decreasing $\\Delta t$\n2743:    - First-order due to non-commutativity $[\\mathcal{L}_{\\text{Langevin}}, \\mathcal{L}_{\\text{clone}}] \\neq 0$\n2744: \n2745: **Balanced regime**: To achieve overall error $\\varepsilon$, balance the two terms:\n2746: \n2747: $$\n2748: \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\approx C_{\\text{discrete}} \\Delta t \\approx \\frac{\\varepsilon}{2}\n2749: $$\n2750: \n2751: This gives the scaling relationship:\n2752: \n2753: $$\n2754: \\Delta t \\sim \\frac{1}{\\sqrt{N}}\n2755: $$\n2756: \n2757: **Example**: For $\\varepsilon = 0.01$ and $C_{\\text{MF}} \\approx C_{\\text{discrete}} \\approx 1$:\n2758: - Choose $N = 10^4$ walkers $\\Rightarrow$ statistical error $\\approx 0.01$\n2759: - Choose $\\Delta t = 0.01$ $\\Rightarrow$ discretization error $\\approx 0.01$\n2760: - Total error $\\approx 0.02$ (factor of 2 from triangle inequality)"
    },
    {
      "directive_type": "remark",
      "label": "rem-higher-order-splitting",
      "title": "Higher-Order Splitting Methods",
      "start_line": 2762,
      "end_line": 2798,
      "header_lines": [
        2763
      ],
      "content_start": 2765,
      "content_end": 2797,
      "content": "2765: :label: rem-higher-order-splitting\n2766: \n2767: The discretization term $O(\\Delta t / N)$ is already negligible for large $N$, but can we further reduce it using higher-order splitting?\n2768: \n2769: **General principle:** For ergodic systems with a unique invariant measure, the relationship between local and global errors is:\n2770: - A symmetric integrator with local weak error $O((\\Delta t)^{p+1})$ for even $p$\n2771: - Produces an invariant measure error of $O((\\Delta t)^p)$\n2772: \n2773: This is proven via the Poisson equation argument in Part III ({prf:ref}`thm-error-propagation`): roughly, one derivative is lost when integrating local errors over infinite time.\n2774: \n2775: **Strang splitting** (second-order symmetric):\n2776: \n2777: $$\n2778: \\mathcal{T}^{\\Delta t}_{\\text{Strang}} = \\mathcal{T}_{\\text{Langevin}}^{\\Delta t/2} \\circ \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{Langevin}}^{\\Delta t/2}\n2779: $$\n2780: \n2781: This is symmetric and achieves:\n2782: - **Local weak error**: $O((\\Delta t)^3)$ (second-order method with $p=2$)\n2783: - **Global invariant measure error**: $O((\\Delta t)^2)$ (applying the general principle)\n2784: \n2785: Therefore, Strang splitting improves the discretization term to:\n2786: \n2787: $$\n2788: \\frac{C_{\\text{discrete}}^{(2)}}{N} (\\Delta t)^2\n2789: $$\n2790: \n2791: where $C_{\\text{discrete}}^{(2)}$ is typically larger than $C_{\\text{discrete}}$ due to higher-order commutator contributions, but the $(\\Delta t)^2$ dependence makes it negligible for any reasonable time step.\n2792: \n2793: **Practical assessment:**\n2794: - For $N = 10^4$ and $\\Delta t = 0.01$: First-order gives $\\sim 10^{-6}$, second-order gives $\\sim 10^{-8}$\n2795: - **Both are negligible** compared to the mean-field error $\\sim 10^{-2}$\n2796: - **Recommendation**: Use simple Lie splitting; the added complexity of Strang splitting provides no practical benefit when the discretization error is already dominated by the $O(1/\\sqrt{N})$ mean-field term\n2797: ",
      "metadata": {
        "label": "rem-higher-order-splitting"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [
        "thm-error-propagation"
      ],
      "raw_directive": "2762: :::\n2763: \n2764: :::{prf:remark} Higher-Order Splitting Methods\n2765: :label: rem-higher-order-splitting\n2766: \n2767: The discretization term $O(\\Delta t / N)$ is already negligible for large $N$, but can we further reduce it using higher-order splitting?\n2768: \n2769: **General principle:** For ergodic systems with a unique invariant measure, the relationship between local and global errors is:\n2770: - A symmetric integrator with local weak error $O((\\Delta t)^{p+1})$ for even $p$\n2771: - Produces an invariant measure error of $O((\\Delta t)^p)$\n2772: \n2773: This is proven via the Poisson equation argument in Part III ({prf:ref}`thm-error-propagation`): roughly, one derivative is lost when integrating local errors over infinite time.\n2774: \n2775: **Strang splitting** (second-order symmetric):\n2776: \n2777: $$\n2778: \\mathcal{T}^{\\Delta t}_{\\text{Strang}} = \\mathcal{T}_{\\text{Langevin}}^{\\Delta t/2} \\circ \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{Langevin}}^{\\Delta t/2}\n2779: $$\n2780: \n2781: This is symmetric and achieves:\n2782: - **Local weak error**: $O((\\Delta t)^3)$ (second-order method with $p=2$)\n2783: - **Global invariant measure error**: $O((\\Delta t)^2)$ (applying the general principle)\n2784: \n2785: Therefore, Strang splitting improves the discretization term to:\n2786: \n2787: $$\n2788: \\frac{C_{\\text{discrete}}^{(2)}}{N} (\\Delta t)^2\n2789: $$\n2790: \n2791: where $C_{\\text{discrete}}^{(2)}$ is typically larger than $C_{\\text{discrete}}$ due to higher-order commutator contributions, but the $(\\Delta t)^2$ dependence makes it negligible for any reasonable time step.\n2792: \n2793: **Practical assessment:**\n2794: - For $N = 10^4$ and $\\Delta t = 0.01$: First-order gives $\\sim 10^{-6}$, second-order gives $\\sim 10^{-8}$\n2795: - **Both are negligible** compared to the mean-field error $\\sim 10^{-2}$\n2796: - **Recommendation**: Use simple Lie splitting; the added complexity of Strang splitting provides no practical benefit when the discretization error is already dominated by the $O(1/\\sqrt{N})$ mean-field term\n2797: \n2798: **Cost**: Strang splitting requires splitting the BAOAB step and increases computational overhead by ~50%."
    },
    {
      "directive_type": "remark",
      "label": "rem-optimality-mean-field-rate",
      "title": "Optimality of the Mean-Field Rate",
      "start_line": 2800,
      "end_line": 2817,
      "header_lines": [
        2801
      ],
      "content_start": 2803,
      "content_end": 2816,
      "content": "2803: :label: rem-optimality-mean-field-rate\n2804: \n2805: The $O(1/\\sqrt{N})$ rate is **optimal** for empirical measure convergence in mean-field particle systems.\n2806: \n2807: **Why?** This is the rate of the **Central Limit Theorem**:\n2808: \n2809: $$\n2810: \\sqrt{N} (\\bar{\\mu}_N - \\rho_0) \\xrightarrow{d} \\mathcal{N}(0, \\Sigma)\n2811: $$\n2812: \n2813: where $\\Sigma$ is the covariance operator of the limiting Gaussian process.\n2814: \n2815: **Implication**: No particle method can achieve better than $O(1/\\sqrt{N})$ convergence without additional structure (e.g., multilevel methods, variance reduction).\n2816: ",
      "metadata": {
        "label": "rem-optimality-mean-field-rate"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [],
      "raw_directive": "2800: :::\n2801: \n2802: :::{prf:remark} Optimality of the Mean-Field Rate\n2803: :label: rem-optimality-mean-field-rate\n2804: \n2805: The $O(1/\\sqrt{N})$ rate is **optimal** for empirical measure convergence in mean-field particle systems.\n2806: \n2807: **Why?** This is the rate of the **Central Limit Theorem**:\n2808: \n2809: $$\n2810: \\sqrt{N} (\\bar{\\mu}_N - \\rho_0) \\xrightarrow{d} \\mathcal{N}(0, \\Sigma)\n2811: $$\n2812: \n2813: where $\\Sigma$ is the covariance operator of the limiting Gaussian process.\n2814: \n2815: **Implication**: No particle method can achieve better than $O(1/\\sqrt{N})$ convergence without additional structure (e.g., multilevel methods, variance reduction).\n2816: \n2817: **Reference**: Sznitman (1991), \"Topics in propagation of chaos\" - Section 6 on optimal rates."
    },
    {
      "directive_type": "proposition",
      "label": "prop-explicit-constants",
      "title": "Explicit Constant Formulas",
      "start_line": 2825,
      "end_line": 2868,
      "header_lines": [
        2826
      ],
      "content_start": 2828,
      "content_end": 2867,
      "content": "2828: :label: prop-explicit-constants\n2829: \n2830: Under the framework axioms, the error constants admit the following explicit bounds:\n2831: \n2832: **1. Mean-field constant:**\n2833: \n2834: $$\n2835: C_{\\text{MF}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2836: $$\n2837: \n2838: where:\n2839: - $C_{\\text{var}}$ is the variance constant from the Fournier-Guillin bound for empirical measure fluctuations\n2840:   - Depends on metric properties and observable regularity\n2841: - $C_{\\text{int}}$ is the interaction complexity constant from {prf:ref}`lem-quantitative-kl-bound`\n2842:   - Quantifies the strength of particle interactions through the diversity companion probability\n2843:   - Explicit form: $C_{\\text{int}} = \\lambda L_{\\log \\rho_0} \\cdot \\text{diam}(\\Omega)$\n2844:   - Depends on system parameters: $\\gamma, \\sigma, \\lambda, \\delta, \\beta, \\kappa_{\\text{conf}}$\n2845: - $C'$ is a universal constant from the propagation of chaos proof\n2846: \n2847: **2. Discretization constant:**\n2848: \n2849: $$\n2850: C_{\\text{discrete}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}\n2851: $$\n2852: \n2853: where:\n2854: - $C_{\\text{split}} = \\frac{1}{2} \\lambda \\beta C_{\\text{chaos}} \\max(C_F, \\sigma^2, \\|\\nabla^2 U\\|_\\infty)$ (commutator bound)\n2855: - $C_{\\text{chaos}}$: propagation of chaos constant (Sznitman, typically $O(1)$)\n2856: - $C_{\\text{poisson}}$: Poisson equation regularity constant (depends on $\\gamma, \\sigma, \\|\\nabla^3 U\\|_\\infty$)\n2857: - $\\kappa_{\\text{mix}}^{\\text{cont}} = \\min(\\kappa_{\\text{hypo}}, \\lambda)$ (smaller of hypocoercivity gap and cloning rate)\n2858: \n2859: **Typical parameter values** (for optimization tasks):\n2860: - Friction: $\\gamma = 0.1$ to $1.0$\n2861: - Noise scale: $\\sigma = 0.1$ to $1.0$\n2862: - Cloning rate: $\\lambda = 0.01$ to $0.1$\n2863: - Cloning noise: $\\delta = 0.1$ to $0.3$\n2864: - Fitness weight: $\\beta = 1$ to $10$\n2865: \n2866: **Order-of-magnitude estimates:**\n2867: - $C_{\\text{MF}} \\sim O(10)$ for typical problems",
      "metadata": {
        "label": "prop-explicit-constants"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [
        "lem-quantitative-kl-bound"
      ],
      "raw_directive": "2825: For practical implementation, we provide explicit formulas for the constants in terms of system parameters.\n2826: \n2827: :::{prf:proposition} Explicit Constant Formulas\n2828: :label: prop-explicit-constants\n2829: \n2830: Under the framework axioms, the error constants admit the following explicit bounds:\n2831: \n2832: **1. Mean-field constant:**\n2833: \n2834: $$\n2835: C_{\\text{MF}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2836: $$\n2837: \n2838: where:\n2839: - $C_{\\text{var}}$ is the variance constant from the Fournier-Guillin bound for empirical measure fluctuations\n2840:   - Depends on metric properties and observable regularity\n2841: - $C_{\\text{int}}$ is the interaction complexity constant from {prf:ref}`lem-quantitative-kl-bound`\n2842:   - Quantifies the strength of particle interactions through the diversity companion probability\n2843:   - Explicit form: $C_{\\text{int}} = \\lambda L_{\\log \\rho_0} \\cdot \\text{diam}(\\Omega)$\n2844:   - Depends on system parameters: $\\gamma, \\sigma, \\lambda, \\delta, \\beta, \\kappa_{\\text{conf}}$\n2845: - $C'$ is a universal constant from the propagation of chaos proof\n2846: \n2847: **2. Discretization constant:**\n2848: \n2849: $$\n2850: C_{\\text{discrete}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}\n2851: $$\n2852: \n2853: where:\n2854: - $C_{\\text{split}} = \\frac{1}{2} \\lambda \\beta C_{\\text{chaos}} \\max(C_F, \\sigma^2, \\|\\nabla^2 U\\|_\\infty)$ (commutator bound)\n2855: - $C_{\\text{chaos}}$: propagation of chaos constant (Sznitman, typically $O(1)$)\n2856: - $C_{\\text{poisson}}$: Poisson equation regularity constant (depends on $\\gamma, \\sigma, \\|\\nabla^3 U\\|_\\infty$)\n2857: - $\\kappa_{\\text{mix}}^{\\text{cont}} = \\min(\\kappa_{\\text{hypo}}, \\lambda)$ (smaller of hypocoercivity gap and cloning rate)\n2858: \n2859: **Typical parameter values** (for optimization tasks):\n2860: - Friction: $\\gamma = 0.1$ to $1.0$\n2861: - Noise scale: $\\sigma = 0.1$ to $1.0$\n2862: - Cloning rate: $\\lambda = 0.01$ to $0.1$\n2863: - Cloning noise: $\\delta = 0.1$ to $0.3$\n2864: - Fitness weight: $\\beta = 1$ to $10$\n2865: \n2866: **Order-of-magnitude estimates:**\n2867: - $C_{\\text{MF}} \\sim O(10)$ for typical problems\n2868: - $C_{\\text{discrete}} \\sim O(1)$ to $O(10)$ depending on mixing rate"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-377",
      "title": null,
      "start_line": 2870,
      "end_line": 2915,
      "header_lines": [],
      "content_start": 2872,
      "content_end": 2914,
      "content": "2872: :::{prf:proof}\n2873: \n2874: These formulas are derived by tracing through the constants in Parts I, II, and III:\n2875: \n2876: **Mean-field constant derivation:**\n2877: \n2878: From {prf:ref}`thm-quantitative-propagation-chaos` (Part I), the mean-field error for Lipschitz observables is:\n2879: \n2880: $$\n2881: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\mathbb{E}_{\\rho_0}[\\phi] \\right| \\leq \\frac{C_{\\text{obs}} \\cdot L_\\phi}{\\sqrt{N}}\n2882: $$\n2883: \n2884: where the constant is given by:\n2885: \n2886: $$\n2887: C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2888: $$\n2889: \n2890: Here:\n2891: - $C_{\\text{var}}$ accounts for the variance of empirical fluctuations (from Fournier-Guillin)\n2892: - $C_{\\text{int}}$ is the interaction complexity constant from {prf:ref}`lem-quantitative-kl-bound`\n2893: - $C'$ is a universal constant from the proof\n2894: \n2895: For $C^4$ observables (needed for Part III Poisson equation regularity), we can bound $L_\\phi \\leq \\|\\phi\\|_{C^4}$. Therefore:\n2896: \n2897: $$\n2898: C_{\\text{MF}} = C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2899: $$\n2900: \n2901: **Note on C^4 norm dependency:** The dependence on $\\|\\phi\\|_{C^4}$ (rather than just Lipschitz constant $L_\\phi$) arises from the regularity required for the solution $\\psi$ of the Poisson equation used in Part III to relate the invariant measure error to the local weak error of the discrete scheme. The Kantorovich-Rubinstein duality relates $W_1$ distance to error for 1-Lipschitz observables (i.e., $C^1$ functions), but the higher $C^4$ regularity is needed to bound the error propagation through the Markov chain dynamics.\n2902: \n2903: **Discretization constant derivation:**\n2904: \n2905: From {prf:ref}`thm-error-propagation`, Step 4:\n2906: \n2907: $$\n2908: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] \\right| \\leq \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4} \\Delta t\n2909: $$\n2910: \n2911: The numerator combines:\n2912: - **Splitting error**: From {prf:ref}`lem-lie-splitting-weak-error`, Step 6, the commutator bound gives $C_{\\text{split}} = \\frac{1}{2} C_{\\text{comm}}$ where $C_{\\text{comm}}$ is N-uniform by propagation of chaos\n2913: - **Poisson regularity**: From Step 1 of {prf:ref}`thm-error-propagation`, $\\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}$\n2914: ",
      "metadata": {},
      "section": "## Part IV: Total Error Bound",
      "references": [
        "thm-quantitative-propagation-chaos",
        "lem-quantitative-kl-bound",
        "thm-error-propagation",
        "lem-lie-splitting-weak-error"
      ],
      "raw_directive": "2870: :::\n2871: \n2872: :::{prf:proof}\n2873: \n2874: These formulas are derived by tracing through the constants in Parts I, II, and III:\n2875: \n2876: **Mean-field constant derivation:**\n2877: \n2878: From {prf:ref}`thm-quantitative-propagation-chaos` (Part I), the mean-field error for Lipschitz observables is:\n2879: \n2880: $$\n2881: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\mathbb{E}_{\\rho_0}[\\phi] \\right| \\leq \\frac{C_{\\text{obs}} \\cdot L_\\phi}{\\sqrt{N}}\n2882: $$\n2883: \n2884: where the constant is given by:\n2885: \n2886: $$\n2887: C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2888: $$\n2889: \n2890: Here:\n2891: - $C_{\\text{var}}$ accounts for the variance of empirical fluctuations (from Fournier-Guillin)\n2892: - $C_{\\text{int}}$ is the interaction complexity constant from {prf:ref}`lem-quantitative-kl-bound`\n2893: - $C'$ is a universal constant from the proof\n2894: \n2895: For $C^4$ observables (needed for Part III Poisson equation regularity), we can bound $L_\\phi \\leq \\|\\phi\\|_{C^4}$. Therefore:\n2896: \n2897: $$\n2898: C_{\\text{MF}} = C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2899: $$\n2900: \n2901: **Note on C^4 norm dependency:** The dependence on $\\|\\phi\\|_{C^4}$ (rather than just Lipschitz constant $L_\\phi$) arises from the regularity required for the solution $\\psi$ of the Poisson equation used in Part III to relate the invariant measure error to the local weak error of the discrete scheme. The Kantorovich-Rubinstein duality relates $W_1$ distance to error for 1-Lipschitz observables (i.e., $C^1$ functions), but the higher $C^4$ regularity is needed to bound the error propagation through the Markov chain dynamics.\n2902: \n2903: **Discretization constant derivation:**\n2904: \n2905: From {prf:ref}`thm-error-propagation`, Step 4:\n2906: \n2907: $$\n2908: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] \\right| \\leq \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4} \\Delta t\n2909: $$\n2910: \n2911: The numerator combines:\n2912: - **Splitting error**: From {prf:ref}`lem-lie-splitting-weak-error`, Step 6, the commutator bound gives $C_{\\text{split}} = \\frac{1}{2} C_{\\text{comm}}$ where $C_{\\text{comm}}$ is N-uniform by propagation of chaos\n2913: - **Poisson regularity**: From Step 1 of {prf:ref}`thm-error-propagation`, $\\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}$\n2914: \n2915: The denominator is the continuous-time mixing rate, which is the spectral gap of the generator $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$."
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}