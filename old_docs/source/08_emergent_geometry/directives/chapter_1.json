{
  "chapter_index": 1,
  "section_id": "## 1. The Emergent Geometry Framework",
  "directive_count": 11,
  "hints": [
    {
      "directive_type": "definition",
      "label": "def-d-adaptive-diffusion",
      "title": "Adaptive Diffusion Tensor (from `07_adaptative_gas.md`)",
      "start_line": 141,
      "end_line": 161,
      "header_lines": [
        142
      ],
      "content_start": 144,
      "content_end": 160,
      "content": "144: :label: def-d-adaptive-diffusion\n145: \n146: For a swarm state $S = \\{(x_i, v_i, s_i)\\}_{i=1}^N$, the **adaptive diffusion tensor** for walker $i$ is:\n147: \n148: $$\n149: \\Sigma_{\\text{reg}}(x_i, S) = \\left( H_i(S) + \\epsilon_\\Sigma I \\right)^{-1/2}\n150: $$\n151: \n152: where:\n153: - $H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ is the Hessian of the fitness potential with respect to walker $i$'s position\n154: - $\\epsilon_\\Sigma > 0$ is the **regularization parameter**\n155: - The matrix square root is the unique symmetric positive definite square root\n156: \n157: The induced **diffusion matrix** (covariance of the noise) is:\n158: \n159: $$\n160: D_{\\text{reg}}(x_i, S) = \\Sigma_{\\text{reg}}(x_i, S) \\Sigma_{\\text{reg}}(x_i, S)^T = \\left( H_i(S) + \\epsilon_\\Sigma I \\right)^{-1}",
      "metadata": {
        "label": "def-d-adaptive-diffusion"
      },
      "section": "## 1. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "141: The Adaptive Gas introduces geometry through its noise structure.\n142: \n143: :::{prf:definition} Adaptive Diffusion Tensor (from `07_adaptative_gas.md`)\n144: :label: def-d-adaptive-diffusion\n145: \n146: For a swarm state $S = \\{(x_i, v_i, s_i)\\}_{i=1}^N$, the **adaptive diffusion tensor** for walker $i$ is:\n147: \n148: $$\n149: \\Sigma_{\\text{reg}}(x_i, S) = \\left( H_i(S) + \\epsilon_\\Sigma I \\right)^{-1/2}\n150: $$\n151: \n152: where:\n153: - $H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ is the Hessian of the fitness potential with respect to walker $i$'s position\n154: - $\\epsilon_\\Sigma > 0$ is the **regularization parameter**\n155: - The matrix square root is the unique symmetric positive definite square root\n156: \n157: The induced **diffusion matrix** (covariance of the noise) is:\n158: \n159: $$\n160: D_{\\text{reg}}(x_i, S) = \\Sigma_{\\text{reg}}(x_i, S) \\Sigma_{\\text{reg}}(x_i, S)^T = \\left( H_i(S) + \\epsilon_\\Sigma I \\right)^{-1}\n161: $$"
    },
    {
      "directive_type": "remark",
      "label": "unlabeled-remark-27",
      "title": "Why This is a Riemannian Metric",
      "start_line": 163,
      "end_line": 173,
      "header_lines": [
        164
      ],
      "content_start": 166,
      "content_end": 172,
      "content": "166: :class: note\n167: \n168: The regularized Hessian $g(x_i, S) = H_i(S) + \\epsilon_\\Sigma I$ defines a Riemannian metric on the state space. In differential geometry, this is precisely the metric induced by a potential function (the fitness). In information geometry, this is analogous to the **Fisher information metric**.\n169: \n170: **Geometric interpretation** (using the standard convention $D = g^{-1}$):\n171: - **Flat directions** (small Hessian eigenvalues): Small metric eigenvalues \u2192 **large diffusion** \u2192 more exploration\n172: - **Curved directions** (large Hessian eigenvalues): Large metric eigenvalues \u2192 **small diffusion** \u2192 more exploitation",
      "metadata": {
        "class": "note"
      },
      "section": "## 1. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "163: :::\n164: \n165: :::{prf:remark} Why This is a Riemannian Metric\n166: :class: note\n167: \n168: The regularized Hessian $g(x_i, S) = H_i(S) + \\epsilon_\\Sigma I$ defines a Riemannian metric on the state space. In differential geometry, this is precisely the metric induced by a potential function (the fitness). In information geometry, this is analogous to the **Fisher information metric**.\n169: \n170: **Geometric interpretation** (using the standard convention $D = g^{-1}$):\n171: - **Flat directions** (small Hessian eigenvalues): Small metric eigenvalues \u2192 **large diffusion** \u2192 more exploration\n172: - **Curved directions** (large Hessian eigenvalues): Large metric eigenvalues \u2192 **small diffusion** \u2192 more exploitation\n173: "
    },
    {
      "directive_type": "assumption",
      "label": "assump-spectral-floor",
      "title": "Spectral Floor (Standing Assumption)",
      "start_line": 179,
      "end_line": 189,
      "header_lines": [
        180
      ],
      "content_start": 182,
      "content_end": 188,
      "content": "182: :label: assump-spectral-floor\n183: \n184: There exists $\\Lambda_- \\ge 0$ such that for all swarm states $S$ and walkers $i$:\n185: \n186: $$\n187: \\lambda_{\\min}(H(x_i, S)) \\ge -\\Lambda_-\n188: $$",
      "metadata": {
        "label": "assump-spectral-floor"
      },
      "section": "## 1. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "179: The regularization $\\epsilon_\\Sigma I$ ensures the diffusion is well-behaved.\n180: \n181: :::{prf:assumption} Spectral Floor (Standing Assumption)\n182: :label: assump-spectral-floor\n183: \n184: There exists $\\Lambda_- \\ge 0$ such that for all swarm states $S$ and walkers $i$:\n185: \n186: $$\n187: \\lambda_{\\min}(H(x_i, S)) \\ge -\\Lambda_-\n188: $$\n189: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-uniform-ellipticity",
      "title": "Uniform Ellipticity by Construction (from `07_adaptative_gas.md`)",
      "start_line": 191,
      "end_line": 229,
      "header_lines": [
        192
      ],
      "content_start": 194,
      "content_end": 228,
      "content": "194: :label: thm-uniform-ellipticity\n195: \n196: For all swarm states $S$ and all walkers $i$, the diffusion matrix satisfies:\n197: \n198: $$\n199: c_{\\min} I \\preceq D_{\\text{reg}}(x_i, S) \\preceq c_{\\max} I\n200: $$\n201: \n202: where:\n203: \n204: $$\n205: c_{\\min} = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad c_{\\max} = \\frac{1}{\\epsilon_\\Sigma - \\Lambda_-}\n206: $$\n207: \n208: and $\\lambda_{\\max}(H)$ is the maximum eigenvalue of the unregularized Hessian over the compact state space $\\mathcal{X}_{\\text{valid}}$.\n209: \n210: **Simplified form when $H \\succeq 0$ (positive semi-definite)**:\n211: \n212: When the Hessian is guaranteed to be positive semi-definite (i.e., $\\Lambda_- = 0$), the bounds simplify to:\n213: \n214: $$\n215: c_{\\min} = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad c_{\\max} = \\frac{1}{\\epsilon_\\Sigma}\n216: $$\n217: \n218: **Equivalently (in terms of diffusion tensor $\\Sigma_{\\text{reg}}$)**:\n219: \n220: $$\n221: \\frac{1}{\\sqrt{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}} I \\preceq \\Sigma_{\\text{reg}}(x_i, S) \\preceq \\frac{1}{\\sqrt{\\epsilon_\\Sigma - \\Lambda_-}} I\n222: $$\n223: \n224: **Proof**: If $A = H + \\epsilon_\\Sigma I$ is SPD, the eigenvalues of $D = A^{-1}$ are $\\{1/(\\lambda_i(H) + \\epsilon_\\Sigma)\\}$. Therefore:\n225: \n226: $$\n227: \\lambda_{\\min}(D) = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad \\lambda_{\\max}(D) = \\frac{1}{\\lambda_{\\min}(H) + \\epsilon_\\Sigma} \\le \\frac{1}{\\epsilon_\\Sigma - \\Lambda_-}\n228: $$",
      "metadata": {
        "label": "thm-uniform-ellipticity"
      },
      "section": "## 1. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "191: :::\n192: \n193: :::{prf:theorem} Uniform Ellipticity by Construction (from `07_adaptative_gas.md`)\n194: :label: thm-uniform-ellipticity\n195: \n196: For all swarm states $S$ and all walkers $i$, the diffusion matrix satisfies:\n197: \n198: $$\n199: c_{\\min} I \\preceq D_{\\text{reg}}(x_i, S) \\preceq c_{\\max} I\n200: $$\n201: \n202: where:\n203: \n204: $$\n205: c_{\\min} = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad c_{\\max} = \\frac{1}{\\epsilon_\\Sigma - \\Lambda_-}\n206: $$\n207: \n208: and $\\lambda_{\\max}(H)$ is the maximum eigenvalue of the unregularized Hessian over the compact state space $\\mathcal{X}_{\\text{valid}}$.\n209: \n210: **Simplified form when $H \\succeq 0$ (positive semi-definite)**:\n211: \n212: When the Hessian is guaranteed to be positive semi-definite (i.e., $\\Lambda_- = 0$), the bounds simplify to:\n213: \n214: $$\n215: c_{\\min} = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad c_{\\max} = \\frac{1}{\\epsilon_\\Sigma}\n216: $$\n217: \n218: **Equivalently (in terms of diffusion tensor $\\Sigma_{\\text{reg}}$)**:\n219: \n220: $$\n221: \\frac{1}{\\sqrt{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}} I \\preceq \\Sigma_{\\text{reg}}(x_i, S) \\preceq \\frac{1}{\\sqrt{\\epsilon_\\Sigma - \\Lambda_-}} I\n222: $$\n223: \n224: **Proof**: If $A = H + \\epsilon_\\Sigma I$ is SPD, the eigenvalues of $D = A^{-1}$ are $\\{1/(\\lambda_i(H) + \\epsilon_\\Sigma)\\}$. Therefore:\n225: \n226: $$\n227: \\lambda_{\\min}(D) = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad \\lambda_{\\max}(D) = \\frac{1}{\\lambda_{\\min}(H) + \\epsilon_\\Sigma} \\le \\frac{1}{\\epsilon_\\Sigma - \\Lambda_-}\n228: $$\n229: "
    },
    {
      "directive_type": "proposition",
      "label": "prop-lipschitz-diffusion",
      "title": "Lipschitz Continuity of Adaptive Diffusion",
      "start_line": 249,
      "end_line": 262,
      "header_lines": [
        250
      ],
      "content_start": 252,
      "content_end": 261,
      "content": "252: :label: prop-lipschitz-diffusion\n253: \n254: The adaptive diffusion tensor is Lipschitz continuous:\n255: \n256: $$\n257: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F \\le L_\\Sigma \\cdot d_{\\text{state}}((x_1, S_1), (x_2, S_2))\n258: $$\n259: \n260: where $\\|\\cdot\\|_F$ is the Frobenius norm, $d_{\\text{state}}$ is an appropriate state-space metric, and $L_\\Sigma$ depends on:\n261: - The Lipschitz constant of the fitness Hessian $\\nabla^2 V_{\\text{fit}}$",
      "metadata": {
        "label": "prop-lipschitz-diffusion"
      },
      "section": "## 1. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "249: The diffusion tensor varies smoothly with the state.\n250: \n251: :::{prf:proposition} Lipschitz Continuity of Adaptive Diffusion\n252: :label: prop-lipschitz-diffusion\n253: \n254: The adaptive diffusion tensor is Lipschitz continuous:\n255: \n256: $$\n257: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F \\le L_\\Sigma \\cdot d_{\\text{state}}((x_1, S_1), (x_2, S_2))\n258: $$\n259: \n260: where $\\|\\cdot\\|_F$ is the Frobenius norm, $d_{\\text{state}}$ is an appropriate state-space metric, and $L_\\Sigma$ depends on:\n261: - The Lipschitz constant of the fitness Hessian $\\nabla^2 V_{\\text{fit}}$\n262: - The regularization $\\epsilon_\\Sigma$"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-128",
      "title": null,
      "start_line": 264,
      "end_line": 348,
      "header_lines": [],
      "content_start": 265,
      "content_end": 347,
      "content": "265: \n266: :::{prf:proof}\n267: We prove Lipschitz continuity with an N-uniform constant $L_\\Sigma$.\n268: \n269: **Step 1: Structure of the fitness potential**\n270: \n271: For typical fitness potentials (e.g., kernel density estimates, pair potentials), the fitness has the structure:\n272: \n273: $$\n274: V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{i,j} \\phi(x_i, x_j)\n275: $$\n276: \n277: where $\\phi: \\mathcal{X} \\times \\mathcal{X} \\to \\mathbb{R}$ is a smooth, bounded interaction kernel. The Hessian with respect to walker $i$'s position is:\n278: \n279: $$\n280: H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{j=1}^N \\nabla^2_{x_i} \\phi(x_i, x_j)\n281: $$\n282: \n283: The $1/N$ normalization is critical for N-uniformity.\n284: \n285: **Step 2: Lipschitz continuity of the Hessian**\n286: \n287: Since $\\phi$ is smooth with bounded third derivatives (Assumption on $V_{\\text{fit}}$), the Hessian is Lipschitz:\n288: \n289: $$\n290: \\|H_i(S_1) - H_i(S_2)\\|_F \\le \\frac{1}{N} \\sum_{j=1}^N \\|\\nabla^2_{x_i} \\phi(x_{1,i}, x_{1,j}) - \\nabla^2_{x_i} \\phi(x_{2,i}, x_{2,j})\\|_F\n291: $$\n292: \n293: $$\n294: \\le \\frac{1}{N} \\sum_{j=1}^N L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n295: $$\n296: \n297: $$\n298: \\le L_{\\phi}^{(3)} \\cdot \\frac{1}{N} \\sum_{j=1}^N (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n299: $$\n300: \n301: $$\n302: = L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|)\n303: $$\n304: \n305: Define the state-space metric:\n306: \n307: $$\n308: d_{\\text{state}}((x_i, S_1), (x_i, S_2)) = \\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|\n309: $$\n310: \n311: Then $\\|H_i(S_1) - H_i(S_2)\\|_F \\le L_H \\cdot d_{\\text{state}}$ where $L_H = L_{\\phi}^{(3)}$ is **independent of $N$**.\n312: \n313: **Step 3: Lipschitz continuity of the matrix square root**\n314: \n315: The map $f(A) = (A + \\epsilon_\\Sigma I)^{-1/2}$ is Lipschitz on the set of symmetric matrices with eigenvalues in $[\\epsilon_\\Sigma - \\Lambda_-, H_{\\max} + \\epsilon_\\Sigma]$.\n316: \n317: For symmetric matrices $A, B$ in this set, by standard matrix perturbation theory (Bhatia, Matrix Analysis, Theorem VII.1.8):\n318: \n319: $$\n320: \\|f(A) - f(B)\\|_F \\le K_{\\text{sqrt}}(\\epsilon_\\Sigma, H_{\\max}) \\|A - B\\|_F\n321: $$\n322: \n323: where $K_{\\text{sqrt}}$ depends only on the ellipticity bounds, not on $N$.\n324: \n325: **Step 4: Composition**\n326: \n327: By the chain rule for Lipschitz functions:\n328: \n329: $$\n330: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F = \\|f(H_i(S_1)) - f(H_i(S_2))\\|_F\n331: $$\n332: \n333: $$\n334: \\le K_{\\text{sqrt}} \\|H_i(S_1) - H_i(S_2)\\|_F\n335: $$\n336: \n337: $$\n338: \\le K_{\\text{sqrt}} \\cdot L_H \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n339: $$\n340: \n341: Setting $L_\\Sigma = K_{\\text{sqrt}} \\cdot L_H$, we have:\n342: \n343: $$\n344: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F \\le L_\\Sigma \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n345: $$\n346: \n347: where $L_\\Sigma$ is **independent of $N$** by construction.",
      "metadata": {},
      "section": "## 1. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "264: :::\n265: \n266: :::{prf:proof}\n267: We prove Lipschitz continuity with an N-uniform constant $L_\\Sigma$.\n268: \n269: **Step 1: Structure of the fitness potential**\n270: \n271: For typical fitness potentials (e.g., kernel density estimates, pair potentials), the fitness has the structure:\n272: \n273: $$\n274: V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{i,j} \\phi(x_i, x_j)\n275: $$\n276: \n277: where $\\phi: \\mathcal{X} \\times \\mathcal{X} \\to \\mathbb{R}$ is a smooth, bounded interaction kernel. The Hessian with respect to walker $i$'s position is:\n278: \n279: $$\n280: H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{j=1}^N \\nabla^2_{x_i} \\phi(x_i, x_j)\n281: $$\n282: \n283: The $1/N$ normalization is critical for N-uniformity.\n284: \n285: **Step 2: Lipschitz continuity of the Hessian**\n286: \n287: Since $\\phi$ is smooth with bounded third derivatives (Assumption on $V_{\\text{fit}}$), the Hessian is Lipschitz:\n288: \n289: $$\n290: \\|H_i(S_1) - H_i(S_2)\\|_F \\le \\frac{1}{N} \\sum_{j=1}^N \\|\\nabla^2_{x_i} \\phi(x_{1,i}, x_{1,j}) - \\nabla^2_{x_i} \\phi(x_{2,i}, x_{2,j})\\|_F\n291: $$\n292: \n293: $$\n294: \\le \\frac{1}{N} \\sum_{j=1}^N L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n295: $$\n296: \n297: $$\n298: \\le L_{\\phi}^{(3)} \\cdot \\frac{1}{N} \\sum_{j=1}^N (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n299: $$\n300: \n301: $$\n302: = L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|)\n303: $$\n304: \n305: Define the state-space metric:\n306: \n307: $$\n308: d_{\\text{state}}((x_i, S_1), (x_i, S_2)) = \\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|\n309: $$\n310: \n311: Then $\\|H_i(S_1) - H_i(S_2)\\|_F \\le L_H \\cdot d_{\\text{state}}$ where $L_H = L_{\\phi}^{(3)}$ is **independent of $N$**.\n312: \n313: **Step 3: Lipschitz continuity of the matrix square root**\n314: \n315: The map $f(A) = (A + \\epsilon_\\Sigma I)^{-1/2}$ is Lipschitz on the set of symmetric matrices with eigenvalues in $[\\epsilon_\\Sigma - \\Lambda_-, H_{\\max} + \\epsilon_\\Sigma]$.\n316: \n317: For symmetric matrices $A, B$ in this set, by standard matrix perturbation theory (Bhatia, Matrix Analysis, Theorem VII.1.8):\n318: \n319: $$\n320: \\|f(A) - f(B)\\|_F \\le K_{\\text{sqrt}}(\\epsilon_\\Sigma, H_{\\max}) \\|A - B\\|_F\n321: $$\n322: \n323: where $K_{\\text{sqrt}}$ depends only on the ellipticity bounds, not on $N$.\n324: \n325: **Step 4: Composition**\n326: \n327: By the chain rule for Lipschitz functions:\n328: \n329: $$\n330: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F = \\|f(H_i(S_1)) - f(H_i(S_2))\\|_F\n331: $$\n332: \n333: $$\n334: \\le K_{\\text{sqrt}} \\|H_i(S_1) - H_i(S_2)\\|_F\n335: $$\n336: \n337: $$\n338: \\le K_{\\text{sqrt}} \\cdot L_H \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n339: $$\n340: \n341: Setting $L_\\Sigma = K_{\\text{sqrt}} \\cdot L_H$, we have:\n342: \n343: $$\n344: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F \\le L_\\Sigma \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n345: $$\n346: \n347: where $L_\\Sigma$ is **independent of $N$** by construction.\n348: "
    },
    {
      "directive_type": "definition",
      "label": "def-d-kinetic-operator-adaptive",
      "title": "Kinetic Operator with Adaptive Diffusion",
      "start_line": 354,
      "end_line": 393,
      "header_lines": [
        355
      ],
      "content_start": 357,
      "content_end": 392,
      "content": "357: :label: def-d-kinetic-operator-adaptive\n358: \n359: The kinetic operator $\\Psi_{\\text{kin}}$ evolves the swarm for time $\\tau$ according to:\n360: \n361: $$\n362: \\begin{aligned}\n363: dx_i &= v_i \\, dt \\\\\n364: dv_i &= \\left[ F(x_i) - \\gamma v_i \\right] dt + \\Sigma_{\\text{reg}}(x_i, S) \\circ dW_i\n365: \\end{aligned}\n366: $$\n367: \n368: where:\n369: - $F(x) = -\\nabla U(x)$ is the force from the confining potential (Axiom 1.3.1 from `04_convergence.md`)\n370: - $\\gamma > 0$ is the friction coefficient\n371: - $W_i$ are independent standard Brownian motions\n372: - $\\circ$ denotes the **Stratonovich product** (not It\u00f4)\n373: \n374: **Why Stratonovich**: The Stratonovich formulation is essential for manifold/geometric settings because:\n375: 1. **Chain rule works**: Stratonovich SDEs transform naturally under coordinate changes\n376: 2. **Geometric invariance**: The diffusion $(H + \\epsilon_\\Sigma I)^{-1/2}$ represents intrinsic geometry\n377: 3. **No spurious drift**: It\u00f4 would add correction terms $\\frac{1}{2}\\sum_j (D_x\\Sigma_{\\text{reg}}^{(\\cdot,j)})\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ that obscure the physics\n378: \n379: **Generator and Discretization Convention**: We present the SDE in Stratonovich form for geometric clarity. However:\n380: - **For proofs**: The infinitesimal generator $\\mathcal{L}$ uses the **It\u00f4 form** with It\u00f4 drift:\n381: \n382: $$\n383: b_{\\text{It\\hat{o}}}(x,v,S) = [F(x) - \\gamma v] + \\frac{1}{2}\\sum_{j=1}^d (D_x\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S))\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\n384: $$\n385: \n386:   where $\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ is the $j$-th column and $D_x$ is the Jacobian w.r.t. $x$.\n387: \n388: - **For discretization**: To properly simulate this SDE, we use either:\n389:   - **Heun's method** (stochastic midpoint) for the Stratonovich form, or\n390:   - **Euler-Maruyama** on the It\u00f4 form (with the corrected drift above)\n391: \n392: Note: Direct application of Euler-Maruyama to the Stratonovich form is inconsistent and should be avoided.",
      "metadata": {
        "label": "def-d-kinetic-operator-adaptive"
      },
      "section": "## 1. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "354: The kinetic operator evolves walkers according to underdamped Langevin dynamics with the adaptive diffusion.\n355: \n356: :::{prf:definition} Kinetic Operator with Adaptive Diffusion\n357: :label: def-d-kinetic-operator-adaptive\n358: \n359: The kinetic operator $\\Psi_{\\text{kin}}$ evolves the swarm for time $\\tau$ according to:\n360: \n361: $$\n362: \\begin{aligned}\n363: dx_i &= v_i \\, dt \\\\\n364: dv_i &= \\left[ F(x_i) - \\gamma v_i \\right] dt + \\Sigma_{\\text{reg}}(x_i, S) \\circ dW_i\n365: \\end{aligned}\n366: $$\n367: \n368: where:\n369: - $F(x) = -\\nabla U(x)$ is the force from the confining potential (Axiom 1.3.1 from `04_convergence.md`)\n370: - $\\gamma > 0$ is the friction coefficient\n371: - $W_i$ are independent standard Brownian motions\n372: - $\\circ$ denotes the **Stratonovich product** (not It\u00f4)\n373: \n374: **Why Stratonovich**: The Stratonovich formulation is essential for manifold/geometric settings because:\n375: 1. **Chain rule works**: Stratonovich SDEs transform naturally under coordinate changes\n376: 2. **Geometric invariance**: The diffusion $(H + \\epsilon_\\Sigma I)^{-1/2}$ represents intrinsic geometry\n377: 3. **No spurious drift**: It\u00f4 would add correction terms $\\frac{1}{2}\\sum_j (D_x\\Sigma_{\\text{reg}}^{(\\cdot,j)})\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ that obscure the physics\n378: \n379: **Generator and Discretization Convention**: We present the SDE in Stratonovich form for geometric clarity. However:\n380: - **For proofs**: The infinitesimal generator $\\mathcal{L}$ uses the **It\u00f4 form** with It\u00f4 drift:\n381: \n382: $$\n383: b_{\\text{It\\hat{o}}}(x,v,S) = [F(x) - \\gamma v] + \\frac{1}{2}\\sum_{j=1}^d (D_x\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S))\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\n384: $$\n385: \n386:   where $\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ is the $j$-th column and $D_x$ is the Jacobian w.r.t. $x$.\n387: \n388: - **For discretization**: To properly simulate this SDE, we use either:\n389:   - **Heun's method** (stochastic midpoint) for the Stratonovich form, or\n390:   - **Euler-Maruyama** on the It\u00f4 form (with the corrected drift above)\n391: \n392: Note: Direct application of Euler-Maruyama to the Stratonovich form is inconsistent and should be avoided.\n393: "
    },
    {
      "directive_type": "remark",
      "label": "rem-comparison-isotropic",
      "title": "Comparison to Isotropic Case",
      "start_line": 395,
      "end_line": 407,
      "header_lines": [
        396
      ],
      "content_start": 398,
      "content_end": 406,
      "content": "398: :label: rem-comparison-isotropic\n399: \n400: The **isotropic Euclidean Gas** (`04_convergence.md`) uses $\\Sigma = \\sigma_v I$. The convergence proof relies heavily on this simplification:\n401: - Noise contribution to Lyapunov drift: $\\text{Tr}(\\sigma_v^2 I \\cdot \\nabla^2 V) = \\sigma_v^2 \\text{Tr}(\\nabla^2 V)$ is **constant**\n402: - Synchronous coupling: Both swarms use **identical** noise tensor $\\sigma_v I$\n403: \n404: The **Adaptive Gas** uses $\\Sigma = \\Sigma_{\\text{reg}}(x_i, S)$. The challenges:\n405: - Noise contribution: $\\text{Tr}(D_{\\text{reg}}(x_i, S) \\cdot \\nabla^2 V)$ is **state-dependent**\n406: - Synchronous coupling: Must handle **different** noise tensors $\\Sigma_{\\text{reg}}(x_{1,i}, S_1) \\neq \\Sigma_{\\text{reg}}(x_{2,i}, S_2)$",
      "metadata": {
        "label": "rem-comparison-isotropic"
      },
      "section": "## 1. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "395: :::\n396: \n397: :::{prf:remark} Comparison to Isotropic Case\n398: :label: rem-comparison-isotropic\n399: \n400: The **isotropic Euclidean Gas** (`04_convergence.md`) uses $\\Sigma = \\sigma_v I$. The convergence proof relies heavily on this simplification:\n401: - Noise contribution to Lyapunov drift: $\\text{Tr}(\\sigma_v^2 I \\cdot \\nabla^2 V) = \\sigma_v^2 \\text{Tr}(\\nabla^2 V)$ is **constant**\n402: - Synchronous coupling: Both swarms use **identical** noise tensor $\\sigma_v I$\n403: \n404: The **Adaptive Gas** uses $\\Sigma = \\Sigma_{\\text{reg}}(x_i, S)$. The challenges:\n405: - Noise contribution: $\\text{Tr}(D_{\\text{reg}}(x_i, S) \\cdot \\nabla^2 V)$ is **state-dependent**\n406: - Synchronous coupling: Must handle **different** noise tensors $\\Sigma_{\\text{reg}}(x_{1,i}, S_1) \\neq \\Sigma_{\\text{reg}}(x_{2,i}, S_2)$\n407: "
    },
    {
      "directive_type": "observation",
      "label": "obs-two-formulations",
      "title": "Two Equivalent Formulations",
      "start_line": 428,
      "end_line": 458,
      "header_lines": [
        429
      ],
      "content_start": 431,
      "content_end": 457,
      "content": "431: :label: obs-two-formulations\n432: \n433: **Perspective 1: Flat Algorithmic Space (This Document)**\n434: - **State space**: Flat Euclidean $\\mathbb{R}^d \\times \\mathbb{R}^d$ (positions and velocities)\n435: - **Diffusion**: Anisotropic, state-dependent: $D(x, S) = (H(x, S) + \\epsilon_\\Sigma I)^{-1}$\n436: - **Metric**: Standard Euclidean inner product\n437: - **SDE** (Stratonovich):\n438: \n439: \n440: $$\n441: dv = [F(x) - \\gamma v] dt + \\Sigma_{\\text{reg}}(x, S) \\circ dW\n442: $$\n443: \n444:   where $\\Sigma_{\\text{reg}} = D^{1/2}$ is anisotropic\n445: \n446: **Perspective 2: Emergent Riemannian Manifold**\n447: - **State space**: Riemannian manifold $(\\mathcal{X}, g)$ with metric $g(x, S) = H(x, S) + \\epsilon_\\Sigma I$\n448: - **Diffusion**: Isotropic in the Riemannian metric (constant diffusion coefficient)\n449: - **Metric**: Riemannian metric $g = D^{-1}$ induced by regularized Hessian\n450: - **SDE** (in local coordinates, Stratonovich):\n451: \n452: \n453: $$\n454: dv = [\\tilde{F}_g(x) - \\gamma v] dt + \\sigma \\sqrt{g^{-1}(x, S)} \\circ dW\n455: $$\n456: \n457:   where $\\tilde{F}_g$ includes Christoffel symbol corrections",
      "metadata": {
        "label": "obs-two-formulations"
      },
      "section": "## 1. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "428: The Adaptive Gas can be analyzed from two complementary viewpoints:\n429: \n430: :::{prf:observation} Two Equivalent Formulations\n431: :label: obs-two-formulations\n432: \n433: **Perspective 1: Flat Algorithmic Space (This Document)**\n434: - **State space**: Flat Euclidean $\\mathbb{R}^d \\times \\mathbb{R}^d$ (positions and velocities)\n435: - **Diffusion**: Anisotropic, state-dependent: $D(x, S) = (H(x, S) + \\epsilon_\\Sigma I)^{-1}$\n436: - **Metric**: Standard Euclidean inner product\n437: - **SDE** (Stratonovich):\n438: \n439: \n440: $$\n441: dv = [F(x) - \\gamma v] dt + \\Sigma_{\\text{reg}}(x, S) \\circ dW\n442: $$\n443: \n444:   where $\\Sigma_{\\text{reg}} = D^{1/2}$ is anisotropic\n445: \n446: **Perspective 2: Emergent Riemannian Manifold**\n447: - **State space**: Riemannian manifold $(\\mathcal{X}, g)$ with metric $g(x, S) = H(x, S) + \\epsilon_\\Sigma I$\n448: - **Diffusion**: Isotropic in the Riemannian metric (constant diffusion coefficient)\n449: - **Metric**: Riemannian metric $g = D^{-1}$ induced by regularized Hessian\n450: - **SDE** (in local coordinates, Stratonovich):\n451: \n452: \n453: $$\n454: dv = [\\tilde{F}_g(x) - \\gamma v] dt + \\sigma \\sqrt{g^{-1}(x, S)} \\circ dW\n455: $$\n456: \n457:   where $\\tilde{F}_g$ includes Christoffel symbol corrections\n458: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-coordinate-invariance",
      "title": "Invariance Under Coordinate Changes (Refined)",
      "start_line": 478,
      "end_line": 506,
      "header_lines": [
        479
      ],
      "content_start": 481,
      "content_end": 505,
      "content": "481: :label: thm-coordinate-invariance\n482: \n483: Let $\\Psi: (\\mathbb{R}^d, D_{\\text{flat}}) \\to (M, g)$ be a $C^2$ diffeomorphism relating flat space with anisotropic diffusion to a Riemannian manifold. If the Jacobian $d\\Psi$ and its inverse have bounded operator norms:\n484: \n485: $$\n486: \\|d\\Psi\\|_{\\text{op}}, \\|(d\\Psi)^{-1}\\|_{\\text{op}} \\le K\n487: $$\n488: \n489: and the push-forward relation holds:\n490: \n491: $$\n492: D_{\\text{flat}}(x) = (d\\Psi_x^{-1})^T g(\\Psi(x))^{-1} (d\\Psi_x^{-1})\n493: $$\n494: \n495: then:\n496: \n497: 1. **TV distances match exactly**: $\\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\mathcal{L}^{\\text{curved}}(Y_t) - \\pi^{\\text{curved}}\\|_{\\text{TV}}$\n498: \n499: 2. **Lyapunov drift inequalities are preserved up to condition-number factors**: If $\\mathbb{E}[\\Delta V_{\\text{flat}}(X)] \\le -\\kappa V_{\\text{flat}}(X) + C$, then with $V_{\\text{curved}} = V_{\\text{flat}} \\circ \\Psi^{-1}$:\n500: \n501: $$\n502: \\mathbb{E}[\\Delta V_{\\text{curved}}(Y)] \\le -\\kappa' V_{\\text{curved}}(Y) + C'\n503: $$\n504: \n505: where $\\kappa' \\asymp \\kappa/\\text{cond}(d\\Psi)^2$ and $C' \\asymp C \\cdot \\text{cond}(d\\Psi)^2$.",
      "metadata": {
        "label": "thm-coordinate-invariance"
      },
      "section": "## 1. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "478: #### 1.6.3. Invariance of Convergence Constants\n479: \n480: :::{prf:theorem} Invariance Under Coordinate Changes (Refined)\n481: :label: thm-coordinate-invariance\n482: \n483: Let $\\Psi: (\\mathbb{R}^d, D_{\\text{flat}}) \\to (M, g)$ be a $C^2$ diffeomorphism relating flat space with anisotropic diffusion to a Riemannian manifold. If the Jacobian $d\\Psi$ and its inverse have bounded operator norms:\n484: \n485: $$\n486: \\|d\\Psi\\|_{\\text{op}}, \\|(d\\Psi)^{-1}\\|_{\\text{op}} \\le K\n487: $$\n488: \n489: and the push-forward relation holds:\n490: \n491: $$\n492: D_{\\text{flat}}(x) = (d\\Psi_x^{-1})^T g(\\Psi(x))^{-1} (d\\Psi_x^{-1})\n493: $$\n494: \n495: then:\n496: \n497: 1. **TV distances match exactly**: $\\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\mathcal{L}^{\\text{curved}}(Y_t) - \\pi^{\\text{curved}}\\|_{\\text{TV}}$\n498: \n499: 2. **Lyapunov drift inequalities are preserved up to condition-number factors**: If $\\mathbb{E}[\\Delta V_{\\text{flat}}(X)] \\le -\\kappa V_{\\text{flat}}(X) + C$, then with $V_{\\text{curved}} = V_{\\text{flat}} \\circ \\Psi^{-1}$:\n500: \n501: $$\n502: \\mathbb{E}[\\Delta V_{\\text{curved}}(Y)] \\le -\\kappa' V_{\\text{curved}}(Y) + C'\n503: $$\n504: \n505: where $\\kappa' \\asymp \\kappa/\\text{cond}(d\\Psi)^2$ and $C' \\asymp C \\cdot \\text{cond}(d\\Psi)^2$.\n506: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-372",
      "title": null,
      "start_line": 508,
      "end_line": 552,
      "header_lines": [],
      "content_start": 509,
      "content_end": 551,
      "content": "509: \n510: :::{prf:proof}\n511: **Key insight**: Convergence of a Markov process is an **intrinsic property** of the process itself, independent of the coordinate system used to describe it.\n512: \n513: **Step 1: Push-forward measure**\n514: \n515: The law of the process in flat coordinates, $\\mathcal{L}^{\\text{flat}}(X_t)$, is related to the law in manifold coordinates, $\\mathcal{L}^{\\text{curved}}(Y_t)$, by:\n516: \n517: $$\n518: \\mathcal{L}^{\\text{curved}}(Y_t) = \\Psi_* \\mathcal{L}^{\\text{flat}}(X_t)\n519: $$\n520: \n521: where $Y_t = \\Psi(X_t)$ and $\\Psi_*$ denotes push-forward.\n522: \n523: **Step 2: Total variation distance is preserved**\n524: \n525: For any measurable sets $A_{\\text{flat}} \\subset \\mathbb{R}^d$ and $A_{\\text{curved}} = \\Psi(A_{\\text{flat}}) \\subset M$:\n526: \n527: $$\n528: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\Psi_* \\mathcal{L}^{\\text{flat}}(X_t) - \\Psi_* \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\mathcal{L}^{\\text{curved}}(Y_t) - \\pi^{\\text{curved}}\\|_{\\text{TV}}\n529: $$\n530: \n531: where $\\pi^{\\text{curved}} = \\Psi_* \\pi^{\\text{flat}}$ is the push-forward stationary measure.\n532: \n533: **Step 3: TV convergence is exactly preserved**\n534: \n535: From geometric ergodicity in flat coordinates:\n536: \n537: $$\n538: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} \\le C_\\pi (1 - \\kappa_{\\text{total}})^t\n539: $$\n540: \n541: Since the left-hand side equals the total variation distance in curved coordinates (Step 2), TV convergence is preserved exactly.\n542: \n543: **Step 4: Lyapunov functions transform with condition-number factors**\n544: \n545: If $V_{\\text{flat}}(x)$ is a Lyapunov function satisfying $\\mathbb{E}[\\Delta V_{\\text{flat}}] \\le -\\kappa V_{\\text{flat}} + C$, then $V_{\\text{curved}}(y) = V_{\\text{flat}}(\\Psi^{-1}(y))$ satisfies the drift inequality in curved coordinates, but:\n546: \n547: - The generator involves $\\nabla V_{\\text{curved}} = (d\\Psi^{-1})^T \\nabla V_{\\text{flat}}$ and $\\nabla^2 V_{\\text{curved}}$ (chain rule)\n548: - These scale by $\\|d\\Psi\\|_{\\text{op}}$ and $\\|(d\\Psi)^{-1}\\|_{\\text{op}}$, introducing condition-number factors\n549: - Hence $\\kappa'$ and $C'$ scale with $\\text{cond}(d\\Psi)^2 = \\|d\\Psi\\|_{\\text{op}} \\cdot \\|(d\\Psi)^{-1}\\|_{\\text{op}}$\n550: \n551: **Conclusion**: Geometric ergodicity (qualitative property) is coordinate-invariant, but Lyapunov constants (quantitative) may change unless $\\Psi$ is an isometry.",
      "metadata": {},
      "section": "## 1. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "508: :::\n509: \n510: :::{prf:proof}\n511: **Key insight**: Convergence of a Markov process is an **intrinsic property** of the process itself, independent of the coordinate system used to describe it.\n512: \n513: **Step 1: Push-forward measure**\n514: \n515: The law of the process in flat coordinates, $\\mathcal{L}^{\\text{flat}}(X_t)$, is related to the law in manifold coordinates, $\\mathcal{L}^{\\text{curved}}(Y_t)$, by:\n516: \n517: $$\n518: \\mathcal{L}^{\\text{curved}}(Y_t) = \\Psi_* \\mathcal{L}^{\\text{flat}}(X_t)\n519: $$\n520: \n521: where $Y_t = \\Psi(X_t)$ and $\\Psi_*$ denotes push-forward.\n522: \n523: **Step 2: Total variation distance is preserved**\n524: \n525: For any measurable sets $A_{\\text{flat}} \\subset \\mathbb{R}^d$ and $A_{\\text{curved}} = \\Psi(A_{\\text{flat}}) \\subset M$:\n526: \n527: $$\n528: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\Psi_* \\mathcal{L}^{\\text{flat}}(X_t) - \\Psi_* \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\mathcal{L}^{\\text{curved}}(Y_t) - \\pi^{\\text{curved}}\\|_{\\text{TV}}\n529: $$\n530: \n531: where $\\pi^{\\text{curved}} = \\Psi_* \\pi^{\\text{flat}}$ is the push-forward stationary measure.\n532: \n533: **Step 3: TV convergence is exactly preserved**\n534: \n535: From geometric ergodicity in flat coordinates:\n536: \n537: $$\n538: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} \\le C_\\pi (1 - \\kappa_{\\text{total}})^t\n539: $$\n540: \n541: Since the left-hand side equals the total variation distance in curved coordinates (Step 2), TV convergence is preserved exactly.\n542: \n543: **Step 4: Lyapunov functions transform with condition-number factors**\n544: \n545: If $V_{\\text{flat}}(x)$ is a Lyapunov function satisfying $\\mathbb{E}[\\Delta V_{\\text{flat}}] \\le -\\kappa V_{\\text{flat}} + C$, then $V_{\\text{curved}}(y) = V_{\\text{flat}}(\\Psi^{-1}(y))$ satisfies the drift inequality in curved coordinates, but:\n546: \n547: - The generator involves $\\nabla V_{\\text{curved}} = (d\\Psi^{-1})^T \\nabla V_{\\text{flat}}$ and $\\nabla^2 V_{\\text{curved}}$ (chain rule)\n548: - These scale by $\\|d\\Psi\\|_{\\text{op}}$ and $\\|(d\\Psi)^{-1}\\|_{\\text{op}}$, introducing condition-number factors\n549: - Hence $\\kappa'$ and $C'$ scale with $\\text{cond}(d\\Psi)^2 = \\|d\\Psi\\|_{\\text{op}} \\cdot \\|(d\\Psi)^{-1}\\|_{\\text{op}}$\n550: \n551: **Conclusion**: Geometric ergodicity (qualitative property) is coordinate-invariant, but Lyapunov constants (quantitative) may change unless $\\Psi$ is an isometry.\n552: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}