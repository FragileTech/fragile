{
  "chapter_index": 3,
  "section_id": "## 3. Anisotropic Kinetic Operator Analysis",
  "directive_count": 16,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-ito-correction-bound",
      "title": "It\u00f4 Correction Term Bound",
      "start_line": 781,
      "end_line": 803,
      "header_lines": [
        782
      ],
      "content_start": 784,
      "content_end": 802,
      "content": "784: :label: lem-ito-correction-bound\n785: \n786: For the kinetic SDE with adaptive diffusion (Definition [](#def-d-kinetic-operator-adaptive)), the It\u00f4 correction term in the drift is:\n787: \n788: $$\n789: b_{\\text{correction}}(x, v, S) = \\frac{1}{2}\\sum_{j=1}^d \\left( D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S) \\right) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\n790: $$\n791: \n792: where $\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ is the $j$-th column of $\\Sigma_{\\text{reg}}$ and $D_x$ is the Jacobian with respect to $x$.\n793: \n794: This term satisfies the bound:\n795: \n796: $$\n797: \\|b_{\\text{correction}}(x, v, S)\\| \\le C_{\\text{It\u00f4}} := \\frac{1}{2} d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n798: $$\n799: \n800: where:\n801: - $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is the supremum of the operator norm of the Jacobian of $\\Sigma_{\\text{reg}}$ over the state space\n802: - $c_{\\max}^{1/2} = 1/\\sqrt{\\epsilon_\\Sigma}$ is the upper bound on $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}}$",
      "metadata": {
        "label": "lem-ito-correction-bound"
      },
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "781: Before proving the drift inequalities, we must analyze the **It\u00f4 correction term** that arises from the state-dependent diffusion tensor.\n782: \n783: :::{prf:lemma} It\u00f4 Correction Term Bound\n784: :label: lem-ito-correction-bound\n785: \n786: For the kinetic SDE with adaptive diffusion (Definition [](#def-d-kinetic-operator-adaptive)), the It\u00f4 correction term in the drift is:\n787: \n788: $$\n789: b_{\\text{correction}}(x, v, S) = \\frac{1}{2}\\sum_{j=1}^d \\left( D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S) \\right) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\n790: $$\n791: \n792: where $\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ is the $j$-th column of $\\Sigma_{\\text{reg}}$ and $D_x$ is the Jacobian with respect to $x$.\n793: \n794: This term satisfies the bound:\n795: \n796: $$\n797: \\|b_{\\text{correction}}(x, v, S)\\| \\le C_{\\text{It\u00f4}} := \\frac{1}{2} d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n798: $$\n799: \n800: where:\n801: - $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is the supremum of the operator norm of the Jacobian of $\\Sigma_{\\text{reg}}$ over the state space\n802: - $c_{\\max}^{1/2} = 1/\\sqrt{\\epsilon_\\Sigma}$ is the upper bound on $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}}$\n803: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-31",
      "title": null,
      "start_line": 805,
      "end_line": 847,
      "header_lines": [],
      "content_start": 806,
      "content_end": 846,
      "content": "806: \n807: :::{prf:proof}\n808: **Step 1: Structure of the correction term**\n809: \n810: By definition of the Stratonovich-to-It\u00f4 conversion for the SDE $dv = \\ldots + \\Sigma_{\\text{reg}}(x,S) \\circ dW$, the correction is:\n811: \n812: $$\n813: b_{\\text{correction}} = \\frac{1}{2}\\sum_{j=1}^d (D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}) \\Sigma_{\\text{reg}}^{(\\cdot,j)}\n814: $$\n815: \n816: **Step 2: Bound on each term**\n817: \n818: For each $j \\in \\{1,\\ldots,d\\}$:\n819: \n820: $$\n821: \\|(D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\| \\le \\|D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|_{\\text{op}} \\cdot \\|\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|\n822: $$\n823: \n824: The Jacobian operator norm is bounded by $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$, and the column norm is bounded by $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}} \\le c_{\\max}^{1/2}$ (from uniform ellipticity).\n825: \n826: **Step 3: Sum over dimensions**\n827: \n828: $$\n829: \\|b_{\\text{correction}}\\| \\le \\sum_{j=1}^d \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2} \\le d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n830: $$\n831: \n832: Multiplying by $1/2$ gives the claimed bound.\n833: \n834: **Step 4: N-uniformity**\n835: \n836: The diffusion tensor $\\Sigma_{\\text{reg}}(x_i, S)$ depends on:\n837: 1. The walker's own position $x_i$\n838: 2. The Hessian $H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$\n839: \n840: For typical fitness potentials (e.g., $V_{\\text{fit}}(S) = \\frac{1}{N}\\sum_{i,j} V_{\\text{pair}}(x_i, x_j)$), the Hessian has the structure:\n841: \n842: $$\n843: H_i(S) = \\frac{1}{N} \\sum_{j \\neq i} \\nabla^2 V_{\\text{pair}}(x_i, x_j)\n844: $$\n845: \n846: The gradient of $\\Sigma_{\\text{reg}}$ with respect to $x_i$ involves third derivatives of $V_{\\text{pair}}$, averaged over $N$ pairs. The $1/N$ normalization in $V_{\\text{fit}}$ ensures that $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is **independent of $N$**.",
      "metadata": {},
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "805: :::\n806: \n807: :::{prf:proof}\n808: **Step 1: Structure of the correction term**\n809: \n810: By definition of the Stratonovich-to-It\u00f4 conversion for the SDE $dv = \\ldots + \\Sigma_{\\text{reg}}(x,S) \\circ dW$, the correction is:\n811: \n812: $$\n813: b_{\\text{correction}} = \\frac{1}{2}\\sum_{j=1}^d (D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}) \\Sigma_{\\text{reg}}^{(\\cdot,j)}\n814: $$\n815: \n816: **Step 2: Bound on each term**\n817: \n818: For each $j \\in \\{1,\\ldots,d\\}$:\n819: \n820: $$\n821: \\|(D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\| \\le \\|D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|_{\\text{op}} \\cdot \\|\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|\n822: $$\n823: \n824: The Jacobian operator norm is bounded by $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$, and the column norm is bounded by $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}} \\le c_{\\max}^{1/2}$ (from uniform ellipticity).\n825: \n826: **Step 3: Sum over dimensions**\n827: \n828: $$\n829: \\|b_{\\text{correction}}\\| \\le \\sum_{j=1}^d \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2} \\le d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n830: $$\n831: \n832: Multiplying by $1/2$ gives the claimed bound.\n833: \n834: **Step 4: N-uniformity**\n835: \n836: The diffusion tensor $\\Sigma_{\\text{reg}}(x_i, S)$ depends on:\n837: 1. The walker's own position $x_i$\n838: 2. The Hessian $H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$\n839: \n840: For typical fitness potentials (e.g., $V_{\\text{fit}}(S) = \\frac{1}{N}\\sum_{i,j} V_{\\text{pair}}(x_i, x_j)$), the Hessian has the structure:\n841: \n842: $$\n843: H_i(S) = \\frac{1}{N} \\sum_{j \\neq i} \\nabla^2 V_{\\text{pair}}(x_i, x_j)\n844: $$\n845: \n846: The gradient of $\\Sigma_{\\text{reg}}$ with respect to $x_i$ involves third derivatives of $V_{\\text{pair}}$, averaged over $N$ pairs. The $1/N$ normalization in $V_{\\text{fit}}$ ensures that $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is **independent of $N$**.\n847: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-velocity-variance-anisotropic",
      "title": "Velocity Variance Contraction (Anisotropic)",
      "start_line": 866,
      "end_line": 887,
      "header_lines": [
        867
      ],
      "content_start": 869,
      "content_end": 886,
      "content": "869: :label: thm-velocity-variance-anisotropic\n870: \n871: For the kinetic operator with adaptive diffusion, the velocity variance difference satisfies:\n872: \n873: $$\n874: \\mathbb{E}[V_{\\text{Var},v}(S'_1, S'_2) \\mid S_1, S_2] \\le V_{\\text{Var},v}(S_1, S_2) + \\tau \\left[ -2\\gamma V_{\\text{Var},v}(S_1, S_2) + C'_v \\right]\n875: $$\n876: \n877: where:\n878: - $\\gamma > 0$ is the friction coefficient\n879: - $C'_v = O(c_{\\max} d)$ depends on the upper diffusion bound (independent of $N$)\n880: - Both constants are **N-uniform** (independent of swarm size and current state)\n881: \n882: Rearranging:\n883: \n884: $$\n885: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\le -\\kappa'_v \\tau V_{\\text{Var},v} + C'_v \\tau\n886: $$",
      "metadata": {
        "label": "thm-velocity-variance-anisotropic"
      },
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "866: The first result is straightforward: friction dissipates velocity variance even with anisotropic noise.\n867: \n868: :::{prf:theorem} Velocity Variance Contraction (Anisotropic)\n869: :label: thm-velocity-variance-anisotropic\n870: \n871: For the kinetic operator with adaptive diffusion, the velocity variance difference satisfies:\n872: \n873: $$\n874: \\mathbb{E}[V_{\\text{Var},v}(S'_1, S'_2) \\mid S_1, S_2] \\le V_{\\text{Var},v}(S_1, S_2) + \\tau \\left[ -2\\gamma V_{\\text{Var},v}(S_1, S_2) + C'_v \\right]\n875: $$\n876: \n877: where:\n878: - $\\gamma > 0$ is the friction coefficient\n879: - $C'_v = O(c_{\\max} d)$ depends on the upper diffusion bound (independent of $N$)\n880: - Both constants are **N-uniform** (independent of swarm size and current state)\n881: \n882: Rearranging:\n883: \n884: $$\n885: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\le -\\kappa'_v \\tau V_{\\text{Var},v} + C'_v \\tau\n886: $$\n887: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-115",
      "title": null,
      "start_line": 889,
      "end_line": 1038,
      "header_lines": [],
      "content_start": 890,
      "content_end": 1037,
      "content": "890: \n891: :::{prf:proof}\n892: We analyze the generator $\\mathcal{L}$ acting on the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$ where:\n893: \n894: $$\n895: V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i: s_{k,i}=1} \\|v_{k,i} - \\bar{v}_k\\|^2\n896: $$\n897: \n898: (normalized by total swarm size $N$, consistent with position variance)\n899: \n900: **Step 1: Generator for a Single Swarm**\n901: \n902: For swarm $S_k$ evolving under the kinetic SDE (Stratonovich form):\n903: \n904: $$\n905: \\begin{aligned}\n906: dx_{k,i} &= v_{k,i} \\, dt \\\\\n907: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n908: \\end{aligned}\n909: $$\n910: \n911: The infinitesimal generator acts on the variance as:\n912: \n913: $$\n914: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|v_{k,i} - \\bar{v}_k\\|^2 \\right]\n915: $$\n916: \n917: where $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers and $N$ is the total (fixed) swarm size.\n918: \n919: **Step 2: Apply Generator to Centered Velocities**\n920: \n921: For each walker $i \\in A_k$, let $\\tilde{v}_{k,i} = v_{k,i} - \\bar{v}_k$. The generator acting on $f_i = \\|\\tilde{v}_{k,i}\\|^2$ with the **It\u00f4 drift** (including the correction term from Lemma [](#lem-ito-correction-bound)) is:\n922: \n923: $$\n924: \\mathcal{L} f_i = 2 \\langle \\tilde{v}_{k,i}, [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\rangle + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k))\n925: $$\n926: \n927: where we used $\\nabla f_i = 2\\tilde{v}_{k,i}$ and $\\nabla^2 f_i = 2I_d$.\n928: \n929: **Step 3: Analyze Drift Term**\n930: \n931: $$\n932: \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\langle v_{k,i} - \\bar{v}_k, v_{k,i} \\rangle = -\\gamma \\|v_{k,i}\\|^2 + \\gamma \\langle \\bar{v}_k, v_{k,i} \\rangle\n933: $$\n934: \n935: When we sum over all walkers: $\\sum_{i \\in A_k} \\langle \\bar{v}_k, v_{k,i} \\rangle = N_k \\|\\bar{v}_k\\|^2$ (by definition of $\\bar{v}_k$).\n936: \n937: Also: $\\sum_{i \\in A_k} \\|v_{k,i}\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i} + \\bar{v}_k\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 + N_k \\|\\bar{v}_k\\|^2$.\n938: \n939: Therefore:\n940: \n941: $$\n942: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 = -\\gamma N \\cdot V_{\\text{Var},v}(S_k)\n943: $$\n944: \n945: where we used the definition $V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2$.\n946: \n947: The force term $\\sum_i \\langle \\tilde{v}_{k,i}, F(x_{k,i}) \\rangle$ is bounded by Cauchy-Schwarz: $|\\langle \\tilde{v}, F \\rangle| \\le \\|F\\|_{\\infty} \\sqrt{N \\cdot V_{\\text{Var},v}}$, which can be absorbed into the friction by Young's inequality for sufficiently large $\\gamma$.\n948: \n949: **It\u00f4 correction contribution**: By Lemma [](#lem-ito-correction-bound), $\\|b_{\\text{correction}}\\| \\le C_{\\text{It\u00f4}}$, so:\n950: \n951: $$\n952: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k) \\rangle \\le N_k \\sqrt{V_{\\text{Var},v}} \\cdot C_{\\text{It\u00f4}}\n953: $$\n954: \n955: This is bounded by $N C_{\\text{It\u00f4}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}$ (by Young's inequality with $\\epsilon = 1/(4\\gamma)$), which contributes to the additive constant and slightly modifies the friction rate.\n956: \n957: **Step 4: Analyze Diffusion Term (KEY: N-uniformity)**\n958: \n959: $$\n960: \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) \\le \\sum_{i \\in A_k} c_{\\max} d = N_k \\cdot c_{\\max} d\n961: $$\n962: \n963: **Step 5: Combine and Normalize**\n964: \n965: $$\n966: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 \\right]\n967: $$\n968: \n969: $$\n970: = \\frac{1}{N} \\sum_{i \\in A_k} \\mathcal{L}[\\|\\tilde{v}_{k,i}\\|^2]\n971: $$\n972: \n973: $$\n974: = \\frac{1}{N} \\sum_{i \\in A_k} \\left[ -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}}) \\right]\n975: $$\n976: \n977: From Step 3, $\\sum_{i \\in A_k} -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 = -2\\gamma N \\cdot V_{\\text{Var},v}(S_k)$, so:\n978: \n979: $$\n980: = \\frac{1}{N} \\cdot (-2\\gamma N \\cdot V_{\\text{Var},v}(S_k)) + \\frac{1}{N} \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n981: $$\n982: \n983: $$\n984: = -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n985: $$\n986: \n987: $$\n988: \\le -2\\gamma V_{\\text{Var},v}(S_k) + c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n989: $$\n990: \n991: since $N_k \\le N$.\n992: \n993: **CRITICAL OBSERVATION**: With normalization by the total swarm size $N$, the diffusion term is bounded by $\\frac{N_k}{N} c_{\\max} d \\le c_{\\max} d$, which is **independent of both $N$ and $N_k$**. This establishes N-uniformity without requiring exact cancellation.\n994: \n995: **Step 6: Assemble Full Drift (Including It\u00f4 Correction)**\n996: \n997: Combining Steps 3-5, the full drift for $V_{\\text{Var},v}(S_k)$ is:\n998: \n999: $$\n1000: \\mathcal{L} V_{\\text{Var},v}(S_k) \\le -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + NC_{\\text{It\u00f4}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}(S_k) + O(\\|F\\|_\\infty)\n1001: $$\n1002: \n1003: Collecting the $V_{\\text{Var},v}$ terms:\n1004: \n1005: $$\n1006: \\le -(2\\gamma - \\frac{1}{4\\gamma}) V_{\\text{Var},v}(S_k) + c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)\n1007: $$\n1008: \n1009: For $\\gamma \\ge 1/2$, we have $2\\gamma - 1/(4\\gamma) \\ge \\gamma$. Define the effective friction rate:\n1010: \n1011: $$\n1012: \\kappa'_v := 2\\gamma - \\frac{1}{4\\gamma} \\ge \\gamma \\quad \\text{(for $\\gamma \\ge 1/2$)}\n1013: $$\n1014: \n1015: **Step 7: Coupled Sum**\n1016: \n1017: For the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$:\n1018: \n1019: $$\n1020: \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) \\le -\\kappa'_v V_{\\text{Var},v}(S_1, S_2) + 2[c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)]\n1021: $$\n1022: \n1023: **Step 8: Discrete-Time Conversion**\n1024: \n1025: By the discretization theorem (Theorem 1.7.2 from `04_convergence.md`):\n1026: \n1027: $$\n1028: \\mathbb{E}[V_{\\text{Var},v}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{Var},v}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) + O(\\tau^2)\n1029: $$\n1030: \n1031: Setting $C'_v = 2[c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)]$ (independent of $N$ since $C_{\\text{It\u00f4}}$ is N-uniform):\n1032: \n1033: $$\n1034: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\le -\\kappa'_v \\tau V_{\\text{Var},v} + C'_v \\tau\n1035: $$\n1036: \n1037: where $\\kappa'_v = 2\\gamma - 1/(4\\gamma) \\ge \\gamma$ for $\\gamma \\ge 1/2$.",
      "metadata": {},
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "889: :::\n890: \n891: :::{prf:proof}\n892: We analyze the generator $\\mathcal{L}$ acting on the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$ where:\n893: \n894: $$\n895: V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i: s_{k,i}=1} \\|v_{k,i} - \\bar{v}_k\\|^2\n896: $$\n897: \n898: (normalized by total swarm size $N$, consistent with position variance)\n899: \n900: **Step 1: Generator for a Single Swarm**\n901: \n902: For swarm $S_k$ evolving under the kinetic SDE (Stratonovich form):\n903: \n904: $$\n905: \\begin{aligned}\n906: dx_{k,i} &= v_{k,i} \\, dt \\\\\n907: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n908: \\end{aligned}\n909: $$\n910: \n911: The infinitesimal generator acts on the variance as:\n912: \n913: $$\n914: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|v_{k,i} - \\bar{v}_k\\|^2 \\right]\n915: $$\n916: \n917: where $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers and $N$ is the total (fixed) swarm size.\n918: \n919: **Step 2: Apply Generator to Centered Velocities**\n920: \n921: For each walker $i \\in A_k$, let $\\tilde{v}_{k,i} = v_{k,i} - \\bar{v}_k$. The generator acting on $f_i = \\|\\tilde{v}_{k,i}\\|^2$ with the **It\u00f4 drift** (including the correction term from Lemma [](#lem-ito-correction-bound)) is:\n922: \n923: $$\n924: \\mathcal{L} f_i = 2 \\langle \\tilde{v}_{k,i}, [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\rangle + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k))\n925: $$\n926: \n927: where we used $\\nabla f_i = 2\\tilde{v}_{k,i}$ and $\\nabla^2 f_i = 2I_d$.\n928: \n929: **Step 3: Analyze Drift Term**\n930: \n931: $$\n932: \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\langle v_{k,i} - \\bar{v}_k, v_{k,i} \\rangle = -\\gamma \\|v_{k,i}\\|^2 + \\gamma \\langle \\bar{v}_k, v_{k,i} \\rangle\n933: $$\n934: \n935: When we sum over all walkers: $\\sum_{i \\in A_k} \\langle \\bar{v}_k, v_{k,i} \\rangle = N_k \\|\\bar{v}_k\\|^2$ (by definition of $\\bar{v}_k$).\n936: \n937: Also: $\\sum_{i \\in A_k} \\|v_{k,i}\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i} + \\bar{v}_k\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 + N_k \\|\\bar{v}_k\\|^2$.\n938: \n939: Therefore:\n940: \n941: $$\n942: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 = -\\gamma N \\cdot V_{\\text{Var},v}(S_k)\n943: $$\n944: \n945: where we used the definition $V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2$.\n946: \n947: The force term $\\sum_i \\langle \\tilde{v}_{k,i}, F(x_{k,i}) \\rangle$ is bounded by Cauchy-Schwarz: $|\\langle \\tilde{v}, F \\rangle| \\le \\|F\\|_{\\infty} \\sqrt{N \\cdot V_{\\text{Var},v}}$, which can be absorbed into the friction by Young's inequality for sufficiently large $\\gamma$.\n948: \n949: **It\u00f4 correction contribution**: By Lemma [](#lem-ito-correction-bound), $\\|b_{\\text{correction}}\\| \\le C_{\\text{It\u00f4}}$, so:\n950: \n951: $$\n952: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k) \\rangle \\le N_k \\sqrt{V_{\\text{Var},v}} \\cdot C_{\\text{It\u00f4}}\n953: $$\n954: \n955: This is bounded by $N C_{\\text{It\u00f4}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}$ (by Young's inequality with $\\epsilon = 1/(4\\gamma)$), which contributes to the additive constant and slightly modifies the friction rate.\n956: \n957: **Step 4: Analyze Diffusion Term (KEY: N-uniformity)**\n958: \n959: $$\n960: \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) \\le \\sum_{i \\in A_k} c_{\\max} d = N_k \\cdot c_{\\max} d\n961: $$\n962: \n963: **Step 5: Combine and Normalize**\n964: \n965: $$\n966: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 \\right]\n967: $$\n968: \n969: $$\n970: = \\frac{1}{N} \\sum_{i \\in A_k} \\mathcal{L}[\\|\\tilde{v}_{k,i}\\|^2]\n971: $$\n972: \n973: $$\n974: = \\frac{1}{N} \\sum_{i \\in A_k} \\left[ -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}}) \\right]\n975: $$\n976: \n977: From Step 3, $\\sum_{i \\in A_k} -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 = -2\\gamma N \\cdot V_{\\text{Var},v}(S_k)$, so:\n978: \n979: $$\n980: = \\frac{1}{N} \\cdot (-2\\gamma N \\cdot V_{\\text{Var},v}(S_k)) + \\frac{1}{N} \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n981: $$\n982: \n983: $$\n984: = -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n985: $$\n986: \n987: $$\n988: \\le -2\\gamma V_{\\text{Var},v}(S_k) + c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n989: $$\n990: \n991: since $N_k \\le N$.\n992: \n993: **CRITICAL OBSERVATION**: With normalization by the total swarm size $N$, the diffusion term is bounded by $\\frac{N_k}{N} c_{\\max} d \\le c_{\\max} d$, which is **independent of both $N$ and $N_k$**. This establishes N-uniformity without requiring exact cancellation.\n994: \n995: **Step 6: Assemble Full Drift (Including It\u00f4 Correction)**\n996: \n997: Combining Steps 3-5, the full drift for $V_{\\text{Var},v}(S_k)$ is:\n998: \n999: $$\n1000: \\mathcal{L} V_{\\text{Var},v}(S_k) \\le -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + NC_{\\text{It\u00f4}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}(S_k) + O(\\|F\\|_\\infty)\n1001: $$\n1002: \n1003: Collecting the $V_{\\text{Var},v}$ terms:\n1004: \n1005: $$\n1006: \\le -(2\\gamma - \\frac{1}{4\\gamma}) V_{\\text{Var},v}(S_k) + c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)\n1007: $$\n1008: \n1009: For $\\gamma \\ge 1/2$, we have $2\\gamma - 1/(4\\gamma) \\ge \\gamma$. Define the effective friction rate:\n1010: \n1011: $$\n1012: \\kappa'_v := 2\\gamma - \\frac{1}{4\\gamma} \\ge \\gamma \\quad \\text{(for $\\gamma \\ge 1/2$)}\n1013: $$\n1014: \n1015: **Step 7: Coupled Sum**\n1016: \n1017: For the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$:\n1018: \n1019: $$\n1020: \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) \\le -\\kappa'_v V_{\\text{Var},v}(S_1, S_2) + 2[c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)]\n1021: $$\n1022: \n1023: **Step 8: Discrete-Time Conversion**\n1024: \n1025: By the discretization theorem (Theorem 1.7.2 from `04_convergence.md`):\n1026: \n1027: $$\n1028: \\mathbb{E}[V_{\\text{Var},v}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{Var},v}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) + O(\\tau^2)\n1029: $$\n1030: \n1031: Setting $C'_v = 2[c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)]$ (independent of $N$ since $C_{\\text{It\u00f4}}$ is N-uniform):\n1032: \n1033: $$\n1034: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\le -\\kappa'_v \\tau V_{\\text{Var},v} + C'_v \\tau\n1035: $$\n1036: \n1037: where $\\kappa'_v = 2\\gamma - 1/(4\\gamma) \\ge \\gamma$ for $\\gamma \\ge 1/2$.\n1038: "
    },
    {
      "directive_type": "definition",
      "label": "def-d-hypocoercive-norm",
      "title": "Hypocoercive Norm (from `04_convergence.md`)",
      "start_line": 1058,
      "end_line": 1074,
      "header_lines": [
        1059
      ],
      "content_start": 1061,
      "content_end": 1073,
      "content": "1061: :label: def-d-hypocoercive-norm\n1062: \n1063: For phase-space differences $(\\Delta x, \\Delta v) \\in \\mathbb{R}^{2d}$, the **hypocoercive norm squared** is:\n1064: \n1065: $$\n1066: \\|(\\Delta x, \\Delta v)\\|_h^2 = \\|\\Delta x\\|^2 + \\lambda_v \\|\\Delta v\\|^2 + b \\langle \\Delta x, \\Delta v \\rangle\n1067: $$\n1068: \n1069: where:\n1070: - $\\lambda_v > 0$: Velocity weight (typically $\\lambda_v \\sim 1/\\gamma$)\n1071: - $b \\in \\mathbb{R}$: Coupling coefficient (chosen for optimal contraction)\n1072: \n1073: **Positive definiteness**: Requires $\\lambda_v > b^2/4$.",
      "metadata": {
        "label": "def-d-hypocoercive-norm"
      },
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1058: #### 3.2.1. The Hypocoercive Norm (Review)\n1059: \n1060: :::{prf:definition} Hypocoercive Norm (from `04_convergence.md`)\n1061: :label: def-d-hypocoercive-norm\n1062: \n1063: For phase-space differences $(\\Delta x, \\Delta v) \\in \\mathbb{R}^{2d}$, the **hypocoercive norm squared** is:\n1064: \n1065: $$\n1066: \\|(\\Delta x, \\Delta v)\\|_h^2 = \\|\\Delta x\\|^2 + \\lambda_v \\|\\Delta v\\|^2 + b \\langle \\Delta x, \\Delta v \\rangle\n1067: $$\n1068: \n1069: where:\n1070: - $\\lambda_v > 0$: Velocity weight (typically $\\lambda_v \\sim 1/\\gamma$)\n1071: - $b \\in \\mathbb{R}$: Coupling coefficient (chosen for optimal contraction)\n1072: \n1073: **Positive definiteness**: Requires $\\lambda_v > b^2/4$.\n1074: "
    },
    {
      "directive_type": "remark",
      "label": "rem-coupling-essential",
      "title": "Why Coupling is Essential",
      "start_line": 1076,
      "end_line": 1086,
      "header_lines": [
        1077
      ],
      "content_start": 1079,
      "content_end": 1085,
      "content": "1079: :label: rem-coupling-essential\n1080: \n1081: The cross term $b \\langle \\Delta x, \\Delta v \\rangle$ is **crucial for hypocoercivity**:\n1082: \n1083: - **Without coupling** ($b = 0$): Position and velocity errors are independent. Since noise acts only on $v$, the position error $\\|\\Delta x\\|^2$ has **no direct dissipation**.\n1084: \n1085: - **With coupling** ($b \\neq 0$): The position error is \"rotated\" into the velocity space via the coupling. The velocity noise then dissipates the rotated error, which propagates back to positions via $\\dot{x} = v$.",
      "metadata": {
        "label": "rem-coupling-essential"
      },
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1076: :::\n1077: \n1078: :::{prf:remark} Why Coupling is Essential\n1079: :label: rem-coupling-essential\n1080: \n1081: The cross term $b \\langle \\Delta x, \\Delta v \\rangle$ is **crucial for hypocoercivity**:\n1082: \n1083: - **Without coupling** ($b = 0$): Position and velocity errors are independent. Since noise acts only on $v$, the position error $\\|\\Delta x\\|^2$ has **no direct dissipation**.\n1084: \n1085: - **With coupling** ($b \\neq 0$): The position error is \"rotated\" into the velocity space via the coupling. The velocity noise then dissipates the rotated error, which propagates back to positions via $\\dot{x} = v$.\n1086: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-location-error-anisotropic",
      "title": "Location Error Contraction (Anisotropic)",
      "start_line": 1118,
      "end_line": 1131,
      "header_lines": [
        1119
      ],
      "content_start": 1121,
      "content_end": 1130,
      "content": "1121: :label: thm-location-error-anisotropic\n1122: \n1123: The location error $V_{\\text{loc}}(S_1, S_2) = \\|(\\Delta \\mu_x, \\Delta \\mu_v)\\|_h^2$ satisfies:\n1124: \n1125: $$\n1126: \\mathbb{E}[\\Delta V_{\\text{loc}}] \\le -\\kappa_{\\text{loc}} \\tau V_{\\text{loc}} + C_{\\text{loc}} \\tau\n1127: $$\n1128: \n1129: where:\n1130: - $\\kappa_{\\text{loc}} = O(\\min\\{\\gamma, c_{\\min}\\}) > 0$ is the hypocoercive contraction rate",
      "metadata": {
        "label": "thm-location-error-anisotropic"
      },
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1118: #### 3.2.3. Location Error Drift (Anisotropic Case)\n1119: \n1120: :::{prf:theorem} Location Error Contraction (Anisotropic)\n1121: :label: thm-location-error-anisotropic\n1122: \n1123: The location error $V_{\\text{loc}}(S_1, S_2) = \\|(\\Delta \\mu_x, \\Delta \\mu_v)\\|_h^2$ satisfies:\n1124: \n1125: $$\n1126: \\mathbb{E}[\\Delta V_{\\text{loc}}] \\le -\\kappa_{\\text{loc}} \\tau V_{\\text{loc}} + C_{\\text{loc}} \\tau\n1127: $$\n1128: \n1129: where:\n1130: - $\\kappa_{\\text{loc}} = O(\\min\\{\\gamma, c_{\\min}\\}) > 0$ is the hypocoercive contraction rate\n1131: - $C_{\\text{loc}} = O(c_{\\max}^2 + n_{\\text{status}})$ is the expansion from noise and status changes"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-359",
      "title": null,
      "start_line": 1133,
      "end_line": 1388,
      "header_lines": [],
      "content_start": 1134,
      "content_end": 1387,
      "content": "1134: \n1135: :::{prf:proof}\n1136: This proof provides a complete, self-contained drift matrix analysis for the anisotropic case.\n1137: \n1138: **Preliminaries: The Infinitesimal Generator**\n1139: \n1140: For the coupled $2N$-particle kinetic process, the infinitesimal generator is:\n1141: \n1142: $$\n1143: \\mathcal{L} = \\sum_{k=1,2} \\sum_{i \\in A_k} \\left[ v_{k,i} \\cdot \\nabla_{x_{k,i}} + [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\cdot \\nabla_{v_{k,i}} + \\frac{1}{2} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k) \\nabla^2_{v_{k,i}}) \\right]\n1144: $$\n1145: \n1146: where:\n1147: - $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers in swarm $k$\n1148: - $D_{\\text{reg}}(x_{k,i}, S_k) = \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\Sigma_{\\text{reg}}(x_{k,i}, S_k)^T$ is the diffusion matrix\n1149: - $b_{\\text{correction}}$ is the It\u00f4 correction term from Lemma [](#lem-ito-correction-bound)\n1150: - $\\nabla_{x_{k,i}}, \\nabla_{v_{k,i}}$ are gradients with respect to walker $i$ in swarm $k$\n1151: - $\\nabla^2_{v_{k,i}}$ is the Hessian with respect to velocity (note: no diffusion in position)\n1152: \n1153: We apply this generator to the location error $V_{\\text{loc}}(S_1, S_2) = z^T Q z$ where $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T$ is the barycenter difference.\n1154: \n1155: **Step 1: State Vector and Dynamics**\n1156: \n1157: Define the barycenter difference vector $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T \\in \\mathbb{R}^{2d}$ where:\n1158: \n1159: $$\n1160: \\Delta \\mu_x = \\bar{x}_1 - \\bar{x}_2, \\quad \\Delta \\mu_v = \\bar{v}_1 - \\bar{v}_2\n1161: $$\n1162: \n1163: For swarm $k$, the barycenters evolve as (Stratonovich form):\n1164: \n1165: $$\n1166: d\\bar{x}_k = \\bar{v}_k \\, dt\n1167: $$\n1168: \n1169: $$\n1170: d\\bar{v}_k = \\left[ \\bar{F}_k - \\gamma \\bar{v}_k + \\bar{b}_{\\text{correction},k} \\right] dt + \\frac{1}{N_k} \\sum_{i \\in A_k} \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n1171: $$\n1172: \n1173: where $\\bar{F}_k = \\frac{1}{N_k} \\sum_{i \\in A_k} F(x_{k,i})$ is the average force and $\\bar{b}_{\\text{correction},k} = \\frac{1}{N_k} \\sum_{i \\in A_k} b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)$ is the average It\u00f4 correction.\n1174: \n1175: Taking differences:\n1176: \n1177: $$\n1178: \\frac{d}{dt} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} + \\text{(noise difference)}\n1179: $$\n1180: \n1181: where $\\Delta \\bar{b}_{\\text{correction}} = \\bar{b}_{\\text{correction},1} - \\bar{b}_{\\text{correction},2}$ is bounded by $2C_{\\text{It\u00f4}}$ (Lemma [](#lem-ito-correction-bound)).\n1182: \n1183: Define the drift matrix:\n1184: \n1185: $$\n1186: M = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix}\n1187: $$\n1188: \n1189: **Step 2: Hypocoercive Quadratic Form**\n1190: \n1191: The location error is $V_{\\text{loc}} = z^T Q z$ with the hypocoercive weight matrix:\n1192: \n1193: $$\n1194: Q = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix}\n1195: $$\n1196: \n1197: where $\\lambda_v > 0$ weights velocity error and $b \\in \\mathbb{R}$ couples position and velocity errors.\n1198: \n1199: **Positive definiteness**: Requires $\\lambda_v > b^2/4$ (Sylvester's criterion).\n1200: \n1201: **Step 3: Generator Applied to Quadratic Form**\n1202: \n1203: The infinitesimal generator acting on $V_{\\text{loc}}(z) = z^T Q z$ is:\n1204: \n1205: $$\n1206: \\mathcal{L} V_{\\text{loc}} = 2 z^T Q \\left[ M z + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} \\right] + \\text{Tr}\\left( \\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}} \\right)\n1207: $$\n1208: \n1209: where $\\bar{D}_{\\text{noise}}$ is the covariance of the noise difference (computed below) and $\\Delta \\bar{b}_{\\text{correction}}$ is the difference in average It\u00f4 corrections.\n1210: \n1211: **Step 3a: Drift Term (Deterministic)**\n1212: \n1213: The drift from $M$ is:\n1214: \n1215: $$\n1216: z^T (M^T Q + Q M) z\n1217: $$\n1218: \n1219: Compute the drift matrix $\\mathcal{D} = M^T Q + Q M$:\n1220: \n1221: $$\n1222: M^T Q = \\begin{bmatrix} 0 & 0 \\\\ I_d & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ I_d - \\frac{b\\gamma}{2}I_d & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1223: $$\n1224: \n1225: $$\n1226: Q M = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} = \\begin{bmatrix} 0 & I_d - \\frac{b\\gamma}{2}I_d \\\\ 0 & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1227: $$\n1228: \n1229: $$\n1230: \\mathcal{D} = M^T Q + Q M = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ (1 - \\frac{b\\gamma}{2})I_d & (b - 2\\gamma\\lambda_v)I_d \\end{bmatrix}\n1231: $$\n1232: \n1233: **Step 3b: Force and It\u00f4 Correction Contribution**\n1234: \n1235: $$\n1236: 2 z^T Q \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} = 2 (\\Delta \\mu_x, \\Delta \\mu_v) \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix}\n1237: $$\n1238: \n1239: $$\n1240: = b \\langle \\Delta \\mu_x, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle + 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle\n1241: $$\n1242: \n1243: By Lipschitz continuity of $F(x) = -\\nabla U(x)$ (from coercivity Axiom 1.3.1):\n1244: \n1245: $$\n1246: \\|\\Delta \\bar{F}\\| \\le L_F \\|\\Delta \\mu_x\\| + O(1/\\sqrt{N})\n1247: $$\n1248: \n1249: By Lemma [](#lem-ito-correction-bound):\n1250: \n1251: $$\n1252: \\|\\Delta \\bar{b}_{\\text{correction}}\\| \\le 2C_{\\text{It\u00f4}}\n1253: $$\n1254: \n1255: Using Cauchy-Schwarz and Young's inequality $2ab \\le \\epsilon a^2 + b^2/\\epsilon$:\n1256: \n1257: $$\n1258: b \\langle \\Delta \\mu_x, \\Delta \\bar{F} \\rangle \\le |b| L_F \\|\\Delta \\mu_x\\|^2 + O(1/\\sqrt{N})\n1259: $$\n1260: \n1261: $$\n1262: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} \\rangle \\le 2\\lambda_v L_F \\|\\Delta \\mu_x\\| \\|\\Delta \\mu_v\\| \\le \\lambda_v L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2)\n1263: $$\n1264: \n1265: **It\u00f4 correction terms**: Similarly,\n1266: \n1267: $$\n1268: b \\langle \\Delta \\mu_x, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le |b| C_{\\text{It\u00f4}} \\|\\Delta \\mu_x\\|\n1269: $$\n1270: \n1271: $$\n1272: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le 2\\lambda_v C_{\\text{It\u00f4}} \\|\\Delta \\mu_v\\|\n1273: $$\n1274: \n1275: These contribute $O(C_{\\text{It\u00f4}})$ to the additive constant after Young's inequality.\n1276: \n1277: **Step 3c: Noise Contribution (ANISOTROPIC CASE - KEY)**\n1278: \n1279: The noise difference has covariance (per unit time):\n1280: \n1281: $$\n1282: \\bar{D}_{\\text{noise}} = \\text{blockdiag}\\left( 0_d, \\frac{1}{N_1} \\sum_{i \\in A_1} D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_{j \\in A_2} D_{\\text{reg}}(x_{2,j}, S_2) \\right)\n1283: $$\n1284: \n1285: The contribution to the generator is:\n1286: \n1287: $$\n1288: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) = \\text{Tr}(\\bar{D}_{\\text{noise}} \\cdot 2Q)\n1289: $$\n1290: \n1291: Since noise acts only on velocities:\n1292: \n1293: $$\n1294: = 2 \\text{Tr}\\left( \\left[ \\frac{1}{N_1} \\sum_i D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_j D_{\\text{reg}}(x_{2,j}, S_2) \\right] \\lambda_v I_d \\right)\n1295: $$\n1296: \n1297: $$\n1298: = 2\\lambda_v \\left[ \\frac{1}{N_1} \\sum_i \\text{Tr}(D_{\\text{reg}}(x_{1,i}, S_1)) + \\frac{1}{N_2} \\sum_j \\text{Tr}(D_{\\text{reg}}(x_{2,j}, S_2)) \\right]\n1299: $$\n1300: \n1301: By uniform ellipticity $c_{\\min} I \\preceq D_{\\text{reg}} \\preceq c_{\\max} I$:\n1302: \n1303: $$\n1304: c_{\\min} d \\le \\text{Tr}(D_{\\text{reg}}(x,S)) \\le c_{\\max} d\n1305: $$\n1306: \n1307: Therefore:\n1308: \n1309: $$\n1310: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) \\le 2\\lambda_v \\cdot 2 c_{\\max} d = 4\\lambda_v c_{\\max} d\n1311: $$\n1312: \n1313: **CRITICAL**: This bound is **independent of $N$** because the $1/N_k$ factor in $\\bar{D}_{\\text{noise}}$ cancels the sum over $N_k$ walkers.\n1314: \n1315: **Step 4: Combined Drift Inequality**\n1316: \n1317: $$\n1318: \\mathcal{L} V_{\\text{loc}} \\le z^T \\mathcal{D} z + (|b| + \\lambda_v) L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2) + 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N})\n1319: $$\n1320: \n1321: **Step 5: Optimal Parameter Choice**\n1322: \n1323: Following the hypocoercivity analysis from `04_convergence.md` (Lemma 2.5.1), choose:\n1324: \n1325: $$\n1326: \\lambda_v = \\frac{1}{\\gamma}, \\quad b = \\frac{2}{\\sqrt{\\gamma}}\n1327: $$\n1328: \n1329: This gives near-critical damping. With these values:\n1330: \n1331: $$\n1332: \\mathcal{D} = \\begin{bmatrix} 0 & (1 - \\frac{1}{\\sqrt{\\gamma}})I_d \\\\ (1 - \\frac{1}{\\sqrt{\\gamma}})I_d & (\\frac{2}{\\sqrt{\\gamma}} - \\frac{2}{\\gamma})I_d \\end{bmatrix}\n1333: $$\n1334: \n1335: **Step 6: Eigenvalue Analysis of Effective Drift Matrix**\n1336: \n1337: Define the **effective drift matrix** including force perturbation:\n1338: \n1339: $$\n1340: \\mathcal{D}_{\\text{eff}} = \\mathcal{D} + (|b| + \\lambda_v) L_F \\cdot I_{2d}\n1341: $$\n1342: \n1343: The eigenvalues of $\\mathcal{D}$ (in the limit $\\gamma \\to \\infty$ for simplicity) are approximately:\n1344: \n1345: $$\n1346: \\lambda_{\\pm} \\approx -\\frac{\\gamma}{2} \\pm i\\omega\n1347: $$\n1348: \n1349: where $\\omega$ is the oscillation frequency. The **real part** is negative: $\\text{Re}(\\lambda) \\approx -\\gamma/2$.\n1350: \n1351: Adding the force perturbation shifts eigenvalues by at most $O(L_F)$. For sufficiently large $\\gamma > L_F$:\n1352: \n1353: $$\n1354: \\text{Re}(\\lambda_{\\text{min}}(\\mathcal{D}_{\\text{eff}})) \\le -\\frac{\\gamma}{4} < 0\n1355: $$\n1356: \n1357: This gives the contraction rate:\n1358: \n1359: $$\n1360: z^T \\mathcal{D}_{\\text{eff}} z \\le -\\kappa_{\\text{hypo}} \\|z\\|^2\n1361: $$\n1362: \n1363: where $\\kappa_{\\text{hypo}} = O(\\min\\{\\gamma, c_{\\min}\\})$.\n1364: \n1365: **WHY $c_{\\min}$ APPEARS**: The noise term contributes $4\\lambda_v c_{\\max} d$ to the expansion. For the Lyapunov function to decay, the contraction $-\\kappa_{\\text{hypo}} V_{\\text{loc}}$ must dominate. The effective contraction is:\n1366: \n1367: $$\n1368: \\kappa_{\\text{loc}} = \\kappa_{\\text{hypo}} - \\frac{4\\lambda_v c_{\\max} d}{V_{\\text{loc}}}\n1369: $$\n1370: \n1371: For large $V_{\\text{loc}}$, this is positive. For bounded $V_{\\text{loc}}$, we need $\\kappa_{\\text{hypo}} \\ge c_{\\text{threshold}}$ to ensure net contraction. By analyzing the full dynamics, this threshold is $O(c_{\\min})$ (the minimum noise strength required for hypocoercive coupling).\n1372: \n1373: **Step 7: Discrete-Time Result**\n1374: \n1375: By the It\u00f4-to-discretization theorem:\n1376: \n1377: $$\n1378: \\mathbb{E}[V_{\\text{loc}}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{loc}}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{loc}}(S_1, S_2) + O(\\tau^2)\n1379: $$\n1380: \n1381: $$\n1382: \\le (1 - \\kappa_{\\text{loc}} \\tau) V_{\\text{loc}}(S_1, S_2) + C_{\\text{loc}} \\tau\n1383: $$\n1384: \n1385: where:\n1386: - $\\kappa_{\\text{loc}} = O(\\min\\{\\gamma, c_{\\min}\\})$\n1387: - $C_{\\text{loc}} = 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N}) = O(c_{\\max})$ (N-uniform)",
      "metadata": {},
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1133: :::\n1134: \n1135: :::{prf:proof}\n1136: This proof provides a complete, self-contained drift matrix analysis for the anisotropic case.\n1137: \n1138: **Preliminaries: The Infinitesimal Generator**\n1139: \n1140: For the coupled $2N$-particle kinetic process, the infinitesimal generator is:\n1141: \n1142: $$\n1143: \\mathcal{L} = \\sum_{k=1,2} \\sum_{i \\in A_k} \\left[ v_{k,i} \\cdot \\nabla_{x_{k,i}} + [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\cdot \\nabla_{v_{k,i}} + \\frac{1}{2} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k) \\nabla^2_{v_{k,i}}) \\right]\n1144: $$\n1145: \n1146: where:\n1147: - $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers in swarm $k$\n1148: - $D_{\\text{reg}}(x_{k,i}, S_k) = \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\Sigma_{\\text{reg}}(x_{k,i}, S_k)^T$ is the diffusion matrix\n1149: - $b_{\\text{correction}}$ is the It\u00f4 correction term from Lemma [](#lem-ito-correction-bound)\n1150: - $\\nabla_{x_{k,i}}, \\nabla_{v_{k,i}}$ are gradients with respect to walker $i$ in swarm $k$\n1151: - $\\nabla^2_{v_{k,i}}$ is the Hessian with respect to velocity (note: no diffusion in position)\n1152: \n1153: We apply this generator to the location error $V_{\\text{loc}}(S_1, S_2) = z^T Q z$ where $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T$ is the barycenter difference.\n1154: \n1155: **Step 1: State Vector and Dynamics**\n1156: \n1157: Define the barycenter difference vector $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T \\in \\mathbb{R}^{2d}$ where:\n1158: \n1159: $$\n1160: \\Delta \\mu_x = \\bar{x}_1 - \\bar{x}_2, \\quad \\Delta \\mu_v = \\bar{v}_1 - \\bar{v}_2\n1161: $$\n1162: \n1163: For swarm $k$, the barycenters evolve as (Stratonovich form):\n1164: \n1165: $$\n1166: d\\bar{x}_k = \\bar{v}_k \\, dt\n1167: $$\n1168: \n1169: $$\n1170: d\\bar{v}_k = \\left[ \\bar{F}_k - \\gamma \\bar{v}_k + \\bar{b}_{\\text{correction},k} \\right] dt + \\frac{1}{N_k} \\sum_{i \\in A_k} \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n1171: $$\n1172: \n1173: where $\\bar{F}_k = \\frac{1}{N_k} \\sum_{i \\in A_k} F(x_{k,i})$ is the average force and $\\bar{b}_{\\text{correction},k} = \\frac{1}{N_k} \\sum_{i \\in A_k} b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)$ is the average It\u00f4 correction.\n1174: \n1175: Taking differences:\n1176: \n1177: $$\n1178: \\frac{d}{dt} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} + \\text{(noise difference)}\n1179: $$\n1180: \n1181: where $\\Delta \\bar{b}_{\\text{correction}} = \\bar{b}_{\\text{correction},1} - \\bar{b}_{\\text{correction},2}$ is bounded by $2C_{\\text{It\u00f4}}$ (Lemma [](#lem-ito-correction-bound)).\n1182: \n1183: Define the drift matrix:\n1184: \n1185: $$\n1186: M = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix}\n1187: $$\n1188: \n1189: **Step 2: Hypocoercive Quadratic Form**\n1190: \n1191: The location error is $V_{\\text{loc}} = z^T Q z$ with the hypocoercive weight matrix:\n1192: \n1193: $$\n1194: Q = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix}\n1195: $$\n1196: \n1197: where $\\lambda_v > 0$ weights velocity error and $b \\in \\mathbb{R}$ couples position and velocity errors.\n1198: \n1199: **Positive definiteness**: Requires $\\lambda_v > b^2/4$ (Sylvester's criterion).\n1200: \n1201: **Step 3: Generator Applied to Quadratic Form**\n1202: \n1203: The infinitesimal generator acting on $V_{\\text{loc}}(z) = z^T Q z$ is:\n1204: \n1205: $$\n1206: \\mathcal{L} V_{\\text{loc}} = 2 z^T Q \\left[ M z + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} \\right] + \\text{Tr}\\left( \\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}} \\right)\n1207: $$\n1208: \n1209: where $\\bar{D}_{\\text{noise}}$ is the covariance of the noise difference (computed below) and $\\Delta \\bar{b}_{\\text{correction}}$ is the difference in average It\u00f4 corrections.\n1210: \n1211: **Step 3a: Drift Term (Deterministic)**\n1212: \n1213: The drift from $M$ is:\n1214: \n1215: $$\n1216: z^T (M^T Q + Q M) z\n1217: $$\n1218: \n1219: Compute the drift matrix $\\mathcal{D} = M^T Q + Q M$:\n1220: \n1221: $$\n1222: M^T Q = \\begin{bmatrix} 0 & 0 \\\\ I_d & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ I_d - \\frac{b\\gamma}{2}I_d & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1223: $$\n1224: \n1225: $$\n1226: Q M = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} = \\begin{bmatrix} 0 & I_d - \\frac{b\\gamma}{2}I_d \\\\ 0 & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1227: $$\n1228: \n1229: $$\n1230: \\mathcal{D} = M^T Q + Q M = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ (1 - \\frac{b\\gamma}{2})I_d & (b - 2\\gamma\\lambda_v)I_d \\end{bmatrix}\n1231: $$\n1232: \n1233: **Step 3b: Force and It\u00f4 Correction Contribution**\n1234: \n1235: $$\n1236: 2 z^T Q \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} = 2 (\\Delta \\mu_x, \\Delta \\mu_v) \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix}\n1237: $$\n1238: \n1239: $$\n1240: = b \\langle \\Delta \\mu_x, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle + 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle\n1241: $$\n1242: \n1243: By Lipschitz continuity of $F(x) = -\\nabla U(x)$ (from coercivity Axiom 1.3.1):\n1244: \n1245: $$\n1246: \\|\\Delta \\bar{F}\\| \\le L_F \\|\\Delta \\mu_x\\| + O(1/\\sqrt{N})\n1247: $$\n1248: \n1249: By Lemma [](#lem-ito-correction-bound):\n1250: \n1251: $$\n1252: \\|\\Delta \\bar{b}_{\\text{correction}}\\| \\le 2C_{\\text{It\u00f4}}\n1253: $$\n1254: \n1255: Using Cauchy-Schwarz and Young's inequality $2ab \\le \\epsilon a^2 + b^2/\\epsilon$:\n1256: \n1257: $$\n1258: b \\langle \\Delta \\mu_x, \\Delta \\bar{F} \\rangle \\le |b| L_F \\|\\Delta \\mu_x\\|^2 + O(1/\\sqrt{N})\n1259: $$\n1260: \n1261: $$\n1262: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} \\rangle \\le 2\\lambda_v L_F \\|\\Delta \\mu_x\\| \\|\\Delta \\mu_v\\| \\le \\lambda_v L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2)\n1263: $$\n1264: \n1265: **It\u00f4 correction terms**: Similarly,\n1266: \n1267: $$\n1268: b \\langle \\Delta \\mu_x, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le |b| C_{\\text{It\u00f4}} \\|\\Delta \\mu_x\\|\n1269: $$\n1270: \n1271: $$\n1272: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le 2\\lambda_v C_{\\text{It\u00f4}} \\|\\Delta \\mu_v\\|\n1273: $$\n1274: \n1275: These contribute $O(C_{\\text{It\u00f4}})$ to the additive constant after Young's inequality.\n1276: \n1277: **Step 3c: Noise Contribution (ANISOTROPIC CASE - KEY)**\n1278: \n1279: The noise difference has covariance (per unit time):\n1280: \n1281: $$\n1282: \\bar{D}_{\\text{noise}} = \\text{blockdiag}\\left( 0_d, \\frac{1}{N_1} \\sum_{i \\in A_1} D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_{j \\in A_2} D_{\\text{reg}}(x_{2,j}, S_2) \\right)\n1283: $$\n1284: \n1285: The contribution to the generator is:\n1286: \n1287: $$\n1288: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) = \\text{Tr}(\\bar{D}_{\\text{noise}} \\cdot 2Q)\n1289: $$\n1290: \n1291: Since noise acts only on velocities:\n1292: \n1293: $$\n1294: = 2 \\text{Tr}\\left( \\left[ \\frac{1}{N_1} \\sum_i D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_j D_{\\text{reg}}(x_{2,j}, S_2) \\right] \\lambda_v I_d \\right)\n1295: $$\n1296: \n1297: $$\n1298: = 2\\lambda_v \\left[ \\frac{1}{N_1} \\sum_i \\text{Tr}(D_{\\text{reg}}(x_{1,i}, S_1)) + \\frac{1}{N_2} \\sum_j \\text{Tr}(D_{\\text{reg}}(x_{2,j}, S_2)) \\right]\n1299: $$\n1300: \n1301: By uniform ellipticity $c_{\\min} I \\preceq D_{\\text{reg}} \\preceq c_{\\max} I$:\n1302: \n1303: $$\n1304: c_{\\min} d \\le \\text{Tr}(D_{\\text{reg}}(x,S)) \\le c_{\\max} d\n1305: $$\n1306: \n1307: Therefore:\n1308: \n1309: $$\n1310: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) \\le 2\\lambda_v \\cdot 2 c_{\\max} d = 4\\lambda_v c_{\\max} d\n1311: $$\n1312: \n1313: **CRITICAL**: This bound is **independent of $N$** because the $1/N_k$ factor in $\\bar{D}_{\\text{noise}}$ cancels the sum over $N_k$ walkers.\n1314: \n1315: **Step 4: Combined Drift Inequality**\n1316: \n1317: $$\n1318: \\mathcal{L} V_{\\text{loc}} \\le z^T \\mathcal{D} z + (|b| + \\lambda_v) L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2) + 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N})\n1319: $$\n1320: \n1321: **Step 5: Optimal Parameter Choice**\n1322: \n1323: Following the hypocoercivity analysis from `04_convergence.md` (Lemma 2.5.1), choose:\n1324: \n1325: $$\n1326: \\lambda_v = \\frac{1}{\\gamma}, \\quad b = \\frac{2}{\\sqrt{\\gamma}}\n1327: $$\n1328: \n1329: This gives near-critical damping. With these values:\n1330: \n1331: $$\n1332: \\mathcal{D} = \\begin{bmatrix} 0 & (1 - \\frac{1}{\\sqrt{\\gamma}})I_d \\\\ (1 - \\frac{1}{\\sqrt{\\gamma}})I_d & (\\frac{2}{\\sqrt{\\gamma}} - \\frac{2}{\\gamma})I_d \\end{bmatrix}\n1333: $$\n1334: \n1335: **Step 6: Eigenvalue Analysis of Effective Drift Matrix**\n1336: \n1337: Define the **effective drift matrix** including force perturbation:\n1338: \n1339: $$\n1340: \\mathcal{D}_{\\text{eff}} = \\mathcal{D} + (|b| + \\lambda_v) L_F \\cdot I_{2d}\n1341: $$\n1342: \n1343: The eigenvalues of $\\mathcal{D}$ (in the limit $\\gamma \\to \\infty$ for simplicity) are approximately:\n1344: \n1345: $$\n1346: \\lambda_{\\pm} \\approx -\\frac{\\gamma}{2} \\pm i\\omega\n1347: $$\n1348: \n1349: where $\\omega$ is the oscillation frequency. The **real part** is negative: $\\text{Re}(\\lambda) \\approx -\\gamma/2$.\n1350: \n1351: Adding the force perturbation shifts eigenvalues by at most $O(L_F)$. For sufficiently large $\\gamma > L_F$:\n1352: \n1353: $$\n1354: \\text{Re}(\\lambda_{\\text{min}}(\\mathcal{D}_{\\text{eff}})) \\le -\\frac{\\gamma}{4} < 0\n1355: $$\n1356: \n1357: This gives the contraction rate:\n1358: \n1359: $$\n1360: z^T \\mathcal{D}_{\\text{eff}} z \\le -\\kappa_{\\text{hypo}} \\|z\\|^2\n1361: $$\n1362: \n1363: where $\\kappa_{\\text{hypo}} = O(\\min\\{\\gamma, c_{\\min}\\})$.\n1364: \n1365: **WHY $c_{\\min}$ APPEARS**: The noise term contributes $4\\lambda_v c_{\\max} d$ to the expansion. For the Lyapunov function to decay, the contraction $-\\kappa_{\\text{hypo}} V_{\\text{loc}}$ must dominate. The effective contraction is:\n1366: \n1367: $$\n1368: \\kappa_{\\text{loc}} = \\kappa_{\\text{hypo}} - \\frac{4\\lambda_v c_{\\max} d}{V_{\\text{loc}}}\n1369: $$\n1370: \n1371: For large $V_{\\text{loc}}$, this is positive. For bounded $V_{\\text{loc}}$, we need $\\kappa_{\\text{hypo}} \\ge c_{\\text{threshold}}$ to ensure net contraction. By analyzing the full dynamics, this threshold is $O(c_{\\min})$ (the minimum noise strength required for hypocoercive coupling).\n1372: \n1373: **Step 7: Discrete-Time Result**\n1374: \n1375: By the It\u00f4-to-discretization theorem:\n1376: \n1377: $$\n1378: \\mathbb{E}[V_{\\text{loc}}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{loc}}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{loc}}(S_1, S_2) + O(\\tau^2)\n1379: $$\n1380: \n1381: $$\n1382: \\le (1 - \\kappa_{\\text{loc}} \\tau) V_{\\text{loc}}(S_1, S_2) + C_{\\text{loc}} \\tau\n1383: $$\n1384: \n1385: where:\n1386: - $\\kappa_{\\text{loc}} = O(\\min\\{\\gamma, c_{\\min}\\})$\n1387: - $C_{\\text{loc}} = 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N}) = O(c_{\\max})$ (N-uniform)\n1388: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-structural-error-anisotropic",
      "title": "Structural Error Contraction (Anisotropic)",
      "start_line": 1406,
      "end_line": 1418,
      "header_lines": [
        1407
      ],
      "content_start": 1409,
      "content_end": 1417,
      "content": "1409: :label: thm-structural-error-anisotropic\n1410: \n1411: The structural error $V_{\\text{struct}}(S_1, S_2) = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ (Wasserstein distance between centered measures) satisfies:\n1412: \n1413: $$\n1414: \\mathbb{E}[\\Delta V_{\\text{struct}}] \\le -\\kappa_{\\text{struct}} \\tau V_{\\text{struct}} + C_{\\text{struct}} \\tau\n1415: $$\n1416: \n1417: where:",
      "metadata": {
        "label": "thm-structural-error-anisotropic"
      },
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1406: #### 3.2.4. Structural Error Drift (Anisotropic Case)\n1407: \n1408: :::{prf:theorem} Structural Error Contraction (Anisotropic)\n1409: :label: thm-structural-error-anisotropic\n1410: \n1411: The structural error $V_{\\text{struct}}(S_1, S_2) = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ (Wasserstein distance between centered measures) satisfies:\n1412: \n1413: $$\n1414: \\mathbb{E}[\\Delta V_{\\text{struct}}] \\le -\\kappa_{\\text{struct}} \\tau V_{\\text{struct}} + C_{\\text{struct}} \\tau\n1415: $$\n1416: \n1417: where:\n1418: - $\\kappa_{\\text{struct}} = O(\\min\\{\\gamma, c_{\\min}\\}) > 0$"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-646",
      "title": null,
      "start_line": 1420,
      "end_line": 1502,
      "header_lines": [
        1497
      ],
      "content_start": 1421,
      "content_end": 1501,
      "content": "1421: \n1422: :::{prf:proof}\n1423: This proof adapts the synchronous coupling argument from `04_convergence.md` (Lemma 2.6.1) to handle different noise tensors.\n1424: \n1425: **Step 1: Synchronous Coupling Setup**\n1426: \n1427: For discrete empirical measures, the optimal transport plan is the **synchronous coupling**: match particles by index.\n1428: \n1429: $$\n1430: \\pi^N = \\frac{1}{N} \\sum_{i=1}^N \\delta_{(z_{1,i}, z_{2,i})}\n1431: $$\n1432: \n1433: where $z_{k,i} = (x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})$ are centered coordinates.\n1434: \n1435: The Wasserstein distance is:\n1436: \n1437: $$\n1438: V_{\\text{struct}} = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2) = \\frac{1}{N} \\sum_{i=1}^N \\|z_{1,i} - z_{2,i}\\|_h^2\n1439: $$\n1440: \n1441: **Step 2: Single-Pair Dynamics**\n1442: \n1443: Each particle pair evolves under (Stratonovich form):\n1444: \n1445: $$\n1446: \\begin{aligned}\n1447: dx_{k,i} &= v_{k,i} \\, dt \\\\\n1448: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_i\n1449: \\end{aligned}\n1450: $$\n1451: \n1452: **Challenge**: The noise tensors $\\Sigma_{\\text{reg}}(x_{1,i}, S_1)$ and $\\Sigma_{\\text{reg}}(x_{2,i}, S_2)$ are **different** because the two swarms are in different states.\n1453: \n1454: **Solution**: Use **midpoint coupling**. Evolve both particles with the **average** noise tensor:\n1455: \n1456: $$\n1457: \\Sigma_{\\text{mid},i} = \\frac{1}{2} \\left[ \\Sigma_{\\text{reg}}(x_{1,i}, S_1) + \\Sigma_{\\text{reg}}(x_{2,i}, S_2) \\right]\n1458: $$\n1459: \n1460: **Step 3: Coupling Error Analysis (Rigorous Bound)**\n1461: \n1462: The **coupling error** is the difference between the true dynamics and the midpoint dynamics.\n1463: \n1464: **Step 3a: Define the error process**\n1465: \n1466: For the true SDE of particle difference (Stratonovich):\n1467: \n1468: $$\n1469: d(z_{1,i} - z_{2,i}) = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + [\\Sigma_{\\text{reg}}(x_{1,i}, S_1) - \\Sigma_{\\text{reg}}(x_{2,i}, S_2)] \\circ dW_i\n1470: $$\n1471: \n1472: where $M$ is the drift matrix and $\\Delta F_i = F(x_{1,i}) - F(x_{2,i})$.\n1473: \n1474: Under **midpoint coupling** with shared noise $dW_i$:\n1475: \n1476: $$\n1477: d(z_{1,i} - z_{2,i})_{\\text{mid}} = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + \\Sigma_{\\text{mid},i} \\circ dW_i\n1478: $$\n1479: \n1480: The **coupling error process** is:\n1481: \n1482: $$\n1483: \\text{Error}_i(t) = \\int_0^t \\left[ \\frac{\\Sigma_{\\text{reg}}(x_{1,i}(s), S_1) - \\Sigma_{\\text{reg}}(x_{2,i}(s), S_2)}{2} \\right] \\circ dW_i(s)\n1484: $$\n1485: \n1486: where we used $\\Sigma_{\\text{mid}} = (\\Sigma_1 + \\Sigma_2)/2$.\n1487: \n1488: **Step 3b: Stratonovich Isometry for Variance Bound**\n1489: \n1490: We apply the fundamental isometry property of Stratonovich stochastic integrals. For any adapted matrix-valued process $\\sigma(s)$:\n1491: \n1492: $$\n1493: \\mathbb{E}\\left[\\left\\|\\int_0^t \\sigma(s) \\circ dW_s\\right\\|^2\\right] = \\mathbb{E}\\left[\\int_0^t \\|\\sigma(s)\\|_F^2 ds\\right]\n1494: $$\n1495: \n1496: where $\\|\\cdot\\|_F$ is the Frobenius norm. This is a standard result in stochastic calculus (see Karatzas & Shreve, Brownian Motion and Stochastic Calculus, Theorem 3.3.16).\n1497: \n1498: :::{admonition} Why Stratonovich?\n1499: :class: note\n1500: \n1501: This isometry is **identical** to the It\u00f4 case, but Stratonovich integrals have a key advantage for physics: **geometric invariance under coordinate transformations**. When we later map this result to curved space (Section 8), the Stratonovich formulation ensures the convergence rate remains coordinate-independent.",
      "metadata": {
        "class": "note"
      },
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1420: :::\n1421: \n1422: :::{prf:proof}\n1423: This proof adapts the synchronous coupling argument from `04_convergence.md` (Lemma 2.6.1) to handle different noise tensors.\n1424: \n1425: **Step 1: Synchronous Coupling Setup**\n1426: \n1427: For discrete empirical measures, the optimal transport plan is the **synchronous coupling**: match particles by index.\n1428: \n1429: $$\n1430: \\pi^N = \\frac{1}{N} \\sum_{i=1}^N \\delta_{(z_{1,i}, z_{2,i})}\n1431: $$\n1432: \n1433: where $z_{k,i} = (x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})$ are centered coordinates.\n1434: \n1435: The Wasserstein distance is:\n1436: \n1437: $$\n1438: V_{\\text{struct}} = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2) = \\frac{1}{N} \\sum_{i=1}^N \\|z_{1,i} - z_{2,i}\\|_h^2\n1439: $$\n1440: \n1441: **Step 2: Single-Pair Dynamics**\n1442: \n1443: Each particle pair evolves under (Stratonovich form):\n1444: \n1445: $$\n1446: \\begin{aligned}\n1447: dx_{k,i} &= v_{k,i} \\, dt \\\\\n1448: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_i\n1449: \\end{aligned}\n1450: $$\n1451: \n1452: **Challenge**: The noise tensors $\\Sigma_{\\text{reg}}(x_{1,i}, S_1)$ and $\\Sigma_{\\text{reg}}(x_{2,i}, S_2)$ are **different** because the two swarms are in different states.\n1453: \n1454: **Solution**: Use **midpoint coupling**. Evolve both particles with the **average** noise tensor:\n1455: \n1456: $$\n1457: \\Sigma_{\\text{mid},i} = \\frac{1}{2} \\left[ \\Sigma_{\\text{reg}}(x_{1,i}, S_1) + \\Sigma_{\\text{reg}}(x_{2,i}, S_2) \\right]\n1458: $$\n1459: \n1460: **Step 3: Coupling Error Analysis (Rigorous Bound)**\n1461: \n1462: The **coupling error** is the difference between the true dynamics and the midpoint dynamics.\n1463: \n1464: **Step 3a: Define the error process**\n1465: \n1466: For the true SDE of particle difference (Stratonovich):\n1467: \n1468: $$\n1469: d(z_{1,i} - z_{2,i}) = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + [\\Sigma_{\\text{reg}}(x_{1,i}, S_1) - \\Sigma_{\\text{reg}}(x_{2,i}, S_2)] \\circ dW_i\n1470: $$\n1471: \n1472: where $M$ is the drift matrix and $\\Delta F_i = F(x_{1,i}) - F(x_{2,i})$.\n1473: \n1474: Under **midpoint coupling** with shared noise $dW_i$:\n1475: \n1476: $$\n1477: d(z_{1,i} - z_{2,i})_{\\text{mid}} = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + \\Sigma_{\\text{mid},i} \\circ dW_i\n1478: $$\n1479: \n1480: The **coupling error process** is:\n1481: \n1482: $$\n1483: \\text{Error}_i(t) = \\int_0^t \\left[ \\frac{\\Sigma_{\\text{reg}}(x_{1,i}(s), S_1) - \\Sigma_{\\text{reg}}(x_{2,i}(s), S_2)}{2} \\right] \\circ dW_i(s)\n1484: $$\n1485: \n1486: where we used $\\Sigma_{\\text{mid}} = (\\Sigma_1 + \\Sigma_2)/2$.\n1487: \n1488: **Step 3b: Stratonovich Isometry for Variance Bound**\n1489: \n1490: We apply the fundamental isometry property of Stratonovich stochastic integrals. For any adapted matrix-valued process $\\sigma(s)$:\n1491: \n1492: $$\n1493: \\mathbb{E}\\left[\\left\\|\\int_0^t \\sigma(s) \\circ dW_s\\right\\|^2\\right] = \\mathbb{E}\\left[\\int_0^t \\|\\sigma(s)\\|_F^2 ds\\right]\n1494: $$\n1495: \n1496: where $\\|\\cdot\\|_F$ is the Frobenius norm. This is a standard result in stochastic calculus (see Karatzas & Shreve, Brownian Motion and Stochastic Calculus, Theorem 3.3.16).\n1497: \n1498: :::{admonition} Why Stratonovich?\n1499: :class: note\n1500: \n1501: This isometry is **identical** to the It\u00f4 case, but Stratonovich integrals have a key advantage for physics: **geometric invariance under coordinate transformations**. When we later map this result to curved space (Section 8), the Stratonovich formulation ensures the convergence rate remains coordinate-independent.\n1502: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-hypocoercive-main",
      "title": "Hypocoercive Contraction for Adaptive Gas",
      "start_line": 1627,
      "end_line": 1640,
      "header_lines": [
        1628
      ],
      "content_start": 1630,
      "content_end": 1639,
      "content": "1630: :label: thm-hypocoercive-main\n1631: \n1632: The inter-swarm Wasserstein distance $V_W(S_1, S_2) = V_{\\text{loc}} + V_{\\text{struct}}$ satisfies:\n1633: \n1634: $$\n1635: \\mathbb{E}[\\Delta V_W] \\le -\\kappa'_W \\tau V_W + C'_W \\tau\n1636: $$\n1637: \n1638: where:\n1639: - $\\kappa'_W = \\min\\{\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}}\\} = O(\\min\\{\\gamma, c_{\\min}\\}) > 0$",
      "metadata": {
        "label": "thm-hypocoercive-main"
      },
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1627: #### 3.2.5. Main Hypocoercive Theorem (Assembly)\n1628: \n1629: :::{prf:theorem} Hypocoercive Contraction for Adaptive Gas\n1630: :label: thm-hypocoercive-main\n1631: \n1632: The inter-swarm Wasserstein distance $V_W(S_1, S_2) = V_{\\text{loc}} + V_{\\text{struct}}$ satisfies:\n1633: \n1634: $$\n1635: \\mathbb{E}[\\Delta V_W] \\le -\\kappa'_W \\tau V_W + C'_W \\tau\n1636: $$\n1637: \n1638: where:\n1639: - $\\kappa'_W = \\min\\{\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}}\\} = O(\\min\\{\\gamma, c_{\\min}\\}) > 0$\n1640: - $C'_W = C_{\\text{loc}} + C_{\\text{struct}} = O(c_{\\max}^2)$"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-868",
      "title": null,
      "start_line": 1642,
      "end_line": 1646,
      "header_lines": [],
      "content_start": 1643,
      "content_end": 1645,
      "content": "1643: \n1644: :::{prf:proof}\n1645: Direct from Theorems [](#thm-location-error-anisotropic) and [](#thm-structural-error-anisotropic). Since both components contract at rates $\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}} = O(\\min\\{\\gamma, c_{\\min}\\})$, their sum contracts at rate $\\min\\{\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}}\\}$.",
      "metadata": {},
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1642: :::\n1643: \n1644: :::{prf:proof}\n1645: Direct from Theorems [](#thm-location-error-anisotropic) and [](#thm-structural-error-anisotropic). Since both components contract at rates $\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}} = O(\\min\\{\\gamma, c_{\\min}\\})$, their sum contracts at rate $\\min\\{\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}}\\}$.\n1646: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-position-variance-expansion",
      "title": "Position Variance Expansion",
      "start_line": 1663,
      "end_line": 1673,
      "header_lines": [
        1664
      ],
      "content_start": 1666,
      "content_end": 1672,
      "content": "1666: :label: thm-position-variance-expansion\n1667: \n1668: The position variance difference satisfies:\n1669: \n1670: $$\n1671: \\mathbb{E}[\\Delta V_{\\text{Var},x}] \\le C'_x \\tau\n1672: $$",
      "metadata": {
        "label": "thm-position-variance-expansion"
      },
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1663: ### 3.3. Position Variance Expansion (Bounded)\n1664: \n1665: :::{prf:theorem} Position Variance Expansion\n1666: :label: thm-position-variance-expansion\n1667: \n1668: The position variance difference satisfies:\n1669: \n1670: $$\n1671: \\mathbb{E}[\\Delta V_{\\text{Var},x}] \\le C'_x \\tau\n1672: $$\n1673: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-901",
      "title": null,
      "start_line": 1675,
      "end_line": 1699,
      "header_lines": [],
      "content_start": 1676,
      "content_end": 1698,
      "content": "1676: \n1677: :::{prf:proof}\n1678: **Step 1**: Position evolves as $dx = v \\, dt$ (no noise, no force).\n1679: \n1680: **Step 2**: The generator acting on $V_{\\text{Var},x} = |V_{\\text{Var},x}(S_1) - V_{\\text{Var},x}(S_2)|$ is:\n1681: \n1682: $$\n1683: \\mathcal{L} V_{\\text{Var},x} = 2 \\langle x - \\bar{x}, v - \\bar{v} \\rangle\n1684: $$\n1685: \n1686: **Step 3**: By Cauchy-Schwarz and the velocity bound $\\|v\\| \\le V_{\\max}$:\n1687: \n1688: $$\n1689: |\\mathcal{L} V_{\\text{Var},x}| \\le 2 V_{\\max} \\sqrt{V_{\\text{Var},x}}\n1690: $$\n1691: \n1692: **Step 4**: Using Young's inequality, this is bounded by a constant independent of $V_{\\text{Var},x}$:\n1693: \n1694: $$\n1695: \\mathcal{L} V_{\\text{Var},x} \\le C'_x\n1696: $$\n1697: \n1698: **Step 5**: Discrete-time result follows from integration.",
      "metadata": {},
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1675: :::\n1676: \n1677: :::{prf:proof}\n1678: **Step 1**: Position evolves as $dx = v \\, dt$ (no noise, no force).\n1679: \n1680: **Step 2**: The generator acting on $V_{\\text{Var},x} = |V_{\\text{Var},x}(S_1) - V_{\\text{Var},x}(S_2)|$ is:\n1681: \n1682: $$\n1683: \\mathcal{L} V_{\\text{Var},x} = 2 \\langle x - \\bar{x}, v - \\bar{v} \\rangle\n1684: $$\n1685: \n1686: **Step 3**: By Cauchy-Schwarz and the velocity bound $\\|v\\| \\le V_{\\max}$:\n1687: \n1688: $$\n1689: |\\mathcal{L} V_{\\text{Var},x}| \\le 2 V_{\\max} \\sqrt{V_{\\text{Var},x}}\n1690: $$\n1691: \n1692: **Step 4**: Using Young's inequality, this is bounded by a constant independent of $V_{\\text{Var},x}$:\n1693: \n1694: $$\n1695: \\mathcal{L} V_{\\text{Var},x} \\le C'_x\n1696: $$\n1697: \n1698: **Step 5**: Discrete-time result follows from integration.\n1699: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-boundary-contraction",
      "title": "Boundary Potential Contraction",
      "start_line": 1703,
      "end_line": 1713,
      "header_lines": [
        1704
      ],
      "content_start": 1706,
      "content_end": 1712,
      "content": "1706: :label: thm-boundary-contraction\n1707: \n1708: The boundary potential satisfies:\n1709: \n1710: $$\n1711: \\mathbb{E}[\\Delta W_b] \\le -\\kappa'_b \\tau W_b + C'_b \\tau\n1712: $$",
      "metadata": {
        "label": "thm-boundary-contraction"
      },
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1703: ### 3.4. Boundary Potential Contraction\n1704: \n1705: :::{prf:theorem} Boundary Potential Contraction\n1706: :label: thm-boundary-contraction\n1707: \n1708: The boundary potential satisfies:\n1709: \n1710: $$\n1711: \\mathbb{E}[\\Delta W_b] \\le -\\kappa'_b \\tau W_b + C'_b \\tau\n1712: $$\n1713: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-941",
      "title": null,
      "start_line": 1715,
      "end_line": 1737,
      "header_lines": [],
      "content_start": 1716,
      "content_end": 1736,
      "content": "1716: \n1717: :::{prf:proof}\n1718: **Step 1**: The confining force $F(x) = -\\nabla U(x)$ points inward near the boundary with strength $\\langle x, \\nabla U(x) \\rangle \\ge \\alpha_U \\|x\\|^2 - R_U$ (Axiom 1.3.1).\n1719: \n1720: **Step 2**: The generator acting on $W_b = \\sum_k \\frac{1}{N_k} \\sum_i w_b(x_{k,i})$ includes the force term:\n1721: \n1722: $$\n1723: \\mathcal{L} w_b(x) = \\langle \\nabla w_b(x), v \\rangle + \\langle \\nabla w_b(x), F(x) \\rangle + \\text{diffusion}\n1724: $$\n1725: \n1726: **Step 3**: Near the boundary, $\\nabla w_b$ points outward and $F$ points inward, giving:\n1727: \n1728: $$\n1729: \\langle \\nabla w_b(x), F(x) \\rangle \\le -\\alpha_U w_b(x)\n1730: $$\n1731: \n1732: **Step 4**: The velocity and diffusion terms contribute bounded constants. The force dominates:\n1733: \n1734: $$\n1735: \\mathcal{L} W_b \\le -\\kappa'_b W_b + C'_b\n1736: $$",
      "metadata": {},
      "section": "## 3. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1715: :::\n1716: \n1717: :::{prf:proof}\n1718: **Step 1**: The confining force $F(x) = -\\nabla U(x)$ points inward near the boundary with strength $\\langle x, \\nabla U(x) \\rangle \\ge \\alpha_U \\|x\\|^2 - R_U$ (Axiom 1.3.1).\n1719: \n1720: **Step 2**: The generator acting on $W_b = \\sum_k \\frac{1}{N_k} \\sum_i w_b(x_{k,i})$ includes the force term:\n1721: \n1722: $$\n1723: \\mathcal{L} w_b(x) = \\langle \\nabla w_b(x), v \\rangle + \\langle \\nabla w_b(x), F(x) \\rangle + \\text{diffusion}\n1724: $$\n1725: \n1726: **Step 3**: Near the boundary, $\\nabla w_b$ points outward and $F$ points inward, giving:\n1727: \n1728: $$\n1729: \\langle \\nabla w_b(x), F(x) \\rangle \\le -\\alpha_U w_b(x)\n1730: $$\n1731: \n1732: **Step 4**: The velocity and diffusion terms contribute bounded constants. The force dominates:\n1733: \n1734: $$\n1735: \\mathcal{L} W_b \\le -\\kappa'_b W_b + C'_b\n1736: $$\n1737: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}