{
  "chapter_index": 4,
  "section_id": "## 4. Energy Functional: Hellinger-Kantorovich Distance",
  "directive_count": 9,
  "hints": [
    {
      "directive_type": "definition",
      "label": "def-scutoid-energy",
      "title": "Scutoid Deformation Energy (Hellinger-Kantorovich)",
      "start_line": 715,
      "end_line": 752,
      "header_lines": [
        716
      ],
      "content_start": 718,
      "content_end": 751,
      "content": "718: :label: def-scutoid-energy\n719: \n720: The **deformation energy** required to transform the swarm configuration from time $t$ to $t + \\Delta t$ is defined using the **Hellinger-Kantorovich distance** between the empirical measures:\n721: \n722: $$\n723: E_{\\text{scutoid}}(t \\to t + \\Delta t) = \\text{HK}_{\\alpha}(\\mu_t, \\mu_{t + \\Delta t})^2\n724: $$\n725: \n726: where:\n727: - $\\mu_t = \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(t)} \\delta_{x_i(t)}$ is the empirical measure at time $t$ (unnormalized, total mass $|\\mathcal{A}(t)|/N \\le 1$)\n728: - $\\text{HK}_{\\alpha}(\\mu, \\nu)$ is the **Hellinger-Kantorovich distance** with parameter $\\alpha > 0$:\n729: \n730: $$\n731: \\text{HK}_{\\alpha}(\\mu, \\nu)^2 = \\inf_{\\pi} \\left\\{ \\int_{\\mathcal{X} \\times \\mathcal{X}} \\frac{d_g(x, y)^2}{4\\alpha} \\, d\\pi(x, y) + \\alpha \\text{KL}(\\pi_1 | \\mu) + \\alpha \\text{KL}(\\pi_2 | \\nu) \\right\\}\n732: $$\n733: \n734: where:\n735: - $\\pi$ is a **transport plan** (not necessarily a coupling, since masses may differ)\n736: - $\\pi_1, \\pi_2$ are the marginals of $\\pi$\n737: - $\\text{KL}(\\pi_1 | \\mu) = \\int \\log(d\\pi_1/d\\mu) \\, d\\pi_1$ is the **Kullback-Leibler divergence** (measuring mass growth/destruction)\n738: - $\\alpha > 0$ is a parameter balancing transport cost vs. mass creation cost\n739: \n740: **Physical interpretation**:\n741: - **Transport term**: $\\int d_g(x, y)^2 / (4\\alpha) \\, d\\pi$ is the cost of moving mass via geodesics\n742: - **Mass creation/destruction**: $\\text{KL}(\\pi_1 | \\mu)$ penalizes creating or destroying walkers (cloning/death events)\n743: - **Parameter $\\alpha$**: Controls the trade-off\u2014large $\\alpha$ makes mass creation cheaper, small $\\alpha$ makes transport cheaper\n744: \n745: **Why HK for the Fragile Gas**:\n746: 1. **Unbalanced transport**: Cloning events change the number of alive walkers, so $|\\mathcal{A}(t)| \\neq |\\mathcal{A}(t + \\Delta t)|$ generically\n747: 2. **Mass splitting**: A cloning event \"splits\" a walker's mass (parent dies, child is born)\n748: 3. **Natural for birth-death processes**: HK distance is the geometric framework for reaction-diffusion equations\n749: 4. **Reduces to Wasserstein**: When masses are balanced ($\\mu(\\mathcal{X}) = \\nu(\\mathcal{X})$), $\\text{HK}_{\\alpha} \\to W_2$ as $\\alpha \\to \\infty$\n750: \n751: **Units**: $[\\text{Energy}] = [\\text{Distance}]^2$ (via the $d_g^2$ term).",
      "metadata": {
        "label": "def-scutoid-energy"
      },
      "section": "## 4. Energy Functional: Hellinger-Kantorovich Distance",
      "raw_directive": "715: The scutoid framework requires an energy functional that naturally handles **mass creation/destruction** during cloning events. The **Hellinger-Kantorovich (HK) distance** is the correct geometric framework for this setting.\n716: \n717: :::{prf:definition} Scutoid Deformation Energy (Hellinger-Kantorovich)\n718: :label: def-scutoid-energy\n719: \n720: The **deformation energy** required to transform the swarm configuration from time $t$ to $t + \\Delta t$ is defined using the **Hellinger-Kantorovich distance** between the empirical measures:\n721: \n722: $$\n723: E_{\\text{scutoid}}(t \\to t + \\Delta t) = \\text{HK}_{\\alpha}(\\mu_t, \\mu_{t + \\Delta t})^2\n724: $$\n725: \n726: where:\n727: - $\\mu_t = \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(t)} \\delta_{x_i(t)}$ is the empirical measure at time $t$ (unnormalized, total mass $|\\mathcal{A}(t)|/N \\le 1$)\n728: - $\\text{HK}_{\\alpha}(\\mu, \\nu)$ is the **Hellinger-Kantorovich distance** with parameter $\\alpha > 0$:\n729: \n730: $$\n731: \\text{HK}_{\\alpha}(\\mu, \\nu)^2 = \\inf_{\\pi} \\left\\{ \\int_{\\mathcal{X} \\times \\mathcal{X}} \\frac{d_g(x, y)^2}{4\\alpha} \\, d\\pi(x, y) + \\alpha \\text{KL}(\\pi_1 | \\mu) + \\alpha \\text{KL}(\\pi_2 | \\nu) \\right\\}\n732: $$\n733: \n734: where:\n735: - $\\pi$ is a **transport plan** (not necessarily a coupling, since masses may differ)\n736: - $\\pi_1, \\pi_2$ are the marginals of $\\pi$\n737: - $\\text{KL}(\\pi_1 | \\mu) = \\int \\log(d\\pi_1/d\\mu) \\, d\\pi_1$ is the **Kullback-Leibler divergence** (measuring mass growth/destruction)\n738: - $\\alpha > 0$ is a parameter balancing transport cost vs. mass creation cost\n739: \n740: **Physical interpretation**:\n741: - **Transport term**: $\\int d_g(x, y)^2 / (4\\alpha) \\, d\\pi$ is the cost of moving mass via geodesics\n742: - **Mass creation/destruction**: $\\text{KL}(\\pi_1 | \\mu)$ penalizes creating or destroying walkers (cloning/death events)\n743: - **Parameter $\\alpha$**: Controls the trade-off\u2014large $\\alpha$ makes mass creation cheaper, small $\\alpha$ makes transport cheaper\n744: \n745: **Why HK for the Fragile Gas**:\n746: 1. **Unbalanced transport**: Cloning events change the number of alive walkers, so $|\\mathcal{A}(t)| \\neq |\\mathcal{A}(t + \\Delta t)|$ generically\n747: 2. **Mass splitting**: A cloning event \"splits\" a walker's mass (parent dies, child is born)\n748: 3. **Natural for birth-death processes**: HK distance is the geometric framework for reaction-diffusion equations\n749: 4. **Reduces to Wasserstein**: When masses are balanced ($\\mu(\\mathcal{X}) = \\nu(\\mathcal{X})$), $\\text{HK}_{\\alpha} \\to W_2$ as $\\alpha \\to \\infty$\n750: \n751: **Units**: $[\\text{Energy}] = [\\text{Distance}]^2$ (via the $d_g^2$ term).\n752: "
    },
    {
      "directive_type": "definition",
      "label": "def-genealogical-cost",
      "title": "Genealogical HK Cost",
      "start_line": 754,
      "end_line": 798,
      "header_lines": [
        755
      ],
      "content_start": 757,
      "content_end": 797,
      "content": "757: :label: def-genealogical-cost\n758: \n759: The **genealogical Hellinger-Kantorovich cost** $C_G(\\mu_t, \\mu_{t+\\Delta t})$ is the cost of the specific transport plan $\\pi_G$ that follows the algorithmic genealogy:\n760: \n761: $$\n762: C_G(\\mu_t, \\mu_{t+\\Delta t})^2 = \\int_{\\mathcal{X} \\times \\mathcal{X}} \\frac{d_g(x, y)^2}{4\\alpha} \\, d\\pi_G(x, y) + \\alpha \\text{KL}((\\pi_G)_1 | \\mu_t) + \\alpha \\text{KL}((\\pi_G)_2 | \\mu_{t+\\Delta t})\n763: $$\n764: \n765: where the **genealogical transport plan** $\\pi_G$ is constructed as follows:\n766: \n767: 1. **Persistent walkers**: For each $i \\in \\mathcal{P}(t)$ (alive at both $t$ and $t + \\Delta t$):\n768: \n769: $$\n770: \\pi_G(x_i(t), x_i(t + \\Delta t)) = \\frac{1}{N}\n771: $$\n772: \n773: (transport mass from walker $i$'s position at $t$ to its position at $t + \\Delta t$)\n774: \n775: 2. **Cloned walkers**: For each $i \\in \\mathcal{C}(t)$ (died and replaced):\n776:    - **Mass destruction**: Walker $i$ dies at position $x_i(t)$ (mass $1/N$ disappears)\n777:    - **Mass creation**: New walker cloned from parent $j = \\text{parent}(i)$ appears at $x_j(t + \\Delta t)$ (mass $1/N$ appears)\n778: \n779: The KL terms capture this mass creation/destruction:\n780: - $\\text{KL}((\\pi_G)_1 | \\mu_t)$ measures mass destroyed (dead walkers)\n781: - $\\text{KL}((\\pi_G)_2 | \\mu_{t+\\Delta t})$ measures mass created (cloned walkers)\n782: \n783: **Explicit formula**:\n784: \n785: $$\n786: C_G(\\mu_t, \\mu_{t+\\Delta t})^2 = \\frac{1}{4\\alpha} E_{\\text{transport}} + \\alpha E_{\\text{birth-death}}\n787: $$\n788: \n789: where:\n790: - $E_{\\text{transport}} = \\frac{1}{N} \\sum_{i \\in \\mathcal{P}(t)} d_g(x_i(t), x_i(t + \\Delta t))^2$ (transport cost for persistent walkers)\n791: - $E_{\\text{birth-death}} = \\frac{2|\\mathcal{C}(t)|}{N}$ (mass creation/destruction cost, factor of 2 from KL terms on both marginals)\n792: \n793: **Derivation of birth-death cost**: For empirical measures with discrete mass creation/destruction, the KL divergence $\\text{KL}(\\pi_1 | \\mu)$ equals the total mass created or destroyed (up to normalization). For $|\\mathcal{C}(t)|$ cloning events (each destroying mass $1/N$ and creating mass $1/N$), the total cost from both marginals is $2|\\mathcal{C}(t)|/N$. See {cite}`LieroMielkeSavare2016` Section 2.3 for the general formula for discrete measures.\n794: \n795: **Key insight**: The HK framework **naturally decomposes** into:\n796: 1. **Transport component**: Moving persistent walkers along their trajectories (Langevin dynamics)\n797: 2. **Reaction component**: Birth-death events from cloning (mass change)",
      "metadata": {
        "label": "def-genealogical-cost"
      },
      "section": "## 4. Energy Functional: Hellinger-Kantorovich Distance",
      "raw_directive": "754: :::\n755: \n756: :::{prf:definition} Genealogical HK Cost\n757: :label: def-genealogical-cost\n758: \n759: The **genealogical Hellinger-Kantorovich cost** $C_G(\\mu_t, \\mu_{t+\\Delta t})$ is the cost of the specific transport plan $\\pi_G$ that follows the algorithmic genealogy:\n760: \n761: $$\n762: C_G(\\mu_t, \\mu_{t+\\Delta t})^2 = \\int_{\\mathcal{X} \\times \\mathcal{X}} \\frac{d_g(x, y)^2}{4\\alpha} \\, d\\pi_G(x, y) + \\alpha \\text{KL}((\\pi_G)_1 | \\mu_t) + \\alpha \\text{KL}((\\pi_G)_2 | \\mu_{t+\\Delta t})\n763: $$\n764: \n765: where the **genealogical transport plan** $\\pi_G$ is constructed as follows:\n766: \n767: 1. **Persistent walkers**: For each $i \\in \\mathcal{P}(t)$ (alive at both $t$ and $t + \\Delta t$):\n768: \n769: $$\n770: \\pi_G(x_i(t), x_i(t + \\Delta t)) = \\frac{1}{N}\n771: $$\n772: \n773: (transport mass from walker $i$'s position at $t$ to its position at $t + \\Delta t$)\n774: \n775: 2. **Cloned walkers**: For each $i \\in \\mathcal{C}(t)$ (died and replaced):\n776:    - **Mass destruction**: Walker $i$ dies at position $x_i(t)$ (mass $1/N$ disappears)\n777:    - **Mass creation**: New walker cloned from parent $j = \\text{parent}(i)$ appears at $x_j(t + \\Delta t)$ (mass $1/N$ appears)\n778: \n779: The KL terms capture this mass creation/destruction:\n780: - $\\text{KL}((\\pi_G)_1 | \\mu_t)$ measures mass destroyed (dead walkers)\n781: - $\\text{KL}((\\pi_G)_2 | \\mu_{t+\\Delta t})$ measures mass created (cloned walkers)\n782: \n783: **Explicit formula**:\n784: \n785: $$\n786: C_G(\\mu_t, \\mu_{t+\\Delta t})^2 = \\frac{1}{4\\alpha} E_{\\text{transport}} + \\alpha E_{\\text{birth-death}}\n787: $$\n788: \n789: where:\n790: - $E_{\\text{transport}} = \\frac{1}{N} \\sum_{i \\in \\mathcal{P}(t)} d_g(x_i(t), x_i(t + \\Delta t))^2$ (transport cost for persistent walkers)\n791: - $E_{\\text{birth-death}} = \\frac{2|\\mathcal{C}(t)|}{N}$ (mass creation/destruction cost, factor of 2 from KL terms on both marginals)\n792: \n793: **Derivation of birth-death cost**: For empirical measures with discrete mass creation/destruction, the KL divergence $\\text{KL}(\\pi_1 | \\mu)$ equals the total mass created or destroyed (up to normalization). For $|\\mathcal{C}(t)|$ cloning events (each destroying mass $1/N$ and creating mass $1/N$), the total cost from both marginals is $2|\\mathcal{C}(t)|/N$. See {cite}`LieroMielkeSavare2016` Section 2.3 for the general formula for discrete measures.\n794: \n795: **Key insight**: The HK framework **naturally decomposes** into:\n796: 1. **Transport component**: Moving persistent walkers along their trajectories (Langevin dynamics)\n797: 2. **Reaction component**: Birth-death events from cloning (mass change)\n798: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-hk-upper-bound",
      "title": "Upper Bound on HK Energy from Genealogy",
      "start_line": 800,
      "end_line": 824,
      "header_lines": [
        801
      ],
      "content_start": 803,
      "content_end": 823,
      "content": "803: :label: thm-hk-upper-bound\n804: \n805: The Hellinger-Kantorovich distance is bounded above by the genealogical transport cost:\n806: \n807: $$\n808: \\text{HK}_{\\alpha}(\\mu_t, \\mu_{t+\\Delta t})^2 \\le C_G(\\mu_t, \\mu_{t+\\Delta t})^2 = \\frac{1}{4\\alpha} E_{\\text{transport}} + \\alpha E_{\\text{birth-death}}\n809: $$\n810: \n811: **Proof**: By definition, the HK distance is the infimum over all transport plans:\n812: \n813: $$\n814: \\text{HK}_{\\alpha}(\\mu, \\nu)^2 = \\inf_{\\pi} \\left\\{ \\int \\frac{d_g(x, y)^2}{4\\alpha} \\, d\\pi + \\alpha \\text{KL}(\\pi_1 | \\mu) + \\alpha \\text{KL}(\\pi_2 | \\nu) \\right\\}\n815: $$\n816: \n817: The genealogical transport plan $\\pi_G$ is *a valid plan* (though not a coupling, since masses may differ), so it is included in the set over which the infimum is taken. Therefore:\n818: \n819: $$\n820: \\text{HK}_{\\alpha}(\\mu_t, \\mu_{t+\\Delta t})^2 \\le C_G(\\mu_t, \\mu_{t+\\Delta t})^2\n821: $$\n822: \n823: $\\square$",
      "metadata": {
        "label": "thm-hk-upper-bound"
      },
      "section": "## 4. Energy Functional: Hellinger-Kantorovich Distance",
      "raw_directive": "800: :::\n801: \n802: :::{prf:theorem} Upper Bound on HK Energy from Genealogy\n803: :label: thm-hk-upper-bound\n804: \n805: The Hellinger-Kantorovich distance is bounded above by the genealogical transport cost:\n806: \n807: $$\n808: \\text{HK}_{\\alpha}(\\mu_t, \\mu_{t+\\Delta t})^2 \\le C_G(\\mu_t, \\mu_{t+\\Delta t})^2 = \\frac{1}{4\\alpha} E_{\\text{transport}} + \\alpha E_{\\text{birth-death}}\n809: $$\n810: \n811: **Proof**: By definition, the HK distance is the infimum over all transport plans:\n812: \n813: $$\n814: \\text{HK}_{\\alpha}(\\mu, \\nu)^2 = \\inf_{\\pi} \\left\\{ \\int \\frac{d_g(x, y)^2}{4\\alpha} \\, d\\pi + \\alpha \\text{KL}(\\pi_1 | \\mu) + \\alpha \\text{KL}(\\pi_2 | \\nu) \\right\\}\n815: $$\n816: \n817: The genealogical transport plan $\\pi_G$ is *a valid plan* (though not a coupling, since masses may differ), so it is included in the set over which the infimum is taken. Therefore:\n818: \n819: $$\n820: \\text{HK}_{\\alpha}(\\mu_t, \\mu_{t+\\Delta t})^2 \\le C_G(\\mu_t, \\mu_{t+\\Delta t})^2\n821: $$\n822: \n823: $\\square$\n824: "
    },
    {
      "directive_type": "remark",
      "label": "rem-genealogical-optimality",
      "title": "Optimality of the Genealogical Plan",
      "start_line": 826,
      "end_line": 842,
      "header_lines": [
        827
      ],
      "content_start": 829,
      "content_end": 841,
      "content": "829: :label: rem-genealogical-optimality\n830: \n831: The inequality $\\text{HK}_{\\alpha}^2 = C_G^2$ (equality) holds if and only if the genealogical transport plan $\\pi_G$ is **HK-optimal**.\n832: \n833: **Why the Fragile Gas may achieve optimality**:\n834: 1. **Local Langevin dynamics**: Persistent walkers diffuse locally, which is energy-minimizing for smooth gradients\n835: 2. **Fitness-driven cloning**: Cloning selects high-fitness parents, which (heuristically) minimizes the expected distance between dead walkers and their replacements\n836: 3. **Balance parameter**: If the algorithmic parameter $\\alpha$ is chosen to match the HK parameter, the algorithm effectively solves the HK optimization\n837: \n838: **Connection to gradient flows**: The HK distance defines a **Riemannian structure on the space of measures** (the Wasserstein-Fisher-Rao geometry). The Fragile Gas dynamics can be interpreted as a **discrete-time gradient flow** in this geometry, which would imply $\\pi_G$ is approximately optimal.\n839: \n840: **Empirical validation**: Computing both $\\text{HK}_{\\alpha}^2$ (via convex optimization solvers) and $C_G^2$ (from genealogy) on swarm runs would:\n841: 1. Quantify the tightness of the bound",
      "metadata": {
        "label": "rem-genealogical-optimality"
      },
      "section": "## 4. Energy Functional: Hellinger-Kantorovich Distance",
      "raw_directive": "826: :::\n827: \n828: :::{prf:remark} Optimality of the Genealogical Plan\n829: :label: rem-genealogical-optimality\n830: \n831: The inequality $\\text{HK}_{\\alpha}^2 = C_G^2$ (equality) holds if and only if the genealogical transport plan $\\pi_G$ is **HK-optimal**.\n832: \n833: **Why the Fragile Gas may achieve optimality**:\n834: 1. **Local Langevin dynamics**: Persistent walkers diffuse locally, which is energy-minimizing for smooth gradients\n835: 2. **Fitness-driven cloning**: Cloning selects high-fitness parents, which (heuristically) minimizes the expected distance between dead walkers and their replacements\n836: 3. **Balance parameter**: If the algorithmic parameter $\\alpha$ is chosen to match the HK parameter, the algorithm effectively solves the HK optimization\n837: \n838: **Connection to gradient flows**: The HK distance defines a **Riemannian structure on the space of measures** (the Wasserstein-Fisher-Rao geometry). The Fragile Gas dynamics can be interpreted as a **discrete-time gradient flow** in this geometry, which would imply $\\pi_G$ is approximately optimal.\n839: \n840: **Empirical validation**: Computing both $\\text{HK}_{\\alpha}^2$ (via convex optimization solvers) and $C_G^2$ (from genealogy) on swarm runs would:\n841: 1. Quantify the tightness of the bound\n842: 2. Determine the optimal choice of $\\alpha$ for the algorithm"
    },
    {
      "directive_type": "corollary",
      "label": "cor-scutoid-energy",
      "title": "Scutoid Fraction and Energy",
      "start_line": 844,
      "end_line": 858,
      "header_lines": [
        845
      ],
      "content_start": 847,
      "content_end": 857,
      "content": "847: :label: cor-scutoid-energy\n848: \n849: The scutoid fraction $\\phi(t)$ is correlated with the Wasserstein energy:\n850: \n851: $$\n852: E_{\\text{scutoid}}(t \\to t + \\Delta t) \\propto \\phi(t) \\cdot \\bar{d}_{\\text{clone}}^2\n853: $$\n854: \n855: where $\\bar{d}_{\\text{clone}}$ is the average geodesic distance between cloned walkers and their parents.\n856: \n857: **Interpretation**: A **scutoid-dominated phase** (high $\\phi$) corresponds to **high energy** (rapid configuration changes), while a **prism-dominated phase** (low $\\phi$) corresponds to **low energy** (stable configuration).",
      "metadata": {
        "label": "cor-scutoid-energy"
      },
      "section": "## 4. Energy Functional: Hellinger-Kantorovich Distance",
      "raw_directive": "844: :::\n845: \n846: :::{prf:corollary} Scutoid Fraction and Energy\n847: :label: cor-scutoid-energy\n848: \n849: The scutoid fraction $\\phi(t)$ is correlated with the Wasserstein energy:\n850: \n851: $$\n852: E_{\\text{scutoid}}(t \\to t + \\Delta t) \\propto \\phi(t) \\cdot \\bar{d}_{\\text{clone}}^2\n853: $$\n854: \n855: where $\\bar{d}_{\\text{clone}}$ is the average geodesic distance between cloned walkers and their parents.\n856: \n857: **Interpretation**: A **scutoid-dominated phase** (high $\\phi$) corresponds to **high energy** (rapid configuration changes), while a **prism-dominated phase** (low $\\phi$) corresponds to **low energy** (stable configuration).\n858: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-scutoid-hk-minimization",
      "title": "Scutoid Geometry Minimizes Hellinger-Kantorovich Energy",
      "start_line": 862,
      "end_line": 880,
      "header_lines": [
        863
      ],
      "content_start": 865,
      "content_end": 879,
      "content": "865: :label: thm-scutoid-hk-minimization\n866: \n867: The genealogical transport plan that generates the scutoid tessellation is the **optimal transport plan** that minimizes the Hellinger-Kantorovich distance $\\text{HK}_\\alpha(\\mu_t, \\mu_{t+\\Delta t})$ between the empirical measures of the swarm at consecutive time steps.\n868: \n869: **Formal statement**: The spacetime evolution of the Fragile Gas, represented by scutoid cells connecting Voronoi tessellations at times $t$ and $t + \\Delta t$, minimizes the Hellinger-Kantorovich energy:\n870: \n871: $$\n872: \\text{HK}_\\alpha(\\mu_t, \\mu_{t+\\Delta t})^2 = \\inf_{\\pi \\in \\Pi(\\mu_t, \\mu_{t+\\Delta t})} \\int_{\\mathcal{X} \\times \\mathcal{X}} c_\\alpha(x, y) \\, d\\pi(x, y)\n873: $$\n874: \n875: where:\n876: - $\\mu_t = \\frac{1}{N} \\sum_{i=1}^N \\delta_{x_i(t)}$ is the empirical measure at time $t$\n877: - $\\Pi(\\mu_t, \\mu_{t+\\Delta t})$ is the set of transport plans (couplings)\n878: - The cost function is $c_\\alpha(x, y) = \\frac{1}{4\\alpha} d_g(x, y)^2 + \\alpha \\cdot \\text{KL}(\\text{birth/death})$\n879: - $\\alpha > 0$ balances transport cost vs. mass creation/destruction cost",
      "metadata": {
        "label": "thm-scutoid-hk-minimization"
      },
      "section": "## 4. Energy Functional: Hellinger-Kantorovich Distance",
      "raw_directive": "862: ### 4.2. Minimization Principle\n863: \n864: :::{prf:theorem} Scutoid Geometry Minimizes Hellinger-Kantorovich Energy\n865: :label: thm-scutoid-hk-minimization\n866: \n867: The genealogical transport plan that generates the scutoid tessellation is the **optimal transport plan** that minimizes the Hellinger-Kantorovich distance $\\text{HK}_\\alpha(\\mu_t, \\mu_{t+\\Delta t})$ between the empirical measures of the swarm at consecutive time steps.\n868: \n869: **Formal statement**: The spacetime evolution of the Fragile Gas, represented by scutoid cells connecting Voronoi tessellations at times $t$ and $t + \\Delta t$, minimizes the Hellinger-Kantorovich energy:\n870: \n871: $$\n872: \\text{HK}_\\alpha(\\mu_t, \\mu_{t+\\Delta t})^2 = \\inf_{\\pi \\in \\Pi(\\mu_t, \\mu_{t+\\Delta t})} \\int_{\\mathcal{X} \\times \\mathcal{X}} c_\\alpha(x, y) \\, d\\pi(x, y)\n873: $$\n874: \n875: where:\n876: - $\\mu_t = \\frac{1}{N} \\sum_{i=1}^N \\delta_{x_i(t)}$ is the empirical measure at time $t$\n877: - $\\Pi(\\mu_t, \\mu_{t+\\Delta t})$ is the set of transport plans (couplings)\n878: - The cost function is $c_\\alpha(x, y) = \\frac{1}{4\\alpha} d_g(x, y)^2 + \\alpha \\cdot \\text{KL}(\\text{birth/death})$\n879: - $\\alpha > 0$ balances transport cost vs. mass creation/destruction cost\n880: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-172",
      "title": "Two-Part Variational Argument",
      "start_line": 882,
      "end_line": 957,
      "header_lines": [],
      "content_start": 884,
      "content_end": 956,
      "content": "884: :::{prf:proof} Two-Part Variational Argument\n885: \n886: The proof decomposes the HK energy according to the algorithm's two-stage structure: persistent walker transport (geodesic ruling of prisms) and cloning events (mid-level vertices).\n887: \n888: **Part 1: Geodesic Ruling for Persistent Walkers**\n889: \n890: For the subset $\\mathcal{P}(t)$ of walkers not involved in cloning, the transport component of the HK energy reduces to the squared Wasserstein-2 distance:\n891: \n892: $$\n893: W_2^2(\\mu_t|_{\\mathcal{P}}, \\mu_{t+\\Delta t}|_{\\mathcal{P}}) = \\inf_{\\pi} \\int_{\\mathcal{X} \\times \\mathcal{X}} d_g(x, y)^2 \\, d\\pi(x, y)\n894: $$\n895: \n896: The algorithm defines a specific transport plan: each walker $i \\in \\mathcal{P}$ moves from $x_i(t)$ to $x_i(t + \\Delta t)$ along a path $\\gamma_i(s)$ for $s \\in [t, t + \\Delta t]$ governed by the Langevin dynamics:\n897: \n898: $$\n899: dv_i = [-\\nabla U_{\\text{eff}}(x_i) - \\gamma v_i] dt + \\Sigma_{\\text{reg}}(x_i) \\circ dW_i\n900: $$\n901: \n902: **Least Action Principle**: The cost associated with path $\\gamma_i$ is:\n903: \n904: $$\n905: C[\\gamma_i] = \\int_t^{t+\\Delta t} L(\\gamma_i(s), \\dot{\\gamma}_i(s)) \\, ds\n906: $$\n907: \n908: where the Lagrangian is $L(x, v) = \\frac{1}{2} g_{ab}(x) v^a v^b$ (kinetic energy in the emergent metric).\n909: \n910: The paths that **minimize** this action are precisely the **geodesics** of the spacetime metric $g_{\\text{ST}}$ (Euler-Lagrange equations).\n911: \n912: **In the low-noise limit** ($\\Sigma_{\\text{reg}} \\to 0$), the Langevin SDE becomes deterministic:\n913: \n914: $$\n915: \\ddot{x}_i + \\gamma \\dot{x}_i + g(x_i)^{-1} \\nabla U_{\\text{eff}}(x_i) = 0\n916: $$\n917: \n918: This is the **damped geodesic equation** on the manifold $(\\mathcal{X}, g)$. For high friction $\\gamma \\gg 1$ and zero potential gradient, this reduces exactly to geodesic flow.\n919: \n920: **Conclusion**: The geodesic ruling of scutoid lateral faces (connecting persistent walkers) is the **natural geometric consequence** of the Langevin dynamics minimizing transport cost in the emergent Riemannian geometry.\n921: \n922: **Part 2: Optimal Mid-Level Vertex Placement from Cloning**\n923: \n924: Consider a cloning event where walker $i$ at $x_i$ (to be destroyed) is replaced by a clone of walker $j$ at $x_j$ (the parent). The HK cost contribution for this event is:\n925: \n926: $$\n927: C_{\\text{clone}}(x_{\\text{new}}) = \\frac{1}{4\\alpha} d_g(x_j, x_{\\text{new}})^2 + \\alpha \\left[ \\text{KL}(\\text{creation at } x_{\\text{new}}) + \\text{KL}(\\text{destruction at } x_i) \\right]\n928: $$\n929: \n930: where $x_{\\text{new}}$ is the birth position of the new walker.\n931: \n932: **Minimization**: The KL terms for discrete creation/destruction of mass $m = 1/N$ are **constants** (independent of $x_{\\text{new}}$). The only position-dependent term is the transport cost:\n933: \n934: $$\n935: \\frac{\\partial C_{\\text{clone}}}{\\partial x_{\\text{new}}} = \\frac{1}{2\\alpha} \\nabla_{x_{\\text{new}}} d_g(x_j, x_{\\text{new}})^2\n936: $$\n937: \n938: This gradient vanishes when $x_{\\text{new}} = x_j$, i.e., when the new walker is born at the **exact location of the parent**.\n939: \n940: **Algorithm Implementation**: From {prf:ref}`def-inelastic-collision-update`, the algorithm sets:\n941: \n942: $$\n943: x_{\\text{new}} = x_j + \\xi, \\quad \\xi \\sim \\mathcal{N}(0, \\sigma_x^2 I)\n944: $$\n945: \n946: This is a **small random displacement** from the optimal position $x_j$. The noise serves an **exploratory purpose** (breaking symmetry, preventing premature convergence) while keeping the birth position near the HK-optimal location.\n947: \n948: **In the zero-noise limit** $\\sigma_x \\to 0$:\n949: \n950: $$\n951: x_{\\text{new}} \\to x_j \\quad \\text{(the HK-optimal position)}\n952: $$\n953: \n954: **Geometric Interpretation**: The **spatial coordinate** of the scutoid's mid-level vertex represents the birth position $x_{\\text{new}}$. Its **temporal coordinate** $t_{\\text{mid}} = t + \\Delta t/2$ corresponds to the algorithmic cloning timestep ({prf:ref}`prop-algorithmic-midpoint`).\n955: \n956: **Conclusion**: The placement of mid-level vertices at parent locations (plus small exploratory noise) directly follows from **minimizing the Hellinger-Kantorovich energy functional**. This is not a modeling choice but a mathematical necessity.",
      "metadata": {},
      "section": "## 4. Energy Functional: Hellinger-Kantorovich Distance",
      "raw_directive": "882: :::\n883: \n884: :::{prf:proof} Two-Part Variational Argument\n885: \n886: The proof decomposes the HK energy according to the algorithm's two-stage structure: persistent walker transport (geodesic ruling of prisms) and cloning events (mid-level vertices).\n887: \n888: **Part 1: Geodesic Ruling for Persistent Walkers**\n889: \n890: For the subset $\\mathcal{P}(t)$ of walkers not involved in cloning, the transport component of the HK energy reduces to the squared Wasserstein-2 distance:\n891: \n892: $$\n893: W_2^2(\\mu_t|_{\\mathcal{P}}, \\mu_{t+\\Delta t}|_{\\mathcal{P}}) = \\inf_{\\pi} \\int_{\\mathcal{X} \\times \\mathcal{X}} d_g(x, y)^2 \\, d\\pi(x, y)\n894: $$\n895: \n896: The algorithm defines a specific transport plan: each walker $i \\in \\mathcal{P}$ moves from $x_i(t)$ to $x_i(t + \\Delta t)$ along a path $\\gamma_i(s)$ for $s \\in [t, t + \\Delta t]$ governed by the Langevin dynamics:\n897: \n898: $$\n899: dv_i = [-\\nabla U_{\\text{eff}}(x_i) - \\gamma v_i] dt + \\Sigma_{\\text{reg}}(x_i) \\circ dW_i\n900: $$\n901: \n902: **Least Action Principle**: The cost associated with path $\\gamma_i$ is:\n903: \n904: $$\n905: C[\\gamma_i] = \\int_t^{t+\\Delta t} L(\\gamma_i(s), \\dot{\\gamma}_i(s)) \\, ds\n906: $$\n907: \n908: where the Lagrangian is $L(x, v) = \\frac{1}{2} g_{ab}(x) v^a v^b$ (kinetic energy in the emergent metric).\n909: \n910: The paths that **minimize** this action are precisely the **geodesics** of the spacetime metric $g_{\\text{ST}}$ (Euler-Lagrange equations).\n911: \n912: **In the low-noise limit** ($\\Sigma_{\\text{reg}} \\to 0$), the Langevin SDE becomes deterministic:\n913: \n914: $$\n915: \\ddot{x}_i + \\gamma \\dot{x}_i + g(x_i)^{-1} \\nabla U_{\\text{eff}}(x_i) = 0\n916: $$\n917: \n918: This is the **damped geodesic equation** on the manifold $(\\mathcal{X}, g)$. For high friction $\\gamma \\gg 1$ and zero potential gradient, this reduces exactly to geodesic flow.\n919: \n920: **Conclusion**: The geodesic ruling of scutoid lateral faces (connecting persistent walkers) is the **natural geometric consequence** of the Langevin dynamics minimizing transport cost in the emergent Riemannian geometry.\n921: \n922: **Part 2: Optimal Mid-Level Vertex Placement from Cloning**\n923: \n924: Consider a cloning event where walker $i$ at $x_i$ (to be destroyed) is replaced by a clone of walker $j$ at $x_j$ (the parent). The HK cost contribution for this event is:\n925: \n926: $$\n927: C_{\\text{clone}}(x_{\\text{new}}) = \\frac{1}{4\\alpha} d_g(x_j, x_{\\text{new}})^2 + \\alpha \\left[ \\text{KL}(\\text{creation at } x_{\\text{new}}) + \\text{KL}(\\text{destruction at } x_i) \\right]\n928: $$\n929: \n930: where $x_{\\text{new}}$ is the birth position of the new walker.\n931: \n932: **Minimization**: The KL terms for discrete creation/destruction of mass $m = 1/N$ are **constants** (independent of $x_{\\text{new}}$). The only position-dependent term is the transport cost:\n933: \n934: $$\n935: \\frac{\\partial C_{\\text{clone}}}{\\partial x_{\\text{new}}} = \\frac{1}{2\\alpha} \\nabla_{x_{\\text{new}}} d_g(x_j, x_{\\text{new}})^2\n936: $$\n937: \n938: This gradient vanishes when $x_{\\text{new}} = x_j$, i.e., when the new walker is born at the **exact location of the parent**.\n939: \n940: **Algorithm Implementation**: From {prf:ref}`def-inelastic-collision-update`, the algorithm sets:\n941: \n942: $$\n943: x_{\\text{new}} = x_j + \\xi, \\quad \\xi \\sim \\mathcal{N}(0, \\sigma_x^2 I)\n944: $$\n945: \n946: This is a **small random displacement** from the optimal position $x_j$. The noise serves an **exploratory purpose** (breaking symmetry, preventing premature convergence) while keeping the birth position near the HK-optimal location.\n947: \n948: **In the zero-noise limit** $\\sigma_x \\to 0$:\n949: \n950: $$\n951: x_{\\text{new}} \\to x_j \\quad \\text{(the HK-optimal position)}\n952: $$\n953: \n954: **Geometric Interpretation**: The **spatial coordinate** of the scutoid's mid-level vertex represents the birth position $x_{\\text{new}}$. Its **temporal coordinate** $t_{\\text{mid}} = t + \\Delta t/2$ corresponds to the algorithmic cloning timestep ({prf:ref}`prop-algorithmic-midpoint`).\n955: \n956: **Conclusion**: The placement of mid-level vertices at parent locations (plus small exploratory noise) directly follows from **minimizing the Hellinger-Kantorovich energy functional**. This is not a modeling choice but a mathematical necessity.\n957: "
    },
    {
      "directive_type": "remark",
      "label": "rem-biological-connection",
      "title": "Connection to Biological Scutoids",
      "start_line": 959,
      "end_line": 969,
      "header_lines": [
        960
      ],
      "content_start": 962,
      "content_end": 968,
      "content": "962: :label: rem-biological-connection\n963: \n964: The biological result of G\u00f3mez-G\u00e1lvez et al. (2018) showed that scutoids minimize packing energy in curved epithelial tissue. Our theorem proves an analogous result for algorithmic dynamics: scutoids minimize the **information-geometric cost** (HK distance) of swarm reconfiguration.\n965: \n966: This is not mere analogy\u2014both systems optimize under geometric constraints:\n967: - **Biology**: Minimize surface tension subject to volume filling\n968: - **Fragile Gas**: Minimize HK distance subject to genealogical constraints",
      "metadata": {
        "label": "rem-biological-connection"
      },
      "section": "## 4. Energy Functional: Hellinger-Kantorovich Distance",
      "raw_directive": "959: :::\n960: \n961: :::{prf:remark} Connection to Biological Scutoids\n962: :label: rem-biological-connection\n963: \n964: The biological result of G\u00f3mez-G\u00e1lvez et al. (2018) showed that scutoids minimize packing energy in curved epithelial tissue. Our theorem proves an analogous result for algorithmic dynamics: scutoids minimize the **information-geometric cost** (HK distance) of swarm reconfiguration.\n965: \n966: This is not mere analogy\u2014both systems optimize under geometric constraints:\n967: - **Biology**: Minimize surface tension subject to volume filling\n968: - **Fragile Gas**: Minimize HK distance subject to genealogical constraints\n969: "
    },
    {
      "directive_type": "remark",
      "label": "rem-noise-regularization",
      "title": "Exploratory Noise as Regularization",
      "start_line": 971,
      "end_line": 979,
      "header_lines": [
        972
      ],
      "content_start": 974,
      "content_end": 978,
      "content": "974: :label: rem-noise-regularization\n975: \n976: The small noise term $\\xi$ in the cloning birth position serves dual purposes:\n977: 1. **Algorithmic**: Prevents exact overlap of walkers, maintaining diversity\n978: 2. **Mathematical**: Regularizes the HK problem, ensuring uniqueness of the optimal plan",
      "metadata": {
        "label": "rem-noise-regularization"
      },
      "section": "## 4. Energy Functional: Hellinger-Kantorovich Distance",
      "raw_directive": "971: :::\n972: \n973: :::{prf:remark} Exploratory Noise as Regularization\n974: :label: rem-noise-regularization\n975: \n976: The small noise term $\\xi$ in the cloning birth position serves dual purposes:\n977: 1. **Algorithmic**: Prevents exact overlap of walkers, maintaining diversity\n978: 2. **Mathematical**: Regularizes the HK problem, ensuring uniqueness of the optimal plan\n979: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}