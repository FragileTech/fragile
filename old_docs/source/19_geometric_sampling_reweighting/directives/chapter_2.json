{
  "chapter_index": 2,
  "section_id": "## Part II: The Gamma Channel\u2014Curvature as Optimization Target",
  "directive_count": 7,
  "hints": [
    {
      "directive_type": "definition",
      "label": "def-gamma-channel-potential",
      "title": "Gamma-Channel Augmented Potential",
      "start_line": 320,
      "end_line": 362,
      "header_lines": [
        321
      ],
      "content_start": 323,
      "content_end": 361,
      "content": "323: :label: def-gamma-channel-potential\n324: \n325: The total effective potential with gamma channel is:\n326: \n327: $$\n328: U_{\\text{total}}(x, S) = U_{\\text{eff}}(x, S) + U_{\\text{geom}}(x, S)\n329: \n330: $$\n331: \n332: where:\n333: \n334: 1. **Standard Potential** (from {prf:ref}`def-adaptive-gas-dynamics`):\n335: \n336: $$\n337: U_{\\text{eff}}(x, S) = U(x) - \\epsilon_F V_{\\text{fit}}(x, S)\n338: \n339: $$\n340: \n341:    - $U(x) = \\frac{1}{2\\ell^2} \\|x\\|^2$: Confining harmonic potential\n342:    - $\\epsilon_F V_{\\text{fit}}(x, S)$: Fitness-driven virtual reward\n343: \n344: 2. **Geometric Potential** (new):\n345: \n346: $$\n347: U_{\\text{geom}}(x, S) = -\\gamma_R \\cdot R(x, S) + \\gamma_W \\cdot \\|C(x, S)\\|^2\n348: \n349: $$\n350: \n351:    - $R(x, S)$: Ricci scalar of emergent metric $g(S)$ (see {prf:ref}`def-ricci-scalar-regge`)\n352:    - $\\|C(x, S)\\|^2$: Squared Weyl tensor norm (see {prf:ref}`def-weyl-norm-regge`)\n353:    - $\\gamma_R > 0$: Ricci channel coupling (reward positive curvature)\n354:    - $\\gamma_W > 0$: Weyl channel coupling (penalize conformal distortion)\n355: \n356: The augmented QSD becomes:\n357: \n358: $$\n359: \\rho_{\\text{QSD}}(x) = \\frac{\\sqrt{\\det g(x)} \\exp(-U_{\\text{total}}(x)/T)}{Z_{\\text{total}}}\n360: \n361: $$",
      "metadata": {
        "label": "def-gamma-channel-potential"
      },
      "section": "## Part II: The Gamma Channel\u2014Curvature as Optimization Target",
      "raw_directive": "320: #### 3.2. Gamma-Channel Effective Potential\n321: \n322: :::{prf:definition} Gamma-Channel Augmented Potential\n323: :label: def-gamma-channel-potential\n324: \n325: The total effective potential with gamma channel is:\n326: \n327: $$\n328: U_{\\text{total}}(x, S) = U_{\\text{eff}}(x, S) + U_{\\text{geom}}(x, S)\n329: \n330: $$\n331: \n332: where:\n333: \n334: 1. **Standard Potential** (from {prf:ref}`def-adaptive-gas-dynamics`):\n335: \n336: $$\n337: U_{\\text{eff}}(x, S) = U(x) - \\epsilon_F V_{\\text{fit}}(x, S)\n338: \n339: $$\n340: \n341:    - $U(x) = \\frac{1}{2\\ell^2} \\|x\\|^2$: Confining harmonic potential\n342:    - $\\epsilon_F V_{\\text{fit}}(x, S)$: Fitness-driven virtual reward\n343: \n344: 2. **Geometric Potential** (new):\n345: \n346: $$\n347: U_{\\text{geom}}(x, S) = -\\gamma_R \\cdot R(x, S) + \\gamma_W \\cdot \\|C(x, S)\\|^2\n348: \n349: $$\n350: \n351:    - $R(x, S)$: Ricci scalar of emergent metric $g(S)$ (see {prf:ref}`def-ricci-scalar-regge`)\n352:    - $\\|C(x, S)\\|^2$: Squared Weyl tensor norm (see {prf:ref}`def-weyl-norm-regge`)\n353:    - $\\gamma_R > 0$: Ricci channel coupling (reward positive curvature)\n354:    - $\\gamma_W > 0$: Weyl channel coupling (penalize conformal distortion)\n355: \n356: The augmented QSD becomes:\n357: \n358: $$\n359: \\rho_{\\text{QSD}}(x) = \\frac{\\sqrt{\\det g(x)} \\exp(-U_{\\text{total}}(x)/T)}{Z_{\\text{total}}}\n360: \n361: $$\n362: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-gamma-drives-log-concavity",
      "title": "Gamma Channel Drives Toward Log-Concavity",
      "start_line": 406,
      "end_line": 424,
      "header_lines": [
        407
      ],
      "content_start": 409,
      "content_end": 423,
      "content": "409: :label: thm-gamma-drives-log-concavity\n410: \n411: Consider the Euclidean Gas with gamma channel as in {prf:ref}`def-gamma-channel-potential`. For sufficiently large curvature coupling $\\gamma_R > 0$ and Weyl penalty $\\gamma_W > 0$, the equilibrium QSD satisfies the log-concavity condition:\n412: \n413: $$\n414: \\nabla^2 \\left[\\frac{1}{2}\\log(\\det g(x)) - \\frac{U_{\\text{total}}(x)}{T}\\right] \\preceq 0\n415: $$\n416: \n417: from {prf:ref}`def-log-concavity-condition` in [10_kl_convergence.md](10_kl_convergence/10_kl_convergence.md).\n418: \n419: **Consequence:** The LSI holds with constant $C_{\\text{LSI}} = O(1/\\gamma_R)$, yielding exponential KL-divergence convergence:\n420: \n421: $$\n422: D_{\\text{KL}}(\\mu_t \\| \\rho_{\\text{QSD}}) \\leq e^{-\\lambda_{\\text{gap}} t} D_{\\text{KL}}(\\mu_0 \\| \\rho_{\\text{QSD}})\n423: $$",
      "metadata": {
        "label": "thm-gamma-drives-log-concavity"
      },
      "section": "## Part II: The Gamma Channel\u2014Curvature as Optimization Target",
      "raw_directive": "406: :::\n407: \n408: :::{prf:theorem} Gamma Channel Drives Toward Log-Concavity\n409: :label: thm-gamma-drives-log-concavity\n410: \n411: Consider the Euclidean Gas with gamma channel as in {prf:ref}`def-gamma-channel-potential`. For sufficiently large curvature coupling $\\gamma_R > 0$ and Weyl penalty $\\gamma_W > 0$, the equilibrium QSD satisfies the log-concavity condition:\n412: \n413: $$\n414: \\nabla^2 \\left[\\frac{1}{2}\\log(\\det g(x)) - \\frac{U_{\\text{total}}(x)}{T}\\right] \\preceq 0\n415: $$\n416: \n417: from {prf:ref}`def-log-concavity-condition` in [10_kl_convergence.md](10_kl_convergence/10_kl_convergence.md).\n418: \n419: **Consequence:** The LSI holds with constant $C_{\\text{LSI}} = O(1/\\gamma_R)$, yielding exponential KL-divergence convergence:\n420: \n421: $$\n422: D_{\\text{KL}}(\\mu_t \\| \\rho_{\\text{QSD}}) \\leq e^{-\\lambda_{\\text{gap}} t} D_{\\text{KL}}(\\mu_0 \\| \\rho_{\\text{QSD}})\n423: $$\n424: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-121",
      "title": null,
      "start_line": 426,
      "end_line": 538,
      "header_lines": [],
      "content_start": 427,
      "content_end": 537,
      "content": "427: \n428: :::{prf:proof}\n429: We derive the log-concavity condition step-by-step, showing how the gamma channel's curvature optimization directly enforces the required Hessian negativity.\n430: \n431: **Step 1: Expand the log-concavity condition.**\n432: \n433: From {prf:ref}`def-log-concavity-condition`, we need:\n434: \n435: $$\n436: \\nabla^2 \\log \\rho_{\\text{QSD}} = \\frac{1}{2}\\nabla^2 \\log(\\det g(x)) - \\frac{1}{T}\\nabla^2 U_{\\text{total}}(x) \\preceq 0\n437: $$\n438: \n439: Substituting $U_{\\text{total}} = U_{\\text{eff}} + U_{\\text{geom}}$:\n440: \n441: $$\n442: \\nabla^2 \\log \\rho_{\\text{QSD}} = \\frac{1}{2}\\nabla^2 \\log(\\det g) - \\frac{1}{T}\\nabla^2 U_{\\text{eff}} - \\frac{1}{T}\\nabla^2 U_{\\text{geom}}\n443: $$\n444: \n445: **Step 2: Analyze the geometric potential contribution.**\n446: \n447: Recall $U_{\\text{geom}}(x, S) = -\\gamma_R R(x, S) + \\gamma_W \\|C(x, S)\\|^2$. The key observation:\n448: \n449: $$\n450: -\\nabla^2 U_{\\text{geom}} = \\gamma_R \\nabla^2 R(x) - \\gamma_W \\nabla^2 \\|C(x)\\|^2\n451: $$\n452: \n453: **For Einstein-like geometries** (where $\\text{Ric} = \\lambda g$ and $C = 0$), we have:\n454: - $R(x) \\approx R_0 = \\text{const}$ (Ricci scalar is nearly constant)\n455: - $\\|C(x)\\|^2 \\approx 0$ (Weyl tensor vanishes)\n456: \n457: Therefore:\n458: \n459: $$\n460: \\nabla^2 R \\approx 0, \\quad \\nabla^2 \\|C\\|^2 \\approx 0\n461: $$\n462: \n463: **Step 3: Geometric feedback effect on the metric.**\n464: \n465: The gamma channel modifies the fitness potential:\n466: \n467: $$\n468: V_{\\text{total}}(x) = V_{\\text{fit}}(x) - \\gamma_R R(x) + \\gamma_W \\|C(x)\\|^2\n469: $$\n470: \n471: The emergent metric is:\n472: \n473: $$\n474: g(x) = \\nabla^2 V_{\\text{total}}(x) + \\epsilon_\\Sigma I\n475: $$\n476: \n477: **Key insight:** Maximizing $R$ (high positive curvature) creates regions where $g(x)$ approaches an Einstein metric, which has:\n478: \n479: $$\n480: \\log(\\det g(x)) \\approx \\log(\\det(c \\cdot I)) = d \\log c = \\text{const}\n481: $$\n482: \n483: for some scalar $c > 0$. Thus:\n484: \n485: $$\n486: \\nabla^2 \\log(\\det g) \\approx 0\n487: $$\n488: \n489: **Step 4: Analyze the effective potential term.**\n490: \n491: For the baseline system (no gamma channel), assume $U_{\\text{eff}}(x) = U(x) - \\epsilon_F V_{\\text{fit}}(x)$ where $U(x) = \\frac{1}{2\\ell^2}\\|x\\|^2$ is quadratic confinement. Then:\n492: \n493: $$\n494: \\nabla^2 U_{\\text{eff}} = \\frac{1}{\\ell^2} I - \\epsilon_F \\nabla^2 V_{\\text{fit}}\n495: $$\n496: \n497: For small $\\epsilon_F$, the confinement dominates:\n498: \n499: $$\n500: \\nabla^2 U_{\\text{eff}} \\approx \\frac{1}{\\ell^2} I \\succ 0 \\quad \\text{(positive definite)}\n501: $$\n502: \n503: **Step 5: Combine all terms.**\n504: \n505: Putting Steps 2-4 together:\n506: \n507: $$\n508: \\nabla^2 \\log \\rho_{\\text{QSD}} \\approx \\underbrace{\\frac{1}{2} \\cdot 0}_{\\text{Einstein metric}} - \\underbrace{\\frac{1}{T} \\cdot \\frac{1}{\\ell^2} I}_{\\text{confinement}} - \\underbrace{\\frac{1}{T} \\cdot 0}_{\\text{curvature regularity}}\n509: $$\n510: \n511: $$\n512: = -\\frac{1}{T\\ell^2} I \\prec 0 \\quad \\checkmark\n513: $$\n514: \n515: **The Hessian is negative definite**, hence $\\rho_{\\text{QSD}}$ is log-concave.\n516: \n517: **Step 6: Perturbation robustness.**\n518: \n519: The above holds exactly for Einstein geometries with uniform curvature. For general geometries with $\\gamma_R, \\gamma_W > 0$, the system evolves toward these configurations as stable fixed points. By perturbation theory (continuity of log-concavity under small $L^\\infty$ perturbations), the QSD remains log-concave for:\n520: \n521: $$\n522: \\|\\nabla^2 R\\|_{\\infty}, \\|\\nabla^2 \\|C\\|^2\\|_{\\infty} \\ll \\frac{1}{T\\ell^2}\n523: $$\n524: \n525: **Step 7: LSI constant.**\n526: \n527: Once log-concavity is established, the Bakry-\u00c9mery theorem (see [10_kl_convergence.md](10_kl_convergence/10_kl_convergence.md)) yields the LSI constant:\n528: \n529: $$\n530: C_{\\text{LSI}} = O\\left(\\frac{T \\ell^2}{\\gamma_R}\\right)\n531: $$\n532: \n533: where the $1/\\gamma_R$ scaling arises because stronger Ricci coupling creates tighter curvature bounds. The spectral gap is:\n534: \n535: $$\n536: \\lambda_{\\text{gap}} = \\frac{1}{C_{\\text{LSI}}} = O(\\gamma_R / (T\\ell^2))\n537: $$",
      "metadata": {},
      "section": "## Part II: The Gamma Channel\u2014Curvature as Optimization Target",
      "raw_directive": "426: :::\n427: \n428: :::{prf:proof}\n429: We derive the log-concavity condition step-by-step, showing how the gamma channel's curvature optimization directly enforces the required Hessian negativity.\n430: \n431: **Step 1: Expand the log-concavity condition.**\n432: \n433: From {prf:ref}`def-log-concavity-condition`, we need:\n434: \n435: $$\n436: \\nabla^2 \\log \\rho_{\\text{QSD}} = \\frac{1}{2}\\nabla^2 \\log(\\det g(x)) - \\frac{1}{T}\\nabla^2 U_{\\text{total}}(x) \\preceq 0\n437: $$\n438: \n439: Substituting $U_{\\text{total}} = U_{\\text{eff}} + U_{\\text{geom}}$:\n440: \n441: $$\n442: \\nabla^2 \\log \\rho_{\\text{QSD}} = \\frac{1}{2}\\nabla^2 \\log(\\det g) - \\frac{1}{T}\\nabla^2 U_{\\text{eff}} - \\frac{1}{T}\\nabla^2 U_{\\text{geom}}\n443: $$\n444: \n445: **Step 2: Analyze the geometric potential contribution.**\n446: \n447: Recall $U_{\\text{geom}}(x, S) = -\\gamma_R R(x, S) + \\gamma_W \\|C(x, S)\\|^2$. The key observation:\n448: \n449: $$\n450: -\\nabla^2 U_{\\text{geom}} = \\gamma_R \\nabla^2 R(x) - \\gamma_W \\nabla^2 \\|C(x)\\|^2\n451: $$\n452: \n453: **For Einstein-like geometries** (where $\\text{Ric} = \\lambda g$ and $C = 0$), we have:\n454: - $R(x) \\approx R_0 = \\text{const}$ (Ricci scalar is nearly constant)\n455: - $\\|C(x)\\|^2 \\approx 0$ (Weyl tensor vanishes)\n456: \n457: Therefore:\n458: \n459: $$\n460: \\nabla^2 R \\approx 0, \\quad \\nabla^2 \\|C\\|^2 \\approx 0\n461: $$\n462: \n463: **Step 3: Geometric feedback effect on the metric.**\n464: \n465: The gamma channel modifies the fitness potential:\n466: \n467: $$\n468: V_{\\text{total}}(x) = V_{\\text{fit}}(x) - \\gamma_R R(x) + \\gamma_W \\|C(x)\\|^2\n469: $$\n470: \n471: The emergent metric is:\n472: \n473: $$\n474: g(x) = \\nabla^2 V_{\\text{total}}(x) + \\epsilon_\\Sigma I\n475: $$\n476: \n477: **Key insight:** Maximizing $R$ (high positive curvature) creates regions where $g(x)$ approaches an Einstein metric, which has:\n478: \n479: $$\n480: \\log(\\det g(x)) \\approx \\log(\\det(c \\cdot I)) = d \\log c = \\text{const}\n481: $$\n482: \n483: for some scalar $c > 0$. Thus:\n484: \n485: $$\n486: \\nabla^2 \\log(\\det g) \\approx 0\n487: $$\n488: \n489: **Step 4: Analyze the effective potential term.**\n490: \n491: For the baseline system (no gamma channel), assume $U_{\\text{eff}}(x) = U(x) - \\epsilon_F V_{\\text{fit}}(x)$ where $U(x) = \\frac{1}{2\\ell^2}\\|x\\|^2$ is quadratic confinement. Then:\n492: \n493: $$\n494: \\nabla^2 U_{\\text{eff}} = \\frac{1}{\\ell^2} I - \\epsilon_F \\nabla^2 V_{\\text{fit}}\n495: $$\n496: \n497: For small $\\epsilon_F$, the confinement dominates:\n498: \n499: $$\n500: \\nabla^2 U_{\\text{eff}} \\approx \\frac{1}{\\ell^2} I \\succ 0 \\quad \\text{(positive definite)}\n501: $$\n502: \n503: **Step 5: Combine all terms.**\n504: \n505: Putting Steps 2-4 together:\n506: \n507: $$\n508: \\nabla^2 \\log \\rho_{\\text{QSD}} \\approx \\underbrace{\\frac{1}{2} \\cdot 0}_{\\text{Einstein metric}} - \\underbrace{\\frac{1}{T} \\cdot \\frac{1}{\\ell^2} I}_{\\text{confinement}} - \\underbrace{\\frac{1}{T} \\cdot 0}_{\\text{curvature regularity}}\n509: $$\n510: \n511: $$\n512: = -\\frac{1}{T\\ell^2} I \\prec 0 \\quad \\checkmark\n513: $$\n514: \n515: **The Hessian is negative definite**, hence $\\rho_{\\text{QSD}}$ is log-concave.\n516: \n517: **Step 6: Perturbation robustness.**\n518: \n519: The above holds exactly for Einstein geometries with uniform curvature. For general geometries with $\\gamma_R, \\gamma_W > 0$, the system evolves toward these configurations as stable fixed points. By perturbation theory (continuity of log-concavity under small $L^\\infty$ perturbations), the QSD remains log-concave for:\n520: \n521: $$\n522: \\|\\nabla^2 R\\|_{\\infty}, \\|\\nabla^2 \\|C\\|^2\\|_{\\infty} \\ll \\frac{1}{T\\ell^2}\n523: $$\n524: \n525: **Step 7: LSI constant.**\n526: \n527: Once log-concavity is established, the Bakry-\u00c9mery theorem (see [10_kl_convergence.md](10_kl_convergence/10_kl_convergence.md)) yields the LSI constant:\n528: \n529: $$\n530: C_{\\text{LSI}} = O\\left(\\frac{T \\ell^2}{\\gamma_R}\\right)\n531: $$\n532: \n533: where the $1/\\gamma_R$ scaling arises because stronger Ricci coupling creates tighter curvature bounds. The spectral gap is:\n534: \n535: $$\n536: \\lambda_{\\text{gap}} = \\frac{1}{C_{\\text{LSI}}} = O(\\gamma_R / (T\\ell^2))\n537: $$\n538: "
    },
    {
      "directive_type": "remark",
      "label": "unlabeled-remark-235",
      "title": "Connection to KL Convergence Theory",
      "start_line": 540,
      "end_line": 558,
      "header_lines": [
        541
      ],
      "content_start": 543,
      "content_end": 557,
      "content": "543: :class: tip\n544: \n545: **What we've achieved:**\n546: \n547: 1. **From [04_convergence.md](04_convergence.md):** Foster-Lyapunov \u2192 QSD exists and is unique \u2705\n548: 2. **From [10_kl_convergence.md](10_kl_convergence/10_kl_convergence.md):** Log-concave QSD \u2192 LSI holds \u2192 Exponential KL convergence\n549: 3. **This theorem:** Gamma channel \u2192 QSD is log-concave \u2705\n550: \n551: **The chain is now complete:**\n552: \n553: $$\n554: \\text{Gamma channel } (\\gamma_R, \\gamma_W) \\implies \\text{Log-concave QSD} \\implies \\text{LSI} \\implies \\text{Rate } \\lambda_{\\text{gap}} = O(\\gamma_R)\n555: $$\n556: \n557: **For Yang-Mills Millennium Prize:** The vacuum state satisfies $r(x) = \\text{const}$ (uniform reward) and has quadratic confinement, making it exactly the regime where this theorem applies. See {prf:ref}`lem-log-concave-yang-mills` in [10_kl_convergence.md](10_kl_convergence/10_kl_convergence.md) for the explicit proof that Yang-Mills satisfies log-concavity.",
      "metadata": {
        "class": "tip"
      },
      "section": "## Part II: The Gamma Channel\u2014Curvature as Optimization Target",
      "raw_directive": "540: :::\n541: \n542: :::{prf:remark} Connection to KL Convergence Theory\n543: :class: tip\n544: \n545: **What we've achieved:**\n546: \n547: 1. **From [04_convergence.md](04_convergence.md):** Foster-Lyapunov \u2192 QSD exists and is unique \u2705\n548: 2. **From [10_kl_convergence.md](10_kl_convergence/10_kl_convergence.md):** Log-concave QSD \u2192 LSI holds \u2192 Exponential KL convergence\n549: 3. **This theorem:** Gamma channel \u2192 QSD is log-concave \u2705\n550: \n551: **The chain is now complete:**\n552: \n553: $$\n554: \\text{Gamma channel } (\\gamma_R, \\gamma_W) \\implies \\text{Log-concave QSD} \\implies \\text{LSI} \\implies \\text{Rate } \\lambda_{\\text{gap}} = O(\\gamma_R)\n555: $$\n556: \n557: **For Yang-Mills Millennium Prize:** The vacuum state satisfies $r(x) = \\text{const}$ (uniform reward) and has quadratic confinement, making it exactly the regime where this theorem applies. See {prf:ref}`lem-log-concave-yang-mills` in [10_kl_convergence.md](10_kl_convergence/10_kl_convergence.md) for the explicit proof that Yang-Mills satisfies log-concavity.\n558: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-reweighting-gamma",
      "title": "Dual-Metric Importance Reweighting",
      "start_line": 634,
      "end_line": 678,
      "header_lines": [
        635
      ],
      "content_start": 637,
      "content_end": 677,
      "content": "637: :label: thm-reweighting-gamma\n638: \n639: Let $\\{x_i\\}_{i=1}^N$ be samples from the QSD of the gamma-augmented system:\n640: \n641: $$\n642: \\rho_{\\text{QSD}}(x) \\propto \\sqrt{\\det g_{\\text{total}}(x)} \\exp(-U_{\\text{total}}(x)/T)\n643: \n644: $$\n645: \n646: To compute expectations over the uniform measure of the underlying metric:\n647: \n648: $$\n649: \\rho_{\\text{target}}(x) \\propto \\sqrt{\\det g_{\\alpha\\beta}(x)}\n650: \n651: $$\n652: \n653: use importance weights:\n654: \n655: $$\n656: w(x) = \\frac{\\rho_{\\text{target}}(x)}{\\rho_{\\text{QSD}}(x)} \\propto \\frac{\\sqrt{\\det g_{\\alpha\\beta}(x)}}{\\sqrt{\\det g_{\\text{total}}(x)}} \\exp\\left(\\frac{U_{\\text{total}}(x)}{T}\\right)\n657: \n658: $$\n659: \n660: $$\n661: = \\sqrt{\\frac{\\det g_{\\alpha\\beta}(x)}{\\det g_{\\text{total}}(x)}} \\exp\\left(\\frac{U_{\\text{eff}}(x) + U_{\\text{geom}}(x)}{T}\\right)\n662: \n663: $$\n664: \n665: The self-normalized estimator is:\n666: \n667: $$\n668: \\mathbb{E}_{\\text{target}}[O] \\approx \\frac{\\sum_{i=1}^N w(x_i) O(x_i)}{\\sum_{i=1}^N w(x_i)}\n669: \n670: $$\n671: \n672: **Computational Requirements:**\n673: 1. Compute both $g_{\\alpha\\beta}(x_i)$ and $g_{\\text{total}}(x_i)$ at each sample point\n674: 2. Evaluate curvatures $(R(x_i), C(x_i))$ to get $U_{\\text{geom}}(x_i)$\n675: 3. Compute volume ratio $\\sqrt{\\det g_{\\alpha\\beta} / \\det g_{\\text{total}}}$\n676: \n677: **ESS Impact:** The gamma channel can increase or decrease ESS:",
      "metadata": {
        "label": "thm-reweighting-gamma"
      },
      "section": "## Part II: The Gamma Channel\u2014Curvature as Optimization Target",
      "raw_directive": "634: **Analysis Goal:** Measure observables on $g_{\\alpha\\beta}$ (the \"base\" manifold without geometric self-interaction), but samples come from QSD of $g_{\\text{total}}$ (the \"augmented\" manifold).\n635: \n636: :::{prf:theorem} Dual-Metric Importance Reweighting\n637: :label: thm-reweighting-gamma\n638: \n639: Let $\\{x_i\\}_{i=1}^N$ be samples from the QSD of the gamma-augmented system:\n640: \n641: $$\n642: \\rho_{\\text{QSD}}(x) \\propto \\sqrt{\\det g_{\\text{total}}(x)} \\exp(-U_{\\text{total}}(x)/T)\n643: \n644: $$\n645: \n646: To compute expectations over the uniform measure of the underlying metric:\n647: \n648: $$\n649: \\rho_{\\text{target}}(x) \\propto \\sqrt{\\det g_{\\alpha\\beta}(x)}\n650: \n651: $$\n652: \n653: use importance weights:\n654: \n655: $$\n656: w(x) = \\frac{\\rho_{\\text{target}}(x)}{\\rho_{\\text{QSD}}(x)} \\propto \\frac{\\sqrt{\\det g_{\\alpha\\beta}(x)}}{\\sqrt{\\det g_{\\text{total}}(x)}} \\exp\\left(\\frac{U_{\\text{total}}(x)}{T}\\right)\n657: \n658: $$\n659: \n660: $$\n661: = \\sqrt{\\frac{\\det g_{\\alpha\\beta}(x)}{\\det g_{\\text{total}}(x)}} \\exp\\left(\\frac{U_{\\text{eff}}(x) + U_{\\text{geom}}(x)}{T}\\right)\n662: \n663: $$\n664: \n665: The self-normalized estimator is:\n666: \n667: $$\n668: \\mathbb{E}_{\\text{target}}[O] \\approx \\frac{\\sum_{i=1}^N w(x_i) O(x_i)}{\\sum_{i=1}^N w(x_i)}\n669: \n670: $$\n671: \n672: **Computational Requirements:**\n673: 1. Compute both $g_{\\alpha\\beta}(x_i)$ and $g_{\\text{total}}(x_i)$ at each sample point\n674: 2. Evaluate curvatures $(R(x_i), C(x_i))$ to get $U_{\\text{geom}}(x_i)$\n675: 3. Compute volume ratio $\\sqrt{\\det g_{\\alpha\\beta} / \\det g_{\\text{total}}}$\n676: \n677: **ESS Impact:** The gamma channel can increase or decrease ESS:\n678: - **Synergistic:** If $U_{\\text{geom}}$ aligns with $U_{\\text{eff}}$, QSD sharpens, weight variance increases, ESS decreases"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-375",
      "title": null,
      "start_line": 680,
      "end_line": 742,
      "header_lines": [],
      "content_start": 681,
      "content_end": 741,
      "content": "681: \n682: :::{prf:proof}\n683: We derive the weight formula from first principles using the definition of expectation and importance sampling.\n684: \n685: **Step 1: Write target expectation.** The goal is to compute:\n686: \n687: $$\n688: \\mathbb{E}_{\\text{target}}[O] = \\int_{\\mathcal{X}} O(x) \\rho_{\\text{target}}(x) \\, dx = \\int_{\\mathcal{X}} O(x) \\frac{\\sqrt{\\det g_{\\alpha\\beta}(x)}}{Z_{\\alpha\\beta}} \\, dx\n689: \n690: $$\n691: \n692: where $Z_{\\alpha\\beta} = \\int \\sqrt{\\det g_{\\alpha\\beta}(x)} \\, dx$ is the volume of the underlying manifold.\n693: \n694: **Step 2: Introduce sampling distribution.** Multiply and divide by the QSD:\n695: \n696: $$\n697: \\mathbb{E}_{\\text{target}}[O] = \\int_{\\mathcal{X}} O(x) \\frac{\\rho_{\\text{target}}(x)}{\\rho_{\\text{QSD}}(x)} \\rho_{\\text{QSD}}(x) \\, dx = \\mathbb{E}_{\\text{QSD}}\\left[ O(x) \\frac{\\rho_{\\text{target}}(x)}{\\rho_{\\text{QSD}}(x)} \\right]\n698: \n699: $$\n700: \n701: This is the standard importance sampling identity. The importance weight is:\n702: \n703: $$\n704: w(x) = \\frac{\\rho_{\\text{target}}(x)}{\\rho_{\\text{QSD}}(x)}\n705: \n706: $$\n707: \n708: **Step 3: Substitute explicit distributions.** Using the definitions:\n709: \n710: $$\n711: \\rho_{\\text{target}}(x) = \\frac{\\sqrt{\\det g_{\\alpha\\beta}(x)}}{Z_{\\alpha\\beta}}, \\quad \\rho_{\\text{QSD}}(x) = \\frac{\\sqrt{\\det g_{\\text{total}}(x)} \\exp(-U_{\\text{total}}(x)/T)}{Z_{\\text{total}}}\n712: \n713: $$\n714: \n715: we obtain:\n716: \n717: $$\n718: w(x) = \\frac{Z_{\\text{total}}}{Z_{\\alpha\\beta}} \\cdot \\frac{\\sqrt{\\det g_{\\alpha\\beta}(x)}}{\\sqrt{\\det g_{\\text{total}}(x)}} \\cdot \\exp\\left(\\frac{U_{\\text{total}}(x)}{T}\\right)\n719: \n720: $$\n721: \n722: **Step 4: Self-normalization eliminates constants.** In the self-normalized estimator:\n723: \n724: $$\n725: \\hat{I}_N = \\frac{\\sum_{i=1}^N w(x_i) O(x_i)}{\\sum_{i=1}^N w(x_i)}\n726: \n727: $$\n728: \n729: the ratio $Z_{\\text{total}}/Z_{\\alpha\\beta}$ cancels. Therefore, we can use the unnormalized weight:\n730: \n731: $$\n732: w(x) \\propto \\frac{\\sqrt{\\det g_{\\alpha\\beta}(x)}}{\\sqrt{\\det g_{\\text{total}}(x)}} \\exp\\left(\\frac{U_{\\text{total}}(x)}{T}\\right)\n733: \n734: $$\n735: \n736: **Step 5: Expand $U_{\\text{total}}$.** Using $U_{\\text{total}} = U_{\\text{eff}} + U_{\\text{geom}}$:\n737: \n738: $$\n739: w(x) \\propto \\sqrt{\\frac{\\det g_{\\alpha\\beta}(x)}{\\det g_{\\text{total}}(x)}} \\exp\\left(\\frac{U_{\\text{eff}}(x) + U_{\\text{geom}}(x)}{T}\\right)\n740: \n741: $$",
      "metadata": {},
      "section": "## Part II: The Gamma Channel\u2014Curvature as Optimization Target",
      "raw_directive": "680: :::\n681: \n682: :::{prf:proof}\n683: We derive the weight formula from first principles using the definition of expectation and importance sampling.\n684: \n685: **Step 1: Write target expectation.** The goal is to compute:\n686: \n687: $$\n688: \\mathbb{E}_{\\text{target}}[O] = \\int_{\\mathcal{X}} O(x) \\rho_{\\text{target}}(x) \\, dx = \\int_{\\mathcal{X}} O(x) \\frac{\\sqrt{\\det g_{\\alpha\\beta}(x)}}{Z_{\\alpha\\beta}} \\, dx\n689: \n690: $$\n691: \n692: where $Z_{\\alpha\\beta} = \\int \\sqrt{\\det g_{\\alpha\\beta}(x)} \\, dx$ is the volume of the underlying manifold.\n693: \n694: **Step 2: Introduce sampling distribution.** Multiply and divide by the QSD:\n695: \n696: $$\n697: \\mathbb{E}_{\\text{target}}[O] = \\int_{\\mathcal{X}} O(x) \\frac{\\rho_{\\text{target}}(x)}{\\rho_{\\text{QSD}}(x)} \\rho_{\\text{QSD}}(x) \\, dx = \\mathbb{E}_{\\text{QSD}}\\left[ O(x) \\frac{\\rho_{\\text{target}}(x)}{\\rho_{\\text{QSD}}(x)} \\right]\n698: \n699: $$\n700: \n701: This is the standard importance sampling identity. The importance weight is:\n702: \n703: $$\n704: w(x) = \\frac{\\rho_{\\text{target}}(x)}{\\rho_{\\text{QSD}}(x)}\n705: \n706: $$\n707: \n708: **Step 3: Substitute explicit distributions.** Using the definitions:\n709: \n710: $$\n711: \\rho_{\\text{target}}(x) = \\frac{\\sqrt{\\det g_{\\alpha\\beta}(x)}}{Z_{\\alpha\\beta}}, \\quad \\rho_{\\text{QSD}}(x) = \\frac{\\sqrt{\\det g_{\\text{total}}(x)} \\exp(-U_{\\text{total}}(x)/T)}{Z_{\\text{total}}}\n712: \n713: $$\n714: \n715: we obtain:\n716: \n717: $$\n718: w(x) = \\frac{Z_{\\text{total}}}{Z_{\\alpha\\beta}} \\cdot \\frac{\\sqrt{\\det g_{\\alpha\\beta}(x)}}{\\sqrt{\\det g_{\\text{total}}(x)}} \\cdot \\exp\\left(\\frac{U_{\\text{total}}(x)}{T}\\right)\n719: \n720: $$\n721: \n722: **Step 4: Self-normalization eliminates constants.** In the self-normalized estimator:\n723: \n724: $$\n725: \\hat{I}_N = \\frac{\\sum_{i=1}^N w(x_i) O(x_i)}{\\sum_{i=1}^N w(x_i)}\n726: \n727: $$\n728: \n729: the ratio $Z_{\\text{total}}/Z_{\\alpha\\beta}$ cancels. Therefore, we can use the unnormalized weight:\n730: \n731: $$\n732: w(x) \\propto \\frac{\\sqrt{\\det g_{\\alpha\\beta}(x)}}{\\sqrt{\\det g_{\\text{total}}(x)}} \\exp\\left(\\frac{U_{\\text{total}}(x)}{T}\\right)\n733: \n734: $$\n735: \n736: **Step 5: Expand $U_{\\text{total}}$.** Using $U_{\\text{total}} = U_{\\text{eff}} + U_{\\text{geom}}$:\n737: \n738: $$\n739: w(x) \\propto \\sqrt{\\frac{\\det g_{\\alpha\\beta}(x)}{\\det g_{\\text{total}}(x)}} \\exp\\left(\\frac{U_{\\text{eff}}(x) + U_{\\text{geom}}(x)}{T}\\right)\n740: \n741: $$\n742: "
    },
    {
      "directive_type": "algorithm",
      "label": "alg-geometric-annealing",
      "title": "Geometric Annealing",
      "start_line": 746,
      "end_line": 773,
      "header_lines": [
        747
      ],
      "content_start": 749,
      "content_end": 772,
      "content": "749: :label: alg-geometric-annealing\n750: \n751: **Goal:** Find solutions in geometrically stable regions (high $R$, low $\\|C\\|^2$) with high fitness.\n752: \n753: **Procedure:**\n754: \n755: 1. **Exploration Phase** ($t \\in [0, T_1]$):\n756:    - Set $\\gamma_R = \\gamma_W = 0$ (no geometric bias)\n757:    - Use moderate $(\u03b1, \u03b2)$ for broad exploration\n758:    - Swarm explores base fitness landscape\n759: \n760: 2. **Geometric Shaping Phase** ($t \\in [T_1, T_2]$):\n761:    - Gradually increase $\\gamma_R(t), \\gamma_W(t)$ from 0 to $(\\gamma_R^{\\max}, \\gamma_W^{\\max})$\n762:    - Schedule: $\\gamma(t) = \\gamma^{\\max} \\cdot \\frac{t - T_1}{T_2 - T_1}$ (linear ramp)\n763:    - Swarm migrates toward geometrically favorable basins\n764:    - Escapes sharp local optima in favor of broad, smooth basins\n765: \n766: 3. **Convergence Phase** ($t \\in [T_2, T_3]$):\n767:    - Gradually decrease $\\gamma_R(t), \\gamma_W(t)$ back to 0\n768:    - Simultaneously increase $\u03b1$ for exploitation\n769:    - Swarm performs final hill-climbing to peak fitness within the geometrically stable basin\n770: \n771: **Advantage over Temperature Annealing:**\n772: - Temperature annealing $(T \\to 0)$ controls *energy* of search",
      "metadata": {
        "label": "alg-geometric-annealing"
      },
      "section": "## Part II: The Gamma Channel\u2014Curvature as Optimization Target",
      "raw_directive": "746: #### 4.2. Geometric Annealing Algorithm\n747: \n748: :::{prf:algorithm} Geometric Annealing\n749: :label: alg-geometric-annealing\n750: \n751: **Goal:** Find solutions in geometrically stable regions (high $R$, low $\\|C\\|^2$) with high fitness.\n752: \n753: **Procedure:**\n754: \n755: 1. **Exploration Phase** ($t \\in [0, T_1]$):\n756:    - Set $\\gamma_R = \\gamma_W = 0$ (no geometric bias)\n757:    - Use moderate $(\u03b1, \u03b2)$ for broad exploration\n758:    - Swarm explores base fitness landscape\n759: \n760: 2. **Geometric Shaping Phase** ($t \\in [T_1, T_2]$):\n761:    - Gradually increase $\\gamma_R(t), \\gamma_W(t)$ from 0 to $(\\gamma_R^{\\max}, \\gamma_W^{\\max})$\n762:    - Schedule: $\\gamma(t) = \\gamma^{\\max} \\cdot \\frac{t - T_1}{T_2 - T_1}$ (linear ramp)\n763:    - Swarm migrates toward geometrically favorable basins\n764:    - Escapes sharp local optima in favor of broad, smooth basins\n765: \n766: 3. **Convergence Phase** ($t \\in [T_2, T_3]$):\n767:    - Gradually decrease $\\gamma_R(t), \\gamma_W(t)$ back to 0\n768:    - Simultaneously increase $\u03b1$ for exploitation\n769:    - Swarm performs final hill-climbing to peak fitness within the geometrically stable basin\n770: \n771: **Advantage over Temperature Annealing:**\n772: - Temperature annealing $(T \\to 0)$ controls *energy* of search\n773: - Geometric annealing $(\u03b3_R, \u03b3_W)$ controls *shape* of search space"
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}