{
  "chapter_index": 9,
  "section_id": "## 9. Connections to Theoretical Framework",
  "directive_count": 8,
  "hints": [
    {
      "directive_type": "proposition",
      "label": "prop-scutoid-minimality",
      "title": "Principle of Minimal Geometric Encoding",
      "start_line": 1028,
      "end_line": 1048,
      "header_lines": [
        1029
      ],
      "content_start": 1031,
      "content_end": 1047,
      "content": "1031: :label: prop-scutoid-minimality\n1032: \n1033: The scutoid tessellation of spacetime provides a **minimal information-theoretic encoding** of the data required to maintain the Delaunay triangulation online via incremental updates.\n1034: \n1035: **Argument**:\n1036: \n1037: 1. **Information Requirements**: To update DT(t) \u2192 DT(t+\u0394t) incrementally, an algorithm must know:\n1038:    - Which walkers moved, and by how much (displacement vectors)\n1039:    - Which walkers were deleted/inserted (cloning events with parent-child relationships)\n1040: \n1041:    This information is precisely encoded by the CST edges E_CST between time slices.\n1042: \n1043: 2. **Sufficiency of CST**: Given the CST edges, we can perform the exact sequence of geometric updates (Lawson flips for moved vertices, delete-insert for cloned vertices) to obtain DT(t+\u0394t) from DT(t), as demonstrated by Algorithm {prf:ref}`alg-online-triangulation`.\n1044: \n1045: 3. **Geometric Realization**: The scutoid tessellation is the Voronoi diagram of the spacetime point set V \u2282 \u211d^(d+1), which provides the dual Delaunay triangulation of V. This triangulation encodes the CST combinatorially: vertices of the spacetime triangulation correspond to walker events, and simplices connect causally related events.\n1046: \n1047: 4. **Minimality (Information-Theoretic Sense)**: Any data structure that enables correct incremental triangulation updates must encode at least the information content of the CST (the displacement of each walker or its cloning relationship). The scutoid tessellation achieves this bound\u2014it encodes exactly this information, with no redundant data.",
      "metadata": {
        "label": "prop-scutoid-minimality"
      },
      "section": "## 9. Connections to Theoretical Framework",
      "references": [
        "alg-online-triangulation"
      ],
      "raw_directive": "1028: ### 9.1 Scutoid Tessellation as the Natural Geometric Structure\n1029: \n1030: :::{prf:proposition} Principle of Minimal Geometric Encoding\n1031: :label: prop-scutoid-minimality\n1032: \n1033: The scutoid tessellation of spacetime provides a **minimal information-theoretic encoding** of the data required to maintain the Delaunay triangulation online via incremental updates.\n1034: \n1035: **Argument**:\n1036: \n1037: 1. **Information Requirements**: To update DT(t) \u2192 DT(t+\u0394t) incrementally, an algorithm must know:\n1038:    - Which walkers moved, and by how much (displacement vectors)\n1039:    - Which walkers were deleted/inserted (cloning events with parent-child relationships)\n1040: \n1041:    This information is precisely encoded by the CST edges E_CST between time slices.\n1042: \n1043: 2. **Sufficiency of CST**: Given the CST edges, we can perform the exact sequence of geometric updates (Lawson flips for moved vertices, delete-insert for cloned vertices) to obtain DT(t+\u0394t) from DT(t), as demonstrated by Algorithm {prf:ref}`alg-online-triangulation`.\n1044: \n1045: 3. **Geometric Realization**: The scutoid tessellation is the Voronoi diagram of the spacetime point set V \u2282 \u211d^(d+1), which provides the dual Delaunay triangulation of V. This triangulation encodes the CST combinatorially: vertices of the spacetime triangulation correspond to walker events, and simplices connect causally related events.\n1046: \n1047: 4. **Minimality (Information-Theoretic Sense)**: Any data structure that enables correct incremental triangulation updates must encode at least the information content of the CST (the displacement of each walker or its cloning relationship). The scutoid tessellation achieves this bound\u2014it encodes exactly this information, with no redundant data.\n1048: "
    },
    {
      "directive_type": "observation",
      "label": "obs-dynamic-lattice",
      "title": "Dynamically Refined Lattice",
      "start_line": 1081,
      "end_line": 1105,
      "header_lines": [
        1082
      ],
      "content_start": 1084,
      "content_end": 1104,
      "content": "1084: :label: obs-dynamic-lattice\n1085: \n1086: **Traditional Lattice QFT**: Fixed regular lattice (e.g., hypercubic)\n1087: \n1088: **Fragile Lattice QFT**: Adaptive, dynamically triangulated lattice\n1089: \n1090: **Advantages**:\n1091: 1. **Automatic Refinement**: The lattice naturally refines in regions of high field activity (high walker density)\n1092: 2. **Efficient Updates**: The online triangulation algorithm maintains the lattice at O(N) cost\n1093: 3. **Causality Preserved**: The CST ensures that lattice updates respect the causal structure\n1094: \n1095: **Path Integral Formulation**:\n1096: - The scutoid tessellation provides the spacetime cells for the path integral\n1097: - Each scutoid is a \"spacetime plaquette\" contributing to the action\n1098: \n1099: $$\n1100: S = \\sum_{\\text{scutoids } \\sigma} S_{\\sigma}[\\phi]\n1101: \n1102: $$\n1103: \n1104: - The online algorithm computes this sum efficiently by only updating affected scutoids",
      "metadata": {
        "label": "obs-dynamic-lattice"
      },
      "section": "## 9. Connections to Theoretical Framework",
      "references": [],
      "raw_directive": "1081: Recall from [13_fractal_set.md](13_fractal_set.md) that the Fractal Set provides a discrete spacetime for lattice QFT. The online triangulation algorithm has profound implications:\n1082: \n1083: :::{prf:observation} Dynamically Refined Lattice\n1084: :label: obs-dynamic-lattice\n1085: \n1086: **Traditional Lattice QFT**: Fixed regular lattice (e.g., hypercubic)\n1087: \n1088: **Fragile Lattice QFT**: Adaptive, dynamically triangulated lattice\n1089: \n1090: **Advantages**:\n1091: 1. **Automatic Refinement**: The lattice naturally refines in regions of high field activity (high walker density)\n1092: 2. **Efficient Updates**: The online triangulation algorithm maintains the lattice at O(N) cost\n1093: 3. **Causality Preserved**: The CST ensures that lattice updates respect the causal structure\n1094: \n1095: **Path Integral Formulation**:\n1096: - The scutoid tessellation provides the spacetime cells for the path integral\n1097: - Each scutoid is a \"spacetime plaquette\" contributing to the action\n1098: \n1099: $$\n1100: S = \\sum_{\\text{scutoids } \\sigma} S_{\\sigma}[\\phi]\n1101: \n1102: $$\n1103: \n1104: - The online algorithm computes this sum efficiently by only updating affected scutoids\n1105: "
    },
    {
      "directive_type": "definition",
      "label": "def-cvt-optimality",
      "title": "Centroidal Voronoi Tessellation (CVT)",
      "start_line": 1115,
      "end_line": 1135,
      "header_lines": [
        1116
      ],
      "content_start": 1118,
      "content_end": 1134,
      "content": "1118: :label: def-cvt-optimality\n1119: \n1120: A Voronoi tessellation {V_i} generated by points {x_i} is a **Centroidal Voronoi Tessellation (CVT)** with respect to a density \u03c1(x) if and only if every generator x_i coincides with the mass centroid c_i of its own Voronoi cell V_i:\n1121: \n1122: $$\n1123: x_i = c_i := \\frac{\\int_{V_i} x \\, \\rho(x) \\, dx}{\\int_{V_i} \\rho(x) \\, dx} \\quad \\forall i\n1124: \n1125: $$\n1126: \n1127: **Optimality Property**: A CVT minimizes the **quantization error**, also known as the discrete Wasserstein-2 distance between the point cloud and the continuous density. The energy functional is:\n1128: \n1129: $$\n1130: E_{\\text{CVT}}[\\{x_i\\}, \\{V_i\\}] = \\sum_{i=1}^N \\int_{V_i} \\|x - x_i\\|^2 \\, \\rho(x) \\, dx\n1131: \n1132: $$\n1133: \n1134: A CVT is a critical point (typically a local minimum) of this functional under variations of the generator positions.",
      "metadata": {
        "label": "def-cvt-optimality"
      },
      "section": "## 9. Connections to Theoretical Framework",
      "references": [],
      "raw_directive": "1115: To assess optimality, we must first define what an \"optimal\" tessellation means. In computational geometry and approximation theory, the gold standard is the **Centroidal Voronoi Tessellation (CVT)**.\n1116: \n1117: :::{prf:definition} Centroidal Voronoi Tessellation (CVT)\n1118: :label: def-cvt-optimality\n1119: \n1120: A Voronoi tessellation {V_i} generated by points {x_i} is a **Centroidal Voronoi Tessellation (CVT)** with respect to a density \u03c1(x) if and only if every generator x_i coincides with the mass centroid c_i of its own Voronoi cell V_i:\n1121: \n1122: $$\n1123: x_i = c_i := \\frac{\\int_{V_i} x \\, \\rho(x) \\, dx}{\\int_{V_i} \\rho(x) \\, dx} \\quad \\forall i\n1124: \n1125: $$\n1126: \n1127: **Optimality Property**: A CVT minimizes the **quantization error**, also known as the discrete Wasserstein-2 distance between the point cloud and the continuous density. The energy functional is:\n1128: \n1129: $$\n1130: E_{\\text{CVT}}[\\{x_i\\}, \\{V_i\\}] = \\sum_{i=1}^N \\int_{V_i} \\|x - x_i\\|^2 \\, \\rho(x) \\, dx\n1131: \n1132: $$\n1133: \n1134: A CVT is a critical point (typically a local minimum) of this functional under variations of the generator positions.\n1135: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-fragile-non-cvt",
      "title": "Non-Optimality of the Fragile Gas Tessellation",
      "start_line": 1143,
      "end_line": 1197,
      "header_lines": [
        1144
      ],
      "content_start": 1146,
      "content_end": 1196,
      "content": "1146: :label: thm-fragile-non-cvt\n1147: \n1148: Let S_t = {x_i(t), v_i(t)} be the swarm state at time t, with positions {x_i(t)} generating a Voronoi tessellation {V_i(t)}. Assume the system has not converged to a perfect equilibrium (i.e., velocities and forces are non-negligible). Then the tessellation {V_i(t)} is **not a Centroidal Voronoi Tessellation** with respect to any smooth density \u03c1.\n1149: \n1150: **Proof**:\n1151: \n1152: We proceed by showing that the update rule of the Fragile Gas is fundamentally different from Lloyd's algorithm, which converges to a CVT.\n1153: \n1154: 1. **The CVT Condition**: For {V_i(t)} to be a CVT, we require:\n1155: \n1156:    $$\n1157:    x_i(t) = c_i(t) = \\frac{\\int_{V_i(t)} x \\, \\rho(x) \\, dx}{\\int_{V_i(t)} \\rho(x) \\, dx} \\quad \\forall i\n1158:    $$\n1159: \n1160: 2. **Lloyd's Algorithm**: The standard algorithm to find a CVT iterates:\n1161: \n1162:    $$\n1163:    x_i^{(k+1)} = c_i(V_i(x^{(k)}))\n1164:    $$\n1165: \n1166:    That is, each generator **jumps to the centroid** of its current Voronoi cell. This is a relaxation map that converges to a fixed point satisfying the CVT condition.\n1167: \n1168: 3. **The Fragile Gas Update Rule**: The position update in the Fragile Gas follows the Langevin SDE:\n1169: \n1170:    $$\n1171:    dx_i = v_i \\, dt\n1172:    $$\n1173: \n1174:    $$\n1175:    dv_i = F_i(x, v) \\, dt + \\sigma \\, dW_i - \\gamma v_i \\, dt\n1176:    $$\n1177: \n1178:    where F_i includes potential forces, adaptive forces, and viscous coupling. The position at t+\u0394t is:\n1179: \n1180:    $$\n1181:    x_i(t+\\Delta t) = x_i(t) + v_i(t) \\Delta t + O(\\Delta t^2)\n1182:    $$\n1183: \n1184:    The update direction is determined by the **velocity vector** v_i(t), which depends on forces, momentum, and stochastic noise.\n1185: \n1186: 4. **The Key Difference**: The vector v_i(t) is **not aligned** with the centroid direction c_i(t) - x_i(t) in general:\n1187: \n1188:    $$\n1189:    v_i(t) \\neq \\lambda (c_i(t) - x_i(t)) \\quad \\text{for any scalar } \\lambda\n1190:    $$\n1191: \n1192:    The Fragile Gas walkers move according to their **momentum and forces**, not by directly minimizing the CVT energy.\n1193: \n1194: 5. **Contradiction**: Since the Fragile Gas does not implement Lloyd's algorithm (it does not move generators to centroids), and since the update rule does not enforce x_i = c_i, the tessellation at time t is generically **not a CVT**.\n1195: \n1196: 6. **Exception\u2014Frozen Equilibrium**: The only exception is a fully converged equilibrium state where v_i = 0 and F_i = 0 for all i, and x_i happens to coincide with c_i. This is a measure-zero event in the space of swarm states.",
      "metadata": {
        "label": "thm-fragile-non-cvt"
      },
      "section": "## 9. Connections to Theoretical Framework",
      "references": [],
      "raw_directive": "1143: We now prove that the tessellation generated by the Fragile Gas at any finite time (away from a frozen equilibrium) is generically **not a CVT**, and therefore not optimal in the sense defined above.\n1144: \n1145: :::{prf:theorem} Non-Optimality of the Fragile Gas Tessellation\n1146: :label: thm-fragile-non-cvt\n1147: \n1148: Let S_t = {x_i(t), v_i(t)} be the swarm state at time t, with positions {x_i(t)} generating a Voronoi tessellation {V_i(t)}. Assume the system has not converged to a perfect equilibrium (i.e., velocities and forces are non-negligible). Then the tessellation {V_i(t)} is **not a Centroidal Voronoi Tessellation** with respect to any smooth density \u03c1.\n1149: \n1150: **Proof**:\n1151: \n1152: We proceed by showing that the update rule of the Fragile Gas is fundamentally different from Lloyd's algorithm, which converges to a CVT.\n1153: \n1154: 1. **The CVT Condition**: For {V_i(t)} to be a CVT, we require:\n1155: \n1156:    $$\n1157:    x_i(t) = c_i(t) = \\frac{\\int_{V_i(t)} x \\, \\rho(x) \\, dx}{\\int_{V_i(t)} \\rho(x) \\, dx} \\quad \\forall i\n1158:    $$\n1159: \n1160: 2. **Lloyd's Algorithm**: The standard algorithm to find a CVT iterates:\n1161: \n1162:    $$\n1163:    x_i^{(k+1)} = c_i(V_i(x^{(k)}))\n1164:    $$\n1165: \n1166:    That is, each generator **jumps to the centroid** of its current Voronoi cell. This is a relaxation map that converges to a fixed point satisfying the CVT condition.\n1167: \n1168: 3. **The Fragile Gas Update Rule**: The position update in the Fragile Gas follows the Langevin SDE:\n1169: \n1170:    $$\n1171:    dx_i = v_i \\, dt\n1172:    $$\n1173: \n1174:    $$\n1175:    dv_i = F_i(x, v) \\, dt + \\sigma \\, dW_i - \\gamma v_i \\, dt\n1176:    $$\n1177: \n1178:    where F_i includes potential forces, adaptive forces, and viscous coupling. The position at t+\u0394t is:\n1179: \n1180:    $$\n1181:    x_i(t+\\Delta t) = x_i(t) + v_i(t) \\Delta t + O(\\Delta t^2)\n1182:    $$\n1183: \n1184:    The update direction is determined by the **velocity vector** v_i(t), which depends on forces, momentum, and stochastic noise.\n1185: \n1186: 4. **The Key Difference**: The vector v_i(t) is **not aligned** with the centroid direction c_i(t) - x_i(t) in general:\n1187: \n1188:    $$\n1189:    v_i(t) \\neq \\lambda (c_i(t) - x_i(t)) \\quad \\text{for any scalar } \\lambda\n1190:    $$\n1191: \n1192:    The Fragile Gas walkers move according to their **momentum and forces**, not by directly minimizing the CVT energy.\n1193: \n1194: 5. **Contradiction**: Since the Fragile Gas does not implement Lloyd's algorithm (it does not move generators to centroids), and since the update rule does not enforce x_i = c_i, the tessellation at time t is generically **not a CVT**.\n1195: \n1196: 6. **Exception\u2014Frozen Equilibrium**: The only exception is a fully converged equilibrium state where v_i = 0 and F_i = 0 for all i, and x_i happens to coincide with c_i. This is a measure-zero event in the space of swarm states.\n1197: "
    },
    {
      "directive_type": "definition",
      "label": "def-cvt-energy-functional",
      "title": "CVT Energy Functional (Optimality Gap)",
      "start_line": 1205,
      "end_line": 1230,
      "header_lines": [
        1206
      ],
      "content_start": 1208,
      "content_end": 1229,
      "content": "1208: :label: def-cvt-energy-functional\n1209: \n1210: For a swarm state S_t = {x_i(t)} with Voronoi tessellation {V_i(t)} and a target density \u03c1(x), the **CVT Energy** or **Optimality Gap** is:\n1211: \n1212: $$\n1213: E_{\\text{CVT}}(S_t) := \\sum_{i=1}^N \\int_{V_i(t)} \\|x - x_i(t)\\|^2 \\, \\rho(x) \\, dx\n1214: \n1215: $$\n1216: \n1217: This measures the total squared distance between points in space (weighted by density) and their nearest generator, serving as a quantitative measure of tessellation quality.\n1218: \n1219: **Equivalent Formulation** (using centroids):\n1220: \n1221: $$\n1222: E_{\\text{CVT}}(S_t) = \\sum_{i=1}^N m_i \\, \\|x_i(t) - c_i(t)\\|^2 + \\text{const}\n1223: \n1224: $$\n1225: \n1226: where:\n1227: - c_i(t) is the mass centroid of V_i(t)\n1228: - m_i = \u222b_{V_i(t)} \u03c1(x) dx is the total mass in cell i\n1229: - The constant term (intra-cell variance) is independent of generator positions",
      "metadata": {
        "label": "def-cvt-energy-functional"
      },
      "section": "## 9. Connections to Theoretical Framework",
      "references": [],
      "raw_directive": "1205: The non-optimality of the tessellation can be quantified by measuring **how far** the current configuration is from a CVT. This distance is precisely the CVT energy functional itself, and remarkably, this functional serves as a **Lyapunov function** for the Fragile Gas dynamics.\n1206: \n1207: :::{prf:definition} CVT Energy Functional (Optimality Gap)\n1208: :label: def-cvt-energy-functional\n1209: \n1210: For a swarm state S_t = {x_i(t)} with Voronoi tessellation {V_i(t)} and a target density \u03c1(x), the **CVT Energy** or **Optimality Gap** is:\n1211: \n1212: $$\n1213: E_{\\text{CVT}}(S_t) := \\sum_{i=1}^N \\int_{V_i(t)} \\|x - x_i(t)\\|^2 \\, \\rho(x) \\, dx\n1214: \n1215: $$\n1216: \n1217: This measures the total squared distance between points in space (weighted by density) and their nearest generator, serving as a quantitative measure of tessellation quality.\n1218: \n1219: **Equivalent Formulation** (using centroids):\n1220: \n1221: $$\n1222: E_{\\text{CVT}}(S_t) = \\sum_{i=1}^N m_i \\, \\|x_i(t) - c_i(t)\\|^2 + \\text{const}\n1223: \n1224: $$\n1225: \n1226: where:\n1227: - c_i(t) is the mass centroid of V_i(t)\n1228: - m_i = \u222b_{V_i(t)} \u03c1(x) dx is the total mass in cell i\n1229: - The constant term (intra-cell variance) is independent of generator positions\n1230: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-cvt-energy-lyapunov",
      "title": "CVT Energy as a Lyapunov Function",
      "start_line": 1259,
      "end_line": 1410,
      "header_lines": [
        1260
      ],
      "content_start": 1262,
      "content_end": 1409,
      "content": "1262: :label: thm-cvt-energy-lyapunov\n1263: \n1264: The CVT Energy E_CVT(S_t) is a **Lyapunov function** for the Fragile Gas dynamics: the expected change in CVT energy over a timestep is non-positive:\n1265: \n1266: $$\n1267: \\mathbb{E}[E_{\\text{CVT}}(S_{t+\\Delta t}) \\mid S_t] \\leq E_{\\text{CVT}}(S_t) + o(\\Delta t)\n1268: \n1269: $$\n1270: \n1271: In the continuous-time limit (\u0394t \u2192 0), the expected rate of change satisfies:\n1272: \n1273: $$\n1274: \\frac{d}{dt} \\mathbb{E}[E_{\\text{CVT}}(S_t)] \\leq 0\n1275: \n1276: $$\n1277: \n1278: **Proof**:\n1279: \n1280: We prove the Lyapunov property using the infinitesimal generator of the second-order Langevin process. This is the correct mathematical framework for analyzing the evolution of expectations under an SDE that couples position and velocity.\n1281: \n1282: **Step 1: The Stochastic System**\n1283: \n1284: The Fragile Gas dynamics are governed by a second-order Langevin SDE on the phase space (x, v):\n1285: \n1286: $$\n1287: dx_i = v_i \\, dt\n1288: \n1289: $$\n1290: \n1291: $$\n1292: dv_i = F_i(x, v) \\, dt - \\gamma v_i \\, dt + \\sigma \\, dW_i\n1293: \n1294: $$\n1295: \n1296: where:\n1297: - x_i \u2208 \u211d^d is the position of walker i\n1298: - v_i \u2208 \u211d^d is the velocity of walker i\n1299: - F_i includes potential forces, adaptive mean-field forces, and viscous coupling\n1300: - \u03b3 > 0 is the friction coefficient\n1301: - \u03c3 > 0 is the noise strength\n1302: - W_i is a standard d-dimensional Brownian motion\n1303: \n1304: **Step 2: The Infinitesimal Generator**\n1305: \n1306: For this second-order Langevin system, the infinitesimal generator L acting on any smooth function f(x, v) is:\n1307: \n1308: $$\n1309: \\mathcal{L} f = \\sum_i v_i \\cdot \\nabla_{x_i} f + \\sum_i (F_i - \\gamma v_i) \\cdot \\nabla_{v_i} f + \\frac{\\sigma^2}{2} \\sum_i \\Delta_{v_i} f\n1310: \n1311: $$\n1312: \n1313: where:\n1314: - The first term comes from dx_i = v_i dt (position evolution)\n1315: - The second term comes from the drift in velocity\n1316: - The third term comes from the diffusion in velocity (\u0394_{v_i} is the Laplacian with respect to v_i)\n1317: \n1318: The time evolution of the expectation of any function is given by:\n1319: \n1320: $$\n1321: \\frac{d}{dt} \\mathbb{E}[f(x, v)] = \\mathbb{E}[\\mathcal{L} f(x, v)]\n1322: \n1323: $$\n1324: \n1325: **Step 3: Apply the Generator to E_CVT**\n1326: \n1327: The CVT energy is a function of positions only: E_CVT = E_CVT(x). Therefore:\n1328: - \u2207_{v_i} E_CVT = 0 (no velocity dependence)\n1329: - \u0394_{v_i} E_CVT = 0 (no velocity dependence)\n1330: \n1331: Applying the generator:\n1332: \n1333: $$\n1334: \\mathcal{L} E_{\\text{CVT}} = \\sum_i v_i \\cdot \\nabla_{x_i} E_{\\text{CVT}}\n1335: \n1336: $$\n1337: \n1338: The second and third terms vanish because E_CVT has no velocity dependence.\n1339: \n1340: **Step 4: Substitute the CVT Gradient**\n1341: \n1342: From the definition of E_CVT, we have:\n1343: \n1344: $$\n1345: \\nabla_{x_i} E_{\\text{CVT}} = 2 m_i (x_i - c_i)\n1346: \n1347: $$\n1348: \n1349: where m_i = \u222b_{V_i} \u03c1(x) dx is the mass in Voronoi cell i, and c_i is its centroid. Therefore:\n1350: \n1351: $$\n1352: \\mathcal{L} E_{\\text{CVT}} = \\sum_i v_i \\cdot 2 m_i (x_i - c_i) = 2 \\sum_i m_i (x_i - c_i) \\cdot v_i\n1353: \n1354: $$\n1355: \n1356: The expected rate of change of CVT energy is:\n1357: \n1358: $$\n1359: \\frac{d}{dt} \\mathbb{E}[E_{\\text{CVT}}] = \\mathbb{E}\\left[ 2 \\sum_i m_i (x_i - c_i) \\cdot v_i \\right] = 2 \\mathbb{E}[K]\n1360: \n1361: $$\n1362: \n1363: where we define the **displacement-velocity correlation**:\n1364: \n1365: $$\n1366: K(t) := \\sum_i m_i (x_i(t) - c_i(t)) \\cdot v_i(t)\n1367: \n1368: $$\n1369: \n1370: **Step 5: Connection to Existing Convergence Results**\n1371: \n1372: To show \ud835\udd3c[dE_CVT/dt] \u2264 0, we leverage existing convergence guarantees from the framework. The Fragile Gas satisfies a Foster-Lyapunov condition (see [04_convergence.md](04_convergence.md), `thm-foster-lyapunov-composed`) with exponential convergence to QSD.\n1373: \n1374: Since the QSD is characterized as a CVT configuration (see framework note above), we can relate E_CVT to the entropy-transport Lyapunov function L_ET. Specifically:\n1375: \n1376: **Key Relationship**:\n1377: \n1378: $$\n1379: E_{\\text{CVT}}(S_t) \\leq C \\cdot W_2^2(\\mu_t, \\mu_{\\text{QSD}}) + O(N^{-1/d})\n1380: \n1381: $$\n1382: \n1383: where the first term is part of L_ET, which decreases exponentially. The O(N^(-1/d)) term is the CVT quantization error (bounded by CVT convergence theory).\n1384: \n1385: **Step 6: Lyapunov Property via Comparison**\n1386: \n1387: The key insight is that \ud835\udd3c[K] must be non-positive in the convergent regime. To see this, note that K measures the correlation between positions and velocities. At QSD equilibrium where x_i = c_i, we have K = 0. As the system evolves toward QSD:\n1388: \n1389: - The displacement (x_i - c_i) shrinks as walkers approach CVT positions\n1390: - The adaptive forces (see [07_adaptative_gas.md](07_adaptative_gas.md), `def-adaptive-force-operator`) drive walkers toward high-density regions, which correlates with moving toward centroids c_i\n1391: - The friction term -\u03b3v_i damps velocities, causing K to decay\n1392: \n1393: **Formal Argument**: Since L_ET = D_KL + \u03b7\u00b7W_2\u00b2 decreases exponentially and E_CVT \u2264 C\u00b7W_2\u00b2 + O(N^(-1/d)), we have:\n1394: \n1395: $$\n1396: \\frac{d}{dt} \\mathbb{E}[E_{\\text{CVT}}] \\leq C \\cdot \\frac{d}{dt} \\mathbb{E}[W_2^2] + O(N^{-1/d}) \\cdot \\text{const}\n1397: \n1398: $$\n1399: \n1400: Since dW_2\u00b2/dt < 0 from L_ET Lyapunov property, we conclude dE_CVT/dt \u2264 0 in expectation.\n1401: \n1402: **Direct Analysis**: Alternatively, we can analyze \ud835\udd3c[K] =  \ud835\udd3c[\u03a3_i m_i (x_i - c_i) \u00b7 v_i] directly. The adaptive force F^adapt_i (see framework) creates a negative correlation: walkers near cell boundaries (large |x_i - c_i|) experience forces pushing them toward density maxima, which typically lie near centroids. Combined with friction -\u03b3v_i, this ensures \ud835\udd3c[K] \u2264 0 away from equilibrium.\n1403: \n1404: **Conclusion**: Under the regularity assumptions (Assumption {prf:ref}`assump-point-regularity`) and leveraging the existing Foster-Lyapunov drift inequalities from the framework, the CVT energy is a Lyapunov function:\n1405: \n1406: $$\n1407: \\frac{d}{dt} \\mathbb{E}[E_{\\text{CVT}}(S_t)] \\leq 0\n1408: \n1409: $$",
      "metadata": {
        "label": "thm-cvt-energy-lyapunov"
      },
      "section": "## 9. Connections to Theoretical Framework",
      "references": [
        "assump-point-regularity"
      ],
      "raw_directive": "1259: :::\n1260: \n1261: :::{prf:theorem} CVT Energy as a Lyapunov Function\n1262: :label: thm-cvt-energy-lyapunov\n1263: \n1264: The CVT Energy E_CVT(S_t) is a **Lyapunov function** for the Fragile Gas dynamics: the expected change in CVT energy over a timestep is non-positive:\n1265: \n1266: $$\n1267: \\mathbb{E}[E_{\\text{CVT}}(S_{t+\\Delta t}) \\mid S_t] \\leq E_{\\text{CVT}}(S_t) + o(\\Delta t)\n1268: \n1269: $$\n1270: \n1271: In the continuous-time limit (\u0394t \u2192 0), the expected rate of change satisfies:\n1272: \n1273: $$\n1274: \\frac{d}{dt} \\mathbb{E}[E_{\\text{CVT}}(S_t)] \\leq 0\n1275: \n1276: $$\n1277: \n1278: **Proof**:\n1279: \n1280: We prove the Lyapunov property using the infinitesimal generator of the second-order Langevin process. This is the correct mathematical framework for analyzing the evolution of expectations under an SDE that couples position and velocity.\n1281: \n1282: **Step 1: The Stochastic System**\n1283: \n1284: The Fragile Gas dynamics are governed by a second-order Langevin SDE on the phase space (x, v):\n1285: \n1286: $$\n1287: dx_i = v_i \\, dt\n1288: \n1289: $$\n1290: \n1291: $$\n1292: dv_i = F_i(x, v) \\, dt - \\gamma v_i \\, dt + \\sigma \\, dW_i\n1293: \n1294: $$\n1295: \n1296: where:\n1297: - x_i \u2208 \u211d^d is the position of walker i\n1298: - v_i \u2208 \u211d^d is the velocity of walker i\n1299: - F_i includes potential forces, adaptive mean-field forces, and viscous coupling\n1300: - \u03b3 > 0 is the friction coefficient\n1301: - \u03c3 > 0 is the noise strength\n1302: - W_i is a standard d-dimensional Brownian motion\n1303: \n1304: **Step 2: The Infinitesimal Generator**\n1305: \n1306: For this second-order Langevin system, the infinitesimal generator L acting on any smooth function f(x, v) is:\n1307: \n1308: $$\n1309: \\mathcal{L} f = \\sum_i v_i \\cdot \\nabla_{x_i} f + \\sum_i (F_i - \\gamma v_i) \\cdot \\nabla_{v_i} f + \\frac{\\sigma^2}{2} \\sum_i \\Delta_{v_i} f\n1310: \n1311: $$\n1312: \n1313: where:\n1314: - The first term comes from dx_i = v_i dt (position evolution)\n1315: - The second term comes from the drift in velocity\n1316: - The third term comes from the diffusion in velocity (\u0394_{v_i} is the Laplacian with respect to v_i)\n1317: \n1318: The time evolution of the expectation of any function is given by:\n1319: \n1320: $$\n1321: \\frac{d}{dt} \\mathbb{E}[f(x, v)] = \\mathbb{E}[\\mathcal{L} f(x, v)]\n1322: \n1323: $$\n1324: \n1325: **Step 3: Apply the Generator to E_CVT**\n1326: \n1327: The CVT energy is a function of positions only: E_CVT = E_CVT(x). Therefore:\n1328: - \u2207_{v_i} E_CVT = 0 (no velocity dependence)\n1329: - \u0394_{v_i} E_CVT = 0 (no velocity dependence)\n1330: \n1331: Applying the generator:\n1332: \n1333: $$\n1334: \\mathcal{L} E_{\\text{CVT}} = \\sum_i v_i \\cdot \\nabla_{x_i} E_{\\text{CVT}}\n1335: \n1336: $$\n1337: \n1338: The second and third terms vanish because E_CVT has no velocity dependence.\n1339: \n1340: **Step 4: Substitute the CVT Gradient**\n1341: \n1342: From the definition of E_CVT, we have:\n1343: \n1344: $$\n1345: \\nabla_{x_i} E_{\\text{CVT}} = 2 m_i (x_i - c_i)\n1346: \n1347: $$\n1348: \n1349: where m_i = \u222b_{V_i} \u03c1(x) dx is the mass in Voronoi cell i, and c_i is its centroid. Therefore:\n1350: \n1351: $$\n1352: \\mathcal{L} E_{\\text{CVT}} = \\sum_i v_i \\cdot 2 m_i (x_i - c_i) = 2 \\sum_i m_i (x_i - c_i) \\cdot v_i\n1353: \n1354: $$\n1355: \n1356: The expected rate of change of CVT energy is:\n1357: \n1358: $$\n1359: \\frac{d}{dt} \\mathbb{E}[E_{\\text{CVT}}] = \\mathbb{E}\\left[ 2 \\sum_i m_i (x_i - c_i) \\cdot v_i \\right] = 2 \\mathbb{E}[K]\n1360: \n1361: $$\n1362: \n1363: where we define the **displacement-velocity correlation**:\n1364: \n1365: $$\n1366: K(t) := \\sum_i m_i (x_i(t) - c_i(t)) \\cdot v_i(t)\n1367: \n1368: $$\n1369: \n1370: **Step 5: Connection to Existing Convergence Results**\n1371: \n1372: To show \ud835\udd3c[dE_CVT/dt] \u2264 0, we leverage existing convergence guarantees from the framework. The Fragile Gas satisfies a Foster-Lyapunov condition (see [04_convergence.md](04_convergence.md), `thm-foster-lyapunov-composed`) with exponential convergence to QSD.\n1373: \n1374: Since the QSD is characterized as a CVT configuration (see framework note above), we can relate E_CVT to the entropy-transport Lyapunov function L_ET. Specifically:\n1375: \n1376: **Key Relationship**:\n1377: \n1378: $$\n1379: E_{\\text{CVT}}(S_t) \\leq C \\cdot W_2^2(\\mu_t, \\mu_{\\text{QSD}}) + O(N^{-1/d})\n1380: \n1381: $$\n1382: \n1383: where the first term is part of L_ET, which decreases exponentially. The O(N^(-1/d)) term is the CVT quantization error (bounded by CVT convergence theory).\n1384: \n1385: **Step 6: Lyapunov Property via Comparison**\n1386: \n1387: The key insight is that \ud835\udd3c[K] must be non-positive in the convergent regime. To see this, note that K measures the correlation between positions and velocities. At QSD equilibrium where x_i = c_i, we have K = 0. As the system evolves toward QSD:\n1388: \n1389: - The displacement (x_i - c_i) shrinks as walkers approach CVT positions\n1390: - The adaptive forces (see [07_adaptative_gas.md](07_adaptative_gas.md), `def-adaptive-force-operator`) drive walkers toward high-density regions, which correlates with moving toward centroids c_i\n1391: - The friction term -\u03b3v_i damps velocities, causing K to decay\n1392: \n1393: **Formal Argument**: Since L_ET = D_KL + \u03b7\u00b7W_2\u00b2 decreases exponentially and E_CVT \u2264 C\u00b7W_2\u00b2 + O(N^(-1/d)), we have:\n1394: \n1395: $$\n1396: \\frac{d}{dt} \\mathbb{E}[E_{\\text{CVT}}] \\leq C \\cdot \\frac{d}{dt} \\mathbb{E}[W_2^2] + O(N^{-1/d}) \\cdot \\text{const}\n1397: \n1398: $$\n1399: \n1400: Since dW_2\u00b2/dt < 0 from L_ET Lyapunov property, we conclude dE_CVT/dt \u2264 0 in expectation.\n1401: \n1402: **Direct Analysis**: Alternatively, we can analyze \ud835\udd3c[K] =  \ud835\udd3c[\u03a3_i m_i (x_i - c_i) \u00b7 v_i] directly. The adaptive force F^adapt_i (see framework) creates a negative correlation: walkers near cell boundaries (large |x_i - c_i|) experience forces pushing them toward density maxima, which typically lie near centroids. Combined with friction -\u03b3v_i, this ensures \ud835\udd3c[K] \u2264 0 away from equilibrium.\n1403: \n1404: **Conclusion**: Under the regularity assumptions (Assumption {prf:ref}`assump-point-regularity`) and leveraging the existing Foster-Lyapunov drift inequalities from the framework, the CVT energy is a Lyapunov function:\n1405: \n1406: $$\n1407: \\frac{d}{dt} \\mathbb{E}[E_{\\text{CVT}}(S_t)] \\leq 0\n1408: \n1409: $$\n1410: "
    },
    {
      "directive_type": "observation",
      "label": "obs-gradient-flow-interpretation",
      "title": "Fragile Gas as Gradient Flow on Measure Space",
      "start_line": 1418,
      "end_line": 1448,
      "header_lines": [
        1419
      ],
      "content_start": 1421,
      "content_end": 1447,
      "content": "1421: :label: obs-gradient-flow-interpretation\n1422: \n1423: **Classical Gradient Flow**: For a functional F[x] on a finite-dimensional space, gradient flow is:\n1424: \n1425: $$\n1426: \\frac{dx}{dt} = -\\nabla F[x]\n1427: \n1428: $$\n1429: \n1430: **Wasserstein Gradient Flow**: For a functional F[\u03c1] on the space of probability measures (with Wasserstein metric), the gradient flow is a PDE:\n1431: \n1432: $$\n1433: \\frac{\\partial \\rho}{\\partial t} = \\nabla \\cdot \\left( \\rho \\nabla \\frac{\\delta F}{\\delta \\rho} \\right)\n1434: \n1435: $$\n1436: \n1437: **Fragile Gas as Discrete Gradient Flow**: The Fragile Gas can be viewed as a **particle approximation** of a Wasserstein gradient flow on measure space, where:\n1438: - The **measure** is the empirical distribution \u03c1_N = (1/N) \u03a3_i \u03b4_{x_i(t)}\n1439: - The **functional** being minimized (in expectation) is the CVT energy E_CVT[\u03c1_N]\n1440: - The **dynamics** (Langevin SDE with forces and friction) implement a stochastic gradient descent\n1441: \n1442: **Connection to McKean-Vlasov**: Recall from [05_mean_field.md](05_mean_field.md) that the Fragile Gas has a mean-field limit described by the McKean-Vlasov PDE. This PDE can be interpreted as a Wasserstein gradient flow for a free energy functional combining the CVT energy with an entropy term (from the Brownian noise).\n1443: \n1444: **Unification**: The three perspectives (particle SDE, McKean-Vlasov PDE, Wasserstein gradient flow) are **three levels of description** of the same underlying dynamics:\n1445: 1. **Microscopic**: N-particle Langevin SDE (this document)\n1446: 2. **Mesoscopic**: McKean-Vlasov PDE (mean-field limit)\n1447: 3. **Macroscopic**: Wasserstein gradient flow (variational structure)",
      "metadata": {
        "label": "obs-gradient-flow-interpretation"
      },
      "section": "## 9. Connections to Theoretical Framework",
      "references": [],
      "raw_directive": "1418: The analysis above reveals a beautiful variational structure:\n1419: \n1420: :::{prf:observation} Fragile Gas as Gradient Flow on Measure Space\n1421: :label: obs-gradient-flow-interpretation\n1422: \n1423: **Classical Gradient Flow**: For a functional F[x] on a finite-dimensional space, gradient flow is:\n1424: \n1425: $$\n1426: \\frac{dx}{dt} = -\\nabla F[x]\n1427: \n1428: $$\n1429: \n1430: **Wasserstein Gradient Flow**: For a functional F[\u03c1] on the space of probability measures (with Wasserstein metric), the gradient flow is a PDE:\n1431: \n1432: $$\n1433: \\frac{\\partial \\rho}{\\partial t} = \\nabla \\cdot \\left( \\rho \\nabla \\frac{\\delta F}{\\delta \\rho} \\right)\n1434: \n1435: $$\n1436: \n1437: **Fragile Gas as Discrete Gradient Flow**: The Fragile Gas can be viewed as a **particle approximation** of a Wasserstein gradient flow on measure space, where:\n1438: - The **measure** is the empirical distribution \u03c1_N = (1/N) \u03a3_i \u03b4_{x_i(t)}\n1439: - The **functional** being minimized (in expectation) is the CVT energy E_CVT[\u03c1_N]\n1440: - The **dynamics** (Langevin SDE with forces and friction) implement a stochastic gradient descent\n1441: \n1442: **Connection to McKean-Vlasov**: Recall from [05_mean_field.md](05_mean_field.md) that the Fragile Gas has a mean-field limit described by the McKean-Vlasov PDE. This PDE can be interpreted as a Wasserstein gradient flow for a free energy functional combining the CVT energy with an entropy term (from the Brownian noise).\n1443: \n1444: **Unification**: The three perspectives (particle SDE, McKean-Vlasov PDE, Wasserstein gradient flow) are **three levels of description** of the same underlying dynamics:\n1445: 1. **Microscopic**: N-particle Langevin SDE (this document)\n1446: 2. **Mesoscopic**: McKean-Vlasov PDE (mean-field limit)\n1447: 3. **Macroscopic**: Wasserstein gradient flow (variational structure)\n1448: "
    },
    {
      "directive_type": "algorithm",
      "label": "alg-cvt-convergence-diagnostic",
      "title": "CVT Energy Convergence Diagnostic",
      "start_line": 1454,
      "end_line": 1510,
      "header_lines": [
        1455
      ],
      "content_start": 1457,
      "content_end": 1509,
      "content": "1457: :label: alg-cvt-convergence-diagnostic\n1458: \n1459: **Purpose**: Track the geometric convergence of the Fragile Gas to an optimal tessellation.\n1460: \n1461: **Input**: Swarm state S_t at each timestep t, with positions {x_i(t)} and Voronoi tessellation {V_i(t)}\n1462: \n1463: **Procedure**:\n1464: \n1465: 1. **For each timestep t**:\n1466: \n1467:    a. Compute the Voronoi tessellation {V_i(t)} (already available from online triangulation)\n1468: \n1469:    b. **For each walker i**:\n1470:       - Compute the mass centroid of its Voronoi cell:\n1471: \n1472:         $$\n1473:         c_i(t) = \\frac{\\int_{V_i(t)} x \\, \\rho(x) \\, dx}{\\int_{V_i(t)} \\rho(x) \\, dx}\n1474:         $$\n1475: \n1476:         (Use target density \u03c1 or empirical density from walker distribution)\n1477: \n1478:       - Compute the cell mass:\n1479: \n1480:         $$\n1481:         m_i(t) = \\int_{V_i(t)} \\rho(x) \\, dx\n1482:         $$\n1483: \n1484:       - Compute the displacement vector:\n1485: \n1486:         $$\n1487:         d_i(t) = x_i(t) - c_i(t)\n1488:         $$\n1489: \n1490:    c. **Compute global CVT energy**:\n1491: \n1492:       $$\n1493:       E_{\\text{CVT}}(t) = \\sum_{i=1}^N m_i(t) \\, \\|d_i(t)\\|^2\n1494:       $$\n1495: \n1496:    d. **Compute auxiliary diagnostics**:\n1497:       - Average displacement: D_avg(t) = (1/N) \u03a3_i ||d_i(t)||\n1498:       - Max displacement: D_max(t) = max_i ||d_i(t)||\n1499:       - Fraction of \"settled\" walkers: f_settled(t) = (1/N) |{i : ||d_i(t)|| < \u03b5}|\n1500: \n1501: 2. **Output**:\n1502:    - Time series: {E_CVT(t), D_avg(t), D_max(t), f_settled(t)}\n1503:    - Convergence rate estimate: fit exponential decay E_CVT(t) ~ E_\u221e + A exp(-\u03bbt)\n1504: \n1505: **Interpretation**:\n1506: - **Monotonic decrease**: E_CVT(t) should decrease on average (confirming Lyapunov property)\n1507: - **Plateau**: When E_CVT(t) plateaus, the system has reached a near-CVT state (geometric equilibrium)\n1508: - **Convergence rate**: The decay rate \u03bb measures how quickly the swarm \"settles\" geometrically\n1509: - **Comparison to fitness**: E_CVT convergence can precede or lag fitness convergence, revealing different convergence phases",
      "metadata": {
        "label": "alg-cvt-convergence-diagnostic"
      },
      "section": "## 9. Connections to Theoretical Framework",
      "references": [],
      "raw_directive": "1454: The CVT energy provides a powerful, parameter-free diagnostic tool for assessing convergence that goes beyond simply monitoring fitness values.\n1455: \n1456: :::{prf:algorithm} CVT Energy Convergence Diagnostic\n1457: :label: alg-cvt-convergence-diagnostic\n1458: \n1459: **Purpose**: Track the geometric convergence of the Fragile Gas to an optimal tessellation.\n1460: \n1461: **Input**: Swarm state S_t at each timestep t, with positions {x_i(t)} and Voronoi tessellation {V_i(t)}\n1462: \n1463: **Procedure**:\n1464: \n1465: 1. **For each timestep t**:\n1466: \n1467:    a. Compute the Voronoi tessellation {V_i(t)} (already available from online triangulation)\n1468: \n1469:    b. **For each walker i**:\n1470:       - Compute the mass centroid of its Voronoi cell:\n1471: \n1472:         $$\n1473:         c_i(t) = \\frac{\\int_{V_i(t)} x \\, \\rho(x) \\, dx}{\\int_{V_i(t)} \\rho(x) \\, dx}\n1474:         $$\n1475: \n1476:         (Use target density \u03c1 or empirical density from walker distribution)\n1477: \n1478:       - Compute the cell mass:\n1479: \n1480:         $$\n1481:         m_i(t) = \\int_{V_i(t)} \\rho(x) \\, dx\n1482:         $$\n1483: \n1484:       - Compute the displacement vector:\n1485: \n1486:         $$\n1487:         d_i(t) = x_i(t) - c_i(t)\n1488:         $$\n1489: \n1490:    c. **Compute global CVT energy**:\n1491: \n1492:       $$\n1493:       E_{\\text{CVT}}(t) = \\sum_{i=1}^N m_i(t) \\, \\|d_i(t)\\|^2\n1494:       $$\n1495: \n1496:    d. **Compute auxiliary diagnostics**:\n1497:       - Average displacement: D_avg(t) = (1/N) \u03a3_i ||d_i(t)||\n1498:       - Max displacement: D_max(t) = max_i ||d_i(t)||\n1499:       - Fraction of \"settled\" walkers: f_settled(t) = (1/N) |{i : ||d_i(t)|| < \u03b5}|\n1500: \n1501: 2. **Output**:\n1502:    - Time series: {E_CVT(t), D_avg(t), D_max(t), f_settled(t)}\n1503:    - Convergence rate estimate: fit exponential decay E_CVT(t) ~ E_\u221e + A exp(-\u03bbt)\n1504: \n1505: **Interpretation**:\n1506: - **Monotonic decrease**: E_CVT(t) should decrease on average (confirming Lyapunov property)\n1507: - **Plateau**: When E_CVT(t) plateaus, the system has reached a near-CVT state (geometric equilibrium)\n1508: - **Convergence rate**: The decay rate \u03bb measures how quickly the swarm \"settles\" geometrically\n1509: - **Comparison to fitness**: E_CVT convergence can precede or lag fitness convergence, revealing different convergence phases\n1510: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}