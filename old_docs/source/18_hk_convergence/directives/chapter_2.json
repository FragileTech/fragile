{
  "chapter_index": 2,
  "section_id": "## 2. Lemma A: Mass Contraction from Revival and Death",
  "directive_count": 2,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-mass-contraction-revival-death",
      "title": "Mass Contraction via Revival and Death",
      "start_line": 96,
      "end_line": 135,
      "header_lines": [
        97
      ],
      "content_start": 99,
      "content_end": 134,
      "content": "99: :label: lem-mass-contraction-revival-death\n100: \n101: Let $k_t = \\|\\mu_t\\|$ denote the number of alive walkers at time $t$ (the total mass of the empirical measure). Let $k_* = \\|\\pi_{\\text{QSD}}\\|$ denote the equilibrium alive count under the QSD.\n102: \n103: Assume:\n104: 1. **Birth Mechanism**: The Fragile Gas creates new walkers via two processes:\n105:    - Guaranteed revival of all dead walkers (from {prf:ref}`def-axiom-guaranteed-revival`)\n106:    - Cloning of alive walkers with rate $\\lambda_{\\text{clone}}(k_t)$ per walker\n107: \n108:    Total births: $B_t = (N - k_t) + C_t$ where $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$\n109: \n110: 2. **Death Mechanism**: Boundary exit causes death with rate $\\bar{p}_{\\text{kill}}(k_t)$, giving $\\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(k_t) k_t$\n111: \n112: 3. **QSD Equilibrium**: The equilibrium mass $k_*$ satisfies $(N - k_*) + \\lambda_{\\text{clone}}^* k_* = \\bar{p}_{\\text{kill}}^* k_*$\n113: \n114: 4. **Lipschitz Continuity**: Both $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k)$ are Lipschitz continuous:\n115:    - $|\\lambda_{\\text{clone}}(k_t) - \\lambda_{\\text{clone}}^*| \\leq L_\\lambda |k_t - k_*|$\n116:    - $|\\bar{p}_{\\text{kill}}(k_t) - \\bar{p}_{\\text{kill}}^*| \\leq L_p |k_t - k_*|$\n117: \n118: Then there exist constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$ such that:\n119: \n120: $$\n121: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n122: $$\n123: \n124: where:\n125: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n126: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n127: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n128: - $L_\\lambda$ is the Lipschitz constant of the cloning rate\n129: - $L_p$ is the Lipschitz constant of the killing rate\n130: - $N$ is the total number of walkers (alive + dead)\n131: \n132: **Assumptions:**\n133: 1. $\\epsilon^2 + \\epsilon < 1$, which requires $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (achieved when $L_p L_\\lambda = O(1/N^2)$ for large $N$)\n134: 2. $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with $L_g^{(2)} = O(N^{-1})$ (natural for density-dependent rates)",
      "metadata": {
        "label": "lem-mass-contraction-revival-death"
      },
      "section": "## 2. Lemma A: Mass Contraction from Revival and Death",
      "references": [
        "def-axiom-guaranteed-revival"
      ],
      "raw_directive": "96: **Our Approach:** We will prove contraction directly by analyzing the full distribution of the mass change, accounting for both revival (mass increase) and boundary death (mass decrease).\n97: \n98: :::{prf:lemma} Mass Contraction via Revival and Death\n99: :label: lem-mass-contraction-revival-death\n100: \n101: Let $k_t = \\|\\mu_t\\|$ denote the number of alive walkers at time $t$ (the total mass of the empirical measure). Let $k_* = \\|\\pi_{\\text{QSD}}\\|$ denote the equilibrium alive count under the QSD.\n102: \n103: Assume:\n104: 1. **Birth Mechanism**: The Fragile Gas creates new walkers via two processes:\n105:    - Guaranteed revival of all dead walkers (from {prf:ref}`def-axiom-guaranteed-revival`)\n106:    - Cloning of alive walkers with rate $\\lambda_{\\text{clone}}(k_t)$ per walker\n107: \n108:    Total births: $B_t = (N - k_t) + C_t$ where $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$\n109: \n110: 2. **Death Mechanism**: Boundary exit causes death with rate $\\bar{p}_{\\text{kill}}(k_t)$, giving $\\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(k_t) k_t$\n111: \n112: 3. **QSD Equilibrium**: The equilibrium mass $k_*$ satisfies $(N - k_*) + \\lambda_{\\text{clone}}^* k_* = \\bar{p}_{\\text{kill}}^* k_*$\n113: \n114: 4. **Lipschitz Continuity**: Both $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k)$ are Lipschitz continuous:\n115:    - $|\\lambda_{\\text{clone}}(k_t) - \\lambda_{\\text{clone}}^*| \\leq L_\\lambda |k_t - k_*|$\n116:    - $|\\bar{p}_{\\text{kill}}(k_t) - \\bar{p}_{\\text{kill}}^*| \\leq L_p |k_t - k_*|$\n117: \n118: Then there exist constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$ such that:\n119: \n120: $$\n121: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n122: $$\n123: \n124: where:\n125: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n126: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n127: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n128: - $L_\\lambda$ is the Lipschitz constant of the cloning rate\n129: - $L_p$ is the Lipschitz constant of the killing rate\n130: - $N$ is the total number of walkers (alive + dead)\n131: \n132: **Assumptions:**\n133: 1. $\\epsilon^2 + \\epsilon < 1$, which requires $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (achieved when $L_p L_\\lambda = O(1/N^2)$ for large $N$)\n134: 2. $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with $L_g^{(2)} = O(N^{-1})$ (natural for density-dependent rates)\n135: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-50",
      "title": null,
      "start_line": 139,
      "end_line": 781,
      "header_lines": [],
      "content_start": 141,
      "content_end": 780,
      "content": "141: :::{prf:proof}\n142: \n143: **Constants and Assumptions**\n144: \n145: The proof uses the following constants and assumptions:\n146: \n147: - **$\\lambda_{\\max}$**: Upper bound on the cloning rate: $\\lambda_{\\text{clone}}(k) \\leq \\lambda_{\\max}$ for all $k$\n148: - **$\\bar{p}_{\\max}$**: Upper bound on the killing probability: $\\bar{p}_{\\text{kill}}(k') \\leq \\bar{p}_{\\max}$ for all $k'$\n149: - **$L_\\lambda$**: Lipschitz constant of the cloning rate: $|\\lambda_{\\text{clone}}(k_1) - \\lambda_{\\text{clone}}(k_2)| \\leq L_\\lambda |k_1 - k_2|$\n150: - **$L_p$**: Lipschitz constant of the killing probability: $|\\bar{p}_{\\text{kill}}(k'_1) - \\bar{p}_{\\text{kill}}(k'_2)| \\leq L_p |k'_1 - k'_2|$\n151: - **$L_g^{(1)}$**: Bound on the first derivative of $g(c) = \\bar{p}_{\\text{kill}}(N+c)(N+c)$: $|g'(c)| \\leq L_g^{(1)}$\n152: - **$L_g^{(2)}$**: Bound on the second derivative of $g(c)$: $|g''(c)| \\leq L_g^{(2)}$\n153: \n154: **Assumption on density-dependent scaling:** For rates that depend on densities $\\rho = k/N$, we have $L_g^{(2)} = O(N^{-1})$.\n155: \n156: ---\n157: \n158: **Explicit Model Definition: Two-Stage Process**\n159: \n160: The Fragile Gas update from time $t$ to $t+1$ consists of two sequential stages:\n161: \n162: 1. **Stage 1 - Births (Cloning + Revival)**: Starting with $k_t$ alive walkers, apply the cloning operator $\\Psi_{\\text{clone}}$ which includes:\n163:    - Guaranteed revival of all $(N - k_t)$ dead walkers (Axiom of Guaranteed Revival)\n164:    - Stochastic cloning of alive walkers, creating $C_t$ new walkers\n165: \n166:    After Stage 1, the intermediate population size is:\n167: \n168:    $$\n169:    k'_t := N + C_t\n170:    $$\n171: \n172: 2. **Stage 2 - Deaths (Kinetic + Boundary)**: Apply the kinetic operator $\\Psi_{\\text{kin}}$ to the intermediate population of size $k'_t$:\n173:    - Langevin diffusion moves walkers\n174:    - Boundary killing removes $D_t$ walkers that exit $\\mathcal{X}_{\\text{valid}}$\n175: \n176:    After Stage 2, the final population size is:\n177: \n178:    $$\n179:    k_{t+1} = k'_t - D_t = N + C_t - D_t\n180:    $$\n181: \n182: **Key Insight:** Deaths $D_t$ are drawn from the intermediate population $k'_t = N + C_t$, NOT from the initial population $k_t$. This temporal ordering is critical for the correct drift calculation.\n183: \n184: **Setup: Mass Balance Equation**\n185: \n186: The mass evolution is:\n187: \n188: $$\n189: k_{t+1} = N + C_t - D_t\n190: $$\n191: \n192: where:\n193: - $C_t \\geq 0$ is the number of cloning events from Stage 1 (random variable)\n194: - $D_t \\geq 0$ is the number of deaths from Stage 2 (random variable, dependent on $C_t$)\n195: \n196: **Step 1: Expected Deaths (Two-Stage Expectation)**\n197: \n198: Deaths occur when walkers from the intermediate population $k'_t = N + C_t$ exit the valid domain during the kinetic stage.\n199: \n200: Let $\\bar{p}_{\\text{kill}}(k')$ denote the average per-walker killing probability when the population size is $k'$. Then, conditioned on $C_t$:\n201: \n202: $$\n203: \\mathbb{E}[D_t | C_t, k_t] = \\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t)\n204: $$\n205: \n206: Taking the expectation over $C_t$:\n207: \n208: $$\n209: \\mathbb{E}[D_t | k_t] = \\mathbb{E}_{C_t}[\\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t) | k_t]\n210: $$\n211: \n212: **Step 2: Expected Cloning Events**\n213: \n214: Cloning events occur in Stage 1. Let $\\lambda_{\\text{clone}}(k_t)$ denote the expected per-walker cloning rate when there are $k_t$ alive walkers:\n215: \n216: $$\n217: \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) \\cdot k_t\n218: $$\n219: \n220: **Assumption (Lipschitz Continuity of Cloning Rate):** The cloning rate is Lipschitz continuous:\n221: \n222: $$\n223: |\\lambda_{\\text{clone}}(k_1) - \\lambda_{\\text{clone}}(k_2)| \\leq L_\\lambda |k_1 - k_2|\n224: $$\n225: \n226: **Step 3: Define the Equilibrium**\n227: \n228: At equilibrium, the expected mass change is zero: $\\mathbb{E}[k_{t+1} - k_* | k_t = k_*] = 0$.\n229: \n230: From the mass balance $k_{t+1} = N + C_t - D_t$:\n231: \n232: $$\n233: \\mathbb{E}[N + C_t - D_t | k_* ] = k_*\n234: $$\n235: \n236: Using the two-stage expectation for deaths:\n237: \n238: $$\n239: N + \\mathbb{E}[C_t | k_*] - \\mathbb{E}_{C_t}[\\mathbb{E}[D_t | C_t, k_*]] = k_*\n240: $$\n241: \n242: Let $\\lambda_{\\text{clone}}^* := \\lambda_{\\text{clone}}(k_*)$ and $C_* := \\mathbb{E}[C_t | k_*] = \\lambda_{\\text{clone}}^* k_*$.\n243: \n244: At equilibrium, the intermediate population is $k'^* = N + C_*$, and:\n245: \n246: $$\n247: \\bar{p}_{\\text{kill}}^* := \\bar{p}_{\\text{kill}}(k'^*) = \\bar{p}_{\\text{kill}}(N + \\lambda_{\\text{clone}}^* k_*)\n248: $$\n249: \n250: The equilibrium condition becomes:\n251: \n252: $$\n253: N + \\lambda_{\\text{clone}}^* k_* - \\bar{p}_{\\text{kill}}^* \\cdot (N + \\lambda_{\\text{clone}}^* k_*) = k_*\n254: $$\n255: \n256: Simplifying:\n257: \n258: $$\n259: (N + \\lambda_{\\text{clone}}^* k_*)(1 - \\bar{p}_{\\text{kill}}^*) = k_*\n260: $$\n261: \n262: $$\n263: N + \\lambda_{\\text{clone}}^* k_* = \\frac{k_*}{1 - \\bar{p}_{\\text{kill}}^*}\n264: $$\n265: \n266: **Step 4: Expected Mass Change (Two-Stage Calculation with Taylor Expansion)**\n267: \n268: The deviation from equilibrium is:\n269: \n270: $$\n271: k_{t+1} - k_* = N + C_t - D_t - k_*\n272: $$\n273: \n274: Taking expectations:\n275: \n276: $$\n277: \\mathbb{E}[k_{t+1} - k_* | k_t] = N + \\mathbb{E}[C_t | k_t] - \\mathbb{E}[D_t | k_t] - k_*\n278: $$\n279: \n280: From Step 2: $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$.\n281: \n282: From Step 1, using the law of total expectation:\n283: \n284: $$\n285: \\mathbb{E}[D_t | k_t] = \\mathbb{E}_{C_t}[\\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t) | k_t]\n286: $$\n287: \n288: **Rigorous expectation calculation via Taylor expansion:**\n289: \n290: Define the death function:\n291: \n292: $$\n293: g(c) := \\bar{p}_{\\text{kill}}(N + c) \\cdot (N + c)\n294: $$\n295: \n296: **Assumption:** $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with bounded derivatives:\n297: - $|g'(c)| \\leq L_g^{(1)} < \\infty$\n298: - $|g''(c)| \\leq L_g^{(2)} < \\infty$\n299: \n300: Let $\\bar{C}_t := \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$. By Taylor's theorem:\n301: \n302: $$\n303: g(C_t) = g(\\bar{C}_t) + g'(\\bar{C}_t)(C_t - \\bar{C}_t) + \\frac{1}{2}g''(\\xi_t)(C_t - \\bar{C}_t)^2\n304: $$\n305: \n306: where $\\xi_t$ is between $C_t$ and $\\bar{C}_t$.\n307: \n308: Taking expectations:\n309: \n310: $$\n311: \\mathbb{E}[D_t | k_t] = \\mathbb{E}[g(C_t) | k_t] = g(\\bar{C}_t) + \\frac{1}{2}\\mathbb{E}[g''(\\xi_t)(C_t - \\bar{C}_t)^2 | k_t]\n312: $$\n313: \n314: The second-order term is bounded:\n315: \n316: $$\n317: \\left|\\frac{1}{2}\\mathbb{E}[g''(\\xi_t)(C_t - \\bar{C}_t)^2 | k_t]\\right| \\leq \\frac{L_g^{(2)}}{2} \\text{Var}(C_t | k_t)\n318: $$\n319: \n320: **Model for cloning variance:** Assume cloning events are independent Bernoulli trials, giving:\n321: \n322: $$\n323: \\text{Var}(C_t | k_t) \\leq \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t \\leq \\lambda_{\\max} N\n324: $$\n325: \n326: where $\\lambda_{\\max} := \\sup_{k} \\lambda_{\\text{clone}}(k)$.\n327: \n328: Thus:\n329: \n330: $$\n331: \\mathbb{E}[D_t | k_t] = g(\\bar{C}_t) + \\mathcal{E}_{\\text{drift}}\n332: $$\n333: \n334: where the drift error satisfies:\n335: \n336: $$\n337: |\\mathcal{E}_{\\text{drift}}| \\leq \\frac{L_g^{(2)} \\lambda_{\\max} N}{2}\n338: $$\n339: \n340: Define the intermediate population mean:\n341: \n342: $$\n343: \\bar{k}'_t := N + \\bar{C}_t = N + \\lambda_{\\text{clone}}(k_t) k_t\n344: $$\n345: \n346: Then:\n347: \n348: $$\n349: \\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(\\bar{k}'_t) \\cdot \\bar{k}'_t + \\mathcal{E}_{\\text{drift}}\n350: $$\n351: \n352: **Step 5: Drift Analysis Using Equilibrium (with Error Term)**\n353: \n354: Substituting into the expected mass change:\n355: \n356: $$\n357: \\mathbb{E}[k_{t+1} - k_* | k_t] = N + \\lambda_{\\text{clone}}(k_t) k_t - \\bar{p}_{\\text{kill}}(\\bar{k}'_t) \\cdot \\bar{k}'_t - \\mathcal{E}_{\\text{drift}} - k_*\n358: $$\n359: \n360: $$\n361: = \\bar{k}'_t (1 - \\bar{p}_{\\text{kill}}(\\bar{k}'_t)) - k_* - \\mathcal{E}_{\\text{drift}}\n362: $$\n363: \n364: From Step 3, at equilibrium $k'^* (1 - \\bar{p}_{\\text{kill}}^*) = k_*$. Thus:\n365: \n366: $$\n367: \\mathbb{E}[k_{t+1} - k_* | k_t] = f(\\bar{k}'_t) - f(k'^*) - \\mathcal{E}_{\\text{drift}}\n368: $$\n369: \n370: where $f(k') := k'(1 - \\bar{p}_{\\text{kill}}(k'))$.\n371: \n372: **Lipschitz continuity of $f$:** By the same calculation as before, $f$ has Lipschitz constant:\n373: \n374: $$\n375: L_f = 1 + 2L_p N + \\bar{p}_{\\text{kill}}^*\n376: $$\n377: \n378: From Step 2: $|\\bar{k}'_t - k'^*| \\leq (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*|$.\n379: \n380: Therefore:\n381: \n382: $$\n383: |f(\\bar{k}'_t) - f(k'^*)| \\leq L_f \\cdot (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*|\n384: $$\n385: \n386: Combining with the drift error from Step 4:\n387: \n388: $$\n389: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq L_f \\cdot (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*| + \\frac{L_g^{(2)} \\lambda_{\\max} N}{2}\n390: $$\n391: \n392: Define:\n393: - $\\epsilon := L_f (L_\\lambda N + \\lambda_{\\text{clone}}^*) = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n394: - $\\mathcal{E}_{\\max} := L_g^{(2)} \\lambda_{\\max} N / 2$\n395: \n396: **Step 6: Lyapunov Function - Squared Error Contraction**\n397: \n398: To properly handle the stochastic fluctuations, we use a **Lyapunov function** approach. Define:\n399: \n400: $$\n401: V(k_t) := (k_t - k_*)^2\n402: $$\n403: \n404: We will prove a drift inequality:\n405: \n406: $$\n407: \\mathbb{E}[V(k_{t+1}) | k_t] \\leq (1 - \\kappa_{\\text{mass}}) V(k_t) + C_{\\text{mass}}\n408: $$\n409: \n410: for some constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$.\n411: \n412: **Step 6a: Expansion of Expected Squared Error**\n413: \n414: The mass deviation at time $t+1$ is:\n415: \n416: $$\n417: k_{t+1} - k_* = N + C_t - D_t - k_*\n418: $$\n419: \n420: From Step 4, using the equilibrium condition:\n421: \n422: $$\n423: k_{t+1} - k_* = (\\bar{p}_{\\text{kill}}^* - \\lambda_{\\text{clone}}^*) k_* - (k_t - k_*) + C_t - D_t\n424: $$\n425: \n426: Define:\n427: - $\\Delta C_t := C_t - \\mathbb{E}[C_t | k_t]$ (cloning fluctuation)\n428: - $\\Delta D_t := D_t - \\mathbb{E}[D_t | k_t]$ (death fluctuation)\n429: \n430: Then:\n431: \n432: $$\n433: k_{t+1} - k_* = \\mathbb{E}[k_{t+1} - k_* | k_t] + \\Delta C_t - \\Delta D_t\n434: $$\n435: \n436: Squaring:\n437: \n438: $$\n439: (k_{t+1} - k_*)^2 = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + 2\\mathbb{E}[k_{t+1} - k_* | k_t](\\Delta C_t - \\Delta D_t) + (\\Delta C_t - \\Delta D_t)^2\n440: $$\n441: \n442: Taking expectations (and using $\\mathbb{E}[\\Delta C_t | k_t] = \\mathbb{E}[\\Delta D_t | k_t] = 0$):\n443: \n444: $$\n445: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + \\text{Var}(C_t - D_t | k_t)\n446: $$\n447: \n448: **Step 6b: Rigorous Variance Bound Using Law of Total Variance**\n449: \n450: Since $D_t$ depends on $C_t$ (deaths are drawn from the intermediate population), we use the law of total variance:\n451: \n452: $$\n453: \\text{Var}(C_t - D_t | k_t) = \\mathbb{E}[\\text{Var}(C_t - D_t | C_t, k_t)] + \\text{Var}(\\mathbb{E}[C_t - D_t | C_t, k_t])\n454: $$\n455: \n456: **Term 1: Conditional variance**\n457: \n458: From the two-stage model, conditioned on $C_t$:\n459: \n460: $$\n461: \\text{Var}(C_t - D_t | C_t, k_t) = \\text{Var}(D_t | C_t, k_t)\n462: $$\n463: \n464: For binomial-like death processes:\n465: \n466: $$\n467: \\text{Var}(D_t | C_t, k_t) \\leq \\mathbb{E}[D_t | C_t, k_t] = \\bar{p}_{\\text{kill}}(N + C_t)(N + C_t)\n468: $$\n469: \n470: Taking expectations over $C_t$:\n471: \n472: $$\n473: \\mathbb{E}[\\text{Var}(D_t | C_t, k_t)] \\leq \\mathbb{E}[\\bar{p}_{\\text{kill}}(N + C_t)(N + C_t)] \\leq \\bar{p}_{\\max} \\mathbb{E}[N + C_t] = \\bar{p}_{\\max}(N + \\lambda_{\\text{clone}}(k_t) k_t)\n474: $$\n475: \n476: where $\\bar{p}_{\\max} := \\sup_{k'} \\bar{p}_{\\text{kill}}(k')$. Thus:\n477: \n478: $$\n479: \\mathbb{E}[\\text{Var}(C_t - D_t | C_t, k_t)] \\leq \\bar{p}_{\\max} N (1 + \\lambda_{\\max})\n480: $$\n481: \n482: **Term 2: Variance of conditional expectation**\n483: \n484: Define $h(c) := c - g(c) = c - \\bar{p}_{\\text{kill}}(N + c)(N + c)$ where $g$ is the death function from Step 4.\n485: \n486: Then:\n487: \n488: $$\n489: \\text{Var}(\\mathbb{E}[C_t - D_t | C_t, k_t]) = \\text{Var}(h(C_t) | k_t)\n490: $$\n491: \n492: **Rigorous bound via Taylor expansion:**\n493: \n494: Let $\\mu_c := \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$. Expand $h(C_t)$ around $\\mu_c$ using Taylor's theorem:\n495: \n496: $$\n497: h(C_t) = h(\\mu_c) + h'(\\mu_c)(C_t - \\mu_c) + \\frac{1}{2}h''(\\xi_t)(C_t - \\mu_c)^2\n498: $$\n499: \n500: where $\\xi_t$ is between $C_t$ and $\\mu_c$.\n501: \n502: Taking the variance (noting that $\\mathbb{E}[C_t - \\mu_c | k_t] = 0$):\n503: \n504: $$\n505: \\text{Var}(h(C_t) | k_t) = \\mathbb{E}\\left[\\left(h'(\\mu_c)(C_t - \\mu_c) + \\frac{1}{2}h''(\\xi_t)(C_t - \\mu_c)^2\\right)^2 \\bigg| k_t\\right]\n506: $$\n507: \n508: Expanding the square and using $(a+b)^2 \\leq 2a^2 + 2b^2$:\n509: \n510: $$\n511: \\text{Var}(h(C_t) | k_t) \\leq 2[h'(\\mu_c)]^2 \\text{Var}(C_t | k_t) + 2\\mathbb{E}\\left[\\frac{1}{4}[h''(\\xi_t)]^2(C_t - \\mu_c)^4 \\bigg| k_t\\right]\n512: $$\n513: \n514: **Bounding the derivatives:**\n515: \n516: The function $h$ has derivatives:\n517: - $h'(c) = 1 - g'(c)$, with $|h'(c)| \\leq 1 + L_g^{(1)}$ (from Lipschitz property of $g$)\n518: - $h''(c) = -g''(c)$, with $|h''(c)| \\leq L_g^{(2)}$\n519: \n520: **Bounding the fourth moment:**\n521: \n522: For Bernoulli cloning, $C_t$ is distributed as a sum of $k_t$ independent Bernoulli trials with individual success probability $p_t = \\lambda_{\\text{clone}}(k_t)$. Thus $C_t \\sim \\text{Binomial}(k_t, p_t)$ with mean $\\mu_c = k_t p_t$ and variance $\\sigma_c^2 = k_t p_t(1-p_t) \\leq \\mu_c$.\n523: \n524: The fourth central moment of a binomial distribution is:\n525: \n526: $$\n527: \\mu_4 = \\mathbb{E}[(C_t - \\mu_c)^4 | k_t] = 3\\sigma_c^4 + \\sigma_c^2(1 - 6p_t(1-p_t))\n528: $$\n529: \n530: Since $0 \\leq p_t \\leq 1$, we have $6p_t(1-p_t) \\leq 3/2$, so $1 - 6p_t(1-p_t) \\geq -1/2$. Therefore:\n531: \n532: $$\n533: \\mu_4 \\leq 3\\sigma_c^4 + \\sigma_c^2 \\leq 3\\mu_c^2 + \\mu_c\n534: $$\n535: \n536: Since $\\mu_c = \\lambda_{\\text{clone}}(k_t) k_t \\leq \\lambda_{\\max} N$, this gives:\n537: \n538: $$\n539: \\mu_4 \\leq 3(\\lambda_{\\max} N)^2 + \\lambda_{\\max} N\n540: $$\n541: \n542: where we used $\\sigma_c^2 \\leq \\mu_c$.\n543: \n544: Therefore:\n545: \n546: $$\n547: \\text{Var}(h(C_t) | k_t) \\leq 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{1}{2}(L_g^{(2)})^2 (3(\\lambda_{\\max} N)^2 + \\lambda_{\\max} N)\n548: $$\n549: \n550: $$\n551: = 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{3}{2}(L_g^{(2)})^2 (\\lambda_{\\max} N)^2 + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} N\n552: $$\n553: \n554: **Combined variance bound:**\n555: \n556: Combining the two terms from the law of total variance:\n557: \n558: $$\n559: \\text{Var}(C_t - D_t | k_t) \\leq \\bar{p}_{\\max} N (1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{3}{2}(L_g^{(2)})^2 (\\lambda_{\\max} N)^2 + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} N\n560: $$\n561: \n562: Collecting the $O(N)$ terms:\n563: \n564: $$\n565: = N\\left[\\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}\\right] + \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2\n566: $$\n567: \n568: Define the variance constant and the $O(1)$ remainder:\n569: \n570: $$\n571: C_{\\text{var}} := \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} = O(1)\n572: $$\n573: \n574: $$\n575: C_2 := \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2 = O(1) \\quad \\text{(for density-dependent rates with } L_g^{(2)} = O(N^{-1}))\n576: $$\n577: \n578: Then:\n579: \n580: $$\n581: \\text{Var}(C_t - D_t | k_t) \\leq C_{\\text{var}} N + C_2\n582: $$\n583: \n584: **Step 6c: Bound the Drift Term**\n585: \n586: From Step 5, we have:\n587: \n588: $$\n589: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq \\epsilon |k_t - k_*|\n590: $$\n591: \n592: where $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$.\n593: \n594: **Key requirement:** For contraction, we need $\\epsilon < 1$. Expanding:\n595: \n596: $$\n597: \\epsilon = L_\\lambda N + \\lambda_{\\text{clone}}^* + 2L_p L_\\lambda N^2 + O(N)\n598: $$\n599: \n600: The dominant term is $2L_p L_\\lambda N^2$. Thus, $\\epsilon < 1$ requires:\n601: \n602: $$\n603: L_p L_\\lambda \\ll \\frac{1}{N^2}\n604: $$\n605: \n606: **Physical interpretation:** This condition states that the product of Lipschitz constants must scale as $O(1/N^2)$. This is natural if rates depend on densities $k/N$ rather than absolute counts, giving $L_p, L_\\lambda \\sim O(1/N)$.\n607: \n608: **Step 6d: Final Lyapunov Inequality (with Error Term)**\n609: \n610: From Step 6a:\n611: \n612: $$\n613: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + \\text{Var}(C_t - D_t | k_t)\n614: $$\n615: \n616: From Step 5, we have:\n617: \n618: $$\n619: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq \\epsilon |k_t - k_*| + \\mathcal{E}_{\\max}\n620: $$\n621: \n622: Thus:\n623: \n624: $$\n625: (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 \\leq (\\epsilon |k_t - k_*| + \\mathcal{E}_{\\max})^2 = \\epsilon^2 (k_t - k_*)^2 + 2\\epsilon \\mathcal{E}_{\\max} |k_t - k_*| + \\mathcal{E}_{\\max}^2\n626: $$\n627: \n628: From Step 6b:\n629: \n630: $$\n631: \\text{Var}(C_t - D_t | k_t) \\leq C_{\\text{var}} N + C_2\n632: $$\n633: \n634: Combining:\n635: \n636: $$\n637: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq \\epsilon^2 (k_t - k_*)^2 + 2\\epsilon \\mathcal{E}_{\\max} |k_t - k_*| + \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N + C_2\n638: $$\n639: \n640: **Bounding the cross-term using Young's inequality:**\n641: \n642: We use the general Young's inequality for products: $2ab \\leq \\delta a^2 + (1/\\delta)b^2$ for any $\\delta > 0$.\n643: \n644: The squared drift term is $(A + B)^2$ where $A = \\epsilon |k_t - k_*|$ and $B = \\mathcal{E}_{\\max}$:\n645: \n646: $$\n647: (A + B)^2 = A^2 + 2AB + B^2 \\leq A^2 + \\delta A^2 + \\frac{1}{\\delta}B^2 + B^2 = (1 + \\delta)A^2 + \\left(1 + \\frac{1}{\\delta}\\right)B^2\n648: $$\n649: \n650: Choosing $\\delta = 1/\\epsilon$ (valid since $\\epsilon > 0$):\n651: \n652: $$\n653: (A + B)^2 \\leq \\left(1 + \\frac{1}{\\epsilon}\\right)\\epsilon^2 (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 = (\\epsilon^2 + \\epsilon)(k_t - k_*)^2 + (1 + \\epsilon)\\mathcal{E}_{\\max}^2\n654: $$\n655: \n656: Combining all terms:\n657: \n658: $$\n659: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (\\epsilon^2 + \\epsilon) (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N + C_2\n660: $$\n661: \n662: **Contraction condition:** For contraction, we require:\n663: \n664: $$\n665: \\epsilon^2 + \\epsilon < 1\n666: $$\n667: \n668: Solving: $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (golden ratio minus 1).\n669: \n670: **Derivation of the contraction rate $\\kappa_{\\text{mass}}$:**\n671: \n672: From the inequality above, we have shown:\n673: \n674: $$\n675: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (\\epsilon^2 + \\epsilon) (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N\n676: $$\n677: \n678: To express this in the standard form of a Lyapunov drift inequality:\n679: \n680: $$\n681: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (1 - 2\\kappa_{\\text{mass}}) (k_t - k_*)^2 + C_{\\text{mass}}\n682: $$\n683: \n684: we require the contraction coefficient to satisfy:\n685: \n686: $$\n687: 1 - 2\\kappa_{\\text{mass}} = \\epsilon^2 + \\epsilon\n688: $$\n689: \n690: Solving for $\\kappa_{\\text{mass}}$:\n691: \n692: $$\n693: 2\\kappa_{\\text{mass}} = 1 - (\\epsilon^2 + \\epsilon) = 1 - \\epsilon(1 + \\epsilon)\n694: $$\n695: \n696: Thus:\n697: \n698: $$\n699: \\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}\n700: $$\n701: \n702: For positivity of $\\kappa_{\\text{mass}}$, we need $\\epsilon^2 + \\epsilon < 1$, which is satisfied when $\\epsilon < \\frac{\\sqrt{5}-1}{2}$.\n703: \n704: The final Lyapunov inequality is:\n705: \n706: $$\n707: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (1 - 2\\kappa_{\\text{mass}}) (k_t - k_*)^2 + C_{\\text{mass}}\n708: $$\n709: \n710: where:\n711: \n712: $$\n713: C_{\\text{mass}} := C_{\\text{var}} N + C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2\n714: $$\n715: \n716: **Scaling of $C_{\\text{mass}}$:** For density-dependent death rates $\\bar{p}_{\\text{kill}}(k') = p(k'/N)$, the second derivative satisfies $L_g^{(2)} = O(N^{-1})$ (as established in the Constants and Assumptions section at the beginning of this proof). Therefore:\n717: \n718: $$\n719: \\mathcal{E}_{\\max} = \\frac{L_g^{(2)} \\lambda_{\\max} N}{2} = O(1), \\quad \\mathcal{E}_{\\max}^2 = O(1)\n720: $$\n721: \n722: From Step 6b, $C_2 = \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2 = O(1)$ as well.\n723: \n724: The constant term is:\n725: \n726: $$\n727: C_{\\text{mass}} = C_{\\text{var}} N + C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 = O(N)\n728: $$\n729: \n730: The $O(N)$ scaling is dominated by the variance term $C_{\\text{var}} N$ from Step 6b, with both $C_2 = O(1)$ and $(1 + \\epsilon) \\mathcal{E}_{\\max}^2 = O(1)$ contributing to the overall constant but not affecting the leading-order scaling.\n731: \n732: We write $C_{\\text{mass}} = C_N \\cdot N$ where:\n733: \n734: $$\n735: C_N := C_{\\text{var}} + \\frac{C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2}{N} = O(1)\n736: $$\n737: \n738: **Step 7: Final Result and Physical Interpretation**\n739: \n740: Taking total expectation:\n741: \n742: $$\n743: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n744: $$\n745: \n746: where:\n747: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n748: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n749: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n750: - $L_\\lambda$ is the Lipschitz constant of the cloning rate $\\lambda_{\\text{clone}}(k)$\n751: - $L_p$ is the Lipschitz constant of the killing rate $\\bar{p}_{\\text{kill}}(k')$\n752: - $L_g^{(2)}$ is the bound on the second derivative of $g(c) = \\bar{p}_{\\text{kill}}(N + c)(N + c)$\n753: - $N$ is the total number of walkers (alive + dead)\n754: \n755: **Assumption for positivity of $\\kappa_{\\text{mass}}$:** We require $\\epsilon^2 + \\epsilon < 1$, which gives $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$. From Step 6c, this requires:\n756: \n757: $$\n758: L_p L_\\lambda = O(N^{-2})\n759: $$\n760: \n761: **Physical plausibility of the assumption:** This condition is natural when birth/death rates depend on **densities** rather than absolute counts. If:\n762: \n763: $$\n764: \\lambda_{\\text{clone}}(k) = \\lambda(\\rho) \\quad \\text{where } \\rho = k/N\n765: $$\n766: \n767: $$\n768: \\bar{p}_{\\text{kill}}(k') = p(\\rho') \\quad \\text{where } \\rho' = k'/N\n769: $$\n770: \n771: Then the Lipschitz constants with respect to $k$ are:\n772: \n773: $$\n774: L_\\lambda = \\frac{1}{N} \\sup_\\rho |\\lambda'(\\rho)|, \\quad L_p = \\frac{1}{N} \\sup_{\\rho'} |p'(\\rho')|\n775: $$\n776: \n777: Thus $L_p L_\\lambda = O(N^{-2})$, and the condition is automatically satisfied for any smooth density-dependent rates.\n778: \n779: **Convergence:** This is the standard drift inequality for squared error, which implies exponential convergence of $\\mathbb{E}[(k_t - k_*)^2]$ to the stationary distribution with $\\mathbb{E}[(k_\\infty - k_*)^2] = O(C_{\\text{mass}}/\\kappa_{\\text{mass}}) = O(N/\\kappa_{\\text{mass}})$.\n780: ",
      "metadata": {},
      "section": "## 2. Lemma A: Mass Contraction from Revival and Death",
      "references": [],
      "raw_directive": "139: ### Proof of Lemma A\n140: \n141: :::{prf:proof}\n142: \n143: **Constants and Assumptions**\n144: \n145: The proof uses the following constants and assumptions:\n146: \n147: - **$\\lambda_{\\max}$**: Upper bound on the cloning rate: $\\lambda_{\\text{clone}}(k) \\leq \\lambda_{\\max}$ for all $k$\n148: - **$\\bar{p}_{\\max}$**: Upper bound on the killing probability: $\\bar{p}_{\\text{kill}}(k') \\leq \\bar{p}_{\\max}$ for all $k'$\n149: - **$L_\\lambda$**: Lipschitz constant of the cloning rate: $|\\lambda_{\\text{clone}}(k_1) - \\lambda_{\\text{clone}}(k_2)| \\leq L_\\lambda |k_1 - k_2|$\n150: - **$L_p$**: Lipschitz constant of the killing probability: $|\\bar{p}_{\\text{kill}}(k'_1) - \\bar{p}_{\\text{kill}}(k'_2)| \\leq L_p |k'_1 - k'_2|$\n151: - **$L_g^{(1)}$**: Bound on the first derivative of $g(c) = \\bar{p}_{\\text{kill}}(N+c)(N+c)$: $|g'(c)| \\leq L_g^{(1)}$\n152: - **$L_g^{(2)}$**: Bound on the second derivative of $g(c)$: $|g''(c)| \\leq L_g^{(2)}$\n153: \n154: **Assumption on density-dependent scaling:** For rates that depend on densities $\\rho = k/N$, we have $L_g^{(2)} = O(N^{-1})$.\n155: \n156: ---\n157: \n158: **Explicit Model Definition: Two-Stage Process**\n159: \n160: The Fragile Gas update from time $t$ to $t+1$ consists of two sequential stages:\n161: \n162: 1. **Stage 1 - Births (Cloning + Revival)**: Starting with $k_t$ alive walkers, apply the cloning operator $\\Psi_{\\text{clone}}$ which includes:\n163:    - Guaranteed revival of all $(N - k_t)$ dead walkers (Axiom of Guaranteed Revival)\n164:    - Stochastic cloning of alive walkers, creating $C_t$ new walkers\n165: \n166:    After Stage 1, the intermediate population size is:\n167: \n168:    $$\n169:    k'_t := N + C_t\n170:    $$\n171: \n172: 2. **Stage 2 - Deaths (Kinetic + Boundary)**: Apply the kinetic operator $\\Psi_{\\text{kin}}$ to the intermediate population of size $k'_t$:\n173:    - Langevin diffusion moves walkers\n174:    - Boundary killing removes $D_t$ walkers that exit $\\mathcal{X}_{\\text{valid}}$\n175: \n176:    After Stage 2, the final population size is:\n177: \n178:    $$\n179:    k_{t+1} = k'_t - D_t = N + C_t - D_t\n180:    $$\n181: \n182: **Key Insight:** Deaths $D_t$ are drawn from the intermediate population $k'_t = N + C_t$, NOT from the initial population $k_t$. This temporal ordering is critical for the correct drift calculation.\n183: \n184: **Setup: Mass Balance Equation**\n185: \n186: The mass evolution is:\n187: \n188: $$\n189: k_{t+1} = N + C_t - D_t\n190: $$\n191: \n192: where:\n193: - $C_t \\geq 0$ is the number of cloning events from Stage 1 (random variable)\n194: - $D_t \\geq 0$ is the number of deaths from Stage 2 (random variable, dependent on $C_t$)\n195: \n196: **Step 1: Expected Deaths (Two-Stage Expectation)**\n197: \n198: Deaths occur when walkers from the intermediate population $k'_t = N + C_t$ exit the valid domain during the kinetic stage.\n199: \n200: Let $\\bar{p}_{\\text{kill}}(k')$ denote the average per-walker killing probability when the population size is $k'$. Then, conditioned on $C_t$:\n201: \n202: $$\n203: \\mathbb{E}[D_t | C_t, k_t] = \\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t)\n204: $$\n205: \n206: Taking the expectation over $C_t$:\n207: \n208: $$\n209: \\mathbb{E}[D_t | k_t] = \\mathbb{E}_{C_t}[\\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t) | k_t]\n210: $$\n211: \n212: **Step 2: Expected Cloning Events**\n213: \n214: Cloning events occur in Stage 1. Let $\\lambda_{\\text{clone}}(k_t)$ denote the expected per-walker cloning rate when there are $k_t$ alive walkers:\n215: \n216: $$\n217: \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) \\cdot k_t\n218: $$\n219: \n220: **Assumption (Lipschitz Continuity of Cloning Rate):** The cloning rate is Lipschitz continuous:\n221: \n222: $$\n223: |\\lambda_{\\text{clone}}(k_1) - \\lambda_{\\text{clone}}(k_2)| \\leq L_\\lambda |k_1 - k_2|\n224: $$\n225: \n226: **Step 3: Define the Equilibrium**\n227: \n228: At equilibrium, the expected mass change is zero: $\\mathbb{E}[k_{t+1} - k_* | k_t = k_*] = 0$.\n229: \n230: From the mass balance $k_{t+1} = N + C_t - D_t$:\n231: \n232: $$\n233: \\mathbb{E}[N + C_t - D_t | k_* ] = k_*\n234: $$\n235: \n236: Using the two-stage expectation for deaths:\n237: \n238: $$\n239: N + \\mathbb{E}[C_t | k_*] - \\mathbb{E}_{C_t}[\\mathbb{E}[D_t | C_t, k_*]] = k_*\n240: $$\n241: \n242: Let $\\lambda_{\\text{clone}}^* := \\lambda_{\\text{clone}}(k_*)$ and $C_* := \\mathbb{E}[C_t | k_*] = \\lambda_{\\text{clone}}^* k_*$.\n243: \n244: At equilibrium, the intermediate population is $k'^* = N + C_*$, and:\n245: \n246: $$\n247: \\bar{p}_{\\text{kill}}^* := \\bar{p}_{\\text{kill}}(k'^*) = \\bar{p}_{\\text{kill}}(N + \\lambda_{\\text{clone}}^* k_*)\n248: $$\n249: \n250: The equilibrium condition becomes:\n251: \n252: $$\n253: N + \\lambda_{\\text{clone}}^* k_* - \\bar{p}_{\\text{kill}}^* \\cdot (N + \\lambda_{\\text{clone}}^* k_*) = k_*\n254: $$\n255: \n256: Simplifying:\n257: \n258: $$\n259: (N + \\lambda_{\\text{clone}}^* k_*)(1 - \\bar{p}_{\\text{kill}}^*) = k_*\n260: $$\n261: \n262: $$\n263: N + \\lambda_{\\text{clone}}^* k_* = \\frac{k_*}{1 - \\bar{p}_{\\text{kill}}^*}\n264: $$\n265: \n266: **Step 4: Expected Mass Change (Two-Stage Calculation with Taylor Expansion)**\n267: \n268: The deviation from equilibrium is:\n269: \n270: $$\n271: k_{t+1} - k_* = N + C_t - D_t - k_*\n272: $$\n273: \n274: Taking expectations:\n275: \n276: $$\n277: \\mathbb{E}[k_{t+1} - k_* | k_t] = N + \\mathbb{E}[C_t | k_t] - \\mathbb{E}[D_t | k_t] - k_*\n278: $$\n279: \n280: From Step 2: $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$.\n281: \n282: From Step 1, using the law of total expectation:\n283: \n284: $$\n285: \\mathbb{E}[D_t | k_t] = \\mathbb{E}_{C_t}[\\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t) | k_t]\n286: $$\n287: \n288: **Rigorous expectation calculation via Taylor expansion:**\n289: \n290: Define the death function:\n291: \n292: $$\n293: g(c) := \\bar{p}_{\\text{kill}}(N + c) \\cdot (N + c)\n294: $$\n295: \n296: **Assumption:** $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with bounded derivatives:\n297: - $|g'(c)| \\leq L_g^{(1)} < \\infty$\n298: - $|g''(c)| \\leq L_g^{(2)} < \\infty$\n299: \n300: Let $\\bar{C}_t := \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$. By Taylor's theorem:\n301: \n302: $$\n303: g(C_t) = g(\\bar{C}_t) + g'(\\bar{C}_t)(C_t - \\bar{C}_t) + \\frac{1}{2}g''(\\xi_t)(C_t - \\bar{C}_t)^2\n304: $$\n305: \n306: where $\\xi_t$ is between $C_t$ and $\\bar{C}_t$.\n307: \n308: Taking expectations:\n309: \n310: $$\n311: \\mathbb{E}[D_t | k_t] = \\mathbb{E}[g(C_t) | k_t] = g(\\bar{C}_t) + \\frac{1}{2}\\mathbb{E}[g''(\\xi_t)(C_t - \\bar{C}_t)^2 | k_t]\n312: $$\n313: \n314: The second-order term is bounded:\n315: \n316: $$\n317: \\left|\\frac{1}{2}\\mathbb{E}[g''(\\xi_t)(C_t - \\bar{C}_t)^2 | k_t]\\right| \\leq \\frac{L_g^{(2)}}{2} \\text{Var}(C_t | k_t)\n318: $$\n319: \n320: **Model for cloning variance:** Assume cloning events are independent Bernoulli trials, giving:\n321: \n322: $$\n323: \\text{Var}(C_t | k_t) \\leq \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t \\leq \\lambda_{\\max} N\n324: $$\n325: \n326: where $\\lambda_{\\max} := \\sup_{k} \\lambda_{\\text{clone}}(k)$.\n327: \n328: Thus:\n329: \n330: $$\n331: \\mathbb{E}[D_t | k_t] = g(\\bar{C}_t) + \\mathcal{E}_{\\text{drift}}\n332: $$\n333: \n334: where the drift error satisfies:\n335: \n336: $$\n337: |\\mathcal{E}_{\\text{drift}}| \\leq \\frac{L_g^{(2)} \\lambda_{\\max} N}{2}\n338: $$\n339: \n340: Define the intermediate population mean:\n341: \n342: $$\n343: \\bar{k}'_t := N + \\bar{C}_t = N + \\lambda_{\\text{clone}}(k_t) k_t\n344: $$\n345: \n346: Then:\n347: \n348: $$\n349: \\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(\\bar{k}'_t) \\cdot \\bar{k}'_t + \\mathcal{E}_{\\text{drift}}\n350: $$\n351: \n352: **Step 5: Drift Analysis Using Equilibrium (with Error Term)**\n353: \n354: Substituting into the expected mass change:\n355: \n356: $$\n357: \\mathbb{E}[k_{t+1} - k_* | k_t] = N + \\lambda_{\\text{clone}}(k_t) k_t - \\bar{p}_{\\text{kill}}(\\bar{k}'_t) \\cdot \\bar{k}'_t - \\mathcal{E}_{\\text{drift}} - k_*\n358: $$\n359: \n360: $$\n361: = \\bar{k}'_t (1 - \\bar{p}_{\\text{kill}}(\\bar{k}'_t)) - k_* - \\mathcal{E}_{\\text{drift}}\n362: $$\n363: \n364: From Step 3, at equilibrium $k'^* (1 - \\bar{p}_{\\text{kill}}^*) = k_*$. Thus:\n365: \n366: $$\n367: \\mathbb{E}[k_{t+1} - k_* | k_t] = f(\\bar{k}'_t) - f(k'^*) - \\mathcal{E}_{\\text{drift}}\n368: $$\n369: \n370: where $f(k') := k'(1 - \\bar{p}_{\\text{kill}}(k'))$.\n371: \n372: **Lipschitz continuity of $f$:** By the same calculation as before, $f$ has Lipschitz constant:\n373: \n374: $$\n375: L_f = 1 + 2L_p N + \\bar{p}_{\\text{kill}}^*\n376: $$\n377: \n378: From Step 2: $|\\bar{k}'_t - k'^*| \\leq (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*|$.\n379: \n380: Therefore:\n381: \n382: $$\n383: |f(\\bar{k}'_t) - f(k'^*)| \\leq L_f \\cdot (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*|\n384: $$\n385: \n386: Combining with the drift error from Step 4:\n387: \n388: $$\n389: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq L_f \\cdot (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*| + \\frac{L_g^{(2)} \\lambda_{\\max} N}{2}\n390: $$\n391: \n392: Define:\n393: - $\\epsilon := L_f (L_\\lambda N + \\lambda_{\\text{clone}}^*) = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n394: - $\\mathcal{E}_{\\max} := L_g^{(2)} \\lambda_{\\max} N / 2$\n395: \n396: **Step 6: Lyapunov Function - Squared Error Contraction**\n397: \n398: To properly handle the stochastic fluctuations, we use a **Lyapunov function** approach. Define:\n399: \n400: $$\n401: V(k_t) := (k_t - k_*)^2\n402: $$\n403: \n404: We will prove a drift inequality:\n405: \n406: $$\n407: \\mathbb{E}[V(k_{t+1}) | k_t] \\leq (1 - \\kappa_{\\text{mass}}) V(k_t) + C_{\\text{mass}}\n408: $$\n409: \n410: for some constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$.\n411: \n412: **Step 6a: Expansion of Expected Squared Error**\n413: \n414: The mass deviation at time $t+1$ is:\n415: \n416: $$\n417: k_{t+1} - k_* = N + C_t - D_t - k_*\n418: $$\n419: \n420: From Step 4, using the equilibrium condition:\n421: \n422: $$\n423: k_{t+1} - k_* = (\\bar{p}_{\\text{kill}}^* - \\lambda_{\\text{clone}}^*) k_* - (k_t - k_*) + C_t - D_t\n424: $$\n425: \n426: Define:\n427: - $\\Delta C_t := C_t - \\mathbb{E}[C_t | k_t]$ (cloning fluctuation)\n428: - $\\Delta D_t := D_t - \\mathbb{E}[D_t | k_t]$ (death fluctuation)\n429: \n430: Then:\n431: \n432: $$\n433: k_{t+1} - k_* = \\mathbb{E}[k_{t+1} - k_* | k_t] + \\Delta C_t - \\Delta D_t\n434: $$\n435: \n436: Squaring:\n437: \n438: $$\n439: (k_{t+1} - k_*)^2 = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + 2\\mathbb{E}[k_{t+1} - k_* | k_t](\\Delta C_t - \\Delta D_t) + (\\Delta C_t - \\Delta D_t)^2\n440: $$\n441: \n442: Taking expectations (and using $\\mathbb{E}[\\Delta C_t | k_t] = \\mathbb{E}[\\Delta D_t | k_t] = 0$):\n443: \n444: $$\n445: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + \\text{Var}(C_t - D_t | k_t)\n446: $$\n447: \n448: **Step 6b: Rigorous Variance Bound Using Law of Total Variance**\n449: \n450: Since $D_t$ depends on $C_t$ (deaths are drawn from the intermediate population), we use the law of total variance:\n451: \n452: $$\n453: \\text{Var}(C_t - D_t | k_t) = \\mathbb{E}[\\text{Var}(C_t - D_t | C_t, k_t)] + \\text{Var}(\\mathbb{E}[C_t - D_t | C_t, k_t])\n454: $$\n455: \n456: **Term 1: Conditional variance**\n457: \n458: From the two-stage model, conditioned on $C_t$:\n459: \n460: $$\n461: \\text{Var}(C_t - D_t | C_t, k_t) = \\text{Var}(D_t | C_t, k_t)\n462: $$\n463: \n464: For binomial-like death processes:\n465: \n466: $$\n467: \\text{Var}(D_t | C_t, k_t) \\leq \\mathbb{E}[D_t | C_t, k_t] = \\bar{p}_{\\text{kill}}(N + C_t)(N + C_t)\n468: $$\n469: \n470: Taking expectations over $C_t$:\n471: \n472: $$\n473: \\mathbb{E}[\\text{Var}(D_t | C_t, k_t)] \\leq \\mathbb{E}[\\bar{p}_{\\text{kill}}(N + C_t)(N + C_t)] \\leq \\bar{p}_{\\max} \\mathbb{E}[N + C_t] = \\bar{p}_{\\max}(N + \\lambda_{\\text{clone}}(k_t) k_t)\n474: $$\n475: \n476: where $\\bar{p}_{\\max} := \\sup_{k'} \\bar{p}_{\\text{kill}}(k')$. Thus:\n477: \n478: $$\n479: \\mathbb{E}[\\text{Var}(C_t - D_t | C_t, k_t)] \\leq \\bar{p}_{\\max} N (1 + \\lambda_{\\max})\n480: $$\n481: \n482: **Term 2: Variance of conditional expectation**\n483: \n484: Define $h(c) := c - g(c) = c - \\bar{p}_{\\text{kill}}(N + c)(N + c)$ where $g$ is the death function from Step 4.\n485: \n486: Then:\n487: \n488: $$\n489: \\text{Var}(\\mathbb{E}[C_t - D_t | C_t, k_t]) = \\text{Var}(h(C_t) | k_t)\n490: $$\n491: \n492: **Rigorous bound via Taylor expansion:**\n493: \n494: Let $\\mu_c := \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$. Expand $h(C_t)$ around $\\mu_c$ using Taylor's theorem:\n495: \n496: $$\n497: h(C_t) = h(\\mu_c) + h'(\\mu_c)(C_t - \\mu_c) + \\frac{1}{2}h''(\\xi_t)(C_t - \\mu_c)^2\n498: $$\n499: \n500: where $\\xi_t$ is between $C_t$ and $\\mu_c$.\n501: \n502: Taking the variance (noting that $\\mathbb{E}[C_t - \\mu_c | k_t] = 0$):\n503: \n504: $$\n505: \\text{Var}(h(C_t) | k_t) = \\mathbb{E}\\left[\\left(h'(\\mu_c)(C_t - \\mu_c) + \\frac{1}{2}h''(\\xi_t)(C_t - \\mu_c)^2\\right)^2 \\bigg| k_t\\right]\n506: $$\n507: \n508: Expanding the square and using $(a+b)^2 \\leq 2a^2 + 2b^2$:\n509: \n510: $$\n511: \\text{Var}(h(C_t) | k_t) \\leq 2[h'(\\mu_c)]^2 \\text{Var}(C_t | k_t) + 2\\mathbb{E}\\left[\\frac{1}{4}[h''(\\xi_t)]^2(C_t - \\mu_c)^4 \\bigg| k_t\\right]\n512: $$\n513: \n514: **Bounding the derivatives:**\n515: \n516: The function $h$ has derivatives:\n517: - $h'(c) = 1 - g'(c)$, with $|h'(c)| \\leq 1 + L_g^{(1)}$ (from Lipschitz property of $g$)\n518: - $h''(c) = -g''(c)$, with $|h''(c)| \\leq L_g^{(2)}$\n519: \n520: **Bounding the fourth moment:**\n521: \n522: For Bernoulli cloning, $C_t$ is distributed as a sum of $k_t$ independent Bernoulli trials with individual success probability $p_t = \\lambda_{\\text{clone}}(k_t)$. Thus $C_t \\sim \\text{Binomial}(k_t, p_t)$ with mean $\\mu_c = k_t p_t$ and variance $\\sigma_c^2 = k_t p_t(1-p_t) \\leq \\mu_c$.\n523: \n524: The fourth central moment of a binomial distribution is:\n525: \n526: $$\n527: \\mu_4 = \\mathbb{E}[(C_t - \\mu_c)^4 | k_t] = 3\\sigma_c^4 + \\sigma_c^2(1 - 6p_t(1-p_t))\n528: $$\n529: \n530: Since $0 \\leq p_t \\leq 1$, we have $6p_t(1-p_t) \\leq 3/2$, so $1 - 6p_t(1-p_t) \\geq -1/2$. Therefore:\n531: \n532: $$\n533: \\mu_4 \\leq 3\\sigma_c^4 + \\sigma_c^2 \\leq 3\\mu_c^2 + \\mu_c\n534: $$\n535: \n536: Since $\\mu_c = \\lambda_{\\text{clone}}(k_t) k_t \\leq \\lambda_{\\max} N$, this gives:\n537: \n538: $$\n539: \\mu_4 \\leq 3(\\lambda_{\\max} N)^2 + \\lambda_{\\max} N\n540: $$\n541: \n542: where we used $\\sigma_c^2 \\leq \\mu_c$.\n543: \n544: Therefore:\n545: \n546: $$\n547: \\text{Var}(h(C_t) | k_t) \\leq 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{1}{2}(L_g^{(2)})^2 (3(\\lambda_{\\max} N)^2 + \\lambda_{\\max} N)\n548: $$\n549: \n550: $$\n551: = 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{3}{2}(L_g^{(2)})^2 (\\lambda_{\\max} N)^2 + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} N\n552: $$\n553: \n554: **Combined variance bound:**\n555: \n556: Combining the two terms from the law of total variance:\n557: \n558: $$\n559: \\text{Var}(C_t - D_t | k_t) \\leq \\bar{p}_{\\max} N (1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{3}{2}(L_g^{(2)})^2 (\\lambda_{\\max} N)^2 + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} N\n560: $$\n561: \n562: Collecting the $O(N)$ terms:\n563: \n564: $$\n565: = N\\left[\\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}\\right] + \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2\n566: $$\n567: \n568: Define the variance constant and the $O(1)$ remainder:\n569: \n570: $$\n571: C_{\\text{var}} := \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} = O(1)\n572: $$\n573: \n574: $$\n575: C_2 := \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2 = O(1) \\quad \\text{(for density-dependent rates with } L_g^{(2)} = O(N^{-1}))\n576: $$\n577: \n578: Then:\n579: \n580: $$\n581: \\text{Var}(C_t - D_t | k_t) \\leq C_{\\text{var}} N + C_2\n582: $$\n583: \n584: **Step 6c: Bound the Drift Term**\n585: \n586: From Step 5, we have:\n587: \n588: $$\n589: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq \\epsilon |k_t - k_*|\n590: $$\n591: \n592: where $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$.\n593: \n594: **Key requirement:** For contraction, we need $\\epsilon < 1$. Expanding:\n595: \n596: $$\n597: \\epsilon = L_\\lambda N + \\lambda_{\\text{clone}}^* + 2L_p L_\\lambda N^2 + O(N)\n598: $$\n599: \n600: The dominant term is $2L_p L_\\lambda N^2$. Thus, $\\epsilon < 1$ requires:\n601: \n602: $$\n603: L_p L_\\lambda \\ll \\frac{1}{N^2}\n604: $$\n605: \n606: **Physical interpretation:** This condition states that the product of Lipschitz constants must scale as $O(1/N^2)$. This is natural if rates depend on densities $k/N$ rather than absolute counts, giving $L_p, L_\\lambda \\sim O(1/N)$.\n607: \n608: **Step 6d: Final Lyapunov Inequality (with Error Term)**\n609: \n610: From Step 6a:\n611: \n612: $$\n613: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + \\text{Var}(C_t - D_t | k_t)\n614: $$\n615: \n616: From Step 5, we have:\n617: \n618: $$\n619: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq \\epsilon |k_t - k_*| + \\mathcal{E}_{\\max}\n620: $$\n621: \n622: Thus:\n623: \n624: $$\n625: (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 \\leq (\\epsilon |k_t - k_*| + \\mathcal{E}_{\\max})^2 = \\epsilon^2 (k_t - k_*)^2 + 2\\epsilon \\mathcal{E}_{\\max} |k_t - k_*| + \\mathcal{E}_{\\max}^2\n626: $$\n627: \n628: From Step 6b:\n629: \n630: $$\n631: \\text{Var}(C_t - D_t | k_t) \\leq C_{\\text{var}} N + C_2\n632: $$\n633: \n634: Combining:\n635: \n636: $$\n637: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq \\epsilon^2 (k_t - k_*)^2 + 2\\epsilon \\mathcal{E}_{\\max} |k_t - k_*| + \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N + C_2\n638: $$\n639: \n640: **Bounding the cross-term using Young's inequality:**\n641: \n642: We use the general Young's inequality for products: $2ab \\leq \\delta a^2 + (1/\\delta)b^2$ for any $\\delta > 0$.\n643: \n644: The squared drift term is $(A + B)^2$ where $A = \\epsilon |k_t - k_*|$ and $B = \\mathcal{E}_{\\max}$:\n645: \n646: $$\n647: (A + B)^2 = A^2 + 2AB + B^2 \\leq A^2 + \\delta A^2 + \\frac{1}{\\delta}B^2 + B^2 = (1 + \\delta)A^2 + \\left(1 + \\frac{1}{\\delta}\\right)B^2\n648: $$\n649: \n650: Choosing $\\delta = 1/\\epsilon$ (valid since $\\epsilon > 0$):\n651: \n652: $$\n653: (A + B)^2 \\leq \\left(1 + \\frac{1}{\\epsilon}\\right)\\epsilon^2 (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 = (\\epsilon^2 + \\epsilon)(k_t - k_*)^2 + (1 + \\epsilon)\\mathcal{E}_{\\max}^2\n654: $$\n655: \n656: Combining all terms:\n657: \n658: $$\n659: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (\\epsilon^2 + \\epsilon) (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N + C_2\n660: $$\n661: \n662: **Contraction condition:** For contraction, we require:\n663: \n664: $$\n665: \\epsilon^2 + \\epsilon < 1\n666: $$\n667: \n668: Solving: $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (golden ratio minus 1).\n669: \n670: **Derivation of the contraction rate $\\kappa_{\\text{mass}}$:**\n671: \n672: From the inequality above, we have shown:\n673: \n674: $$\n675: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (\\epsilon^2 + \\epsilon) (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N\n676: $$\n677: \n678: To express this in the standard form of a Lyapunov drift inequality:\n679: \n680: $$\n681: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (1 - 2\\kappa_{\\text{mass}}) (k_t - k_*)^2 + C_{\\text{mass}}\n682: $$\n683: \n684: we require the contraction coefficient to satisfy:\n685: \n686: $$\n687: 1 - 2\\kappa_{\\text{mass}} = \\epsilon^2 + \\epsilon\n688: $$\n689: \n690: Solving for $\\kappa_{\\text{mass}}$:\n691: \n692: $$\n693: 2\\kappa_{\\text{mass}} = 1 - (\\epsilon^2 + \\epsilon) = 1 - \\epsilon(1 + \\epsilon)\n694: $$\n695: \n696: Thus:\n697: \n698: $$\n699: \\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}\n700: $$\n701: \n702: For positivity of $\\kappa_{\\text{mass}}$, we need $\\epsilon^2 + \\epsilon < 1$, which is satisfied when $\\epsilon < \\frac{\\sqrt{5}-1}{2}$.\n703: \n704: The final Lyapunov inequality is:\n705: \n706: $$\n707: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (1 - 2\\kappa_{\\text{mass}}) (k_t - k_*)^2 + C_{\\text{mass}}\n708: $$\n709: \n710: where:\n711: \n712: $$\n713: C_{\\text{mass}} := C_{\\text{var}} N + C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2\n714: $$\n715: \n716: **Scaling of $C_{\\text{mass}}$:** For density-dependent death rates $\\bar{p}_{\\text{kill}}(k') = p(k'/N)$, the second derivative satisfies $L_g^{(2)} = O(N^{-1})$ (as established in the Constants and Assumptions section at the beginning of this proof). Therefore:\n717: \n718: $$\n719: \\mathcal{E}_{\\max} = \\frac{L_g^{(2)} \\lambda_{\\max} N}{2} = O(1), \\quad \\mathcal{E}_{\\max}^2 = O(1)\n720: $$\n721: \n722: From Step 6b, $C_2 = \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2 = O(1)$ as well.\n723: \n724: The constant term is:\n725: \n726: $$\n727: C_{\\text{mass}} = C_{\\text{var}} N + C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 = O(N)\n728: $$\n729: \n730: The $O(N)$ scaling is dominated by the variance term $C_{\\text{var}} N$ from Step 6b, with both $C_2 = O(1)$ and $(1 + \\epsilon) \\mathcal{E}_{\\max}^2 = O(1)$ contributing to the overall constant but not affecting the leading-order scaling.\n731: \n732: We write $C_{\\text{mass}} = C_N \\cdot N$ where:\n733: \n734: $$\n735: C_N := C_{\\text{var}} + \\frac{C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2}{N} = O(1)\n736: $$\n737: \n738: **Step 7: Final Result and Physical Interpretation**\n739: \n740: Taking total expectation:\n741: \n742: $$\n743: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n744: $$\n745: \n746: where:\n747: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n748: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n749: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n750: - $L_\\lambda$ is the Lipschitz constant of the cloning rate $\\lambda_{\\text{clone}}(k)$\n751: - $L_p$ is the Lipschitz constant of the killing rate $\\bar{p}_{\\text{kill}}(k')$\n752: - $L_g^{(2)}$ is the bound on the second derivative of $g(c) = \\bar{p}_{\\text{kill}}(N + c)(N + c)$\n753: - $N$ is the total number of walkers (alive + dead)\n754: \n755: **Assumption for positivity of $\\kappa_{\\text{mass}}$:** We require $\\epsilon^2 + \\epsilon < 1$, which gives $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$. From Step 6c, this requires:\n756: \n757: $$\n758: L_p L_\\lambda = O(N^{-2})\n759: $$\n760: \n761: **Physical plausibility of the assumption:** This condition is natural when birth/death rates depend on **densities** rather than absolute counts. If:\n762: \n763: $$\n764: \\lambda_{\\text{clone}}(k) = \\lambda(\\rho) \\quad \\text{where } \\rho = k/N\n765: $$\n766: \n767: $$\n768: \\bar{p}_{\\text{kill}}(k') = p(\\rho') \\quad \\text{where } \\rho' = k'/N\n769: $$\n770: \n771: Then the Lipschitz constants with respect to $k$ are:\n772: \n773: $$\n774: L_\\lambda = \\frac{1}{N} \\sup_\\rho |\\lambda'(\\rho)|, \\quad L_p = \\frac{1}{N} \\sup_{\\rho'} |p'(\\rho')|\n775: $$\n776: \n777: Thus $L_p L_\\lambda = O(N^{-2})$, and the condition is automatically satisfied for any smooth density-dependent rates.\n778: \n779: **Convergence:** This is the standard drift inequality for squared error, which implies exponential convergence of $\\mathbb{E}[(k_t - k_*)^2]$ to the stationary distribution with $\\mathbb{E}[(k_\\infty - k_*)^2] = O(C_{\\text{mass}}/\\kappa_{\\text{mass}}) = O(N/\\kappa_{\\text{mass}})$.\n780: \n781: This completes the proof of Lemma A."
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}