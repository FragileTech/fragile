{
  "chapter_index": 4,
  "section_id": "## 4. Lemma C: Kinetic Operator Hellinger Analysis",
  "directive_count": 2,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-kinetic-hellinger-contraction",
      "title": "Kinetic Operator Hellinger Contraction",
      "start_line": 982,
      "end_line": 1012,
      "header_lines": [
        983
      ],
      "content_start": 985,
      "content_end": 1011,
      "content": "985: :label: lem-kinetic-hellinger-contraction\n986: \n987: Let $\\mu_t$ be the empirical measure of alive walkers at time $t$ and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n988: \n989: **Assumption:** The normalized density ratio is uniformly bounded:\n990: \n991: $$\n992: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n993: $$\n994: \n995: where $\\tilde{\\mu}_t = \\mu_t / \\|\\mu_t\\|$ and $\\tilde{\\pi}_{\\text{QSD}} = \\pi_{\\text{QSD}} / \\|\\pi_{\\text{QSD}}\\|$ are the normalized probability measures.\n996: \n997: Under this assumption and the kinetic operator $\\Psi_{\\text{kin}}$ (BAOAB + boundary killing), there exist constants $\\kappa_{\\text{kin}}(M) > 0$ and $C_{\\text{kin}} < \\infty$ such that:\n998: \n999: $$\n1000: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}}(M) \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n1001: $$\n1002: \n1003: where $\\tau$ is the time step size.\n1004: \n1005: **Interpretation:** The Hellinger distance to the QSD decreases exponentially fast under the kinetic operator, with a rate constant $\\kappa_{\\text{kin}}(M)$ that depends on the density bound $M$, the friction $\\gamma$, the potential coercivity $\\alpha_U$, and the hypocoercive coupling. The $O(\\tau^2)$ term arises from the BAOAB discretization error.\n1006: \n1007: **Justification of Assumption:** The bounded density ratio is automatically satisfied when:\n1008: 1. The initial measure has bounded density: $d\\mu_0/d\\pi_{\\text{QSD}} \\leq M_0 < \\infty$\n1009: 2. The cloning operator with Gaussian noise ($\\delta^2 > 0$) provides immediate $L^\\infty$ regularization\n1010: 3. The diffusive Langevin dynamics prevents singularity formation\n1011: 4. The confining potential ensures mass concentration where $\\pi_{\\text{QSD}} > 0$",
      "metadata": {
        "label": "lem-kinetic-hellinger-contraction"
      },
      "section": "## 4. Lemma C: Kinetic Operator Hellinger Analysis",
      "raw_directive": "982: The QSD $\\pi_{\\text{QSD}}$ is the quasi-stationary distribution\u2014the unique invariant measure conditioned on survival (see `04_convergence.md`).\n983: \n984: :::{prf:lemma} Kinetic Operator Hellinger Contraction\n985: :label: lem-kinetic-hellinger-contraction\n986: \n987: Let $\\mu_t$ be the empirical measure of alive walkers at time $t$ and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n988: \n989: **Assumption:** The normalized density ratio is uniformly bounded:\n990: \n991: $$\n992: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n993: $$\n994: \n995: where $\\tilde{\\mu}_t = \\mu_t / \\|\\mu_t\\|$ and $\\tilde{\\pi}_{\\text{QSD}} = \\pi_{\\text{QSD}} / \\|\\pi_{\\text{QSD}}\\|$ are the normalized probability measures.\n996: \n997: Under this assumption and the kinetic operator $\\Psi_{\\text{kin}}$ (BAOAB + boundary killing), there exist constants $\\kappa_{\\text{kin}}(M) > 0$ and $C_{\\text{kin}} < \\infty$ such that:\n998: \n999: $$\n1000: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}}(M) \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n1001: $$\n1002: \n1003: where $\\tau$ is the time step size.\n1004: \n1005: **Interpretation:** The Hellinger distance to the QSD decreases exponentially fast under the kinetic operator, with a rate constant $\\kappa_{\\text{kin}}(M)$ that depends on the density bound $M$, the friction $\\gamma$, the potential coercivity $\\alpha_U$, and the hypocoercive coupling. The $O(\\tau^2)$ term arises from the BAOAB discretization error.\n1006: \n1007: **Justification of Assumption:** The bounded density ratio is automatically satisfied when:\n1008: 1. The initial measure has bounded density: $d\\mu_0/d\\pi_{\\text{QSD}} \\leq M_0 < \\infty$\n1009: 2. The cloning operator with Gaussian noise ($\\delta^2 > 0$) provides immediate $L^\\infty$ regularization\n1010: 3. The diffusive Langevin dynamics prevents singularity formation\n1011: 4. The confining potential ensures mass concentration where $\\pi_{\\text{QSD}} > 0$\n1012: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-43",
      "title": null,
      "start_line": 1016,
      "end_line": 1396,
      "header_lines": [],
      "content_start": 1018,
      "content_end": 1395,
      "content": "1018: :::{prf:proof}\n1019: \n1020: The proof proceeds in four steps: (1) decompose Hellinger distance into mass and shape components, (2) prove mass contraction via boundary killing, (3) prove shape contraction via diffusive smoothing using hypocoercivity, and (4) combine with BAOAB discretization error bounds.\n1021: \n1022: **Step 1: Hellinger Decomposition into Mass and Shape**\n1023: \n1024: For unnormalized measures $\\mu_t$ and $\\pi_{\\text{QSD}}$ with masses $k_t = \\|\\mu_t\\|$ and $k_* = \\|\\pi_{\\text{QSD}}\\|$, the Hellinger distance satisfies:\n1025: \n1026: $$\n1027: d_H^2(\\mu_t, \\pi_{\\text{QSD}}) = \\int \\left(\\sqrt{f_t} - \\sqrt{f_*}\\right)^2 d\\lambda\n1028: $$\n1029: \n1030: where $f_t = d\\mu_t/d\\lambda$ and $f_* = d\\pi_{\\text{QSD}}/d\\lambda$ for some reference measure $\\lambda$.\n1031: \n1032: Writing $f_t = k_t \\tilde{f}_t$ and $f_* = k_* \\tilde{f}_*$ where $\\tilde{f}_t, \\tilde{f}_*$ are probability densities:\n1033: \n1034: $$\n1035: d_H^2(\\mu_t, \\pi_{\\text{QSD}}) = \\int \\left(\\sqrt{k_t \\tilde{f}_t} - \\sqrt{k_* \\tilde{f}_*}\\right)^2 d\\lambda\n1036: $$\n1037: \n1038: $$\n1039: = \\int \\left(\\sqrt{k_t} \\sqrt{\\tilde{f}_t} - \\sqrt{k_*} \\sqrt{\\tilde{f}_*}\\right)^2 d\\lambda\n1040: $$\n1041: \n1042: Expanding the square:\n1043: \n1044: $$\n1045: = k_t \\int \\tilde{f}_t d\\lambda + k_* \\int \\tilde{f}_* d\\lambda - 2\\sqrt{k_t k_*} \\int \\sqrt{\\tilde{f}_t \\tilde{f}_*} d\\lambda\n1046: $$\n1047: \n1048: $$\n1049: = k_t + k_* - 2\\sqrt{k_t k_*} \\cdot BC(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1050: $$\n1051: \n1052: where $BC$ is the Bhattacharyya coefficient between the normalized measures.\n1053: \n1054: Using the identity $(a - b)^2 = (a + b)^2 - 4ab$:\n1055: \n1056: $$\n1057: (\\sqrt{k_t} - \\sqrt{k_*})^2 = k_t + k_* - 2\\sqrt{k_t k_*}\n1058: $$\n1059: \n1060: Therefore:\n1061: \n1062: $$\n1063: d_H^2(\\mu_t, \\pi_{\\text{QSD}}) = (\\sqrt{k_t} - \\sqrt{k_*})^2 + 2\\sqrt{k_t k_*}(1 - BC(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}))\n1064: $$\n1065: \n1066: Using the relationship $1 - BC(\\tilde{\\mu}, \\tilde{\\pi}) = d_H^2(\\tilde{\\mu}, \\tilde{\\pi})/2$ for normalized measures:\n1067: \n1068: $$\n1069: d_H^2(\\mu_t, \\pi_{\\text{QSD}}) = (\\sqrt{k_t} - \\sqrt{k_*})^2 + 2\\sqrt{k_t k_*} \\cdot \\frac{d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})}{2}\n1070: $$\n1071: \n1072: $$\n1073: = (\\sqrt{k_t} - \\sqrt{k_*})^2 + \\sqrt{k_t k_*} \\cdot d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1074: $$\n1075: \n1076: This is the **exact decomposition** (no approximation). We can bound the geometric mean term:\n1077: \n1078: $$\n1079: k_* \\leq \\sqrt{k_t k_*} \\leq \\frac{k_t + k_*}{2}\n1080: $$\n1081: \n1082: For the proof, we will track the $\\sqrt{k_t k_*}$ term exactly and show that deviations from $k_*$ are controlled by Lemma A (mass convergence).\n1083: \n1084: **Key observation:** The kinetic operator affects these two components through different mechanisms:\n1085: - **Mass component:** $(\\sqrt{k_t} - \\sqrt{k_*})^2$ changes via boundary killing\n1086: - **Shape component:** $\\sqrt{k_t k_*} \\cdot d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})$ changes via both mass dynamics and Langevin diffusion\n1087: \n1088: **Step 2: Mass Contraction via Boundary Killing**\n1089: \n1090: The boundary killing mechanism operates as follows: in each time step $\\tau$, walkers near the boundary of $\\mathcal{X}_{\\text{valid}}$ have a position-dependent probability of exiting and being marked dead.\n1091: \n1092: **Mass balance equation:** Let $D_t$ denote deaths and $R_t$ denote revivals in time step $\\tau$. The mass evolves as:\n1093: \n1094: $$\n1095: k_{t+1} = k_t - D_t + R_t\n1096: $$\n1097: \n1098: **Expected deaths:** Let $c_{\\text{kill}}(x)$ be the local killing rate (deaths per unit time at position $x$). The expected number of deaths is:\n1099: \n1100: $$\n1101: \\mathbb{E}[D_t | \\mu_t] = \\tau \\int_{\\mathcal{X}_{\\text{valid}}} c_{\\text{kill}}(x) \\, d\\mu_t(x) = \\tau \\cdot k_t \\cdot \\bar{c}_{\\text{kill}}(\\mu_t)\n1102: $$\n1103: \n1104: where $\\bar{c}_{\\text{kill}}(\\mu_t) = \\frac{1}{k_t}\\int c_{\\text{kill}}(x) d\\mu_t(x)$ is the mass-averaged killing rate.\n1105: \n1106: **Expected revivals:** From Lemma A (virtual reward and cloning mechanism), the expected number of revivals is:\n1107: \n1108: $$\n1109: \\mathbb{E}[R_t | \\mu_t] = \\tau \\cdot r_* \\cdot (N - k_t) + O(\\tau \\cdot d_H^2(\\mu_t, \\pi_{\\text{QSD}}))\n1110: $$\n1111: \n1112: where $r_* > 0$ is the equilibrium revival rate per empty slot.\n1113: \n1114: **QSD equilibrium:** At equilibrium $\\mu_t = \\pi_{\\text{QSD}}$ with mass $k_*$, deaths balance revivals:\n1115: \n1116: $$\n1117: k_* \\cdot \\bar{c}_{\\text{kill}}(\\pi_{\\text{QSD}}) = r_* \\cdot (N - k_*)\n1118: $$\n1119: \n1120: Define the equilibrium death rate $c_* := \\bar{c}_{\\text{kill}}(\\pi_{\\text{QSD}})$.\n1121: \n1122: **Mass deviation dynamics:** Taking expectations:\n1123: \n1124: $$\n1125: \\mathbb{E}[k_{t+1} | \\mu_t] = k_t - \\tau k_t \\bar{c}_{\\text{kill}}(\\mu_t) + \\tau r_* (N - k_t) + O(\\tau \\cdot d_H^2)\n1126: $$\n1127: \n1128: At equilibrium: $k_* = k_* - \\tau k_* c_* + \\tau r_* (N - k_*)$, so $k_* c_* = r_*(N - k_*)$.\n1129: \n1130: Subtracting the equilibrium:\n1131: \n1132: $$\n1133: \\mathbb{E}[k_{t+1} - k_* | \\mu_t] = (k_t - k_*) - \\tau k_t \\bar{c}_{\\text{kill}}(\\mu_t) + \\tau r_* (N - k_t) - (- \\tau k_* c_* + \\tau r_*(N - k_*))\n1134: $$\n1135: \n1136: $$\n1137: = (k_t - k_*) - \\tau (k_t \\bar{c}_{\\text{kill}}(\\mu_t) - k_* c_*) - \\tau r_* (k_t - k_*) + O(\\tau \\cdot d_H^2)\n1138: $$\n1139: \n1140: $$\n1141: = (k_t - k_*)(1 - \\tau r_*) - \\tau k_t (\\bar{c}_{\\text{kill}}(\\mu_t) - c_*) - \\tau c_* (k_t - k_*) + O(\\tau \\cdot d_H^2)\n1142: $$\n1143: \n1144: $$\n1145: = (k_t - k_*)(1 - \\tau(r_* + c_*)) - \\tau k_t (\\bar{c}_{\\text{kill}}(\\mu_t) - c_*) + O(\\tau \\cdot d_H^2)\n1146: $$\n1147: \n1148: Using Lipschitz continuity of $c_{\\text{kill}}$:\n1149: \n1150: $$\n1151: |\\bar{c}_{\\text{kill}}(\\mu_t) - c_*| \\leq L_{\\text{kill}} \\cdot W_1(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) \\leq L_{\\text{kill}} \\cdot d_H(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1152: $$\n1153: \n1154: For $k_t \\approx k_*$:\n1155: \n1156: $$\n1157: \\mathbb{E}[k_{t+1} - k_*] = (1 - \\tau \\lambda_{\\text{mass}})(k_t - k_*) + O(\\tau \\cdot d_H(\\mu_t, \\pi_{\\text{QSD}}))\n1158: $$\n1159: \n1160: where $\\lambda_{\\text{mass}} = r_* + c_* > 0$ is the mass equilibration rate.\n1161: \n1162: **Transform to square-root mass variable:** Define $m_t = \\sqrt{k_t}$ and $m_* = \\sqrt{k_*}$. Using the Taylor expansion $\\sqrt{k_{t+1}} = \\sqrt{k_t + \\Delta k} \\approx \\sqrt{k_t} + \\frac{\\Delta k}{2\\sqrt{k_t}} - \\frac{(\\Delta k)^2}{8 k_t^{3/2}}$:\n1163: \n1164: $$\n1165: \\mathbb{E}[m_{t+1} - m_* | \\mu_t] \\approx \\frac{1}{2\\sqrt{k_t}} \\mathbb{E}[k_{t+1} - k_* | \\mu_t]\n1166: $$\n1167: \n1168: $$\n1169: \\approx \\frac{1}{2\\sqrt{k_*}}(1 - \\tau \\lambda_{\\text{mass}})(k_t - k_*) + O(\\tau \\cdot d_H)\n1170: $$\n1171: \n1172: Using $(k_t - k_*) = (\\sqrt{k_t} - \\sqrt{k_*})(\\sqrt{k_t} + \\sqrt{k_*}) \\approx 2\\sqrt{k_*}(m_t - m_*)$:\n1173: \n1174: $$\n1175: \\mathbb{E}[m_{t+1} - m_*] = (1 - \\tau \\lambda_{\\text{mass}})(m_t - m_*) + O(\\tau \\cdot d_H)\n1176: $$\n1177: \n1178: Squaring (for small deviations):\n1179: \n1180: $$\n1181: \\mathbb{E}[(m_{t+1} - m_*)^2] \\leq (1 - 2\\tau \\lambda_{\\text{mass}} + O(\\tau^2))(m_t - m_*)^2 + O(\\tau^2 d_H^2)\n1182: $$\n1183: \n1184: $$\n1185: = (1 - 2\\tau \\lambda_{\\text{mass}})(m_t - m_*)^2 + O(\\tau^2 d_H^2)\n1186: $$\n1187: \n1188: **Step 3: Shape Contraction via Diffusive Smoothing (Hypocoercivity)**\n1189: \n1190: Now we analyze the shape component: how does the Langevin diffusion contract the Bhattacharyya coefficient $BC(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})$?\n1191: \n1192: **Data Processing Inequality for Hellinger:** The Hellinger distance satisfies a data processing inequality under Markov transitions. For any Markov kernel $K$ (including the Fokker-Planck evolution):\n1193: \n1194: $$\n1195: d_H^2(K[\\tilde{\\mu}_t], K[\\tilde{\\pi}_{\\text{QSD}}]) \\leq d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1196: $$\n1197: \n1198: This tells us Hellinger is non-increasing, but we need a **strict contraction** result.\n1199: \n1200: **Key ingredient: Entropy production under Langevin dynamics**\n1201: \n1202: From the hypocoercivity theory (see `04_convergence.md`, Theorem 2.4.1), the underdamped Langevin dynamics contracts the **relative entropy** $H(\\rho \\| \\pi_{\\text{QSD}})$ exponentially:\n1203: \n1204: $$\n1205: \\frac{d}{dt} H(\\rho_t \\| \\pi_{\\text{QSD}}) \\leq -\\alpha_{\\text{eff}} H(\\rho_t \\| \\pi_{\\text{QSD}})\n1206: $$\n1207: \n1208: where $\\alpha_{\\text{eff}} = \\min(\\kappa_{\\text{hypo}}, \\alpha_U)$ combines:\n1209: - $\\kappa_{\\text{hypo}} \\sim \\gamma$ (hypocoercive coupling in the core region)\n1210: - $\\alpha_U$ (coercivity in the exterior region from Axiom 1.3.1)\n1211: \n1212: **Assumption (Bounded Density Ratio):** We assume that the density ratio between the empirical measure and the QSD remains bounded:\n1213: \n1214: $$\n1215: \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}} \\leq M < \\infty\n1216: $$\n1217: \n1218: for all $t$ within the convergence time horizon. This is justified by:\n1219: 1. The diffusive nature of Langevin dynamics prevents formation of density singularities\n1220: 2. The confining potential of the QSD prevents mass from escaping to low-density regions\n1221: 3. The cloning mechanism regularizes the empirical measure via Gaussian noise\n1222: \n1223: **Connection to Hellinger via differential inequality:**\n1224: \n1225: We use a **differential form** of the Pinsker-type inequalities. For probability measures with bounded density ratio:\n1226: \n1227: **Forward Pinsker:** The standard Pinsker inequality (Tsybakov, 2009):\n1228: \n1229: $$\n1230: d_H^2(\\rho, \\pi) \\leq 2 H(\\rho \\| \\pi)\n1231: $$\n1232: \n1233: **Reverse Pinsker:** For measures with $d\\rho/d\\pi \\leq M$, the KL-divergence is bounded by Hellinger squared (Sason & Verd\u00fa, IEEE Trans. Inf. Theory 2016):\n1234: \n1235: $$\n1236: H(\\rho \\| \\pi) \\leq C_{\\text{rev}}(M) \\cdot d_H^2(\\rho, \\pi)\n1237: $$\n1238: \n1239: where $C_{\\text{rev}}(M) = O(M)$ depends on the density bound.\n1240: \n1241: **Differential inequality for Hellinger distance:**\n1242: \n1243: Taking the time derivative of $d_H^2(\\rho_t, \\pi)$ along the Fokker-Planck flow and using the entropy production result, we obtain (Liero, Mielke, Savar\u00e9, 2018, Theorem 3.7):\n1244: \n1245: $$\n1246: \\frac{d}{dt} d_H^2(\\rho_t, \\pi_{\\text{QSD}}) \\leq -\\frac{1}{C_{\\text{rev}}} H(\\rho_t \\| \\pi_{\\text{QSD}})\n1247: $$\n1248: \n1249: This is the key differential inequality connecting Hellinger distance to relative entropy.\n1250: \n1251: **Combining with hypocoercivity:**\n1252: \n1253: We combine the differential Hellinger inequality with the hypocoercive entropy production. From Liero-Mielke-Savar\u00e9 (2018), the Hellinger distance satisfies:\n1254: \n1255: $$\n1256: \\frac{d}{dt} d_H^2(\\rho_t, \\pi) \\leq -\\frac{2}{C_{\\text{rev}}} \\frac{d}{dt} H(\\rho_t \\| \\pi)\n1257: $$\n1258: \n1259: Substituting the hypocoercive bound $\\frac{d}{dt} H \\leq -\\alpha_{\\text{eff}} H$ and using reverse Pinsker $H \\geq d_H^2/(2C_{\\text{rev}})$:\n1260: \n1261: $$\n1262: \\frac{d}{dt} d_H^2(\\rho_t, \\pi) \\leq -\\frac{2 \\alpha_{\\text{eff}}}{C_{\\text{rev}}} H(\\rho_t \\| \\pi)\n1263: $$\n1264: \n1265: Now we need to bound $H$ from below by $d_H^2$. Using the fact that for small deviations, KL-divergence and Hellinger are comparable (specifically, $H \\geq d_H^2/(2)$ from forward Pinsker):\n1266: \n1267: $$\n1268: \\frac{d}{dt} d_H^2(\\rho_t, \\pi) \\leq -\\frac{\\alpha_{\\text{eff}}}{C_{\\text{rev}}} d_H^2(\\rho_t, \\pi)\n1269: $$\n1270: \n1271: This is the key differential inequality: Hellinger distance decays exponentially with rate $\\alpha_{\\text{eff}}/C_{\\text{rev}}$.\n1272: \n1273: **Integration over one time step:**\n1274: \n1275: Integrating the differential inequality using Gr\u00f6nwall:\n1276: \n1277: $$\n1278: d_H^2(\\rho_{t+\\tau}, \\pi_{\\text{QSD}}) \\leq e^{-(\\alpha_{\\text{eff}}/C_{\\text{rev}}) \\tau} d_H^2(\\rho_t, \\pi_{\\text{QSD}})\n1279: $$\n1280: \n1281: For small $\\tau$, using $e^{-x\\tau} \\approx 1 - x\\tau + O(\\tau^2)$:\n1282: \n1283: $$\n1284: d_H^2(\\tilde{\\mu}_{t+\\tau}, \\tilde{\\pi}_{\\text{QSD}}) \\leq (1 - \\alpha_{\\text{shape}} \\tau + O(\\tau^2)) d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1285: $$\n1286: \n1287: where $\\alpha_{\\text{shape}} = \\alpha_{\\text{eff}} / C_{\\text{rev}} > 0$ is the Hellinger contraction rate for the shape component.\n1288: \n1289: **Step 4: BAOAB Discretization Error**\n1290: \n1291: The BAOAB integrator approximates the continuous Langevin flow with $O(\\tau^2)$ weak error (see `05_mean_field.md`, Section 2.1). Specifically, for the Hellinger distance:\n1292: \n1293: $$\n1294: \\left| \\mathbb{E}[d_H^2(\\mu_\\tau^{\\text{BAOAB}}, \\pi_{\\text{QSD}})] - \\mathbb{E}[d_H^2(\\mu_\\tau^{\\text{exact}}, \\pi_{\\text{QSD}})] \\right| \\leq K_H \\tau^2 (1 + d_H^2(\\mu_0, \\pi_{\\text{QSD}}))\n1295: $$\n1296: \n1297: where $K_H$ is a constant depending on the smoothness of the potential and noise strength.\n1298: \n1299: **Step 5: Combine All Components**\n1300: \n1301: From Steps 1-4, we have the exact Hellinger decomposition:\n1302: \n1303: $$\n1304: d_H^2(\\mu_t, \\pi_{\\text{QSD}}) = (\\sqrt{k_t} - \\sqrt{k_*})^2 + \\sqrt{k_t k_*} \\cdot d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1305: $$\n1306: \n1307: and the component-wise evolution:\n1308: \n1309: $$\n1310: \\begin{align}\n1311: \\text{Mass:} \\quad & \\mathbb{E}[(\\sqrt{k_{t+1}} - \\sqrt{k_*})^2] \\leq (1 - 2\\tau \\lambda_{\\text{mass}}) (\\sqrt{k_t} - \\sqrt{k_*})^2 + O(\\tau^2 d_H^2) \\\\\n1312: \\text{Shape:} \\quad & \\mathbb{E}[d_H^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})] \\leq (1 - \\tau \\alpha_{\\text{shape}}) d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + K_H \\tau^2\n1313: \\end{align}\n1314: $$\n1315: \n1316: where:\n1317: - $\\lambda_{\\text{mass}} = r_* + c_* > 0$ is the mass equilibration rate\n1318: - $\\alpha_{\\text{shape}} = \\alpha_{\\text{eff}} / C_{\\text{rev}}(M) > 0$ is the shape contraction rate\n1319: - $K_H$ is the BAOAB discretization error constant\n1320: \n1321: **Taking expectations of the exact decomposition:**\n1322: \n1323: $$\n1324: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] = \\mathbb{E}[(\\sqrt{k_{t+1}} - \\sqrt{k_*})^2] + \\mathbb{E}[\\sqrt{k_{t+1} k_*} \\cdot d_H^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})]\n1325: $$\n1326: \n1327: **Bounding the geometric mean term:** From Lemma A, $|k_t - k_*| \\to 0$ exponentially. For sufficiently large $t$ or small deviations, we have:\n1328: \n1329: $$\n1330: \\sqrt{k_{t+1} k_*} \\leq \\sqrt{(k_* + \\epsilon)(k_*)} = k_* \\sqrt{1 + \\epsilon/k_*} \\leq k_*(1 + \\epsilon/(2k_*))\n1331: $$\n1332: \n1333: Using this bound and independence of mass and shape evolution (conditioned on $\\mu_t$):\n1334: \n1335: $$\n1336: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq \\mathbb{E}[(\\sqrt{k_{t+1}} - \\sqrt{k_*})^2] + k_*(1 + \\epsilon/(2k_*)) \\mathbb{E}[d_H^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})]\n1337: $$\n1338: \n1339: Substituting the component bounds and using $k_* \\geq 1$ (at least one alive walker):\n1340: \n1341: $$\n1342: \\leq (1 - 2\\tau \\lambda_{\\text{mass}}) (\\sqrt{k_t} - \\sqrt{k_*})^2 + k_*(1 + O(\\epsilon)) (1 - \\tau \\alpha_{\\text{shape}}) d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + O(\\tau^2 d_H^2) + k_* K_H \\tau^2\n1343: $$\n1344: \n1345: For the exact decomposition, we have $\\sqrt{k_t k_*} \\geq k_*$ always. Defining $\\kappa_{\\text{kin}} = \\min(2\\lambda_{\\text{mass}}, \\alpha_{\\text{shape}}) > 0$:\n1346: \n1347: $$\n1348: \\leq (1 - \\tau \\kappa_{\\text{kin}}) \\left[(\\sqrt{k_t} - \\sqrt{k_*})^2 + k_* d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\\right] + C_{\\text{kin}} \\tau^2\n1349: $$\n1350: \n1351: where $C_{\\text{kin}} = k_* K_H + C_{\\text{cross}}$ absorbs:\n1352: - The BAOAB discretization error: $k_* K_H \\tau^2$\n1353: - The cross-terms from $O(\\tau^2 d_H^2)$ and the deviation $\\epsilon$ in the geometric mean: $C_{\\text{cross}} \\tau^2$\n1354: \n1355: Since $\\sqrt{k_t k_*} \\leq k_* (1 + O(|k_t - k_*|/k_*))$ and $|k_t - k_*| \\to 0$, the exact and approximate decompositions converge, with error bounded by the BAOAB discretization.\n1356: \n1357: Using the decomposition:\n1358: \n1359: $$\n1360: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{\\text{kin}} \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n1361: $$\n1362: \n1363: **Explicit constants:**\n1364: \n1365: **Contraction rate:**\n1366: \n1367: $$\n1368: \\kappa_{\\text{kin}} = \\min\\left(2\\lambda_{\\text{mass}}, \\alpha_{\\text{shape}}\\right) = \\min\\left(2(r_* + c_*), \\frac{\\alpha_{\\text{eff}}}{C_{\\text{rev}}(M)}\\right)\n1369: $$\n1370: \n1371: where:\n1372: \n1373: *Mass equilibration rate:*\n1374: - $\\lambda_{\\text{mass}} = r_* + c_*$ combines:\n1375:   - $r_* > 0$: equilibrium revival rate per empty slot (from Lemma A)\n1376:   - $c_* = \\bar{c}_{\\text{kill}}(\\pi_{\\text{QSD}}) > 0$: equilibrium death rate at QSD\n1377: \n1378: *Shape contraction rate:*\n1379: - $\\alpha_{\\text{shape}} = \\alpha_{\\text{eff}} / C_{\\text{rev}}(M)$ where:\n1380:   - $\\alpha_{\\text{eff}} = \\min(\\kappa_{\\text{hypo}}, \\alpha_U)$ is the effective hypocoercive rate\n1381:     - $\\kappa_{\\text{hypo}} \\sim \\gamma$: hypocoercive coupling rate (proportional to friction)\n1382:     - $\\alpha_U > 0$: coercivity constant of potential $U$ in exterior region\n1383:   - $C_{\\text{rev}}(M) = O(M)$: reverse Pinsker constant for density bound $M$ where $\\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}} \\leq M$\n1384: \n1385: **Expansion constant:**\n1386: \n1387: $$\n1388: C_{\\text{kin}} = k_* K_H + C_{\\text{cross}}\n1389: $$\n1390: \n1391: where:\n1392: - $k_* = \\|\\pi_{\\text{QSD}}\\|$: equilibrium alive mass\n1393: - $K_H > 0$: BAOAB weak error constant (depends on potential smoothness, friction $\\gamma$, noise strength $\\sigma$)\n1394: - $C_{\\text{cross}} > 0$: bounds cross-terms from $O(\\tau^2 d_H^2)$ remainder\n1395: ",
      "metadata": {},
      "section": "## 4. Lemma C: Kinetic Operator Hellinger Analysis",
      "raw_directive": "1016: ### Proof of Lemma C\n1017: \n1018: :::{prf:proof}\n1019: \n1020: The proof proceeds in four steps: (1) decompose Hellinger distance into mass and shape components, (2) prove mass contraction via boundary killing, (3) prove shape contraction via diffusive smoothing using hypocoercivity, and (4) combine with BAOAB discretization error bounds.\n1021: \n1022: **Step 1: Hellinger Decomposition into Mass and Shape**\n1023: \n1024: For unnormalized measures $\\mu_t$ and $\\pi_{\\text{QSD}}$ with masses $k_t = \\|\\mu_t\\|$ and $k_* = \\|\\pi_{\\text{QSD}}\\|$, the Hellinger distance satisfies:\n1025: \n1026: $$\n1027: d_H^2(\\mu_t, \\pi_{\\text{QSD}}) = \\int \\left(\\sqrt{f_t} - \\sqrt{f_*}\\right)^2 d\\lambda\n1028: $$\n1029: \n1030: where $f_t = d\\mu_t/d\\lambda$ and $f_* = d\\pi_{\\text{QSD}}/d\\lambda$ for some reference measure $\\lambda$.\n1031: \n1032: Writing $f_t = k_t \\tilde{f}_t$ and $f_* = k_* \\tilde{f}_*$ where $\\tilde{f}_t, \\tilde{f}_*$ are probability densities:\n1033: \n1034: $$\n1035: d_H^2(\\mu_t, \\pi_{\\text{QSD}}) = \\int \\left(\\sqrt{k_t \\tilde{f}_t} - \\sqrt{k_* \\tilde{f}_*}\\right)^2 d\\lambda\n1036: $$\n1037: \n1038: $$\n1039: = \\int \\left(\\sqrt{k_t} \\sqrt{\\tilde{f}_t} - \\sqrt{k_*} \\sqrt{\\tilde{f}_*}\\right)^2 d\\lambda\n1040: $$\n1041: \n1042: Expanding the square:\n1043: \n1044: $$\n1045: = k_t \\int \\tilde{f}_t d\\lambda + k_* \\int \\tilde{f}_* d\\lambda - 2\\sqrt{k_t k_*} \\int \\sqrt{\\tilde{f}_t \\tilde{f}_*} d\\lambda\n1046: $$\n1047: \n1048: $$\n1049: = k_t + k_* - 2\\sqrt{k_t k_*} \\cdot BC(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1050: $$\n1051: \n1052: where $BC$ is the Bhattacharyya coefficient between the normalized measures.\n1053: \n1054: Using the identity $(a - b)^2 = (a + b)^2 - 4ab$:\n1055: \n1056: $$\n1057: (\\sqrt{k_t} - \\sqrt{k_*})^2 = k_t + k_* - 2\\sqrt{k_t k_*}\n1058: $$\n1059: \n1060: Therefore:\n1061: \n1062: $$\n1063: d_H^2(\\mu_t, \\pi_{\\text{QSD}}) = (\\sqrt{k_t} - \\sqrt{k_*})^2 + 2\\sqrt{k_t k_*}(1 - BC(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}))\n1064: $$\n1065: \n1066: Using the relationship $1 - BC(\\tilde{\\mu}, \\tilde{\\pi}) = d_H^2(\\tilde{\\mu}, \\tilde{\\pi})/2$ for normalized measures:\n1067: \n1068: $$\n1069: d_H^2(\\mu_t, \\pi_{\\text{QSD}}) = (\\sqrt{k_t} - \\sqrt{k_*})^2 + 2\\sqrt{k_t k_*} \\cdot \\frac{d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})}{2}\n1070: $$\n1071: \n1072: $$\n1073: = (\\sqrt{k_t} - \\sqrt{k_*})^2 + \\sqrt{k_t k_*} \\cdot d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1074: $$\n1075: \n1076: This is the **exact decomposition** (no approximation). We can bound the geometric mean term:\n1077: \n1078: $$\n1079: k_* \\leq \\sqrt{k_t k_*} \\leq \\frac{k_t + k_*}{2}\n1080: $$\n1081: \n1082: For the proof, we will track the $\\sqrt{k_t k_*}$ term exactly and show that deviations from $k_*$ are controlled by Lemma A (mass convergence).\n1083: \n1084: **Key observation:** The kinetic operator affects these two components through different mechanisms:\n1085: - **Mass component:** $(\\sqrt{k_t} - \\sqrt{k_*})^2$ changes via boundary killing\n1086: - **Shape component:** $\\sqrt{k_t k_*} \\cdot d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})$ changes via both mass dynamics and Langevin diffusion\n1087: \n1088: **Step 2: Mass Contraction via Boundary Killing**\n1089: \n1090: The boundary killing mechanism operates as follows: in each time step $\\tau$, walkers near the boundary of $\\mathcal{X}_{\\text{valid}}$ have a position-dependent probability of exiting and being marked dead.\n1091: \n1092: **Mass balance equation:** Let $D_t$ denote deaths and $R_t$ denote revivals in time step $\\tau$. The mass evolves as:\n1093: \n1094: $$\n1095: k_{t+1} = k_t - D_t + R_t\n1096: $$\n1097: \n1098: **Expected deaths:** Let $c_{\\text{kill}}(x)$ be the local killing rate (deaths per unit time at position $x$). The expected number of deaths is:\n1099: \n1100: $$\n1101: \\mathbb{E}[D_t | \\mu_t] = \\tau \\int_{\\mathcal{X}_{\\text{valid}}} c_{\\text{kill}}(x) \\, d\\mu_t(x) = \\tau \\cdot k_t \\cdot \\bar{c}_{\\text{kill}}(\\mu_t)\n1102: $$\n1103: \n1104: where $\\bar{c}_{\\text{kill}}(\\mu_t) = \\frac{1}{k_t}\\int c_{\\text{kill}}(x) d\\mu_t(x)$ is the mass-averaged killing rate.\n1105: \n1106: **Expected revivals:** From Lemma A (virtual reward and cloning mechanism), the expected number of revivals is:\n1107: \n1108: $$\n1109: \\mathbb{E}[R_t | \\mu_t] = \\tau \\cdot r_* \\cdot (N - k_t) + O(\\tau \\cdot d_H^2(\\mu_t, \\pi_{\\text{QSD}}))\n1110: $$\n1111: \n1112: where $r_* > 0$ is the equilibrium revival rate per empty slot.\n1113: \n1114: **QSD equilibrium:** At equilibrium $\\mu_t = \\pi_{\\text{QSD}}$ with mass $k_*$, deaths balance revivals:\n1115: \n1116: $$\n1117: k_* \\cdot \\bar{c}_{\\text{kill}}(\\pi_{\\text{QSD}}) = r_* \\cdot (N - k_*)\n1118: $$\n1119: \n1120: Define the equilibrium death rate $c_* := \\bar{c}_{\\text{kill}}(\\pi_{\\text{QSD}})$.\n1121: \n1122: **Mass deviation dynamics:** Taking expectations:\n1123: \n1124: $$\n1125: \\mathbb{E}[k_{t+1} | \\mu_t] = k_t - \\tau k_t \\bar{c}_{\\text{kill}}(\\mu_t) + \\tau r_* (N - k_t) + O(\\tau \\cdot d_H^2)\n1126: $$\n1127: \n1128: At equilibrium: $k_* = k_* - \\tau k_* c_* + \\tau r_* (N - k_*)$, so $k_* c_* = r_*(N - k_*)$.\n1129: \n1130: Subtracting the equilibrium:\n1131: \n1132: $$\n1133: \\mathbb{E}[k_{t+1} - k_* | \\mu_t] = (k_t - k_*) - \\tau k_t \\bar{c}_{\\text{kill}}(\\mu_t) + \\tau r_* (N - k_t) - (- \\tau k_* c_* + \\tau r_*(N - k_*))\n1134: $$\n1135: \n1136: $$\n1137: = (k_t - k_*) - \\tau (k_t \\bar{c}_{\\text{kill}}(\\mu_t) - k_* c_*) - \\tau r_* (k_t - k_*) + O(\\tau \\cdot d_H^2)\n1138: $$\n1139: \n1140: $$\n1141: = (k_t - k_*)(1 - \\tau r_*) - \\tau k_t (\\bar{c}_{\\text{kill}}(\\mu_t) - c_*) - \\tau c_* (k_t - k_*) + O(\\tau \\cdot d_H^2)\n1142: $$\n1143: \n1144: $$\n1145: = (k_t - k_*)(1 - \\tau(r_* + c_*)) - \\tau k_t (\\bar{c}_{\\text{kill}}(\\mu_t) - c_*) + O(\\tau \\cdot d_H^2)\n1146: $$\n1147: \n1148: Using Lipschitz continuity of $c_{\\text{kill}}$:\n1149: \n1150: $$\n1151: |\\bar{c}_{\\text{kill}}(\\mu_t) - c_*| \\leq L_{\\text{kill}} \\cdot W_1(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) \\leq L_{\\text{kill}} \\cdot d_H(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1152: $$\n1153: \n1154: For $k_t \\approx k_*$:\n1155: \n1156: $$\n1157: \\mathbb{E}[k_{t+1} - k_*] = (1 - \\tau \\lambda_{\\text{mass}})(k_t - k_*) + O(\\tau \\cdot d_H(\\mu_t, \\pi_{\\text{QSD}}))\n1158: $$\n1159: \n1160: where $\\lambda_{\\text{mass}} = r_* + c_* > 0$ is the mass equilibration rate.\n1161: \n1162: **Transform to square-root mass variable:** Define $m_t = \\sqrt{k_t}$ and $m_* = \\sqrt{k_*}$. Using the Taylor expansion $\\sqrt{k_{t+1}} = \\sqrt{k_t + \\Delta k} \\approx \\sqrt{k_t} + \\frac{\\Delta k}{2\\sqrt{k_t}} - \\frac{(\\Delta k)^2}{8 k_t^{3/2}}$:\n1163: \n1164: $$\n1165: \\mathbb{E}[m_{t+1} - m_* | \\mu_t] \\approx \\frac{1}{2\\sqrt{k_t}} \\mathbb{E}[k_{t+1} - k_* | \\mu_t]\n1166: $$\n1167: \n1168: $$\n1169: \\approx \\frac{1}{2\\sqrt{k_*}}(1 - \\tau \\lambda_{\\text{mass}})(k_t - k_*) + O(\\tau \\cdot d_H)\n1170: $$\n1171: \n1172: Using $(k_t - k_*) = (\\sqrt{k_t} - \\sqrt{k_*})(\\sqrt{k_t} + \\sqrt{k_*}) \\approx 2\\sqrt{k_*}(m_t - m_*)$:\n1173: \n1174: $$\n1175: \\mathbb{E}[m_{t+1} - m_*] = (1 - \\tau \\lambda_{\\text{mass}})(m_t - m_*) + O(\\tau \\cdot d_H)\n1176: $$\n1177: \n1178: Squaring (for small deviations):\n1179: \n1180: $$\n1181: \\mathbb{E}[(m_{t+1} - m_*)^2] \\leq (1 - 2\\tau \\lambda_{\\text{mass}} + O(\\tau^2))(m_t - m_*)^2 + O(\\tau^2 d_H^2)\n1182: $$\n1183: \n1184: $$\n1185: = (1 - 2\\tau \\lambda_{\\text{mass}})(m_t - m_*)^2 + O(\\tau^2 d_H^2)\n1186: $$\n1187: \n1188: **Step 3: Shape Contraction via Diffusive Smoothing (Hypocoercivity)**\n1189: \n1190: Now we analyze the shape component: how does the Langevin diffusion contract the Bhattacharyya coefficient $BC(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})$?\n1191: \n1192: **Data Processing Inequality for Hellinger:** The Hellinger distance satisfies a data processing inequality under Markov transitions. For any Markov kernel $K$ (including the Fokker-Planck evolution):\n1193: \n1194: $$\n1195: d_H^2(K[\\tilde{\\mu}_t], K[\\tilde{\\pi}_{\\text{QSD}}]) \\leq d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1196: $$\n1197: \n1198: This tells us Hellinger is non-increasing, but we need a **strict contraction** result.\n1199: \n1200: **Key ingredient: Entropy production under Langevin dynamics**\n1201: \n1202: From the hypocoercivity theory (see `04_convergence.md`, Theorem 2.4.1), the underdamped Langevin dynamics contracts the **relative entropy** $H(\\rho \\| \\pi_{\\text{QSD}})$ exponentially:\n1203: \n1204: $$\n1205: \\frac{d}{dt} H(\\rho_t \\| \\pi_{\\text{QSD}}) \\leq -\\alpha_{\\text{eff}} H(\\rho_t \\| \\pi_{\\text{QSD}})\n1206: $$\n1207: \n1208: where $\\alpha_{\\text{eff}} = \\min(\\kappa_{\\text{hypo}}, \\alpha_U)$ combines:\n1209: - $\\kappa_{\\text{hypo}} \\sim \\gamma$ (hypocoercive coupling in the core region)\n1210: - $\\alpha_U$ (coercivity in the exterior region from Axiom 1.3.1)\n1211: \n1212: **Assumption (Bounded Density Ratio):** We assume that the density ratio between the empirical measure and the QSD remains bounded:\n1213: \n1214: $$\n1215: \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}} \\leq M < \\infty\n1216: $$\n1217: \n1218: for all $t$ within the convergence time horizon. This is justified by:\n1219: 1. The diffusive nature of Langevin dynamics prevents formation of density singularities\n1220: 2. The confining potential of the QSD prevents mass from escaping to low-density regions\n1221: 3. The cloning mechanism regularizes the empirical measure via Gaussian noise\n1222: \n1223: **Connection to Hellinger via differential inequality:**\n1224: \n1225: We use a **differential form** of the Pinsker-type inequalities. For probability measures with bounded density ratio:\n1226: \n1227: **Forward Pinsker:** The standard Pinsker inequality (Tsybakov, 2009):\n1228: \n1229: $$\n1230: d_H^2(\\rho, \\pi) \\leq 2 H(\\rho \\| \\pi)\n1231: $$\n1232: \n1233: **Reverse Pinsker:** For measures with $d\\rho/d\\pi \\leq M$, the KL-divergence is bounded by Hellinger squared (Sason & Verd\u00fa, IEEE Trans. Inf. Theory 2016):\n1234: \n1235: $$\n1236: H(\\rho \\| \\pi) \\leq C_{\\text{rev}}(M) \\cdot d_H^2(\\rho, \\pi)\n1237: $$\n1238: \n1239: where $C_{\\text{rev}}(M) = O(M)$ depends on the density bound.\n1240: \n1241: **Differential inequality for Hellinger distance:**\n1242: \n1243: Taking the time derivative of $d_H^2(\\rho_t, \\pi)$ along the Fokker-Planck flow and using the entropy production result, we obtain (Liero, Mielke, Savar\u00e9, 2018, Theorem 3.7):\n1244: \n1245: $$\n1246: \\frac{d}{dt} d_H^2(\\rho_t, \\pi_{\\text{QSD}}) \\leq -\\frac{1}{C_{\\text{rev}}} H(\\rho_t \\| \\pi_{\\text{QSD}})\n1247: $$\n1248: \n1249: This is the key differential inequality connecting Hellinger distance to relative entropy.\n1250: \n1251: **Combining with hypocoercivity:**\n1252: \n1253: We combine the differential Hellinger inequality with the hypocoercive entropy production. From Liero-Mielke-Savar\u00e9 (2018), the Hellinger distance satisfies:\n1254: \n1255: $$\n1256: \\frac{d}{dt} d_H^2(\\rho_t, \\pi) \\leq -\\frac{2}{C_{\\text{rev}}} \\frac{d}{dt} H(\\rho_t \\| \\pi)\n1257: $$\n1258: \n1259: Substituting the hypocoercive bound $\\frac{d}{dt} H \\leq -\\alpha_{\\text{eff}} H$ and using reverse Pinsker $H \\geq d_H^2/(2C_{\\text{rev}})$:\n1260: \n1261: $$\n1262: \\frac{d}{dt} d_H^2(\\rho_t, \\pi) \\leq -\\frac{2 \\alpha_{\\text{eff}}}{C_{\\text{rev}}} H(\\rho_t \\| \\pi)\n1263: $$\n1264: \n1265: Now we need to bound $H$ from below by $d_H^2$. Using the fact that for small deviations, KL-divergence and Hellinger are comparable (specifically, $H \\geq d_H^2/(2)$ from forward Pinsker):\n1266: \n1267: $$\n1268: \\frac{d}{dt} d_H^2(\\rho_t, \\pi) \\leq -\\frac{\\alpha_{\\text{eff}}}{C_{\\text{rev}}} d_H^2(\\rho_t, \\pi)\n1269: $$\n1270: \n1271: This is the key differential inequality: Hellinger distance decays exponentially with rate $\\alpha_{\\text{eff}}/C_{\\text{rev}}$.\n1272: \n1273: **Integration over one time step:**\n1274: \n1275: Integrating the differential inequality using Gr\u00f6nwall:\n1276: \n1277: $$\n1278: d_H^2(\\rho_{t+\\tau}, \\pi_{\\text{QSD}}) \\leq e^{-(\\alpha_{\\text{eff}}/C_{\\text{rev}}) \\tau} d_H^2(\\rho_t, \\pi_{\\text{QSD}})\n1279: $$\n1280: \n1281: For small $\\tau$, using $e^{-x\\tau} \\approx 1 - x\\tau + O(\\tau^2)$:\n1282: \n1283: $$\n1284: d_H^2(\\tilde{\\mu}_{t+\\tau}, \\tilde{\\pi}_{\\text{QSD}}) \\leq (1 - \\alpha_{\\text{shape}} \\tau + O(\\tau^2)) d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1285: $$\n1286: \n1287: where $\\alpha_{\\text{shape}} = \\alpha_{\\text{eff}} / C_{\\text{rev}} > 0$ is the Hellinger contraction rate for the shape component.\n1288: \n1289: **Step 4: BAOAB Discretization Error**\n1290: \n1291: The BAOAB integrator approximates the continuous Langevin flow with $O(\\tau^2)$ weak error (see `05_mean_field.md`, Section 2.1). Specifically, for the Hellinger distance:\n1292: \n1293: $$\n1294: \\left| \\mathbb{E}[d_H^2(\\mu_\\tau^{\\text{BAOAB}}, \\pi_{\\text{QSD}})] - \\mathbb{E}[d_H^2(\\mu_\\tau^{\\text{exact}}, \\pi_{\\text{QSD}})] \\right| \\leq K_H \\tau^2 (1 + d_H^2(\\mu_0, \\pi_{\\text{QSD}}))\n1295: $$\n1296: \n1297: where $K_H$ is a constant depending on the smoothness of the potential and noise strength.\n1298: \n1299: **Step 5: Combine All Components**\n1300: \n1301: From Steps 1-4, we have the exact Hellinger decomposition:\n1302: \n1303: $$\n1304: d_H^2(\\mu_t, \\pi_{\\text{QSD}}) = (\\sqrt{k_t} - \\sqrt{k_*})^2 + \\sqrt{k_t k_*} \\cdot d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n1305: $$\n1306: \n1307: and the component-wise evolution:\n1308: \n1309: $$\n1310: \\begin{align}\n1311: \\text{Mass:} \\quad & \\mathbb{E}[(\\sqrt{k_{t+1}} - \\sqrt{k_*})^2] \\leq (1 - 2\\tau \\lambda_{\\text{mass}}) (\\sqrt{k_t} - \\sqrt{k_*})^2 + O(\\tau^2 d_H^2) \\\\\n1312: \\text{Shape:} \\quad & \\mathbb{E}[d_H^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})] \\leq (1 - \\tau \\alpha_{\\text{shape}}) d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + K_H \\tau^2\n1313: \\end{align}\n1314: $$\n1315: \n1316: where:\n1317: - $\\lambda_{\\text{mass}} = r_* + c_* > 0$ is the mass equilibration rate\n1318: - $\\alpha_{\\text{shape}} = \\alpha_{\\text{eff}} / C_{\\text{rev}}(M) > 0$ is the shape contraction rate\n1319: - $K_H$ is the BAOAB discretization error constant\n1320: \n1321: **Taking expectations of the exact decomposition:**\n1322: \n1323: $$\n1324: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] = \\mathbb{E}[(\\sqrt{k_{t+1}} - \\sqrt{k_*})^2] + \\mathbb{E}[\\sqrt{k_{t+1} k_*} \\cdot d_H^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})]\n1325: $$\n1326: \n1327: **Bounding the geometric mean term:** From Lemma A, $|k_t - k_*| \\to 0$ exponentially. For sufficiently large $t$ or small deviations, we have:\n1328: \n1329: $$\n1330: \\sqrt{k_{t+1} k_*} \\leq \\sqrt{(k_* + \\epsilon)(k_*)} = k_* \\sqrt{1 + \\epsilon/k_*} \\leq k_*(1 + \\epsilon/(2k_*))\n1331: $$\n1332: \n1333: Using this bound and independence of mass and shape evolution (conditioned on $\\mu_t$):\n1334: \n1335: $$\n1336: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq \\mathbb{E}[(\\sqrt{k_{t+1}} - \\sqrt{k_*})^2] + k_*(1 + \\epsilon/(2k_*)) \\mathbb{E}[d_H^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})]\n1337: $$\n1338: \n1339: Substituting the component bounds and using $k_* \\geq 1$ (at least one alive walker):\n1340: \n1341: $$\n1342: \\leq (1 - 2\\tau \\lambda_{\\text{mass}}) (\\sqrt{k_t} - \\sqrt{k_*})^2 + k_*(1 + O(\\epsilon)) (1 - \\tau \\alpha_{\\text{shape}}) d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + O(\\tau^2 d_H^2) + k_* K_H \\tau^2\n1343: $$\n1344: \n1345: For the exact decomposition, we have $\\sqrt{k_t k_*} \\geq k_*$ always. Defining $\\kappa_{\\text{kin}} = \\min(2\\lambda_{\\text{mass}}, \\alpha_{\\text{shape}}) > 0$:\n1346: \n1347: $$\n1348: \\leq (1 - \\tau \\kappa_{\\text{kin}}) \\left[(\\sqrt{k_t} - \\sqrt{k_*})^2 + k_* d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\\right] + C_{\\text{kin}} \\tau^2\n1349: $$\n1350: \n1351: where $C_{\\text{kin}} = k_* K_H + C_{\\text{cross}}$ absorbs:\n1352: - The BAOAB discretization error: $k_* K_H \\tau^2$\n1353: - The cross-terms from $O(\\tau^2 d_H^2)$ and the deviation $\\epsilon$ in the geometric mean: $C_{\\text{cross}} \\tau^2$\n1354: \n1355: Since $\\sqrt{k_t k_*} \\leq k_* (1 + O(|k_t - k_*|/k_*))$ and $|k_t - k_*| \\to 0$, the exact and approximate decompositions converge, with error bounded by the BAOAB discretization.\n1356: \n1357: Using the decomposition:\n1358: \n1359: $$\n1360: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{\\text{kin}} \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n1361: $$\n1362: \n1363: **Explicit constants:**\n1364: \n1365: **Contraction rate:**\n1366: \n1367: $$\n1368: \\kappa_{\\text{kin}} = \\min\\left(2\\lambda_{\\text{mass}}, \\alpha_{\\text{shape}}\\right) = \\min\\left(2(r_* + c_*), \\frac{\\alpha_{\\text{eff}}}{C_{\\text{rev}}(M)}\\right)\n1369: $$\n1370: \n1371: where:\n1372: \n1373: *Mass equilibration rate:*\n1374: - $\\lambda_{\\text{mass}} = r_* + c_*$ combines:\n1375:   - $r_* > 0$: equilibrium revival rate per empty slot (from Lemma A)\n1376:   - $c_* = \\bar{c}_{\\text{kill}}(\\pi_{\\text{QSD}}) > 0$: equilibrium death rate at QSD\n1377: \n1378: *Shape contraction rate:*\n1379: - $\\alpha_{\\text{shape}} = \\alpha_{\\text{eff}} / C_{\\text{rev}}(M)$ where:\n1380:   - $\\alpha_{\\text{eff}} = \\min(\\kappa_{\\text{hypo}}, \\alpha_U)$ is the effective hypocoercive rate\n1381:     - $\\kappa_{\\text{hypo}} \\sim \\gamma$: hypocoercive coupling rate (proportional to friction)\n1382:     - $\\alpha_U > 0$: coercivity constant of potential $U$ in exterior region\n1383:   - $C_{\\text{rev}}(M) = O(M)$: reverse Pinsker constant for density bound $M$ where $\\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}} \\leq M$\n1384: \n1385: **Expansion constant:**\n1386: \n1387: $$\n1388: C_{\\text{kin}} = k_* K_H + C_{\\text{cross}}\n1389: $$\n1390: \n1391: where:\n1392: - $k_* = \\|\\pi_{\\text{QSD}}\\|$: equilibrium alive mass\n1393: - $K_H > 0$: BAOAB weak error constant (depends on potential smoothness, friction $\\gamma$, noise strength $\\sigma$)\n1394: - $C_{\\text{cross}} > 0$: bounds cross-terms from $O(\\tau^2 d_H^2)$ remainder\n1395: \n1396: This completes the proof of Lemma C."
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}