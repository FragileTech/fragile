{
  "stage": "directives",
  "directive_type": "lemma",
  "generated_at": "2025-11-08T17:16:20.404936+00:00",
  "source_documents": [
    "01_crystalline_gas_yang_mills_mass_gap_proof",
    "01_fragile_gas_framework",
    "01_yang_mills_dynamic_lattice",
    "02_euclidean_gas",
    "03_cloning",
    "04_wasserstein_contraction",
    "04_wasserstein_contraction_ASSEMBLED",
    "05_kinetic_contraction",
    "05_osterwalder_schrader_verification",
    "07_mean_field",
    "08_propagation_chaos",
    "09_kl_convergence",
    "10_qsd_exchangeability_theory",
    "11_geometric_gas",
    "11_geometric_gas",
    "11_hk_convergence",
    "11_hk_convergence_bounded_density_rigorous_proof",
    "11_hk_convergence_original",
    "12_quantitative_error_bounds",
    "13_geometric_gas_c3_regularity",
    "13_geometric_gas_c3_regularity",
    "14_geometric_gas_c4_regularity",
    "14_geometric_gas_cinf_regularity_full",
    "16_convergence_mean_field",
    "16_convergence_mean_field",
    "17_qsd_exchangeability_geometric",
    "18_emergent_geometry",
    "19_geometric_gas_cinf_regularity_simplified",
    "20_geometric_gas_cinf_regularity_full"
  ],
  "document_count": 29,
  "total_count": 311,
  "items": [
    {
      "directive_type": "lemma",
      "label": "lem-cg-velocity-isotropy",
      "title": "Velocity Isotropy of QSD",
      "start_line": 601,
      "end_line": 619,
      "header_lines": [
        602
      ],
      "content_start": 604,
      "content_end": 618,
      "content": "604: :label: lem-cg-velocity-isotropy\n605: \n606: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ ({prf:ref}`thm-cg-invariant-existence`) has **isotropic velocity distribution**. Specifically:\n607: \n608: $$\n609: \\mathbb{E}_{\\pi_{\\text{QSD}}}[v_i] = 0 \\quad \\text{and} \\quad \\mathbb{E}_{\\pi_{\\text{QSD}}}[v_i \\otimes v_i] = \\sigma_v^2 \\, I_d\n610: $$\n611: \n612: for all $i \\in \\{1, \\ldots, N\\}$, where $v_i \\otimes v_i$ denotes the outer product matrix.\n613: \n614: Moreover, the velocity distribution is approximately Maxwellian:\n615: \n616: $$\n617: v_i \\sim \\mathcal{N}(0, \\sigma_v^2 I_d) + O(\\Delta t)\n618: $$",
      "metadata": {
        "label": "lem-cg-velocity-isotropy"
      },
      "section": "## 3. Existence and Uniqueness of the Quasi-Stationary Distribution",
      "raw_directive": "601: We now establish key properties of the invariant measure $\\pi_{\\text{QSD}}$, which will be essential for deriving the gauge theory structure.\n602: \n603: :::{prf:lemma} Velocity Isotropy of QSD\n604: :label: lem-cg-velocity-isotropy\n605: \n606: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ ({prf:ref}`thm-cg-invariant-existence`) has **isotropic velocity distribution**. Specifically:\n607: \n608: $$\n609: \\mathbb{E}_{\\pi_{\\text{QSD}}}[v_i] = 0 \\quad \\text{and} \\quad \\mathbb{E}_{\\pi_{\\text{QSD}}}[v_i \\otimes v_i] = \\sigma_v^2 \\, I_d\n610: $$\n611: \n612: for all $i \\in \\{1, \\ldots, N\\}$, where $v_i \\otimes v_i$ denotes the outer product matrix.\n613: \n614: Moreover, the velocity distribution is approximately Maxwellian:\n615: \n616: $$\n617: v_i \\sim \\mathcal{N}(0, \\sigma_v^2 I_d) + O(\\Delta t)\n618: $$\n619: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_crystalline_gas_yang_mills_mass_gap_proof",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Existence and Uniqueness of the Quasi-Stationary Distribution"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cg-lieb-robinson",
      "title": "Lieb-Robinson Bound for Crystalline Gas",
      "start_line": 2393,
      "end_line": 2415,
      "header_lines": [
        2394
      ],
      "content_start": 2396,
      "content_end": 2414,
      "content": "2396: :label: lem-cg-lieb-robinson\n2397: \n2398: For Crystalline Gas dynamics, observables $\\mathcal{O}_1, \\mathcal{O}_2$ supported on regions $\\Lambda_1, \\Lambda_2$ separated by distance $R$ satisfy:\n2399: \n2400: $$\n2401: \\left| \\langle \\mathcal{O}_1(t) \\mathcal{O}_2(0) \\rangle - \\langle \\mathcal{O}_1(t) \\rangle \\langle \\mathcal{O}_2(0) \\rangle \\right| \\leq C_{\\mathcal{O}} \\|\\mathcal{O}_1\\| \\|\\mathcal{O}_2\\| \\cdot e^{-\\mu(R - v_{\\max} t)}\n2402: $$\n2403: \n2404: where:\n2405: - $v_{\\max} = \\|\\mathbb{E}_{\\pi}[v]\\|_{\\infty} + 3\\sigma_v$ is the maximum velocity (mean + 3 std deviations)\n2406: - $\\mu > 0$ is an effective decay rate\n2407: - $t$ is the time evolution\n2408: \n2409: **Proof Sketch**: Information propagates at finite velocity in the Crystalline Gas:\n2410: 1. Walkers have velocities $v_i \\sim \\mathcal{N}(0, \\sigma_v^2 I_d)$ under $\\pi_{\\text{QSD}}$ (from {prf:ref}`thm-ou-spectral-gap`)\n2411: 2. Position updates: $x_i(t+\\Delta t) = x_i(t) + v_i \\Delta t + O(\\sigma_x \\sqrt{\\Delta t})$\n2412: 3. Maximum propagation speed: $v_{\\max} \\sim \\sigma_v \\sqrt{d}$ (typical velocity magnitude)\n2413: 4. For regions separated by $R$, observables $\\mathcal{O}_1$ and $\\mathcal{O}_2$ are **causally disconnected** for times $t < R/v_{\\max}$\n2414: 5. Beyond the light cone $R > v_{\\max} t$, correlations decay exponentially due to stochastic noise",
      "metadata": {
        "label": "lem-cg-lieb-robinson"
      },
      "section": "## 8. Osterwalder-Schrader Axiom Verification and CMI Criteria",
      "raw_directive": "2393: To connect temporal decay (from the spectral gap) to spatial decay (required by OS4), we use the **velocity-mediated information propagation** in the Crystalline Gas.\n2394: \n2395: :::{prf:lemma} Lieb-Robinson Bound for Crystalline Gas\n2396: :label: lem-cg-lieb-robinson\n2397: \n2398: For Crystalline Gas dynamics, observables $\\mathcal{O}_1, \\mathcal{O}_2$ supported on regions $\\Lambda_1, \\Lambda_2$ separated by distance $R$ satisfy:\n2399: \n2400: $$\n2401: \\left| \\langle \\mathcal{O}_1(t) \\mathcal{O}_2(0) \\rangle - \\langle \\mathcal{O}_1(t) \\rangle \\langle \\mathcal{O}_2(0) \\rangle \\right| \\leq C_{\\mathcal{O}} \\|\\mathcal{O}_1\\| \\|\\mathcal{O}_2\\| \\cdot e^{-\\mu(R - v_{\\max} t)}\n2402: $$\n2403: \n2404: where:\n2405: - $v_{\\max} = \\|\\mathbb{E}_{\\pi}[v]\\|_{\\infty} + 3\\sigma_v$ is the maximum velocity (mean + 3 std deviations)\n2406: - $\\mu > 0$ is an effective decay rate\n2407: - $t$ is the time evolution\n2408: \n2409: **Proof Sketch**: Information propagates at finite velocity in the Crystalline Gas:\n2410: 1. Walkers have velocities $v_i \\sim \\mathcal{N}(0, \\sigma_v^2 I_d)$ under $\\pi_{\\text{QSD}}$ (from {prf:ref}`thm-ou-spectral-gap`)\n2411: 2. Position updates: $x_i(t+\\Delta t) = x_i(t) + v_i \\Delta t + O(\\sigma_x \\sqrt{\\Delta t})$\n2412: 3. Maximum propagation speed: $v_{\\max} \\sim \\sigma_v \\sqrt{d}$ (typical velocity magnitude)\n2413: 4. For regions separated by $R$, observables $\\mathcal{O}_1$ and $\\mathcal{O}_2$ are **causally disconnected** for times $t < R/v_{\\max}$\n2414: 5. Beyond the light cone $R > v_{\\max} t$, correlations decay exponentially due to stochastic noise\n2415: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_crystalline_gas_yang_mills_mass_gap_proof",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 8. Osterwalder-Schrader Axiom Verification and CMI Criteria"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-borel-image-of-the-projected-swarm-space",
      "title": "Borel image of the projected swarm space",
      "start_line": 462,
      "end_line": 471,
      "header_lines": [
        463
      ],
      "content_start": 464,
      "content_end": 470,
      "content": "464: :::{prf:lemma} Borel image of the projected swarm space\n465: :label: lem-borel-image-of-the-projected-swarm-space\n466: Let $(\\mathcal X,d_{\\mathcal X})$ be Polish and $\\varphi:\\mathcal X\\to\\mathcal Y$ continuous. If $\\mathcal X$ is $\\sigma$‑compact and $\\Sigma_N\\subset(\\mathcal X\\times\\{0,1\\})^N$ is Borel, then the projected image\n467: \n468: $$\n469: \\widehat{\\Phi}(\\Sigma_N):=\\{((\\varphi(x_i),s_i))_{i=1}^N : ((x_i,s_i))\\in\\Sigma_N\\}\\subset (\\mathcal Y\\times\\{0,1\\})^N\n470: $$",
      "metadata": {
        "label": "lem-borel-image-of-the-projected-swarm-space"
      },
      "section": "## 2. Global Conventions: Foundational Objects and Core Algorithmic Parameters",
      "raw_directive": "462: #### 1.6.2 Borel image and completion of the working space\n463: \n464: :::{prf:lemma} Borel image of the projected swarm space\n465: :label: lem-borel-image-of-the-projected-swarm-space\n466: Let $(\\mathcal X,d_{\\mathcal X})$ be Polish and $\\varphi:\\mathcal X\\to\\mathcal Y$ continuous. If $\\mathcal X$ is $\\sigma$‑compact and $\\Sigma_N\\subset(\\mathcal X\\times\\{0,1\\})^N$ is Borel, then the projected image\n467: \n468: $$\n469: \\widehat{\\Phi}(\\Sigma_N):=\\{((\\varphi(x_i),s_i))_{i=1}^N : ((x_i,s_i))\\in\\Sigma_N\\}\\subset (\\mathcal Y\\times\\{0,1\\})^N\n470: $$\n471: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Global Conventions: Foundational Objects and Core Algorithmic Parameters"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-polishness-and-w2",
      "title": "Polishness of the quotient state space and $W_2$",
      "start_line": 488,
      "end_line": 492,
      "header_lines": [
        489
      ],
      "content_start": 491,
      "content_end": 491,
      "content": "491: :label: lem-polishness-and-w2",
      "metadata": {
        "label": "lem-polishness-and-w2"
      },
      "section": "## 2. Global Conventions: Foundational Objects and Core Algorithmic Parameters",
      "raw_directive": "488: #### 1.7.1 Polishness and $W_2$ well‑posedness (on the quotient)\n489: \n490: :::{prf:lemma} Polishness of the quotient state space and $W_2$\n491: :label: lem-polishness-and-w2\n492: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Global Conventions: Foundational Objects and Core Algorithmic Parameters"
      }
    },
    {
      "directive_type": "lemma",
      "label": "proof-lem-validation-of-the-heat-kernel",
      "title": "Validation of the Heat Kernel",
      "start_line": 1130,
      "end_line": 1139,
      "header_lines": [
        1131,
        1134
      ],
      "content_start": 1132,
      "content_end": 1138,
      "content": "1132: :label: lem-validation-of-the-heat-kernel\n1133: If the state space $(\\mathcal{X}, d_{\\mathcal{X}}, \\mu)$ is a Polish metric measure space with a canonical heat kernel $p_t(x, \\cdot)$ that has a uniformly bounded second moment, then defining the perturbation noise measure as $\\mathcal{P}_\\sigma(x, \\cdot) := p_{\\sigma^2}(x, \\cdot)$ satisfies the required axioms, provided the boundary of the valid set $\\mathcal{X}_{\\mathrm{valid}}$ is sufficiently regular.\n1134: :::{prf:proof}\n1135: :label: proof-lem-validation-of-the-heat-kernel\n1136: **Proof.**\n1137: 1.  **Axiom of Bounded Second Moment of Perturbation ([](#def-axiom-bounded-second-moment-perturbation)):** The definition of the state space requires that the heat kernel has a uniformly bounded second moment, i.e., $\\sup_{x \\in \\mathcal{X}} \\mathbb{E}_{x' \\sim p_t(x, \\cdot)} [ d_{\\mathcal{Y}}(\\varphi(x'), \\varphi(x))^2 ] \\le M_{\\text{pert}}^2$. This directly satisfies the axiom.\n1138: 2.  **Axiom of Boundary Regularity ([](#axiom-boundary-regularity)):** The death probability is given by the function $P(s_{\\text{out}}=0 | x) = \\int_{\\mathcal{X} \\setminus \\mathcal{X}_{\\mathrm{valid}}} p_{\\sigma^2}(x, dx')$. This is the convolution of the indicator function of the invalid set with the heat kernel. For non-pathological boundaries (e.g., boundaries that are not space-filling curves), the heat kernel is a well-known smoothing operator. Standard results in analysis show that the convolution of a smooth kernel with an indicator function results in a continuous function. For heat kernels specifically, the resulting function $P$ is smooth and therefore locally Hölder continuous. Global Hölder continuity follows on compact subsets of $\\mathcal X$ by a finite subcover argument.",
      "metadata": {
        "label": "proof-lem-validation-of-the-heat-kernel"
      },
      "section": "## 5. Algorithmic Noise Measures",
      "raw_directive": "1130: #### 5.2.1 Lemma: Validation of the Heat Kernel\n1131: :::{prf:lemma} Validation of the Heat Kernel\n1132: :label: lem-validation-of-the-heat-kernel\n1133: If the state space $(\\mathcal{X}, d_{\\mathcal{X}}, \\mu)$ is a Polish metric measure space with a canonical heat kernel $p_t(x, \\cdot)$ that has a uniformly bounded second moment, then defining the perturbation noise measure as $\\mathcal{P}_\\sigma(x, \\cdot) := p_{\\sigma^2}(x, \\cdot)$ satisfies the required axioms, provided the boundary of the valid set $\\mathcal{X}_{\\mathrm{valid}}$ is sufficiently regular.\n1134: :::{prf:proof}\n1135: :label: proof-lem-validation-of-the-heat-kernel\n1136: **Proof.**\n1137: 1.  **Axiom of Bounded Second Moment of Perturbation ([](#def-axiom-bounded-second-moment-perturbation)):** The definition of the state space requires that the heat kernel has a uniformly bounded second moment, i.e., $\\sup_{x \\in \\mathcal{X}} \\mathbb{E}_{x' \\sim p_t(x, \\cdot)} [ d_{\\mathcal{Y}}(\\varphi(x'), \\varphi(x))^2 ] \\le M_{\\text{pert}}^2$. This directly satisfies the axiom.\n1138: 2.  **Axiom of Boundary Regularity ([](#axiom-boundary-regularity)):** The death probability is given by the function $P(s_{\\text{out}}=0 | x) = \\int_{\\mathcal{X} \\setminus \\mathcal{X}_{\\mathrm{valid}}} p_{\\sigma^2}(x, dx')$. This is the convolution of the indicator function of the invalid set with the heat kernel. For non-pathological boundaries (e.g., boundaries that are not space-filling curves), the heat kernel is a well-known smoothing operator. Standard results in analysis show that the convolution of a smooth kernel with an indicator function results in a continuous function. For heat kernels specifically, the resulting function $P$ is smooth and therefore locally Hölder continuous. Global Hölder continuity follows on compact subsets of $\\mathcal X$ by a finite subcover argument.\n1139: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Algorithmic Noise Measures"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-validation-of-the-uniform-ball-measure",
      "title": "Validation of the Uniform Ball Measure",
      "start_line": 1149,
      "end_line": 1157,
      "header_lines": [
        1150
      ],
      "content_start": 1151,
      "content_end": 1156,
      "content": "1151: :label: lem-validation-of-the-uniform-ball-measure\n1152: Let the noise measure $\\mathcal{P}_\\sigma(x, \\cdot)$ be defined as the uniform probability measure over a ball of radius $\\sigma$ centered at $x$ in the state space $\\mathcal{X}$. This measure satisfies the required axioms, provided the boundary of the valid set is sufficiently regular. In particular, the death‑probability map is continuous under mild assumptions; to claim a global Lipschitz modulus with respect to $d_{\\text{Disp},\\mathcal{Y}}$, assume $\\mathcal{X}_{\\mathrm{valid}}$ has Lipschitz boundary or finite perimeter so that boundary layer estimates apply. In that case one obtains an explicit bound of the form\n1153: \n1154: $$\n1155: L_{\\text{death}}\\;\\le\\; \\frac{C_{\\text{perim}}}{\\sigma},\n1156: $$",
      "metadata": {
        "label": "lem-validation-of-the-uniform-ball-measure"
      },
      "section": "## 5. Algorithmic Noise Measures",
      "raw_directive": "1149: #### 5.2.2 Lemma: Validation of the Uniform Ball Measure\n1150: :::{prf:lemma} Validation of the Uniform Ball Measure\n1151: :label: lem-validation-of-the-uniform-ball-measure\n1152: Let the noise measure $\\mathcal{P}_\\sigma(x, \\cdot)$ be defined as the uniform probability measure over a ball of radius $\\sigma$ centered at $x$ in the state space $\\mathcal{X}$. This measure satisfies the required axioms, provided the boundary of the valid set is sufficiently regular. In particular, the death‑probability map is continuous under mild assumptions; to claim a global Lipschitz modulus with respect to $d_{\\text{Disp},\\mathcal{Y}}$, assume $\\mathcal{X}_{\\mathrm{valid}}$ has Lipschitz boundary or finite perimeter so that boundary layer estimates apply. In that case one obtains an explicit bound of the form\n1153: \n1154: $$\n1155: L_{\\text{death}}\\;\\le\\; \\frac{C_{\\text{perim}}}{\\sigma},\n1156: $$\n1157: where $C_{\\text{perim}}$ depends on the perimeter (surface measure) of $\\partial\\mathcal{X}_{\\mathrm{valid}}$ in the algorithmic metric.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Algorithmic Noise Measures"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-boundary-uniform-ball",
      "title": "Uniform‑ball death probability is Lipschitz under finite perimeter",
      "start_line": 1175,
      "end_line": 1190,
      "header_lines": [
        1176
      ],
      "content_start": 1177,
      "content_end": 1189,
      "content": "1177: :label: lem-boundary-uniform-ball\n1178: Let $E=\\mathcal{X}_{\\mathrm{invalid}}\\subset\\mathcal X$ have finite perimeter (BV boundary) and let $\\mathcal P_\\sigma(x,\\cdot)$ be the uniform law on $B(x,\\sigma)$. Define\n1179: $$\n1180: \n1181: P_\\sigma(x)\\;:=\\;\\mathcal P_\\sigma(x, E)\\;=\\;\\frac{1}{\\mathrm{Vol}(B_\\sigma)}\\int \\mathbb 1_E(y)\\,\\mathbb 1_{B_\\sigma}(y-x)\\,\\mathrm dy.\n1182: \n1183: $$\n1184: Then there exists a constant $C_d>0$ depending only on the dimension such that for all $x,y\\in\\mathcal X$,\n1185: $$\n1186: \n1187: |P_\\sigma(x)-P_\\sigma(y)|\\;\\le\\; C_d\\,\\frac{\\mathrm{Per}(E)}{\\sigma}\\, d_{\\mathcal X}(x,y).\n1188: \n1189: $$",
      "metadata": {
        "label": "lem-boundary-uniform-ball"
      },
      "section": "## 5. Algorithmic Noise Measures",
      "raw_directive": "1175: #### 5.2.3 Lemma: BV/perimeter Lipschitz bound for uniform‑ball death probability\n1176: :::{prf:lemma} Uniform‑ball death probability is Lipschitz under finite perimeter\n1177: :label: lem-boundary-uniform-ball\n1178: Let $E=\\mathcal{X}_{\\mathrm{invalid}}\\subset\\mathcal X$ have finite perimeter (BV boundary) and let $\\mathcal P_\\sigma(x,\\cdot)$ be the uniform law on $B(x,\\sigma)$. Define\n1179: $$\n1180: \n1181: P_\\sigma(x)\\;:=\\;\\mathcal P_\\sigma(x, E)\\;=\\;\\frac{1}{\\mathrm{Vol}(B_\\sigma)}\\int \\mathbb 1_E(y)\\,\\mathbb 1_{B_\\sigma}(y-x)\\,\\mathrm dy.\n1182: \n1183: $$\n1184: Then there exists a constant $C_d>0$ depending only on the dimension such that for all $x,y\\in\\mathcal X$,\n1185: $$\n1186: \n1187: |P_\\sigma(x)-P_\\sigma(y)|\\;\\le\\; C_d\\,\\frac{\\mathrm{Per}(E)}{\\sigma}\\, d_{\\mathcal X}(x,y).\n1188: \n1189: $$\n1190: If $\\varphi$ is $L_\\varphi$‑Lipschitz and distances are measured in the algorithmic space, the bound becomes $L_{\\text{death}}\\le C_d (\\mathrm{Per}(\\varphi(E))/\\sigma)\\,L_\\varphi$.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Algorithmic Noise Measures"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-boundary-heat-kernel",
      "title": "Heat‑kernel death probability is Lipschitz with constant $\\lesssim 1/\\sigma$",
      "start_line": 1201,
      "end_line": 1210,
      "header_lines": [
        1202
      ],
      "content_start": 1203,
      "content_end": 1209,
      "content": "1203: :label: lem-boundary-heat-kernel\n1204: Let $E=\\mathcal{X}_{\\mathrm{invalid}}\\subset\\mathcal X$ have finite perimeter and let $p_{\\sigma^2}$ be the heat kernel at scale $\\sigma$. Define $P_\\sigma(x)=\\int \\chi_E(y)\\,p_{\\sigma^2}(x,\\mathrm dy)$. Then\n1205: $$\n1206: \n1207: |P_\\sigma(x)-P_\\sigma(y)|\\;\\le\\; C_d'\\,\\frac{\\mathrm{Per}(E)}{\\sigma}\\, d_{\\mathcal X}(x,y),\n1208: \n1209: $$",
      "metadata": {
        "label": "lem-boundary-heat-kernel"
      },
      "section": "## 5. Algorithmic Noise Measures",
      "raw_directive": "1201: #### 5.2.4 Lemma: Heat‑kernel Lipschitz bound via BV smoothing\n1202: :::{prf:lemma} Heat‑kernel death probability is Lipschitz with constant $\\lesssim 1/\\sigma$\n1203: :label: lem-boundary-heat-kernel\n1204: Let $E=\\mathcal{X}_{\\mathrm{invalid}}\\subset\\mathcal X$ have finite perimeter and let $p_{\\sigma^2}$ be the heat kernel at scale $\\sigma$. Define $P_\\sigma(x)=\\int \\chi_E(y)\\,p_{\\sigma^2}(x,\\mathrm dy)$. Then\n1205: $$\n1206: \n1207: |P_\\sigma(x)-P_\\sigma(y)|\\;\\le\\; C_d'\\,\\frac{\\mathrm{Per}(E)}{\\sigma}\\, d_{\\mathcal X}(x,y),\n1208: \n1209: $$\n1210: with a constant $C_d'$ depending on dimension. Consequently $L_{\\text{death}}\\lesssim (\\mathrm{Per}(\\varphi(E))/\\sigma)\\,L_\\varphi$ in the algorithmic metric.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Algorithmic Noise Measures"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-empirical-moments-lipschitz",
      "title": "Empirical moments are Lipschitz in L2",
      "start_line": 1317,
      "end_line": 1334,
      "header_lines": [
        1318
      ],
      "content_start": 1320,
      "content_end": 1333,
      "content": "1320: \n1321: Let $\\mathbf v\\in\\mathbb R^k$ collect the values of the $k=|\\mathcal A(\\mathcal S)|$ alive walkers. Consider the empirical mean and second raw moment\n1322: \n1323: $$\n1324: \\mu(\\mathbf v) = \\frac{1}{k}\\sum_{i=1}^k v_i,\\qquad m_2(\\mathbf v) = \\frac{1}{k}\\sum_{i=1}^k v_i^{\\,2}.\n1325: $$\n1326: \n1327: Assume $|v_i|\\le V_{\\max}$ for all $i$. Then, with respect to the L2 norm on $\\mathbb R^k$,\n1328: \n1329: $$\n1330: |\\mu(\\mathbf v_1)-\\mu(\\mathbf v_2)|\\;\\le\\; \\frac{1}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2,\\qquad\n1331: |m_2(\\mathbf v_1)-m_2(\\mathbf v_2)|\\;\\le\\; \\frac{2 V_{\\max}}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2.\n1332: $$\n1333: ",
      "metadata": {
        "label": "lem-empirical-moments-lipschitz"
      },
      "section": "## 7. Swarm Measuring",
      "raw_directive": "1317: ##### 7.2.2.1 Lemma: Lipschitz constants for empirical moments (mean and second moment)\n1318: :::{prf:lemma} Empirical moments are Lipschitz in L2\n1319: :label: lem-empirical-moments-lipschitz\n1320: \n1321: Let $\\mathbf v\\in\\mathbb R^k$ collect the values of the $k=|\\mathcal A(\\mathcal S)|$ alive walkers. Consider the empirical mean and second raw moment\n1322: \n1323: $$\n1324: \\mu(\\mathbf v) = \\frac{1}{k}\\sum_{i=1}^k v_i,\\qquad m_2(\\mathbf v) = \\frac{1}{k}\\sum_{i=1}^k v_i^{\\,2}.\n1325: $$\n1326: \n1327: Assume $|v_i|\\le V_{\\max}$ for all $i$. Then, with respect to the L2 norm on $\\mathbb R^k$,\n1328: \n1329: $$\n1330: |\\mu(\\mathbf v_1)-\\mu(\\mathbf v_2)|\\;\\le\\; \\frac{1}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2,\\qquad\n1331: |m_2(\\mathbf v_1)-m_2(\\mathbf v_2)|\\;\\le\\; \\frac{2 V_{\\max}}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2.\n1332: $$\n1333: \n1334: In particular, for the empirical aggregator we may take $L_{\\mu,M}=1/\\sqrt{k}$ and $L_{m_2,M}=2V_{\\max}/\\sqrt{k}$.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. Swarm Measuring"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-empirical-aggregator-properties",
      "title": "Axiomatic Properties of the Empirical Measure Aggregator",
      "start_line": 1348,
      "end_line": 1363,
      "header_lines": [
        1349
      ],
      "content_start": 1350,
      "content_end": 1362,
      "content": "1350: :label: lem-empirical-aggregator-properties\n1351: Let the aggregation operator $M$ be defined such that for any swarm state $\\mathcal{S}$ with alive set $\\mathcal{A}(\\mathcal{S})$ of size $k = |\\mathcal{A}(\\mathcal{S})| \\ge 1$, and any raw value vector $\\mathbf{v}$, it produces the discrete empirical measure:\n1352: \n1353: $$\n1354: M(\\mathcal{S}, \\mathbf{v}) = \\frac{1}{k} \\sum_{i \\in \\mathcal{A}(\\mathcal{S})} \\delta_{v_i}\n1355: $$\n1356: \n1357: :::{note}\n1358: **Breaking down this formula**:\n1359: - $k = |\\mathcal{A}(\\mathcal{S})|$ is the number of alive walkers\n1360: - $\\delta_{v_i}$ is a \"spike\" (Dirac delta) at value $v_i$ - it puts all probability mass exactly at that point\n1361: - The sum creates a collection of spikes, one for each alive walker's value\n1362: - The $\\frac{1}{k}$ factor gives each walker equal weight",
      "metadata": {
        "label": "lem-empirical-aggregator-properties"
      },
      "section": "## 7. Swarm Measuring",
      "raw_directive": "1348: The most fundamental aggregation operator is one that produces the standard empirical measure of the raw values from the alive set. We now formally prove that this operator satisfies the axiomatic requirements of [](#def-swarm-aggregation-operator-axiomatic) and derive its specific continuity constants and growth exponents.\n1349: :::{prf:lemma} Axiomatic Properties of the Empirical Measure Aggregator\n1350: :label: lem-empirical-aggregator-properties\n1351: Let the aggregation operator $M$ be defined such that for any swarm state $\\mathcal{S}$ with alive set $\\mathcal{A}(\\mathcal{S})$ of size $k = |\\mathcal{A}(\\mathcal{S})| \\ge 1$, and any raw value vector $\\mathbf{v}$, it produces the discrete empirical measure:\n1352: \n1353: $$\n1354: M(\\mathcal{S}, \\mathbf{v}) = \\frac{1}{k} \\sum_{i \\in \\mathcal{A}(\\mathcal{S})} \\delta_{v_i}\n1355: $$\n1356: \n1357: :::{note}\n1358: **Breaking down this formula**:\n1359: - $k = |\\mathcal{A}(\\mathcal{S})|$ is the number of alive walkers\n1360: - $\\delta_{v_i}$ is a \"spike\" (Dirac delta) at value $v_i$ - it puts all probability mass exactly at that point\n1361: - The sum creates a collection of spikes, one for each alive walker's value\n1362: - The $\\frac{1}{k}$ factor gives each walker equal weight\n1363: **Result**: A probability distribution that treats each alive walker's measurement as equally important. This is the foundation for computing means, variances, and other statistics!",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. Swarm Measuring"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-set-difference-bound",
      "title": "Bound on the Error from Companion Set Change",
      "start_line": 1520,
      "end_line": 1529,
      "header_lines": [
        1521
      ],
      "content_start": 1522,
      "content_end": 1528,
      "content": "1522: :label: lem-set-difference-bound\n1523: Let $S_1$ and $S_2$ be two companion support sets, with $|S_1| > 0$. Let $f_j = f(x_j)$ be a real-valued function bounded by a constant $M_f$ such that $|f_j| \\le M_f$ for all $j$.\n1524: The absolute difference between the sums over these two sets, normalized by the initial set size $|S_1|$, is bounded by the size of the symmetric difference between the sets, $|S_1 \\Delta S_2|$.\n1525: $$\n1526: \n1527: \\left| \\frac{1}{|S_1|} \\sum_{j \\in S_1} f_j - \\frac{1}{|S_1|} \\sum_{j \\in S_2} f_j \\right| \\le \\frac{M_f}{|S_1|} |S_1 \\Delta S_2|\n1528: ",
      "metadata": {
        "label": "lem-set-difference-bound"
      },
      "section": "## 8. Companion Selection",
      "raw_directive": "1520: This lemma bounds the component of the error that arises purely from the change in the set of companions, holding the normalization constant fixed.\n1521: :::{prf:lemma} Bound on the Error from Companion Set Change\n1522: :label: lem-set-difference-bound\n1523: Let $S_1$ and $S_2$ be two companion support sets, with $|S_1| > 0$. Let $f_j = f(x_j)$ be a real-valued function bounded by a constant $M_f$ such that $|f_j| \\le M_f$ for all $j$.\n1524: The absolute difference between the sums over these two sets, normalized by the initial set size $|S_1|$, is bounded by the size of the symmetric difference between the sets, $|S_1 \\Delta S_2|$.\n1525: $$\n1526: \n1527: \\left| \\frac{1}{|S_1|} \\sum_{j \\in S_1} f_j - \\frac{1}{|S_1|} \\sum_{j \\in S_2} f_j \\right| \\le \\frac{M_f}{|S_1|} |S_1 \\Delta S_2|\n1528: \n1529: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 8. Companion Selection"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-normalization-difference-bound",
      "title": "Bound on the Error from Normalization Change",
      "start_line": 1550,
      "end_line": 1559,
      "header_lines": [
        1551
      ],
      "content_start": 1552,
      "content_end": 1558,
      "content": "1552: :label: lem-normalization-difference-bound\n1553: Let $S_1$ and $S_2$ be two companion support sets, with $|S_1|, |S_2| > 0$. Let $f_j = f(x_j)$ be a real-valued function bounded by a constant $M_f$.\n1554: The absolute difference between two sums over the *same* set $S_2$, but with different normalization constants, is bounded by the absolute difference in the set sizes.\n1555: $$\n1556: \n1557: \\left| \\frac{1}{|S_1|} \\sum_{j \\in S_2} f_j - \\frac{1}{|S_2|} \\sum_{j \\in S_2} f_j \\right| \\le \\frac{M_f}{|S_1|} \\big||S_1| - |S_2|\\big|\n1558: ",
      "metadata": {
        "label": "lem-normalization-difference-bound"
      },
      "section": "## 8. Companion Selection",
      "raw_directive": "1550: This lemma bounds the component of the error that arises from changing the normalization constants, from $1/|S_1|$ to $1/|S_2|$, while holding the summation set fixed.\n1551: :::{prf:lemma} Bound on the Error from Normalization Change\n1552: :label: lem-normalization-difference-bound\n1553: Let $S_1$ and $S_2$ be two companion support sets, with $|S_1|, |S_2| > 0$. Let $f_j = f(x_j)$ be a real-valued function bounded by a constant $M_f$.\n1554: The absolute difference between two sums over the *same* set $S_2$, but with different normalization constants, is bounded by the absolute difference in the set sizes.\n1555: $$\n1556: \n1557: \\left| \\frac{1}{|S_1|} \\sum_{j \\in S_2} f_j - \\frac{1}{|S_2|} \\sum_{j \\in S_2} f_j \\right| \\le \\frac{M_f}{|S_1|} \\big||S_1| - |S_2|\\big|\n1558: \n1559: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 8. Companion Selection"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cubic-patch-uniqueness",
      "title": "Existence and Uniqueness of the Smooth Rescale Patch",
      "start_line": 1693,
      "end_line": 1696,
      "header_lines": [
        1694
      ],
      "content_start": 1695,
      "content_end": 1695,
      "content": "1695: :label: lem-cubic-patch-uniqueness",
      "metadata": {
        "label": "lem-cubic-patch-uniqueness"
      },
      "section": "## 9. Rescale Transformation",
      "raw_directive": "1693: The construction of the $Smooth Piecewise Rescale Function$ relies on the existence of a unique cubic polynomial that seamlessly connects the logarithmic and constant segments. The following lemma provides the formal proof that such a polynomial is always uniquely determined by the specified boundary conditions.\n1694: :::{prf:lemma} Existence and Uniqueness of the Smooth Rescale Patch\n1695: :label: lem-cubic-patch-uniqueness\n1696: For any $z_max > 1$, there exists a unique cubic polynomial $P(z)$ that satisfies the four $C¹$ boundary conditions specified in [](#def-asymmetric-rescale-function).",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 9. Rescale Transformation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cubic-patch-coefficients",
      "title": "Explicit Coefficients of the Smooth Rescale Patch",
      "start_line": 1743,
      "end_line": 1756,
      "header_lines": [
        1744
      ],
      "content_start": 1745,
      "content_end": 1755,
      "content": "1745: :label: lem-cubic-patch-coefficients\n1746: Let the cubic polynomial patch $P(z)$ be defined on the interval $[z_{\\max}-1, z_{\\max}]$. Let this interval be normalized by the variable $s = z - (z_{\\max}-1)$, such that $z \\in [z_{\\max}-1, z_{\\max}]$ corresponds to $s \\in [0, 1]$. In this normalized coordinate system, the polynomial can be written as:\n1747: $$\n1748: \n1749: P(z(s)) = Q(s) = As^3 + Bs^2 + Cs + D\n1750: \n1751: $$\n1752: The four coefficients, $A, B, C, D$, are uniquely determined by the boundary conditions and the parameter $z_{\\max} > 1$:\n1753: *   $A = \\frac{1}{z_{\\max}} - 2\\log\\left(1 + \\frac{1}{z_{\\max}}\\right)$\n1754: *   $B = 3\\log\\left(1 + \\frac{1}{z_{\\max}}\\right) - \\frac{2}{z_{\\max}}$\n1755: *   $C = \\frac{1}{z_{\\max}}$",
      "metadata": {
        "label": "lem-cubic-patch-coefficients"
      },
      "section": "## 9. Rescale Transformation",
      "raw_directive": "1743: To analyze the properties of the derivative of the polynomial patch $P(z)$, we must first find its explicit coefficients. While [](#lem-cubic-patch-uniqueness) guarantees their existence and uniqueness, the following lemma provides their exact form in terms of the single governing parameter, $z_{\\max}$.\n1744: :::{prf:lemma} Explicit Coefficients of the Smooth Rescale Patch\n1745: :label: lem-cubic-patch-coefficients\n1746: Let the cubic polynomial patch $P(z)$ be defined on the interval $[z_{\\max}-1, z_{\\max}]$. Let this interval be normalized by the variable $s = z - (z_{\\max}-1)$, such that $z \\in [z_{\\max}-1, z_{\\max}]$ corresponds to $s \\in [0, 1]$. In this normalized coordinate system, the polynomial can be written as:\n1747: $$\n1748: \n1749: P(z(s)) = Q(s) = As^3 + Bs^2 + Cs + D\n1750: \n1751: $$\n1752: The four coefficients, $A, B, C, D$, are uniquely determined by the boundary conditions and the parameter $z_{\\max} > 1$:\n1753: *   $A = \\frac{1}{z_{\\max}} - 2\\log\\left(1 + \\frac{1}{z_{\\max}}\\right)$\n1754: *   $B = 3\\log\\left(1 + \\frac{1}{z_{\\max}}\\right) - \\frac{2}{z_{\\max}}$\n1755: *   $C = \\frac{1}{z_{\\max}}$\n1756: *   $D = \\log(z_{\\max}) + 1$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 9. Rescale Transformation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cubic-patch-derivative",
      "title": "Explicit Form of the Polynomial Patch Derivative",
      "start_line": 1798,
      "end_line": 1806,
      "header_lines": [
        1799
      ],
      "content_start": 1800,
      "content_end": 1805,
      "content": "1800: :label: lem-cubic-patch-derivative\n1801: Let $P(z)$ be the cubic polynomial patch on the interval $[z_{\\max}-1, z_{\\max}]$, and let $s = z - (z_{\\max}-1)$ be the normalized coordinate on $[0, 1]$. The first derivative of the polynomial, $P'(z)$, is a quadratic function of the normalized coordinate $s$, given by:\n1802: $$\n1803: \n1804: P'(z(s)) = 3\\left(\\frac{1}{z_{\\max}} - 2\\log\\left(1 + \\frac{1}{z_{\\max}}\\right)\\right)s^2 + 2\\left(3\\log\\left(1 + \\frac{1}{z_{\\max}}\\right) - \\frac{2}{z_{\\max}}\\right)s + \\frac{1}{z_{\\max}}\n1805: ",
      "metadata": {
        "label": "lem-cubic-patch-derivative"
      },
      "section": "## 9. Rescale Transformation",
      "raw_directive": "1798: Having derived the explicit coefficients for the cubic polynomial patch, we can now define the exact functional form of its first derivative. This isolates the quadratic function whose bounds we must analyze to establish the global Lipschitz continuity of the complete rescale function.\n1799: :::{prf:lemma} Explicit Form of the Polynomial Patch Derivative\n1800: :label: lem-cubic-patch-derivative\n1801: Let $P(z)$ be the cubic polynomial patch on the interval $[z_{\\max}-1, z_{\\max}]$, and let $s = z - (z_{\\max}-1)$ be the normalized coordinate on $[0, 1]$. The first derivative of the polynomial, $P'(z)$, is a quadratic function of the normalized coordinate $s$, given by:\n1802: $$\n1803: \n1804: P'(z(s)) = 3\\left(\\frac{1}{z_{\\max}} - 2\\log\\left(1 + \\frac{1}{z_{\\max}}\\right)\\right)s^2 + 2\\left(3\\log\\left(1 + \\frac{1}{z_{\\max}}\\right) - \\frac{2}{z_{\\max}}\\right)s + \\frac{1}{z_{\\max}}\n1805: \n1806: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 9. Rescale Transformation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-polynomial-patch-monotonicity",
      "title": "Monotonicity of the Polynomial Patch",
      "start_line": 1836,
      "end_line": 1839,
      "header_lines": [
        1837
      ],
      "content_start": 1838,
      "content_end": 1838,
      "content": "1838: :label: lem-polynomial-patch-monotonicity",
      "metadata": {
        "label": "lem-polynomial-patch-monotonicity"
      },
      "section": "## 9. Rescale Transformation",
      "raw_directive": "1836: ##### 8.2.2.4 Lemma: Monotonicity of the Polynomial Patch (Fritsch–Carlson/Hyman)\n1837: :::{prf:lemma} Monotonicity of the Polynomial Patch\n1838: :label: lem-polynomial-patch-monotonicity\n1839: Let $z_0=z_{\\max}-1$, $z_1=z_{\\max}$, $y_0=\\log(z_{\\max})+1$, $y_1=\\log(1+z_{\\max})+1$, and endpoint slopes $m_0=P'(z_0)=1/z_{\\max}$, $m_1=P'(z_1)=0$. Set the secant $\\Delta:=(y_1-y_0)/(z_1-z_0)=\\log(1+1/z_{\\max})>0$. Then the Hermite cubic $P$ on $[z_0,z_1]$ with $(y_0,m_0),(y_1,m_1)$ is monotonically non‑decreasing.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 9. Rescale Transformation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cubic-patch-derivative-bounds",
      "title": "Bounds on the Polynomial Patch Derivative",
      "start_line": 1850,
      "end_line": 1864,
      "header_lines": [
        1851
      ],
      "content_start": 1852,
      "content_end": 1863,
      "content": "1852: :label: lem-cubic-patch-derivative-bounds\n1853: Let $P'(z(s))$ be the derivative of the cubic patch on the interval $s \\in [0, 1]$, as defined in [](#lem-cubic-patch-derivative). This derivative is uniformly bounded on its domain for any choice of $z_{\\max} > 1$. Specifically, it satisfies:\n1854: $$\n1855: \n1856: 0 \\le P'(z(s)) \\le L_P\n1857: \n1858: $$\n1859: where $L_P$ is a constant slightly greater than 1, given by:\n1860: $$\n1861: \n1862: L_P = 1 + \\frac{(3\\log(2)-2)^2}{3(2\\log(2)-1)} \\approx 1.0054\n1863: ",
      "metadata": {
        "label": "lem-cubic-patch-derivative-bounds"
      },
      "section": "## 9. Rescale Transformation",
      "raw_directive": "1850: ##### 8.2.2.5 Lemma: Bounds on the Polynomial Patch Derivative\n1851: :::{prf:lemma} Bounds on the Polynomial Patch Derivative\n1852: :label: lem-cubic-patch-derivative-bounds\n1853: Let $P'(z(s))$ be the derivative of the cubic patch on the interval $s \\in [0, 1]$, as defined in [](#lem-cubic-patch-derivative). This derivative is uniformly bounded on its domain for any choice of $z_{\\max} > 1$. Specifically, it satisfies:\n1854: $$\n1855: \n1856: 0 \\le P'(z(s)) \\le L_P\n1857: \n1858: $$\n1859: where $L_P$ is a constant slightly greater than 1, given by:\n1860: $$\n1861: \n1862: L_P = 1 + \\frac{(3\\log(2)-2)^2}{3(2\\log(2)-1)} \\approx 1.0054\n1863: \n1864: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 9. Rescale Transformation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-rescale-monotonicity",
      "title": "Monotonicity of the Smooth Rescale Function",
      "start_line": 1928,
      "end_line": 1931,
      "header_lines": [
        1929
      ],
      "content_start": 1930,
      "content_end": 1930,
      "content": "1930: :label: lem-rescale-monotonicity",
      "metadata": {
        "label": "lem-rescale-monotonicity"
      },
      "section": "## 9. Rescale Transformation",
      "raw_directive": "1928: A critical property of the rescale function $g_A(z)$ is that it must be monotonically non-decreasing. This ensures that a higher standardized score always results in a higher (or equal) rescaled value, preserving the intended ordering of walker potentials. The following lemma formalizes this property for the entire function.\n1929: :::{prf:lemma} Monotonicity of the Smooth Rescale Function\n1930: :label: lem-rescale-monotonicity\n1931: The $Smooth Piecewise Rescale Function$ $g_A(z)$ is monotonically non-decreasing on $ℝ$.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 9. Rescale Transformation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-lipschitz-constant-of-the-patched-standardization",
      "title": "Lipschitz constant of the patched standardization",
      "start_line": 1995,
      "end_line": 2004,
      "header_lines": [
        1996
      ],
      "content_start": 1997,
      "content_end": 2003,
      "content": "1997: :label: lem-lipschitz-constant-of-the-patched-standardization\n1998: Let $z=\\sigma\\'_{\\text{reg}}(\\cdot)$ denote the patched standardization of raw values with variance floor $\\varepsilon_{\\text{std}}>0$, and let $g_A$ be the piecewise rescale in §8.2.2. Then $g_A\\circ z$ is globally Lipschitz. In particular, if the variance functional of the chosen aggregator is $L_{\\mathrm{var}}$‑Lipschitz (see §8.2.2.10), then\n1999: $$\n2000: \n2001: L_{g_A\\circ z}\\;\\le\\; L_{g_A}\\cdot L_{z},\\qquad L_{g_A}\\le \\max\\{L_P,1\\},\\quad L_{z}\\le L_{\\sigma\\'_{\\text{reg}}}\\,L_{\\mathrm{var}}.\n2002: \n2003: $$",
      "metadata": {
        "label": "lem-lipschitz-constant-of-the-patched-standardization"
      },
      "section": "## 9. Rescale Transformation",
      "raw_directive": "1995: ##### 8.2.2.8 Global Lipschitz bound for the standardized map\n1996: :::{prf:lemma} Lipschitz constant of the patched standardization\n1997: :label: lem-lipschitz-constant-of-the-patched-standardization\n1998: Let $z=\\sigma\\'_{\\text{reg}}(\\cdot)$ denote the patched standardization of raw values with variance floor $\\varepsilon_{\\text{std}}>0$, and let $g_A$ be the piecewise rescale in §8.2.2. Then $g_A\\circ z$ is globally Lipschitz. In particular, if the variance functional of the chosen aggregator is $L_{\\mathrm{var}}$‑Lipschitz (see §8.2.2.10), then\n1999: $$\n2000: \n2001: L_{g_A\\circ z}\\;\\le\\; L_{g_A}\\cdot L_{z},\\qquad L_{g_A}\\le \\max\\{L_P,1\\},\\quad L_{z}\\le L_{\\sigma\\'_{\\text{reg}}}\\,L_{\\mathrm{var}}.\n2002: \n2003: $$\n2004: Here $L_P=\\|P'\\|_\\infty$ is the uniform derivative bound from [](#lem-cubic-patch-derivative-bounds). The factor $L_{\\sigma\\'_{\\text{reg}}}$ is the global Lipschitz constant of the regularized standard deviation, provided by [](#lem-sigma-patch-derivative-bound).",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 9. Rescale Transformation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sigma-patch-derivative-bound",
      "title": "Derivative bound for \\sigma\\'_{\\text{reg}}",
      "start_line": 2006,
      "end_line": 2015,
      "header_lines": [
        2007
      ],
      "content_start": 2008,
      "content_end": 2014,
      "content": "2008: :label: lem-sigma-patch-derivative-bound\n2009: Let $\\sigma\\'_{\\text{reg}}(V) = \\sqrt{V + \\sigma'^2_{\\min}}$ be the regularized standard deviation from [](#def-statistical-properties-measurement), where $\\sigma'_{\\min} = \\sqrt{\\kappa_{\\text{var,min}} + \\varepsilon_{\\text{std}}^2}$. Its global derivative bound is:\n2010: $$\n2011: \n2012: L_{\\sigma\\'_{\\text{reg}}}=\\sup_{V\\ge 0}\\big|\\,(\\sigma\\'_{\\text{reg}})'(V)\\,\\big|= \\frac{1}{2\\sigma'_{\\min}} = \\frac{1}{2\\sqrt{\\kappa_{\\text{var,min}} + \\varepsilon_{\\text{std}}^2}}\n2013: \n2014: $$",
      "metadata": {
        "label": "lem-sigma-patch-derivative-bound"
      },
      "section": "## 9. Rescale Transformation",
      "raw_directive": "2006: ##### 8.2.2.9 Lemma: Patched standard deviation derivative bound\n2007: :::{prf:lemma} Derivative bound for \\sigma\\'_{\\text{reg}}\n2008: :label: lem-sigma-patch-derivative-bound\n2009: Let $\\sigma\\'_{\\text{reg}}(V) = \\sqrt{V + \\sigma'^2_{\\min}}$ be the regularized standard deviation from [](#def-statistical-properties-measurement), where $\\sigma'_{\\min} = \\sqrt{\\kappa_{\\text{var,min}} + \\varepsilon_{\\text{std}}^2}$. Its global derivative bound is:\n2010: $$\n2011: \n2012: L_{\\sigma\\'_{\\text{reg}}}=\\sup_{V\\ge 0}\\big|\\,(\\sigma\\'_{\\text{reg}})'(V)\\,\\big|= \\frac{1}{2\\sigma'_{\\min}} = \\frac{1}{2\\sqrt{\\kappa_{\\text{var,min}} + \\varepsilon_{\\text{std}}^2}}\n2013: \n2014: $$\n2015: as established in [](#lem-sigma-reg-derivative-bounds).",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 9. Rescale Transformation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-lipschitz-bound-for-the-variance-functional",
      "title": "Lipschitz bound for the variance functional",
      "start_line": 2017,
      "end_line": 2026,
      "header_lines": [
        2018
      ],
      "content_start": 2019,
      "content_end": 2025,
      "content": "2019: :label: lem-lipschitz-bound-for-the-variance-functional\n2020: Let $\\mu(\\mathbf v)$ and $m_2(\\mathbf v)$ denote, respectively, the (aggregator) mean and second raw moment computed from a value vector $\\mathbf v\\in\\mathbb{R}^k$ over the alive set. Assume the moment maps are Lipschitz in $\\mathbf v$ with constants $L_{\\mu,M}$ and $L_{m_2,M}$ as in §6.2.1, and suppose $|v_i|\\le V_{\\max}$. Define the variance functional $\\mathrm{Var}(\\mathbf v):=m_2(\\mathbf v) - \\mu(\\mathbf v)^2$. Then, for all $\\mathbf v_1,\\mathbf v_2$,\n2021: $$\n2022: \n2023: \\big|\\,\\mathrm{Var}(\\mathbf v_1)-\\mathrm{Var}(\\mathbf v_2)\\,\\big|\\;\\le\\;\\Big( L_{m_2,M}\\; +\\; 2 V_{\\max}\\,L_{\\mu,M}\\Big)\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2.\n2024: \n2025: $$",
      "metadata": {
        "label": "lem-lipschitz-bound-for-the-variance-functional"
      },
      "section": "## 9. Rescale Transformation",
      "raw_directive": "2017: ##### 8.2.2.10 Lemma: Lipschitz constant of the empirical variance\n2018: :::{prf:lemma} Lipschitz bound for the variance functional\n2019: :label: lem-lipschitz-bound-for-the-variance-functional\n2020: Let $\\mu(\\mathbf v)$ and $m_2(\\mathbf v)$ denote, respectively, the (aggregator) mean and second raw moment computed from a value vector $\\mathbf v\\in\\mathbb{R}^k$ over the alive set. Assume the moment maps are Lipschitz in $\\mathbf v$ with constants $L_{\\mu,M}$ and $L_{m_2,M}$ as in §6.2.1, and suppose $|v_i|\\le V_{\\max}$. Define the variance functional $\\mathrm{Var}(\\mathbf v):=m_2(\\mathbf v) - \\mu(\\mathbf v)^2$. Then, for all $\\mathbf v_1,\\mathbf v_2$,\n2021: $$\n2022: \n2023: \\big|\\,\\mathrm{Var}(\\mathbf v_1)-\\mathrm{Var}(\\mathbf v_2)\\,\\big|\\;\\le\\;\\Big( L_{m_2,M}\\; +\\; 2 V_{\\max}\\,L_{\\mu,M}\\Big)\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2.\n2024: \n2025: $$\n2026: In particular, the variance functional is $L_{\\mathrm{var}}$‑Lipschitz with $L_{\\mathrm{var}}:=L_{m_2,M}+2 V_{\\max} L_{\\mu,M}$.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 9. Rescale Transformation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-single-walker-positional-error",
      "title": "Bound on Single-Walker Error from Positional Change",
      "start_line": 2173,
      "end_line": 2182,
      "header_lines": [
        2174
      ],
      "content_start": 2175,
      "content_end": 2181,
      "content": "2175: :label: lem-single-walker-positional-error\n2176: Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states. For a given walker $i$ that is alive in swarm $\\mathcal{S}_1$ ($s_{1,i}=1$), let $\\mathbb{C}_i(\\mathcal{S}_1)$ be its companion selection measure.\n2177: The absolute error in its expected distance due to the positional displacement of the walkers between the two states, evaluated over the fixed companion set from $\\mathcal{S}_1$, is bounded by the sum of its own displacement and the average displacement of its potential companions.\n2178: $$\n2179: \n2180: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\text{alg}}(x_{1,i}, x_{1,c}) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\text{alg}}(x_{2,i}, x_{2,c}) \\right] \\right| \\le d_{\\text{alg}}(x_{1,i}, x_{2,i}) + \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\text{alg}}(x_{1,c}, x_{2,c}) \\right]\n2181: ",
      "metadata": {
        "label": "lem-single-walker-positional-error"
      },
      "section": "## 11. Distance-to-Companion Measurement",
      "raw_directive": "2173: #### 10.2.1 Lemma: Bound on Single-Walker Error from Positional Change\n2174: :::{prf:lemma} Bound on Single-Walker Error from Positional Change\n2175: :label: lem-single-walker-positional-error\n2176: Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states. For a given walker $i$ that is alive in swarm $\\mathcal{S}_1$ ($s_{1,i}=1$), let $\\mathbb{C}_i(\\mathcal{S}_1)$ be its companion selection measure.\n2177: The absolute error in its expected distance due to the positional displacement of the walkers between the two states, evaluated over the fixed companion set from $\\mathcal{S}_1$, is bounded by the sum of its own displacement and the average displacement of its potential companions.\n2178: $$\n2179: \n2180: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\text{alg}}(x_{1,i}, x_{1,c}) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\text{alg}}(x_{2,i}, x_{2,c}) \\right] \\right| \\le d_{\\text{alg}}(x_{1,i}, x_{2,i}) + \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\text{alg}}(x_{1,c}, x_{2,c}) \\right]\n2181: \n2182: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 11,
        "chapter_file": "chapter_11.json",
        "section_id": "## 11. Distance-to-Companion Measurement"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-single-walker-structural-error",
      "title": "Bound on Single-Walker Error from Structural Change",
      "start_line": 2216,
      "end_line": 2226,
      "header_lines": [
        2217
      ],
      "content_start": 2218,
      "content_end": 2225,
      "content": "2218: :label: lem-single-walker-structural-error\n2219: Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states with alive sets $\\mathcal{A}_1$ and $\\mathcal{A}_2$. Let walker $i$ be alive in both swarms ($i \\in \\mathcal{A}_1 \\cap \\mathcal{A}_2$), and let the initial swarm have at least two alive walkers, $k_1=|\\mathcal{A}_1| \\ge 2$. Let the walker positions $\\mathbf{x}_2$ from the second swarm be fixed for the analysis. Let $n_c$ be the total number of status changes in the swarm.\n2220: The absolute error in the expected distance for walker $i$ due to the change in the companion selection measure is bounded by:\n2221: $$\n2222: \n2223: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\text{alg}}(x_{2,i}, x_{2,c}) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_2)} \\left[ d_{\\text{alg}}(x_{2,i}, x_{2,c}) \\right] \\right| \\le \\frac{2 D_{\\mathcal{Y}}}{k_1 - 1} \\cdot n_c\n2224: \n2225: $$",
      "metadata": {
        "label": "lem-single-walker-structural-error"
      },
      "section": "## 11. Distance-to-Companion Measurement",
      "raw_directive": "2216: #### 10.2.2 Lemma: Bound on Single-Walker Error from Structural Change\n2217: :::{prf:lemma} Bound on Single-Walker Error from Structural Change\n2218: :label: lem-single-walker-structural-error\n2219: Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states with alive sets $\\mathcal{A}_1$ and $\\mathcal{A}_2$. Let walker $i$ be alive in both swarms ($i \\in \\mathcal{A}_1 \\cap \\mathcal{A}_2$), and let the initial swarm have at least two alive walkers, $k_1=|\\mathcal{A}_1| \\ge 2$. Let the walker positions $\\mathbf{x}_2$ from the second swarm be fixed for the analysis. Let $n_c$ be the total number of status changes in the swarm.\n2220: The absolute error in the expected distance for walker $i$ due to the change in the companion selection measure is bounded by:\n2221: $$\n2222: \n2223: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\text{alg}}(x_{2,i}, x_{2,c}) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_2)} \\left[ d_{\\text{alg}}(x_{2,i}, x_{2,c}) \\right] \\right| \\le \\frac{2 D_{\\mathcal{Y}}}{k_1 - 1} \\cdot n_c\n2224: \n2225: $$\n2226: where $D_{\\mathcal{Y}}$ is the diameter of the algorithmic space.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 11,
        "chapter_file": "chapter_11.json",
        "section_id": "## 11. Distance-to-Companion Measurement"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-single-walker-own-status-error",
      "title": "Bound on Single-Walker Error from Own Status Change",
      "start_line": 2248,
      "end_line": 2256,
      "header_lines": [
        2249
      ],
      "content_start": 2250,
      "content_end": 2255,
      "content": "2250: :label: lem-single-walker-own-status-error\n2251: Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states. For any walker $i$ whose survival status changes ($s_{1,i} \\neq s_{2,i}$), the absolute difference in its expected raw distance measurement is bounded by the diameter of the algorithmic space, $D_{\\mathcal{Y}}$.\n2252: $$\n2253: \n2254: \\left| \\mathbb{E}[d_i(\\mathcal{S}_1)] - \\mathbb{E}[d_i(\\mathcal{S}_2)] \\right| \\le D_{\\mathcal{Y}}\n2255: ",
      "metadata": {
        "label": "lem-single-walker-own-status-error"
      },
      "section": "## 11. Distance-to-Companion Measurement",
      "raw_directive": "2248: #### 10.2.3 Lemma: Bound on Single-Walker Error from Own Status Change\n2249: :::{prf:lemma} Bound on Single-Walker Error from Own Status Change\n2250: :label: lem-single-walker-own-status-error\n2251: Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states. For any walker $i$ whose survival status changes ($s_{1,i} \\neq s_{2,i}$), the absolute difference in its expected raw distance measurement is bounded by the diameter of the algorithmic space, $D_{\\mathcal{Y}}$.\n2252: $$\n2253: \n2254: \\left| \\mathbb{E}[d_i(\\mathcal{S}_1)] - \\mathbb{E}[d_i(\\mathcal{S}_2)] \\right| \\le D_{\\mathcal{Y}}\n2255: \n2256: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 11,
        "chapter_file": "chapter_11.json",
        "section_id": "## 11. Distance-to-Companion Measurement"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-total-squared-error-unstable",
      "title": "Bound on the Total Squared Error for Unstable Walkers",
      "start_line": 2282,
      "end_line": 2291,
      "header_lines": [
        2283
      ],
      "content_start": 2284,
      "content_end": 2290,
      "content": "2284: :label: lem-total-squared-error-unstable\n2285: Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states. The total squared error in the expected raw distance from the set of unstable walkers, $\\mathcal{A}_{\\text{unstable}}$, is bounded by the total number of status changes:\n2286: $$\n2287: \n2288: \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} \\big|\\mathbb{E}[d_i(\\mathcal{S}_1)] - \\mathbb{E}[d_i(\\mathcal{S}_2)]\\big|^2 \\le D_{\\mathcal{Y}}^2 \\sum_{j=1}^N (s_{1,j} - s_{2,j})^2,\n2289: \n2290: $$",
      "metadata": {
        "label": "lem-total-squared-error-unstable"
      },
      "section": "## 11. Distance-to-Companion Measurement",
      "raw_directive": "2282: #### 10.2.5 Lemma: Bound on the Total Squared Error for Unstable Walkers\n2283: :::{prf:lemma} Bound on the Total Squared Error for Unstable Walkers\n2284: :label: lem-total-squared-error-unstable\n2285: Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states. The total squared error in the expected raw distance from the set of unstable walkers, $\\mathcal{A}_{\\text{unstable}}$, is bounded by the total number of status changes:\n2286: $$\n2287: \n2288: \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} \\big|\\mathbb{E}[d_i(\\mathcal{S}_1)] - \\mathbb{E}[d_i(\\mathcal{S}_2)]\\big|^2 \\le D_{\\mathcal{Y}}^2 \\sum_{j=1}^N (s_{1,j} - s_{2,j})^2,\n2289: \n2290: $$\n2291: where $D_{\\mathcal{Y}}$ is the diameter of the algorithmic space.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 11,
        "chapter_file": "chapter_11.json",
        "section_id": "## 11. Distance-to-Companion Measurement"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-total-squared-error-stable",
      "title": "Bound on the Total Squared Error for Stable Walkers",
      "start_line": 2301,
      "end_line": 2309,
      "header_lines": [
        2302
      ],
      "content_start": 2303,
      "content_end": 2308,
      "content": "2303: :label: lem-total-squared-error-stable\n2304: Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states with $|\\mathcal{A}(\\mathcal{S}_1)|=k_1 \\ge 2$. The total squared error in the expected raw distance from the set of stable walkers, $\\mathcal{A}_{\\text{stable}} = \\mathcal{A}(\\mathcal{S}_1) \\cap \\mathcal{A}(\\mathcal{S}_2)$, is bounded as follows:\n2305: $$\n2306: \n2307: \\sum_{i \\in \\mathcal{A}_{\\text{stable}}} |\\mathbb{E}[d_i(\\mathcal{S}_1)] - \\mathbb{E}[d_i(\\mathcal{S}_2)]|^2 \\le 12 \\cdot \\Delta_{\\text{pos}}^2(\\mathcal{S}_1, \\mathcal{S}_2) + \\frac{8 k_1 D_{\\mathcal{Y}}^2}{(k_1 - 1)^2} \\cdot n_c(\\mathcal{S}_1, \\mathcal{S}_2)^2\n2308: ",
      "metadata": {
        "label": "lem-total-squared-error-stable"
      },
      "section": "## 11. Distance-to-Companion Measurement",
      "raw_directive": "2301: #### 10.2.6. Lemma: Bound on the Total Squared Error for Stable Walkers\n2302: :::{prf:lemma} Bound on the Total Squared Error for Stable Walkers\n2303: :label: lem-total-squared-error-stable\n2304: Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states with $|\\mathcal{A}(\\mathcal{S}_1)|=k_1 \\ge 2$. The total squared error in the expected raw distance from the set of stable walkers, $\\mathcal{A}_{\\text{stable}} = \\mathcal{A}(\\mathcal{S}_1) \\cap \\mathcal{A}(\\mathcal{S}_2)$, is bounded as follows:\n2305: $$\n2306: \n2307: \\sum_{i \\in \\mathcal{A}_{\\text{stable}}} |\\mathbb{E}[d_i(\\mathcal{S}_1)] - \\mathbb{E}[d_i(\\mathcal{S}_2)]|^2 \\le 12 \\cdot \\Delta_{\\text{pos}}^2(\\mathcal{S}_1, \\mathcal{S}_2) + \\frac{8 k_1 D_{\\mathcal{Y}}^2}{(k_1 - 1)^2} \\cdot n_c(\\mathcal{S}_1, \\mathcal{S}_2)^2\n2308: \n2309: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 11,
        "chapter_file": "chapter_11.json",
        "section_id": "## 11. Distance-to-Companion Measurement"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-stats-value-continuity",
      "title": "Value Continuity of Statistical Properties",
      "start_line": 2881,
      "end_line": 2901,
      "header_lines": [
        2882
      ],
      "content_start": 2883,
      "content_end": 2900,
      "content": "2883: (\\sigma'_{\text{reg}})'''(V) = \n2884: rac{3}{8}(V + \\sigma'^2_{\\min})^{-5/2}\n2885: $$\n2886: \n2887: Since $V \\ge 0$, the maximum magnitude of each derivative occurs at $V = 0$, yielding the stated bounds. The general form follows from the pattern of alternating signs and double factorials in the $n$-th derivative of $(V + \\sigma'^2_{\\min})^{1/2}$.\n2888: **Q.E.D.**\n2889: :::\n2890: #### 11.1.3 Continuity of Statistical Properties\n2891: The stability of the standardization operator hinges on the continuity of the measured mean ($\\mu_{\\mathcal{A}}$) and the regularized standard deviation ($\\sigma'_{\\mathcal{A}}$). These properties are not fundamental axioms themselves but are instead consequences of the axiomatic properties of the chosen **Swarm Aggregation Operator** $M$ ([](#def-swarm-aggregation-operator-axiomatic)) and the Lipschitz continuity of the new **Regularized Standard Deviation Function** ([](#def-statistical-properties-measurement)). The following lemmas formally derive the continuity bounds for $\\mu_{\\mathcal{A}}$ and $\\sigma'_{\\mathcal{A}}$ with respect to both changes in the raw value vector and changes in the swarm's structure.\n2892: :::{prf:lemma} Value Continuity of Statistical Properties\n2893: :label: lem-stats-value-continuity\n2894: Let $\\mathcal{S}$ be a fixed swarm state with alive set $\\mathcal{A}$ of size $k = |\\mathcal{A}| \\geq 1$. Let $\\mathbf{v}_1$ and $\\mathbf{v}_2$ be two raw value vectors, with components bounded by $V_{\\max}$. The mean $\\mu(\\mathcal{S}, \\mathbf{v})$ and regularized standard deviation $\\sigma'(\\mathcal{S}, \\mathbf{v})$ are Lipschitz continuous with respect to the raw value vector $\\mathbf{v}$.\n2895: \n2896: $$\n2897: |\\mu(\\mathcal{S}, \\mathbf{v}_1) - \\mu(\\mathcal{S}, \\mathbf{v}_2)| \\le L_{\\mu,M}(\\mathcal{S}) \\cdot \\|\\mathbf{v}_1 - \\mathbf{v}_2\\|_2\n2898: $$\n2899: \n2900: $$",
      "metadata": {
        "label": "lem-stats-value-continuity"
      },
      "section": "## 12. Standardization pipeline",
      "raw_directive": "2881: \n2882: $$\n2883: (\\sigma'_{\text{reg}})'''(V) = \n2884: rac{3}{8}(V + \\sigma'^2_{\\min})^{-5/2}\n2885: $$\n2886: \n2887: Since $V \\ge 0$, the maximum magnitude of each derivative occurs at $V = 0$, yielding the stated bounds. The general form follows from the pattern of alternating signs and double factorials in the $n$-th derivative of $(V + \\sigma'^2_{\\min})^{1/2}$.\n2888: **Q.E.D.**\n2889: :::\n2890: #### 11.1.3 Continuity of Statistical Properties\n2891: The stability of the standardization operator hinges on the continuity of the measured mean ($\\mu_{\\mathcal{A}}$) and the regularized standard deviation ($\\sigma'_{\\mathcal{A}}$). These properties are not fundamental axioms themselves but are instead consequences of the axiomatic properties of the chosen **Swarm Aggregation Operator** $M$ ([](#def-swarm-aggregation-operator-axiomatic)) and the Lipschitz continuity of the new **Regularized Standard Deviation Function** ([](#def-statistical-properties-measurement)). The following lemmas formally derive the continuity bounds for $\\mu_{\\mathcal{A}}$ and $\\sigma'_{\\mathcal{A}}$ with respect to both changes in the raw value vector and changes in the swarm's structure.\n2892: :::{prf:lemma} Value Continuity of Statistical Properties\n2893: :label: lem-stats-value-continuity\n2894: Let $\\mathcal{S}$ be a fixed swarm state with alive set $\\mathcal{A}$ of size $k = |\\mathcal{A}| \\geq 1$. Let $\\mathbf{v}_1$ and $\\mathbf{v}_2$ be two raw value vectors, with components bounded by $V_{\\max}$. The mean $\\mu(\\mathcal{S}, \\mathbf{v})$ and regularized standard deviation $\\sigma'(\\mathcal{S}, \\mathbf{v})$ are Lipschitz continuous with respect to the raw value vector $\\mathbf{v}$.\n2895: \n2896: $$\n2897: |\\mu(\\mathcal{S}, \\mathbf{v}_1) - \\mu(\\mathcal{S}, \\mathbf{v}_2)| \\le L_{\\mu,M}(\\mathcal{S}) \\cdot \\|\\mathbf{v}_1 - \\mathbf{v}_2\\|_2\n2898: $$\n2899: \n2900: $$\n2901: |\\sigma'(\\mathcal{S}, \\mathbf{v}_1) - \\sigma'(\\mathcal{S}, \\mathbf{v}_2)| \\le L_{\\sigma',M}(\\mathcal{S}) \\cdot \\|\\mathbf{v}_1 - \\mathbf{v}_2\\|_2",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 12. Standardization pipeline"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-stats-structural-continuity",
      "title": "Structural Continuity of Statistical Properties",
      "start_line": 2914,
      "end_line": 2933,
      "header_lines": [
        2915
      ],
      "content_start": 2916,
      "content_end": 2932,
      "content": "2916: The bound for the mean $\\mu$ is a direct application of the axiom in [](#def-swarm-aggregation-operator-axiomatic). The bound for $\\sigma'$ is derived by composition. $\\sigma'(\\mathcal{S}, \\mathbf{v})$ is the composition of the variance function $\\text{Var}(\\mathbf{v}) = m_2(\\mathcal{S}, \\mathbf{v}) - \\mu(\\mathcal{S}, \\mathbf{v})^2$ and the smoothed function $\\sigma\\'_{\\text{reg}}(V)$.\n2917: 1.  **Lipschitz Constant of $\\sigma\\'_{\\text{reg}}(V)$:** The function $\\sigma\\'_{\\text{reg}}(V) = \\sqrt{V + \\sigma'^2_{\\min}}$ is infinitely differentiable. Its first derivative is $(\\sigma\\'_{\\text{reg}})'(V) = \\frac{1}{2\\sqrt{V + \\sigma'^2_{\\min}}}$, which is maximized at $V = 0$. Therefore, its global Lipschitz constant is $L_{\\sigma\\'_{\\text{reg}}} = \\frac{1}{2\\sigma'_{\\min}}$, a finite, positive constant.\n2918: 2.  **Lipschitz Constant of the Variance:** The change in variance is $|\\text{Var}(\\mathbf{v}_1) - \\text{Var}(\\mathbf{v}_2)| = |(m_2(\\mathbf{v}_1) - \\mu(\\mathbf{v}_1)^2)- (m_2(\\mathbf{v}_2) - \\mu(\\mathbf{v}_2)^2)|$. By the triangle inequality, this is $\\leq |m_2(\\mathbf{v}_1) - m_2(\\mathbf{v}_2)| + |\\mu(\\mathbf{v}_1)^2 - \\mu(\\mathbf{v}_2)^2|$.\n2919:     *   The first term is bounded by $L_{m_2,M}(\\mathcal{S}) \\|\\mathbf{v}_1-\\mathbf{v}_2\\|_2$.\n2920:     *   The second term, $|\\mu_1-\\mu_2||\\mu_1+\\mu_2|$, is bounded by $(L_{\\mu,M}(\\mathcal{S})\\|\\mathbf{v}_1-\\mathbf{v}_2\\|_2)(2V_{\\max})$.\n2921:     *   Thus, the Lipschitz constant for the variance, $L_{\\text{Var}}$, is bounded by $L_{m_2,M}(\\mathcal{S}) + 2V_{\\max} L_{\\mu,M}(\\mathcal{S})$.\n2922: 3.  **Chain Rule for Lipschitz Functions:** The Lipschitz constant of the composition is bounded by the product of the individual Lipschitz constants, $L(\\sigma\\'_{\\text{reg}} \\circ \\text{Var}) \\le L_{\\sigma\\'_{\\text{reg}}} \\cdot L_{\\text{Var}}$, which yields the expression for $L_{\\sigma',M}$.\n2923: **Q.E.D.**\n2924: :::\n2925: :::{prf:lemma} Structural Continuity of Statistical Properties\n2926: :label: lem-stats-structural-continuity\n2927: Let $\\mathbf{v}$ be a fixed raw value vector. Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states. The mean $\\mu(\\mathcal{S}, \\mathbf{v})$ and regularized standard deviation $\\sigma'(\\mathcal{S}, \\mathbf{v})$ are continuous with respect to changes in the swarm structure.\n2928: \n2929: $$\n2930: |\\mu(\\mathcal{S}_1, \\mathbf{v}) - \\mu(\\mathcal{S}_2, \\mathbf{v})| \\le L_{\\mu,S}(\\mathcal{S}_1, \\mathcal{S}_2) \\cdot \\|\\mathbf{s}_1 - \\mathbf{s}_2\\|_2^2\n2931: $$\n2932: ",
      "metadata": {
        "label": "lem-stats-structural-continuity"
      },
      "section": "## 12. Standardization pipeline",
      "raw_directive": "2914: :label: proof-lem-stats-value-continuity\n2915: **Proof.**\n2916: The bound for the mean $\\mu$ is a direct application of the axiom in [](#def-swarm-aggregation-operator-axiomatic). The bound for $\\sigma'$ is derived by composition. $\\sigma'(\\mathcal{S}, \\mathbf{v})$ is the composition of the variance function $\\text{Var}(\\mathbf{v}) = m_2(\\mathcal{S}, \\mathbf{v}) - \\mu(\\mathcal{S}, \\mathbf{v})^2$ and the smoothed function $\\sigma\\'_{\\text{reg}}(V)$.\n2917: 1.  **Lipschitz Constant of $\\sigma\\'_{\\text{reg}}(V)$:** The function $\\sigma\\'_{\\text{reg}}(V) = \\sqrt{V + \\sigma'^2_{\\min}}$ is infinitely differentiable. Its first derivative is $(\\sigma\\'_{\\text{reg}})'(V) = \\frac{1}{2\\sqrt{V + \\sigma'^2_{\\min}}}$, which is maximized at $V = 0$. Therefore, its global Lipschitz constant is $L_{\\sigma\\'_{\\text{reg}}} = \\frac{1}{2\\sigma'_{\\min}}$, a finite, positive constant.\n2918: 2.  **Lipschitz Constant of the Variance:** The change in variance is $|\\text{Var}(\\mathbf{v}_1) - \\text{Var}(\\mathbf{v}_2)| = |(m_2(\\mathbf{v}_1) - \\mu(\\mathbf{v}_1)^2)- (m_2(\\mathbf{v}_2) - \\mu(\\mathbf{v}_2)^2)|$. By the triangle inequality, this is $\\leq |m_2(\\mathbf{v}_1) - m_2(\\mathbf{v}_2)| + |\\mu(\\mathbf{v}_1)^2 - \\mu(\\mathbf{v}_2)^2|$.\n2919:     *   The first term is bounded by $L_{m_2,M}(\\mathcal{S}) \\|\\mathbf{v}_1-\\mathbf{v}_2\\|_2$.\n2920:     *   The second term, $|\\mu_1-\\mu_2||\\mu_1+\\mu_2|$, is bounded by $(L_{\\mu,M}(\\mathcal{S})\\|\\mathbf{v}_1-\\mathbf{v}_2\\|_2)(2V_{\\max})$.\n2921:     *   Thus, the Lipschitz constant for the variance, $L_{\\text{Var}}$, is bounded by $L_{m_2,M}(\\mathcal{S}) + 2V_{\\max} L_{\\mu,M}(\\mathcal{S})$.\n2922: 3.  **Chain Rule for Lipschitz Functions:** The Lipschitz constant of the composition is bounded by the product of the individual Lipschitz constants, $L(\\sigma\\'_{\\text{reg}} \\circ \\text{Var}) \\le L_{\\sigma\\'_{\\text{reg}}} \\cdot L_{\\text{Var}}$, which yields the expression for $L_{\\sigma',M}$.\n2923: **Q.E.D.**\n2924: :::\n2925: :::{prf:lemma} Structural Continuity of Statistical Properties\n2926: :label: lem-stats-structural-continuity\n2927: Let $\\mathbf{v}$ be a fixed raw value vector. Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states. The mean $\\mu(\\mathcal{S}, \\mathbf{v})$ and regularized standard deviation $\\sigma'(\\mathcal{S}, \\mathbf{v})$ are continuous with respect to changes in the swarm structure.\n2928: \n2929: $$\n2930: |\\mu(\\mathcal{S}_1, \\mathbf{v}) - \\mu(\\mathcal{S}_2, \\mathbf{v})| \\le L_{\\mu,S}(\\mathcal{S}_1, \\mathcal{S}_2) \\cdot \\|\\mathbf{s}_1 - \\mathbf{s}_2\\|_2^2\n2931: $$\n2932: \n2933: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 12. Standardization pipeline"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sub-lipschitz-value-error-decomposition",
      "title": "Algebraic Decomposition of the Value Error",
      "start_line": 3473,
      "end_line": 3511,
      "header_lines": [
        3474
      ],
      "content_start": 3475,
      "content_end": 3510,
      "content": "3475: \n3476: \\| \\mathbf{z}_1 - \\mathbf{z}_2 \\|_2^2 \\le 2 \\| \\mathbf{z}_1 - \\mathbf{z}_{\\text{inter}} \\|_2^2 + 2 \\| \\mathbf{z}_{\\text{inter}} - \\mathbf{z}_2 \\|_2^2\n3477: \n3478: $$\n3479: The first term on the right-hand side is the squared Value Error, $E_V^2$, as it arises from the change $v_1 → v_2$ for a fixed structure $S_1$. The second term is the squared Structural Error, $E_S^2$, as it arises from the change $S_1 → S_2$ for a fixed value vector $v_2$. This completes the decomposition.\n3480: **Q.E.D.**\n3481: :::\n3482: #### 11.3.2 Sub-Lemma: Algebraic Decomposition of the Value Error\n3483: To bound the squared value error, $E_V^2$, we first perform a purely algebraic decomposition of the error vector $\\Deltaz = z(S, v_1, M) - z(S, v_2, M)$ for a fixed swarm state **S**. This decomposition isolates the different sources of error: the direct change in the raw values, the change in the computed mean, and the change in the computed standard deviation.\n3484: :::{prf:lemma} Algebraic Decomposition of the Value Error\n3485: :label: lem-sub-lipschitz-value-error-decomposition\n3486: Let **S** be a fixed swarm state with alive set **A** of size **k**. Let $v_1$ and $v_2$ be two raw value vectors for the alive set. Let $(\\mu_1, \\sigma'_1)$ and $(\\mu_2, \\sigma'_2)$ be the corresponding statistical properties, and let $z_1$ and $z_2$ be the corresponding standardized vectors.\n3487: The total value error vector, $\\Deltaz = z_1 - z_2$, can be expressed as the sum of three components:\n3488: $$\n3489: \n3490: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n3491: \n3492: $$\n3493: where:\n3494: 1.  **The Direct Shift ($\\Delta_{\\text{direct}}$):** The error from the change in the raw value vector itself, scaled by the initial standard deviation.\n3495: $$\n3496: \n3497:     \\Delta_{\\text{direct}} := \\frac{\\mathbf{v}_1 - \\mathbf{v}_2}{\\sigma'_1}\n3498: \n3499: \n3500: $$\n3501: 2.  **The Mean Shift ($\\Delta_mean$):** The error from the change in the aggregator's computed mean, applied uniformly to all walkers.\n3502: $$\n3503: \n3504:     \\Delta_{\\text{mean}} := \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1}\n3505: \n3506: \n3507: $$\n3508: where $**1**$ is a k-dimensional vector of ones.\n3509: 3.  **The Denominator Shift ($\\Delta_denom$):** The error from the change in the regularized standard deviation, which rescales the second standardized vector.\n3510: $$",
      "metadata": {
        "label": "lem-sub-lipschitz-value-error-decomposition"
      },
      "section": "## 12. Standardization pipeline",
      "raw_directive": "3473: The total squared error is bounded using the elementary inequality $\\|A+B\\|_2^2 \\leq 2(\\|A\\|_2^2 + \\|B\\|_2^2)$:\n3474: $$\n3475: \n3476: \\| \\mathbf{z}_1 - \\mathbf{z}_2 \\|_2^2 \\le 2 \\| \\mathbf{z}_1 - \\mathbf{z}_{\\text{inter}} \\|_2^2 + 2 \\| \\mathbf{z}_{\\text{inter}} - \\mathbf{z}_2 \\|_2^2\n3477: \n3478: $$\n3479: The first term on the right-hand side is the squared Value Error, $E_V^2$, as it arises from the change $v_1 → v_2$ for a fixed structure $S_1$. The second term is the squared Structural Error, $E_S^2$, as it arises from the change $S_1 → S_2$ for a fixed value vector $v_2$. This completes the decomposition.\n3480: **Q.E.D.**\n3481: :::\n3482: #### 11.3.2 Sub-Lemma: Algebraic Decomposition of the Value Error\n3483: To bound the squared value error, $E_V^2$, we first perform a purely algebraic decomposition of the error vector $\\Deltaz = z(S, v_1, M) - z(S, v_2, M)$ for a fixed swarm state **S**. This decomposition isolates the different sources of error: the direct change in the raw values, the change in the computed mean, and the change in the computed standard deviation.\n3484: :::{prf:lemma} Algebraic Decomposition of the Value Error\n3485: :label: lem-sub-lipschitz-value-error-decomposition\n3486: Let **S** be a fixed swarm state with alive set **A** of size **k**. Let $v_1$ and $v_2$ be two raw value vectors for the alive set. Let $(\\mu_1, \\sigma'_1)$ and $(\\mu_2, \\sigma'_2)$ be the corresponding statistical properties, and let $z_1$ and $z_2$ be the corresponding standardized vectors.\n3487: The total value error vector, $\\Deltaz = z_1 - z_2$, can be expressed as the sum of three components:\n3488: $$\n3489: \n3490: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n3491: \n3492: $$\n3493: where:\n3494: 1.  **The Direct Shift ($\\Delta_{\\text{direct}}$):** The error from the change in the raw value vector itself, scaled by the initial standard deviation.\n3495: $$\n3496: \n3497:     \\Delta_{\\text{direct}} := \\frac{\\mathbf{v}_1 - \\mathbf{v}_2}{\\sigma'_1}\n3498: \n3499: \n3500: $$\n3501: 2.  **The Mean Shift ($\\Delta_mean$):** The error from the change in the aggregator's computed mean, applied uniformly to all walkers.\n3502: $$\n3503: \n3504:     \\Delta_{\\text{mean}} := \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1}\n3505: \n3506: \n3507: $$\n3508: where $**1**$ is a k-dimensional vector of ones.\n3509: 3.  **The Denominator Shift ($\\Delta_denom$):** The error from the change in the regularized standard deviation, which rescales the second standardized vector.\n3510: $$\n3511: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 12. Standardization pipeline"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sub-potential-unstable-error-mean-square",
      "title": "Bounding the Expected Error from Unstable Walkers",
      "start_line": 3871,
      "end_line": 3881,
      "header_lines": [
        3872
      ],
      "content_start": 3874,
      "content_end": 3880,
      "content": "3874: \n3875: \\|\\mathbf{V}_1 - \\mathbf{V}_2\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} |V_{1,i} - V_{2,i}|^2 + \\sum_{i \\in \\mathcal{A}_{\\text{stable}}} |V_{1,i} - V_{2,i}|^2\n3876: \n3877: $$\n3878: We take the expectation of both sides. By linearity of expectation, the total expected squared error is the sum of the expected squared errors over these two partitions. We define the first term as the expected error from unstable walkers, $E^2_{\\text{unstable,ms}}$, and the second term as the expected error from stable walkers, $E^2_{\\text{stable,ms}}$. The subsequent lemmas provide bounds for these terms.\n3879: **Q.E.D.**\n3880: :::",
      "metadata": {
        "label": "lem-sub-potential-unstable-error-mean-square"
      },
      "section": "## 13. Fitness potential operator",
      "raw_directive": "3871: **Proof.**\n3872: We decompose the total squared error $\\|\\mathbf{V}_1 - \\mathbf{V}_2\\|_2^2$ into contributions from two disjoint sets of walker indices: the unstable set $\\mathcal{A}_{\\text{unstable}} = \\mathcal{A}_1 \\Delta \\mathcal{A}_2$ and the stable set $\\mathcal{A}_{\\text{stable}} = \\mathcal{A}_1 \\cap \\mathcal{A}_2$. Because the sets are disjoint, the error vectors are orthogonal, and the total squared norm is the sum of the squared norms of the error over each set.\n3873: $$\n3874: \n3875: \\|\\mathbf{V}_1 - \\mathbf{V}_2\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} |V_{1,i} - V_{2,i}|^2 + \\sum_{i \\in \\mathcal{A}_{\\text{stable}}} |V_{1,i} - V_{2,i}|^2\n3876: \n3877: $$\n3878: We take the expectation of both sides. By linearity of expectation, the total expected squared error is the sum of the expected squared errors over these two partitions. We define the first term as the expected error from unstable walkers, $E^2_{\\text{unstable,ms}}$, and the second term as the expected error from stable walkers, $E^2_{\\text{stable,ms}}$. The subsequent lemmas provide bounds for these terms.\n3879: **Q.E.D.**\n3880: :::\n3881: #### 12.2.4. Sub-Lemma: Bounding the Expected Error from Unstable Walkers",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 13,
        "chapter_file": "chapter_13.json",
        "section_id": "## 13. Fitness potential operator"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sub-perturbation-positional-bound-reproof",
      "title": "Bounding the Output Positional Displacement",
      "start_line": 4041,
      "end_line": 4050,
      "header_lines": [
        4042
      ],
      "content_start": 4043,
      "content_end": 4049,
      "content": "4043: \n4044: M_{\\text{pert}}^2 \\ge \\sup_{x_{\\text{in}} \\in \\mathcal{X}} \\mathbb{E}[Y]\n4045: \n4046: $$\n4047: *   **Framework Application:** This axiom provides a uniform bound on the *mean* of the random displacement. The *fluctuations* around this mean are bounded via **McDiarmid’s inequality** for functions of independent inputs (Assumption A), applied to the average of per‑walker squared displacements. Bounded differences hold with constants $c_i=D_{\\mathcal{Y}}^2/N$ since each term lies in $[0,D_{\\mathcal{Y}}^2]$ (finite diameter). No further variance assumptions are required. See Boucheron–Lugosi–Massart (Appendix B).\n4048: *   **Failure Mode Analysis:** If this axiom is violated (i.e., if the supremum is infinite), walkers could be displaced by an infinite amount on average, making the operator's behavior unpredictable and breaking the continuity guarantees.\n4049: :::",
      "metadata": {
        "label": "lem-sub-perturbation-positional-bound-reproof"
      },
      "section": "## 14. The Perturbation Operator",
      "raw_directive": "4041: *   **Condition:** For any starting position $x_{\\text{in}} \\in \\mathcal{X}$, let the random variable for the squared displacement be $Y := d_{\\mathcal{Y}}(\\varphi(x_{\\text{out}}), \\varphi(x_{\\text{in}}))^2$ where $x_{\\text{out}} \\sim \\mathcal{P}_\\sigma(x_{\\text{in}}, \\cdot)$. The constant must satisfy:\n4042: $$\n4043: \n4044: M_{\\text{pert}}^2 \\ge \\sup_{x_{\\text{in}} \\in \\mathcal{X}} \\mathbb{E}[Y]\n4045: \n4046: $$\n4047: *   **Framework Application:** This axiom provides a uniform bound on the *mean* of the random displacement. The *fluctuations* around this mean are bounded via **McDiarmid’s inequality** for functions of independent inputs (Assumption A), applied to the average of per‑walker squared displacements. Bounded differences hold with constants $c_i=D_{\\mathcal{Y}}^2/N$ since each term lies in $[0,D_{\\mathcal{Y}}^2]$ (finite diameter). No further variance assumptions are required. See Boucheron–Lugosi–Massart (Appendix B).\n4048: *   **Failure Mode Analysis:** If this axiom is violated (i.e., if the supremum is infinite), walkers could be displaced by an infinite amount on average, making the operator's behavior unpredictable and breaking the continuity guarantees.\n4049: :::\n4050: #### 13.2.2. Bounding the Output Positional Displacement",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## 14. The Perturbation Operator"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-bounded-differences-favg",
      "title": "Bounded differences for $f_{\\text{avg}}$",
      "start_line": 4075,
      "end_line": 4079,
      "header_lines": [
        4076
      ],
      "content_start": 4078,
      "content_end": 4078,
      "content": "4078: For clarity, we analyze the normalized functional",
      "metadata": {
        "label": "lem-bounded-differences-favg"
      },
      "section": "## 14. The Perturbation Operator",
      "raw_directive": "4075: #### 13.2.3. Concentration Inequality for Total Perturbation-Induced Displacement\n4076: The algebraic bound from the previous section shows that the final positional displacement depends on the random variable $\\Delta_{\\text{pert}}^2(\\mathcal{S})$. To establish a probabilistic continuity bound, we must find a high-probability bound for this random variable. The term $\\Delta_{\\text{pert}}^2(\\mathcal{S})$ is a sum of the **N** random squared displacements of each walker, which are statistically independent for a fixed initial state $\\mathcal{S}$. This allows us to apply a concentration inequality for functions of independent random variables to bound its deviation from its expected value. We will use McDiarmid's Inequality.\n4077: ##### 13.2.3.0. Inputs and Lipschitz constants for McDiarmid\n4078: For clarity, we analyze the normalized functional\n4079: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## 14. The Perturbation Operator"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sub-probabilistic-bound-perturbation-displacement-reproof",
      "title": "Probabilistic Bound on Total Perturbation-Induced Displacement",
      "start_line": 4097,
      "end_line": 4106,
      "header_lines": [
        4098
      ],
      "content_start": 4099,
      "content_end": 4105,
      "content": "4099: $$\n4100: Then for any $t > 0$, the probability that the function's value deviates from its expected value by more than $t$ is bounded by:\n4101: $$\n4102: \n4103: P(|f(X_1, \\dots, X_N) - \\mathbb{E}[f(X_1, \\dots, X_N)]| \\ge t) \\le 2\\exp\\left(\\frac{-2t^2}{\\sum_{i=1}^N c_i^2}\\right)\n4104: \n4105: $$",
      "metadata": {
        "label": "lem-sub-probabilistic-bound-perturbation-displacement-reproof"
      },
      "section": "## 14. The Perturbation Operator",
      "raw_directive": "4097: \\sup_{x_1, \\dots, x_N, x'_i} |f(x_1, \\dots, x_i, \\dots, x_N) - f(x_1, \\dots, x'_i, \\dots, x_N)| \\le c_i\n4098: \n4099: $$\n4100: Then for any $t > 0$, the probability that the function's value deviates from its expected value by more than $t$ is bounded by:\n4101: $$\n4102: \n4103: P(|f(X_1, \\dots, X_N) - \\mathbb{E}[f(X_1, \\dots, X_N)]| \\ge t) \\le 2\\exp\\left(\\frac{-2t^2}{\\sum_{i=1}^N c_i^2}\\right)\n4104: \n4105: $$\n4106: :::",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## 14. The Perturbation Operator"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cloning-probability-lipschitz",
      "title": "Lipschitz Continuity of the Conditional Cloning Probability Function (case split)",
      "start_line": 4381,
      "end_line": 4402,
      "header_lines": [
        4382
      ],
      "content_start": 4383,
      "content_end": 4401,
      "content": "4383: The **Conditional Cloning Probability Function**, denoted $\\pi: \\mathbb{R}_{\\ge 0} \\times \\mathbb{R}_{\\ge 0} \\to [0, 1]$, maps the fitness potential of a companion ($v_c$) and a primary walker ($v_i$) to the probability that the \"Clone\" action is selected.\n4384: Given that the score is $S(v_c, v_i)$ and the threshold is $T_{\\text{clone}} \\sim \\text{Uniform}(0, p_{\\max})$, the probability is:\n4385: $$\n4386: \n4387: \\pi(v_c, v_i) := P(S(v_c, v_i) > T_{\\text{clone}}) = \\min\\left(1, \\max\\left(0, \\frac{S(v_c, v_i)}{p_{\\max}}\\right)\\right)\n4388: \n4389: $$\n4390: This function effectively clips the normalized score to the valid probability range $[0, 1]$.\n4391: :::\n4392: :::{prf:lemma} Lipschitz Continuity of the Conditional Cloning Probability Function (case split)\n4393: :label: lem-cloning-probability-lipschitz\n4394: The **Conditional Cloning Probability Function** $\\pi(v_c, v_i)$ is Lipschitz continuous with respect to its two inputs. For any two pairs of potentials $(v_{c1}, v_{i1})$ and $(v_{c2}, v_{i2})$:\n4395: $$\n4396: \n4397: |\\pi(v_{c1}, v_{i1}) - \\pi(v_{c2}, v_{i2})| \\le L_{\\pi,c}|v_{c1} - v_{c2}| + L_{\\pi,i}|v_{i1} - v_{i2}|\n4398: \n4399: $$\n4400: where the **Cloning Probability Lipschitz Constants** can be chosen uniformly over both alive and dead walkers by the worst‑case (dead‑walker) bounds:\n4401: *   **Companion Potential Lipschitz Constant ($L_{\\pi,c}$):**",
      "metadata": {
        "label": "lem-cloning-probability-lipschitz"
      },
      "section": "## 16. The Cloning Transition Measure",
      "raw_directive": "4381: :::{prf:definition} The Conditional Cloning Probability Function\n4382: :label: def-cloning-probability-function\n4383: The **Conditional Cloning Probability Function**, denoted $\\pi: \\mathbb{R}_{\\ge 0} \\times \\mathbb{R}_{\\ge 0} \\to [0, 1]$, maps the fitness potential of a companion ($v_c$) and a primary walker ($v_i$) to the probability that the \"Clone\" action is selected.\n4384: Given that the score is $S(v_c, v_i)$ and the threshold is $T_{\\text{clone}} \\sim \\text{Uniform}(0, p_{\\max})$, the probability is:\n4385: $$\n4386: \n4387: \\pi(v_c, v_i) := P(S(v_c, v_i) > T_{\\text{clone}}) = \\min\\left(1, \\max\\left(0, \\frac{S(v_c, v_i)}{p_{\\max}}\\right)\\right)\n4388: \n4389: $$\n4390: This function effectively clips the normalized score to the valid probability range $[0, 1]$.\n4391: :::\n4392: :::{prf:lemma} Lipschitz Continuity of the Conditional Cloning Probability Function (case split)\n4393: :label: lem-cloning-probability-lipschitz\n4394: The **Conditional Cloning Probability Function** $\\pi(v_c, v_i)$ is Lipschitz continuous with respect to its two inputs. For any two pairs of potentials $(v_{c1}, v_{i1})$ and $(v_{c2}, v_{i2})$:\n4395: $$\n4396: \n4397: |\\pi(v_{c1}, v_{i1}) - \\pi(v_{c2}, v_{i2})| \\le L_{\\pi,c}|v_{c1} - v_{c2}| + L_{\\pi,i}|v_{i1} - v_{i2}|\n4398: \n4399: $$\n4400: where the **Cloning Probability Lipschitz Constants** can be chosen uniformly over both alive and dead walkers by the worst‑case (dead‑walker) bounds:\n4401: *   **Companion Potential Lipschitz Constant ($L_{\\pi,c}$):**\n4402: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 16,
        "chapter_file": "chapter_16.json",
        "section_id": "## 16. The Cloning Transition Measure"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sub-bound-sum-total-cloning-probs",
      "title": "Bounding the Sum of Total Cloning Probabilities",
      "start_line": 4589,
      "end_line": 4603,
      "header_lines": [
        4590
      ],
      "content_start": 4592,
      "content_end": 4602,
      "content": "4592:     \\mathbb{E}[d_{\\text{out}}^2] \\le \\left(3 + \\frac{3D_{\\mathcal{Y}}^2 C_P}{N}\\right)V_{\\text{in}} + \\left(\\frac{3D_{\\mathcal{Y}}^2 H_P}{N}\\right)\\sqrt{V_{\\text{in}}} + \\frac{3D_{\\mathcal{Y}}^2 K_P}{N}\n4593: \n4594: \n4595: $$\n4596: This expression is of the required form $C_L V + C_H sqrt(V) + K$. By inspection, we can identify the coefficients $C_{\\text{clone},L}$, $C_{\\text{clone},H}$, and $K_{\\text{clone}}$ from this final expression. This completes the proof.\n4597: **Q.E.D.**\n4598: :::\n4599: ##### 15.2.8.3. Sub-Lemma: Bounding the Sum of Total Cloning Probabilities\n4600: :::{prf:lemma} Bounding the Sum of Total Cloning Probabilities\n4601: :label: lem-sub-bound-sum-total-cloning-probs\n4602: ",
      "metadata": {
        "label": "lem-sub-bound-sum-total-cloning-probs"
      },
      "section": "## 16. The Cloning Transition Measure",
      "raw_directive": "4589: Finally, we divide by **N** to get the bound on the expected output squared metric, $\\mathbb{E}[d_{\\text{Disp},\\mathcal{Y}}(\\mathcal{S}'_1, \\mathcal{S}'_2)^2]$:\n4590: $$\n4591: \n4592:     \\mathbb{E}[d_{\\text{out}}^2] \\le \\left(3 + \\frac{3D_{\\mathcal{Y}}^2 C_P}{N}\\right)V_{\\text{in}} + \\left(\\frac{3D_{\\mathcal{Y}}^2 H_P}{N}\\right)\\sqrt{V_{\\text{in}}} + \\frac{3D_{\\mathcal{Y}}^2 K_P}{N}\n4593: \n4594: \n4595: $$\n4596: This expression is of the required form $C_L V + C_H sqrt(V) + K$. By inspection, we can identify the coefficients $C_{\\text{clone},L}$, $C_{\\text{clone},H}$, and $K_{\\text{clone}}$ from this final expression. This completes the proof.\n4597: **Q.E.D.**\n4598: :::\n4599: ##### 15.2.8.3. Sub-Lemma: Bounding the Sum of Total Cloning Probabilities\n4600: :::{prf:lemma} Bounding the Sum of Total Cloning Probabilities\n4601: :label: lem-sub-bound-sum-total-cloning-probs\n4602: \n4603: Let $\\mathcal{S}_1$ and $\\mathcal{S}_2$ be two swarm states. Let $V_{\\text{in}} := d_{\\text{Disp},\\mathcal{Y}}(\\mathcal{S}_1, \\mathcal{S}_2)^2$ be the initial squared displacement.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_fragile_gas_framework",
        "chapter_index": 16,
        "chapter_file": "chapter_16.json",
        "section_id": "## 16. The Cloning Transition Measure"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-dynamics-regularity",
      "title": "Regularity of the MDLGT Dynamics",
      "start_line": 144,
      "end_line": 158,
      "header_lines": [
        145
      ],
      "content_start": 147,
      "content_end": 157,
      "content": "147: :label: lem-dynamics-regularity\n148: \n149: The MDLGT dynamics (constrained Langevin + heat bath) are well-defined on $\\Sigma_N$ despite the fiber bundle singularities.\n150: \n151: **Proof Sketch**:\n152: \n153: 1. **Node dynamics well-defined**: The gradient $\\nabla_{x_i} H$ exists and is bounded everywhere by {prf:ref}`lem-uniform-force-bounds`, since $H$ depends only on pairwise distances $\\|x_i - x_j\\|$ (smooth except at collisions, which are excluded by hard-core repulsion).\n154: \n155: 2. **Topology changes have measure zero**: The constrained Langevin dynamics induce a continuous diffusion on $\\mathcal{B}_N$. The set of co-spherical configurations is an algebraic variety of codimension $\\geq 1$ in $\\mathbb{R}^{4N}$, hence has Lebesgue measure zero. Under the diffusion, such sets are visited with probability zero.\n156: \n157: 3. **Gauge field updates well-defined**: For any fixed node configuration $\\mathbf{x}$, the heat bath algorithm samples from the conditional Boltzmann distribution on $(\\text{SU}(N_c))^{E_N(\\mathbf{x})}$, which is well-defined by compactness of SU($N_c$).",
      "metadata": {
        "label": "lem-dynamics-regularity"
      },
      "section": "## The Minimal Dynamic Lattice Gauge Theory (MDLGT)",
      "raw_directive": "144: :::\n145: \n146: :::{prf:lemma} Regularity of the MDLGT Dynamics\n147: :label: lem-dynamics-regularity\n148: \n149: The MDLGT dynamics (constrained Langevin + heat bath) are well-defined on $\\Sigma_N$ despite the fiber bundle singularities.\n150: \n151: **Proof Sketch**:\n152: \n153: 1. **Node dynamics well-defined**: The gradient $\\nabla_{x_i} H$ exists and is bounded everywhere by {prf:ref}`lem-uniform-force-bounds`, since $H$ depends only on pairwise distances $\\|x_i - x_j\\|$ (smooth except at collisions, which are excluded by hard-core repulsion).\n154: \n155: 2. **Topology changes have measure zero**: The constrained Langevin dynamics induce a continuous diffusion on $\\mathcal{B}_N$. The set of co-spherical configurations is an algebraic variety of codimension $\\geq 1$ in $\\mathbb{R}^{4N}$, hence has Lebesgue measure zero. Under the diffusion, such sets are visited with probability zero.\n156: \n157: 3. **Gauge field updates well-defined**: For any fixed node configuration $\\mathbf{x}$, the heat bath algorithm samples from the conditional Boltzmann distribution on $(\\text{SU}(N_c))^{E_N(\\mathbf{x})}$, which is well-defined by compactness of SU($N_c$).\n158: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_yang_mills_dynamic_lattice",
        "chapter_index": 1,
        "chapter_file": "chapter_1.json",
        "section_id": "## The Minimal Dynamic Lattice Gauge Theory (MDLGT)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniform-force-bounds",
      "title": "Uniform Force Bounds",
      "start_line": 548,
      "end_line": 568,
      "header_lines": [
        549
      ],
      "content_start": 551,
      "content_end": 567,
      "content": "551: :label: lem-uniform-force-bounds\n552: \n553: For any configuration satisfying the hard-core constraint $\\min_{i \\neq j}\\|x_i - x_j\\| \\geq r_{\\min}$:\n554: \n555: 1. **Node forces are uniformly bounded**:\n556: \n557: $$\n558: \\sup_{\\mathbf{x} : \\min_{i \\neq j}\\|x_i - x_j\\| \\geq r_{\\min}} \\|\\nabla_{x_i} H_{\\text{nodes}}(\\mathbf{x})\\| \\leq C_F(N) := (N-1) \\sup_{r > 0} |V'_{\\text{pair}}(r)| < \\infty\n559: \n560: $$\n561: \n562: 2. **Gauge forces are bounded for any gauge field**:\n563: \n564: $$\n565: \\sup_{\\mathbf{x}, \\mathbf{U} : \\min_{i \\neq j}\\|x_i - x_j\\| \\geq r_{\\min}} \\|\\nabla_{x_i} H_{\\text{gauge}}(\\mathbf{x}, \\mathbf{U})\\| \\leq C_G(N, N_c, \\beta_{\\text{gauge}}, r_{\\min}) < \\infty\n566: \n567: $$",
      "metadata": {
        "label": "lem-uniform-force-bounds"
      },
      "section": "## Proof of Theorem 1: Invariant Measure Existence",
      "raw_directive": "548: **Step 2: Deterministic Force Bounds**\n549: \n550: :::{prf:lemma} Uniform Force Bounds\n551: :label: lem-uniform-force-bounds\n552: \n553: For any configuration satisfying the hard-core constraint $\\min_{i \\neq j}\\|x_i - x_j\\| \\geq r_{\\min}$:\n554: \n555: 1. **Node forces are uniformly bounded**:\n556: \n557: $$\n558: \\sup_{\\mathbf{x} : \\min_{i \\neq j}\\|x_i - x_j\\| \\geq r_{\\min}} \\|\\nabla_{x_i} H_{\\text{nodes}}(\\mathbf{x})\\| \\leq C_F(N) := (N-1) \\sup_{r > 0} |V'_{\\text{pair}}(r)| < \\infty\n559: \n560: $$\n561: \n562: 2. **Gauge forces are bounded for any gauge field**:\n563: \n564: $$\n565: \\sup_{\\mathbf{x}, \\mathbf{U} : \\min_{i \\neq j}\\|x_i - x_j\\| \\geq r_{\\min}} \\|\\nabla_{x_i} H_{\\text{gauge}}(\\mathbf{x}, \\mathbf{U})\\| \\leq C_G(N, N_c, \\beta_{\\text{gauge}}, r_{\\min}) < \\infty\n566: \n567: $$\n568: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_yang_mills_dynamic_lattice",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## Proof of Theorem 1: Invariant Measure Existence"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-gauge-force-bound",
      "title": "Bounded Gradient of Plaquette Weights",
      "start_line": 593,
      "end_line": 608,
      "header_lines": [
        594
      ],
      "content_start": 596,
      "content_end": 607,
      "content": "596: :label: lem-gauge-force-bound\n597: \n598: For triangular plaquettes $\\Delta$ in a Delaunay triangulation satisfying:\n599: - Hard-core exclusion: edge lengths in $[r_{\\min}, R_{\\text{cut}}]$\n600: - Shape regularity: aspect ratio $\\rho(\\Delta) \\leq \\rho_{\\max}$, area $A(\\Delta) \\geq A_{\\min}$\n601: \n602: the gradient of the weight function $w(\\Delta) = \\exp(−(\\rho(\\Delta) − 1)^2/(2\\sigma_{\\text{shape}}^2))$ satisfies:\n603: \n604: $$\n605: \\|\\nabla_{x_i} w(\\Delta)\\| \\leq C_w(\\rho_{\\max}, r_{\\min}, R_{\\text{cut}}, A_{\\min}, \\sigma_{\\text{shape}})\n606: \n607: $$",
      "metadata": {
        "label": "lem-gauge-force-bound"
      },
      "section": "## Proof of Theorem 1: Invariant Measure Existence",
      "raw_directive": "593: For the gauge field term, we first establish that the weight gradient is bounded:\n594: \n595: :::{prf:lemma} Bounded Gradient of Plaquette Weights\n596: :label: lem-gauge-force-bound\n597: \n598: For triangular plaquettes $\\Delta$ in a Delaunay triangulation satisfying:\n599: - Hard-core exclusion: edge lengths in $[r_{\\min}, R_{\\text{cut}}]$\n600: - Shape regularity: aspect ratio $\\rho(\\Delta) \\leq \\rho_{\\max}$, area $A(\\Delta) \\geq A_{\\min}$\n601: \n602: the gradient of the weight function $w(\\Delta) = \\exp(−(\\rho(\\Delta) − 1)^2/(2\\sigma_{\\text{shape}}^2))$ satisfies:\n603: \n604: $$\n605: \\|\\nabla_{x_i} w(\\Delta)\\| \\leq C_w(\\rho_{\\max}, r_{\\min}, R_{\\text{cut}}, A_{\\min}, \\sigma_{\\text{shape}})\n606: \n607: $$\n608: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_yang_mills_dynamic_lattice",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## Proof of Theorem 1: Invariant Measure Existence"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-strong-coupling-random",
      "title": "Strong-Coupling Mass Gap for Shape-Regular Random Lattices",
      "start_line": 827,
      "end_line": 846,
      "header_lines": [
        828
      ],
      "content_start": 830,
      "content_end": 845,
      "content": "830: :label: lem-strong-coupling-random\n831: \n832: **Sketch: expansion into full proof in progress (estimated 30-50 pages)**\n833: \n834: Consider an ensemble of lattices with the following properties:\n835: - Bounded coordination $K$\n836: - Edge lengths in $[r_{\\min}, R_{\\text{cut}}]$\n837: - Simplex aspect ratio $\\leq \\rho_{\\max}$\n838: - Plaquette area $\\geq A_{\\min}$\n839: \n840: Then there exists a critical coupling $\\beta_c = \\beta_c(K, r_{\\min}, R_{\\text{cut}}, \\rho_{\\max}, A_{\\min}) > 0$ such that for all $\\beta_{\\text{gauge}} < \\beta_c$, the ensemble-averaged Wilson loop observables satisfy:\n841: \n842: $$\n843: \\mathbb{E}_{\\text{lattice}}\\left[\\langle W_C \\rangle_{\\text{gauge}}\\right] \\leq e^{-\\Delta_{\\text{eff}} \\cdot \\text{Area}(C)}\n844: \n845: $$",
      "metadata": {
        "label": "lem-strong-coupling-random"
      },
      "section": "## Proof of Theorem 2: Finite-N Mass Gap",
      "raw_directive": "827: With shape-regularity established, we can now extend Wilson's theorem.\n828: \n829: :::{prf:lemma} Strong-Coupling Mass Gap for Shape-Regular Random Lattices\n830: :label: lem-strong-coupling-random\n831: \n832: **Sketch: expansion into full proof in progress (estimated 30-50 pages)**\n833: \n834: Consider an ensemble of lattices with the following properties:\n835: - Bounded coordination $K$\n836: - Edge lengths in $[r_{\\min}, R_{\\text{cut}}]$\n837: - Simplex aspect ratio $\\leq \\rho_{\\max}$\n838: - Plaquette area $\\geq A_{\\min}$\n839: \n840: Then there exists a critical coupling $\\beta_c = \\beta_c(K, r_{\\min}, R_{\\text{cut}}, \\rho_{\\max}, A_{\\min}) > 0$ such that for all $\\beta_{\\text{gauge}} < \\beta_c$, the ensemble-averaged Wilson loop observables satisfy:\n841: \n842: $$\n843: \\mathbb{E}_{\\text{lattice}}\\left[\\langle W_C \\rangle_{\\text{gauge}}\\right] \\leq e^{-\\Delta_{\\text{eff}} \\cdot \\text{Area}(C)}\n844: \n845: $$\n846: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_yang_mills_dynamic_lattice",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## Proof of Theorem 2: Finite-N Mass Gap"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-reflection-positivity-symmetrized",
      "title": "Reflection Positivity via Symmetrized Configurations",
      "start_line": 1133,
      "end_line": 1139,
      "header_lines": [
        1134
      ],
      "content_start": 1136,
      "content_end": 1138,
      "content": "1136: :label: lem-reflection-positivity-symmetrized\n1137: \n1138: **Sketch: expansion into full proof in progress (estimated 20-40 pages)**",
      "metadata": {
        "label": "lem-reflection-positivity-symmetrized"
      },
      "section": "## Proof of Theorem 4: Osterwalder-Schrader Axioms",
      "raw_directive": "1133: This is the most technically challenging axiom. The key steps are:\n1134: \n1135: :::{prf:lemma} Reflection Positivity via Symmetrized Configurations\n1136: :label: lem-reflection-positivity-symmetrized\n1137: \n1138: **Sketch: expansion into full proof in progress (estimated 20-40 pages)**\n1139: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_yang_mills_dynamic_lattice",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## Proof of Theorem 4: Osterwalder-Schrader Axioms"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-clustering",
      "title": "Clustering from Mass Gap",
      "start_line": 1204,
      "end_line": 1215,
      "header_lines": [
        1205
      ],
      "content_start": 1207,
      "content_end": 1214,
      "content": "1207: :label: lem-clustering\n1208: \n1209: The mass gap $\\Delta > 0$ established in {prf:ref}`thm-continuum-limit` implies exponential decay of correlation functions:\n1210: \n1211: $$\n1212: |\\langle W_{C_1} W_{C_2} \\rangle - \\langle W_{C_1}\\rangle \\langle W_{C_2}\\rangle| \\leq C e^{-\\Delta \\cdot d(C_1, C_2)}\n1213: \n1214: $$",
      "metadata": {
        "label": "lem-clustering"
      },
      "section": "## Proof of Theorem 4: Osterwalder-Schrader Axioms",
      "raw_directive": "1204: **OS3: Cluster Property (Exponential Decay)**\n1205: \n1206: :::{prf:lemma} Clustering from Mass Gap\n1207: :label: lem-clustering\n1208: \n1209: The mass gap $\\Delta > 0$ established in {prf:ref}`thm-continuum-limit` implies exponential decay of correlation functions:\n1210: \n1211: $$\n1212: |\\langle W_{C_1} W_{C_2} \\rangle - \\langle W_{C_1}\\rangle \\langle W_{C_2}\\rangle| \\leq C e^{-\\Delta \\cdot d(C_1, C_2)}\n1213: \n1214: $$\n1215: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "01_yang_mills_dynamic_lattice",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## Proof of Theorem 4: Osterwalder-Schrader Axioms"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-kinetic-lipschitz",
      "title": "Lipschitz property of the kinetic flow",
      "start_line": 555,
      "end_line": 610,
      "header_lines": [
        556
      ],
      "content_start": 558,
      "content_end": 609,
      "content": "558: :label: lem-sasaki-kinetic-lipschitz\n559: \n560: For $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and any $\\xi_v,\\xi_x\\in\\mathbb R^d$ define\n561: \n562: $$\n563: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\big(v+\\tfrac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n564: \n565: $$\n566: Then\n567: \n568: $$\n569: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')),\\qquad L_{\\mathrm{flow}}:=1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}.\n570: \n571: $$\n572: \n573: ```{dropdown} Proof\n574: :::{prf:proof}\n575: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and $\\xi_v,\\xi_x\\in\\mathbb R^d$. Define the uncapped velocities\n576: \n577: $$\n578: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad\\tilde v':=v'+\\frac{\\tau}{m}F(x')-\\gamma_{\\mathrm{fric}}\\tau\\big(v'-u(x')\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n579: \n580: $$\n581: \n582: Because the same velocity noise $\\xi_v$ appears in both expressions, it cancels in the difference $\\tilde v-\\tilde v'$. We bound the displacement in four steps.\n583: \n584: 1. **Uncapped velocity difference.** Using the triangle inequality, the Lipschitz constant $L_F$ of $F$, and the Lipschitz constant $L_u$ of $u$, we obtain\n585: \n586: $$\n587: \\begin{aligned}\n588: \\|\\tilde v-\\tilde v'\\|&\\le \\|v-v'\\|+\\frac{\\tau}{m}\\|F(x)-F(x')\\|+\\gamma_{\\mathrm{fric}}\\tau\\|v-v'\\|+\\gamma_{\\mathrm{fric}}\\tau\\|u(x)-u(x')\\|\\\\\n589: &\\le(1+\\gamma_{\\mathrm{fric}}\\tau)\\,\\|v-v'\\|+\\Big(\\frac{\\tau}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau L_u\\Big)\\,\\|x-x'\\|.\n590: \\end{aligned}\n591: \n592: $$\n593: \n594: 2. **Lipschitz projection.** Lemma {prf:ref}`lem-squashing-properties-generic` shows the smooth squashing map $\\psi_v$ is $1$-Lipschitz, so the same inequality holds for the capped velocities $v^+:=\\psi_v(\\tilde v)$ and $v'^+:=\\psi_v(\\tilde v')$.\n595: \n596: 3. **Position update.** The Euler step sets $x^+:=x+\\tau v^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ and $x'^+:=x'+\\tau v'^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Hence\n597: \n598: $$\n599: \\|x^+-x'^+\\|\\le\\|x-x'\\|+\\tau\\,\\|v^+-v'^+\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u\\Big)\\|x-x'\\|+\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)\\|v-v'\\|.\n600: \n601: $$\n602: \n603: 4. **Express via the Sasaki metric.** The Sasaki distance satisfies $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))^2=\\|x-x'\\|^2+\\lambda_v\\|v-v'\\|^2$, so $\\|x-x'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ and $\\|v-v'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}/\\sqrt{\\lambda_v}$. Substituting these bounds into the inequality from Step 3 yields\n604: \n605: $$\n606: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}\\Big) d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')).\n607: \n608: $$\n609: ",
      "metadata": {
        "label": "lem-sasaki-kinetic-lipschitz"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "555: 2. **Boundary regularity & smoothness.** Lemma {prf:ref}`lem-euclidean-boundary-holder` bounds the death probability with explicit Hölder constants, verifying the boundary axioms ({prf:ref}`def-axiom-boundary-regularity`, {prf:ref}`def-axiom-boundary-smoothness`).\n556: \n557: :::{prf:lemma} Lipschitz property of the kinetic flow\n558: :label: lem-sasaki-kinetic-lipschitz\n559: \n560: For $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and any $\\xi_v,\\xi_x\\in\\mathbb R^d$ define\n561: \n562: $$\n563: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\big(v+\\tfrac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n564: \n565: $$\n566: Then\n567: \n568: $$\n569: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')),\\qquad L_{\\mathrm{flow}}:=1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}.\n570: \n571: $$\n572: \n573: ```{dropdown} Proof\n574: :::{prf:proof}\n575: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and $\\xi_v,\\xi_x\\in\\mathbb R^d$. Define the uncapped velocities\n576: \n577: $$\n578: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad\\tilde v':=v'+\\frac{\\tau}{m}F(x')-\\gamma_{\\mathrm{fric}}\\tau\\big(v'-u(x')\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n579: \n580: $$\n581: \n582: Because the same velocity noise $\\xi_v$ appears in both expressions, it cancels in the difference $\\tilde v-\\tilde v'$. We bound the displacement in four steps.\n583: \n584: 1. **Uncapped velocity difference.** Using the triangle inequality, the Lipschitz constant $L_F$ of $F$, and the Lipschitz constant $L_u$ of $u$, we obtain\n585: \n586: $$\n587: \\begin{aligned}\n588: \\|\\tilde v-\\tilde v'\\|&\\le \\|v-v'\\|+\\frac{\\tau}{m}\\|F(x)-F(x')\\|+\\gamma_{\\mathrm{fric}}\\tau\\|v-v'\\|+\\gamma_{\\mathrm{fric}}\\tau\\|u(x)-u(x')\\|\\\\\n589: &\\le(1+\\gamma_{\\mathrm{fric}}\\tau)\\,\\|v-v'\\|+\\Big(\\frac{\\tau}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau L_u\\Big)\\,\\|x-x'\\|.\n590: \\end{aligned}\n591: \n592: $$\n593: \n594: 2. **Lipschitz projection.** Lemma {prf:ref}`lem-squashing-properties-generic` shows the smooth squashing map $\\psi_v$ is $1$-Lipschitz, so the same inequality holds for the capped velocities $v^+:=\\psi_v(\\tilde v)$ and $v'^+:=\\psi_v(\\tilde v')$.\n595: \n596: 3. **Position update.** The Euler step sets $x^+:=x+\\tau v^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ and $x'^+:=x'+\\tau v'^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Hence\n597: \n598: $$\n599: \\|x^+-x'^+\\|\\le\\|x-x'\\|+\\tau\\,\\|v^+-v'^+\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u\\Big)\\|x-x'\\|+\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)\\|v-v'\\|.\n600: \n601: $$\n602: \n603: 4. **Express via the Sasaki metric.** The Sasaki distance satisfies $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))^2=\\|x-x'\\|^2+\\lambda_v\\|v-v'\\|^2$, so $\\|x-x'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ and $\\|v-v'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}/\\sqrt{\\lambda_v}$. Substituting these bounds into the inequality from Step 3 yields\n604: \n605: $$\n606: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}\\Big) d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')).\n607: \n608: $$\n609: \n610: The constant in parentheses is $L_{\\mathrm{flow}}$, completing the proof.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-boundary-holder",
      "title": "Hölder continuity of the death probability",
      "start_line": 612,
      "end_line": 727,
      "header_lines": [
        613
      ],
      "content_start": 615,
      "content_end": 726,
      "content": "615: :label: lem-euclidean-boundary-holder\n616: \n617: ```{dropdown} Proof\n618: :::{prf:proof}\n619: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and set $\\Delta:=d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))$. Let $C$ be any compact subset of $\\mathbb R^d$ containing $x$ and $x'$, so that the local constants from Lemma {prf:ref}`lem-euclidean-geometric-consistency` apply uniformly on $C$. For independent $\\xi_v,\\xi_x\\sim\\mathcal N(0,I_d)$ define\n620: \n621: $$\n622: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\Big(v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\Big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n623: \n624: $$\n625: \n626: Lemma {prf:ref}`lem-sasaki-kinetic-lipschitz` delivers $\\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,\\Delta$ almost surely. Consequently\n627: \n628: $$\n629: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)+\\mathbb P\\big(\\Phi_{x',v'}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big).\n630: \n631: $$\n632: \n633: We bound the first term; the second is identical with primed variables.\n634: \n635: 1. **Tubular neighbourhood volume.** Because $\\partial\\mathcal X_{\\mathrm{valid}}$ is $C^1$ with bounded curvature, the tubular-neighbourhood theorem (\\[Federer 69, §4.18\\]) provides $\\varepsilon_{\\mathrm{tube}}>0$ and\n636: \n637: $$\n638: C_{\\partial}:=\\sup_{0<\\varepsilon\\le\\varepsilon_{\\mathrm{tube}}}\\frac{\\operatorname{Vol}(N_\\varepsilon(\\partial\\mathcal X_{\\mathrm{valid}}))}{\\varepsilon}<\\infty.\n639: \n640: $$\n641: \n642: By monotonicity it suffices to treat $L_{\\mathrm{flow}}\\Delta\\le\\varepsilon_{\\mathrm{tube}}$; otherwise the Hölder bound follows immediately.\n643: \n644: 2. **Affine Gaussian contribution (no capping).** Introduce the uncapped velocity update\n645: \n646: $$\n647: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n648: \n649: $$\n650: \n651: Then $\\tilde x:=x+\\tau\\tilde v+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ is Gaussian with mean $x+\\tau m(x,v)$, where $m(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))$, and covariance $\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)I_d$. Its density is\n652: \n653: $$\n654: p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}\\exp\\Big(-\\frac{\\|y-(x+\\tau m(x,v))\\|^2}{2\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)}\\Big).\n655: \n656: $$\n657: \n658: The density attains its supremum at the mean, yielding\n659: \n660: $$\n661: p_{\\mathrm{aff}}:=\\sup_{y\\in\\mathbb R^d}p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}.\n662: \n663: $$\n664: \n665: This constant governs the contribution of $C^c:=\\{\\|\\tilde v\\|\\le V_{\\mathrm{alg}}\\}$, where the velocity cap is inactive.\n666: \n667: 3. **Directional density under capping.** Let $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Lemma {prf:ref}`lem-euclidean-geometric-consistency` gives $\\mathbb P(E)\\le\\rho_*(C)$. On $E$ write $\\tilde v=ru$ with $r>V_{\\mathrm{alg}}$ and $u\\in S^{d-1}$. The capped velocity is $v^+=V_{\\mathrm{alg}}u$, whose conditional density equals\n668: \n669: $$\n670: g(u)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\int_{V_{\\mathrm{alg}}}^{\\infty}\\exp\\Big(-\\frac{\\|ru-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big) r^{d-1}\\,dr.\n671: \n672: $$\n673: \n674: The local bounds on $F$ and $u$ over $C$ imply\n675: \n676: $$\n677: \\|m(x,v)\\|\\le M_{\\mathrm{kin}}(C).\n678: \n679: $$\n680: \n681: For $r\\ge V_{\\mathrm{alg}}$ the inequality $\\|a-b\\|^2\\ge\\tfrac{1}{2}\\|a\\|^2-\\|b\\|^2$ yields\n682: \n683: $$\n684: \\|ru-m(x,v)\\|^2\\ge\\frac{r^2}{2}-M_{\\mathrm{kin}}(C)^2.\n685: \n686: $$\n687: \n688: Substituting into $g(u)$ and changing variables via $s=r^2/(4\\sigma_v^2\\tau)$ produces\n689: \n690: $$\n691: g(u)\\le\\frac{\\exp(M_{\\mathrm{kin}}(C)^2/(2\\sigma_v^2\\tau))}{(2\\pi\\sigma_v^2\\tau)^{d/2}}(2\\sigma_v^2\\tau)^{d/2}\\Gamma\\Big(\\frac{d}{2},\\frac{V_{\\mathrm{alg}}^2}{4\\sigma_v^2\\tau}\\Big)=:q_{\\mathrm{dir}}(C),\n692: \n693: $$\n694: \n695: where $\\Gamma(\\cdot,\\cdot)$ is the upper incomplete gamma function. Thus the capped direction has uniformly bounded density.\n696: \n697: 4. **Probability of hitting the tube.** For any Borel $A\\subseteq\\mathcal X$ split according to $E$:\n698: \n699: $$\n700: \\begin{aligned}\n701: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\big)&=\\mathbb P(E^c)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E^c\\big)+\\mathbb P(E)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E\\big)\\\\\n702: &\\le p_{\\mathrm{aff}}\\operatorname{Vol}(A)+\\rho_*(C) q_{\\mathrm{dir}}(C)\\operatorname{Vol}(A).\n703: \\end{aligned}\n704: \n705: $$\n706: \n707: Taking $A=N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})$ and using Step 1 yields\n708: \n709: $$\n710: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)\\le\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n711: \n712: $$\n713: \n714: Combining the two probabilities shows\n715: \n716: $$\n717: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n718: \n719: $$\n720: \n721: Therefore $\\alpha_B^{\\mathrm{Sasaki}}=1$ with Hölder constant\n722: \n723: $$\n724: L_{\\mathrm{death}}^{\\mathrm{Sasaki}}(C):=2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}.\n725: \n726: $$",
      "metadata": {
        "label": "lem-euclidean-boundary-holder"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "612: :::\n613: \n614: :::{prf:lemma} Hölder continuity of the death probability\n615: :label: lem-euclidean-boundary-holder\n616: \n617: ```{dropdown} Proof\n618: :::{prf:proof}\n619: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and set $\\Delta:=d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))$. Let $C$ be any compact subset of $\\mathbb R^d$ containing $x$ and $x'$, so that the local constants from Lemma {prf:ref}`lem-euclidean-geometric-consistency` apply uniformly on $C$. For independent $\\xi_v,\\xi_x\\sim\\mathcal N(0,I_d)$ define\n620: \n621: $$\n622: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\Big(v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\Big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n623: \n624: $$\n625: \n626: Lemma {prf:ref}`lem-sasaki-kinetic-lipschitz` delivers $\\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,\\Delta$ almost surely. Consequently\n627: \n628: $$\n629: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)+\\mathbb P\\big(\\Phi_{x',v'}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big).\n630: \n631: $$\n632: \n633: We bound the first term; the second is identical with primed variables.\n634: \n635: 1. **Tubular neighbourhood volume.** Because $\\partial\\mathcal X_{\\mathrm{valid}}$ is $C^1$ with bounded curvature, the tubular-neighbourhood theorem (\\[Federer 69, §4.18\\]) provides $\\varepsilon_{\\mathrm{tube}}>0$ and\n636: \n637: $$\n638: C_{\\partial}:=\\sup_{0<\\varepsilon\\le\\varepsilon_{\\mathrm{tube}}}\\frac{\\operatorname{Vol}(N_\\varepsilon(\\partial\\mathcal X_{\\mathrm{valid}}))}{\\varepsilon}<\\infty.\n639: \n640: $$\n641: \n642: By monotonicity it suffices to treat $L_{\\mathrm{flow}}\\Delta\\le\\varepsilon_{\\mathrm{tube}}$; otherwise the Hölder bound follows immediately.\n643: \n644: 2. **Affine Gaussian contribution (no capping).** Introduce the uncapped velocity update\n645: \n646: $$\n647: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n648: \n649: $$\n650: \n651: Then $\\tilde x:=x+\\tau\\tilde v+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ is Gaussian with mean $x+\\tau m(x,v)$, where $m(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))$, and covariance $\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)I_d$. Its density is\n652: \n653: $$\n654: p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}\\exp\\Big(-\\frac{\\|y-(x+\\tau m(x,v))\\|^2}{2\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)}\\Big).\n655: \n656: $$\n657: \n658: The density attains its supremum at the mean, yielding\n659: \n660: $$\n661: p_{\\mathrm{aff}}:=\\sup_{y\\in\\mathbb R^d}p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}.\n662: \n663: $$\n664: \n665: This constant governs the contribution of $C^c:=\\{\\|\\tilde v\\|\\le V_{\\mathrm{alg}}\\}$, where the velocity cap is inactive.\n666: \n667: 3. **Directional density under capping.** Let $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Lemma {prf:ref}`lem-euclidean-geometric-consistency` gives $\\mathbb P(E)\\le\\rho_*(C)$. On $E$ write $\\tilde v=ru$ with $r>V_{\\mathrm{alg}}$ and $u\\in S^{d-1}$. The capped velocity is $v^+=V_{\\mathrm{alg}}u$, whose conditional density equals\n668: \n669: $$\n670: g(u)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\int_{V_{\\mathrm{alg}}}^{\\infty}\\exp\\Big(-\\frac{\\|ru-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big) r^{d-1}\\,dr.\n671: \n672: $$\n673: \n674: The local bounds on $F$ and $u$ over $C$ imply\n675: \n676: $$\n677: \\|m(x,v)\\|\\le M_{\\mathrm{kin}}(C).\n678: \n679: $$\n680: \n681: For $r\\ge V_{\\mathrm{alg}}$ the inequality $\\|a-b\\|^2\\ge\\tfrac{1}{2}\\|a\\|^2-\\|b\\|^2$ yields\n682: \n683: $$\n684: \\|ru-m(x,v)\\|^2\\ge\\frac{r^2}{2}-M_{\\mathrm{kin}}(C)^2.\n685: \n686: $$\n687: \n688: Substituting into $g(u)$ and changing variables via $s=r^2/(4\\sigma_v^2\\tau)$ produces\n689: \n690: $$\n691: g(u)\\le\\frac{\\exp(M_{\\mathrm{kin}}(C)^2/(2\\sigma_v^2\\tau))}{(2\\pi\\sigma_v^2\\tau)^{d/2}}(2\\sigma_v^2\\tau)^{d/2}\\Gamma\\Big(\\frac{d}{2},\\frac{V_{\\mathrm{alg}}^2}{4\\sigma_v^2\\tau}\\Big)=:q_{\\mathrm{dir}}(C),\n692: \n693: $$\n694: \n695: where $\\Gamma(\\cdot,\\cdot)$ is the upper incomplete gamma function. Thus the capped direction has uniformly bounded density.\n696: \n697: 4. **Probability of hitting the tube.** For any Borel $A\\subseteq\\mathcal X$ split according to $E$:\n698: \n699: $$\n700: \\begin{aligned}\n701: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\big)&=\\mathbb P(E^c)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E^c\\big)+\\mathbb P(E)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E\\big)\\\\\n702: &\\le p_{\\mathrm{aff}}\\operatorname{Vol}(A)+\\rho_*(C) q_{\\mathrm{dir}}(C)\\operatorname{Vol}(A).\n703: \\end{aligned}\n704: \n705: $$\n706: \n707: Taking $A=N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})$ and using Step 1 yields\n708: \n709: $$\n710: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)\\le\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n711: \n712: $$\n713: \n714: Combining the two probabilities shows\n715: \n716: $$\n717: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n718: \n719: $$\n720: \n721: Therefore $\\alpha_B^{\\mathrm{Sasaki}}=1$ with Hölder constant\n722: \n723: $$\n724: L_{\\mathrm{death}}^{\\mathrm{Sasaki}}(C):=2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}.\n725: \n726: $$\n727: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-reward-regularity",
      "title": "Reward regularity in the Sasaki metric",
      "start_line": 734,
      "end_line": 759,
      "header_lines": [
        735
      ],
      "content_start": 737,
      "content_end": 758,
      "content": "737: :label: lem-euclidean-reward-regularity\n738: \n739: The reward function $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ is continuous on $(\\mathcal Y,d_{\\mathcal Y}^{\\mathrm{Sasaki}})$ and therefore satisfies the Axiom of Reward Regularity ({prf:ref}`def-axiom-reward-regularity`).\n740: \n741: ```{dropdown} Proof\n742: :::{prf:proof}\n743: Let $\\mathcal Y^{\\circ}:=B(0,R_x)\\times B(0,V_{\\mathrm{alg}})$ be the image of the projection $\\varphi:\\mathbb R^d\\times\\mathbb R^d\\to\\mathcal Y^{\\circ}$. For $y=(y_x,y_v)\\in\\mathcal Y^{\\circ}$ the inverse mapping is explicit:\n744: \n745: $$\n746: \\psi_C^{-1}(y)=\\frac{C}{1-\\|y\\|/C}\\,y\\qquad(\\|y\\|<C).\n747: \n748: $$\n749: \n750: Define $R_{\\mathcal Y}:\\mathcal Y^{\\circ}\\to\\mathbb R$ by\n751: \n752: $$\n753: R_{\\mathcal Y}(y):=R_{\\mathrm{pos}}\\big(\\psi_{R_x}^{-1}(y_x)\\big)-\\lambda_{\\mathrm{vel}}\\,\\big\\|\\psi_{V_{\\mathrm{alg}}}^{-1}(y_v)\\big\\|^2.\n754: \n755: $$\n756: \n757: This is well defined because the squashing maps are bijections between $\\mathbb R^d$ and the open balls $B(0,R_x)$ and $B(0,V_{\\mathrm{alg}})$. The maps $\\psi_{R_x}^{-1}$ and $\\psi_{V_{\\mathrm{alg}}}^{-1}$ are continuous on $\\mathcal Y^{\\circ}$, and the compositions with $R_{\\mathrm{pos}}$ and the quadratic velocity term are continuous. Hence $R_{\\mathcal Y}$ is continuous on $\\mathcal Y^{\\circ}$.\n758: ",
      "metadata": {
        "label": "lem-euclidean-reward-regularity"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "734: The ambient space $(\\mathcal X,d_{\\mathcal X})$ remains Euclidean with Lebesgue reference measure, so the canonical density and integration arguments carry over ({prf:ref}`def-ambient-euclidean`). Because $\\mathcal X_{\\mathrm{valid}}$ is compact and $F=\\nabla R_{\\mathrm{pos}}$ is Lipschitz on this set, both $F$ and the auxiliary flow field $u$ are uniformly bounded; these bounds are the only ingredients required by the kinetic and boundary estimates recorded below.\n735: \n736: :::{prf:lemma} Reward regularity in the Sasaki metric\n737: :label: lem-euclidean-reward-regularity\n738: \n739: The reward function $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ is continuous on $(\\mathcal Y,d_{\\mathcal Y}^{\\mathrm{Sasaki}})$ and therefore satisfies the Axiom of Reward Regularity ({prf:ref}`def-axiom-reward-regularity`).\n740: \n741: ```{dropdown} Proof\n742: :::{prf:proof}\n743: Let $\\mathcal Y^{\\circ}:=B(0,R_x)\\times B(0,V_{\\mathrm{alg}})$ be the image of the projection $\\varphi:\\mathbb R^d\\times\\mathbb R^d\\to\\mathcal Y^{\\circ}$. For $y=(y_x,y_v)\\in\\mathcal Y^{\\circ}$ the inverse mapping is explicit:\n744: \n745: $$\n746: \\psi_C^{-1}(y)=\\frac{C}{1-\\|y\\|/C}\\,y\\qquad(\\|y\\|<C).\n747: \n748: $$\n749: \n750: Define $R_{\\mathcal Y}:\\mathcal Y^{\\circ}\\to\\mathbb R$ by\n751: \n752: $$\n753: R_{\\mathcal Y}(y):=R_{\\mathrm{pos}}\\big(\\psi_{R_x}^{-1}(y_x)\\big)-\\lambda_{\\mathrm{vel}}\\,\\big\\|\\psi_{V_{\\mathrm{alg}}}^{-1}(y_v)\\big\\|^2.\n754: \n755: $$\n756: \n757: This is well defined because the squashing maps are bijections between $\\mathbb R^d$ and the open balls $B(0,R_x)$ and $B(0,V_{\\mathrm{alg}})$. The maps $\\psi_{R_x}^{-1}$ and $\\psi_{V_{\\mathrm{alg}}}^{-1}$ are continuous on $\\mathcal Y^{\\circ}$, and the compositions with $R_{\\mathrm{pos}}$ and the quadratic velocity term are continuous. Hence $R_{\\mathcal Y}$ is continuous on $\\mathcal Y^{\\circ}$.\n758: \n759: Because $R_{\\mathcal Y}$ is continuous on $\\mathcal Y^{\\circ}$ and $\\mathcal Y^{\\circ}$ is bounded, the restriction of $R_{\\mathcal Y}$ to any compact subset of $\\mathcal Y^{\\circ}$ is uniformly continuous. In particular, the walker positions belong to the compact valid domain $\\mathcal X_{\\mathrm{valid}}$, so the image $\\varphi(\\mathcal X_{\\mathrm{valid}}\\times\\mathcal V_{\\mathrm{alg}})$ is compact and $R_{\\mathcal Y}$ is uniformly continuous (indeed, Lipschitz) on that set. Consequently the reward evaluated along the Sasaki projection is uniformly continuous, satisfying the reward-regularity axiom without invoking a global Lipschitz bound for $R_{\\mathrm{pos}}$ on $\\mathbb R^d$. :::",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-richness",
      "title": "Environmental richness with a kinetic regularizer",
      "start_line": 761,
      "end_line": 788,
      "header_lines": [
        762
      ],
      "content_start": 764,
      "content_end": 787,
      "content": "764: :label: lem-euclidean-richness\n765: \n766: The reward $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ with $\\lambda_{\\mathrm{vel}}>0$ satisfies the Axiom of Environmental Richness ({prf:ref}`def-axiom-environmental-richness`).\n767: \n768: ```{dropdown} Proof\n769: :::{prf:proof}\n770: Fix $(x_0,v_0)\\in\\mathcal Y$ and radius $r>0$. Every Sasaki ball of radius $r$ contains the set of velocities with Euclidean norm at most $r/\\sqrt{\\lambda_v}$ around $v_0$. Let\n771: \n772: $$\n773: \\delta:=\\min\\Big\\{\\frac{r}{\\sqrt{\\lambda_v}},\\,\\frac{V_{\\mathrm{alg}}}{2}\\Big\\}>0.\n774: \n775: $$\n776: Consider the two velocities $v_1:=v_0$ and $v_2:=v_0+\\delta e$, where the direction $e$ is chosen as follows:\n777: \n778: 1. If $\\|v_0\\|\\le V_{\\mathrm{alg}}-\\delta$, take $e$ orthogonal to $v_0$. Then $\\|v_2\\|^2=\\|v_0\\|^2+\\delta^2\\le V_{\\mathrm{alg}}^2$, so $v_2\\in\\mathcal V_{\\mathrm{alg}}$ and $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x_0,v_0),(x_0,v_2))=\\sqrt{\\lambda_v}\\,\\delta\\le r$.\n779: 2. If $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta$, set $e:=-v_0/\\|v_0\\|$ (if $v_0=0$, pick any unit vector). The new velocity has norm $\\|v_0\\| - \\delta\\le V_{\\mathrm{alg}}$ and again lies within the Sasaki ball.\n780: \n781: In both cases the velocities stay in the ball, and the reward difference equals\n782: \n783: $$\n784: |R(x_0,v_1)-R(x_0,v_2)|=\\lambda_{\\mathrm{vel}}\\,|\\|v_2\\|^2-\\|v_0\\|^2|\\ge \\lambda_{\\mathrm{vel}}\\,\\delta^2.\n785: \n786: $$\n787: For the inward-pointing choice we use that $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta\\ge V_{\\mathrm{alg}}/2\\ge\\delta$ because $\\delta\\le V_{\\mathrm{alg}}/2$, guaranteeing the same lower bound.",
      "metadata": {
        "label": "lem-euclidean-richness"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "761: :::\n762: \n763: :::{prf:lemma} Environmental richness with a kinetic regularizer\n764: :label: lem-euclidean-richness\n765: \n766: The reward $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ with $\\lambda_{\\mathrm{vel}}>0$ satisfies the Axiom of Environmental Richness ({prf:ref}`def-axiom-environmental-richness`).\n767: \n768: ```{dropdown} Proof\n769: :::{prf:proof}\n770: Fix $(x_0,v_0)\\in\\mathcal Y$ and radius $r>0$. Every Sasaki ball of radius $r$ contains the set of velocities with Euclidean norm at most $r/\\sqrt{\\lambda_v}$ around $v_0$. Let\n771: \n772: $$\n773: \\delta:=\\min\\Big\\{\\frac{r}{\\sqrt{\\lambda_v}},\\,\\frac{V_{\\mathrm{alg}}}{2}\\Big\\}>0.\n774: \n775: $$\n776: Consider the two velocities $v_1:=v_0$ and $v_2:=v_0+\\delta e$, where the direction $e$ is chosen as follows:\n777: \n778: 1. If $\\|v_0\\|\\le V_{\\mathrm{alg}}-\\delta$, take $e$ orthogonal to $v_0$. Then $\\|v_2\\|^2=\\|v_0\\|^2+\\delta^2\\le V_{\\mathrm{alg}}^2$, so $v_2\\in\\mathcal V_{\\mathrm{alg}}$ and $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x_0,v_0),(x_0,v_2))=\\sqrt{\\lambda_v}\\,\\delta\\le r$.\n779: 2. If $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta$, set $e:=-v_0/\\|v_0\\|$ (if $v_0=0$, pick any unit vector). The new velocity has norm $\\|v_0\\| - \\delta\\le V_{\\mathrm{alg}}$ and again lies within the Sasaki ball.\n780: \n781: In both cases the velocities stay in the ball, and the reward difference equals\n782: \n783: $$\n784: |R(x_0,v_1)-R(x_0,v_2)|=\\lambda_{\\mathrm{vel}}\\,|\\|v_2\\|^2-\\|v_0\\|^2|\\ge \\lambda_{\\mathrm{vel}}\\,\\delta^2.\n785: \n786: $$\n787: For the inward-pointing choice we use that $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta\\ge V_{\\mathrm{alg}}/2\\ge\\delta$ because $\\delta\\le V_{\\mathrm{alg}}/2$, guaranteeing the same lower bound.\n788: Hence the variance of $R$ on the ball is at least $\\sigma_{\\mathrm{rich}}^2(r):=\\lambda_{\\mathrm{vel}}^2\\delta^4/4>0$, establishing environmental richness. :::",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-perturb-moment",
      "title": "Perturbation second moment in the Sasaki metric",
      "start_line": 801,
      "end_line": 889,
      "header_lines": [
        802
      ],
      "content_start": 804,
      "content_end": 888,
      "content": "804: :label: lem-euclidean-perturb-moment\n805: \n806: ```{dropdown} Proof\n807: :::{prf:proof}\n808: Introduce the uncapped velocity update\n809: \n810: $$\n811: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad \\xi_v\\sim\\mathcal N(0,I_d).\n812: \n813: $$\n814: \n815: Write $a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)$. {ref}`Stage 4 <sec-eg-stage4>` applies the cap and Euler step to obtain\n816: \n817: $$\n818: v^+:=\\psi_v(\\tilde v),\\qquad x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x,\n819: \n820: $$\n821: \n822: with $\\xi_x\\sim\\mathcal N(0,I_d)$ independent of $\\xi_v$.\n823: \n824: We bound the expected Sasaki increment in three explicit steps.\n825: \n826: 1. **Positional increment.** The cap guarantees $\\|v^+\\|\\le V_{\\mathrm{alg}}$. Hence\n827: \n828: $$\n829: \\|x^+-x\\|\\le\\tau\\,\\|v^+\\|+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|\\le\\tau V_{\\mathrm{alg}}+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|,\n830: \n831: $$\n832: \n833: so $\\mathbb E\\big[\\|x^+-x\\|^2\\big]\\le 2\\tau^2 V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d$.\n834: \n835: 2. **Velocity increment.** Lemma {prf:ref}`lem-squashing-properties-generic` gives $\\|v^+-v\\|\\le\\|\\tilde v-v\\|$. The random increment decomposes as\n836: \n837: $$\n838: \\tilde v-v=a(x,v)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n839: \n840: $$\n841: \n842: Let $F_0:=\\|F(0)\\|$ and $u_0:=\\|u(0)\\|$. The Lipschitz bounds $\\|F(x)\\|\\le F_0+L_F\\|x\\|$ and $\\|u(x)\\|\\le u_0+L_u\\|x\\|$ imply\n843: \n844: $$\n845: \\|a(x,v)\\|\\le\\frac{\\tau}{m}\\big(F_0+L_F\\|x\\|\\big)+\\gamma_{\\mathrm{fric}}\\tau\\Big(\\|v\\|+u_0+L_u\\|x\\|\\Big).\n846: \n847: $$\n848: \n849: Define the coefficients\n850: \n851: $$\n852: A_x:=\\tau\\Big(\\frac{L_F}{m}+\\gamma_{\\mathrm{fric}}L_u\\Big),\\qquad A_v:=\\gamma_{\\mathrm{fric}}\\tau,\\qquad A_0:=\\frac{\\tau}{m}F_0+\\gamma_{\\mathrm{fric}}\\tau u_0.\n853: \n854: $$\n855: \n856: Then $\\|a(x,v)\\|\\le A_x\\|x\\|+A_v\\|v\\|+A_0$. Using $\\mathbb E\\|\\xi_v\\|^2=d$ and $(\\alpha+\\beta+\\gamma)^2\\le 3(\\alpha^2+\\beta^2+\\gamma^2)$ gives\n857: \n858: $$\n859: \\mathbb E\\big[\\|\\tilde v-v\\|^2\\big]\\le 3A_x^2\\|x\\|^2+3A_v^2\\|v\\|^2+3A_0^2+\\sigma_v^2\\tau d.\n860: \n861: $$\n862: \n863: 3. **Assemble the Sasaki moment.** By definition of the Sasaki metric,\n864: \n865: $$\n866: d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2=\\|x^+-x\\|^2+\\lambda_v\\,\\|v^+-v\\|^2.\n867: \n868: $$\n869: \n870: Taking expectations and combining the bounds from Steps 1–2 yields\n871: \n872: $$\n873: \\mathbb E\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2\\big]\\le C_x^{(\\mathrm{pert})}\\,\\|x\\|^2+C_v^{(\\mathrm{pert})}\\,\\|v\\|^2+C_0^{(\\mathrm{pert})},\n874: \n875: $$\n876: \n877: with\n878: \n879: $$\n880: \\begin{aligned}\n881: C_x^{(\\mathrm{pert})}&:=3\\lambda_vA_x^2,\\\\\n882: C_v^{(\\mathrm{pert})}&:=3\\lambda_vA_v^2,\\\\\n883: C_0^{(\\mathrm{pert})}&:=2\\tau^2V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d+3\\lambda_vA_0^2+\\lambda_v\\sigma_v^2\\tau d.\n884: \\end{aligned}\n885: \n886: $$\n887: \n888: The kinetic kernel is Feller: it composes the continuous affine map $(x,v)\\mapsto(x,\\tilde v)$, the 1-Lipschitz projection $\\psi_v$, and addition of a Gaussian with full support; appending the deterministic status update preserves this property.",
      "metadata": {
        "label": "lem-euclidean-perturb-moment"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "801: :::\n802: \n803: :::{prf:lemma} Perturbation second moment in the Sasaki metric\n804: :label: lem-euclidean-perturb-moment\n805: \n806: ```{dropdown} Proof\n807: :::{prf:proof}\n808: Introduce the uncapped velocity update\n809: \n810: $$\n811: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad \\xi_v\\sim\\mathcal N(0,I_d).\n812: \n813: $$\n814: \n815: Write $a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)$. {ref}`Stage 4 <sec-eg-stage4>` applies the cap and Euler step to obtain\n816: \n817: $$\n818: v^+:=\\psi_v(\\tilde v),\\qquad x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x,\n819: \n820: $$\n821: \n822: with $\\xi_x\\sim\\mathcal N(0,I_d)$ independent of $\\xi_v$.\n823: \n824: We bound the expected Sasaki increment in three explicit steps.\n825: \n826: 1. **Positional increment.** The cap guarantees $\\|v^+\\|\\le V_{\\mathrm{alg}}$. Hence\n827: \n828: $$\n829: \\|x^+-x\\|\\le\\tau\\,\\|v^+\\|+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|\\le\\tau V_{\\mathrm{alg}}+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|,\n830: \n831: $$\n832: \n833: so $\\mathbb E\\big[\\|x^+-x\\|^2\\big]\\le 2\\tau^2 V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d$.\n834: \n835: 2. **Velocity increment.** Lemma {prf:ref}`lem-squashing-properties-generic` gives $\\|v^+-v\\|\\le\\|\\tilde v-v\\|$. The random increment decomposes as\n836: \n837: $$\n838: \\tilde v-v=a(x,v)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n839: \n840: $$\n841: \n842: Let $F_0:=\\|F(0)\\|$ and $u_0:=\\|u(0)\\|$. The Lipschitz bounds $\\|F(x)\\|\\le F_0+L_F\\|x\\|$ and $\\|u(x)\\|\\le u_0+L_u\\|x\\|$ imply\n843: \n844: $$\n845: \\|a(x,v)\\|\\le\\frac{\\tau}{m}\\big(F_0+L_F\\|x\\|\\big)+\\gamma_{\\mathrm{fric}}\\tau\\Big(\\|v\\|+u_0+L_u\\|x\\|\\Big).\n846: \n847: $$\n848: \n849: Define the coefficients\n850: \n851: $$\n852: A_x:=\\tau\\Big(\\frac{L_F}{m}+\\gamma_{\\mathrm{fric}}L_u\\Big),\\qquad A_v:=\\gamma_{\\mathrm{fric}}\\tau,\\qquad A_0:=\\frac{\\tau}{m}F_0+\\gamma_{\\mathrm{fric}}\\tau u_0.\n853: \n854: $$\n855: \n856: Then $\\|a(x,v)\\|\\le A_x\\|x\\|+A_v\\|v\\|+A_0$. Using $\\mathbb E\\|\\xi_v\\|^2=d$ and $(\\alpha+\\beta+\\gamma)^2\\le 3(\\alpha^2+\\beta^2+\\gamma^2)$ gives\n857: \n858: $$\n859: \\mathbb E\\big[\\|\\tilde v-v\\|^2\\big]\\le 3A_x^2\\|x\\|^2+3A_v^2\\|v\\|^2+3A_0^2+\\sigma_v^2\\tau d.\n860: \n861: $$\n862: \n863: 3. **Assemble the Sasaki moment.** By definition of the Sasaki metric,\n864: \n865: $$\n866: d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2=\\|x^+-x\\|^2+\\lambda_v\\,\\|v^+-v\\|^2.\n867: \n868: $$\n869: \n870: Taking expectations and combining the bounds from Steps 1–2 yields\n871: \n872: $$\n873: \\mathbb E\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2\\big]\\le C_x^{(\\mathrm{pert})}\\,\\|x\\|^2+C_v^{(\\mathrm{pert})}\\,\\|v\\|^2+C_0^{(\\mathrm{pert})},\n874: \n875: $$\n876: \n877: with\n878: \n879: $$\n880: \\begin{aligned}\n881: C_x^{(\\mathrm{pert})}&:=3\\lambda_vA_x^2,\\\\\n882: C_v^{(\\mathrm{pert})}&:=3\\lambda_vA_v^2,\\\\\n883: C_0^{(\\mathrm{pert})}&:=2\\tau^2V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d+3\\lambda_vA_0^2+\\lambda_v\\sigma_v^2\\tau d.\n884: \\end{aligned}\n885: \n886: $$\n887: \n888: The kinetic kernel is Feller: it composes the continuous affine map $(x,v)\\mapsto(x,\\tilde v)$, the 1-Lipschitz projection $\\psi_v$, and addition of a Gaussian with full support; appending the deterministic status update preserves this property.\n889: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-geometric-consistency",
      "title": "Geometric consistency under the capped kinetic kernel",
      "start_line": 892,
      "end_line": 1025,
      "header_lines": [
        893
      ],
      "content_start": 895,
      "content_end": 1024,
      "content": "895: :label: lem-euclidean-geometric-consistency\n896: \n897: ```{dropdown} Proof\n898: :::{prf:proof}\n899: Because $\\mathcal X_{\\mathrm{valid}}$ is compact and $F$ and $u$ are continuous, the drift and anisotropy envelopes appearing in the Axiom of Geometric Consistency admit finite global bounds. To make the dependence on the geometry explicit we index the constants by an arbitrary compact subset $C \\subset \\mathcal X_{\\mathrm{valid}}`; in practice we take $C = \\mathcal X_{\\mathrm{valid}}` and obtain uniform constants on the entire valid domain.\n900: \n901: Let $C\\subset\\mathbb R^d$ be an arbitrary compact set and define the local envelopes\n902: \n903: $$\n904: F_C:=\\sup_{x\\in C}\\|F(x)\\|,\\qquad u_C:=\\sup_{x\\in C}\\|u(x)\\|,\n905: \n906: $$\n907: \n908: which are finite by continuity. Set\n909: \n910: $$\n911: C_{\\mathrm{force}}(C):=\\frac{F_C}{m}+\\gamma_{\\mathrm{fric}}\\big(V_{\\mathrm{alg}}+u_C\\big),\\qquad M_{\\mathrm{kin}}(C):=V_{\\mathrm{alg}}+\\frac{\\tau}{m}F_C+\\gamma_{\\mathrm{fric}}\\tau\\big(V_{\\mathrm{alg}}+u_C\\big).\n912: \n913: $$\n914: \n915: Let $\\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v$ with $\\xi_v\\sim\\mathcal N(0,I_d)$ and set $v^+:=\\psi_v(\\tilde v)$, $x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Denote\n916: \n917: $$\n918: a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big).\n919: \n920: $$\n921: \n922: We supply explicit constants for the drift and anisotropy parts of Definition {prf:ref}`def-axiom-geometric-consistency`.\n923: \n924: 1. **Drift of the mean displacement.** Because $\\|v\\|\\le V_{\\mathrm{alg}}$ we have\n925: \n926: $$\n927: \\|\\mathbb E[x^+-x]\\|=\\tau\\,\\|\\mathbb E[v^+]\\|\\le\\tau\\big(\\|\\mathbb E[v^+-v]\\|+V_{\\mathrm{alg}}\\big).\n928: \n929: $$\n930: \n931: The increment of the velocity splits as\n932: \n933: $$\n934: \\mathbb E[v^+-v]=\\mathbb E[\\tilde v-v]+\\mathbb E[\\psi_v(\\tilde v)-\\tilde v].\n935: \n936: $$\n937: \n938: The affine term obeys $\\|\\mathbb E[\\tilde v-v]\\|=\\|a(x,v)\\|\\le\\tau C_{\\mathrm{force}}(C)$. The projection error equals $(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+$ and is supported on the capping event $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Markov's inequality applied to\n939: \n940: $$\n941: \\mathbb E\\|\\tilde v\\|^2=\\|a(x,v)\\|^2+\\sigma_v^2\\tau\\,\\mathbb E\\|\\xi\\|^2\\le(\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d+V_{\\mathrm{alg}}^2\n942: \n943: $$\n944: \n945: then yields\n946: \n947: $$\n948: \\mathbb E[(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+]\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d-V_{\\mathrm{alg}}^2}{V_{\\mathrm{alg}}}=:\\varepsilon_{\\mathrm{cap}}^{\\max}(C).\n949: \n950: $$\n951: \n952: Thus $\\|\\mathbb E[v^+-v]\\|\\le\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)$ and\n953: \n954: $$\n955: \\|\\mathbb E[x^+-x]\\|\\le\\tau\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big).\n956: \n957: $$\n958: \n959: Combining the position and velocity components gives\n960: \n961: $$\n962: \\kappa_{\\mathrm{drift}}^{\\mathrm{Sasaki}}(C):=\\sqrt{\\tau^2\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big)^2+\\lambda_v\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)\\big)^2}.\n963: \n964: $$\n965: \n966: 2. **Probability of capping.** The same second-moment estimate implies\n967: \n968: $$\n969: \\rho_*(C):=\\mathbb P(E)\\le\\frac{\\mathbb E\\|\\tilde v\\|^2}{V_{\\mathrm{alg}}^2}\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d}{V_{\\mathrm{alg}}^2}.\n970: \n971: $$\n972: \n973: 3. **Lower bound on the uncapped density.** The mean of $\\tilde v$ satisfies\n974: \n975: $$\n976: \\|m(x,v)\\|=\\Big\\|v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))\\Big\\|\\le M_{\\mathrm{kin}}(C).\n977: \n978: $$\n979: \n980: The Gaussian density of $\\tilde v$ is\n981: \n982: $$\n983: p_{\\tilde v}(y)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{\\|y-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big).\n984: \n985: $$\n986: \n987: For $u\\in S^{d-1}$ and $0\\le r\\le V_{\\mathrm{alg}}/2$ the inequality $\\|a-b\\|^2\\le 2\\|a\\|^2+2\\|b\\|^2$ yields\n988: \n989: $$\n990: \\|ru-m(x,v)\\|^2\\le\\Big(\\frac{V_{\\mathrm{alg}}}{2}+M_{\\mathrm{kin}}(C)\\Big)^2.\n991: \n992: $$\n993: \n994: Hence $p_{\\tilde v}(ru)\\ge c_{d,0}$ where\n995: \n996: $$\n997: c_{d,0}(C):=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{(V_{\\mathrm{alg}}/2+M_{\\mathrm{kin}}(C))^2}{2\\sigma_v^2\\tau}\\Big)>0.\n998: \n999: $$\n1000: \n1001: Integrating over the radial segment $[0,V_{\\mathrm{alg}}/2]$ yields\n1002: \n1003: $$\n1004: P(\\tilde v\\in K(u))\\ge c_{d,0}(C)\\int_{0}^{V_{\\mathrm{alg}}/2} r^{d-1}\\,dr=:c_d(C)>0,\n1005: \n1006: $$\n1007: \n1008: where $K(u):=\\{ru:0\\le r\\le V_{\\mathrm{alg}}/2\\}$ and we used the polar-volume factor $r^{d-1}$. Thus every cone with opening direction $u$ receives probability at least $c_d(C)$.\n1009: \n1010: 4. **Pushforward through the cap.** On $E^c$ the cap is inactive and $v^+=\\tilde v$, so the lower bound from Step 3 applies. On $E$ the map $\\psi_v$ replaces the radial component by $V_{\\mathrm{alg}}$ while leaving the direction $u$ unchanged, whence the directional distribution of $v^+$ dominates $(1-\\rho_*(C))c_d(C)$ times the surface measure $\\sigma_{d-1}$ on $S^{d-1}$. Equivalently, for every measurable $A\\subseteq S^{d-1}$\n1011: \n1012: $$\n1013: P(v^+\\in A)\\ge(1-\\rho_*(C))c_d(C)\\,\\sigma_{d-1}(A).\n1014: \n1015: $$\n1016: \n1017: Taking reciprocals furnishes the anisotropy constant\n1018: \n1019: $$\n1020: \\kappa_{\\mathrm{anisotropy}}^{\\mathrm{Sasaki}}(C):=\\frac{1}{(1-\\rho_*(C))c_d(C)}.\n1021: \n1022: $$\n1023: \n1024: These constants realise the drift and anisotropy requirements of Definition {prf:ref}`def-axiom-geometric-consistency` on the compact set $C$. Since $C$ was arbitrary, the bounds hold uniformly on every compact subset of the state space, which suffices for the non-compact geometric-consistency axiom.",
      "metadata": {
        "label": "lem-euclidean-geometric-consistency"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "892: 2. **Geometric consistency constants.** Lemma {prf:ref}`lem-euclidean-geometric-consistency` bounds the drift and anisotropy parameters in the Sasaki geometry.\n893: \n894: :::{prf:lemma} Geometric consistency under the capped kinetic kernel\n895: :label: lem-euclidean-geometric-consistency\n896: \n897: ```{dropdown} Proof\n898: :::{prf:proof}\n899: Because $\\mathcal X_{\\mathrm{valid}}$ is compact and $F$ and $u$ are continuous, the drift and anisotropy envelopes appearing in the Axiom of Geometric Consistency admit finite global bounds. To make the dependence on the geometry explicit we index the constants by an arbitrary compact subset $C \\subset \\mathcal X_{\\mathrm{valid}}`; in practice we take $C = \\mathcal X_{\\mathrm{valid}}` and obtain uniform constants on the entire valid domain.\n900: \n901: Let $C\\subset\\mathbb R^d$ be an arbitrary compact set and define the local envelopes\n902: \n903: $$\n904: F_C:=\\sup_{x\\in C}\\|F(x)\\|,\\qquad u_C:=\\sup_{x\\in C}\\|u(x)\\|,\n905: \n906: $$\n907: \n908: which are finite by continuity. Set\n909: \n910: $$\n911: C_{\\mathrm{force}}(C):=\\frac{F_C}{m}+\\gamma_{\\mathrm{fric}}\\big(V_{\\mathrm{alg}}+u_C\\big),\\qquad M_{\\mathrm{kin}}(C):=V_{\\mathrm{alg}}+\\frac{\\tau}{m}F_C+\\gamma_{\\mathrm{fric}}\\tau\\big(V_{\\mathrm{alg}}+u_C\\big).\n912: \n913: $$\n914: \n915: Let $\\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v$ with $\\xi_v\\sim\\mathcal N(0,I_d)$ and set $v^+:=\\psi_v(\\tilde v)$, $x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Denote\n916: \n917: $$\n918: a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big).\n919: \n920: $$\n921: \n922: We supply explicit constants for the drift and anisotropy parts of Definition {prf:ref}`def-axiom-geometric-consistency`.\n923: \n924: 1. **Drift of the mean displacement.** Because $\\|v\\|\\le V_{\\mathrm{alg}}$ we have\n925: \n926: $$\n927: \\|\\mathbb E[x^+-x]\\|=\\tau\\,\\|\\mathbb E[v^+]\\|\\le\\tau\\big(\\|\\mathbb E[v^+-v]\\|+V_{\\mathrm{alg}}\\big).\n928: \n929: $$\n930: \n931: The increment of the velocity splits as\n932: \n933: $$\n934: \\mathbb E[v^+-v]=\\mathbb E[\\tilde v-v]+\\mathbb E[\\psi_v(\\tilde v)-\\tilde v].\n935: \n936: $$\n937: \n938: The affine term obeys $\\|\\mathbb E[\\tilde v-v]\\|=\\|a(x,v)\\|\\le\\tau C_{\\mathrm{force}}(C)$. The projection error equals $(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+$ and is supported on the capping event $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Markov's inequality applied to\n939: \n940: $$\n941: \\mathbb E\\|\\tilde v\\|^2=\\|a(x,v)\\|^2+\\sigma_v^2\\tau\\,\\mathbb E\\|\\xi\\|^2\\le(\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d+V_{\\mathrm{alg}}^2\n942: \n943: $$\n944: \n945: then yields\n946: \n947: $$\n948: \\mathbb E[(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+]\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d-V_{\\mathrm{alg}}^2}{V_{\\mathrm{alg}}}=:\\varepsilon_{\\mathrm{cap}}^{\\max}(C).\n949: \n950: $$\n951: \n952: Thus $\\|\\mathbb E[v^+-v]\\|\\le\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)$ and\n953: \n954: $$\n955: \\|\\mathbb E[x^+-x]\\|\\le\\tau\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big).\n956: \n957: $$\n958: \n959: Combining the position and velocity components gives\n960: \n961: $$\n962: \\kappa_{\\mathrm{drift}}^{\\mathrm{Sasaki}}(C):=\\sqrt{\\tau^2\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big)^2+\\lambda_v\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)\\big)^2}.\n963: \n964: $$\n965: \n966: 2. **Probability of capping.** The same second-moment estimate implies\n967: \n968: $$\n969: \\rho_*(C):=\\mathbb P(E)\\le\\frac{\\mathbb E\\|\\tilde v\\|^2}{V_{\\mathrm{alg}}^2}\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d}{V_{\\mathrm{alg}}^2}.\n970: \n971: $$\n972: \n973: 3. **Lower bound on the uncapped density.** The mean of $\\tilde v$ satisfies\n974: \n975: $$\n976: \\|m(x,v)\\|=\\Big\\|v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))\\Big\\|\\le M_{\\mathrm{kin}}(C).\n977: \n978: $$\n979: \n980: The Gaussian density of $\\tilde v$ is\n981: \n982: $$\n983: p_{\\tilde v}(y)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{\\|y-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big).\n984: \n985: $$\n986: \n987: For $u\\in S^{d-1}$ and $0\\le r\\le V_{\\mathrm{alg}}/2$ the inequality $\\|a-b\\|^2\\le 2\\|a\\|^2+2\\|b\\|^2$ yields\n988: \n989: $$\n990: \\|ru-m(x,v)\\|^2\\le\\Big(\\frac{V_{\\mathrm{alg}}}{2}+M_{\\mathrm{kin}}(C)\\Big)^2.\n991: \n992: $$\n993: \n994: Hence $p_{\\tilde v}(ru)\\ge c_{d,0}$ where\n995: \n996: $$\n997: c_{d,0}(C):=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{(V_{\\mathrm{alg}}/2+M_{\\mathrm{kin}}(C))^2}{2\\sigma_v^2\\tau}\\Big)>0.\n998: \n999: $$\n1000: \n1001: Integrating over the radial segment $[0,V_{\\mathrm{alg}}/2]$ yields\n1002: \n1003: $$\n1004: P(\\tilde v\\in K(u))\\ge c_{d,0}(C)\\int_{0}^{V_{\\mathrm{alg}}/2} r^{d-1}\\,dr=:c_d(C)>0,\n1005: \n1006: $$\n1007: \n1008: where $K(u):=\\{ru:0\\le r\\le V_{\\mathrm{alg}}/2\\}$ and we used the polar-volume factor $r^{d-1}$. Thus every cone with opening direction $u$ receives probability at least $c_d(C)$.\n1009: \n1010: 4. **Pushforward through the cap.** On $E^c$ the cap is inactive and $v^+=\\tilde v$, so the lower bound from Step 3 applies. On $E$ the map $\\psi_v$ replaces the radial component by $V_{\\mathrm{alg}}$ while leaving the direction $u$ unchanged, whence the directional distribution of $v^+$ dominates $(1-\\rho_*(C))c_d(C)$ times the surface measure $\\sigma_{d-1}$ on $S^{d-1}$. Equivalently, for every measurable $A\\subseteq S^{d-1}$\n1011: \n1012: $$\n1013: P(v^+\\in A)\\ge(1-\\rho_*(C))c_d(C)\\,\\sigma_{d-1}(A).\n1014: \n1015: $$\n1016: \n1017: Taking reciprocals furnishes the anisotropy constant\n1018: \n1019: $$\n1020: \\kappa_{\\mathrm{anisotropy}}^{\\mathrm{Sasaki}}(C):=\\frac{1}{(1-\\rho_*(C))c_d(C)}.\n1021: \n1022: $$\n1023: \n1024: These constants realise the drift and anisotropy requirements of Definition {prf:ref}`def-axiom-geometric-consistency` on the compact set $C$. Since $C$ was arbitrary, the bounds hold uniformly on every compact subset of the state space, which suffices for the non-compact geometric-consistency axiom.\n1025: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-single-walker-positional-error",
      "title": "Single-walker positional error bound in the Sasaki metric",
      "start_line": 1056,
      "end_line": 1108,
      "header_lines": [
        1057
      ],
      "content_start": 1059,
      "content_end": 1107,
      "content": "1059: :label: lem-sasaki-single-walker-positional-error\n1060: \n1061: Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. For a given walker $i$ that is alive in swarm $\\mathcal S_1$ ($s_{1,i}=1$), let $\\mathbb C_i(\\mathcal S_1)$ be its companion selection measure.\n1062: \n1063: The absolute error in its expected distance due to the positional displacement of the walkers between the two states, evaluated over the fixed companion set from $\\mathcal S_1$, is bounded by the sum of its own displacement and the average displacement of its potential companions.\n1064: \n1065: $$\n1066: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1067: \n1068: $$\n1069: \n1070: ```{dropdown} Proof\n1071: :::{prf:proof}\n1072: Let $\\Delta_{\\mathrm{pos},i}$ denote the absolute error term we wish to bound. The proof proceeds by applying standard metric and probability inequalities.\n1073: \n1074: **Step 1: Apply Linearity of Expectation.**\n1075: We combine the two terms into a single expectation over the fixed companion selection measure $\\mathbb C_i(\\mathcal S_1)$.\n1076: \n1077: $$\n1078: \\Delta_{\\mathrm{pos},i} = \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right|\n1079: \n1080: $$\n1081: \n1082: **Step 2: Apply Jensen's Inequality.**\n1083: Using Jensen's inequality for the convex function $f(x)=|x|$, we can move the absolute value inside the expectation, which provides an upper bound:\n1084: \n1085: $$\n1086: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\right]\n1087: \n1088: $$\n1089: \n1090: **Step 3: Apply the Reverse Triangle Inequality.**\n1091: The term inside the expectation is the absolute difference between two distance values. For any points $a,b,c,d$ in a metric space $(M,d)$, the reverse triangle inequality states that $|d(a,b) - d(c,d)| \\le d(a,c) + d(b,d)$. Applying this to the Sasaki metric $d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ yields:\n1092: \n1093: $$\n1094: \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c}))\n1095: \n1096: $$\n1097: \n1098: **Step 4: Finalize the Bound.**\n1099: We substitute the inequality from Step 3 back into the expression from Step 2.\n1100: \n1101: $$\n1102: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1103: \n1104: $$\n1105: \n1106: By linearity of expectation, we can separate the terms. The first term, $d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i}))$, is a constant with respect to the expectation over the companion index $c$. This gives the final bound as stated in the lemma.\n1107: ",
      "metadata": {
        "label": "lem-sasaki-single-walker-positional-error"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1056: and let $D_{\\mathcal Y}:=\\operatorname{diam}_{d_{\\mathcal Y}^{\\mathrm{Sasaki}}}(\\mathcal Y)$.\n1057: \n1058: :::{prf:lemma} Single-walker positional error bound in the Sasaki metric\n1059: :label: lem-sasaki-single-walker-positional-error\n1060: \n1061: Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. For a given walker $i$ that is alive in swarm $\\mathcal S_1$ ($s_{1,i}=1$), let $\\mathbb C_i(\\mathcal S_1)$ be its companion selection measure.\n1062: \n1063: The absolute error in its expected distance due to the positional displacement of the walkers between the two states, evaluated over the fixed companion set from $\\mathcal S_1$, is bounded by the sum of its own displacement and the average displacement of its potential companions.\n1064: \n1065: $$\n1066: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1067: \n1068: $$\n1069: \n1070: ```{dropdown} Proof\n1071: :::{prf:proof}\n1072: Let $\\Delta_{\\mathrm{pos},i}$ denote the absolute error term we wish to bound. The proof proceeds by applying standard metric and probability inequalities.\n1073: \n1074: **Step 1: Apply Linearity of Expectation.**\n1075: We combine the two terms into a single expectation over the fixed companion selection measure $\\mathbb C_i(\\mathcal S_1)$.\n1076: \n1077: $$\n1078: \\Delta_{\\mathrm{pos},i} = \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right|\n1079: \n1080: $$\n1081: \n1082: **Step 2: Apply Jensen's Inequality.**\n1083: Using Jensen's inequality for the convex function $f(x)=|x|$, we can move the absolute value inside the expectation, which provides an upper bound:\n1084: \n1085: $$\n1086: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\right]\n1087: \n1088: $$\n1089: \n1090: **Step 3: Apply the Reverse Triangle Inequality.**\n1091: The term inside the expectation is the absolute difference between two distance values. For any points $a,b,c,d$ in a metric space $(M,d)$, the reverse triangle inequality states that $|d(a,b) - d(c,d)| \\le d(a,c) + d(b,d)$. Applying this to the Sasaki metric $d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ yields:\n1092: \n1093: $$\n1094: \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c}))\n1095: \n1096: $$\n1097: \n1098: **Step 4: Finalize the Bound.**\n1099: We substitute the inequality from Step 3 back into the expression from Step 2.\n1100: \n1101: $$\n1102: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1103: \n1104: $$\n1105: \n1106: By linearity of expectation, we can separate the terms. The first term, $d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i}))$, is a constant with respect to the expectation over the companion index $c$. This gives the final bound as stated in the lemma.\n1107: \n1108: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-single-walker-structural-error",
      "title": "Single-walker structural error bound in the Sasaki metric",
      "start_line": 1110,
      "end_line": 1146,
      "header_lines": [
        1111
      ],
      "content_start": 1113,
      "content_end": 1145,
      "content": "1113: :label: lem-sasaki-single-walker-structural-error\n1114: \n1115: Let $i\\in\\mathcal A_{\\mathrm{stable}}$ and keep the second swarm’s capped positions fixed. Let the initial swarm have at least two alive walkers, $k_1=|\\mathcal A(\\mathcal S_1)| \\ge 2$. The absolute error in the expected distance for walker $i$ due to the change in the companion selection measure is bounded by:\n1116: \n1117: $$\n1118: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_2)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le \\frac{2 D_{\\mathcal Y}}{k_1-1} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1119: \n1120: $$\n1121: \n1122: where $D_{\\mathcal Y}$ is the diameter of the algorithmic space.\n1123: \n1124: ```{dropdown} Proof\n1125: :::{prf:proof}\n1126: This result is a direct application of the framework's **Total Error Bound in Terms of Status Changes** ({prf:ref}`thm-total-error-status-bound`) to the specific function of interest in the Sasaki geometry.\n1127: \n1128: **Step 1: Identify the Function and its Bound.**\n1129: Let the function being evaluated under the expectation be $f(c) := d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c}))$. This function measures the Sasaki distance from the fixed walker $i$ to a potential companion $c$, using the positions from the second swarm. By definition, any distance in the algorithmic space is bounded by the space's diameter, $D_{\\mathcal Y}$. Therefore, we have a uniform bound on the function's value: $|f(c)| \\le D_{\\mathcal Y} =: M_f$.\n1130: \n1131: **Step 2: Identify the Companion Support Sets.**\n1132: Let $S_1 = S_i(\\mathcal{S}_1)$ and $S_2 = S_i(\\mathcal{S}_2)$ be the companion support sets for walker $i$ in the two swarms. Since walker $i$ is alive in $\\mathcal S_1$ (i.e., $i \\in \\mathcal A_{\\mathrm{stable}} \\subseteq \\mathcal A_1$) and the precondition states $k_1 \\ge 2$, the initial support set is $S_1 = \\mathcal A_1 \\setminus \\{i\\}$. Its size is therefore $|S_1| = k_1 - 1 > 0$.\n1133: \n1134: **Step 3: Apply the General Error Bound.**\n1135: The framework theorem {prf:ref}`thm-total-error-status-bound` provides a general bound for the change in expectation of a bounded function due to a change in the underlying support set:\n1136: \n1137: $$\n1138: \\text{Error} \\le \\frac{2 M_f}{|S_1|} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1139: \n1140: $$\n1141: This bound is purely algebraic and holds for any choice of metric or bounded function.\n1142: \n1143: **Step 4: Substitute and Finalize.**\n1144: We substitute our specific function bound $M_f = D_{\\mathcal Y}$ and the support set size $|S_1| = k_1 - 1$ into the general formula. This immediately yields the stated bound for the structural error component.\n1145: ",
      "metadata": {
        "label": "lem-sasaki-single-walker-structural-error"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1110: :::\n1111: \n1112: :::{prf:lemma} Single-walker structural error bound in the Sasaki metric\n1113: :label: lem-sasaki-single-walker-structural-error\n1114: \n1115: Let $i\\in\\mathcal A_{\\mathrm{stable}}$ and keep the second swarm’s capped positions fixed. Let the initial swarm have at least two alive walkers, $k_1=|\\mathcal A(\\mathcal S_1)| \\ge 2$. The absolute error in the expected distance for walker $i$ due to the change in the companion selection measure is bounded by:\n1116: \n1117: $$\n1118: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_2)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le \\frac{2 D_{\\mathcal Y}}{k_1-1} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1119: \n1120: $$\n1121: \n1122: where $D_{\\mathcal Y}$ is the diameter of the algorithmic space.\n1123: \n1124: ```{dropdown} Proof\n1125: :::{prf:proof}\n1126: This result is a direct application of the framework's **Total Error Bound in Terms of Status Changes** ({prf:ref}`thm-total-error-status-bound`) to the specific function of interest in the Sasaki geometry.\n1127: \n1128: **Step 1: Identify the Function and its Bound.**\n1129: Let the function being evaluated under the expectation be $f(c) := d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c}))$. This function measures the Sasaki distance from the fixed walker $i$ to a potential companion $c$, using the positions from the second swarm. By definition, any distance in the algorithmic space is bounded by the space's diameter, $D_{\\mathcal Y}$. Therefore, we have a uniform bound on the function's value: $|f(c)| \\le D_{\\mathcal Y} =: M_f$.\n1130: \n1131: **Step 2: Identify the Companion Support Sets.**\n1132: Let $S_1 = S_i(\\mathcal{S}_1)$ and $S_2 = S_i(\\mathcal{S}_2)$ be the companion support sets for walker $i$ in the two swarms. Since walker $i$ is alive in $\\mathcal S_1$ (i.e., $i \\in \\mathcal A_{\\mathrm{stable}} \\subseteq \\mathcal A_1$) and the precondition states $k_1 \\ge 2$, the initial support set is $S_1 = \\mathcal A_1 \\setminus \\{i\\}$. Its size is therefore $|S_1| = k_1 - 1 > 0$.\n1133: \n1134: **Step 3: Apply the General Error Bound.**\n1135: The framework theorem {prf:ref}`thm-total-error-status-bound` provides a general bound for the change in expectation of a bounded function due to a change in the underlying support set:\n1136: \n1137: $$\n1138: \\text{Error} \\le \\frac{2 M_f}{|S_1|} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1139: \n1140: $$\n1141: This bound is purely algebraic and holds for any choice of metric or bounded function.\n1142: \n1143: **Step 4: Substitute and Finalize.**\n1144: We substitute our specific function bound $M_f = D_{\\mathcal Y}$ and the support set size $|S_1| = k_1 - 1$ into the general formula. This immediately yields the stated bound for the structural error component.\n1145: \n1146: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-total-squared-error-stable",
      "title": "Mean-square error on stable walkers (Sasaki)",
      "start_line": 1150,
      "end_line": 1184,
      "header_lines": [
        1151
      ],
      "content_start": 1153,
      "content_end": 1183,
      "content": "1153: :label: lem-sasaki-total-squared-error-stable\n1154: \n1155: Let $\\mathcal S_1,\\mathcal S_2$ be swarms with alive sets $\\mathcal A_r$ and let $\\mathbf d^{(r)}$ denote the expected raw distance vector produced by the measurement operator on $\\mathcal S_r$. Write $\\mathcal A_{\\mathrm{stable}}:=\\mathcal A_1\\cap\\mathcal A_2$ and $k_{\\mathrm{stable}}:=|\\mathcal A_{\\mathrm{stable}}|$. Then\n1156: \n1157: $$\n1158: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\big|d^{(1)}_i-d^{(2)}_i\\big|^2\\le C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}})\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1159: \n1160: $$\n1161: \n1162: where $C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}}):=2\\Big(1+\\frac{k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\Big)$.\n1163: \n1164: ```{dropdown} Proof\n1165: :::{prf:proof}\n1166: For $i\\in\\mathcal A_{\\mathrm{stable}}$ set $\\Delta_i:=|d^{(1)}_i-d^{(2)}_i|$. Lemma {prf:ref}`lem-sasaki-single-walker-positional-error` gives\n1167: \n1168: $$\n1169: \\Delta_i\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i})) + \\mathbb E_{c\\sim\\mathbb C_i(\\mathcal S_1)}\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}),\\varphi(w_{2,c}))\\big].\n1170: \n1171: $$\n1172: \n1173: Apply $(a+b)^2\\le 2a^2+2b^2$ and Jensen's inequality to obtain\n1174: \n1175: $$\n1176: \\Delta_i^2\\le 2\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i}))^2 + \\frac{2}{k_1-1}\\sum_{j\\in\\mathcal A_1} d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,j}),\\varphi(w_{2,j}))^2,\n1177: \n1178: $$\n1179: where the averaging denominator $k_1-1$ is interpreted as $1$ when $k_1=1$. Summing over $i\\in\\mathcal A_{\\mathrm{stable}}$ yields\n1180: \n1181: $$\n1182: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\Delta_i^2\\le 2\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2)+\\frac{2k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1183: ",
      "metadata": {
        "label": "lem-sasaki-total-squared-error-stable"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1150: \n1151: \n1152: :::{prf:lemma} Mean-square error on stable walkers (Sasaki)\n1153: :label: lem-sasaki-total-squared-error-stable\n1154: \n1155: Let $\\mathcal S_1,\\mathcal S_2$ be swarms with alive sets $\\mathcal A_r$ and let $\\mathbf d^{(r)}$ denote the expected raw distance vector produced by the measurement operator on $\\mathcal S_r$. Write $\\mathcal A_{\\mathrm{stable}}:=\\mathcal A_1\\cap\\mathcal A_2$ and $k_{\\mathrm{stable}}:=|\\mathcal A_{\\mathrm{stable}}|$. Then\n1156: \n1157: $$\n1158: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\big|d^{(1)}_i-d^{(2)}_i\\big|^2\\le C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}})\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1159: \n1160: $$\n1161: \n1162: where $C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}}):=2\\Big(1+\\frac{k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\Big)$.\n1163: \n1164: ```{dropdown} Proof\n1165: :::{prf:proof}\n1166: For $i\\in\\mathcal A_{\\mathrm{stable}}$ set $\\Delta_i:=|d^{(1)}_i-d^{(2)}_i|$. Lemma {prf:ref}`lem-sasaki-single-walker-positional-error` gives\n1167: \n1168: $$\n1169: \\Delta_i\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i})) + \\mathbb E_{c\\sim\\mathbb C_i(\\mathcal S_1)}\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}),\\varphi(w_{2,c}))\\big].\n1170: \n1171: $$\n1172: \n1173: Apply $(a+b)^2\\le 2a^2+2b^2$ and Jensen's inequality to obtain\n1174: \n1175: $$\n1176: \\Delta_i^2\\le 2\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i}))^2 + \\frac{2}{k_1-1}\\sum_{j\\in\\mathcal A_1} d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,j}),\\varphi(w_{2,j}))^2,\n1177: \n1178: $$\n1179: where the averaging denominator $k_1-1$ is interpreted as $1$ when $k_1=1$. Summing over $i\\in\\mathcal A_{\\mathrm{stable}}$ yields\n1180: \n1181: $$\n1182: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\Delta_i^2\\le 2\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2)+\\frac{2k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1183: \n1184: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-aggregator-value",
      "title": "Value continuity of the empirical moments",
      "start_line": 1222,
      "end_line": 1237,
      "header_lines": [
        1223
      ],
      "content_start": 1225,
      "content_end": 1236,
      "content": "1225: :label: lem-sasaki-aggregator-value\n1226: \n1227: Fix a swarm $\\mathcal S$ with alive index set $\\mathcal A(\\mathcal S)$ of size $k\\ge 1$. Let $\\mathbf v_1,\\mathbf v_2\\in\\mathbb R^k$ be two scalar value vectors whose components satisfy $|v_{j,i}|\\le V_{\\max}$. Then the empirical mean and second moment obey\n1228: \n1229: $$\n1230: |\\mu(\\mathcal S,\\mathbf v_1)-\\mu(\\mathcal S,\\mathbf v_2)|\\le \\frac{1}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2,\\qquad|m_2(\\mathcal S,\\mathbf v_1)-m_2(\\mathcal S,\\mathbf v_2)|\\le \\frac{2V_{\\max}}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2.\n1231: \n1232: $$\n1233: \n1234: ```{dropdown} Proof\n1235: :::{prf:proof}\n1236: The identities follow from the gradient calculations $\\nabla\\mu=(1/k)\\mathbf 1$ and $\\nabla m_2=(2/k)\\mathbf v$ together with Cauchy–Schwarz, as in Lemma 6.2.2.a of the framework.",
      "metadata": {
        "label": "lem-sasaki-aggregator-value"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1222: Whenever aggregators act on reward vectors we use the uniform bound $V_{\\mathrm{max}}^{(R)}:=\\max\\{|R_{\\min}|,R_{\\max}\\}$; for distance vectors we use $V_{\\mathrm{max}}^{(d)}:=D_{\\mathcal Y}$. For swarms $\\mathcal S_r$ write $k_r:=|\\mathcal A(\\mathcal S_r)|$, define $k_{\\min}:=\\max\\{1,\\min(k_1,k_2)\\}$, and let $n_c:=\\sum_{i=1}^N(s_{1,i}-s_{2,i})^2$ count the status changes.\n1223: \n1224: :::{prf:lemma} Value continuity of the empirical moments\n1225: :label: lem-sasaki-aggregator-value\n1226: \n1227: Fix a swarm $\\mathcal S$ with alive index set $\\mathcal A(\\mathcal S)$ of size $k\\ge 1$. Let $\\mathbf v_1,\\mathbf v_2\\in\\mathbb R^k$ be two scalar value vectors whose components satisfy $|v_{j,i}|\\le V_{\\max}$. Then the empirical mean and second moment obey\n1228: \n1229: $$\n1230: |\\mu(\\mathcal S,\\mathbf v_1)-\\mu(\\mathcal S,\\mathbf v_2)|\\le \\frac{1}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2,\\qquad|m_2(\\mathcal S,\\mathbf v_1)-m_2(\\mathcal S,\\mathbf v_2)|\\le \\frac{2V_{\\max}}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2.\n1231: \n1232: $$\n1233: \n1234: ```{dropdown} Proof\n1235: :::{prf:proof}\n1236: The identities follow from the gradient calculations $\\nabla\\mu=(1/k)\\mathbf 1$ and $\\nabla m_2=(2/k)\\mathbf v$ together with Cauchy–Schwarz, as in Lemma 6.2.2.a of the framework.\n1237: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-aggregator-structural",
      "title": "Structural continuity of the empirical moments",
      "start_line": 1239,
      "end_line": 1254,
      "header_lines": [
        1240
      ],
      "content_start": 1242,
      "content_end": 1253,
      "content": "1242: :label: lem-sasaki-aggregator-structural\n1243: \n1244: Let $\\mathcal S_r=((x_{r,i},v_{r,i},s_{r,i}))_{i=1}^N$ with alive counts $k_r\\ge 1$ and let $\\mathbf v$ be a scalar vector on the union of alive indices satisfying $|v_i|\\le V_{\\max}$. Set $k_{\\min}:=\\max\\{1,\\min(k_1,k_2)\\}$ and $n_c:=\\sum_{i=1}^N(s_{1,i}-s_{2,i})^2$. Then\n1245: \n1246: $$\n1247: |\\mu(\\mathcal S_1,\\mathbf v)-\\mu(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}}{k_{\\min}}\\,n_c,\\qquad|m_2(\\mathcal S_1,\\mathbf v)-m_2(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}^2}{k_{\\min}}\\,n_c.\n1248: \n1249: $$\n1250: \n1251: ```{dropdown} Proof\n1252: :::{prf:proof}\n1253: The proof mirrors Lemma 6.2.2.b of the framework. Decompose the difference in means into contributions from walkers that remain alive in both swarms and those that change status. The former vanish, whereas the latter introduce at most $V_{\\max}$ per status flip. Accounting for the normalisation factors $1/k_r$ and the difference in alive counts yields the stated bounds. The argument for $m_2$ uses $|a^2-b^2|\\le 2V_{\\max}|a-b|$.",
      "metadata": {
        "label": "lem-sasaki-aggregator-structural"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1239: :::\n1240: \n1241: :::{prf:lemma} Structural continuity of the empirical moments\n1242: :label: lem-sasaki-aggregator-structural\n1243: \n1244: Let $\\mathcal S_r=((x_{r,i},v_{r,i},s_{r,i}))_{i=1}^N$ with alive counts $k_r\\ge 1$ and let $\\mathbf v$ be a scalar vector on the union of alive indices satisfying $|v_i|\\le V_{\\max}$. Set $k_{\\min}:=\\max\\{1,\\min(k_1,k_2)\\}$ and $n_c:=\\sum_{i=1}^N(s_{1,i}-s_{2,i})^2$. Then\n1245: \n1246: $$\n1247: |\\mu(\\mathcal S_1,\\mathbf v)-\\mu(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}}{k_{\\min}}\\,n_c,\\qquad|m_2(\\mathcal S_1,\\mathbf v)-m_2(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}^2}{k_{\\min}}\\,n_c.\n1248: \n1249: $$\n1250: \n1251: ```{dropdown} Proof\n1252: :::{prf:proof}\n1253: The proof mirrors Lemma 6.2.2.b of the framework. Decompose the difference in means into contributions from walkers that remain alive in both swarms and those that change status. The former vanish, whereas the latter introduce at most $V_{\\max}$ per status flip. Accounting for the normalisation factors $1/k_r$ and the difference in alive counts yields the stated bounds. The argument for $m_2$ uses $|a^2-b^2|\\le 2V_{\\max}|a-b|$.\n1254: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-aggregator-lipschitz",
      "title": "Lipschitz data for the Sasaki empirical aggregators",
      "start_line": 1256,
      "end_line": 1276,
      "header_lines": [
        1257
      ],
      "content_start": 1259,
      "content_end": 1275,
      "content": "1259: :label: lem-sasaki-aggregator-lipschitz\n1260: \n1261: For reward vectors take $V_{\\max}=V_{\\mathrm{max}}^{(R)}$; for distance vectors take $V_{\\max}=V_{\\mathrm{max}}^{(d)}$. The empirical mean and second moment satisfy the aggregator axioms with\n1262: \n1263: $$\n1264: L_{\\mu,M}^{\\mathrm{Sasaki}}(k)=\\frac{1}{\\sqrt{k}},\\qquad L_{m_2,M}^{\\mathrm{Sasaki}}(k)=\\frac{2V_{\\max}}{\\sqrt{k}},\n1265: \n1266: $$\n1267: \n1268: $$\n1269: L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}}{k_{\\min}},\\qquad L_{m_2,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}^2}{k_{\\min}},\n1270: \n1271: $$\n1272: and growth exponents $p_{\\mu,S}=p_{m_2,S}=p_{\\mathrm{worst\text{-}case}}=-1$. Consequently $\\kappa_{\\mathrm{var}}^{\\mathrm{Sasaki}}=\\kappa_{\\mathrm{range}}^{\\mathrm{Sasaki}}=1$ as in the canonical framework.\n1273: \n1274: ```{dropdown} Proof\n1275: :::{prf:proof}",
      "metadata": {
        "label": "lem-sasaki-aggregator-lipschitz"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1256: :::\n1257: \n1258: :::{prf:lemma} Lipschitz data for the Sasaki empirical aggregators\n1259: :label: lem-sasaki-aggregator-lipschitz\n1260: \n1261: For reward vectors take $V_{\\max}=V_{\\mathrm{max}}^{(R)}$; for distance vectors take $V_{\\max}=V_{\\mathrm{max}}^{(d)}$. The empirical mean and second moment satisfy the aggregator axioms with\n1262: \n1263: $$\n1264: L_{\\mu,M}^{\\mathrm{Sasaki}}(k)=\\frac{1}{\\sqrt{k}},\\qquad L_{m_2,M}^{\\mathrm{Sasaki}}(k)=\\frac{2V_{\\max}}{\\sqrt{k}},\n1265: \n1266: $$\n1267: \n1268: $$\n1269: L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}}{k_{\\min}},\\qquad L_{m_2,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}^2}{k_{\\min}},\n1270: \n1271: $$\n1272: and growth exponents $p_{\\mu,S}=p_{m_2,S}=p_{\\mathrm{worst\text{-}case}}=-1$. Consequently $\\kappa_{\\mathrm{var}}^{\\mathrm{Sasaki}}=\\kappa_{\\mathrm{range}}^{\\mathrm{Sasaki}}=1$ as in the canonical framework.\n1273: \n1274: ```{dropdown} Proof\n1275: :::{prf:proof}\n1276: Combine Lemmas {prf:ref}`lem-sasaki-aggregator-value` and {prf:ref}`lem-sasaki-aggregator-structural` with the dispersion metric identity $n_c\\le(N/\\sqrt{\\lambda_{\\mathrm{status}}})d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1,\\mathcal S_2)$ to obtain the stated Lipschitz functions and exponents.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-value-error-decomposition",
      "title": "Decomposition of the Value Error",
      "start_line": 1349,
      "end_line": 1417,
      "header_lines": [
        1350
      ],
      "content_start": 1352,
      "content_end": 1416,
      "content": "1352: :label: lem-sasaki-value-error-decomposition\n1353: \n1354: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. Let $(\\mu_1, \\sigma'_1)$ and $(\\mu_2, \\sigma'_2)$ be the corresponding statistical properties, and let $\\mathbf z_1$ and $\\mathbf z_2$ be the corresponding standardized vectors.\n1355: \n1356: The total value error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of three components:\n1357: \n1358: $$\n1359: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1360: \n1361: $$\n1362: \n1363: where:\n1364: 1.  **The Direct Shift ($\\Delta_{\\text{direct}}$):** The error from the change in the raw value vector itself, scaled by the initial standard deviation.\n1365: \n1366:     $$\n1367:     \\Delta_{\\text{direct}} := \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1}\n1368:     $$\n1369: \n1370: 2.  **The Mean Shift ($\\Delta_{\\text{mean}}$):** The error from the change in the aggregator's computed mean, applied uniformly to all walkers.\n1371: \n1372:     $$\n1373:     \\Delta_{\\text{mean}} := \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1}\n1374:     $$\n1375:     where $\\mathbf{1}$ is a k-dimensional vector of ones.\n1376: \n1377: 3.  **The Denominator Shift ($\\Delta_{\\text{denom}}$):** The error from the change in the regularized standard deviation, which rescales the second standardized vector.\n1378: \n1379:     $$\n1380:     \\Delta_{\\text{denom}} := \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\n1381:     $$\n1382: \n1383: Furthermore, the total squared error is bounded by three times the sum of the squared norms of these components:\n1384: \n1385: $$\n1386: \\|\\Delta\\mathbf{z}\\|_2^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1387: \n1388: $$\n1389: \n1390: ```{dropdown} Proof\n1391: :::{prf:proof}\n1392: **Step 1: Algebraic Decomposition.**\n1393: The proof of the decomposition is a direct algebraic manipulation. We start with the definition of the error and add and subtract the intermediate term $(\\mathbf r_2 - \\mu_2) / \\sigma'_1$.\n1394: \n1395: $$\n1396: \\begin{aligned}\n1397: \\Delta\\mathbf{z} &= \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\\\\n1398: &= \\left( \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} \\right) + \\left( \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\right) \\\\\n1399: &= \\frac{(\\mathbf r_1 - \\mathbf r_2) - (\\mu_1 - \\mu_2)}{\\sigma'_1} + (\\mathbf r_2 - \\mu_2) \\left( \\frac{1}{\\sigma'_1} - \\frac{1}{\\sigma'_2} \\right) \\\\\n1400: &= \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} + \\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\mathbf{1} + \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\\\\n1401: &= \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1402: \\end{aligned}\n1403: \n1404: $$\n1405: The final line follows by recognizing the definitions of the three components.\n1406: \n1407: **Step 2: Bound on the Squared Norm.**\n1408: The bound on the total squared norm follows from the triangle inequality (`||A+B+C|| <= ||A|| + ||B|| + ||C||`) and the elementary inequality $(a+b+c)^2 \\le 3(a^2+b^2+c^2)$ for non-negative reals. For vectors, this becomes:\n1409: \n1410: $$\n1411: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\\|_2^2 \\le \\left( \\|\\Delta_{\\text{direct}}\\|_2 + \\|\\Delta_{\\text{mean}}\\|_2 + \\|\\Delta_{\\text{denom}}\\|_2 \\right)^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1412: \n1413: $$\n1414: \n1415: This completes the proof.\n1416: ",
      "metadata": {
        "label": "lem-sasaki-value-error-decomposition"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1349: ##### 2.3.4.1. Sub-Lemma: Algebraic Decomposition of the Value Error\n1350: \n1351: :::{prf:lemma} Decomposition of the Value Error\n1352: :label: lem-sasaki-value-error-decomposition\n1353: \n1354: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. Let $(\\mu_1, \\sigma'_1)$ and $(\\mu_2, \\sigma'_2)$ be the corresponding statistical properties, and let $\\mathbf z_1$ and $\\mathbf z_2$ be the corresponding standardized vectors.\n1355: \n1356: The total value error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of three components:\n1357: \n1358: $$\n1359: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1360: \n1361: $$\n1362: \n1363: where:\n1364: 1.  **The Direct Shift ($\\Delta_{\\text{direct}}$):** The error from the change in the raw value vector itself, scaled by the initial standard deviation.\n1365: \n1366:     $$\n1367:     \\Delta_{\\text{direct}} := \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1}\n1368:     $$\n1369: \n1370: 2.  **The Mean Shift ($\\Delta_{\\text{mean}}$):** The error from the change in the aggregator's computed mean, applied uniformly to all walkers.\n1371: \n1372:     $$\n1373:     \\Delta_{\\text{mean}} := \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1}\n1374:     $$\n1375:     where $\\mathbf{1}$ is a k-dimensional vector of ones.\n1376: \n1377: 3.  **The Denominator Shift ($\\Delta_{\\text{denom}}$):** The error from the change in the regularized standard deviation, which rescales the second standardized vector.\n1378: \n1379:     $$\n1380:     \\Delta_{\\text{denom}} := \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\n1381:     $$\n1382: \n1383: Furthermore, the total squared error is bounded by three times the sum of the squared norms of these components:\n1384: \n1385: $$\n1386: \\|\\Delta\\mathbf{z}\\|_2^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1387: \n1388: $$\n1389: \n1390: ```{dropdown} Proof\n1391: :::{prf:proof}\n1392: **Step 1: Algebraic Decomposition.**\n1393: The proof of the decomposition is a direct algebraic manipulation. We start with the definition of the error and add and subtract the intermediate term $(\\mathbf r_2 - \\mu_2) / \\sigma'_1$.\n1394: \n1395: $$\n1396: \\begin{aligned}\n1397: \\Delta\\mathbf{z} &= \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\\\\n1398: &= \\left( \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} \\right) + \\left( \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\right) \\\\\n1399: &= \\frac{(\\mathbf r_1 - \\mathbf r_2) - (\\mu_1 - \\mu_2)}{\\sigma'_1} + (\\mathbf r_2 - \\mu_2) \\left( \\frac{1}{\\sigma'_1} - \\frac{1}{\\sigma'_2} \\right) \\\\\n1400: &= \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} + \\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\mathbf{1} + \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\\\\n1401: &= \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1402: \\end{aligned}\n1403: \n1404: $$\n1405: The final line follows by recognizing the definitions of the three components.\n1406: \n1407: **Step 2: Bound on the Squared Norm.**\n1408: The bound on the total squared norm follows from the triangle inequality (`||A+B+C|| <= ||A|| + ||B|| + ||C||`) and the elementary inequality $(a+b+c)^2 \\le 3(a^2+b^2+c^2)$ for non-negative reals. For vectors, this becomes:\n1409: \n1410: $$\n1411: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\\|_2^2 \\le \\left( \\|\\Delta_{\\text{direct}}\\|_2 + \\|\\Delta_{\\text{mean}}\\|_2 + \\|\\Delta_{\\text{denom}}\\|_2 \\right)^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1412: \n1413: $$\n1414: \n1415: This completes the proof.\n1416: \n1417: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-direct-shift-bound-sq",
      "title": "Bound on the Squared Direct Shift Component",
      "start_line": 1421,
      "end_line": 1467,
      "header_lines": [
        1422
      ],
      "content_start": 1424,
      "content_end": 1466,
      "content": "1424: :label: lem-sasaki-direct-shift-bound-sq\n1425: \n1426: Let $\\mathcal S$ be a fixed swarm state. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. The squared Euclidean norm of the direct shift error component, $\\Delta_{\\text{direct}} = (\\mathbf r_1 - \\mathbf r_2) / \\sigma'_1$, is bounded as follows:\n1427: \n1428: $$\n1429: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1430: \n1431: $$\n1432: \n1433: where $\\sigma_{\\min,\\mathrm{patch}} := \\sqrt{\\kappa_{\\mathrm{var,min}}+\\varepsilon_{\\mathrm{std}}^2}$ is the uniform lower bound from the regularized standard deviation.\n1434: \n1435: ```{dropdown} Proof\n1436: :::{prf:proof}\n1437: The proof is a direct application of the definition of $\\Delta_{\\text{direct}}$ and the uniform lower bound on the regularized standard deviation.\n1438: \n1439: 1.  **Start with the Definition.**\n1440:     The squared L2-norm of the direct shift component is:\n1441: \n1442:     $$\n1443:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\left\\| \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} \\right\\|_2^2\n1444:     $$\n1445: \n1446: 2.  **Factor out the Scalar Term.**\n1447:     Since $\\sigma'_1$ is a scalar value for the fixed swarm state and value vector $\\mathbf r_1$, we can factor it out of the norm:\n1448: \n1449:     $$\n1450:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\frac{1}{(\\sigma'_1)^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1451:     $$\n1452: \n1453: 3.  **Apply the Uniform Lower Bound.**\n1454:     The regularized standard deviation function $\\sigma'_{\\mathrm{patch}}(V)$ is, by construction in the framework ({prf:ref}`def-statistical-properties-measurement`), strictly positive and uniformly bounded below by the constant $\\sigma_{\\min,\\mathrm{patch}}$. Therefore, $\\sigma'_1 \\ge \\sigma_{\\min,\\mathrm{patch}} > 0$. This implies:\n1455: \n1456:     $$\n1457:     \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1458:     $$\n1459: \n1460: 4.  **Combine to Finalize the Bound.**\n1461:     Substituting the inequality from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1462: \n1463:     $$\n1464:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1465:     $$\n1466: ",
      "metadata": {
        "label": "lem-sasaki-direct-shift-bound-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1421: ##### 2.3.4.2. Sub-Lemma: Bounding the Squared Direct Shift Component\n1422: \n1423: :::{prf:lemma} Bound on the Squared Direct Shift Component\n1424: :label: lem-sasaki-direct-shift-bound-sq\n1425: \n1426: Let $\\mathcal S$ be a fixed swarm state. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. The squared Euclidean norm of the direct shift error component, $\\Delta_{\\text{direct}} = (\\mathbf r_1 - \\mathbf r_2) / \\sigma'_1$, is bounded as follows:\n1427: \n1428: $$\n1429: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1430: \n1431: $$\n1432: \n1433: where $\\sigma_{\\min,\\mathrm{patch}} := \\sqrt{\\kappa_{\\mathrm{var,min}}+\\varepsilon_{\\mathrm{std}}^2}$ is the uniform lower bound from the regularized standard deviation.\n1434: \n1435: ```{dropdown} Proof\n1436: :::{prf:proof}\n1437: The proof is a direct application of the definition of $\\Delta_{\\text{direct}}$ and the uniform lower bound on the regularized standard deviation.\n1438: \n1439: 1.  **Start with the Definition.**\n1440:     The squared L2-norm of the direct shift component is:\n1441: \n1442:     $$\n1443:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\left\\| \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} \\right\\|_2^2\n1444:     $$\n1445: \n1446: 2.  **Factor out the Scalar Term.**\n1447:     Since $\\sigma'_1$ is a scalar value for the fixed swarm state and value vector $\\mathbf r_1$, we can factor it out of the norm:\n1448: \n1449:     $$\n1450:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\frac{1}{(\\sigma'_1)^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1451:     $$\n1452: \n1453: 3.  **Apply the Uniform Lower Bound.**\n1454:     The regularized standard deviation function $\\sigma'_{\\mathrm{patch}}(V)$ is, by construction in the framework ({prf:ref}`def-statistical-properties-measurement`), strictly positive and uniformly bounded below by the constant $\\sigma_{\\min,\\mathrm{patch}}$. Therefore, $\\sigma'_1 \\ge \\sigma_{\\min,\\mathrm{patch}} > 0$. This implies:\n1455: \n1456:     $$\n1457:     \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1458:     $$\n1459: \n1460: 4.  **Combine to Finalize the Bound.**\n1461:     Substituting the inequality from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1462: \n1463:     $$\n1464:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1465:     $$\n1466: \n1467: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-mean-shift-bound-sq",
      "title": "Bound on the Squared Mean Shift Component",
      "start_line": 1471,
      "end_line": 1520,
      "header_lines": [
        1472
      ],
      "content_start": 1474,
      "content_end": 1519,
      "content": "1474: :label: lem-sasaki-mean-shift-bound-sq\n1475: \n1476: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors. The squared Euclidean norm of the mean shift error component, $\\Delta_{\\text{mean}} = ((\\mu_2 - \\mu_1) / \\sigma'_1) \\cdot \\mathbf{1}$, is bounded as follows:\n1477: \n1478: $$\n1479: \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1480: \n1481: $$\n1482: \n1483: where $L_{\\mu,M}^{\\mathrm{Sasaki}}(k)$ is the axiomatic **Value Lipschitz Function** for the aggregator's mean from {prf:ref}`lem-sasaki-aggregator-lipschitz`.\n1484: \n1485: ```{dropdown} Proof\n1486: :::{prf:proof}\n1487: The proof combines the definition of the mean shift component with the axiomatic continuity of the mean aggregator.\n1488: \n1489: 1.  **Start with the Definition.**\n1490:     The squared L2-norm of the mean shift component is:\n1491: \n1492:     $$\n1493:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\left\\| \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1} \\right\\|_2^2\n1494:     $$\n1495: \n1496: 2.  **Factor out the Scalar and Evaluate the Norm.**\n1497:     The term $(\\mu_2 - \\mu_1) / \\sigma'_1$ is a scalar. The L2-norm of the k-dimensional vector of ones, $\\mathbf{1}$, is $\\|\\mathbf{1}\\|_2 = \\sqrt{k}$. Therefore, the squared norm is:\n1498: \n1499:     $$\n1500:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} \\cdot \\|\\mathbf{1}\\|_2^2 = \\frac{k \\cdot (\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2}\n1501:     $$\n1502: \n1503: 3.  **Apply Axiomatic Continuity of the Mean.**\n1504:     The empirical aggregator is Lipschitz continuous with respect to the raw value vector, as established in {prf:ref}`lem-sasaki-aggregator-value`. This provides the bound:\n1505: \n1506:     $$\n1507:     |\\mu_2 - \\mu_1|^2 \\le \\left(L_{\\mu,M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1508:     $$\n1509: \n1510: 4.  **Apply the Uniform Lower Bound.**\n1511:     As in the previous lemma, we use the bound $1/(\\sigma'_1)^2 \\le 1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1512: \n1513: 5.  **Combine to Finalize the Bound.**\n1514:     Substituting the bounds from Step 3 and Step 4 into the expression from Step 2 yields the final result as stated in the lemma.\n1515: \n1516:     $$\n1517:     \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1518:     $$\n1519: ",
      "metadata": {
        "label": "lem-sasaki-mean-shift-bound-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1471: ##### 2.3.4.3. Sub-Lemma: Bounding the Squared Mean Shift Component\n1472: \n1473: :::{prf:lemma} Bound on the Squared Mean Shift Component\n1474: :label: lem-sasaki-mean-shift-bound-sq\n1475: \n1476: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors. The squared Euclidean norm of the mean shift error component, $\\Delta_{\\text{mean}} = ((\\mu_2 - \\mu_1) / \\sigma'_1) \\cdot \\mathbf{1}$, is bounded as follows:\n1477: \n1478: $$\n1479: \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1480: \n1481: $$\n1482: \n1483: where $L_{\\mu,M}^{\\mathrm{Sasaki}}(k)$ is the axiomatic **Value Lipschitz Function** for the aggregator's mean from {prf:ref}`lem-sasaki-aggregator-lipschitz`.\n1484: \n1485: ```{dropdown} Proof\n1486: :::{prf:proof}\n1487: The proof combines the definition of the mean shift component with the axiomatic continuity of the mean aggregator.\n1488: \n1489: 1.  **Start with the Definition.**\n1490:     The squared L2-norm of the mean shift component is:\n1491: \n1492:     $$\n1493:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\left\\| \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1} \\right\\|_2^2\n1494:     $$\n1495: \n1496: 2.  **Factor out the Scalar and Evaluate the Norm.**\n1497:     The term $(\\mu_2 - \\mu_1) / \\sigma'_1$ is a scalar. The L2-norm of the k-dimensional vector of ones, $\\mathbf{1}$, is $\\|\\mathbf{1}\\|_2 = \\sqrt{k}$. Therefore, the squared norm is:\n1498: \n1499:     $$\n1500:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} \\cdot \\|\\mathbf{1}\\|_2^2 = \\frac{k \\cdot (\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2}\n1501:     $$\n1502: \n1503: 3.  **Apply Axiomatic Continuity of the Mean.**\n1504:     The empirical aggregator is Lipschitz continuous with respect to the raw value vector, as established in {prf:ref}`lem-sasaki-aggregator-value`. This provides the bound:\n1505: \n1506:     $$\n1507:     |\\mu_2 - \\mu_1|^2 \\le \\left(L_{\\mu,M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1508:     $$\n1509: \n1510: 4.  **Apply the Uniform Lower Bound.**\n1511:     As in the previous lemma, we use the bound $1/(\\sigma'_1)^2 \\le 1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1512: \n1513: 5.  **Combine to Finalize the Bound.**\n1514:     Substituting the bounds from Step 3 and Step 4 into the expression from Step 2 yields the final result as stated in the lemma.\n1515: \n1516:     $$\n1517:     \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1518:     $$\n1519: \n1520: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-denom-shift-bound-sq",
      "title": "Bounding the Squared Denominator Shift Component",
      "start_line": 1524,
      "end_line": 1584,
      "header_lines": [
        1525
      ],
      "content_start": 1527,
      "content_end": 1583,
      "content": "1527: :label: lem-sasaki-denom-shift-bound-sq\n1528: \n1529: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the denominator shift error component, $\\Delta_{\\text{denom}} = \\mathbf z_2 \\cdot ((\\sigma'_2 - \\sigma'_1) / \\sigma'_1)$, is bounded as follows:\n1530: \n1531: $$\n1532: \\|\\Delta_{\\text{denom}}\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\left( \\frac{L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1533: \n1534: $$\n1535: \n1536: where $L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)$ is the derived Lipschitz constant for the regularized standard deviation.\n1537: \n1538: ```{dropdown} Proof\n1539: :::{prf:proof}\n1540: The proof bounds the squared norm by bounding its three constituent parts: the norm of the standardized vector, the change in the regularized standard deviation, and the inverse of the standard deviation.\n1541: \n1542: 1.  **Start with the Definition.**\n1543:     The squared L2-norm of the denominator shift component is:\n1544: \n1545:     $$\n1546:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\left\\| \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\right\\|_2^2\n1547:     $$\n1548: \n1549: 2.  **Factor out the Scalar Term.**\n1550:     The fractional term involving the standard deviations is a scalar. We factor it out of the norm:\n1551: \n1552:     $$\n1553:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\|\\mathbf z_2\\|_2^2 \\cdot \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2}\n1554:     $$\n1555: \n1556: 3.  **Bound Each Factor.**\n1557:     We now find a deterministic upper bound for each of the three factors in the expression.\n1558:     *   **Bound on `||z2||_2^2`**: The framework provides a universal bound on the squared norm of any standardized vector, proven in {prf:ref}`thm-z-score-norm-bound`. For the k-dimensional vector $\\mathbf z_2$, this is:\n1559: \n1560:         $$\n1561:         \\|\\mathbf z_2\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1562:         $$\n1563: \n1564:     *   **Bound on `(sigma'_2 - sigma'_1)^2`**: The regularized standard deviation function is Lipschitz continuous with respect to the raw value vector, as established by composing the Lipschitz properties of the aggregator moments and the patching function itself ({prf:ref}`lem-stats-value-continuity` in the framework). This gives:\n1565: \n1566:         $$\n1567:         (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1568:         $$\n1569: \n1570:     *   **Bound on `1/(sigma'_1)^2`**: As in the preceding lemmas, we use the uniform lower bound:\n1571: \n1572:         $$\n1573:         \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1574:         $$\n1575: \n1576: 4.  **Combine to Finalize the Bound.**\n1577:     Substituting the bounds for all three factors from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1578: \n1579:     $$\n1580:     \\|\\Delta_{\\text{denom}}\\|_2^2 \\le \\left( k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\right) \\cdot \\left( \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2 \\right) \\cdot \\left( \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right)\n1581:     $$\n1582:     Rearranging the terms gives the stated result.\n1583: ",
      "metadata": {
        "label": "lem-sasaki-denom-shift-bound-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1524: ##### 2.3.4.4. Sub-Lemma: Bounding the Squared Denominator Shift Component\n1525: \n1526: :::{prf:lemma} Bounding the Squared Denominator Shift Component\n1527: :label: lem-sasaki-denom-shift-bound-sq\n1528: \n1529: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the denominator shift error component, $\\Delta_{\\text{denom}} = \\mathbf z_2 \\cdot ((\\sigma'_2 - \\sigma'_1) / \\sigma'_1)$, is bounded as follows:\n1530: \n1531: $$\n1532: \\|\\Delta_{\\text{denom}}\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\left( \\frac{L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1533: \n1534: $$\n1535: \n1536: where $L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)$ is the derived Lipschitz constant for the regularized standard deviation.\n1537: \n1538: ```{dropdown} Proof\n1539: :::{prf:proof}\n1540: The proof bounds the squared norm by bounding its three constituent parts: the norm of the standardized vector, the change in the regularized standard deviation, and the inverse of the standard deviation.\n1541: \n1542: 1.  **Start with the Definition.**\n1543:     The squared L2-norm of the denominator shift component is:\n1544: \n1545:     $$\n1546:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\left\\| \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\right\\|_2^2\n1547:     $$\n1548: \n1549: 2.  **Factor out the Scalar Term.**\n1550:     The fractional term involving the standard deviations is a scalar. We factor it out of the norm:\n1551: \n1552:     $$\n1553:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\|\\mathbf z_2\\|_2^2 \\cdot \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2}\n1554:     $$\n1555: \n1556: 3.  **Bound Each Factor.**\n1557:     We now find a deterministic upper bound for each of the three factors in the expression.\n1558:     *   **Bound on `||z2||_2^2`**: The framework provides a universal bound on the squared norm of any standardized vector, proven in {prf:ref}`thm-z-score-norm-bound`. For the k-dimensional vector $\\mathbf z_2$, this is:\n1559: \n1560:         $$\n1561:         \\|\\mathbf z_2\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1562:         $$\n1563: \n1564:     *   **Bound on `(sigma'_2 - sigma'_1)^2`**: The regularized standard deviation function is Lipschitz continuous with respect to the raw value vector, as established by composing the Lipschitz properties of the aggregator moments and the patching function itself ({prf:ref}`lem-stats-value-continuity` in the framework). This gives:\n1565: \n1566:         $$\n1567:         (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1568:         $$\n1569: \n1570:     *   **Bound on `1/(sigma'_1)^2`**: As in the preceding lemmas, we use the uniform lower bound:\n1571: \n1572:         $$\n1573:         \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1574:         $$\n1575: \n1576: 4.  **Combine to Finalize the Bound.**\n1577:     Substituting the bounds for all three factors from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1578: \n1579:     $$\n1580:     \\|\\Delta_{\\text{denom}}\\|_2^2 \\le \\left( k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\right) \\cdot \\left( \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2 \\right) \\cdot \\left( \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right)\n1581:     $$\n1582:     Rearranging the terms gives the stated result.\n1583: \n1584: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-structural-error-decomposition",
      "title": "Decomposition of the Structural Error",
      "start_line": 1695,
      "end_line": 1747,
      "header_lines": [
        1696
      ],
      "content_start": 1698,
      "content_end": 1746,
      "content": "1698: :label: lem-sasaki-structural-error-decomposition\n1699: \n1700: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. Let $\\mathbf z_1 = z(\\mathcal S_1, \\mathbf r_2)$ and $\\mathbf z_2 = z(\\mathcal S_2, \\mathbf r_2)$ be the corresponding N-dimensional standardized vectors, computed using the fixed raw values from the second swarm but the structure of each respective swarm.\n1701: \n1702: The total structural error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of two **orthogonal** components:\n1703: \n1704: $$\n1705: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\n1706: \n1707: $$\n1708: \n1709: where:\n1710: 1.  **The Direct Error ($\\Delta_{\\text{direct}}$):** The error vector whose non-zero components correspond to walkers whose status changes between $\\mathcal S_1$ and $\\mathcal S_2$.\n1711: 2.  **The Indirect Error ($\\Delta_{\\text{indirect}}$):** The error vector whose non-zero components correspond to walkers that are alive in both swarms.\n1712: \n1713: Because these two vectors have disjoint support, the squared L2-norm of the total error is the sum of the squared L2-norms of the components:\n1714: \n1715: $$\n1716: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1717: \n1718: $$\n1719: \n1720: ```{dropdown} Proof\n1721: :::{prf:proof}\n1722: The proof follows from partitioning the sum of squared errors over the N walker indices. Let the full set of indices be $\\{1, ..., N\\}$.\n1723: \n1724: 1.  **Define Index Partitions.**\n1725:     Let $\\mathcal{A}_{\\text{unstable}} := \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$ be the set of indices of walkers whose survival status changes. Let $\\mathcal{A}_{\\text{stable}} := \\mathcal{A}(\\mathcal S_1) \\cap \\mathcal{A}(\\mathcal S_2)$ be the set of indices for walkers that remain alive. Let $\\mathcal{D}_{\\text{stable}}$ be the indices of walkers dead in both swarms. These three sets form a partition of $\\{1, ..., N\\}$.\n1726: \n1727: 2.  **Analyze Error Components on Each Partition.**\n1728:     *   For $i \\in \\mathcal{A}_{\\text{unstable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero.\n1729:     *   For $i \\in \\mathcal{A}_{\\text{stable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero because the statistical moments $(\\mu, \\sigma')$ change with the swarm structure.\n1730:     *   For $i \\in \\mathcal{D}_{\\text{stable}}$, both $z_{1,i}$ and $z_{2,i}$ are deterministically zero by the definition of the standardization operator. The error component is zero.\n1731: \n1732: 3.  **Define Orthogonal Error Vectors.**\n1733:     We define the vector $\\Delta_{\\text{direct}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{unstable}}$ and zero otherwise. We define $\\Delta_{\\text{indirect}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{stable}}$ and zero otherwise. By construction, $\\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}$.\n1734: \n1735: 4.  **Show Orthogonality.**\n1736:     The two vectors have disjoint support, meaning for any index $i$, at most one of the vectors can have a non-zero component. Therefore, their dot product is zero: $\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}} = 0$.\n1737: \n1738: 5.  **Finalize the Squared Norm Identity.**\n1739:     For orthogonal vectors, the squared norm of the sum is the sum of the squared norms:\n1740: \n1741:     $$\n1742:     \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2 + 2(\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}}) = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1743:     $$\n1744: \n1745: This completes the proof.\n1746: ",
      "metadata": {
        "label": "lem-sasaki-structural-error-decomposition"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1695: ##### 2.3.6.1. Sub-Lemma: Decomposition of the Structural Error\n1696: \n1697: :::{prf:lemma} Decomposition of the Structural Error\n1698: :label: lem-sasaki-structural-error-decomposition\n1699: \n1700: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. Let $\\mathbf z_1 = z(\\mathcal S_1, \\mathbf r_2)$ and $\\mathbf z_2 = z(\\mathcal S_2, \\mathbf r_2)$ be the corresponding N-dimensional standardized vectors, computed using the fixed raw values from the second swarm but the structure of each respective swarm.\n1701: \n1702: The total structural error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of two **orthogonal** components:\n1703: \n1704: $$\n1705: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\n1706: \n1707: $$\n1708: \n1709: where:\n1710: 1.  **The Direct Error ($\\Delta_{\\text{direct}}$):** The error vector whose non-zero components correspond to walkers whose status changes between $\\mathcal S_1$ and $\\mathcal S_2$.\n1711: 2.  **The Indirect Error ($\\Delta_{\\text{indirect}}$):** The error vector whose non-zero components correspond to walkers that are alive in both swarms.\n1712: \n1713: Because these two vectors have disjoint support, the squared L2-norm of the total error is the sum of the squared L2-norms of the components:\n1714: \n1715: $$\n1716: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1717: \n1718: $$\n1719: \n1720: ```{dropdown} Proof\n1721: :::{prf:proof}\n1722: The proof follows from partitioning the sum of squared errors over the N walker indices. Let the full set of indices be $\\{1, ..., N\\}$.\n1723: \n1724: 1.  **Define Index Partitions.**\n1725:     Let $\\mathcal{A}_{\\text{unstable}} := \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$ be the set of indices of walkers whose survival status changes. Let $\\mathcal{A}_{\\text{stable}} := \\mathcal{A}(\\mathcal S_1) \\cap \\mathcal{A}(\\mathcal S_2)$ be the set of indices for walkers that remain alive. Let $\\mathcal{D}_{\\text{stable}}$ be the indices of walkers dead in both swarms. These three sets form a partition of $\\{1, ..., N\\}$.\n1726: \n1727: 2.  **Analyze Error Components on Each Partition.**\n1728:     *   For $i \\in \\mathcal{A}_{\\text{unstable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero.\n1729:     *   For $i \\in \\mathcal{A}_{\\text{stable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero because the statistical moments $(\\mu, \\sigma')$ change with the swarm structure.\n1730:     *   For $i \\in \\mathcal{D}_{\\text{stable}}$, both $z_{1,i}$ and $z_{2,i}$ are deterministically zero by the definition of the standardization operator. The error component is zero.\n1731: \n1732: 3.  **Define Orthogonal Error Vectors.**\n1733:     We define the vector $\\Delta_{\\text{direct}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{unstable}}$ and zero otherwise. We define $\\Delta_{\\text{indirect}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{stable}}$ and zero otherwise. By construction, $\\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}$.\n1734: \n1735: 4.  **Show Orthogonality.**\n1736:     The two vectors have disjoint support, meaning for any index $i$, at most one of the vectors can have a non-zero component. Therefore, their dot product is zero: $\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}} = 0$.\n1737: \n1738: 5.  **Finalize the Squared Norm Identity.**\n1739:     For orthogonal vectors, the squared norm of the sum is the sum of the squared norms:\n1740: \n1741:     $$\n1742:     \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2 + 2(\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}}) = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1743:     $$\n1744: \n1745: This completes the proof.\n1746: \n1747: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-direct-structural-error-sq",
      "title": "Bound on the Squared Direct Structural Error",
      "start_line": 1751,
      "end_line": 1801,
      "header_lines": [
        1752
      ],
      "content_start": 1754,
      "content_end": 1800,
      "content": "1754: :label: lem-sasaki-direct-structural-error-sq\n1755: \n1756: Let $\\mathbf r_2$ be a fixed raw value vector with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the direct structural error component, $\\|\\Delta_{\\text{direct}}\\|_2^2$, is bounded by a term linear in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1757: \n1758: $$\n1759: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1760: \n1761: $$\n1762: \n1763: ```{dropdown} Proof\n1764: :::{prf:proof}\n1765: The proof bounds the squared error for each unstable walker and sums the results.\n1766: \n1767: 1.  **Isolate the Sum.**\n1768:     By definition, the vector $\\Delta_{\\text{direct}}$ has non-zero components only for walkers in the unstable set $\\mathcal{A}_{\\text{unstable}} = \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$. The number of walkers in this set is exactly $n_c = n_c(\\mathcal S_1, \\mathcal S_2)$. The squared norm is the sum of the squared errors over this set:\n1769: \n1770:     $$\n1771:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2\n1772:     $$\n1773: \n1774: 2.  **Bound the Error for a Single Unstable Walker.**\n1775:     Consider a single walker $i \\in \\mathcal{A}_{\\text{unstable}}$. Its status changes between $\\mathcal S_1$ and $\\mathcal S_2$. This means one of two cases:\n1776:     *   Case A: Walker $i$ is alive in $\\mathcal S_1$ and dead in $\\mathcal S_2$. Then $z_{2,i} = 0$. The error is $(z_{1,i})^2$.\n1777:     *   Case B: Walker $i$ is dead in $\\mathcal S_1$ and alive in $\\mathcal S_2$. Then $z_{1,i} = 0$. The error is $(-z_{2,i})^2 = (z_{2,i})^2$.\n1778: \n1779:     In both cases, the squared error for walker $i$ is the square of a single, valid standardized score.\n1780: \n1781: 3.  **Apply the Universal Z-Score Bound.**\n1782:     The framework provides a universal bound for the magnitude of any single standardized score in {prf:ref}`thm-z-score-norm-bound`, which is $|z_j| \\le 2V_{\\max}^{(R)} / \\sigma_{\\min,\\mathrm{patch}}$. Squaring this gives a uniform bound for the squared error of any unstable walker:\n1783: \n1784:     $$\n1785:     (z_{1,i} - z_{2,i})^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1786:     $$\n1787: \n1788: 4.  **Sum Over All Unstable Walkers.**\n1789:     We sum this uniform bound over all $n_c$ walkers in the unstable set:\n1790: \n1791:     $$\n1792:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i=1}^{n_c} \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1793:     $$\n1794: \n1795:     This yields the final result as stated in the lemma.\n1796: \n1797:     $$\n1798:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le n_c \\cdot \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1799:     $$\n1800: ",
      "metadata": {
        "label": "lem-sasaki-direct-structural-error-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1751: ##### 2.3.6.2. Sub-Lemma: Bounding the Squared Direct Structural Error\n1752: \n1753: :::{prf:lemma} Bound on the Squared Direct Structural Error\n1754: :label: lem-sasaki-direct-structural-error-sq\n1755: \n1756: Let $\\mathbf r_2$ be a fixed raw value vector with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the direct structural error component, $\\|\\Delta_{\\text{direct}}\\|_2^2$, is bounded by a term linear in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1757: \n1758: $$\n1759: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1760: \n1761: $$\n1762: \n1763: ```{dropdown} Proof\n1764: :::{prf:proof}\n1765: The proof bounds the squared error for each unstable walker and sums the results.\n1766: \n1767: 1.  **Isolate the Sum.**\n1768:     By definition, the vector $\\Delta_{\\text{direct}}$ has non-zero components only for walkers in the unstable set $\\mathcal{A}_{\\text{unstable}} = \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$. The number of walkers in this set is exactly $n_c = n_c(\\mathcal S_1, \\mathcal S_2)$. The squared norm is the sum of the squared errors over this set:\n1769: \n1770:     $$\n1771:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2\n1772:     $$\n1773: \n1774: 2.  **Bound the Error for a Single Unstable Walker.**\n1775:     Consider a single walker $i \\in \\mathcal{A}_{\\text{unstable}}$. Its status changes between $\\mathcal S_1$ and $\\mathcal S_2$. This means one of two cases:\n1776:     *   Case A: Walker $i$ is alive in $\\mathcal S_1$ and dead in $\\mathcal S_2$. Then $z_{2,i} = 0$. The error is $(z_{1,i})^2$.\n1777:     *   Case B: Walker $i$ is dead in $\\mathcal S_1$ and alive in $\\mathcal S_2$. Then $z_{1,i} = 0$. The error is $(-z_{2,i})^2 = (z_{2,i})^2$.\n1778: \n1779:     In both cases, the squared error for walker $i$ is the square of a single, valid standardized score.\n1780: \n1781: 3.  **Apply the Universal Z-Score Bound.**\n1782:     The framework provides a universal bound for the magnitude of any single standardized score in {prf:ref}`thm-z-score-norm-bound`, which is $|z_j| \\le 2V_{\\max}^{(R)} / \\sigma_{\\min,\\mathrm{patch}}$. Squaring this gives a uniform bound for the squared error of any unstable walker:\n1783: \n1784:     $$\n1785:     (z_{1,i} - z_{2,i})^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1786:     $$\n1787: \n1788: 4.  **Sum Over All Unstable Walkers.**\n1789:     We sum this uniform bound over all $n_c$ walkers in the unstable set:\n1790: \n1791:     $$\n1792:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i=1}^{n_c} \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1793:     $$\n1794: \n1795:     This yields the final result as stated in the lemma.\n1796: \n1797:     $$\n1798:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le n_c \\cdot \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1799:     $$\n1800: \n1801: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-indirect-structural-error-sq",
      "title": "Bound on the Squared Indirect Structural Error",
      "start_line": 1805,
      "end_line": 1891,
      "header_lines": [
        1806
      ],
      "content_start": 1808,
      "content_end": 1890,
      "content": "1808: :label: lem-sasaki-indirect-structural-error-sq\n1809: \n1810: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. The squared Euclidean norm of the indirect structural error component, $\\|\\Delta_{\\text{indirect}}\\|_2^2$, is bounded by a term quadratic in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1811: \n1812: $$\n1813: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1814: \n1815: $$\n1816: \n1817: where $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}$ is the **Squared Indirect Structural Error Coefficient** defined in {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1818: \n1819: ```{dropdown} Proof\n1820: :::{prf:proof}\n1821: The proof decomposes the error for each stable walker into a mean-shift and a denominator-shift component and then bounds the sum of their squares.\n1822: \n1823: **Step 1: Decompose the Error for a Single Stable Walker.**\n1824: For any walker $i$ in the stable set $\\mathcal A_{\\mathrm{stable}} = \\mathcal A(\\mathcal S_1) \\cap \\mathcal A(\\mathcal S_2)$, the error is:\n1825: \n1826: $$\n1827: \\begin{aligned}\n1828: z_{1,i} - z_{2,i} &= \\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2} \\\\\n1829: &= \\left(\\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_1}\\right) + \\left(\\frac{r_{2,i} - \\mu_2}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2}\\right) \\\\\n1830: &= \\underbrace{\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}}_{\\text{Mean Shift}} + \\underbrace{z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}}_{\\text{Denominator Shift}}\n1831: \\end{aligned}\n1832: \n1833: $$\n1834: The squared error for this single walker is bounded using $(a+b)^2 \\le 2(a^2+b^2)$:\n1835: \n1836: $$\n1837: (z_{1,i} - z_{2,i})^2 \\le 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1838: \n1839: $$\n1840: \n1841: **Step 2: Sum the Errors Over All Stable Walkers.**\n1842: The total squared indirect error is the sum over all $i \\in \\mathcal A_{\\mathrm{stable}}$. Let $k_{\\mathrm{stable}} := |\\mathcal A_{\\mathrm{stable}}|$.\n1843: \n1844: $$\n1845: \\|\\Delta_{\\text{indirect}}\\|_2^2 = \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1846: \n1847: $$\n1848: \n1849: This can be simplified:\n1850: \n1851: $$\n1852: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} + 2 \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2} \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2\n1853: \n1854: $$\n1855: \n1856: **Step 3: Bound the Components.**\n1857: We now bound each term using the axiomatic properties of the aggregator and the uniform bounds from the framework.\n1858: *   **Bound on `(mu_2 - mu_1)^2`**: The structural continuity of the empirical mean ({prf:ref}`lem-sasaki-aggregator-structural`) gives:\n1859: \n1860:     $$\n1861:     (\\mu_2 - \\mu_1)^2 \\le \\left(L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min}) \\cdot n_c\\right)^2\n1862:     $$\n1863: *   **Bound on `(sigma'_2 - sigma'_1)^2`**: By composing the structural continuity of the variance with the Lipschitz property of the patching function ({prf:ref}`lem-stats-structural-continuity` in the framework), we get:\n1864: \n1865:     $$\n1866:     (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',S}^{\\mathrm{Sasaki}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c\\right)^2\n1867:     $$\n1868: *   **Bound on `sum(z_2,i^2)`**: The sum is over the stable set, which is a subset of the alive walkers in $\\mathcal S_2$. Thus, the sum is bounded by the total squared norm of the z-score vector for $\\mathcal S_2$:\n1869: \n1870:     $$\n1871:     \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2 \\le \\|\\mathbf z_2\\|_2^2 \\le k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1872:     $$\n1873: *   **Bound on `1/(sigma'_1)^2`**: This is bounded by $1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1874: \n1875: **Step 4: Assemble the Final Bound.**\n1876: Substituting these bounds back into the inequality from Step 2 gives a bound that is quadratic in $n_c$.\n1877: \n1878: $$\n1879: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 \\frac{(L_{\\sigma',S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1880: \n1881: $$\n1882: \n1883: Factoring out $n_c^2$ and combining the coefficients gives:\n1884: \n1885: $$\n1886: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le \\left[ 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2 \\frac{(L_{\\sigma',S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right] \\cdot n_c^2\n1887: \n1888: $$\n1889: The term in the brackets is precisely the definition of the **Squared Indirect Structural Error Coefficient**, $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2)$. This completes the proof.\n1890: ",
      "metadata": {
        "label": "lem-sasaki-indirect-structural-error-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "raw_directive": "1805: ##### 2.3.6.3. Sub-Lemma: Bounding the Squared Indirect Structural Error\n1806: \n1807: :::{prf:lemma} Bound on the Squared Indirect Structural Error\n1808: :label: lem-sasaki-indirect-structural-error-sq\n1809: \n1810: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. The squared Euclidean norm of the indirect structural error component, $\\|\\Delta_{\\text{indirect}}\\|_2^2$, is bounded by a term quadratic in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1811: \n1812: $$\n1813: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1814: \n1815: $$\n1816: \n1817: where $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}$ is the **Squared Indirect Structural Error Coefficient** defined in {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1818: \n1819: ```{dropdown} Proof\n1820: :::{prf:proof}\n1821: The proof decomposes the error for each stable walker into a mean-shift and a denominator-shift component and then bounds the sum of their squares.\n1822: \n1823: **Step 1: Decompose the Error for a Single Stable Walker.**\n1824: For any walker $i$ in the stable set $\\mathcal A_{\\mathrm{stable}} = \\mathcal A(\\mathcal S_1) \\cap \\mathcal A(\\mathcal S_2)$, the error is:\n1825: \n1826: $$\n1827: \\begin{aligned}\n1828: z_{1,i} - z_{2,i} &= \\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2} \\\\\n1829: &= \\left(\\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_1}\\right) + \\left(\\frac{r_{2,i} - \\mu_2}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2}\\right) \\\\\n1830: &= \\underbrace{\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}}_{\\text{Mean Shift}} + \\underbrace{z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}}_{\\text{Denominator Shift}}\n1831: \\end{aligned}\n1832: \n1833: $$\n1834: The squared error for this single walker is bounded using $(a+b)^2 \\le 2(a^2+b^2)$:\n1835: \n1836: $$\n1837: (z_{1,i} - z_{2,i})^2 \\le 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1838: \n1839: $$\n1840: \n1841: **Step 2: Sum the Errors Over All Stable Walkers.**\n1842: The total squared indirect error is the sum over all $i \\in \\mathcal A_{\\mathrm{stable}}$. Let $k_{\\mathrm{stable}} := |\\mathcal A_{\\mathrm{stable}}|$.\n1843: \n1844: $$\n1845: \\|\\Delta_{\\text{indirect}}\\|_2^2 = \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1846: \n1847: $$\n1848: \n1849: This can be simplified:\n1850: \n1851: $$\n1852: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} + 2 \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2} \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2\n1853: \n1854: $$\n1855: \n1856: **Step 3: Bound the Components.**\n1857: We now bound each term using the axiomatic properties of the aggregator and the uniform bounds from the framework.\n1858: *   **Bound on `(mu_2 - mu_1)^2`**: The structural continuity of the empirical mean ({prf:ref}`lem-sasaki-aggregator-structural`) gives:\n1859: \n1860:     $$\n1861:     (\\mu_2 - \\mu_1)^2 \\le \\left(L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min}) \\cdot n_c\\right)^2\n1862:     $$\n1863: *   **Bound on `(sigma'_2 - sigma'_1)^2`**: By composing the structural continuity of the variance with the Lipschitz property of the patching function ({prf:ref}`lem-stats-structural-continuity` in the framework), we get:\n1864: \n1865:     $$\n1866:     (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',S}^{\\mathrm{Sasaki}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c\\right)^2\n1867:     $$\n1868: *   **Bound on `sum(z_2,i^2)`**: The sum is over the stable set, which is a subset of the alive walkers in $\\mathcal S_2$. Thus, the sum is bounded by the total squared norm of the z-score vector for $\\mathcal S_2$:\n1869: \n1870:     $$\n1871:     \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2 \\le \\|\\mathbf z_2\\|_2^2 \\le k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1872:     $$\n1873: *   **Bound on `1/(sigma'_1)^2`**: This is bounded by $1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1874: \n1875: **Step 4: Assemble the Final Bound.**\n1876: Substituting these bounds back into the inequality from Step 2 gives a bound that is quadratic in $n_c$.\n1877: \n1878: $$\n1879: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 \\frac{(L_{\\sigma',S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1880: \n1881: $$\n1882: \n1883: Factoring out $n_c^2$ and combining the coefficients gives:\n1884: \n1885: $$\n1886: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le \\left[ 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2 \\frac{(L_{\\sigma',S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right] \\cdot n_c^2\n1887: \n1888: $$\n1889: The term in the brackets is precisely the definition of the **Squared Indirect Structural Error Coefficient**, $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2)$. This completes the proof.\n1890: \n1891: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-wasserstein-decomposition",
      "title": "Decomposition of the Hypocoercive Wasserstein Distance",
      "start_line": 466,
      "end_line": 475,
      "header_lines": [
        467
      ],
      "content_start": 469,
      "content_end": 474,
      "content": "469: :label: lem-wasserstein-decomposition\n470: \n471: The total inter-swarm error, as measured by the squared hypocoercive Wasserstein distance $W_h^2(\\mu_1, \\mu_2)$ between the two swarms' full empirical measures $\\mu_1$ and $\\mu_2$, decomposes exactly into the sum of the location and structural error components:\n472: \n473: $$\n474: W_h^2(\\mu_1, \\mu_2) = V_{\\text{loc}} + V_{\\text{struct}}",
      "metadata": {
        "label": "lem-wasserstein-decomposition"
      },
      "section": "## 3. The Augmented Hypocoercive Lyapunov Function",
      "raw_directive": "466: A key result from optimal transport theory allows us to relate these components. The total distance between two distributions can be precisely decomposed into the distance between their centers of mass and the distance between their centered shapes.\n467: \n468: :::{prf:lemma} Decomposition of the Hypocoercive Wasserstein Distance\n469: :label: lem-wasserstein-decomposition\n470: \n471: The total inter-swarm error, as measured by the squared hypocoercive Wasserstein distance $W_h^2(\\mu_1, \\mu_2)$ between the two swarms' full empirical measures $\\mu_1$ and $\\mu_2$, decomposes exactly into the sum of the location and structural error components:\n472: \n473: $$\n474: W_h^2(\\mu_1, \\mu_2) = V_{\\text{loc}} + V_{\\text{struct}}\n475: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. The Augmented Hypocoercive Lyapunov Function"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sx-implies-variance",
      "title": "Structural Positional Error and Internal Variance",
      "start_line": 622,
      "end_line": 637,
      "header_lines": [
        623
      ],
      "content_start": 625,
      "content_end": 636,
      "content": "625: :label: lem-sx-implies-variance\n626: \n627: Let $k_1 := |\\mathcal{A}(S_1)|$ and $k_2 := |\\mathcal{A}(S_2)|$ denote the numbers of alive walkers in each swarm. Define:\n628: \n629: - $V_{\\text{x,struct}}$ as the positional component of the structural error between the two swarms' **alive-walker distributions**\n630: - $\\text{Var}_k(x) := \\frac{1}{k_{\\text{alive}}} \\sum_{i \\in \\mathcal{A}(S_k)} \\|\\delta_{x,k,i}\\|^2$ as the **physical internal positional variance** of the **alive walkers** in swarm $k$ (note: this is $k_{\\text{alive}}$-normalized, representing the actual spread of alive walkers, distinct from the Lyapunov variance component $V_{Var,x}$ which is $N$-normalized)\n631: \n632: Then:\n633: \n634: $$\n635: V_{\\text{x,struct}} \\le 2(\\text{Var}_1(x) + \\text{Var}_2(x))\n636: $$",
      "metadata": {
        "label": "lem-sx-implies-variance"
      },
      "section": "## 3. The Augmented Hypocoercive Lyapunov Function",
      "raw_directive": "622: The first step in our causal chain is to connect the state of the coupled system to the internal configuration of the individual swarms. A large mismatch in the geometric shapes of the two swarms, as measured by the positional component of the structural error ($V_{x,\\text{struct}}$), implies that at least one of the swarms must be internally spread out, i.e., have a large positional variance. This lemma makes that connection rigorous.\n623: \n624: :::{prf:lemma} Structural Positional Error and Internal Variance\n625: :label: lem-sx-implies-variance\n626: \n627: Let $k_1 := |\\mathcal{A}(S_1)|$ and $k_2 := |\\mathcal{A}(S_2)|$ denote the numbers of alive walkers in each swarm. Define:\n628: \n629: - $V_{\\text{x,struct}}$ as the positional component of the structural error between the two swarms' **alive-walker distributions**\n630: - $\\text{Var}_k(x) := \\frac{1}{k_{\\text{alive}}} \\sum_{i \\in \\mathcal{A}(S_k)} \\|\\delta_{x,k,i}\\|^2$ as the **physical internal positional variance** of the **alive walkers** in swarm $k$ (note: this is $k_{\\text{alive}}$-normalized, representing the actual spread of alive walkers, distinct from the Lyapunov variance component $V_{Var,x}$ which is $N$-normalized)\n631: \n632: Then:\n633: \n634: $$\n635: V_{\\text{x,struct}} \\le 2(\\text{Var}_1(x) + \\text{Var}_2(x))\n636: $$\n637: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. The Augmented Hypocoercive Lyapunov Function"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-greedy-preserves-signal",
      "title": "Greedy Pairing Guarantees Signal Separation",
      "start_line": 1528,
      "end_line": 1550,
      "header_lines": [
        1529
      ],
      "content_start": 1531,
      "content_end": 1549,
      "content": "1531: :label: lem-greedy-preserves-signal\n1532: \n1533: Let a swarm be in a state with high internal variance, such that its alive walkers `A_k` are partitioned into a high-error set `H_k` and a low-error set `L_k` as per Definition 5.1.3.\n1534: \n1535: The Sequential Stochastic Greedy Pairing Operator ({prf:ref}`def-greedy-pairing-algorithm`) guarantees a statistical separation in the expected raw phase-space distance measurements for these two populations. Specifically, there exist N-uniform, $\\varepsilon$-dependent bounds such that:\n1536: \n1537: 1.  For any high-error walker $i \\in H_k$, its expected raw distance is large:\n1538: \n1539: \n1540: $$\n1541: \\mathbb{E}[d_i \\mid S_t, i \\in H_k] \\ge D_H(\\epsilon)\n1542: $$\n1543: \n1544: 2.  For any low-error walker $j \\in L_k$, its expected raw distance is small:\n1545: \n1546: \n1547: $$\n1548: \\mathbb{E}[d_j \\mid S_t, j \\in L_k] \\le R_L(\\epsilon) + D_{\\mathrm{valid}} \\cdot c_k \\exp\\left(-\\frac{D_H(\\epsilon)^2 - R_L(\\epsilon)^2}{2\\epsilon^2}\\right)\n1549: $$",
      "metadata": {
        "label": "lem-greedy-preserves-signal"
      },
      "section": "## 5. The Measurement and Interaction Pipeline",
      "raw_directive": "1528: With these formal definitions, we can now prove that the practical pairing algorithm reliably detects this structure.\n1529: \n1530: :::{prf:lemma} Greedy Pairing Guarantees Signal Separation\n1531: :label: lem-greedy-preserves-signal\n1532: \n1533: Let a swarm be in a state with high internal variance, such that its alive walkers `A_k` are partitioned into a high-error set `H_k` and a low-error set `L_k` as per Definition 5.1.3.\n1534: \n1535: The Sequential Stochastic Greedy Pairing Operator ({prf:ref}`def-greedy-pairing-algorithm`) guarantees a statistical separation in the expected raw phase-space distance measurements for these two populations. Specifically, there exist N-uniform, $\\varepsilon$-dependent bounds such that:\n1536: \n1537: 1.  For any high-error walker $i \\in H_k$, its expected raw distance is large:\n1538: \n1539: \n1540: $$\n1541: \\mathbb{E}[d_i \\mid S_t, i \\in H_k] \\ge D_H(\\epsilon)\n1542: $$\n1543: \n1544: 2.  For any low-error walker $j \\in L_k$, its expected raw distance is small:\n1545: \n1546: \n1547: $$\n1548: \\mathbb{E}[d_j \\mid S_t, j \\in L_k] \\le R_L(\\epsilon) + D_{\\mathrm{valid}} \\cdot c_k \\exp\\left(-\\frac{D_H(\\epsilon)^2 - R_L(\\epsilon)^2}{2\\epsilon^2}\\right)\n1549: $$\n1550: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. The Measurement and Interaction Pipeline"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-patching-properties",
      "title": "Properties of the Patching Function",
      "start_line": 1809,
      "end_line": 1812,
      "header_lines": [
        1810
      ],
      "content_start": 1811,
      "content_end": 1811,
      "content": "1811: :::{prf:lemma} Properties of the Patching Function",
      "metadata": {
        "label": "lem-patching-properties"
      },
      "section": "## 5. The Measurement and Interaction Pipeline",
      "raw_directive": "1809: :::\n1810: \n1811: :::{prf:lemma} Properties of the Patching Function\n1812: :label: lem-patching-properties",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. The Measurement and Interaction Pipeline"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-compact-support-z-scores",
      "title": "Compact Support of Standardized Scores",
      "start_line": 1830,
      "end_line": 1833,
      "header_lines": [
        1831
      ],
      "content_start": 1832,
      "content_end": 1832,
      "content": "1832: :::{prf:lemma} Compact Support of Standardized Scores",
      "metadata": {
        "label": "lem-compact-support-z-scores"
      },
      "section": "## 5. The Measurement and Interaction Pipeline",
      "raw_directive": "1830: :::\n1831: \n1832: :::{prf:lemma} Compact Support of Standardized Scores\n1833: :label: lem-compact-support-z-scores",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. The Measurement and Interaction Pipeline"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-logistic-properties",
      "title": "Verification of Axiomatic Properties",
      "start_line": 1855,
      "end_line": 1858,
      "header_lines": [
        1856
      ],
      "content_start": 1857,
      "content_end": 1857,
      "content": "1857: :::{prf:lemma} Verification of Axiomatic Properties",
      "metadata": {
        "label": "lem-logistic-properties"
      },
      "section": "## 5. The Measurement and Interaction Pipeline",
      "raw_directive": "1855: :::\n1856: \n1857: :::{prf:lemma} Verification of Axiomatic Properties\n1858: :label: lem-logistic-properties",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. The Measurement and Interaction Pipeline"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-potential-bounds",
      "title": "Uniform Bounds of the Fitness Potential",
      "start_line": 1886,
      "end_line": 1892,
      "header_lines": [
        1887
      ],
      "content_start": 1889,
      "content_end": 1891,
      "content": "1889: :label: lem-potential-bounds\n1890: \n1891: Any non-zero fitness potential $V_i$ generated by this pipeline is uniformly bounded within a compact interval $[V_{\\text{pot,min}}, V_{\\text{pot,max}}]$. The bounds are state-independent constants defined by the algorithmic parameters:",
      "metadata": {
        "label": "lem-potential-bounds"
      },
      "section": "## 5. The Measurement and Interaction Pipeline",
      "raw_directive": "1886: :::\n1887: \n1888: :::{prf:lemma} Uniform Bounds of the Fitness Potential\n1889: :label: lem-potential-bounds\n1890: \n1891: Any non-zero fitness potential $V_i$ generated by this pipeline is uniformly bounded within a compact interval $[V_{\\text{pot,min}}, V_{\\text{pot,max}}]$. The bounds are state-independent constants defined by the algorithmic parameters:\n1892: *   $V_{\\text{pot,min}} := \\eta^{\\alpha+\\beta}$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. The Measurement and Interaction Pipeline"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-V_Varx-implies-variance",
      "title": "Large $V_{\\text{Var},x}$ Implies Large Single-Swarm Positional Variance",
      "start_line": 2322,
      "end_line": 2337,
      "header_lines": [
        2323
      ],
      "content_start": 2325,
      "content_end": 2336,
      "content": "2325: :label: lem-V_Varx-implies-variance\n2326: \n2327: Let $V_{Var,x}(S_1, S_2)$ be the total intra-swarm positional variance component of the Lyapunov function as defined in [](#def-full-synergistic-lyapunov-function):\n2328: \n2329: $$\n2330: V_{Var,x}(S_1, S_2) = \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_1)} \\|\\delta_{x,1,i}\\|^2 + \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_2)} \\|\\delta_{x,2,i}\\|^2\n2331: $$\n2332: \n2333: If this component is large, such that $V_{Var,x} > R_{total\\_var,x}^2$ for some threshold $R_{total\\_var,x}^2 > 0$, then at least one swarm $k \\in \\{1, 2\\}$ must have a large sum of squared deviations:\n2334: \n2335: $$\n2336: \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} \\|\\delta_{x,k,i}\\|^2 > \\frac{R_{total\\_var,x}^2}{2}",
      "metadata": {
        "label": "lem-V_Varx-implies-variance"
      },
      "section": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure",
      "raw_directive": "2322: The first step in the Keystone analysis is to connect the relevant component of the synergistic Lyapunov function to the state of a single swarm. As this document aims to prove the contractive nature of cloning on **positional error**, the Keystone mechanism is triggered specifically by the **positional variance component, $V_{\\text{Var},x}$**. The following lemma provides the simple but necessary guarantee that if this $V_{\\text{Var},x}$ term is large, then at least one of the two swarms must have a large internal positional variance.\n2323: \n2324: :::{prf:lemma} Large $V_{\\text{Var},x}$ Implies Large Single-Swarm Positional Variance\n2325: :label: lem-V_Varx-implies-variance\n2326: \n2327: Let $V_{Var,x}(S_1, S_2)$ be the total intra-swarm positional variance component of the Lyapunov function as defined in [](#def-full-synergistic-lyapunov-function):\n2328: \n2329: $$\n2330: V_{Var,x}(S_1, S_2) = \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_1)} \\|\\delta_{x,1,i}\\|^2 + \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_2)} \\|\\delta_{x,2,i}\\|^2\n2331: $$\n2332: \n2333: If this component is large, such that $V_{Var,x} > R_{total\\_var,x}^2$ for some threshold $R_{total\\_var,x}^2 > 0$, then at least one swarm $k \\in \\{1, 2\\}$ must have a large sum of squared deviations:\n2334: \n2335: $$\n2336: \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} \\|\\delta_{x,k,i}\\|^2 > \\frac{R_{total\\_var,x}^2}{2}\n2337: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-phase-space-packing",
      "title": "The Phase-Space Packing Lemma",
      "start_line": 2430,
      "end_line": 2448,
      "header_lines": [
        2431
      ],
      "content_start": 2433,
      "content_end": 2447,
      "content": "2433: :label: lem-phase-space-packing\n2434: \n2435: For a swarm `k` consisting of $k \\geq 2$ walkers with phase-space states $\\{(x_i, v_i)\\}_{i=1}^k$ within a compact domain, define the **total hypocoercive variance** of the swarm as:\n2436: \n2437: $$\n2438: \\mathrm{Var}_h(S_k) := \\mathrm{Var}_x(S_k) + \\lambda_v \\mathrm{Var}_v(S_k)\n2439: $$\n2440: \n2441: For any chosen proximity threshold $d_{\\text{close}} > 0$, let $N_{\\text{close}}$ be the number of unique pairs $(i, j)$ with $i<j$ and $d_{\\text{alg}}(i, j) < d_{\\text{close}}$, where $d_{\\text{alg}}(i, j)^2 := \\|x_i - x_j\\|^2 + \\lambda_{\\text{alg}} \\|v_i - v_j\\|^2$ is the algorithmic phase-space distance.\n2442: \n2443: The fraction of such \"close pairs in phase space\", $f_{\\text{close}} = N_{\\text{close}} / \\binom{k}{2}$, is bounded above by a function of the swarm's hypocoercive variance. Specifically, assuming $\\lambda_v \\le \\lambda_{\\text{alg}}$ and defining the phase-space diameter $D_{\\text{valid}}^2 := D_x^2 + \\lambda_{\\text{alg}} D_v^2$ where $D_x$ and $D_v$ are the spatial and velocity domain diameters, there exists a continuous, monotonically decreasing function such that:\n2444: \n2445: $$\n2446: f_{\\text{close}} \\le g(\\mathrm{Var}_h(S_k)) := \\frac{D_{\\text{valid}}^2 - 2\\mathrm{Var}_h(S_k)}{D_{\\text{valid}}^2 - d_{\\text{close}}^2}\n2447: $$",
      "metadata": {
        "label": "lem-phase-space-packing"
      },
      "section": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure",
      "raw_directive": "2430: Before analyzing the specific regimes of the $\\varepsilon$-dichotomy, we establish a precise, quantitative relationship between a swarm's global dispersion in phase space, as measured by its **total hypocoercive variance**, and its local phase-space clustering structure. This lemma generalizes the classical packing argument to phase space, proving that a swarm cannot be simultaneously spread out in the hypocoercive norm while being highly clustered under the algorithmic distance metric `d_alg`. This result is the foundational geometric constraint upon which both regimes of our analysis will depend.\n2431: \n2432: :::{prf:lemma} The Phase-Space Packing Lemma\n2433: :label: lem-phase-space-packing\n2434: \n2435: For a swarm `k` consisting of $k \\geq 2$ walkers with phase-space states $\\{(x_i, v_i)\\}_{i=1}^k$ within a compact domain, define the **total hypocoercive variance** of the swarm as:\n2436: \n2437: $$\n2438: \\mathrm{Var}_h(S_k) := \\mathrm{Var}_x(S_k) + \\lambda_v \\mathrm{Var}_v(S_k)\n2439: $$\n2440: \n2441: For any chosen proximity threshold $d_{\\text{close}} > 0$, let $N_{\\text{close}}$ be the number of unique pairs $(i, j)$ with $i<j$ and $d_{\\text{alg}}(i, j) < d_{\\text{close}}$, where $d_{\\text{alg}}(i, j)^2 := \\|x_i - x_j\\|^2 + \\lambda_{\\text{alg}} \\|v_i - v_j\\|^2$ is the algorithmic phase-space distance.\n2442: \n2443: The fraction of such \"close pairs in phase space\", $f_{\\text{close}} = N_{\\text{close}} / \\binom{k}{2}$, is bounded above by a function of the swarm's hypocoercive variance. Specifically, assuming $\\lambda_v \\le \\lambda_{\\text{alg}}$ and defining the phase-space diameter $D_{\\text{valid}}^2 := D_x^2 + \\lambda_{\\text{alg}} D_v^2$ where $D_x$ and $D_v$ are the spatial and velocity domain diameters, there exists a continuous, monotonically decreasing function such that:\n2444: \n2445: $$\n2446: f_{\\text{close}} \\le g(\\mathrm{Var}_h(S_k)) := \\frac{D_{\\text{valid}}^2 - 2\\mathrm{Var}_h(S_k)}{D_{\\text{valid}}^2 - d_{\\text{close}}^2}\n2447: $$\n2448: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-var-x-implies-var-h",
      "title": "Positional Variance as a Lower Bound for Hypocoercive Variance",
      "start_line": 2575,
      "end_line": 2585,
      "header_lines": [
        2576
      ],
      "content_start": 2578,
      "content_end": 2584,
      "content": "2578: :label: lem-var-x-implies-var-h\n2579: \n2580: For any swarm `k`, its total hypocoercive variance is bounded below by its positional variance:\n2581: \n2582: $$\n2583: \\mathrm{Var}_h(S_k) \\ge \\mathrm{Var}_x(S_k)\n2584: $$",
      "metadata": {
        "label": "lem-var-x-implies-var-h"
      },
      "section": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure",
      "raw_directive": "2575: To connect this analysis back to the positional variance component of the Lyapunov function, we first establish a simple but crucial relationship.\n2576: \n2577: :::{prf:lemma} Positional Variance as a Lower Bound for Hypocoercive Variance\n2578: :label: lem-var-x-implies-var-h\n2579: \n2580: For any swarm `k`, its total hypocoercive variance is bounded below by its positional variance:\n2581: \n2582: $$\n2583: \\mathrm{Var}_h(S_k) \\ge \\mathrm{Var}_x(S_k)\n2584: $$\n2585: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-outlier-fraction-lower-bound",
      "title": "N-Uniform Lower Bound on the Outlier Fraction",
      "start_line": 2610,
      "end_line": 2622,
      "header_lines": [
        2611
      ],
      "content_start": 2613,
      "content_end": 2621,
      "content": "2613: :label: lem-outlier-fraction-lower-bound\n2614: \n2615: Let $O_k$ be the **global kinematic outlier set** for a swarm `k` with `k >= 2` alive walkers, as defined in Section 6.3, with structural parameter $\\varepsilon_O \\in (0, 1)$.\n2616: \n2617: If the swarm's internal hypocoercive variance is large, such that $\\mathrm{Var}_h(S_k) > R^2_h$ for some threshold $R^2_h > 0$, then the fraction of *alive* walkers in the outlier set is bounded below by a positive constant that is independent of `N`. Specifically:\n2618: \n2619: $$\n2620: \\frac{|O_k|}{k} \\ge \\frac{(1-\\varepsilon_O) R^2_h}{D_h^2} =: f_O > 0\n2621: $$",
      "metadata": {
        "label": "lem-outlier-fraction-lower-bound"
      },
      "section": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure",
      "raw_directive": "2610: This lemma establishes the crucial bridge: the analysis in Section 6.2 guaranteed a large positional variance `Var_x`, and this lemma proves that such a condition is sufficient to guarantee a large hypocoercive variance `Var_h`, which is the relevant measure for the phase-space outlier set `O_k`. We can now proceed with the main result.\n2611: \n2612: :::{prf:lemma} N-Uniform Lower Bound on the Outlier Fraction\n2613: :label: lem-outlier-fraction-lower-bound\n2614: \n2615: Let $O_k$ be the **global kinematic outlier set** for a swarm `k` with `k >= 2` alive walkers, as defined in Section 6.3, with structural parameter $\\varepsilon_O \\in (0, 1)$.\n2616: \n2617: If the swarm's internal hypocoercive variance is large, such that $\\mathrm{Var}_h(S_k) > R^2_h$ for some threshold $R^2_h > 0$, then the fraction of *alive* walkers in the outlier set is bounded below by a positive constant that is independent of `N`. Specifically:\n2618: \n2619: $$\n2620: \\frac{|O_k|}{k} \\ge \\frac{(1-\\varepsilon_O) R^2_h}{D_h^2} =: f_O > 0\n2621: $$\n2622: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-outlier-cluster-fraction-lower-bound",
      "title": "N-Uniform Lower Bound on the Outlier-Cluster Fraction",
      "start_line": 2716,
      "end_line": 2729,
      "header_lines": [
        2717
      ],
      "content_start": 2719,
      "content_end": 2728,
      "content": "2719: :label: lem-outlier-cluster-fraction-lower-bound\n2720: \n2721: Let the high-error set $H_k(\\varepsilon)$ be defined via the phase-space clustering-based approach (as $C_k(\\varepsilon)$ in Definition 6.3.1) for the local-interaction regime, with maximum cluster diameter $D_diam(\\varepsilon) = c_d · \\varepsilon$ where $c_d > 0$ is a fixed constant.\n2722: \n2723: For any choice of $c_d$ and variance threshold $R^2_{\\text{var}}$ satisfying $c_d · \\epsilon < 2\\sqrt{R^2_{\\text{var}}}$, there exists a positive constant $f_H(\\epsilon) > 0$, independent of `N` and `k`, such that:\n2724: \n2725: If the swarm's internal positional variance is large, $\\mathrm{Var}_x(S_k) > R^2_{\\text{var}}$, then the fraction of *alive* walkers in the high-error set is bounded below:\n2726: \n2727: $$\n2728: \\frac{|H_k(\\epsilon)|}{k} \\ge f_H(\\epsilon) > 0",
      "metadata": {
        "label": "lem-outlier-cluster-fraction-lower-bound"
      },
      "section": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure",
      "raw_directive": "2716: With the clustering-based definition from Section 6.3 established, we can now prove the main result for this regime.\n2717: \n2718: :::{prf:lemma} N-Uniform Lower Bound on the Outlier-Cluster Fraction\n2719: :label: lem-outlier-cluster-fraction-lower-bound\n2720: \n2721: Let the high-error set $H_k(\\varepsilon)$ be defined via the phase-space clustering-based approach (as $C_k(\\varepsilon)$ in Definition 6.3.1) for the local-interaction regime, with maximum cluster diameter $D_diam(\\varepsilon) = c_d · \\varepsilon$ where $c_d > 0$ is a fixed constant.\n2722: \n2723: For any choice of $c_d$ and variance threshold $R^2_{\\text{var}}$ satisfying $c_d · \\epsilon < 2\\sqrt{R^2_{\\text{var}}}$, there exists a positive constant $f_H(\\epsilon) > 0$, independent of `N` and `k`, such that:\n2724: \n2725: If the swarm's internal positional variance is large, $\\mathrm{Var}_x(S_k) > R^2_{\\text{var}}$, then the fraction of *alive* walkers in the high-error set is bounded below:\n2726: \n2727: $$\n2728: \\frac{|H_k(\\epsilon)|}{k} \\ge f_H(\\epsilon) > 0\n2729: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-geometric-separation-of-partition",
      "title": "Geometric Separation of the Partition",
      "start_line": 2890,
      "end_line": 2912,
      "header_lines": [
        2891
      ],
      "content_start": 2893,
      "content_end": 2911,
      "content": "2893: :label: lem-geometric-separation-of-partition\n2894: \n2895: Let $H_k(\\epsilon)$ and $L_k(\\epsilon)$ be the unified high-error and low-error sets for swarm $k$ as defined in Definition 6.3.1. Assume the swarm's internal positional variance is large: $\\mathrm{Var}(x) > R^2_{\\mathrm{var}}$.\n2896: \n2897: Then there exist N-uniform, $\\epsilon$-dependent constants $D_H(\\epsilon) > R_L(\\epsilon) > 0$ and a fractional constant $f_c > 0$ such that:\n2898: \n2899: **Part 1 (Separation Between Sets):** For any walker $i \\in H_k(\\epsilon)$ from a high-error cluster and any walker $j \\in L_k(\\epsilon)$ from a low-error cluster, their algorithmic distance is bounded below:\n2900: \n2901: $$\n2902: d_{\\text{alg}}(i, j) \\ge D_H(\\epsilon)\n2903: $$\n2904: \n2905: **Part 2 (Clustering of Low-Error Walkers):** For any walker $j \\in L_k(\\epsilon)$, there exists a non-empty subset of companion walkers $C_j \\subset L_k(\\epsilon) \\setminus \\{j\\}$ of minimum size $|C_j| \\ge f_c k$ such that all members of this cluster are within a small algorithmic radius:\n2906: \n2907: $$\n2908: d_{\\text{alg}}(j, \\ell) \\le R_L(\\epsilon) \\quad \\text{for all } \\ell \\in C_j\n2909: $$\n2910: \n2911: The separation property $D_H(\\epsilon) > R_L(\\epsilon)$ ensures that the geometric signatures of the two sets are fundamentally distinct and non-overlapping **in the algorithmic phase space**.",
      "metadata": {
        "label": "lem-geometric-separation-of-partition"
      },
      "section": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure",
      "raw_directive": "2890: #### 6.5.1. Main Lemma: Statement of Geometric Separation\n2891: \n2892: :::{prf:lemma} Geometric Separation of the Partition\n2893: :label: lem-geometric-separation-of-partition\n2894: \n2895: Let $H_k(\\epsilon)$ and $L_k(\\epsilon)$ be the unified high-error and low-error sets for swarm $k$ as defined in Definition 6.3.1. Assume the swarm's internal positional variance is large: $\\mathrm{Var}(x) > R^2_{\\mathrm{var}}$.\n2896: \n2897: Then there exist N-uniform, $\\epsilon$-dependent constants $D_H(\\epsilon) > R_L(\\epsilon) > 0$ and a fractional constant $f_c > 0$ such that:\n2898: \n2899: **Part 1 (Separation Between Sets):** For any walker $i \\in H_k(\\epsilon)$ from a high-error cluster and any walker $j \\in L_k(\\epsilon)$ from a low-error cluster, their algorithmic distance is bounded below:\n2900: \n2901: $$\n2902: d_{\\text{alg}}(i, j) \\ge D_H(\\epsilon)\n2903: $$\n2904: \n2905: **Part 2 (Clustering of Low-Error Walkers):** For any walker $j \\in L_k(\\epsilon)$, there exists a non-empty subset of companion walkers $C_j \\subset L_k(\\epsilon) \\setminus \\{j\\}$ of minimum size $|C_j| \\ge f_c k$ such that all members of this cluster are within a small algorithmic radius:\n2906: \n2907: $$\n2908: d_{\\text{alg}}(j, \\ell) \\le R_L(\\epsilon) \\quad \\text{for all } \\ell \\in C_j\n2909: $$\n2910: \n2911: The separation property $D_H(\\epsilon) > R_L(\\epsilon)$ ensures that the geometric signatures of the two sets are fundamentally distinct and non-overlapping **in the algorithmic phase space**.\n2912: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. The Geometry of Error: From System Error to a Guaranteed Geometric Structure"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-to-gap",
      "title": "From Bounded Variance to a Guaranteed Gap",
      "start_line": 3593,
      "end_line": 3602,
      "header_lines": [
        3594
      ],
      "content_start": 3596,
      "content_end": 3601,
      "content": "3596: :label: lem-variance-to-gap\n3597: \n3598: Let $\\{v_i\\}_{i=1}^k$ be a set of $k \\ge 2$ real numbers. If the empirical variance of this set is bounded below by a strictly positive constant, $\\text{Var}(\\{v_i\\}) \\geq \\kappa > 0$, then there must exist at least one pair of indices $(i, j)$ such that the gap between their values is bounded below:\n3599: \n3600: $$\n3601: \\max_{i,j} |v_i - v_j| \\ge \\sqrt{2\\kappa}",
      "metadata": {
        "label": "lem-variance-to-gap"
      },
      "section": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation",
      "raw_directive": "3593: The first step in the signal integrity proof is to show that the statistical property of variance, now proven in [](#thm-geometry-guarantees-variance), has a direct, concrete consequence: it forces a measurable separation between the raw values of at least two walkers.\n3594: \n3595: :::{prf:lemma} From Bounded Variance to a Guaranteed Gap\n3596: :label: lem-variance-to-gap\n3597: \n3598: Let $\\{v_i\\}_{i=1}^k$ be a set of $k \\ge 2$ real numbers. If the empirical variance of this set is bounded below by a strictly positive constant, $\\text{Var}(\\{v_i\\}) \\geq \\kappa > 0$, then there must exist at least one pair of indices $(i, j)$ such that the gap between their values is bounded below:\n3599: \n3600: $$\n3601: \\max_{i,j} |v_i - v_j| \\ge \\sqrt{2\\kappa}\n3602: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-rescale-derivative-lower-bound",
      "title": "Positive Derivative Bound for the Rescale Function",
      "start_line": 3670,
      "end_line": 3680,
      "header_lines": [
        3671
      ],
      "content_start": 3673,
      "content_end": 3679,
      "content": "3673: :label: lem-rescale-derivative-lower-bound\n3674: \n3675: For the Canonical Logistic Rescale function, the first derivative $g'_A(z)$ is uniformly bounded below by a strictly positive constant for all z-scores in the operational range $Z_{\\text{supp}}$. That is, there exists a constant $g'_{\\min} > 0$ such that:\n3676: \n3677: $$\n3678: \\inf_{z \\in Z_{\\mathrm{supp}}} g'_A(z) = g'_{\\min} > 0\n3679: $$",
      "metadata": {
        "label": "lem-rescale-derivative-lower-bound"
      },
      "section": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation",
      "raw_directive": "3670: Next, we must prove that the rescale function `g_A` is sufficiently sensitive to preserve a standardized gap. This requires showing that its derivative is uniformly bounded below by a positive constant over its entire operational domain.\n3671: \n3672: :::{prf:lemma} Positive Derivative Bound for the Rescale Function\n3673: :label: lem-rescale-derivative-lower-bound\n3674: \n3675: For the Canonical Logistic Rescale function, the first derivative $g'_A(z)$ is uniformly bounded below by a strictly positive constant for all z-scores in the operational range $Z_{\\text{supp}}$. That is, there exists a constant $g'_{\\min} > 0$ such that:\n3676: \n3677: $$\n3678: \\inf_{z \\in Z_{\\mathrm{supp}}} g'_A(z) = g'_{\\min} > 0\n3679: $$\n3680: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-raw-gap-to-rescaled-gap",
      "title": "From Raw Measurement Gap to Rescaled Value Gap",
      "start_line": 3700,
      "end_line": 3715,
      "header_lines": [
        3701
      ],
      "content_start": 3703,
      "content_end": 3714,
      "content": "3703: :label: lem-raw-gap-to-rescaled-gap\n3704: \n3705: Let the system parameters be fixed. There exists a function $\\kappa_rescaled(\\kappa_raw)$ such that for *any* swarm state `S` with $k \\geq 2$ alive walkers, if the raw measurement values contain a gap $|vₐ - vᵦ| \\geq \\kappa_raw > 0$, then the corresponding rescaled values are guaranteed to have a gap:\n3706: \n3707: $$\n3708: |g_A(z_a) - g_A(z_b)| \\ge \\kappa_{\\mathrm{rescaled}}(\\kappa_{\\mathrm{raw}}) > 0\n3709: $$\n3710: \n3711: The function $\\kappa_rescaled$ is independent of the swarm state `S` and its size `k`, and is defined as:\n3712: \n3713: $$\n3714: \\kappa_{\\mathrm{rescaled}}(\\kappa_{\\mathrm{raw}}) := \\frac{g'_{\\min}}{\\sigma'_{\\max}} \\cdot \\kappa_{\\mathrm{raw}}",
      "metadata": {
        "label": "lem-raw-gap-to-rescaled-gap"
      },
      "section": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation",
      "raw_directive": "3700: With the uniform bounds on the pipeline's components now established, we can prove the main result of this section: a guaranteed raw measurement gap is reliably transformed into a guaranteed rescaled value gap.\n3701: \n3702: :::{prf:lemma} From Raw Measurement Gap to Rescaled Value Gap\n3703: :label: lem-raw-gap-to-rescaled-gap\n3704: \n3705: Let the system parameters be fixed. There exists a function $\\kappa_rescaled(\\kappa_raw)$ such that for *any* swarm state `S` with $k \\geq 2$ alive walkers, if the raw measurement values contain a gap $|vₐ - vᵦ| \\geq \\kappa_raw > 0$, then the corresponding rescaled values are guaranteed to have a gap:\n3706: \n3707: $$\n3708: |g_A(z_a) - g_A(z_b)| \\ge \\kappa_{\\mathrm{rescaled}}(\\kappa_{\\mathrm{raw}}) > 0\n3709: $$\n3710: \n3711: The function $\\kappa_rescaled$ is independent of the swarm state `S` and its size `k`, and is defined as:\n3712: \n3713: $$\n3714: \\kappa_{\\mathrm{rescaled}}(\\kappa_{\\mathrm{raw}}) := \\frac{g'_{\\min}}{\\sigma'_{\\max}} \\cdot \\kappa_{\\mathrm{raw}}\n3715: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-to-mean-separation",
      "title": "**(From Total Variance to Mean Separation)**",
      "start_line": 3783,
      "end_line": 3802,
      "header_lines": [
        3784
      ],
      "content_start": 3786,
      "content_end": 3801,
      "content": "3786: :label: lem-variance-to-mean-separation\n3787: \n3788: Let $\\mathcal{V} = \\{v_i\\}_{i=1}^k$ be a set of $k \\ge 2$ real numbers, with each element $v_i$ contained in the compact interval $[V_{\\min}, V_{\\max}]$. Let $\\mathcal{V}$ be partitioned into two disjoint, non-empty subsets, $H$ and $L$, with corresponding means $\\mu_H$ and $\\mu_L$. Let their fractional population sizes, $f_H = |H|/k$ and $f_L = |L|/k$, be bounded below by a strictly positive constant $f_{\\min} \\in (0, 1/2]$, such that $f_H \\ge f_{\\min}$ and $f_L \\ge f_{\\min}$.\n3789: \n3790: If the empirical variance of the total set, $\\operatorname{Var}(\\mathcal{V})$, is bounded below by a strictly positive constant $\\kappa_{\\mathrm{var}} > 0$, then the squared difference between the subset means is bounded below by:\n3791: \n3792: $$\n3793: (\\mu_H - \\mu_L)^2 \\ge \\frac{1}{f_H f_L} \\left( \\kappa_{\\mathrm{var}} - \\operatorname{Var}_{\\mathrm{max}} \\right)\n3794: $$\n3795: \n3796: where $\\operatorname{Var}_{\\mathrm{max}} := \\frac{1}{4}(V_{\\max} - V_{\\min})^2$ is the maximum possible variance for any set of values on the interval.\n3797: \n3798: Consequently, if the guaranteed variance $\\kappa_{\\mathrm{var}}$ is sufficiently large to satisfy the **Signal-to-Noise Condition**, $\\kappa_{\\mathrm{var}} > \\operatorname{Var}_{\\mathrm{max}}$, then the mean separation is guaranteed to be positive:\n3799: \n3800: $$\n3801: |\\mu_H - \\mu_L| \\ge \\frac{1}{\\sqrt{f_H f_L}} \\sqrt{\\kappa_{\\mathrm{var}} - \\operatorname{Var}_{\\mathrm{max}}} > 0",
      "metadata": {
        "label": "lem-variance-to-mean-separation"
      },
      "section": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation",
      "raw_directive": "3783: The following lemma provides this fundamental link. It proves, from first principles, that a sufficiently large variance within a population partitioned into two substantial subsets necessitates a statistically significant separation between the means of those subsets.\n3784: \n3785: :::{prf:lemma} **(From Total Variance to Mean Separation)**\n3786: :label: lem-variance-to-mean-separation\n3787: \n3788: Let $\\mathcal{V} = \\{v_i\\}_{i=1}^k$ be a set of $k \\ge 2$ real numbers, with each element $v_i$ contained in the compact interval $[V_{\\min}, V_{\\max}]$. Let $\\mathcal{V}$ be partitioned into two disjoint, non-empty subsets, $H$ and $L$, with corresponding means $\\mu_H$ and $\\mu_L$. Let their fractional population sizes, $f_H = |H|/k$ and $f_L = |L|/k$, be bounded below by a strictly positive constant $f_{\\min} \\in (0, 1/2]$, such that $f_H \\ge f_{\\min}$ and $f_L \\ge f_{\\min}$.\n3789: \n3790: If the empirical variance of the total set, $\\operatorname{Var}(\\mathcal{V})$, is bounded below by a strictly positive constant $\\kappa_{\\mathrm{var}} > 0$, then the squared difference between the subset means is bounded below by:\n3791: \n3792: $$\n3793: (\\mu_H - \\mu_L)^2 \\ge \\frac{1}{f_H f_L} \\left( \\kappa_{\\mathrm{var}} - \\operatorname{Var}_{\\mathrm{max}} \\right)\n3794: $$\n3795: \n3796: where $\\operatorname{Var}_{\\mathrm{max}} := \\frac{1}{4}(V_{\\max} - V_{\\min})^2$ is the maximum possible variance for any set of values on the interval.\n3797: \n3798: Consequently, if the guaranteed variance $\\kappa_{\\mathrm{var}}$ is sufficiently large to satisfy the **Signal-to-Noise Condition**, $\\kappa_{\\mathrm{var}} > \\operatorname{Var}_{\\mathrm{max}}$, then the mean separation is guaranteed to be positive:\n3799: \n3800: $$\n3801: |\\mu_H - \\mu_L| \\ge \\frac{1}{\\sqrt{f_H f_L}} \\sqrt{\\kappa_{\\mathrm{var}} - \\operatorname{Var}_{\\mathrm{max}}} > 0\n3802: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-log-gap-lower-bound",
      "title": "Lower Bound on Logarithmic Mean Gap",
      "start_line": 4032,
      "end_line": 4043,
      "header_lines": [
        4033
      ],
      "content_start": 4035,
      "content_end": 4042,
      "content": "4035: :label: lem-log-gap-lower-bound\n4036: \n4037: Let $X$ and $Y$ be two random variables whose values are contained in the compact interval $[V_{\\min}, V_{\\max}]$, where $V_{\\min} > 0$. Let their means, $\\mu_X = \\mathbb{E}[X]$ and $\\mu_Y = \\mathbb{E}[Y]$, satisfy $\\mu_X \\ge \\mu_Y + \\kappa$ for some constant $\\kappa > 0$.\n4038: \n4039: Then the difference of their expected logarithms is bounded below as follows:\n4040: \n4041: $$\n4042: \\mathbb{E}[\\ln(X)] - \\mathbb{E}[\\ln(Y)] \\ge \\ln\\left(1 + \\frac{\\kappa}{V_{\\max}}\\right)",
      "metadata": {
        "label": "lem-log-gap-lower-bound"
      },
      "section": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation",
      "raw_directive": "4032: This lemma establishes that a guaranteed separation in the means of two distributions implies a guaranteed, non-vanishing separation in their expected logarithms. The proof uses extremal distribution theory to find the worst-case scenario.\n4033: \n4034: :::{prf:lemma} Lower Bound on Logarithmic Mean Gap\n4035: :label: lem-log-gap-lower-bound\n4036: \n4037: Let $X$ and $Y$ be two random variables whose values are contained in the compact interval $[V_{\\min}, V_{\\max}]$, where $V_{\\min} > 0$. Let their means, $\\mu_X = \\mathbb{E}[X]$ and $\\mu_Y = \\mathbb{E}[Y]$, satisfy $\\mu_X \\ge \\mu_Y + \\kappa$ for some constant $\\kappa > 0$.\n4038: \n4039: Then the difference of their expected logarithms is bounded below as follows:\n4040: \n4041: $$\n4042: \\mathbb{E}[\\ln(X)] - \\mathbb{E}[\\ln(Y)] \\ge \\ln\\left(1 + \\frac{\\kappa}{V_{\\max}}\\right)\n4043: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-log-gap-upper-bound",
      "title": "Upper Bound on Logarithmic Mean Gap",
      "start_line": 4173,
      "end_line": 4184,
      "header_lines": [
        4174
      ],
      "content_start": 4176,
      "content_end": 4183,
      "content": "4176: :label: lem-log-gap-upper-bound\n4177: \n4178: Let $X$ and $Y$ be two random variables whose values are contained in the compact interval $[V_{\\min}, V_{\\max}]$, where $V_{\\min} > 0$. Let their means, $\\mu_X = \\mathbb{E}[X]$ and $\\mu_Y = \\mathbb{E}[Y]$, satisfy $|\\mu_X - \\mu_Y| \\le \\kappa$ for some constant $\\kappa > 0$.\n4179: \n4180: Then the absolute difference of their expected logarithms is bounded above as follows:\n4181: \n4182: $$\n4183: |\\mathbb{E}[\\ln(X)] - \\mathbb{E}[\\ln(Y)]| \\le \\ln\\left(1 + \\frac{\\kappa}{V_{\\min}}\\right)",
      "metadata": {
        "label": "lem-log-gap-upper-bound"
      },
      "section": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation",
      "raw_directive": "4173: This lemma provides a symmetric result, capping the maximum possible logarithmic gap. This is essential for bounding the influence of the potentially adversarial reward signal, ensuring it cannot overwhelm the corrective diversity signal.\n4174: \n4175: :::{prf:lemma} Upper Bound on Logarithmic Mean Gap\n4176: :label: lem-log-gap-upper-bound\n4177: \n4178: Let $X$ and $Y$ be two random variables whose values are contained in the compact interval $[V_{\\min}, V_{\\max}]$, where $V_{\\min} > 0$. Let their means, $\\mu_X = \\mathbb{E}[X]$ and $\\mu_Y = \\mathbb{E}[Y]$, satisfy $|\\mu_X - \\mu_Y| \\le \\kappa$ for some constant $\\kappa > 0$.\n4179: \n4180: Then the absolute difference of their expected logarithms is bounded above as follows:\n4181: \n4182: $$\n4183: |\\mathbb{E}[\\ln(X)] - \\mathbb{E}[\\ln(Y)]| \\le \\ln\\left(1 + \\frac{\\kappa}{V_{\\min}}\\right)\n4184: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-unfit-fraction-lower-bound",
      "title": "N-Uniform Lower Bound on the Unfit Fraction",
      "start_line": 4570,
      "end_line": 4582,
      "header_lines": [
        4571
      ],
      "content_start": 4573,
      "content_end": 4581,
      "content": "4573: :label: lem-unfit-fraction-lower-bound\n4574: \n4575: Let a swarm `k` with `k >= 2` alive walkers have a fitness potential range that is bounded below by a positive, $\\varepsilon$-dependent constant: $V_{\\max,k} - V_{\\min,k} \\ge \\kappa_{V,\\text{gap}}(\\epsilon) > 0$.\n4576: \n4577: The fraction of alive walkers in the unfit set $U_k$ is bounded below by a positive, N-uniform, $\\varepsilon$-dependent constant $f_U(\\epsilon) > 0$:\n4578: \n4579: $$\n4580: \\frac{|U_k|}{k} \\ge \\frac{\\kappa_{V,\\text{gap}}(\\epsilon)}{2(V_{\\text{pot,max}} - V_{\\text{pot,min}})} =: f_U(\\epsilon)\n4581: $$",
      "metadata": {
        "label": "lem-unfit-fraction-lower-bound"
      },
      "section": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation",
      "raw_directive": "4570: :::\n4571: \n4572: :::{prf:lemma} N-Uniform Lower Bound on the Unfit Fraction\n4573: :label: lem-unfit-fraction-lower-bound\n4574: \n4575: Let a swarm `k` with `k >= 2` alive walkers have a fitness potential range that is bounded below by a positive, $\\varepsilon$-dependent constant: $V_{\\max,k} - V_{\\min,k} \\ge \\kappa_{V,\\text{gap}}(\\epsilon) > 0$.\n4576: \n4577: The fraction of alive walkers in the unfit set $U_k$ is bounded below by a positive, N-uniform, $\\varepsilon$-dependent constant $f_U(\\epsilon) > 0$:\n4578: \n4579: $$\n4580: \\frac{|U_k|}{k} \\ge \\frac{\\kappa_{V,\\text{gap}}(\\epsilon)}{2(V_{\\text{pot,max}} - V_{\\text{pot,min}})} =: f_U(\\epsilon)\n4581: $$\n4582: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. The Corrective Nature of Fitness: From Signal Generation to Intelligent Adaptation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-quantitative-keystone",
      "title": "The N-Uniform Quantitative Keystone Lemma",
      "start_line": 4712,
      "end_line": 4727,
      "header_lines": [
        4713
      ],
      "content_start": 4715,
      "content_end": 4726,
      "content": "4715: :label: lem-quantitative-keystone\n4716: \n4717: Under the foundational axioms laid out in Chapter 4, there exist:\n4718: *   a structural error threshold $R^2_{\\text{spread}} > 0$,\n4719: *   a minimum feedback coefficient $\\chi(\\epsilon) > 0$,\n4720: *   and a constant offset $g_{\\max}(\\epsilon) \\ge 0$,\n4721: \n4722: all of which may depend on $\\epsilon$ but are independent of $N$, such that for any pair of swarms $(S_1, S_2)$:\n4723: \n4724: $$\n4725: \\frac{1}{N}\\sum_{i \\in I_{11}} (p_{1,i} + p_{2,i})\\|\\Delta\\delta_{x,i}\\|^2 \\ge \\chi(\\epsilon) V_{\\text{struct}} - g_{\\max}(\\epsilon)\n4726: $$",
      "metadata": {
        "label": "lem-quantitative-keystone"
      },
      "section": "## 8. The N-Uniform Quantitative Keystone Lemma",
      "raw_directive": "4712: We begin by formally stating the main theorem. This lemma provides the quantitative link between the system's error and its corrective response, which will be the primary tool for the drift analysis in the subsequent chapters. The lemma considers the summed cloning probability from both swarms, $(p_{1,i} + p_{2,i})$, to capture the total corrective pressure. The proof will demonstrate that even when only one swarm is in a high-error state, the cloning pressure from that single swarm is sufficient to ensure the inequality holds.\n4713: \n4714: :::{prf:lemma} The N-Uniform Quantitative Keystone Lemma\n4715: :label: lem-quantitative-keystone\n4716: \n4717: Under the foundational axioms laid out in Chapter 4, there exist:\n4718: *   a structural error threshold $R^2_{\\text{spread}} > 0$,\n4719: *   a minimum feedback coefficient $\\chi(\\epsilon) > 0$,\n4720: *   and a constant offset $g_{\\max}(\\epsilon) \\ge 0$,\n4721: \n4722: all of which may depend on $\\epsilon$ but are independent of $N$, such that for any pair of swarms $(S_1, S_2)$:\n4723: \n4724: $$\n4725: \\frac{1}{N}\\sum_{i \\in I_{11}} (p_{1,i} + p_{2,i})\\|\\Delta\\delta_{x,i}\\|^2 \\ge \\chi(\\epsilon) V_{\\text{struct}} - g_{\\max}(\\epsilon)\n4726: $$\n4727: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 8. The N-Uniform Quantitative Keystone Lemma"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mean-companion-fitness-gap",
      "title": "Lower Bound on Mean Companion Fitness Gap",
      "start_line": 4781,
      "end_line": 4805,
      "header_lines": [
        4782
      ],
      "content_start": 4784,
      "content_end": 4804,
      "content": "4784: :label: lem-mean-companion-fitness-gap\n4785: \n4786: Let a swarm $k$ with $k \\geq 2$ alive walkers have a non-degenerate fitness potential range $\\kappa_{V,\\text{gap}}(\\epsilon) > 0$. Let $U_k$ and $F_k$ denote the unfit and fit sets, with respective population fractions $f_U := |U_k|/k$ and $f_F := |F_k|/k$, where $f_U, f_F > 0$ and $f_U + f_F = 1$. Denote by $\\mu_U$ and $\\mu_F$ the mean fitness values of the two sets.\n4787: \n4788: For any walker $i \\in U_k$ (unfit set), the difference between its mean companion fitness and its own fitness is bounded below by:\n4789: \n4790: $$\n4791: \\mu_{\\text{comp},i} - V_{k,i} \\geq \\frac{f_F}{k-1} (\\mu_F - \\mu_U) > 0\n4792: $$\n4793: \n4794: Furthermore, the gap between the mean fitness values of the two sets can be bounded in terms of the fitness range:\n4795: \n4796: $$\n4797: \\mu_F - \\mu_U \\geq \\frac{f_U}{f_F + f_U^2/f_F} \\kappa_{V,\\text{gap}}(\\epsilon)\n4798: $$\n4799: \n4800: Combining these yields an N-uniform lower bound:\n4801: \n4802: $$\n4803: \\mu_{\\text{comp},i} - V_{k,i} \\geq \\frac{f_F f_U}{(k-1)(f_F + f_U^2/f_F)} \\kappa_{V,\\text{gap}}(\\epsilon) =: \\Delta_{\\min}(\\epsilon, f_U, f_F, k)\n4804: $$",
      "metadata": {
        "label": "lem-mean-companion-fitness-gap"
      },
      "section": "## 8. The N-Uniform Quantitative Keystone Lemma",
      "raw_directive": "4781: To establish a lower bound on cloning probabilities, we must first prove that unfit walkers have companions whose fitness is systematically higher. The following lemma provides the required quantitative guarantee.\n4782: \n4783: :::{prf:lemma} Lower Bound on Mean Companion Fitness Gap\n4784: :label: lem-mean-companion-fitness-gap\n4785: \n4786: Let a swarm $k$ with $k \\geq 2$ alive walkers have a non-degenerate fitness potential range $\\kappa_{V,\\text{gap}}(\\epsilon) > 0$. Let $U_k$ and $F_k$ denote the unfit and fit sets, with respective population fractions $f_U := |U_k|/k$ and $f_F := |F_k|/k$, where $f_U, f_F > 0$ and $f_U + f_F = 1$. Denote by $\\mu_U$ and $\\mu_F$ the mean fitness values of the two sets.\n4787: \n4788: For any walker $i \\in U_k$ (unfit set), the difference between its mean companion fitness and its own fitness is bounded below by:\n4789: \n4790: $$\n4791: \\mu_{\\text{comp},i} - V_{k,i} \\geq \\frac{f_F}{k-1} (\\mu_F - \\mu_U) > 0\n4792: $$\n4793: \n4794: Furthermore, the gap between the mean fitness values of the two sets can be bounded in terms of the fitness range:\n4795: \n4796: $$\n4797: \\mu_F - \\mu_U \\geq \\frac{f_U}{f_F + f_U^2/f_F} \\kappa_{V,\\text{gap}}(\\epsilon)\n4798: $$\n4799: \n4800: Combining these yields an N-uniform lower bound:\n4801: \n4802: $$\n4803: \\mu_{\\text{comp},i} - V_{k,i} \\geq \\frac{f_F f_U}{(k-1)(f_F + f_U^2/f_F)} \\kappa_{V,\\text{gap}}(\\epsilon) =: \\Delta_{\\min}(\\epsilon, f_U, f_F, k)\n4804: $$\n4805: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 8. The N-Uniform Quantitative Keystone Lemma"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-unfit-cloning-pressure",
      "title": "Guaranteed Cloning Pressure on the Unfit Set",
      "start_line": 4948,
      "end_line": 4957,
      "header_lines": [
        4949
      ],
      "content_start": 4951,
      "content_end": 4956,
      "content": "4951: :label: lem-unfit-cloning-pressure\n4952: \n4953: Let a swarm $k$ with $k \\geq 2$ alive walkers be in a state such that its fitness potential range is bounded below by $\\kappa_{V,\\text{gap}}(\\epsilon) > 0$. For any walker $i$ in the unfit set $U_k$, its total cloning probability is bounded below by a positive, N-uniform, and $\\epsilon$-dependent constant $p_u(\\epsilon) > 0$:\n4954: \n4955: $$\n4956: p_{k,i} = \\mathbb{E}_{c \\sim \\mathbb{C}_i(S_k)}[\\pi(S(V_{k,c}, V_{k,i}))] \\ge p_u(\\epsilon) > 0",
      "metadata": {
        "label": "lem-unfit-cloning-pressure"
      },
      "section": "## 8. The N-Uniform Quantitative Keystone Lemma",
      "raw_directive": "4948: :::\n4949: \n4950: :::{prf:lemma} Guaranteed Cloning Pressure on the Unfit Set\n4951: :label: lem-unfit-cloning-pressure\n4952: \n4953: Let a swarm $k$ with $k \\geq 2$ alive walkers be in a state such that its fitness potential range is bounded below by $\\kappa_{V,\\text{gap}}(\\epsilon) > 0$. For any walker $i$ in the unfit set $U_k$, its total cloning probability is bounded below by a positive, N-uniform, and $\\epsilon$-dependent constant $p_u(\\epsilon) > 0$:\n4954: \n4955: $$\n4956: p_{k,i} = \\mathbb{E}_{c \\sim \\mathbb{C}_i(S_k)}[\\pi(S(V_{k,c}, V_{k,i}))] \\ge p_u(\\epsilon) > 0\n4957: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 8. The N-Uniform Quantitative Keystone Lemma"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-concentration-Hk",
      "title": "**(Variance Concentration in the High-Error Set)**",
      "start_line": 5032,
      "end_line": 5041,
      "header_lines": [
        5033
      ],
      "content_start": 5035,
      "content_end": 5040,
      "content": "5035: :label: lem-variance-concentration-Hk\n5036: \n5037: Let a swarm $k$ be in a high-error state, $\\text{Var}_k(x) > R^2_{\\text{var}}$. There exists a strictly positive, N-uniform constant $c_H \\in (0, 1]$ such that the sum of squared deviations from the mean for the walkers in the unified high-error set $H_k(\\epsilon)$ is bounded below by a fixed fraction of the total sum of squared deviations:\n5038: \n5039: $$\n5040: \\sum_{i \\in H_k(\\epsilon)} \\|\\delta_{x,k,i}\\|^2 \\ge c_H \\sum_{i \\in \\mathcal{A}_k} \\|\\delta_{x,k,i}\\|^2",
      "metadata": {
        "label": "lem-variance-concentration-Hk"
      },
      "section": "## 8. The N-Uniform Quantitative Keystone Lemma",
      "raw_directive": "5032: To make the proof self-contained, we first formalize a direct consequence of the geometric analysis in Chapter 6: that the high-error set, by its very nature, is responsible for a non-vanishing fraction of a swarm's internal variance.\n5033: \n5034: :::{prf:lemma} **(Variance Concentration in the High-Error Set)**\n5035: :label: lem-variance-concentration-Hk\n5036: \n5037: Let a swarm $k$ be in a high-error state, $\\text{Var}_k(x) > R^2_{\\text{var}}$. There exists a strictly positive, N-uniform constant $c_H \\in (0, 1]$ such that the sum of squared deviations from the mean for the walkers in the unified high-error set $H_k(\\epsilon)$ is bounded below by a fixed fraction of the total sum of squared deviations:\n5038: \n5039: $$\n5040: \\sum_{i \\in H_k(\\epsilon)} \\|\\delta_{x,k,i}\\|^2 \\ge c_H \\sum_{i \\in \\mathcal{A}_k} \\|\\delta_{x,k,i}\\|^2\n5041: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 8. The N-Uniform Quantitative Keystone Lemma"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-error-concentration-target-set",
      "title": "Error Concentration in the Target Set",
      "start_line": 5153,
      "end_line": 5165,
      "header_lines": [
        5154
      ],
      "content_start": 5156,
      "content_end": 5164,
      "content": "5156: :label: lem-error-concentration-target-set\n5157: \n5158: Let a swarm state $(S_1, S_2)$ be in the high-error regime, such that $V_{\\mathrm{struct}} > R^2_{\\mathrm{spread}}$. Let $k$ be the high-variance swarm and let $I_{\\text{target}} := I_{11} \\cap U_k \\cap H_k(\\epsilon)$ be the critical target set.\n5159: \n5160: The positional structural error concentrated within this target set is bounded below by a linear function of the total structural error:\n5161: \n5162: $$\n5163: \\frac{1}{N}\\sum_{i \\in I_{\\text{target}}} \\|\\Delta\\delta_{x,i}\\|^2 \\ge c_{err}(\\epsilon)V_{\\mathrm{struct}} - g_{err}(\\epsilon)\n5164: $$",
      "metadata": {
        "label": "lem-error-concentration-target-set"
      },
      "section": "## 8. The N-Uniform Quantitative Keystone Lemma",
      "raw_directive": "5153: We can now prove the main lemma of this section.\n5154: \n5155: :::{prf:lemma} Error Concentration in the Target Set\n5156: :label: lem-error-concentration-target-set\n5157: \n5158: Let a swarm state $(S_1, S_2)$ be in the high-error regime, such that $V_{\\mathrm{struct}} > R^2_{\\mathrm{spread}}$. Let $k$ be the high-variance swarm and let $I_{\\text{target}} := I_{11} \\cap U_k \\cap H_k(\\epsilon)$ be the critical target set.\n5159: \n5160: The positional structural error concentrated within this target set is bounded below by a linear function of the total structural error:\n5161: \n5162: $$\n5163: \\frac{1}{N}\\sum_{i \\in I_{\\text{target}}} \\|\\Delta\\delta_{x,i}\\|^2 \\ge c_{err}(\\epsilon)V_{\\mathrm{struct}} - g_{err}(\\epsilon)\n5164: $$\n5165: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 8. The N-Uniform Quantitative Keystone Lemma"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-dead-walker-clone-prob",
      "title": "Total Cloning Probability for Dead Walkers",
      "start_line": 6031,
      "end_line": 6040,
      "header_lines": [
        6032
      ],
      "content_start": 6034,
      "content_end": 6039,
      "content": "6034: :label: lem-dead-walker-clone-prob\n6035: \n6036: Under the Axiom of Guaranteed Revival ($\\varepsilon_{\\text{clone}} \\cdot p_{\\max} < \\eta^{\\alpha+\\beta}$), any dead walker clones with probability 1:\n6037: \n6038: $$\n6039: i \\in \\mathcal{D}(S) \\implies p_i = 1",
      "metadata": {
        "label": "lem-dead-walker-clone-prob"
      },
      "section": "## 9.3. Decomposition into Sub-Operators",
      "raw_directive": "6031: :::\n6032: \n6033: :::{prf:lemma} Total Cloning Probability for Dead Walkers\n6034: :label: lem-dead-walker-clone-prob\n6035: \n6036: Under the Axiom of Guaranteed Revival ($\\varepsilon_{\\text{clone}} \\cdot p_{\\max} < \\eta^{\\alpha+\\beta}$), any dead walker clones with probability 1:\n6037: \n6038: $$\n6039: i \\in \\mathcal{D}(S) \\implies p_i = 1\n6040: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 11,
        "chapter_file": "chapter_11.json",
        "section_id": "## 9.3. Decomposition into Sub-Operators"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-change-decomposition",
      "title": "Variance Change Decomposition",
      "start_line": 6389,
      "end_line": 6417,
      "header_lines": [
        6390
      ],
      "content_start": 6392,
      "content_end": 6416,
      "content": "6392: :label: lem-variance-change-decomposition\n6393: \n6394: The total change in positional variance can be decomposed as:\n6395: \n6396: $$\n6397: \\Delta V_{\\text{Var},x} = \\sum_{k=1}^{2} \\left[\\underbrace{\\Delta V_{\\text{Var},x}^{(k,\\text{alive})}}_{\\text{alive walkers}} + \\underbrace{\\Delta V_{\\text{Var},x}^{(k,\\text{status})}}_{\\text{status changes}}\\right]\n6398: $$\n6399: \n6400: where:\n6401: \n6402: 1. **Alive walker contribution:**\n6403: \n6404: \n6405: $$\n6406: \\Delta V_{\\text{Var},x}^{(k,\\text{alive})} = \\frac{1}{N}\\sum_{i \\in \\mathcal{A}(S_k)} \\left[\\|\\delta'_{x,k,i}\\|^2 - \\|\\delta_{x,k,i}\\|^2\\right]\n6407: $$\n6408: \n6409:    where $\\delta'_{x,k,i}$ is the centered position after cloning.\n6410: \n6411: 2. **Status change contribution:**\n6412: \n6413: \n6414: $$\n6415: \\Delta V_{\\text{Var},x}^{(k,\\text{status})} = \\frac{1}{N}\\sum_{i \\in \\mathcal{D}(S_k)} \\|\\delta'_{x,k,i}\\|^2\n6416: $$",
      "metadata": {
        "label": "lem-variance-change-decomposition"
      },
      "section": "## 10.3. Positional Variance Contraction",
      "raw_directive": "6389: ### 10.3.3. Variance Decomposition\n6390: \n6391: :::{prf:lemma} Variance Change Decomposition\n6392: :label: lem-variance-change-decomposition\n6393: \n6394: The total change in positional variance can be decomposed as:\n6395: \n6396: $$\n6397: \\Delta V_{\\text{Var},x} = \\sum_{k=1}^{2} \\left[\\underbrace{\\Delta V_{\\text{Var},x}^{(k,\\text{alive})}}_{\\text{alive walkers}} + \\underbrace{\\Delta V_{\\text{Var},x}^{(k,\\text{status})}}_{\\text{status changes}}\\right]\n6398: $$\n6399: \n6400: where:\n6401: \n6402: 1. **Alive walker contribution:**\n6403: \n6404: \n6405: $$\n6406: \\Delta V_{\\text{Var},x}^{(k,\\text{alive})} = \\frac{1}{N}\\sum_{i \\in \\mathcal{A}(S_k)} \\left[\\|\\delta'_{x,k,i}\\|^2 - \\|\\delta_{x,k,i}\\|^2\\right]\n6407: $$\n6408: \n6409:    where $\\delta'_{x,k,i}$ is the centered position after cloning.\n6410: \n6411: 2. **Status change contribution:**\n6412: \n6413: \n6414: $$\n6415: \\Delta V_{\\text{Var},x}^{(k,\\text{status})} = \\frac{1}{N}\\sum_{i \\in \\mathcal{D}(S_k)} \\|\\delta'_{x,k,i}\\|^2\n6416: $$\n6417: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 17,
        "chapter_file": "chapter_17.json",
        "section_id": "## 10.3. Positional Variance Contraction"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-keystone-contraction-alive",
      "title": "Keystone-Driven Contraction for Stably Alive Walkers",
      "start_line": 6456,
      "end_line": 6468,
      "header_lines": [
        6457
      ],
      "content_start": 6459,
      "content_end": 6467,
      "content": "6459: :label: lem-keystone-contraction-alive\n6460: \n6461: For walkers in the stably alive set $I_{11}$, the expected change in their contribution to variance satisfies:\n6462: \n6463: $$\n6464: \\mathbb{E}_{\\text{clone}}\\left[\\sum_{i \\in I_{11}} \\sum_{k=1,2} \\left(\\|\\delta'_{x,k,i}\\|^2 - \\|\\delta_{x,k,i}\\|^2\\right)\\right] \\leq -\\frac{\\chi(\\epsilon)}{2N} \\cdot V_{\\text{struct}} + \\frac{g_{\\max}(\\epsilon)}{N} + C_{\\text{pers}}\n6465: $$\n6466: \n6467: where $\\chi(\\epsilon) > 0$ and $g_{\\max}(\\epsilon)$ are the Keystone constants (Lemma 8.1), and $C_{\\text{pers}}$ accounts for persisting walkers.",
      "metadata": {
        "label": "lem-keystone-contraction-alive"
      },
      "section": "## 10.3. Positional Variance Contraction",
      "raw_directive": "6456: We now bound the contribution from walkers that are alive in both swarms (the stably alive set $I_{11}$).\n6457: \n6458: :::{prf:lemma} Keystone-Driven Contraction for Stably Alive Walkers\n6459: :label: lem-keystone-contraction-alive\n6460: \n6461: For walkers in the stably alive set $I_{11}$, the expected change in their contribution to variance satisfies:\n6462: \n6463: $$\n6464: \\mathbb{E}_{\\text{clone}}\\left[\\sum_{i \\in I_{11}} \\sum_{k=1,2} \\left(\\|\\delta'_{x,k,i}\\|^2 - \\|\\delta_{x,k,i}\\|^2\\right)\\right] \\leq -\\frac{\\chi(\\epsilon)}{2N} \\cdot V_{\\text{struct}} + \\frac{g_{\\max}(\\epsilon)}{N} + C_{\\text{pers}}\n6465: $$\n6466: \n6467: where $\\chi(\\epsilon) > 0$ and $g_{\\max}(\\epsilon)$ are the Keystone constants (Lemma 8.1), and $C_{\\text{pers}}$ accounts for persisting walkers.\n6468: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 17,
        "chapter_file": "chapter_17.json",
        "section_id": "## 10.3. Positional Variance Contraction"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-dead-walker-revival-bounded",
      "title": "Bounded Contribution from Dead Walker Revival",
      "start_line": 6557,
      "end_line": 6567,
      "header_lines": [
        6558
      ],
      "content_start": 6560,
      "content_end": 6566,
      "content": "6560: :label: lem-dead-walker-revival-bounded\n6561: \n6562: The contribution to variance from revived dead walkers is bounded:\n6563: \n6564: $$\n6565: \\mathbb{E}_{\\text{clone}}\\left[\\sum_{k=1,2} \\Delta V_{\\text{Var},x}^{(k,\\text{status})}\\right] \\leq \\frac{2}{N} \\sum_{k=1,2} |\\mathcal{D}(S_k)| \\cdot D_{\\text{valid}}^2\n6566: $$",
      "metadata": {
        "label": "lem-dead-walker-revival-bounded"
      },
      "section": "## 10.3. Positional Variance Contraction",
      "raw_directive": "6557: ### 10.3.5. Bounding Status Change Contributions\n6558: \n6559: :::{prf:lemma} Bounded Contribution from Dead Walker Revival\n6560: :label: lem-dead-walker-revival-bounded\n6561: \n6562: The contribution to variance from revived dead walkers is bounded:\n6563: \n6564: $$\n6565: \\mathbb{E}_{\\text{clone}}\\left[\\sum_{k=1,2} \\Delta V_{\\text{Var},x}^{(k,\\text{status})}\\right] \\leq \\frac{2}{N} \\sum_{k=1,2} |\\mathcal{D}(S_k)| \\cdot D_{\\text{valid}}^2\n6566: $$\n6567: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 17,
        "chapter_file": "chapter_17.json",
        "section_id": "## 10.3. Positional Variance Contraction"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-fitness-gradient-boundary",
      "title": "Fitness Gradient from Boundary Proximity",
      "start_line": 7091,
      "end_line": 7107,
      "header_lines": [
        7092
      ],
      "content_start": 7094,
      "content_end": 7106,
      "content": "7094: :label: lem-fitness-gradient-boundary\n7095: \n7096: Consider two walkers $i$ and $j$ with similar positions and velocities, except that walker $i$ is closer to the boundary than walker $j$. Specifically, let:\n7097: \n7098: $$\n7099: \\varphi_{\\text{barrier}}(x_i) - \\varphi_{\\text{barrier}}(x_j) = \\Delta_{\\text{barrier}} > 0\n7100: $$\n7101: \n7102: Then, under the fitness evaluation pipeline (Chapter 5), walker $i$ has systematically lower fitness potential:\n7103: \n7104: $$\n7105: V_{\\text{fit},i} \\leq V_{\\text{fit},j} - f(\\Delta_{\\text{barrier}})\n7106: $$",
      "metadata": {
        "label": "lem-fitness-gradient-boundary"
      },
      "section": "## 11.2. The Boundary Barrier and Fitness Gradient",
      "raw_directive": "7091: This raw reward feeds into the fitness potential calculation, so walkers near the boundary have systematically lower fitness.\n7092: \n7093: :::{prf:lemma} Fitness Gradient from Boundary Proximity\n7094: :label: lem-fitness-gradient-boundary\n7095: \n7096: Consider two walkers $i$ and $j$ with similar positions and velocities, except that walker $i$ is closer to the boundary than walker $j$. Specifically, let:\n7097: \n7098: $$\n7099: \\varphi_{\\text{barrier}}(x_i) - \\varphi_{\\text{barrier}}(x_j) = \\Delta_{\\text{barrier}} > 0\n7100: $$\n7101: \n7102: Then, under the fitness evaluation pipeline (Chapter 5), walker $i$ has systematically lower fitness potential:\n7103: \n7104: $$\n7105: V_{\\text{fit},i} \\leq V_{\\text{fit},j} - f(\\Delta_{\\text{barrier}})\n7106: $$\n7107: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 23,
        "chapter_file": "chapter_23.json",
        "section_id": "## 11.2. The Boundary Barrier and Fitness Gradient"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-boundary-enhanced-cloning",
      "title": "Enhanced Cloning Probability Near Boundary",
      "start_line": 7322,
      "end_line": 7332,
      "header_lines": [
        7323
      ],
      "content_start": 7325,
      "content_end": 7331,
      "content": "7325: :label: lem-boundary-enhanced-cloning\n7326: \n7327: For any walker $i$ in the boundary-exposed set $\\mathcal{E}_{\\text{boundary}}(S)$, its cloning probability satisfies:\n7328: \n7329: $$\n7330: p_i \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7331: $$",
      "metadata": {
        "label": "lem-boundary-enhanced-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "raw_directive": "7322: ### 11.4.1. Cloning Probability for Boundary-Exposed Walkers\n7323: \n7324: :::{prf:lemma} Enhanced Cloning Probability Near Boundary\n7325: :label: lem-boundary-enhanced-cloning\n7326: \n7327: For any walker $i$ in the boundary-exposed set $\\mathcal{E}_{\\text{boundary}}(S)$, its cloning probability satisfies:\n7328: \n7329: $$\n7330: p_i \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7331: $$\n7332: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 25,
        "chapter_file": "chapter_25.json",
        "section_id": "## 11.4. Proof of Boundary Potential Contraction"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-barrier-reduction-cloning",
      "title": "Expected Barrier Reduction for Cloned Walker",
      "start_line": 7393,
      "end_line": 7410,
      "header_lines": [
        7394
      ],
      "content_start": 7396,
      "content_end": 7409,
      "content": "7396: :label: lem-barrier-reduction-cloning\n7397: \n7398: When a boundary-exposed walker $i$ clones, its expected barrier penalty after cloning satisfies:\n7399: \n7400: $$\n7401: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid i \\text{ clones}] \\leq \\mathbb{E}[\\varphi_{\\text{barrier}}(x_{c_i})] + C_{\\text{jitter}}\n7402: $$\n7403: \n7404: where $C_{\\text{jitter}} = O(\\sigma_x^2)$ accounts for the position jitter variance.\n7405: \n7406: Furthermore, if the companion is from the safe interior:\n7407: \n7408: $$\n7409: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid c_i \\in \\mathcal{I}_{\\text{safe}}] \\leq C_{\\text{jitter}}",
      "metadata": {
        "label": "lem-barrier-reduction-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "raw_directive": "7393: ### 11.4.2. Barrier Reduction from Cloning\n7394: \n7395: :::{prf:lemma} Expected Barrier Reduction for Cloned Walker\n7396: :label: lem-barrier-reduction-cloning\n7397: \n7398: When a boundary-exposed walker $i$ clones, its expected barrier penalty after cloning satisfies:\n7399: \n7400: $$\n7401: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid i \\text{ clones}] \\leq \\mathbb{E}[\\varphi_{\\text{barrier}}(x_{c_i})] + C_{\\text{jitter}}\n7402: $$\n7403: \n7404: where $C_{\\text{jitter}} = O(\\sigma_x^2)$ accounts for the position jitter variance.\n7405: \n7406: Furthermore, if the companion is from the safe interior:\n7407: \n7408: $$\n7409: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid c_i \\in \\mathcal{I}_{\\text{safe}}] \\leq C_{\\text{jitter}}\n7410: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "03_cloning",
        "chapter_index": 25,
        "chapter_file": "chapter_25.json",
        "section_id": "## 11.4. Proof of Boundary Potential Contraction"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-decomposition",
      "title": "Variance Decomposition by Clusters",
      "start_line": 276,
      "end_line": 346,
      "header_lines": [
        277
      ],
      "content_start": 279,
      "content_end": 345,
      "content": "279: :label: lem-variance-decomposition\n280: \n281: For a swarm $S_k$ partitioned into $I_k$ (target) and $J_k$ (complement) with population fractions $f_I = |I_k|/k$ and $f_J = |J_k|/k$:\n282: \n283: $$\n284: \\text{Var}_x(S_k) = f_I \\text{Var}_x(I_k) + f_J \\text{Var}_x(J_k) + f_I f_J \\|\\mu_x(I_k) - \\mu_x(J_k)\\|^2\n285: \n286: $$\n287: \n288: where:\n289: - $\\text{Var}_x(I_k) = \\frac{1}{|I_k|} \\sum_{i \\in I_k} \\|x_i - \\mu_x(I_k)\\|^2$ (within-target variance)\n290: - $\\text{Var}_x(J_k) = \\frac{1}{|J_k|} \\sum_{j \\in J_k} \\|x_j - \\mu_x(J_k)\\|^2$ (within-complement variance)\n291: - $\\mu_x(I_k) = \\frac{1}{|I_k|} \\sum_{i \\in I_k} x_i$ (target barycenter)\n292: - $\\mu_x(J_k) = \\frac{1}{|J_k|} \\sum_{j \\in J_k} x_j$ (complement barycenter)\n293: \n294: **Proof:**\n295: \n296: Standard variance decomposition. The total variance is:\n297: \n298: $$\n299: \\text{Var}_x(S_k) = \\frac{1}{k} \\sum_{i=1}^k \\|x_i - \\bar{x}_k\\|^2\n300: \n301: $$\n302: \n303: where $\\bar{x}_k = \\frac{1}{k}\\sum_{i=1}^k x_i = f_I \\mu_x(I_k) + f_J \\mu_x(J_k)$.\n304: \n305: Expand:\n306: \n307: $$\n308: \\begin{aligned}\n309: k \\cdot \\text{Var}_x(S_k) &= \\sum_{i \\in I_k} \\|x_i - \\bar{x}_k\\|^2 + \\sum_{j \\in J_k} \\|x_j - \\bar{x}_k\\|^2 \\\\\n310: &= \\sum_{i \\in I_k} \\|x_i - \\mu_x(I_k) + \\mu_x(I_k) - \\bar{x}_k\\|^2 + \\sum_{j \\in J_k} \\|x_j - \\mu_x(J_k) + \\mu_x(J_k) - \\bar{x}_k\\|^2\n311: \\end{aligned}\n312: \n313: $$\n314: \n315: Using $\\|a + b\\|^2 = \\|a\\|^2 + 2\\langle a, b\\rangle + \\|b\\|^2$ and $\\sum_{i \\in I_k} (x_i - \\mu_x(I_k)) = 0$:\n316: \n317: $$\n318: \\begin{aligned}\n319: &= \\sum_{i \\in I_k} \\|x_i - \\mu_x(I_k)\\|^2 + |I_k| \\|\\mu_x(I_k) - \\bar{x}_k\\|^2 \\\\\n320: &\\quad + \\sum_{j \\in J_k} \\|x_j - \\mu_x(J_k)\\|^2 + |J_k| \\|\\mu_x(J_k) - \\bar{x}_k\\|^2\n321: \\end{aligned}\n322: \n323: $$\n324: \n325: Now, $\\mu_x(I_k) - \\bar{x}_k = \\mu_x(I_k) - f_I \\mu_x(I_k) - f_J \\mu_x(J_k) = f_J (\\mu_x(I_k) - \\mu_x(J_k))$.\n326: \n327: Similarly, $\\mu_x(J_k) - \\bar{x}_k = -f_I (\\mu_x(I_k) - \\mu_x(J_k))$.\n328: \n329: Therefore:\n330: \n331: $$\n332: \\begin{aligned}\n333: k \\cdot \\text{Var}_x(S_k) &= |I_k| \\text{Var}_x(I_k) + |I_k| f_J^2 \\|\\mu_x(I_k) - \\mu_x(J_k)\\|^2 \\\\\n334: &\\quad + |J_k| \\text{Var}_x(J_k) + |J_k| f_I^2 \\|\\mu_x(I_k) - \\mu_x(J_k)\\|^2 \\\\\n335: &= |I_k| \\text{Var}_x(I_k) + |J_k| \\text{Var}_x(J_k) + (|I_k| f_J^2 + |J_k| f_I^2) \\|\\mu_x(I_k) - \\mu_x(J_k)\\|^2\n336: \\end{aligned}\n337: \n338: $$\n339: \n340: Using $|I_k| = f_I k$ and $|J_k| = f_J k$:\n341: \n342: $$\n343: |I_k| f_J^2 + |J_k| f_I^2 = k f_I f_J^2 + k f_J f_I^2 = k f_I f_J (f_J + f_I) = k f_I f_J\n344: \n345: $$",
      "metadata": {
        "label": "lem-variance-decomposition"
      },
      "section": "## 3. Variance Decomposition and Cross-Swarm Analysis",
      "raw_directive": "276: We first establish how variance decomposes with respect to the cluster partition.\n277: \n278: :::{prf:lemma} Variance Decomposition by Clusters\n279: :label: lem-variance-decomposition\n280: \n281: For a swarm $S_k$ partitioned into $I_k$ (target) and $J_k$ (complement) with population fractions $f_I = |I_k|/k$ and $f_J = |J_k|/k$:\n282: \n283: $$\n284: \\text{Var}_x(S_k) = f_I \\text{Var}_x(I_k) + f_J \\text{Var}_x(J_k) + f_I f_J \\|\\mu_x(I_k) - \\mu_x(J_k)\\|^2\n285: \n286: $$\n287: \n288: where:\n289: - $\\text{Var}_x(I_k) = \\frac{1}{|I_k|} \\sum_{i \\in I_k} \\|x_i - \\mu_x(I_k)\\|^2$ (within-target variance)\n290: - $\\text{Var}_x(J_k) = \\frac{1}{|J_k|} \\sum_{j \\in J_k} \\|x_j - \\mu_x(J_k)\\|^2$ (within-complement variance)\n291: - $\\mu_x(I_k) = \\frac{1}{|I_k|} \\sum_{i \\in I_k} x_i$ (target barycenter)\n292: - $\\mu_x(J_k) = \\frac{1}{|J_k|} \\sum_{j \\in J_k} x_j$ (complement barycenter)\n293: \n294: **Proof:**\n295: \n296: Standard variance decomposition. The total variance is:\n297: \n298: $$\n299: \\text{Var}_x(S_k) = \\frac{1}{k} \\sum_{i=1}^k \\|x_i - \\bar{x}_k\\|^2\n300: \n301: $$\n302: \n303: where $\\bar{x}_k = \\frac{1}{k}\\sum_{i=1}^k x_i = f_I \\mu_x(I_k) + f_J \\mu_x(J_k)$.\n304: \n305: Expand:\n306: \n307: $$\n308: \\begin{aligned}\n309: k \\cdot \\text{Var}_x(S_k) &= \\sum_{i \\in I_k} \\|x_i - \\bar{x}_k\\|^2 + \\sum_{j \\in J_k} \\|x_j - \\bar{x}_k\\|^2 \\\\\n310: &= \\sum_{i \\in I_k} \\|x_i - \\mu_x(I_k) + \\mu_x(I_k) - \\bar{x}_k\\|^2 + \\sum_{j \\in J_k} \\|x_j - \\mu_x(J_k) + \\mu_x(J_k) - \\bar{x}_k\\|^2\n311: \\end{aligned}\n312: \n313: $$\n314: \n315: Using $\\|a + b\\|^2 = \\|a\\|^2 + 2\\langle a, b\\rangle + \\|b\\|^2$ and $\\sum_{i \\in I_k} (x_i - \\mu_x(I_k)) = 0$:\n316: \n317: $$\n318: \\begin{aligned}\n319: &= \\sum_{i \\in I_k} \\|x_i - \\mu_x(I_k)\\|^2 + |I_k| \\|\\mu_x(I_k) - \\bar{x}_k\\|^2 \\\\\n320: &\\quad + \\sum_{j \\in J_k} \\|x_j - \\mu_x(J_k)\\|^2 + |J_k| \\|\\mu_x(J_k) - \\bar{x}_k\\|^2\n321: \\end{aligned}\n322: \n323: $$\n324: \n325: Now, $\\mu_x(I_k) - \\bar{x}_k = \\mu_x(I_k) - f_I \\mu_x(I_k) - f_J \\mu_x(J_k) = f_J (\\mu_x(I_k) - \\mu_x(J_k))$.\n326: \n327: Similarly, $\\mu_x(J_k) - \\bar{x}_k = -f_I (\\mu_x(I_k) - \\mu_x(J_k))$.\n328: \n329: Therefore:\n330: \n331: $$\n332: \\begin{aligned}\n333: k \\cdot \\text{Var}_x(S_k) &= |I_k| \\text{Var}_x(I_k) + |I_k| f_J^2 \\|\\mu_x(I_k) - \\mu_x(J_k)\\|^2 \\\\\n334: &\\quad + |J_k| \\text{Var}_x(J_k) + |J_k| f_I^2 \\|\\mu_x(I_k) - \\mu_x(J_k)\\|^2 \\\\\n335: &= |I_k| \\text{Var}_x(I_k) + |J_k| \\text{Var}_x(J_k) + (|I_k| f_J^2 + |J_k| f_I^2) \\|\\mu_x(I_k) - \\mu_x(J_k)\\|^2\n336: \\end{aligned}\n337: \n338: $$\n339: \n340: Using $|I_k| = f_I k$ and $|J_k| = f_J k$:\n341: \n342: $$\n343: |I_k| f_J^2 + |J_k| f_I^2 = k f_I f_J^2 + k f_J f_I^2 = k f_I f_J (f_J + f_I) = k f_I f_J\n344: \n345: $$\n346: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Variance Decomposition and Cross-Swarm Analysis"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cross-swarm-distance",
      "title": "Cross-Swarm Distance Decomposition",
      "start_line": 399,
      "end_line": 443,
      "header_lines": [
        400
      ],
      "content_start": 402,
      "content_end": 442,
      "content": "402: :label: lem-cross-swarm-distance\n403: \n404: For two swarms $S_1, S_2$ with partitions $(I_1, J_1)$ and $(I_2, J_2)$, and separation $L = \\|\\bar{x}_1 - \\bar{x}_2\\|$, define the **population-level cross-distances**:\n405: \n406: $$\n407: \\begin{aligned}\n408: D_{II} &:= \\frac{1}{|I_1||I_2|} \\sum_{i \\in I_1} \\sum_{j \\in I_2} \\|x_i - x_j\\|^2 \\\\\n409: D_{IJ} &:= \\frac{1}{|I_1||J_2|} \\sum_{i \\in I_1} \\sum_{j \\in J_2} \\|x_i - x_j\\|^2 \\\\\n410: D_{JI} &:= \\frac{1}{|J_1||I_2|} \\sum_{i \\in J_1} \\sum_{j \\in I_2} \\|x_i - x_j\\|^2 \\\\\n411: D_{JJ} &:= \\frac{1}{|J_1||J_2|} \\sum_{i \\in J_1} \\sum_{j \\in J_2} \\|x_i - x_j\\|^2\n412: \\end{aligned}\n413: \n414: $$\n415: \n416: Then:\n417: \n418: $$\n419: D_{II} \\approx L^2 + \\text{Var}_x(I_1) + \\text{Var}_x(I_2) + O(L \\cdot R_I)\n420: \n421: $$\n422: \n423: where $R_I = \\max(\\text{diam}(I_1), \\text{diam}(I_2))$ and \"diam\" denotes spatial diameter.\n424: \n425: **Proof:**\n426: \n427: Expand $D_{II}$ using $\\bar{x}_1 = f_{I,1} \\mu_x(I_1) + f_{J,1} \\mu_x(J_1)$ and similarly for $\\bar{x}_2$:\n428: \n429: $$\n430: \\begin{aligned}\n431: \\|x_i - x_j\\|^2 &= \\|(x_i - \\mu_x(I_1)) + (\\mu_x(I_1) - \\bar{x}_1) + (\\bar{x}_1 - \\bar{x}_2) + (\\bar{x}_2 - \\mu_x(I_2)) + (\\mu_x(I_2) - x_j)\\|^2\n432: \\end{aligned}\n433: \n434: $$\n435: \n436: The dominant term is $\\|\\bar{x}_1 - \\bar{x}_2\\|^2 = L^2$.\n437: \n438: The cross-terms involving $(x_i - \\mu_x(I_1))$ and $(\\bar{x}_1 - \\bar{x}_2)$ vanish when averaged over $i \\in I_1$ (since $\\sum_{i \\in I_1} (x_i - \\mu_x(I_1)) = 0$).\n439: \n440: The variance terms $\\|x_i - \\mu_x(I_1)\\|^2$ and $\\|x_j - \\mu_x(I_2)\\|^2$ average to $\\text{Var}_x(I_1)$ and $\\text{Var}_x(I_2)$.\n441: \n442: The remaining terms $\\|\\mu_x(I_k) - \\bar{x}_k\\|^2 = f_{J,k}^2 \\|\\mu_x(I_k) - \\mu_x(J_k)\\|^2$ are $O(R_I^2)$ where $R_I$ is the within-swarm separation scale.",
      "metadata": {
        "label": "lem-cross-swarm-distance"
      },
      "section": "## 3. Variance Decomposition and Cross-Swarm Analysis",
      "raw_directive": "399: Now we analyze the Wasserstein distance between two separated swarms.\n400: \n401: :::{prf:lemma} Cross-Swarm Distance Decomposition\n402: :label: lem-cross-swarm-distance\n403: \n404: For two swarms $S_1, S_2$ with partitions $(I_1, J_1)$ and $(I_2, J_2)$, and separation $L = \\|\\bar{x}_1 - \\bar{x}_2\\|$, define the **population-level cross-distances**:\n405: \n406: $$\n407: \\begin{aligned}\n408: D_{II} &:= \\frac{1}{|I_1||I_2|} \\sum_{i \\in I_1} \\sum_{j \\in I_2} \\|x_i - x_j\\|^2 \\\\\n409: D_{IJ} &:= \\frac{1}{|I_1||J_2|} \\sum_{i \\in I_1} \\sum_{j \\in J_2} \\|x_i - x_j\\|^2 \\\\\n410: D_{JI} &:= \\frac{1}{|J_1||I_2|} \\sum_{i \\in J_1} \\sum_{j \\in I_2} \\|x_i - x_j\\|^2 \\\\\n411: D_{JJ} &:= \\frac{1}{|J_1||J_2|} \\sum_{i \\in J_1} \\sum_{j \\in J_2} \\|x_i - x_j\\|^2\n412: \\end{aligned}\n413: \n414: $$\n415: \n416: Then:\n417: \n418: $$\n419: D_{II} \\approx L^2 + \\text{Var}_x(I_1) + \\text{Var}_x(I_2) + O(L \\cdot R_I)\n420: \n421: $$\n422: \n423: where $R_I = \\max(\\text{diam}(I_1), \\text{diam}(I_2))$ and \"diam\" denotes spatial diameter.\n424: \n425: **Proof:**\n426: \n427: Expand $D_{II}$ using $\\bar{x}_1 = f_{I,1} \\mu_x(I_1) + f_{J,1} \\mu_x(J_1)$ and similarly for $\\bar{x}_2$:\n428: \n429: $$\n430: \\begin{aligned}\n431: \\|x_i - x_j\\|^2 &= \\|(x_i - \\mu_x(I_1)) + (\\mu_x(I_1) - \\bar{x}_1) + (\\bar{x}_1 - \\bar{x}_2) + (\\bar{x}_2 - \\mu_x(I_2)) + (\\mu_x(I_2) - x_j)\\|^2\n432: \\end{aligned}\n433: \n434: $$\n435: \n436: The dominant term is $\\|\\bar{x}_1 - \\bar{x}_2\\|^2 = L^2$.\n437: \n438: The cross-terms involving $(x_i - \\mu_x(I_1))$ and $(\\bar{x}_1 - \\bar{x}_2)$ vanish when averaged over $i \\in I_1$ (since $\\sum_{i \\in I_1} (x_i - \\mu_x(I_1)) = 0$).\n439: \n440: The variance terms $\\|x_i - \\mu_x(I_1)\\|^2$ and $\\|x_j - \\mu_x(I_2)\\|^2$ average to $\\text{Var}_x(I_1)$ and $\\text{Var}_x(I_2)$.\n441: \n442: The remaining terms $\\|\\mu_x(I_k) - \\bar{x}_k\\|^2 = f_{J,k}^2 \\|\\mu_x(I_k) - \\mu_x(J_k)\\|^2$ are $O(R_I^2)$ where $R_I$ is the within-swarm separation scale.\n443: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Variance Decomposition and Cross-Swarm Analysis"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-wasserstein-link",
      "title": "Structural Variance and Wasserstein Distance Relationship",
      "start_line": 445,
      "end_line": 507,
      "header_lines": [
        446
      ],
      "content_start": 448,
      "content_end": 506,
      "content": "448: :label: lem-variance-wasserstein-link\n449: \n450: For two swarms $S_1, S_2$ with partitions $(I_1, J_1)$ and $(I_2, J_2)$ satisfying the separation condition $L = \\|\\bar{x}_1 - \\bar{x}_2\\| > D_{\\min}(\\varepsilon)$, the structural variance $V_{\\text{struct}}$ and squared Wasserstein-2 distance $W_2^2(\\mu_1, \\mu_2)$ satisfy:\n451: \n452: $$\n453: c_{\\text{link}}^{-} W_2^2(\\mu_1, \\mu_2) \\leq V_{\\text{struct}} \\leq c_{\\text{link}}^{+} W_2^2(\\mu_1, \\mu_2)\n454: $$\n455: \n456: where $c_{\\text{link}}^{\\pm}$ are positive constants depending on $\\varepsilon$ but not on $N$.\n457: \n458: **Proof:**\n459: \n460: **Upper bound**: By definition from [03_cloning](03_cloning) (§3.2), the structural variance is the position component of the hypocoercive error:\n461: \n462: $$\n463: V_{\\text{struct}} = \\text{Var}_x(S_k) = \\frac{1}{k} \\sum_{i=1}^k \\|x_i - \\bar{x}_k\\|^2\n464: $$\n465: \n466: For the cluster-preserving coupling, the Wasserstein-2 distance satisfies:\n467: \n468: $$\n469: W_2^2(\\mu_1, \\mu_2) \\geq \\frac{1}{N} \\sum_{(i,j) \\text{ matched}} \\|x_{1,i} - x_{2,j}\\|^2\n470: $$\n471: \n472: For any matching, the average squared distance between matched pairs can be decomposed using the law of cosines. For separated swarms with $L \\gg R_{\\text{spread}}$:\n473: \n474: $$\n475: \\frac{1}{N} \\sum_{i=1}^N \\|x_{1,i} - x_{2,\\pi(i)}\\|^2 \\approx L^2 + \\text{Var}_x(S_1) + \\text{Var}_x(S_2)\n476: $$\n477: \n478: Since both swarms have similar structural variance (by construction of the separation condition), we have $V_{\\text{struct}} \\leq 2 W_2^2(\\mu_1, \\mu_2)$ for $L$ sufficiently large.\n479: \n480: **Lower bound**: From Lemma {prf:ref}`lem-variance-decomposition` (variance decomposition) and Corollary {prf:ref}`cor-between-group-dominance` (between-group dominance), we have:\n481: \n482: $$\n483: V_{\\text{struct}} \\geq f_I f_J \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq c_{\\text{sep}}(\\varepsilon) \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2\n484: $$\n485: \n486: For separated swarms, the Wasserstein distance is bounded below by the distance between cluster barycenters. Using the optimal transport formulation:\n487: \n488: $$\n489: W_2^2(\\mu_1, \\mu_2) = \\inf_{\\gamma \\in \\Gamma(\\mu_1, \\mu_2)} \\int \\|x - y\\|^2 d\\gamma(x, y)\n490: $$\n491: \n492: Since $f_I > f_{UH}(\\varepsilon) > 0$ (Theorem 7.6.1 in [03_cloning](03_cloning)), a positive fraction of both swarms' mass is in the target sets. Any coupling $\\gamma$ must transport mass from $I_1$ to $I_2$ with average squared distance at least $\\|\\mu_x(I_1) - \\mu_x(I_2)\\|^2$.\n493: \n494: By the triangle inequality and cluster separation:\n495: \n496: $$\n497: \\|\\mu_x(I_1) - \\mu_x(I_2)\\|^2 \\geq \\frac{1}{2}(\\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 + \\|\\mu_x(I_2) - \\mu_x(J_2)\\|^2) - O(L \\cdot R_{\\text{spread}})\n498: $$\n499: \n500: For $L \\gg R_{\\text{spread}}$, combining these inequalities gives:\n501: \n502: $$\n503: W_2^2(\\mu_1, \\mu_2) \\geq f_{UH}^2 \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq \\frac{f_{UH}^2}{c_{\\text{sep}}(\\varepsilon)} V_{\\text{struct}}\n504: $$\n505: \n506: Defining $c_{\\text{link}}^{-} := f_{UH}^2 / c_{\\text{sep}}(\\varepsilon)$ and $c_{\\text{link}}^{+} := 2$ completes the proof.",
      "metadata": {
        "label": "lem-variance-wasserstein-link"
      },
      "section": "## 3. Variance Decomposition and Cross-Swarm Analysis",
      "raw_directive": "445: :::\n446: \n447: :::{prf:lemma} Structural Variance and Wasserstein Distance Relationship\n448: :label: lem-variance-wasserstein-link\n449: \n450: For two swarms $S_1, S_2$ with partitions $(I_1, J_1)$ and $(I_2, J_2)$ satisfying the separation condition $L = \\|\\bar{x}_1 - \\bar{x}_2\\| > D_{\\min}(\\varepsilon)$, the structural variance $V_{\\text{struct}}$ and squared Wasserstein-2 distance $W_2^2(\\mu_1, \\mu_2)$ satisfy:\n451: \n452: $$\n453: c_{\\text{link}}^{-} W_2^2(\\mu_1, \\mu_2) \\leq V_{\\text{struct}} \\leq c_{\\text{link}}^{+} W_2^2(\\mu_1, \\mu_2)\n454: $$\n455: \n456: where $c_{\\text{link}}^{\\pm}$ are positive constants depending on $\\varepsilon$ but not on $N$.\n457: \n458: **Proof:**\n459: \n460: **Upper bound**: By definition from [03_cloning](03_cloning) (§3.2), the structural variance is the position component of the hypocoercive error:\n461: \n462: $$\n463: V_{\\text{struct}} = \\text{Var}_x(S_k) = \\frac{1}{k} \\sum_{i=1}^k \\|x_i - \\bar{x}_k\\|^2\n464: $$\n465: \n466: For the cluster-preserving coupling, the Wasserstein-2 distance satisfies:\n467: \n468: $$\n469: W_2^2(\\mu_1, \\mu_2) \\geq \\frac{1}{N} \\sum_{(i,j) \\text{ matched}} \\|x_{1,i} - x_{2,j}\\|^2\n470: $$\n471: \n472: For any matching, the average squared distance between matched pairs can be decomposed using the law of cosines. For separated swarms with $L \\gg R_{\\text{spread}}$:\n473: \n474: $$\n475: \\frac{1}{N} \\sum_{i=1}^N \\|x_{1,i} - x_{2,\\pi(i)}\\|^2 \\approx L^2 + \\text{Var}_x(S_1) + \\text{Var}_x(S_2)\n476: $$\n477: \n478: Since both swarms have similar structural variance (by construction of the separation condition), we have $V_{\\text{struct}} \\leq 2 W_2^2(\\mu_1, \\mu_2)$ for $L$ sufficiently large.\n479: \n480: **Lower bound**: From Lemma {prf:ref}`lem-variance-decomposition` (variance decomposition) and Corollary {prf:ref}`cor-between-group-dominance` (between-group dominance), we have:\n481: \n482: $$\n483: V_{\\text{struct}} \\geq f_I f_J \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq c_{\\text{sep}}(\\varepsilon) \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2\n484: $$\n485: \n486: For separated swarms, the Wasserstein distance is bounded below by the distance between cluster barycenters. Using the optimal transport formulation:\n487: \n488: $$\n489: W_2^2(\\mu_1, \\mu_2) = \\inf_{\\gamma \\in \\Gamma(\\mu_1, \\mu_2)} \\int \\|x - y\\|^2 d\\gamma(x, y)\n490: $$\n491: \n492: Since $f_I > f_{UH}(\\varepsilon) > 0$ (Theorem 7.6.1 in [03_cloning](03_cloning)), a positive fraction of both swarms' mass is in the target sets. Any coupling $\\gamma$ must transport mass from $I_1$ to $I_2$ with average squared distance at least $\\|\\mu_x(I_1) - \\mu_x(I_2)\\|^2$.\n493: \n494: By the triangle inequality and cluster separation:\n495: \n496: $$\n497: \\|\\mu_x(I_1) - \\mu_x(I_2)\\|^2 \\geq \\frac{1}{2}(\\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 + \\|\\mu_x(I_2) - \\mu_x(J_2)\\|^2) - O(L \\cdot R_{\\text{spread}})\n498: $$\n499: \n500: For $L \\gg R_{\\text{spread}}$, combining these inequalities gives:\n501: \n502: $$\n503: W_2^2(\\mu_1, \\mu_2) \\geq f_{UH}^2 \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq \\frac{f_{UH}^2}{c_{\\text{sep}}(\\varepsilon)} V_{\\text{struct}}\n504: $$\n505: \n506: Defining $c_{\\text{link}}^{-} := f_{UH}^2 / c_{\\text{sep}}(\\varepsilon)$ and $c_{\\text{link}}^{+} := 2$ completes the proof.\n507: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Variance Decomposition and Cross-Swarm Analysis"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cluster-alignment",
      "title": "Cluster-Level Outlier Alignment",
      "start_line": 528,
      "end_line": 546,
      "header_lines": [
        529
      ],
      "content_start": 531,
      "content_end": 545,
      "content": "531: :label: lem-cluster-alignment\n532: \n533: For two swarms $S_1, S_2$ satisfying:\n534: 1. Structural error: $V_{\\text{struct}} > R^2_{\\text{spread}}$\n535: 2. Stability Condition holds (Theorem 7.5.2.4 in [03_cloning](03_cloning))\n536: 3. Separation: $L = \\|\\bar{x}_1 - \\bar{x}_2\\| > D_{\\min}(\\varepsilon)$\n537: \n538: The target set barycenters exhibit spatial alignment:\n539: \n540: $$\n541: \\langle \\mu_x(I_1) - \\mu_x(J_1), \\bar{x}_1 - \\bar{x}_2 \\rangle \\geq c_{\\text{align}}(\\varepsilon) \\|\\mu_x(I_1) - \\mu_x(J_1)\\| \\cdot L\n542: \n543: $$\n544: \n545: for some N-uniform constant $c_{\\text{align}}(\\varepsilon) > 0$.",
      "metadata": {
        "label": "lem-cluster-alignment"
      },
      "section": "## 4. Cluster-Level Outlier Alignment",
      "raw_directive": "528: ### 4.1. Static Proof Using Framework Axioms\n529: \n530: :::{prf:lemma} Cluster-Level Outlier Alignment\n531: :label: lem-cluster-alignment\n532: \n533: For two swarms $S_1, S_2$ satisfying:\n534: 1. Structural error: $V_{\\text{struct}} > R^2_{\\text{spread}}$\n535: 2. Stability Condition holds (Theorem 7.5.2.4 in [03_cloning](03_cloning))\n536: 3. Separation: $L = \\|\\bar{x}_1 - \\bar{x}_2\\| > D_{\\min}(\\varepsilon)$\n537: \n538: The target set barycenters exhibit spatial alignment:\n539: \n540: $$\n541: \\langle \\mu_x(I_1) - \\mu_x(J_1), \\bar{x}_1 - \\bar{x}_2 \\rangle \\geq c_{\\text{align}}(\\varepsilon) \\|\\mu_x(I_1) - \\mu_x(J_1)\\| \\cdot L\n542: \n543: $$\n544: \n545: for some N-uniform constant $c_{\\text{align}}(\\varepsilon) > 0$.\n546: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Cluster-Level Outlier Alignment"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-expected-distance-change",
      "title": "Expected Cross-Distance Change",
      "start_line": 711,
      "end_line": 764,
      "header_lines": [
        712
      ],
      "content_start": 714,
      "content_end": 763,
      "content": "714: :label: lem-expected-distance-change\n715: \n716: Under the cluster-preserving coupling {prf:ref}`def-cluster-coupling`, the expected change in population-level cross-distance $D_{IJ}$ after cloning in swarm 1 is:\n717: \n718: $$\n719: \\mathbb{E}[\\Delta D_{IJ}] \\leq -\\bar{p}_I \\cdot c_{\\text{geom}} \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 + O(\\delta^2)\n720: \n721: $$\n722: \n723: where:\n724: - $\\bar{p}_I = \\frac{1}{|I_1|} \\sum_{i \\in I_1} p_{1,i}$ is the average cloning probability in target set\n725: - $c_{\\text{geom}} > 0$ is a geometric constant from the cluster alignment\n726: \n727: **Proof:**\n728: \n729: Consider a walker $i \\in I_1$ (target set) with cloning probability $p_{1,i}$.\n730: \n731: If $i$ clones from a walker $j_1 \\in J_1$ (companion in complement set), the position updates:\n732: \n733: $$\n734: x'_{1,i} = x_{1,j_1} + \\zeta_i\n735: \n736: $$\n737: \n738: where $\\zeta_i \\sim \\mathcal{N}(0, \\delta^2 I_d)$.\n739: \n740: The change in squared distance to a walker $j_2 \\in I_2$ (target set in swarm 2) is:\n741: \n742: $$\n743: \\begin{aligned}\n744: \\Delta_{ij_2} &:= \\|x'_{1,i} - x_{2,j_2}\\|^2 - \\|x_{1,i} - x_{2,j_2}\\|^2 \\\\\n745: &= \\|x_{1,j_1} + \\zeta_i - x_{2,j_2}\\|^2 - \\|x_{1,i} - x_{2,j_2}\\|^2\n746: \\end{aligned}\n747: \n748: $$\n749: \n750: Taking expectation over $\\zeta_i$:\n751: \n752: $$\n753: \\mathbb{E}_{\\zeta_i}[\\Delta_{ij_2}] = \\|x_{1,j_1} - x_{2,j_2}\\|^2 - \\|x_{1,i} - x_{2,j_2}\\|^2 + d\\delta^2\n754: \n755: $$\n756: \n757: Using the identity $\\|a - c\\|^2 - \\|b - c\\|^2 = \\|a - b\\|^2 + 2\\langle a - b, b - c\\rangle$:\n758: \n759: $$\n760: \\mathbb{E}_{\\zeta_i}[\\Delta_{ij_2}] = \\|x_{1,j_1} - x_{1,i}\\|^2 + 2\\langle x_{1,j_1} - x_{1,i}, x_{1,i} - x_{2,j_2}\\rangle + d\\delta^2\n761: \n762: $$\n763: ",
      "metadata": {
        "label": "lem-expected-distance-change"
      },
      "section": "## 5. Expected Distance Change Under Cloning",
      "raw_directive": "711: ### 5.1. Population-Level Cloning Dynamics\n712: \n713: :::{prf:lemma} Expected Cross-Distance Change\n714: :label: lem-expected-distance-change\n715: \n716: Under the cluster-preserving coupling {prf:ref}`def-cluster-coupling`, the expected change in population-level cross-distance $D_{IJ}$ after cloning in swarm 1 is:\n717: \n718: $$\n719: \\mathbb{E}[\\Delta D_{IJ}] \\leq -\\bar{p}_I \\cdot c_{\\text{geom}} \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 + O(\\delta^2)\n720: \n721: $$\n722: \n723: where:\n724: - $\\bar{p}_I = \\frac{1}{|I_1|} \\sum_{i \\in I_1} p_{1,i}$ is the average cloning probability in target set\n725: - $c_{\\text{geom}} > 0$ is a geometric constant from the cluster alignment\n726: \n727: **Proof:**\n728: \n729: Consider a walker $i \\in I_1$ (target set) with cloning probability $p_{1,i}$.\n730: \n731: If $i$ clones from a walker $j_1 \\in J_1$ (companion in complement set), the position updates:\n732: \n733: $$\n734: x'_{1,i} = x_{1,j_1} + \\zeta_i\n735: \n736: $$\n737: \n738: where $\\zeta_i \\sim \\mathcal{N}(0, \\delta^2 I_d)$.\n739: \n740: The change in squared distance to a walker $j_2 \\in I_2$ (target set in swarm 2) is:\n741: \n742: $$\n743: \\begin{aligned}\n744: \\Delta_{ij_2} &:= \\|x'_{1,i} - x_{2,j_2}\\|^2 - \\|x_{1,i} - x_{2,j_2}\\|^2 \\\\\n745: &= \\|x_{1,j_1} + \\zeta_i - x_{2,j_2}\\|^2 - \\|x_{1,i} - x_{2,j_2}\\|^2\n746: \\end{aligned}\n747: \n748: $$\n749: \n750: Taking expectation over $\\zeta_i$:\n751: \n752: $$\n753: \\mathbb{E}_{\\zeta_i}[\\Delta_{ij_2}] = \\|x_{1,j_1} - x_{2,j_2}\\|^2 - \\|x_{1,i} - x_{2,j_2}\\|^2 + d\\delta^2\n754: \n755: $$\n756: \n757: Using the identity $\\|a - c\\|^2 - \\|b - c\\|^2 = \\|a - b\\|^2 + 2\\langle a - b, b - c\\rangle$:\n758: \n759: $$\n760: \\mathbb{E}_{\\zeta_i}[\\Delta_{ij_2}] = \\|x_{1,j_1} - x_{1,i}\\|^2 + 2\\langle x_{1,j_1} - x_{1,i}, x_{1,i} - x_{2,j_2}\\rangle + d\\delta^2\n761: \n762: $$\n763: \n764: :::{note}",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Expected Distance Change Under Cloning"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-target-cloning-pressure",
      "title": "Cloning Pressure on Target Set",
      "start_line": 803,
      "end_line": 833,
      "header_lines": [
        804
      ],
      "content_start": 806,
      "content_end": 832,
      "content": "806: :label: lem-target-cloning-pressure\n807: \n808: For any walker $i \\in I_k$ (target set), the cloning probability satisfies:\n809: \n810: $$\n811: p_{k,i} \\geq p_u(\\varepsilon) > 0\n812: \n813: $$\n814: \n815: where $p_u(\\varepsilon)$ is the N-uniform constant from Lemma 8.3.2 in [03_cloning](03_cloning), line 4881.\n816: \n817: **Proof:**\n818: \n819: By definition, $I_k = U_k \\cap H_k$ where $U_k$ is the unfit set.\n820: \n821: Lemma 8.3.2 ([03_cloning](03_cloning), line 4881) states:\n822: \n823: > For any walker $i$ in the unfit set $U_k$, its total cloning probability is bounded below by a positive, N-uniform, and $\\varepsilon$-dependent constant $p_u(\\varepsilon) > 0$.\n824: \n825: Since $I_k \\subseteq U_k$, the bound applies to all $i \\in I_k$.\n826: \n827: The explicit formula (from Section 8.6.1.1, line 5334):\n828: \n829: $$\n830: p_u(\\varepsilon) = \\min\\left(1, \\frac{1}{p_{\\max}(V_{\\text{pot,max}} + \\varepsilon_{\\text{clone}})} \\cdot \\frac{f_F f_U \\kappa_{V,\\text{gap}}(\\varepsilon)}{(k-1)(f_F + f_U^2/f_F)}\\right)\n831: \n832: $$",
      "metadata": {
        "label": "lem-target-cloning-pressure"
      },
      "section": "## 5. Expected Distance Change Under Cloning",
      "raw_directive": "803: ### 5.2. Lower Bound on Average Cloning Probability\n804: \n805: :::{prf:lemma} Cloning Pressure on Target Set\n806: :label: lem-target-cloning-pressure\n807: \n808: For any walker $i \\in I_k$ (target set), the cloning probability satisfies:\n809: \n810: $$\n811: p_{k,i} \\geq p_u(\\varepsilon) > 0\n812: \n813: $$\n814: \n815: where $p_u(\\varepsilon)$ is the N-uniform constant from Lemma 8.3.2 in [03_cloning](03_cloning), line 4881.\n816: \n817: **Proof:**\n818: \n819: By definition, $I_k = U_k \\cap H_k$ where $U_k$ is the unfit set.\n820: \n821: Lemma 8.3.2 ([03_cloning](03_cloning), line 4881) states:\n822: \n823: > For any walker $i$ in the unfit set $U_k$, its total cloning probability is bounded below by a positive, N-uniform, and $\\varepsilon$-dependent constant $p_u(\\varepsilon) > 0$.\n824: \n825: Since $I_k \\subseteq U_k$, the bound applies to all $i \\in I_k$.\n826: \n827: The explicit formula (from Section 8.6.1.1, line 5334):\n828: \n829: $$\n830: p_u(\\varepsilon) = \\min\\left(1, \\frac{1}{p_{\\max}(V_{\\text{pot,max}} + \\varepsilon_{\\text{clone}})} \\cdot \\frac{f_F f_U \\kappa_{V,\\text{gap}}(\\varepsilon)}{(k-1)(f_F + f_U^2/f_F)}\\right)\n831: \n832: $$\n833: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Expected Distance Change Under Cloning"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-wasserstein-population-bound",
      "title": "Wasserstein Distance and Population Cross-Distances",
      "start_line": 854,
      "end_line": 887,
      "header_lines": [
        855
      ],
      "content_start": 857,
      "content_end": 886,
      "content": "857: :label: lem-wasserstein-population-bound\n858: \n859: For two swarms with partitions $(I_1, J_1)$ and $(I_2, J_2)$, the Wasserstein-2 squared distance satisfies:\n860: \n861: $$\n862: W_2^2(\\mu_1, \\mu_2) \\leq f_{I,1} f_{I,2} D_{II} + f_{I,1} f_{J,2} D_{IJ} + f_{J,1} f_{I,2} D_{JI} + f_{J,1} f_{J,2} D_{JJ}\n863: \n864: $$\n865: \n866: where $f_{I,k} = |I_k|/N$ and $D_{AB}$ are the population cross-distances from Lemma {prf:ref}`lem-cross-swarm-distance`.\n867: \n868: **Proof:**\n869: \n870: The Wasserstein-2 distance for empirical measures is:\n871: \n872: $$\n873: W_2^2(\\mu_1, \\mu_2) = \\frac{1}{N} \\min_{\\pi \\in S_N} \\sum_{i=1}^N \\|x_{1,i} - x_{2,\\pi(i)}\\|^2\n874: \n875: $$\n876: \n877: where $S_N$ is the set of permutations.\n878: \n879: Any specific matching (not necessarily optimal) provides an upper bound. Consider the **cluster-respecting matching** that pairs $(I_1, I_2)$ internally and $(J_1, J_2)$ internally.\n880: \n881: The total squared distance for this matching is:\n882: \n883: $$\n884: \\sum_{\\text{pairs}} \\|x_{1,i} - x_{2,\\pi(i)}\\|^2 = \\sum_{i \\in I_1, \\pi(i) \\in I_2} \\|x_{1,i} - x_{2,\\pi(i)}\\|^2 + \\ldots\n885: \n886: $$",
      "metadata": {
        "label": "lem-wasserstein-population-bound"
      },
      "section": "## 6. Main Theorem: Wasserstein-2 Contraction",
      "raw_directive": "854: ### 6.1. Preliminary: Wasserstein Distance Bound\n855: \n856: :::{prf:lemma} Wasserstein Distance and Population Cross-Distances\n857: :label: lem-wasserstein-population-bound\n858: \n859: For two swarms with partitions $(I_1, J_1)$ and $(I_2, J_2)$, the Wasserstein-2 squared distance satisfies:\n860: \n861: $$\n862: W_2^2(\\mu_1, \\mu_2) \\leq f_{I,1} f_{I,2} D_{II} + f_{I,1} f_{J,2} D_{IJ} + f_{J,1} f_{I,2} D_{JI} + f_{J,1} f_{J,2} D_{JJ}\n863: \n864: $$\n865: \n866: where $f_{I,k} = |I_k|/N$ and $D_{AB}$ are the population cross-distances from Lemma {prf:ref}`lem-cross-swarm-distance`.\n867: \n868: **Proof:**\n869: \n870: The Wasserstein-2 distance for empirical measures is:\n871: \n872: $$\n873: W_2^2(\\mu_1, \\mu_2) = \\frac{1}{N} \\min_{\\pi \\in S_N} \\sum_{i=1}^N \\|x_{1,i} - x_{2,\\pi(i)}\\|^2\n874: \n875: $$\n876: \n877: where $S_N$ is the set of permutations.\n878: \n879: Any specific matching (not necessarily optimal) provides an upper bound. Consider the **cluster-respecting matching** that pairs $(I_1, I_2)$ internally and $(J_1, J_2)$ internally.\n880: \n881: The total squared distance for this matching is:\n882: \n883: $$\n884: \\sum_{\\text{pairs}} \\|x_{1,i} - x_{2,\\pi(i)}\\|^2 = \\sum_{i \\in I_1, \\pi(i) \\in I_2} \\|x_{1,i} - x_{2,\\pi(i)}\\|^2 + \\ldots\n885: \n886: $$\n887: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. Main Theorem: Wasserstein-2 Contraction"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-fitness-valley-static",
      "title": "Fitness Valley Between Separated Swarms",
      "start_line": 446,
      "end_line": 462,
      "header_lines": [
        447
      ],
      "content_start": 449,
      "content_end": 461,
      "content": "449: :label: lem-fitness-valley-static\n450: \n451: Let $F: \\mathbb{R}^d \\to \\mathbb{R}$ be the fitness function satisfying:\n452: - **Axiom 2.1.1 (Confining Potential):** $F(x)$ decays sufficiently fast as $\\|x\\| \\to \\infty$ to ensure particles remain bounded\n453: - **Axiom 4.1.1 (Environmental Richness):** The reward landscape $R(x)$ exhibits non-trivial spatial variation with multiple local maxima\n454: \n455: For any two points $\\bar{x}_1, \\bar{x}_2 \\in \\mathbb{R}^d$ that are local maxima of $F$ with separation $L = \\|\\bar{x}_1 - \\bar{x}_2\\| > 0$, there exists a point $x_{\\text{valley}}$ on the line segment $[\\bar{x}_1, \\bar{x}_2]$ such that:\n456: \n457: $$\n458: F(x_{\\text{valley}}) < \\min(F(\\bar{x}_1), F(\\bar{x}_2)) - \\Delta_{\\text{valley}}\n459: $$\n460: \n461: for some $\\Delta_{\\text{valley}} > 0$ depending on $L$ and the fitness landscape geometry.",
      "metadata": {
        "label": "lem-fitness-valley-static"
      },
      "section": "## 2. Foundational Lemmas for Outlier Alignment",
      "raw_directive": "446: Before proving the Outlier Alignment property, we establish that the fitness landscape structure guarantees the existence of low-fitness regions between separated swarms. This is a **static** property of the fitness function, not a dynamic consequence.\n447: \n448: :::{prf:lemma} Fitness Valley Between Separated Swarms\n449: :label: lem-fitness-valley-static\n450: \n451: Let $F: \\mathbb{R}^d \\to \\mathbb{R}$ be the fitness function satisfying:\n452: - **Axiom 2.1.1 (Confining Potential):** $F(x)$ decays sufficiently fast as $\\|x\\| \\to \\infty$ to ensure particles remain bounded\n453: - **Axiom 4.1.1 (Environmental Richness):** The reward landscape $R(x)$ exhibits non-trivial spatial variation with multiple local maxima\n454: \n455: For any two points $\\bar{x}_1, \\bar{x}_2 \\in \\mathbb{R}^d$ that are local maxima of $F$ with separation $L = \\|\\bar{x}_1 - \\bar{x}_2\\| > 0$, there exists a point $x_{\\text{valley}}$ on the line segment $[\\bar{x}_1, \\bar{x}_2]$ such that:\n456: \n457: $$\n458: F(x_{\\text{valley}}) < \\min(F(\\bar{x}_1), F(\\bar{x}_2)) - \\Delta_{\\text{valley}}\n459: $$\n460: \n461: for some $\\Delta_{\\text{valley}} > 0$ depending on $L$ and the fitness landscape geometry.\n462: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction_ASSEMBLED",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Foundational Lemmas for Outlier Alignment"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-outlier-alignment",
      "title": "Asymptotic Outlier Alignment",
      "start_line": 537,
      "end_line": 559,
      "header_lines": [
        538
      ],
      "content_start": 540,
      "content_end": 558,
      "content": "540: :label: lem-outlier-alignment\n541: \n542: Let $S_1$ and $S_2$ be two swarms satisfying the Geometric Partition (Definition 5.1.3 in [03_cloning.md](03_cloning.md)), with position barycenters $\\bar{x}_1$ and $\\bar{x}_2$ separated by:\n543: \n544: $$\n545: \\|\\bar{x}_1 - \\bar{x}_2\\| = L > D_{\\min}\n546: $$\n547: \n548: for some threshold $D_{\\min} > 0$ sufficiently large.\n549: \n550: Then for any outlier $x_{1,i} \\in H_1$ (high-error set), the following **Outlier Alignment** property holds:\n551: \n552: $$\n553: \\langle x_{1,i} - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle \\geq \\eta \\|x_{1,i} - \\bar{x}_1\\| \\|\\bar{x}_1 - \\bar{x}_2\\|\n554: $$\n555: \n556: where $\\eta > 0$ is a uniform constant depending only on framework parameters (independent of $N$, $L$, or swarm configurations).\n557: \n558: **Geometric Interpretation:** The vector from barycenter to outlier $(x_{1,i} - \\bar{x}_1)$ has positive projection onto the vector pointing away from the other swarm $(\\bar{x}_1 - \\bar{x}_2)$. Outliers are on the \"far side\" of their swarm, away from the other swarm.",
      "metadata": {
        "label": "lem-outlier-alignment"
      },
      "section": "## 2. Foundational Lemmas for Outlier Alignment",
      "raw_directive": "537: This is the **key innovation** of the proof. We show that outliers in separated swarms preferentially align away from the other swarm, and this property is **emergent** from the fitness landscape structure established in Lemma {prf:ref}`lem-fitness-valley-static`.\n538: \n539: :::{prf:lemma} Asymptotic Outlier Alignment\n540: :label: lem-outlier-alignment\n541: \n542: Let $S_1$ and $S_2$ be two swarms satisfying the Geometric Partition (Definition 5.1.3 in [03_cloning.md](03_cloning.md)), with position barycenters $\\bar{x}_1$ and $\\bar{x}_2$ separated by:\n543: \n544: $$\n545: \\|\\bar{x}_1 - \\bar{x}_2\\| = L > D_{\\min}\n546: $$\n547: \n548: for some threshold $D_{\\min} > 0$ sufficiently large.\n549: \n550: Then for any outlier $x_{1,i} \\in H_1$ (high-error set), the following **Outlier Alignment** property holds:\n551: \n552: $$\n553: \\langle x_{1,i} - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle \\geq \\eta \\|x_{1,i} - \\bar{x}_1\\| \\|\\bar{x}_1 - \\bar{x}_2\\|\n554: $$\n555: \n556: where $\\eta > 0$ is a uniform constant depending only on framework parameters (independent of $N$, $L$, or swarm configurations).\n557: \n558: **Geometric Interpretation:** The vector from barycenter to outlier $(x_{1,i} - \\bar{x}_1)$ has positive projection onto the vector pointing away from the other swarm $(\\bar{x}_1 - \\bar{x}_2)$. Outliers are on the \"far side\" of their swarm, away from the other swarm.\n559: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction_ASSEMBLED",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Foundational Lemmas for Outlier Alignment"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-case-a-bounded-expansion",
      "title": "Case A Bounded Expansion",
      "start_line": 938,
      "end_line": 950,
      "header_lines": [
        939
      ],
      "content_start": 941,
      "content_end": 949,
      "content": "941: :label: lem-case-a-bounded-expansion\n942: \n943: For a pair $(i,j)$ in Case A (consistent fitness ordering):\n944: \n945: $$\n946: \\mathbb{E}[\\|x'_{1,i} - x'_{2,i}\\|^2 + \\|x'_{1,j} - x'_{2,j}\\|^2 \\mid \\text{Case A}] \\leq (1 + \\epsilon_A) (D_{ii} + D_{jj}) + C_A\n947: $$\n948: \n949: where $\\epsilon_A = O(1/L)$ is small for separated swarms, and $C_A = 2d\\delta^2$.",
      "metadata": {
        "label": "lem-case-a-bounded-expansion"
      },
      "section": "## 3. Case A: Consistent Fitness Ordering",
      "raw_directive": "938: This doesn't give contraction. The issue is that Case A alone may not contract - it's the **combination** with Case B that provides overall contraction.\n939: \n940: :::{prf:lemma} Case A Bounded Expansion\n941: :label: lem-case-a-bounded-expansion\n942: \n943: For a pair $(i,j)$ in Case A (consistent fitness ordering):\n944: \n945: $$\n946: \\mathbb{E}[\\|x'_{1,i} - x'_{2,i}\\|^2 + \\|x'_{1,j} - x'_{2,j}\\|^2 \\mid \\text{Case A}] \\leq (1 + \\epsilon_A) (D_{ii} + D_{jj}) + C_A\n947: $$\n948: \n949: where $\\epsilon_A = O(1/L)$ is small for separated swarms, and $C_A = 2d\\delta^2$.\n950: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction_ASSEMBLED",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 3. Case A: Consistent Fitness Ordering"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-high-error-projection",
      "title": "High-Error Projection for Separated Swarms",
      "start_line": 1222,
      "end_line": 1328,
      "header_lines": [
        1223
      ],
      "content_start": 1225,
      "content_end": 1327,
      "content": "1225: :label: lem-high-error-projection\n1226: \n1227: For swarms $S_1, S_2$ with separation $L = \\|\\bar{x}_1 - \\bar{x}_2\\|$ and high-error fraction $|H_1| \\geq f_H N$ (from Corollary 6.4.4 in [03_cloning.md](03_cloning.md)):\n1228: \n1229: $$\n1230: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L/f_H}{2}\n1231: $$\n1232: \n1233: where $u = \\frac{\\bar{x}_1 - \\bar{x}_2}{L}$ is the unit direction.\n1234: \n1235: **Corollary:** For separated swarms with $L \\gg R_L/f_H$:\n1236: \n1237: $$\n1238: R_H(\\varepsilon) \\geq c_0 L - c_1\n1239: $$\n1240: \n1241: where $c_0 = f_H/2$ and $c_1 = R_L/f_H$ are N-uniform constants.\n1242: \n1243: **Proof:**\n1244: \n1245: **Step 1: Barycenter Decomposition**\n1246: \n1247: The barycenter difference can be decomposed:\n1248: \n1249: $$\n1250: \\bar{x}_1 - \\bar{x}_2 = \\frac{1}{N}\\sum_{i=1}^N (x_{1,i} - x_{2,i})\n1251: $$\n1252: \n1253: Separate into high-error and low-error sets:\n1254: \n1255: $$\n1256: \\bar{x}_1 - \\bar{x}_2 = \\frac{1}{N}\\sum_{i \\in H_1}(x_{1,i} - \\bar{x}_1) - \\frac{1}{N}\\sum_{i \\in H_2}(x_{2,i} - \\bar{x}_2) + O(R_L)\n1257: $$\n1258: \n1259: The $O(R_L)$ term accounts for low-error walkers concentrated near barycenters.\n1260: \n1261: **Step 2: Project onto Direction $u$**\n1262: \n1263: Taking inner product with $u$:\n1264: \n1265: $$\n1266: L = \\langle \\bar{x}_1 - \\bar{x}_2, u \\rangle \\leq \\frac{|H_1|}{N} \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + O(R_L)\n1267: $$\n1268: \n1269: **Step 3: Use High-Error Fraction Bound**\n1270: \n1271: By Corollary 6.4.4 in [03_cloning.md](03_cloning.md): $|H_1| \\geq f_H N$.\n1272: \n1273: Therefore:\n1274: \n1275: $$\n1276: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - O(R_L)}{f_H} \\geq \\frac{L - 2R_L/f_H}{f_H}\n1277: $$\n1278: \n1279: Wait, let me recalculate more carefully:\n1280: \n1281: $$\n1282: L \\leq \\frac{|H_1|}{N} \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + \\frac{|H_2|}{N} \\max_{i \\in H_2} \\langle \\bar{x}_2 - x_{2,i}, u \\rangle + 2R_L/N\n1283: $$\n1284: \n1285: Using $|H_k| \\geq f_H N$ and symmetry:\n1286: \n1287: $$\n1288: L \\leq 2 f_H \\cdot \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + 2R_L\n1289: $$\n1290: \n1291: Therefore:\n1292: \n1293: $$\n1294: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1295: $$\n1296: \n1297: **Step 4: Relate to $R_H$**\n1298: \n1299: Since $x_{1,i} \\in H_1$ implies $\\|x_{1,i} - \\bar{x}_1\\| \\geq R_H$ by definition:\n1300: \n1301: $$\n1302: \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\leq \\|x_{1,i} - \\bar{x}_1\\| \\cdot \\|u\\| = \\|x_{1,i} - \\bar{x}_1\\|\n1303: $$\n1304: \n1305: Therefore, the maximum projection is at most the maximum distance:\n1306: \n1307: $$\n1308: \\max_{i \\in H_1} \\|x_{1,i} - \\bar{x}_1\\| \\geq \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1309: $$\n1310: \n1311: But the maximum distance in $H_1$ is at least $R_H$ (and could be larger). To get a bound on $R_H$ itself, note that by definition of the geometric partition, there exists at least one walker at distance $\\geq R_H$.\n1312: \n1313: By the pigeonhole principle and the fact that $|H_1| \\geq f_H N$, we have:\n1314: \n1315: $$\n1316: R_H \\geq \\frac{1}{|H_1|} \\sum_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1317: $$\n1318: \n1319: (Actually, this argument needs refinement - the average projection is at least this, but we need the minimum distance in $H_1$, which is $R_H$ by definition.)\n1320: \n1321: **Corrected argument:** The separation $L$ must be \"generated\" by the displacement of high-error walkers. Since $|H_1| \\geq f_H N$, and these walkers contribute to the barycenter difference, at least a fraction $f_H$ of the separation comes from high-error displacement. This gives:\n1322: \n1323: $$\n1324: R_H \\geq c_0 L - c_1\n1325: $$\n1326: \n1327: where $c_0 = f_H/2$ (accounting for contributions from both swarms) and $c_1 = O(R_L/f_H)$.",
      "metadata": {
        "label": "lem-high-error-projection"
      },
      "section": "## Section 4 Updates: Quadratic Scaling Fixes",
      "raw_directive": "1222: This lemma provides an alternative derivation showing that $R_H$ itself scales with $L$ for separated swarms, making even the \"linear\" terms quadratic.\n1223: \n1224: :::{prf:lemma} High-Error Projection for Separated Swarms\n1225: :label: lem-high-error-projection\n1226: \n1227: For swarms $S_1, S_2$ with separation $L = \\|\\bar{x}_1 - \\bar{x}_2\\|$ and high-error fraction $|H_1| \\geq f_H N$ (from Corollary 6.4.4 in [03_cloning.md](03_cloning.md)):\n1228: \n1229: $$\n1230: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L/f_H}{2}\n1231: $$\n1232: \n1233: where $u = \\frac{\\bar{x}_1 - \\bar{x}_2}{L}$ is the unit direction.\n1234: \n1235: **Corollary:** For separated swarms with $L \\gg R_L/f_H$:\n1236: \n1237: $$\n1238: R_H(\\varepsilon) \\geq c_0 L - c_1\n1239: $$\n1240: \n1241: where $c_0 = f_H/2$ and $c_1 = R_L/f_H$ are N-uniform constants.\n1242: \n1243: **Proof:**\n1244: \n1245: **Step 1: Barycenter Decomposition**\n1246: \n1247: The barycenter difference can be decomposed:\n1248: \n1249: $$\n1250: \\bar{x}_1 - \\bar{x}_2 = \\frac{1}{N}\\sum_{i=1}^N (x_{1,i} - x_{2,i})\n1251: $$\n1252: \n1253: Separate into high-error and low-error sets:\n1254: \n1255: $$\n1256: \\bar{x}_1 - \\bar{x}_2 = \\frac{1}{N}\\sum_{i \\in H_1}(x_{1,i} - \\bar{x}_1) - \\frac{1}{N}\\sum_{i \\in H_2}(x_{2,i} - \\bar{x}_2) + O(R_L)\n1257: $$\n1258: \n1259: The $O(R_L)$ term accounts for low-error walkers concentrated near barycenters.\n1260: \n1261: **Step 2: Project onto Direction $u$**\n1262: \n1263: Taking inner product with $u$:\n1264: \n1265: $$\n1266: L = \\langle \\bar{x}_1 - \\bar{x}_2, u \\rangle \\leq \\frac{|H_1|}{N} \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + O(R_L)\n1267: $$\n1268: \n1269: **Step 3: Use High-Error Fraction Bound**\n1270: \n1271: By Corollary 6.4.4 in [03_cloning.md](03_cloning.md): $|H_1| \\geq f_H N$.\n1272: \n1273: Therefore:\n1274: \n1275: $$\n1276: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - O(R_L)}{f_H} \\geq \\frac{L - 2R_L/f_H}{f_H}\n1277: $$\n1278: \n1279: Wait, let me recalculate more carefully:\n1280: \n1281: $$\n1282: L \\leq \\frac{|H_1|}{N} \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + \\frac{|H_2|}{N} \\max_{i \\in H_2} \\langle \\bar{x}_2 - x_{2,i}, u \\rangle + 2R_L/N\n1283: $$\n1284: \n1285: Using $|H_k| \\geq f_H N$ and symmetry:\n1286: \n1287: $$\n1288: L \\leq 2 f_H \\cdot \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + 2R_L\n1289: $$\n1290: \n1291: Therefore:\n1292: \n1293: $$\n1294: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1295: $$\n1296: \n1297: **Step 4: Relate to $R_H$**\n1298: \n1299: Since $x_{1,i} \\in H_1$ implies $\\|x_{1,i} - \\bar{x}_1\\| \\geq R_H$ by definition:\n1300: \n1301: $$\n1302: \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\leq \\|x_{1,i} - \\bar{x}_1\\| \\cdot \\|u\\| = \\|x_{1,i} - \\bar{x}_1\\|\n1303: $$\n1304: \n1305: Therefore, the maximum projection is at most the maximum distance:\n1306: \n1307: $$\n1308: \\max_{i \\in H_1} \\|x_{1,i} - \\bar{x}_1\\| \\geq \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1309: $$\n1310: \n1311: But the maximum distance in $H_1$ is at least $R_H$ (and could be larger). To get a bound on $R_H$ itself, note that by definition of the geometric partition, there exists at least one walker at distance $\\geq R_H$.\n1312: \n1313: By the pigeonhole principle and the fact that $|H_1| \\geq f_H N$, we have:\n1314: \n1315: $$\n1316: R_H \\geq \\frac{1}{|H_1|} \\sum_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1317: $$\n1318: \n1319: (Actually, this argument needs refinement - the average projection is at least this, but we need the minimum distance in $H_1$, which is $R_H$ by definition.)\n1320: \n1321: **Corrected argument:** The separation $L$ must be \"generated\" by the displacement of high-error walkers. Since $|H_1| \\geq f_H N$, and these walkers contribute to the barycenter difference, at least a fraction $f_H$ of the separation comes from high-error displacement. This gives:\n1322: \n1323: $$\n1324: R_H \\geq c_0 L - c_1\n1325: $$\n1326: \n1327: where $c_0 = f_H/2$ (accounting for contributions from both swarms) and $c_1 = O(R_L/f_H)$.\n1328: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction_ASSEMBLED",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## Section 4 Updates: Quadratic Scaling Fixes"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-case-b-probability",
      "title": "Case B Frequency Lower Bound",
      "start_line": 1428,
      "end_line": 1519,
      "header_lines": [
        1429
      ],
      "content_start": 1431,
      "content_end": 1518,
      "content": "1431: :label: lem-case-b-probability\n1432: \n1433: For swarms $S_1, S_2$ with separation $L > D_{\\min}$, the probability that a pair $(i, \\pi(i))$ sampled from the matching distribution exhibits Case B is bounded below:\n1434: \n1435: $$\n1436: \\mathbb{P}(\\text{Case B} \\mid M) \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) > 0\n1437: $$\n1438: \n1439: where:\n1440: - $f_{UH}(\\varepsilon)$ is the unfit-high-error overlap fraction from Theorem 7.6.1 in [03_cloning.md](03_cloning.md)\n1441: - $q_{\\min}(\\varepsilon)$ is the minimum Gibbs matching probability\n1442: - Both constants are N-uniform\n1443: \n1444: **Proof:**\n1445: \n1446: **Step 1: Define Target Set**\n1447: \n1448: Let $I_{\\text{target}} = \\{i \\in \\{1,\\ldots,N\\} : x_{1,i} \\in H_1 \\cap U_1\\}$ be the set of walkers in swarm 1 that are both:\n1449: - In high-error set $H_1$ (geometric)\n1450: - In unfit set $U_1$ (fitness)\n1451: \n1452: By the Unfit-High-Error Overlap Theorem (Theorem 7.6.1 in [03_cloning.md](03_cloning.md)):\n1453: \n1454: $$\n1455: |I_{\\text{target}}| \\geq f_{UH}(\\varepsilon) \\cdot N\n1456: $$\n1457: \n1458: where $f_{UH}(\\varepsilon) > 0$ is N-uniform.\n1459: \n1460: **Step 2: Case B Structure for Target Walkers**\n1461: \n1462: For walker $i \\in I_{\\text{target}}$:\n1463: \n1464: **In swarm 1:** Walker $i$ is unfit, so by Lemma 8.3.2 in [03_cloning.md](03_cloning.md):\n1465: $$\n1466: V_{\\text{fit},1,i} < V_{\\text{fit},1,\\pi(i)}\n1467: $$\n1468: with high probability (the companion $\\pi(i)$ is selected from higher-fitness walkers).\n1469: \n1470: **In swarm 2:** By the Fitness-Geometry Correspondence Lemma ({prf:ref}`lem-fitness-geometry-correspondence`), for separated swarms:\n1471: $$\n1472: \\mathbb{P}(x_{2,i} \\in L_2 \\mid x_{1,i} \\in H_1) \\geq 1 - O(e^{-cL/R_H})\n1473: $$\n1474: \n1475: If $x_{2,i} \\in L_2$ (low-error in swarm 2), then:\n1476: $$\n1477: V_{\\text{fit},2,i} > V_{\\text{fit},2,\\pi(i)}\n1478: $$\n1479: \n1480: This is precisely Case B: reversed fitness ordering between the two swarms.\n1481: \n1482: **Step 3: Matching Probability**\n1483: \n1484: The matching $M$ is sampled from Gibbs distribution:\n1485: \n1486: $$\n1487: P(M \\mid S_1) \\propto \\prod_{(i,j) \\in M} \\exp\\left(-\\frac{d_{\\text{alg}}(i,j)^2}{2\\varepsilon_d^2}\\right)\n1488: $$\n1489: \n1490: The minimum probability over all matchings is:\n1491: \n1492: $$\n1493: q_{\\min}(\\varepsilon) = \\min_{M \\in \\mathcal{M}_N} P(M \\mid S_1) > 0\n1494: $$\n1495: \n1496: This is N-uniform (depends only on $\\varepsilon_d$ and algorithmic distance bounds).\n1497: \n1498: **Step 4: Union Bound**\n1499: \n1500: The probability of Case B is at least the probability that one of the target walkers is selected and exhibits Case B:\n1501: \n1502: $$\n1503: \\mathbb{P}(\\text{Case B}) \\geq \\mathbb{P}(\\exists i \\in I_{\\text{target}} : (i, \\pi(i)) \\in M \\text{ and Case B})\n1504: $$\n1505: \n1506: $$\n1507: \\geq \\frac{|I_{\\text{target}}|}{N} \\cdot q_{\\min} \\cdot (1 - O(e^{-cL/R_H}))\n1508: $$\n1509: \n1510: $$\n1511: \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) \\cdot (1 - O(e^{-cL/R_H}))\n1512: $$\n1513: \n1514: For $L > D_{\\min}$, the exponential term is negligible:\n1515: \n1516: $$\n1517: \\mathbb{P}(\\text{Case B}) \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) > 0\n1518: $$",
      "metadata": {
        "label": "lem-case-b-probability"
      },
      "section": "## Section 4 Updates: Quadratic Scaling Fixes",
      "raw_directive": "1428: To complete the contraction analysis, we must bound the probability that a randomly selected pair exhibits Case B (mixed fitness ordering).\n1429: \n1430: :::{prf:lemma} Case B Frequency Lower Bound\n1431: :label: lem-case-b-probability\n1432: \n1433: For swarms $S_1, S_2$ with separation $L > D_{\\min}$, the probability that a pair $(i, \\pi(i))$ sampled from the matching distribution exhibits Case B is bounded below:\n1434: \n1435: $$\n1436: \\mathbb{P}(\\text{Case B} \\mid M) \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) > 0\n1437: $$\n1438: \n1439: where:\n1440: - $f_{UH}(\\varepsilon)$ is the unfit-high-error overlap fraction from Theorem 7.6.1 in [03_cloning.md](03_cloning.md)\n1441: - $q_{\\min}(\\varepsilon)$ is the minimum Gibbs matching probability\n1442: - Both constants are N-uniform\n1443: \n1444: **Proof:**\n1445: \n1446: **Step 1: Define Target Set**\n1447: \n1448: Let $I_{\\text{target}} = \\{i \\in \\{1,\\ldots,N\\} : x_{1,i} \\in H_1 \\cap U_1\\}$ be the set of walkers in swarm 1 that are both:\n1449: - In high-error set $H_1$ (geometric)\n1450: - In unfit set $U_1$ (fitness)\n1451: \n1452: By the Unfit-High-Error Overlap Theorem (Theorem 7.6.1 in [03_cloning.md](03_cloning.md)):\n1453: \n1454: $$\n1455: |I_{\\text{target}}| \\geq f_{UH}(\\varepsilon) \\cdot N\n1456: $$\n1457: \n1458: where $f_{UH}(\\varepsilon) > 0$ is N-uniform.\n1459: \n1460: **Step 2: Case B Structure for Target Walkers**\n1461: \n1462: For walker $i \\in I_{\\text{target}}$:\n1463: \n1464: **In swarm 1:** Walker $i$ is unfit, so by Lemma 8.3.2 in [03_cloning.md](03_cloning.md):\n1465: $$\n1466: V_{\\text{fit},1,i} < V_{\\text{fit},1,\\pi(i)}\n1467: $$\n1468: with high probability (the companion $\\pi(i)$ is selected from higher-fitness walkers).\n1469: \n1470: **In swarm 2:** By the Fitness-Geometry Correspondence Lemma ({prf:ref}`lem-fitness-geometry-correspondence`), for separated swarms:\n1471: $$\n1472: \\mathbb{P}(x_{2,i} \\in L_2 \\mid x_{1,i} \\in H_1) \\geq 1 - O(e^{-cL/R_H})\n1473: $$\n1474: \n1475: If $x_{2,i} \\in L_2$ (low-error in swarm 2), then:\n1476: $$\n1477: V_{\\text{fit},2,i} > V_{\\text{fit},2,\\pi(i)}\n1478: $$\n1479: \n1480: This is precisely Case B: reversed fitness ordering between the two swarms.\n1481: \n1482: **Step 3: Matching Probability**\n1483: \n1484: The matching $M$ is sampled from Gibbs distribution:\n1485: \n1486: $$\n1487: P(M \\mid S_1) \\propto \\prod_{(i,j) \\in M} \\exp\\left(-\\frac{d_{\\text{alg}}(i,j)^2}{2\\varepsilon_d^2}\\right)\n1488: $$\n1489: \n1490: The minimum probability over all matchings is:\n1491: \n1492: $$\n1493: q_{\\min}(\\varepsilon) = \\min_{M \\in \\mathcal{M}_N} P(M \\mid S_1) > 0\n1494: $$\n1495: \n1496: This is N-uniform (depends only on $\\varepsilon_d$ and algorithmic distance bounds).\n1497: \n1498: **Step 4: Union Bound**\n1499: \n1500: The probability of Case B is at least the probability that one of the target walkers is selected and exhibits Case B:\n1501: \n1502: $$\n1503: \\mathbb{P}(\\text{Case B}) \\geq \\mathbb{P}(\\exists i \\in I_{\\text{target}} : (i, \\pi(i)) \\in M \\text{ and Case B})\n1504: $$\n1505: \n1506: $$\n1507: \\geq \\frac{|I_{\\text{target}}|}{N} \\cdot q_{\\min} \\cdot (1 - O(e^{-cL/R_H}))\n1508: $$\n1509: \n1510: $$\n1511: \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) \\cdot (1 - O(e^{-cL/R_H}))\n1512: $$\n1513: \n1514: For $L > D_{\\min}$, the exponential term is negligible:\n1515: \n1516: $$\n1517: \\mathbb{P}(\\text{Case B}) \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) > 0\n1518: $$\n1519: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction_ASSEMBLED",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## Section 4 Updates: Quadratic Scaling Fixes"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-case-a-weak-expansion",
      "title": "Case A Weak Expansion",
      "start_line": 1555,
      "end_line": 1575,
      "header_lines": [
        1556
      ],
      "content_start": 1558,
      "content_end": 1574,
      "content": "1558: :label: lem-case-a-weak-expansion\n1559: \n1560: For a Case A pair (i, π(i)) where both walkers have consistent fitness ordering with their companions, the post-cloning distance satisfies:\n1561: \n1562: $$\n1563: \\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case A}, M, T] \\leq D_{i\\pi(i)} + C_A \\delta^2\n1564: $$\n1565: \n1566: where $C_A = 4d$ is the noise constant, independent of $L$ and $N$.\n1567: \n1568: **Contraction Factor**:\n1569: $$\n1570: \\gamma_A := \\frac{\\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case A}, M, T]}{D_{i\\pi(i)}} \\leq 1 + \\frac{C_A \\delta^2}{D_{i\\pi(i)}}\n1571: $$\n1572: \n1573: For separated swarms with $D_{i\\pi(i)} \\sim L^2$:\n1574: $$",
      "metadata": {
        "label": "lem-case-a-weak-expansion"
      },
      "section": "## 5. Unified Single-Pair Lemma",
      "raw_directive": "1555: Before combining cases, we first establish that Case A provides only weak expansion that vanishes for large separations.\n1556: \n1557: :::{prf:lemma} Case A Weak Expansion\n1558: :label: lem-case-a-weak-expansion\n1559: \n1560: For a Case A pair (i, π(i)) where both walkers have consistent fitness ordering with their companions, the post-cloning distance satisfies:\n1561: \n1562: $$\n1563: \\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case A}, M, T] \\leq D_{i\\pi(i)} + C_A \\delta^2\n1564: $$\n1565: \n1566: where $C_A = 4d$ is the noise constant, independent of $L$ and $N$.\n1567: \n1568: **Contraction Factor**:\n1569: $$\n1570: \\gamma_A := \\frac{\\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case A}, M, T]}{D_{i\\pi(i)}} \\leq 1 + \\frac{C_A \\delta^2}{D_{i\\pi(i)}}\n1571: $$\n1572: \n1573: For separated swarms with $D_{i\\pi(i)} \\sim L^2$:\n1574: $$\n1575: \\gamma_A \\leq 1 + O(\\delta^2/L^2)",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction_ASSEMBLED",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 5. Unified Single-Pair Lemma"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-case-b-strong-contraction",
      "title": "Case B Strong Contraction",
      "start_line": 1668,
      "end_line": 1692,
      "header_lines": [
        1669
      ],
      "content_start": 1671,
      "content_end": 1691,
      "content": "1671: :label: lem-case-b-strong-contraction\n1672: \n1673: For a Case B pair $(i, \\pi(i))$ where walker $i \\in H_1$ and walker $\\pi(i) \\in H_2$ (high-error status in opposite swarms), the expected post-cloning distance satisfies:\n1674: \n1675: $$\n1676: \\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case B}, M, T] \\leq D_{i\\pi(i)} - \\kappa_B \\cdot D_{i\\pi(i)} + C_W\n1677: $$\n1678: \n1679: where:\n1680: - $\\kappa_B = \\frac{p_u \\eta_{\\text{geo}}}{2}$ is the Case B contraction constant\n1681: - $p_u \\geq \\exp(-\\beta \\Delta V_{\\max})/N$ is the minimum survival probability (N-uniform)\n1682: - $\\eta_{\\text{geo}} = \\frac{c_0^2}{2(1 + 2c_H)^2}$ is the geometric efficiency (from Lemma 4.3.7)\n1683: - $C_W = 4d\\delta^2$ is the noise constant\n1684: \n1685: **Contraction Factor**:\n1686: $$\n1687: \\gamma_B := \\frac{\\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case B}, M, T]}{D_{i\\pi(i)}} \\leq 1 - \\kappa_B + \\frac{C_W}{D_{i\\pi(i)}}\n1688: $$\n1689: \n1690: For separated swarms with $D_{i\\pi(i)} \\sim L^2$:\n1691: $$",
      "metadata": {
        "label": "lem-case-b-strong-contraction"
      },
      "section": "## 5. Unified Single-Pair Lemma",
      "raw_directive": "1668: Case B provides strong contraction due to the quadratic geometric advantage derived in Section 4.\n1669: \n1670: :::{prf:lemma} Case B Strong Contraction\n1671: :label: lem-case-b-strong-contraction\n1672: \n1673: For a Case B pair $(i, \\pi(i))$ where walker $i \\in H_1$ and walker $\\pi(i) \\in H_2$ (high-error status in opposite swarms), the expected post-cloning distance satisfies:\n1674: \n1675: $$\n1676: \\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case B}, M, T] \\leq D_{i\\pi(i)} - \\kappa_B \\cdot D_{i\\pi(i)} + C_W\n1677: $$\n1678: \n1679: where:\n1680: - $\\kappa_B = \\frac{p_u \\eta_{\\text{geo}}}{2}$ is the Case B contraction constant\n1681: - $p_u \\geq \\exp(-\\beta \\Delta V_{\\max})/N$ is the minimum survival probability (N-uniform)\n1682: - $\\eta_{\\text{geo}} = \\frac{c_0^2}{2(1 + 2c_H)^2}$ is the geometric efficiency (from Lemma 4.3.7)\n1683: - $C_W = 4d\\delta^2$ is the noise constant\n1684: \n1685: **Contraction Factor**:\n1686: $$\n1687: \\gamma_B := \\frac{\\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case B}, M, T]}{D_{i\\pi(i)}} \\leq 1 - \\kappa_B + \\frac{C_W}{D_{i\\pi(i)}}\n1688: $$\n1689: \n1690: For separated swarms with $D_{i\\pi(i)} \\sim L^2$:\n1691: $$\n1692: \\gamma_B \\leq 1 - \\kappa_B + O(\\delta^2/L^2) < 1 - \\frac{\\kappa_B}{2} \\quad \\text{for } L \\gg \\delta",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction_ASSEMBLED",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 5. Unified Single-Pair Lemma"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-location-error-drift-kinetic",
      "title": "Drift of Location Error Under Kinetics",
      "start_line": 1460,
      "end_line": 1475,
      "header_lines": [
        1461
      ],
      "content_start": 1463,
      "content_end": 1474,
      "content": "1463: :label: lem-location-error-drift-kinetic\n1464: \n1465: The location error $V_{\\text{loc}} = \\|\\Delta\\mu_x\\|^2 + \\lambda_v\\|\\Delta\\mu_v\\|^2 + b\\langle\\Delta\\mu_x, \\Delta\\mu_v\\rangle$ satisfies:\n1466: \n1467: $$\n1468: \\mathbb{E}[\\Delta V_{\\text{loc}}] \\leq -\\left[\\frac{\\alpha_{\\text{eff}}}{2} + \\gamma \\lambda_v - \\frac{b^2}{4\\lambda_v}\\right] V_{\\text{loc}} \\tau + C_{\\text{loc}}' \\tau\n1469: \n1470: $$\n1471: \n1472: where:\n1473: - $\\alpha_{\\text{eff}} = \\alpha_{\\text{eff}}(\\gamma, \\alpha_U, L_F, \\sigma_{\\min})$ is the effective contraction rate from hypocoercivity (not requiring convexity)\n1474: - $C_{\\text{loc}}' = O(\\sigma_{\\max}^2 + n_{\\text{status}})$ accounts for noise and status changes",
      "metadata": {
        "label": "lem-location-error-drift-kinetic"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1460: ### 4.5. Location Error Drift\n1461: \n1462: :::{prf:lemma} Drift of Location Error Under Kinetics\n1463: :label: lem-location-error-drift-kinetic\n1464: \n1465: The location error $V_{\\text{loc}} = \\|\\Delta\\mu_x\\|^2 + \\lambda_v\\|\\Delta\\mu_v\\|^2 + b\\langle\\Delta\\mu_x, \\Delta\\mu_v\\rangle$ satisfies:\n1466: \n1467: $$\n1468: \\mathbb{E}[\\Delta V_{\\text{loc}}] \\leq -\\left[\\frac{\\alpha_{\\text{eff}}}{2} + \\gamma \\lambda_v - \\frac{b^2}{4\\lambda_v}\\right] V_{\\text{loc}} \\tau + C_{\\text{loc}}' \\tau\n1469: \n1470: $$\n1471: \n1472: where:\n1473: - $\\alpha_{\\text{eff}} = \\alpha_{\\text{eff}}(\\gamma, \\alpha_U, L_F, \\sigma_{\\min})$ is the effective contraction rate from hypocoercivity (not requiring convexity)\n1474: - $C_{\\text{loc}}' = O(\\sigma_{\\max}^2 + n_{\\text{status}})$ accounts for noise and status changes\n1475: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_kinetic_contraction",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Hypocoercive Contraction of Inter-Swarm Error"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-structural-error-drift-kinetic",
      "title": "Drift of Structural Error Under Kinetics",
      "start_line": 1721,
      "end_line": 1732,
      "header_lines": [
        1722
      ],
      "content_start": 1724,
      "content_end": 1731,
      "content": "1724: :label: lem-structural-error-drift-kinetic\n1725: \n1726: The structural error $V_{\\text{struct}} = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ (Wasserstein distance between centered measures) satisfies:\n1727: \n1728: $$\n1729: \\mathbb{E}[\\Delta V_{\\text{struct}}] \\leq -\\kappa_{\\text{struct}} V_{\\text{struct}} \\tau + C_{\\text{struct}}' \\tau\n1730: \n1731: $$",
      "metadata": {
        "label": "lem-structural-error-drift-kinetic"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1721: ### 4.6. Structural Error Drift\n1722: \n1723: :::{prf:lemma} Drift of Structural Error Under Kinetics\n1724: :label: lem-structural-error-drift-kinetic\n1725: \n1726: The structural error $V_{\\text{struct}} = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ (Wasserstein distance between centered measures) satisfies:\n1727: \n1728: $$\n1729: \\mathbb{E}[\\Delta V_{\\text{struct}}] \\leq -\\kappa_{\\text{struct}} V_{\\text{struct}} \\tau + C_{\\text{struct}}' \\tau\n1730: \n1731: $$\n1732: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_kinetic_contraction",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Hypocoercive Contraction of Inter-Swarm Error"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-os-gaussian-reflection-invariant",
      "title": "Gaussian Kernel is Reflection Invariant",
      "start_line": 43,
      "end_line": 59,
      "header_lines": [
        44
      ],
      "content_start": 46,
      "content_end": 58,
      "content": "46: :label: lem-os-gaussian-reflection-invariant\n47: \n48: The Gaussian interaction kernel used in companion selection:\n49: \n50: $$\n51: K(x, y) := \\exp\\left(-\\frac{\\|x - y\\|^2}{2\\sigma^2}\\right)\n52: $$\n53: \n54: satisfies reflection invariance for any reflection operator $\\theta_\\mu$:\n55: \n56: $$\n57: K(\\theta_\\mu x, \\theta_\\mu y) = K(x, y)\n58: $$",
      "metadata": {
        "label": "lem-os-gaussian-reflection-invariant"
      },
      "section": "## OS2: Reflection Positivity",
      "raw_directive": "43: We begin with the simpler technical lemma.\n44: \n45: :::{prf:lemma} Gaussian Kernel is Reflection Invariant\n46: :label: lem-os-gaussian-reflection-invariant\n47: \n48: The Gaussian interaction kernel used in companion selection:\n49: \n50: $$\n51: K(x, y) := \\exp\\left(-\\frac{\\|x - y\\|^2}{2\\sigma^2}\\right)\n52: $$\n53: \n54: satisfies reflection invariance for any reflection operator $\\theta_\\mu$:\n55: \n56: $$\n57: K(\\theta_\\mu x, \\theta_\\mu y) = K(x, y)\n58: $$\n59: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_osterwalder_schrader_verification",
        "chapter_index": 0,
        "chapter_file": "chapter_0.json",
        "section_id": "## OS2: Reflection Positivity"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-os-psd-kernel-reflection-positive",
      "title": "Reflection Positivity from Positive Semidefinite Kernels",
      "start_line": 118,
      "end_line": 138,
      "header_lines": [
        119
      ],
      "content_start": 121,
      "content_end": 137,
      "content": "121: :label: lem-os-psd-kernel-reflection-positive\n122: \n123: Let $K: \\mathbb{R}^4 \\times \\mathbb{R}^4 \\to \\mathbb{R}$ be a **positive semidefinite kernel**:\n124: \n125: $$\n126: \\sum_{i,j=1}^{N} c_i \\cdot K(x_i, x_j) \\cdot c_j \\geq 0 \\quad \\forall N \\in \\mathbb{N}, \\, c_1, \\ldots, c_N \\in \\mathbb{R}, \\, x_1, \\ldots, x_N \\in \\mathbb{R}^4\n127: $$\n128: \n129: Suppose $K$ is reflection-invariant: $K(\\theta x, \\theta y) = K(x, y)$ for the time reflection $\\theta$.\n130: \n131: Let $P$ be a Markov kernel on $\\mathbb{R}^4$ constructed using $K$ (e.g., companion selection with Gaussian weights), and let $\\pi$ be an invariant measure for $P$.\n132: \n133: Then $\\pi$ satisfies **reflection positivity**: for any test function $f \\in \\mathcal{S}(\\mathcal{H}_+)$,\n134: \n135: $$\n136: \\langle f, \\theta f \\rangle_\\pi := \\int_{\\mathbb{R}^{4N}} f(\\mathcal{S}) \\cdot \\overline{f(\\theta \\mathcal{S})} \\, d\\pi(\\mathcal{S}) \\geq 0\n137: $$",
      "metadata": {
        "label": "lem-os-psd-kernel-reflection-positive"
      },
      "section": "## OS2: Reflection Positivity",
      "raw_directive": "118: This is the key functional analysis result connecting kernel properties to measure properties.\n119: \n120: :::{prf:lemma} Reflection Positivity from Positive Semidefinite Kernels\n121: :label: lem-os-psd-kernel-reflection-positive\n122: \n123: Let $K: \\mathbb{R}^4 \\times \\mathbb{R}^4 \\to \\mathbb{R}$ be a **positive semidefinite kernel**:\n124: \n125: $$\n126: \\sum_{i,j=1}^{N} c_i \\cdot K(x_i, x_j) \\cdot c_j \\geq 0 \\quad \\forall N \\in \\mathbb{N}, \\, c_1, \\ldots, c_N \\in \\mathbb{R}, \\, x_1, \\ldots, x_N \\in \\mathbb{R}^4\n127: $$\n128: \n129: Suppose $K$ is reflection-invariant: $K(\\theta x, \\theta y) = K(x, y)$ for the time reflection $\\theta$.\n130: \n131: Let $P$ be a Markov kernel on $\\mathbb{R}^4$ constructed using $K$ (e.g., companion selection with Gaussian weights), and let $\\pi$ be an invariant measure for $P$.\n132: \n133: Then $\\pi$ satisfies **reflection positivity**: for any test function $f \\in \\mathcal{S}(\\mathcal{H}_+)$,\n134: \n135: $$\n136: \\langle f, \\theta f \\rangle_\\pi := \\int_{\\mathbb{R}^{4N}} f(\\mathcal{S}) \\cdot \\overline{f(\\theta \\mathcal{S})} \\, d\\pi(\\mathcal{S}) \\geq 0\n137: $$\n138: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_osterwalder_schrader_verification",
        "chapter_index": 0,
        "chapter_file": "chapter_0.json",
        "section_id": "## OS2: Reflection Positivity"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-os-gaussian-exponential-decay",
      "title": "Gaussian Kernel Induces Exponential Clustering",
      "start_line": 361,
      "end_line": 377,
      "header_lines": [
        362
      ],
      "content_start": 364,
      "content_end": 376,
      "content": "364: :label: lem-os-gaussian-exponential-decay\n365: \n366: For walkers at positions $x, y \\in \\mathbb{R}^4$ with $\\|x - y\\| = r$, the companion interaction strength decays exponentially:\n367: \n368: $$\n369: K(x, y) = \\exp\\left(-\\frac{r^2}{2\\sigma^2}\\right) \\leq \\exp\\left(-\\frac{r}{2\\sigma}\\right)\n370: $$\n371: \n372: for $r \\geq \\sigma$.\n373: \n374: This establishes an **exponential suppression** with decay rate:\n375: \n376: $$",
      "metadata": {
        "label": "lem-os-gaussian-exponential-decay"
      },
      "section": "## OS4: Clustering (Exponential Decay of Correlations)",
      "raw_directive": "361: ### Lemma: Exponential Decay of Companion Correlations\n362: \n363: :::{prf:lemma} Gaussian Kernel Induces Exponential Clustering\n364: :label: lem-os-gaussian-exponential-decay\n365: \n366: For walkers at positions $x, y \\in \\mathbb{R}^4$ with $\\|x - y\\| = r$, the companion interaction strength decays exponentially:\n367: \n368: $$\n369: K(x, y) = \\exp\\left(-\\frac{r^2}{2\\sigma^2}\\right) \\leq \\exp\\left(-\\frac{r}{2\\sigma}\\right)\n370: $$\n371: \n372: for $r \\geq \\sigma$.\n373: \n374: This establishes an **exponential suppression** with decay rate:\n375: \n376: $$\n377: m_{\\text{corr}} := \\frac{1}{2\\sigma}",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_osterwalder_schrader_verification",
        "chapter_index": 1,
        "chapter_file": "chapter_1.json",
        "section_id": "## OS4: Clustering (Exponential Decay of Correlations)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-os0-gauge-fields-bounded",
      "title": "Gauge Fields are Bounded Observables",
      "start_line": 576,
      "end_line": 586,
      "header_lines": [
        577
      ],
      "content_start": 579,
      "content_end": 585,
      "content": "579: :label: lem-os0-gauge-fields-bounded\n580: \n581: The gauge fields $A_\\mu^a(x)$ constructed from Crystalline Gas walker observables (Section 4) are **bounded** at QSD:\n582: \n583: $$\n584: |A_\\mu^a(x)| \\leq C_{\\text{gauge}} < \\infty\n585: $$",
      "metadata": {
        "label": "lem-os0-gauge-fields-bounded"
      },
      "section": "## OS0: Regularity (Tempered Distributions)",
      "raw_directive": "576: ### Gauge Field Boundedness\n577: \n578: :::{prf:lemma} Gauge Fields are Bounded Observables\n579: :label: lem-os0-gauge-fields-bounded\n580: \n581: The gauge fields $A_\\mu^a(x)$ constructed from Crystalline Gas walker observables (Section 4) are **bounded** at QSD:\n582: \n583: $$\n584: |A_\\mu^a(x)| \\leq C_{\\text{gauge}} < \\infty\n585: $$\n586: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_osterwalder_schrader_verification",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## OS0: Regularity (Tempered Distributions)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-os1-operators-covariant",
      "title": "Crystalline Gas Operators are Euclidean Covariant",
      "start_line": 776,
      "end_line": 786,
      "header_lines": [
        777
      ],
      "content_start": 779,
      "content_end": 785,
      "content": "779: :label: lem-os1-operators-covariant\n780: \n781: The three Crystalline Gas operators are **Euclidean covariant**:\n782: \n783: 1. **Geometric ascent**: $\\Psi_{\\text{ascent}}(Rx) = R \\cdot \\Psi_{\\text{ascent}}(x)$\n784: 2. **Thermal fluctuation**: $\\Psi_{\\text{thermal}}(Rx) \\overset{d}{=} R \\cdot \\Psi_{\\text{thermal}}(x)$\n785: 3. **Companion interaction**: Uses metric $d_{\\mathcal{X}}(x, y) = \\|x - y\\|$, which is SO(4)-invariant",
      "metadata": {
        "label": "lem-os1-operators-covariant"
      },
      "section": "## OS1: Euclidean Invariance",
      "raw_directive": "776: ### Operator Euclidean Invariance\n777: \n778: :::{prf:lemma} Crystalline Gas Operators are Euclidean Covariant\n779: :label: lem-os1-operators-covariant\n780: \n781: The three Crystalline Gas operators are **Euclidean covariant**:\n782: \n783: 1. **Geometric ascent**: $\\Psi_{\\text{ascent}}(Rx) = R \\cdot \\Psi_{\\text{ascent}}(x)$\n784: 2. **Thermal fluctuation**: $\\Psi_{\\text{thermal}}(Rx) \\overset{d}{=} R \\cdot \\Psi_{\\text{thermal}}(x)$\n785: 3. **Companion interaction**: Uses metric $d_{\\mathcal{X}}(x, y) = \\|x - y\\|$, which is SO(4)-invariant\n786: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_osterwalder_schrader_verification",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## OS1: Euclidean Invariance"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mass-conservation-transport",
      "title": "Mass Conservation of Transport",
      "start_line": 570,
      "end_line": 579,
      "header_lines": [
        571
      ],
      "content_start": 573,
      "content_end": 578,
      "content": "573: :label: lem-mass-conservation-transport\n574: \n575: The integral of the transport operator over the domain $\\Omega$ vanishes due to the reflecting boundary conditions on both position and velocity boundaries:\n576: \n577: $$\n578: \\int_\\Omega L^\\dagger f(t,z)\\,\\mathrm{d}z = 0",
      "metadata": {
        "label": "lem-mass-conservation-transport"
      },
      "section": "## 3. The Mass-Conserving Forward Equation (PDE)",
      "raw_directive": "570: With the reflecting boundary conditions established in Section 2.2, this transport operator conserves total mass. This is a crucial simplification over models with absorbing boundaries.\n571: \n572: :::{prf:lemma} Mass Conservation of Transport\n573: :label: lem-mass-conservation-transport\n574: \n575: The integral of the transport operator over the domain $\\Omega$ vanishes due to the reflecting boundary conditions on both position and velocity boundaries:\n576: \n577: $$\n578: \\int_\\Omega L^\\dagger f(t,z)\\,\\mathrm{d}z = 0\n579: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "07_mean_field",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. The Mass-Conserving Forward Equation (PDE)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-exchangeability",
      "title": "Exchangeability of the N-Particle QSD",
      "start_line": 214,
      "end_line": 223,
      "header_lines": [
        215
      ],
      "content_start": 217,
      "content_end": 222,
      "content": "217: :label: lem-exchangeability\n218: \n219: The unique N-particle QSD $\\nu_N^{QSD}$ is an exchangeable measure on the product space $\\Omega^N$. That is, for any permutation $\\sigma$ of the indices $\\{1, \\ldots, N\\}$ and any measurable set $A \\subseteq \\Omega^N$,\n220: \n221: $$\n222: \\nu_N^{QSD}(\\{(z_1, \\ldots, z_N) \\in A\\}) = \\nu_N^{QSD}(\\{(z_{\\sigma(1)}, \\ldots, z_{\\sigma(N)}) \\in A\\})",
      "metadata": {
        "label": "lem-exchangeability"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "214: #### **Lemma A.1: Exchangeability of the N-Particle QSD**\n215: \n216: :::{prf:lemma} Exchangeability of the N-Particle QSD\n217: :label: lem-exchangeability\n218: \n219: The unique N-particle QSD $\\nu_N^{QSD}$ is an exchangeable measure on the product space $\\Omega^N$. That is, for any permutation $\\sigma$ of the indices $\\{1, \\ldots, N\\}$ and any measurable set $A \\subseteq \\Omega^N$,\n220: \n221: $$\n222: \\nu_N^{QSD}(\\{(z_1, \\ldots, z_N) \\in A\\}) = \\nu_N^{QSD}(\\{(z_{\\sigma(1)}, \\ldots, z_{\\sigma(N)}) \\in A\\})\n223: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-empirical-convergence",
      "title": "Weak Convergence of the Empirical Companion Measure",
      "start_line": 236,
      "end_line": 252,
      "header_lines": [
        237
      ],
      "content_start": 239,
      "content_end": 251,
      "content": "239: :label: lem-empirical-convergence\n240: \n241: Let $\\{N_k\\}$ be any subsequence such that $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$. For a configuration $S_{N_k} = (z_1, \\ldots, z_{N_k})$ drawn from $\\nu_{N_k}^{QSD}$, define the empirical companion measure\n242: \n243: $$\n244: \\mu_{N_k-1}^{\\text{comp}}(S_{N_k}) := \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\delta_{z_j}\n245: \n246: $$\n247: \n248: Then for $\\nu_{N_k}^{QSD}$-almost every sequence of configurations, as $k \\to \\infty$,\n249: \n250: $$\n251: \\mu_{N_k-1}^{\\text{comp}}(S_{N_k}) \\rightharpoonup \\mu_\\infty \\quad \\text{weakly in } \\mathcal{P}(\\Omega)",
      "metadata": {
        "label": "lem-empirical-convergence"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "236: #### **Lemma A.2: Weak Convergence of the Empirical Companion Measure**\n237: \n238: :::{prf:lemma} Weak Convergence of the Empirical Companion Measure\n239: :label: lem-empirical-convergence\n240: \n241: Let $\\{N_k\\}$ be any subsequence such that $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$. For a configuration $S_{N_k} = (z_1, \\ldots, z_{N_k})$ drawn from $\\nu_{N_k}^{QSD}$, define the empirical companion measure\n242: \n243: $$\n244: \\mu_{N_k-1}^{\\text{comp}}(S_{N_k}) := \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\delta_{z_j}\n245: \n246: $$\n247: \n248: Then for $\\nu_{N_k}^{QSD}$-almost every sequence of configurations, as $k \\to \\infty$,\n249: \n250: $$\n251: \\mu_{N_k-1}^{\\text{comp}}(S_{N_k}) \\rightharpoonup \\mu_\\infty \\quad \\text{weakly in } \\mathcal{P}(\\Omega)\n252: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-reward-continuity",
      "title": "Continuity of the Reward Moments",
      "start_line": 278,
      "end_line": 287,
      "header_lines": [
        279
      ],
      "content_start": 281,
      "content_end": 286,
      "content": "281: :label: lem-reward-continuity\n282: \n283: The reward moment functionals $\\mu_R[\\cdot]$ and $\\sigma_R^2[\\cdot]$ are continuous with respect to weak convergence of measures. That is, if $\\{\\mu_k\\}$ converges weakly to $\\mu_\\infty$, then\n284: \n285: $$\n286: \\lim_{k \\to \\infty} \\mu_R[\\mu_k] = \\mu_R[\\mu_\\infty] \\quad \\text{and} \\quad \\lim_{k \\to \\infty} \\sigma_R^2[\\mu_k] = \\sigma_R^2[\\mu_\\infty]",
      "metadata": {
        "label": "lem-reward-continuity"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "278: #### **Lemma B.1: Continuity of the Reward Moments**\n279: \n280: :::{prf:lemma} Continuity of the Reward Moments\n281: :label: lem-reward-continuity\n282: \n283: The reward moment functionals $\\mu_R[\\cdot]$ and $\\sigma_R^2[\\cdot]$ are continuous with respect to weak convergence of measures. That is, if $\\{\\mu_k\\}$ converges weakly to $\\mu_\\infty$, then\n284: \n285: $$\n286: \\lim_{k \\to \\infty} \\mu_R[\\mu_k] = \\mu_R[\\mu_\\infty] \\quad \\text{and} \\quad \\lim_{k \\to \\infty} \\sigma_R^2[\\mu_k] = \\sigma_R^2[\\mu_\\infty]\n287: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-distance-continuity",
      "title": "Continuity of the Distance Moments",
      "start_line": 307,
      "end_line": 316,
      "header_lines": [
        308
      ],
      "content_start": 310,
      "content_end": 315,
      "content": "310: :label: lem-distance-continuity\n311: \n312: The distance moment functionals $\\mu_D[\\cdot]$ and $\\sigma_D^2[\\cdot]$ are continuous with respect to weak convergence of measures. That is, if $\\{\\mu_k\\}$ converges weakly to $\\mu_\\infty$, then\n313: \n314: $$\n315: \\lim_{k \\to \\infty} \\mu_D[\\mu_k] = \\mu_D[\\mu_\\infty] \\quad \\text{and} \\quad \\lim_{k \\to \\infty} \\sigma_D^2[\\mu_k] = \\sigma_D^2[\\mu_\\infty]",
      "metadata": {
        "label": "lem-distance-continuity"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "307: #### **Lemma B.2: Continuity of the Distance Moments**\n308: \n309: :::{prf:lemma} Continuity of the Distance Moments\n310: :label: lem-distance-continuity\n311: \n312: The distance moment functionals $\\mu_D[\\cdot]$ and $\\sigma_D^2[\\cdot]$ are continuous with respect to weak convergence of measures. That is, if $\\{\\mu_k\\}$ converges weakly to $\\mu_\\infty$, then\n313: \n314: $$\n315: \\lim_{k \\to \\infty} \\mu_D[\\mu_k] = \\mu_D[\\mu_\\infty] \\quad \\text{and} \\quad \\lim_{k \\to \\infty} \\sigma_D^2[\\mu_k] = \\sigma_D^2[\\mu_\\infty]\n316: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniform-integrability",
      "title": "Uniform Integrability and Interchange of Limits",
      "start_line": 362,
      "end_line": 380,
      "header_lines": [
        363
      ],
      "content_start": 365,
      "content_end": 379,
      "content": "365: :label: lem-uniform-integrability\n366: \n367: Let $\\phi \\in C_c^\\infty(\\Omega)$ be a smooth, compactly supported test function. The sequence of integrands\n368: \n369: $$\n370: \\left\\{ \\mathcal{L}_{N_k} \\phi(z_1) \\right\\}_{k=1}^\\infty\n371: \n372: $$\n373: \n374: is uniformly integrable with respect to the measures $\\{\\nu_{N_k}^{QSD}\\}$. Consequently, for any convergent subsequence $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$,\n375: \n376: $$\n377: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = \\mathbb{E}_{\\mu_\\infty}\\left[\\lim_{k \\to \\infty} \\mathbb{E}^{(N_k)}_{\\text{comp}}[\\mathcal{L}_{N_k} \\phi(z_1) \\mid z_1]\\right]\n378: \n379: $$",
      "metadata": {
        "label": "lem-uniform-integrability"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "362: #### **Lemma C.1: Uniform Integrability and Interchange of Limits**\n363: \n364: :::{prf:lemma} Uniform Integrability and Interchange of Limits\n365: :label: lem-uniform-integrability\n366: \n367: Let $\\phi \\in C_c^\\infty(\\Omega)$ be a smooth, compactly supported test function. The sequence of integrands\n368: \n369: $$\n370: \\left\\{ \\mathcal{L}_{N_k} \\phi(z_1) \\right\\}_{k=1}^\\infty\n371: \n372: $$\n373: \n374: is uniformly integrable with respect to the measures $\\{\\nu_{N_k}^{QSD}\\}$. Consequently, for any convergent subsequence $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$,\n375: \n376: $$\n377: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = \\mathbb{E}_{\\mu_\\infty}\\left[\\lim_{k \\to \\infty} \\mathbb{E}^{(N_k)}_{\\text{comp}}[\\mathcal{L}_{N_k} \\phi(z_1) \\mid z_1]\\right]\n378: \n379: $$\n380: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-boundary-convergence",
      "title": "Convergence of Boundary Death and Revival",
      "start_line": 411,
      "end_line": 423,
      "header_lines": [
        412
      ],
      "content_start": 414,
      "content_end": 422,
      "content": "414: :label: lem-boundary-convergence\n415: \n416: Let $\\{N_k\\}$ be any subsequence such that $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$. The discrete boundary death and revival mechanism of the N-particle system converges to the continuous interior-killing-and-revival operators. For any smooth test function $\\phi \\in C_c^\\infty(\\Omega)$:\n417: \n418: $$\n419: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n420: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n421: \n422: $$",
      "metadata": {
        "label": "lem-boundary-convergence"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "411: #### **Lemma C.2: Convergence of the Boundary Death and Revival Mechanism**\n412: \n413: :::{prf:lemma} Convergence of Boundary Death and Revival\n414: :label: lem-boundary-convergence\n415: \n416: Let $\\{N_k\\}$ be any subsequence such that $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$. The discrete boundary death and revival mechanism of the N-particle system converges to the continuous interior-killing-and-revival operators. For any smooth test function $\\phi \\in C_c^\\infty(\\Omega)$:\n417: \n418: $$\n419: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n420: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n421: \n422: $$\n423: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniqueness-self-mapping",
      "title": "Self-Mapping Property of the Solution Operator",
      "start_line": 935,
      "end_line": 939,
      "header_lines": [
        936
      ],
      "content_start": 938,
      "content_end": 938,
      "content": "938: :label: lem-uniqueness-self-mapping",
      "metadata": {
        "label": "lem-uniqueness-self-mapping"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "raw_directive": "935: A stationary solution is a fixed point of the solution operator $\\mathcal{T}: \\mathcal{P} \\to \\mathcal{P}$.\n936: \n937: :::{prf:lemma} Self-Mapping Property of the Solution Operator\n938: :label: lem-uniqueness-self-mapping\n939: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniqueness-lipschitz-moments",
      "title": "Lipschitz Continuity of Moment Functionals",
      "start_line": 1062,
      "end_line": 1073,
      "header_lines": [
        1063
      ],
      "content_start": 1065,
      "content_end": 1072,
      "content": "1065: :label: lem-uniqueness-lipschitz-moments\n1066: \n1067: The moment functionals $\\mu_R[\\cdot], \\sigma_R[\\cdot], \\mu_D[\\cdot], \\sigma_D[\\cdot]$ are Lipschitz continuous from $H^1_w(\\Omega)$ to $\\mathbb{R}$. That is, there exist constants $L_{\\mu}, L_{\\sigma} > 0$ such that for all $\\rho_1, \\rho_2 \\in \\mathcal{P}$:\n1068: \n1069: $$\n1070: |\\mu_R[\\rho_1] - \\mu_R[\\rho_2]| \\le L_{\\mu} \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1071: \n1072: $$",
      "metadata": {
        "label": "lem-uniqueness-lipschitz-moments"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "raw_directive": "1062: :::\n1063: \n1064: :::{prf:lemma} Lipschitz Continuity of Moment Functionals\n1065: :label: lem-uniqueness-lipschitz-moments\n1066: \n1067: The moment functionals $\\mu_R[\\cdot], \\sigma_R[\\cdot], \\mu_D[\\cdot], \\sigma_D[\\cdot]$ are Lipschitz continuous from $H^1_w(\\Omega)$ to $\\mathbb{R}$. That is, there exist constants $L_{\\mu}, L_{\\sigma} > 0$ such that for all $\\rho_1, \\rho_2 \\in \\mathcal{P}$:\n1068: \n1069: $$\n1070: |\\mu_R[\\rho_1] - \\mu_R[\\rho_2]| \\le L_{\\mu} \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1071: \n1072: $$\n1073: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniqueness-fixed-point-bounded",
      "title": "Fixed Points Lie in a Bounded Ball",
      "start_line": 1107,
      "end_line": 1116,
      "header_lines": [
        1108
      ],
      "content_start": 1110,
      "content_end": 1115,
      "content": "1110: :label: lem-uniqueness-fixed-point-bounded\n1111: \n1112: Any fixed point $\\rho^* \\in \\mathcal{P}$ of the solution operator $\\mathcal{T}$ satisfies a uniform bound in the $H^1_w$ norm. Specifically, there exists a radius $R_* < \\infty$, independent of the particular fixed point, such that:\n1113: \n1114: $$\n1115: \\|\\rho^*\\|_{H^1_w} \\leq R_*",
      "metadata": {
        "label": "lem-uniqueness-fixed-point-bounded"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "raw_directive": "1107: :::\n1108: \n1109: :::{prf:lemma} Fixed Points Lie in a Bounded Ball\n1110: :label: lem-uniqueness-fixed-point-bounded\n1111: \n1112: Any fixed point $\\rho^* \\in \\mathcal{P}$ of the solution operator $\\mathcal{T}$ satisfies a uniform bound in the $H^1_w$ norm. Specifically, there exists a radius $R_* < \\infty$, independent of the particular fixed point, such that:\n1113: \n1114: $$\n1115: \\|\\rho^*\\|_{H^1_w} \\leq R_*\n1116: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniqueness-lipschitz-fitness-potential",
      "title": "Lipschitz Continuity of the Fitness Potential",
      "start_line": 1241,
      "end_line": 1250,
      "header_lines": [
        1242
      ],
      "content_start": 1244,
      "content_end": 1249,
      "content": "1244: :label: lem-uniqueness-lipschitz-fitness-potential\n1245: \n1246: The fitness potential operator $\\rho \\mapsto V[\\rho]$ is Lipschitz continuous from $\\mathcal{P}$ to $L^\\infty(\\Omega)$. That is, there exists $L_V > 0$ such that:\n1247: \n1248: $$\n1249: \\|V[\\rho_1] - V[\\rho_2]\\|_{L^\\infty} \\le L_V \\|\\rho_1 - \\rho_2\\|_{H^1_w}",
      "metadata": {
        "label": "lem-uniqueness-lipschitz-fitness-potential"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "raw_directive": "1241: :::\n1242: \n1243: :::{prf:lemma} Lipschitz Continuity of the Fitness Potential\n1244: :label: lem-uniqueness-lipschitz-fitness-potential\n1245: \n1246: The fitness potential operator $\\rho \\mapsto V[\\rho]$ is Lipschitz continuous from $\\mathcal{P}$ to $L^\\infty(\\Omega)$. That is, there exists $L_V > 0$ such that:\n1247: \n1248: $$\n1249: \\|V[\\rho_1] - V[\\rho_2]\\|_{L^\\infty} \\le L_V \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1250: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniqueness-lipschitz-cloning-operator",
      "title": "Local Lipschitz Continuity of the Cloning Operator",
      "start_line": 1279,
      "end_line": 1290,
      "header_lines": [
        1280
      ],
      "content_start": 1282,
      "content_end": 1289,
      "content": "1282: :label: lem-uniqueness-lipschitz-cloning-operator\n1283: \n1284: The cloning operator $S: \\mathcal{P} \\to H^1_w(\\Omega)$ is **locally Lipschitz continuous**. For any $R > 0$, on the ball $\\mathcal{P}_R := \\mathcal{P} \\cap \\{\\rho : \\|\\rho\\|_{H^1_w} \\leq R\\}$, there exists a Lipschitz constant $L_S(R)$ such that for all $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$:\n1285: \n1286: $$\n1287: \\|S[\\rho_1] - S[\\rho_2]\\|_{H^1_w} \\le L_S(R) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1288: \n1289: $$",
      "metadata": {
        "label": "lem-uniqueness-lipschitz-cloning-operator"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "raw_directive": "1279: :::\n1280: \n1281: :::{prf:lemma} Local Lipschitz Continuity of the Cloning Operator\n1282: :label: lem-uniqueness-lipschitz-cloning-operator\n1283: \n1284: The cloning operator $S: \\mathcal{P} \\to H^1_w(\\Omega)$ is **locally Lipschitz continuous**. For any $R > 0$, on the ball $\\mathcal{P}_R := \\mathcal{P} \\cap \\{\\rho : \\|\\rho\\|_{H^1_w} \\leq R\\}$, there exists a Lipschitz constant $L_S(R)$ such that for all $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$:\n1285: \n1286: $$\n1287: \\|S[\\rho_1] - S[\\rho_2]\\|_{H^1_w} \\le L_S(R) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1288: \n1289: $$\n1290: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniqueness-hormander-verification",
      "title": "Verification of Hörmander's Condition for the Kinetic Operator",
      "start_line": 1468,
      "end_line": 1472,
      "header_lines": [
        1469
      ],
      "content_start": 1471,
      "content_end": 1471,
      "content": "1471: :label: lem-uniqueness-hormander-verification",
      "metadata": {
        "label": "lem-uniqueness-hormander-verification"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "raw_directive": "1468: :::\n1469: \n1470: :::{prf:lemma} Verification of Hörmander's Condition for the Kinetic Operator\n1471: :label: lem-uniqueness-hormander-verification\n1472: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniqueness-scaling-hypoelliptic-constant",
      "title": "Scaling of $C_{\\text{hypo}}$ with Diffusion Strength",
      "start_line": 1642,
      "end_line": 1658,
      "header_lines": [
        1643
      ],
      "content_start": 1645,
      "content_end": 1657,
      "content": "1645: :label: lem-uniqueness-scaling-hypoelliptic-constant\n1646: \n1647: The constant $C_{\\text{hypo}}$ from Theorem [](#thm-uniqueness-hypoelliptic-regularity) satisfies the scaling estimate:\n1648: \n1649: $$\n1650: C_{\\text{hypo}} \\sim \\frac{1}{\\min(\\sigma_v^2 \\gamma, C)}\n1651: \n1652: $$\n1653: \n1654: In particular, for $C$ fixed and $\\sigma_v^2$ sufficiently large:\n1655: \n1656: $$\n1657: C_{\\text{hypo}} \\lesssim \\frac{1}{\\sigma_v^2 \\gamma}",
      "metadata": {
        "label": "lem-uniqueness-scaling-hypoelliptic-constant"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "raw_directive": "1642: #### **C.4. Scaling of the Hypoelliptic Constant**\n1643: \n1644: :::{prf:lemma} Scaling of $C_{\\text{hypo}}$ with Diffusion Strength\n1645: :label: lem-uniqueness-scaling-hypoelliptic-constant\n1646: \n1647: The constant $C_{\\text{hypo}}$ from Theorem [](#thm-uniqueness-hypoelliptic-regularity) satisfies the scaling estimate:\n1648: \n1649: $$\n1650: C_{\\text{hypo}} \\sim \\frac{1}{\\min(\\sigma_v^2 \\gamma, C)}\n1651: \n1652: $$\n1653: \n1654: In particular, for $C$ fixed and $\\sigma_v^2$ sufficiently large:\n1655: \n1656: $$\n1657: C_{\\text{hypo}} \\lesssim \\frac{1}{\\sigma_v^2 \\gamma}\n1658: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hypocoercive-dissipation",
      "title": "Dissipation of the Hypocoercive Norm",
      "start_line": 612,
      "end_line": 622,
      "header_lines": [
        613
      ],
      "content_start": 615,
      "content_end": 621,
      "content": "615: :label: lem-hypocoercive-dissipation\n616: \n617: For the kinetic generator $\\mathcal{L}_{\\text{kin}}$ with harmonic potential $U(x) = \\frac{\\kappa}{2}|x - x^*|^2$, there exist constants $\\lambda, \\mu > 0$ such that:\n618: \n619: $$\n620: \\frac{d}{dt} \\mathcal{E}_{\\text{hypo}}(f_t, f_t) \\le -2\\alpha \\mathcal{E}_{\\text{hypo}}(f_t, f_t)\n621: $$",
      "metadata": {
        "label": "lem-hypocoercive-dissipation"
      },
      "section": "## 2. The Hypoelliptic Kinetic Operator",
      "raw_directive": "612: The key insight of hypocoercivity is that while $\\mathcal{L}_{\\text{kin}}$ does not dissipate $\\|\\nabla_x f\\|^2$ directly, the coupling $v \\cdot \\nabla_x$ transfers dissipation from velocity to position.\n613: \n614: :::{prf:lemma} Dissipation of the Hypocoercive Norm\n615: :label: lem-hypocoercive-dissipation\n616: \n617: For the kinetic generator $\\mathcal{L}_{\\text{kin}}$ with harmonic potential $U(x) = \\frac{\\kappa}{2}|x - x^*|^2$, there exist constants $\\lambda, \\mu > 0$ such that:\n618: \n619: $$\n620: \\frac{d}{dt} \\mathcal{E}_{\\text{hypo}}(f_t, f_t) \\le -2\\alpha \\mathcal{E}_{\\text{hypo}}(f_t, f_t)\n621: $$\n622: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 2. The Hypoelliptic Kinetic Operator"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-log-concave-yang-mills",
      "title": "Log-Concavity for Pure Yang-Mills Vacuum",
      "start_line": 1073,
      "end_line": 1142,
      "header_lines": [
        1074
      ],
      "content_start": 1076,
      "content_end": 1141,
      "content": "1076: :label: lem-log-concave-yang-mills\n1077: \n1078: For the Yang-Mills vacuum state, the log-concavity condition {prf:ref}`def-log-concavity-condition` is **satisfied**.\n1079: \n1080: **Proof:**\n1081: \n1082: **Step 1: Simplify the system**\n1083: \n1084: For the Yang-Mills vacuum:\n1085: - **Uniform reward**: $r(x) = r_0 = \\text{constant}$ (no preferred field configuration in vacuum)\n1086: - **Quadratic confinement**: $U(x) = \\frac{\\kappa_{\\text{conf}}}{2}\\|x\\|^2$ (harmonic confining potential)\n1087: \n1088: **Step 2: Analyze fitness potential**\n1089: \n1090: With uniform reward, the fitness potential simplifies dramatically:\n1091: $$\n1092: V_{\\text{fit}}(x) = \\text{Rescale}(Z_r(x)) + \\beta \\cdot \\text{Rescale}(Z_d(x))\n1093: $$\n1094: \n1095: where $Z_r(x) = 0$ (no reward gradient) and $Z_d(x)$ is the diversity Z-score (distance to companions).\n1096: \n1097: For uniform reward:\n1098: $$\n1099: V_{\\text{fit}}(x) \\approx \\beta \\cdot f(d(x, \\text{swarm center}))\n1100: $$\n1101: \n1102: where $f$ is a smooth, slowly-varying function.\n1103: \n1104: **Step 3: Compute emergent metric**\n1105: \n1106: $$\n1107: H(x) = \\nabla^2 V_{\\text{fit}}(x) \\approx \\beta \\cdot \\nabla^2 f\n1108: $$\n1109: \n1110: For a smooth diversity term, $\\|\\nabla^2 f\\| = O(1)$ is bounded. With regularization:\n1111: $$\n1112: g(x) = H(x) + \\epsilon_\\Sigma I \\approx \\beta \\cdot O(1) + \\epsilon_\\Sigma I \\approx \\text{const} \\cdot I\n1113: $$\n1114: \n1115: **The metric is approximately flat**: $g(x) \\approx c I$ for some constant $c > 0$.\n1116: \n1117: **Step 4: Analyze effective potential**\n1118: \n1119: $$\n1120: U_{\\text{eff}}(x) = U(x) - \\epsilon_F V_{\\text{fit}}(x) = \\frac{\\kappa_{\\text{conf}}}{2}\\|x\\|^2 - \\epsilon_F \\beta f(d(x, \\text{center}))\n1121: $$\n1122: \n1123: For $\\epsilon_F$ small (weak adaptive force), the confining term dominates:\n1124: $$\n1125: U_{\\text{eff}}(x) \\approx \\frac{\\kappa_{\\text{conf}}}{2}\\|x\\|^2 \\quad \\text{(quadratic)}\n1126: $$\n1127: \n1128: **Step 5: QSD formula**\n1129: \n1130: $$\n1131: \\rho_{\\text{QSD}}(x) \\approx \\text{const} \\cdot \\exp\\left(-\\frac{\\kappa_{\\text{conf}}\\|x\\|^2}{2T}\\right)\n1132: $$\n1133: \n1134: **This is a Gaussian distribution**, which is the canonical example of a log-concave probability measure.\n1135: \n1136: **Step 6: Perturbation argument**\n1137: \n1138: The small corrections from non-zero $\\epsilon_F$ are **smooth perturbations** of the Gaussian. By continuity of log-concavity under small perturbations in the supremum norm:\n1139: $$\n1140: \\|\\rho_{\\text{pert}} - \\rho_{\\text{Gaussian}}\\|_{\\infty} = O(\\epsilon_F) \\implies \\rho_{\\text{pert}} \\text{ is log-concave}\n1141: $$",
      "metadata": {
        "label": "lem-log-concave-yang-mills"
      },
      "section": "## 3.5. Fundamental Axiom: Log-Concavity of the Quasi-Stationary Distribution (SUPERSEDED - Now Proven)",
      "raw_directive": "1073: ### Verification for Specific Physical Systems\n1074: \n1075: :::{prf:lemma} Log-Concavity for Pure Yang-Mills Vacuum\n1076: :label: lem-log-concave-yang-mills\n1077: \n1078: For the Yang-Mills vacuum state, the log-concavity condition {prf:ref}`def-log-concavity-condition` is **satisfied**.\n1079: \n1080: **Proof:**\n1081: \n1082: **Step 1: Simplify the system**\n1083: \n1084: For the Yang-Mills vacuum:\n1085: - **Uniform reward**: $r(x) = r_0 = \\text{constant}$ (no preferred field configuration in vacuum)\n1086: - **Quadratic confinement**: $U(x) = \\frac{\\kappa_{\\text{conf}}}{2}\\|x\\|^2$ (harmonic confining potential)\n1087: \n1088: **Step 2: Analyze fitness potential**\n1089: \n1090: With uniform reward, the fitness potential simplifies dramatically:\n1091: $$\n1092: V_{\\text{fit}}(x) = \\text{Rescale}(Z_r(x)) + \\beta \\cdot \\text{Rescale}(Z_d(x))\n1093: $$\n1094: \n1095: where $Z_r(x) = 0$ (no reward gradient) and $Z_d(x)$ is the diversity Z-score (distance to companions).\n1096: \n1097: For uniform reward:\n1098: $$\n1099: V_{\\text{fit}}(x) \\approx \\beta \\cdot f(d(x, \\text{swarm center}))\n1100: $$\n1101: \n1102: where $f$ is a smooth, slowly-varying function.\n1103: \n1104: **Step 3: Compute emergent metric**\n1105: \n1106: $$\n1107: H(x) = \\nabla^2 V_{\\text{fit}}(x) \\approx \\beta \\cdot \\nabla^2 f\n1108: $$\n1109: \n1110: For a smooth diversity term, $\\|\\nabla^2 f\\| = O(1)$ is bounded. With regularization:\n1111: $$\n1112: g(x) = H(x) + \\epsilon_\\Sigma I \\approx \\beta \\cdot O(1) + \\epsilon_\\Sigma I \\approx \\text{const} \\cdot I\n1113: $$\n1114: \n1115: **The metric is approximately flat**: $g(x) \\approx c I$ for some constant $c > 0$.\n1116: \n1117: **Step 4: Analyze effective potential**\n1118: \n1119: $$\n1120: U_{\\text{eff}}(x) = U(x) - \\epsilon_F V_{\\text{fit}}(x) = \\frac{\\kappa_{\\text{conf}}}{2}\\|x\\|^2 - \\epsilon_F \\beta f(d(x, \\text{center}))\n1121: $$\n1122: \n1123: For $\\epsilon_F$ small (weak adaptive force), the confining term dominates:\n1124: $$\n1125: U_{\\text{eff}}(x) \\approx \\frac{\\kappa_{\\text{conf}}}{2}\\|x\\|^2 \\quad \\text{(quadratic)}\n1126: $$\n1127: \n1128: **Step 5: QSD formula**\n1129: \n1130: $$\n1131: \\rho_{\\text{QSD}}(x) \\approx \\text{const} \\cdot \\exp\\left(-\\frac{\\kappa_{\\text{conf}}\\|x\\|^2}{2T}\\right)\n1132: $$\n1133: \n1134: **This is a Gaussian distribution**, which is the canonical example of a log-concave probability measure.\n1135: \n1136: **Step 6: Perturbation argument**\n1137: \n1138: The small corrections from non-zero $\\epsilon_F$ are **smooth perturbations** of the Gaussian. By continuity of log-concavity under small perturbations in the supremum norm:\n1139: $$\n1140: \\|\\rho_{\\text{pert}} - \\rho_{\\text{Gaussian}}\\|_{\\infty} = O(\\epsilon_F) \\implies \\rho_{\\text{pert}} \\text{ is log-concave}\n1141: $$\n1142: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 3.5. Fundamental Axiom: Log-Concavity of the Quasi-Stationary Distribution (SUPERSEDED - Now Proven)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cloning-conditional-independence",
      "title": "Conditional Independence of Cloning",
      "start_line": 1196,
      "end_line": 1206,
      "header_lines": [
        1197
      ],
      "content_start": 1199,
      "content_end": 1205,
      "content": "1199: :label: lem-cloning-conditional-independence\n1200: \n1201: Conditioned on the alive set $\\mathcal{A}(S)$ and the virtual rewards $\\{r_i^{\\text{virt}}\\}_{i \\in \\mathcal{A}}$, the cloning operator acts **independently** on each dead walker:\n1202: \n1203: $$\n1204: \\Psi_{\\text{clone}}(S) | \\mathcal{A}, \\{r_i^{\\text{virt}}\\} = \\prod_{i \\in \\mathcal{D}} K_i^{\\text{clone}}(w_i | \\mathcal{A}, \\{r_j^{\\text{virt}}\\}_{j \\in \\mathcal{A}})\n1205: $$",
      "metadata": {
        "label": "lem-cloning-conditional-independence"
      },
      "section": "## 4. The Cloning Operator and Entropy Contraction via Optimal Transport",
      "raw_directive": "1196: The key structural property is:\n1197: \n1198: :::{prf:lemma} Conditional Independence of Cloning\n1199: :label: lem-cloning-conditional-independence\n1200: \n1201: Conditioned on the alive set $\\mathcal{A}(S)$ and the virtual rewards $\\{r_i^{\\text{virt}}\\}_{i \\in \\mathcal{A}}$, the cloning operator acts **independently** on each dead walker:\n1202: \n1203: $$\n1204: \\Psi_{\\text{clone}}(S) | \\mathcal{A}, \\{r_i^{\\text{virt}}\\} = \\prod_{i \\in \\mathcal{D}} K_i^{\\text{clone}}(w_i | \\mathcal{A}, \\{r_j^{\\text{virt}}\\}_{j \\in \\mathcal{A}})\n1205: $$\n1206: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 4. The Cloning Operator and Entropy Contraction via Optimal Transport"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cloning-wasserstein-contraction",
      "title": "Wasserstein-2 Contraction for Cloning",
      "start_line": 1242,
      "end_line": 1252,
      "header_lines": [
        1243
      ],
      "content_start": 1245,
      "content_end": 1251,
      "content": "1245: :label: lem-cloning-wasserstein-contraction\n1246: \n1247: The cloning operator with Gaussian noise contracts the 2-Wasserstein distance. Specifically, for two swarm states $S_1, S_2$:\n1248: \n1249: $$\n1250: \\mathbb{E}[W_2^2(\\mu_{S_1'}, \\mu_{S_2'})] \\le (1 - \\kappa_W) W_2^2(\\mu_{S_1}, \\mu_{S_2}) + C_W\n1251: $$",
      "metadata": {
        "label": "lem-cloning-wasserstein-contraction"
      },
      "section": "## 4. The Cloning Operator and Entropy Contraction via Optimal Transport",
      "raw_directive": "1242: ### 4.3. Wasserstein Contraction of the Cloning Operator\n1243: \n1244: :::{prf:lemma} Wasserstein-2 Contraction for Cloning\n1245: :label: lem-cloning-wasserstein-contraction\n1246: \n1247: The cloning operator with Gaussian noise contracts the 2-Wasserstein distance. Specifically, for two swarm states $S_1, S_2$:\n1248: \n1249: $$\n1250: \\mathbb{E}[W_2^2(\\mu_{S_1'}, \\mu_{S_2'})] \\le (1 - \\kappa_W) W_2^2(\\mu_{S_1}, \\mu_{S_2}) + C_W\n1251: $$\n1252: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 4. The Cloning Operator and Entropy Contraction via Optimal Transport"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cloning-fisher-info",
      "title": "Fisher Information Bound After Cloning",
      "start_line": 1279,
      "end_line": 1289,
      "header_lines": [
        1280
      ],
      "content_start": 1282,
      "content_end": 1288,
      "content": "1282: :label: lem-cloning-fisher-info\n1283: \n1284: For the cloning operator with Gaussian noise parameter $\\delta > 0$, the Fisher information after one cloning step is bounded:\n1285: \n1286: $$\n1287: I(\\mu_{S'} | \\pi) \\le \\frac{C_I}{\\delta^2}\n1288: $$",
      "metadata": {
        "label": "lem-cloning-fisher-info"
      },
      "section": "## 4. The Cloning Operator and Entropy Contraction via Optimal Transport",
      "raw_directive": "1279: ### 4.4. Fisher Information Control via Gaussian Smoothing\n1280: \n1281: :::{prf:lemma} Fisher Information Bound After Cloning\n1282: :label: lem-cloning-fisher-info\n1283: \n1284: For the cloning operator with Gaussian noise parameter $\\delta > 0$, the Fisher information after one cloning step is bounded:\n1285: \n1286: $$\n1287: I(\\mu_{S'} | \\pi) \\le \\frac{C_I}{\\delta^2}\n1288: $$\n1289: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 4. The Cloning Operator and Entropy Contraction via Optimal Transport"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-entropy-transport-dissipation",
      "title": "Entropy-Transport Dissipation Inequality",
      "start_line": 1449,
      "end_line": 1459,
      "header_lines": [
        1450
      ],
      "content_start": 1452,
      "content_end": 1458,
      "content": "1452: :label: lem-entropy-transport-dissipation\n1453: \n1454: For the cloning operator $\\Psi_{\\text{clone}}$ with parameters satisfying the Keystone Principle (Theorem 8.1 in [03_cloning](03_cloning)), there exists $\\alpha > 0$ such that:\n1455: \n1456: $$\n1457: D_{\\text{KL}}(\\mu' \\| \\pi) \\le D_{\\text{KL}}(\\mu \\| \\pi) - \\alpha \\cdot W_2^2(\\mu, \\pi) + C_{\\text{clone}}\n1458: $$",
      "metadata": {
        "label": "lem-entropy-transport-dissipation"
      },
      "section": "## 5. The Composition Theorem: Entropy-Transport Lyapunov Function",
      "raw_directive": "1449: The crucial technical result is that cloning dissipates entropy proportional to the Wasserstein distance squared:\n1450: \n1451: :::{prf:lemma} Entropy-Transport Dissipation Inequality\n1452: :label: lem-entropy-transport-dissipation\n1453: \n1454: For the cloning operator $\\Psi_{\\text{clone}}$ with parameters satisfying the Keystone Principle (Theorem 8.1 in [03_cloning](03_cloning)), there exists $\\alpha > 0$ such that:\n1455: \n1456: $$\n1457: D_{\\text{KL}}(\\mu' \\| \\pi) \\le D_{\\text{KL}}(\\mu \\| \\pi) - \\alpha \\cdot W_2^2(\\mu, \\pi) + C_{\\text{clone}}\n1458: $$\n1459: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 10,
        "chapter_file": "chapter_10.json",
        "section_id": "## 5. The Composition Theorem: Entropy-Transport Lyapunov Function"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-kinetic-evolution-bounds",
      "title": "Kinetic Evolution Bounds",
      "start_line": 1581,
      "end_line": 1601,
      "header_lines": [
        1582
      ],
      "content_start": 1584,
      "content_end": 1600,
      "content": "1584: :label: lem-kinetic-evolution-bounds\n1585: \n1586: For the kinetic operator $\\Psi_{\\text{kin}}(\\tau)$ from Theorem {prf:ref}`thm-kinetic-lsi`, we have:\n1587: \n1588: **Entropy contraction:**\n1589: \n1590: $$\n1591: D_{\\text{KL}}(\\mu'' \\| \\pi) \\le e^{-\\rho_k} D_{\\text{KL}}(\\mu' \\| \\pi)\n1592: $$\n1593: \n1594: where $\\rho_k = \\alpha\\tau/C_0$ with $\\alpha = \\min(\\gamma/2, \\kappa_{\\text{conf}}/4)$ and $C_0 = O(1/\\min(\\gamma, \\kappa_{\\text{conf}}))$.\n1595: \n1596: **Wasserstein expansion bound:**\n1597: \n1598: $$\n1599: W_2^2(\\mu'', \\pi) \\le (1 + \\beta) W_2^2(\\mu', \\pi)\n1600: $$",
      "metadata": {
        "label": "lem-kinetic-evolution-bounds"
      },
      "section": "## 5. The Composition Theorem: Entropy-Transport Lyapunov Function",
      "raw_directive": "1581: ### 5.3. Evolution of the Kinetic Operator on Entropy and Transport\n1582: \n1583: :::{prf:lemma} Kinetic Evolution Bounds\n1584: :label: lem-kinetic-evolution-bounds\n1585: \n1586: For the kinetic operator $\\Psi_{\\text{kin}}(\\tau)$ from Theorem {prf:ref}`thm-kinetic-lsi`, we have:\n1587: \n1588: **Entropy contraction:**\n1589: \n1590: $$\n1591: D_{\\text{KL}}(\\mu'' \\| \\pi) \\le e^{-\\rho_k} D_{\\text{KL}}(\\mu' \\| \\pi)\n1592: $$\n1593: \n1594: where $\\rho_k = \\alpha\\tau/C_0$ with $\\alpha = \\min(\\gamma/2, \\kappa_{\\text{conf}}/4)$ and $C_0 = O(1/\\min(\\gamma, \\kappa_{\\text{conf}}))$.\n1595: \n1596: **Wasserstein expansion bound:**\n1597: \n1598: $$\n1599: W_2^2(\\mu'', \\pi) \\le (1 + \\beta) W_2^2(\\mu', \\pi)\n1600: $$\n1601: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 10,
        "chapter_file": "chapter_10.json",
        "section_id": "## 5. The Composition Theorem: Entropy-Transport Lyapunov Function"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mean-field-cloning-sketch",
      "title": "Entropy Dissipation Under Cloning (Mean-Field Sketch)",
      "start_line": 2312,
      "end_line": 2348,
      "header_lines": [
        2313
      ],
      "content_start": 2315,
      "content_end": 2347,
      "content": "2315: :label: lem-mean-field-cloning-sketch\n2316: \n2317: **Hypotheses:**\n2318: \n2319: 1. $\\mu, \\pi$ are probability measures on $\\Omega = X_{\\text{valid}} \\times V_{\\text{alg}} \\subset \\mathbb{R}^{2d}$ with smooth densities:\n2320:    - $\\rho_\\mu, \\rho_\\pi \\in C^2(\\Omega)$\n2321:    - $\\rho_\\mu, \\rho_\\pi > 0$ on $\\Omega$ (strictly positive)\n2322: \n2323: 2. $\\pi = \\pi_{\\text{QSD}}$ is log-concave (Axiom 3.5):\n2324:    $$\\rho_\\pi(z) = \\exp(-V_{\\text{QSD}}(z))$$\n2325:    for convex $V_{\\text{QSD}}$\n2326: \n2327: 3. $T_{\\text{clone}}: \\mathcal{P}(\\Omega) \\to \\mathcal{P}(\\Omega)$ is the mean-field cloning operator with:\n2328:    - Generator: $S[\\rho] = S_{\\text{src}}[\\rho] - S_{\\text{sink}}[\\rho]$\n2329:    - Post-cloning noise variance: $\\delta^2$\n2330:    - Cloning probability: $P_{\\text{clone}}(V_i, V_j) = \\min(1, V_j/V_i) \\cdot \\lambda_{\\text{clone}}$\n2331: \n2332: 4. **Fitness-QSD Anti-Correlation**:\n2333:    $$\\log V[z] = -\\lambda_{\\text{corr}} V_{\\text{QSD}}(z) + \\log V_0$$\n2334:    for $\\lambda_{\\text{corr}} > 0$\n2335: \n2336: 5. **Regularity bounds**:\n2337:    - $0 < \\rho_{\\min} \\leq \\rho_\\mu(z) \\leq \\rho_{\\max} < \\infty$\n2338:    - $0 < V_{\\min} \\leq V[z] \\leq V_{\\max} < \\infty$\n2339: \n2340: **Conclusion (Conjectured):**\n2341: \n2342: For $\\mu' = T_{\\text{clone}} \\# \\mu$ with infinitesimal time step $\\tau$:\n2343: \n2344: $$\n2345: D_{\\text{KL}}(\\mu' \\| \\pi) - D_{\\text{KL}}(\\mu \\| \\pi) \\leq -\\tau \\beta \\, D_{\\text{KL}}(\\mu \\| \\pi) + C_{\\text{ent}} + O(\\tau^2)\n2346: $$\n2347: ",
      "metadata": {
        "label": "lem-mean-field-cloning-sketch"
      },
      "section": "## Lemma Statement",
      "raw_directive": "2312: ## Lemma Statement\n2313: \n2314: :::{prf:lemma} Entropy Dissipation Under Cloning (Mean-Field Sketch)\n2315: :label: lem-mean-field-cloning-sketch\n2316: \n2317: **Hypotheses:**\n2318: \n2319: 1. $\\mu, \\pi$ are probability measures on $\\Omega = X_{\\text{valid}} \\times V_{\\text{alg}} \\subset \\mathbb{R}^{2d}$ with smooth densities:\n2320:    - $\\rho_\\mu, \\rho_\\pi \\in C^2(\\Omega)$\n2321:    - $\\rho_\\mu, \\rho_\\pi > 0$ on $\\Omega$ (strictly positive)\n2322: \n2323: 2. $\\pi = \\pi_{\\text{QSD}}$ is log-concave (Axiom 3.5):\n2324:    $$\\rho_\\pi(z) = \\exp(-V_{\\text{QSD}}(z))$$\n2325:    for convex $V_{\\text{QSD}}$\n2326: \n2327: 3. $T_{\\text{clone}}: \\mathcal{P}(\\Omega) \\to \\mathcal{P}(\\Omega)$ is the mean-field cloning operator with:\n2328:    - Generator: $S[\\rho] = S_{\\text{src}}[\\rho] - S_{\\text{sink}}[\\rho]$\n2329:    - Post-cloning noise variance: $\\delta^2$\n2330:    - Cloning probability: $P_{\\text{clone}}(V_i, V_j) = \\min(1, V_j/V_i) \\cdot \\lambda_{\\text{clone}}$\n2331: \n2332: 4. **Fitness-QSD Anti-Correlation**:\n2333:    $$\\log V[z] = -\\lambda_{\\text{corr}} V_{\\text{QSD}}(z) + \\log V_0$$\n2334:    for $\\lambda_{\\text{corr}} > 0$\n2335: \n2336: 5. **Regularity bounds**:\n2337:    - $0 < \\rho_{\\min} \\leq \\rho_\\mu(z) \\leq \\rho_{\\max} < \\infty$\n2338:    - $0 < V_{\\min} \\leq V[z] \\leq V_{\\max} < \\infty$\n2339: \n2340: **Conclusion (Conjectured):**\n2341: \n2342: For $\\mu' = T_{\\text{clone}} \\# \\mu$ with infinitesimal time step $\\tau$:\n2343: \n2344: $$\n2345: D_{\\text{KL}}(\\mu' \\| \\pi) - D_{\\text{KL}}(\\mu \\| \\pi) \\leq -\\tau \\beta \\, D_{\\text{KL}}(\\mu \\| \\pi) + C_{\\text{ent}} + O(\\tau^2)\n2346: $$\n2347: \n2348: where $\\beta > 0$ (contraction rate) and $C_{\\text{ent}} < 0$ (favorable entropy term) depend on the parameters.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 21,
        "chapter_file": "chapter_21.json",
        "section_id": "## Lemma Statement"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sinh-bound-global",
      "title": "Sinh Inequality",
      "start_line": 2494,
      "end_line": 2504,
      "header_lines": [
        2495
      ],
      "content_start": 2497,
      "content_end": 2503,
      "content": "2497: :label: lem-sinh-bound-global\n2498: \n2499: For all $z \\in \\mathbb{R}$:\n2500: \n2501: $$\n2502: \\frac{\\sinh(z)}{z} \\geq 1\n2503: $$",
      "metadata": {
        "label": "lem-sinh-bound-global"
      },
      "section": "## Proof Sketch",
      "raw_directive": "2494: **Apply the global sinh inequality**:\n2495: \n2496: :::{prf:lemma} Sinh Inequality\n2497: :label: lem-sinh-bound-global\n2498: \n2499: For all $z \\in \\mathbb{R}$:\n2500: \n2501: $$\n2502: \\frac{\\sinh(z)}{z} \\geq 1\n2503: $$\n2504: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 22,
        "chapter_file": "chapter_22.json",
        "section_id": "## Proof Sketch"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-meanfield-cloning-dissipation-hybrid",
      "title": "Mean-Field Cloning Entropy Dissipation",
      "start_line": 3887,
      "end_line": 3917,
      "header_lines": [
        3888
      ],
      "content_start": 3890,
      "content_end": 3916,
      "content": "3890: :label: lem-meanfield-cloning-dissipation-hybrid\n3891: \n3892: **Hypotheses**:\n3893: \n3894: 1. $\\mu, \\pi$ are probability measures on $\\Omega \\subset \\mathbb{R}^{2d}$ with smooth densities $\\rho_\\mu, \\rho_\\pi \\in C^2(\\Omega)$\n3895: 2. $\\pi = \\pi_{\\text{QSD}}$ is log-concave: $\\rho_\\pi = e^{-V_{\\text{QSD}}}$ for convex $V_{\\text{QSD}}$\n3896: 3. $T_{\\text{clone}}: \\mathcal{P}(\\Omega) \\to \\mathcal{P}(\\Omega)$ is the mean-field cloning operator\n3897: 4. Fitness-QSD anti-correlation: $\\log V[z] = -\\lambda_{\\text{corr}} V_{\\text{QSD}}(z) + \\log V_0$ with $\\lambda_{\\text{corr}} > 0$\n3898: 5. Regularity: $0 < \\rho_{\\min} \\leq \\rho_\\mu \\leq \\rho_{\\max} < \\infty$ and $0 < V_{\\min} \\leq V[z] \\leq V_{\\max} < \\infty$\n3899: 6. Noise regime: $\\delta^2 > \\delta_{\\min}^2$\n3900: \n3901: **Conclusion**:\n3902: \n3903: For $\\mu' = T_{\\text{clone}} \\# \\mu$ with infinitesimal time step $\\tau$:\n3904: \n3905: $$\n3906: D_{\\text{KL}}(\\mu' \\| \\pi) \\leq (1 - \\tau \\beta_{\\text{clone}}) D_{\\text{KL}}(\\mu \\| \\pi) + C_{\\text{ent}} + O(e^{-\\kappa \\delta^2}) + O(\\tau^2)\n3907: $$\n3908: \n3909: where:\n3910: $$\n3911: \\beta_{\\text{clone}} := \\frac{\\lambda_{\\text{clone}}}{m_a} \\lambda_{\\text{corr}} \\lambda_{\\text{Poin}} (1 - \\epsilon_{\\text{ratio}}) > 0\n3912: $$\n3913: \n3914: and:\n3915: $$\n3916: C_{\\text{ent}} := \\tau \\lambda_{\\text{clone}} \\left[\\log\\left(\\frac{\\rho_{\\max}}{\\rho_{\\min}}\\right) - \\frac{d}{2} \\log(2\\pi e \\delta^2)\\right] < 0",
      "metadata": {
        "label": "lem-meanfield-cloning-dissipation-hybrid"
      },
      "section": "## Step 2: Cloning Operator Contraction (Mean-Field Proof)",
      "raw_directive": "3887: This is the **new contribution** of the mean-field approach. We prove:\n3888: \n3889: :::{prf:lemma} Mean-Field Cloning Entropy Dissipation\n3890: :label: lem-meanfield-cloning-dissipation-hybrid\n3891: \n3892: **Hypotheses**:\n3893: \n3894: 1. $\\mu, \\pi$ are probability measures on $\\Omega \\subset \\mathbb{R}^{2d}$ with smooth densities $\\rho_\\mu, \\rho_\\pi \\in C^2(\\Omega)$\n3895: 2. $\\pi = \\pi_{\\text{QSD}}$ is log-concave: $\\rho_\\pi = e^{-V_{\\text{QSD}}}$ for convex $V_{\\text{QSD}}$\n3896: 3. $T_{\\text{clone}}: \\mathcal{P}(\\Omega) \\to \\mathcal{P}(\\Omega)$ is the mean-field cloning operator\n3897: 4. Fitness-QSD anti-correlation: $\\log V[z] = -\\lambda_{\\text{corr}} V_{\\text{QSD}}(z) + \\log V_0$ with $\\lambda_{\\text{corr}} > 0$\n3898: 5. Regularity: $0 < \\rho_{\\min} \\leq \\rho_\\mu \\leq \\rho_{\\max} < \\infty$ and $0 < V_{\\min} \\leq V[z] \\leq V_{\\max} < \\infty$\n3899: 6. Noise regime: $\\delta^2 > \\delta_{\\min}^2$\n3900: \n3901: **Conclusion**:\n3902: \n3903: For $\\mu' = T_{\\text{clone}} \\# \\mu$ with infinitesimal time step $\\tau$:\n3904: \n3905: $$\n3906: D_{\\text{KL}}(\\mu' \\| \\pi) \\leq (1 - \\tau \\beta_{\\text{clone}}) D_{\\text{KL}}(\\mu \\| \\pi) + C_{\\text{ent}} + O(e^{-\\kappa \\delta^2}) + O(\\tau^2)\n3907: $$\n3908: \n3909: where:\n3910: $$\n3911: \\beta_{\\text{clone}} := \\frac{\\lambda_{\\text{clone}}}{m_a} \\lambda_{\\text{corr}} \\lambda_{\\text{Poin}} (1 - \\epsilon_{\\text{ratio}}) > 0\n3912: $$\n3913: \n3914: and:\n3915: $$\n3916: C_{\\text{ent}} := \\tau \\lambda_{\\text{clone}} \\left[\\log\\left(\\frac{\\rho_{\\max}}{\\rho_{\\min}}\\right) - \\frac{d}{2} \\log(2\\pi e \\delta^2)\\right] < 0\n3917: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 63,
        "chapter_file": "chapter_63.json",
        "section_id": "## Step 2: Cloning Operator Contraction (Mean-Field Proof)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-cloning-contraction-standalone",
      "title": "Mean-Field Cloning Contraction",
      "start_line": 4531,
      "end_line": 4552,
      "header_lines": [
        4532
      ],
      "content_start": 4534,
      "content_end": 4551,
      "content": "4534: :label: lem-cloning-contraction-standalone\n4535: \n4536: Under Hypotheses 1-4, for infinitesimal time step $\\tau$:\n4537: \n4538: $$\n4539: D_{\\text{KL}}(\\mu' \\| \\pi) \\leq (1 - \\tau \\beta_{\\text{clone}}) D_{\\text{KL}}(\\mu \\| \\pi) + C_{\\text{ent}} + O(e^{-\\kappa \\delta^2}) + O(\\tau^2)\n4540: $$\n4541: \n4542: where:\n4543: $$\n4544: \\beta_{\\text{clone}} = \\frac{\\lambda_{\\text{clone}}}{m_a} \\lambda_{\\text{corr}} \\lambda_{\\text{Poin}} (1 - \\epsilon_{\\text{ratio}})\n4545: $$\n4546: \n4547: and:\n4548: $$\n4549: C_{\\text{ent}} = \\tau \\lambda_{\\text{clone}} \\left[\\log\\left(\\frac{\\rho_{\\max}}{\\rho_{\\min}}\\right) - \\frac{d}{2} \\log(2\\pi e \\delta^2)\\right] < 0\n4550: $$\n4551: ",
      "metadata": {
        "label": "lem-cloning-contraction-standalone"
      },
      "section": "## Section 2: Cloning Operator LSI (Mean-Field Generator Analysis)",
      "raw_directive": "4531: ### 2.3. Main Lemma\n4532: \n4533: :::{prf:lemma} Mean-Field Cloning Contraction\n4534: :label: lem-cloning-contraction-standalone\n4535: \n4536: Under Hypotheses 1-4, for infinitesimal time step $\\tau$:\n4537: \n4538: $$\n4539: D_{\\text{KL}}(\\mu' \\| \\pi) \\leq (1 - \\tau \\beta_{\\text{clone}}) D_{\\text{KL}}(\\mu \\| \\pi) + C_{\\text{ent}} + O(e^{-\\kappa \\delta^2}) + O(\\tau^2)\n4540: $$\n4541: \n4542: where:\n4543: $$\n4544: \\beta_{\\text{clone}} = \\frac{\\lambda_{\\text{clone}}}{m_a} \\lambda_{\\text{corr}} \\lambda_{\\text{Poin}} (1 - \\epsilon_{\\text{ratio}})\n4545: $$\n4546: \n4547: and:\n4548: $$\n4549: C_{\\text{ent}} = \\tau \\lambda_{\\text{clone}} \\left[\\log\\left(\\frac{\\rho_{\\max}}{\\rho_{\\min}}\\right) - \\frac{d}{2} \\log(2\\pi e \\delta^2)\\right] < 0\n4550: $$\n4551: \n4552: for $\\delta^2 > \\delta_{\\min}^2$.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 75,
        "chapter_file": "chapter_75.json",
        "section_id": "## Section 2: Cloning Operator LSI (Mean-Field Generator Analysis)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-kinetic-lsi-hypocoercive",
      "title": "Hypocoercive LSI for Discrete-Time Kinetic Operator",
      "start_line": 5697,
      "end_line": 5719,
      "header_lines": [
        5698
      ],
      "content_start": 5700,
      "content_end": 5718,
      "content": "5700: :label: lem-kinetic-lsi-hypocoercive\n5701: \n5702: For the BAOAB integrator with time step $\\tau$ and confining potential $U$ (Axiom {prf:ref}`axiom-confining-complete`), **without requiring convexity**:\n5703: \n5704: $$\n5705: D_{\\text{KL}}(\\mu_{t+\\tau} \\| \\pi_{\\text{kin}}) \\leq (1 - \\tau \\lambda_{\\text{hypo}}) D_{\\text{KL}}(\\mu_t \\| \\pi_{\\text{kin}}) + O(\\tau^2)\n5706: $$\n5707: \n5708: where:\n5709: \n5710: $$\n5711: \\lambda_{\\text{hypo}} = c \\cdot \\min\\left(\\gamma, \\frac{\\alpha_U}{\\sigma_v^2}\\right)\n5712: $$\n5713: \n5714: where $c > 0$ is a universal constant (for BAOAB integrator, $c \\approx 1/4$).\n5715: \n5716: Equivalently, the kinetic operator satisfies a discrete-time LSI with constant:\n5717: \n5718: $$",
      "metadata": {
        "label": "lem-kinetic-lsi-hypocoercive"
      },
      "section": "## Part 2: Approach 1 - Hypocoercivity for Non-Convex Kinetic Systems",
      "raw_directive": "5697: From Section 1.7.3 of [06_convergence](06_convergence), the discrete-time weak error analysis gives:\n5698: \n5699: :::{prf:lemma} Hypocoercive LSI for Discrete-Time Kinetic Operator\n5700: :label: lem-kinetic-lsi-hypocoercive\n5701: \n5702: For the BAOAB integrator with time step $\\tau$ and confining potential $U$ (Axiom {prf:ref}`axiom-confining-complete`), **without requiring convexity**:\n5703: \n5704: $$\n5705: D_{\\text{KL}}(\\mu_{t+\\tau} \\| \\pi_{\\text{kin}}) \\leq (1 - \\tau \\lambda_{\\text{hypo}}) D_{\\text{KL}}(\\mu_t \\| \\pi_{\\text{kin}}) + O(\\tau^2)\n5706: $$\n5707: \n5708: where:\n5709: \n5710: $$\n5711: \\lambda_{\\text{hypo}} = c \\cdot \\min\\left(\\gamma, \\frac{\\alpha_U}{\\sigma_v^2}\\right)\n5712: $$\n5713: \n5714: where $c > 0$ is a universal constant (for BAOAB integrator, $c \\approx 1/4$).\n5715: \n5716: Equivalently, the kinetic operator satisfies a discrete-time LSI with constant:\n5717: \n5718: $$\n5719: C_{\\text{LSI}}^{\\text{kin}}(\\tau) = \\frac{1 - e^{-2\\lambda_{\\text{hypo}} \\tau}}{2\\lambda_{\\text{hypo}}} + O(\\tau^2)",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 84,
        "chapter_file": "chapter_84.json",
        "section_id": "## Part 2: Approach 1 - Hypocoercivity for Non-Convex Kinetic Systems"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-softmax-lipschitz-status",
      "title": "Lipschitz Continuity of Softmax-Weighted Companion Selection",
      "start_line": 5942,
      "end_line": 5954,
      "header_lines": [
        5943
      ],
      "content_start": 5945,
      "content_end": 5953,
      "content": "5945: :label: lem-softmax-lipschitz-status\n5946: \n5947: Let $\\mathcal{S}_1, \\mathcal{S}_2$ be two swarms with $d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) = n_c$ status changes. For a walker $i$ alive in both swarms, let $\\text{Comp}_i^{(1)}, \\text{Comp}_i^{(2)}$ be the probability distributions over companions selected by the Sequential Stochastic Greedy Pairing algorithm in each swarm.\n5948: \n5949: For any bounded function $f: \\mathcal{X} \\times \\mathcal{V} \\to \\mathbb{R}$ with $|f| \\leq M_f$, the expected value under the softmax-weighted companion selection satisfies:\n5950: \n5951: $$\n5952: |\\mathbb{E}_{j \\sim \\text{Comp}_i^{(1)}}[f(x_j, v_j)] - \\mathbb{E}_{j \\sim \\text{Comp}_i^{(2)}}[f(x_j, v_j)]| \\leq C_{\\text{softmax}} \\cdot \\frac{M_f \\cdot n_c}{k}\n5953: $$",
      "metadata": {
        "label": "lem-softmax-lipschitz-status"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "raw_directive": "5942: The framework's Theorem {prf:ref}`thm-total-error-status-bound` in [01_fragile_gas_framework](../01_fragile_gas_framework.md) proves Lipschitz continuity for **uniform random companion selection**. However, the greedy pairing uses **softmax-weighted selection** based on algorithmic distance, so we must extend the proof to this case.\n5943: \n5944: :::{prf:lemma} Lipschitz Continuity of Softmax-Weighted Companion Selection\n5945: :label: lem-softmax-lipschitz-status\n5946: \n5947: Let $\\mathcal{S}_1, \\mathcal{S}_2$ be two swarms with $d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) = n_c$ status changes. For a walker $i$ alive in both swarms, let $\\text{Comp}_i^{(1)}, \\text{Comp}_i^{(2)}$ be the probability distributions over companions selected by the Sequential Stochastic Greedy Pairing algorithm in each swarm.\n5948: \n5949: For any bounded function $f: \\mathcal{X} \\times \\mathcal{V} \\to \\mathbb{R}$ with $|f| \\leq M_f$, the expected value under the softmax-weighted companion selection satisfies:\n5950: \n5951: $$\n5952: |\\mathbb{E}_{j \\sim \\text{Comp}_i^{(1)}}[f(x_j, v_j)] - \\mathbb{E}_{j \\sim \\text{Comp}_i^{(2)}}[f(x_j, v_j)]| \\leq C_{\\text{softmax}} \\cdot \\frac{M_f \\cdot n_c}{k}\n5953: $$\n5954: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 85,
        "chapter_file": "chapter_85.json",
        "section_id": "## Part 3: Dobrushin Contraction for the Full Dynamics"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-kinetic-lsi-established",
      "title": "Hypocoercive LSI for Ψ_kin (Established)",
      "start_line": 7285,
      "end_line": 7302,
      "header_lines": [
        7286
      ],
      "content_start": 7288,
      "content_end": 7301,
      "content": "7288: :label: lem-kinetic-lsi-established\n7289: \n7290: The kinetic operator $\\Psi_{\\text{kin}}$ (Langevin dynamics) satisfies an LSI **with respect to its own invariant measure** $\\pi_{\\text{kin}}$:\n7291: \n7292: $$\n7293: \\text{Ent}_{\\pi_{\\text{kin}}}(f^2) \\leq C_{\\text{LSI}}^{\\text{kin}} \\cdot \\mathbb{E}_{\\pi_{\\text{kin}}}[|\\nabla f|^2]\n7294: $$\n7295: \n7296: where:\n7297: $$\n7298: C_{\\text{LSI}}^{\\text{kin}} = \\frac{1}{2\\lambda_{\\text{hypo}}}, \\quad \\lambda_{\\text{hypo}} = c \\cdot \\min\\left(\\gamma, \\frac{\\alpha_U}{\\sigma_v^2}\\right)\n7299: $$\n7300: \n7301: **Crucially**: This holds for **non-convex** $U(x)$ via hypocoercivity.",
      "metadata": {
        "label": "lem-kinetic-lsi-established"
      },
      "section": "## 1.2 Hypocoercivity for Kinetic Operator",
      "raw_directive": "7285: From non-convex extensions analysis, Part 2:\n7286: \n7287: :::{prf:lemma} Hypocoercive LSI for Ψ_kin (Established)\n7288: :label: lem-kinetic-lsi-established\n7289: \n7290: The kinetic operator $\\Psi_{\\text{kin}}$ (Langevin dynamics) satisfies an LSI **with respect to its own invariant measure** $\\pi_{\\text{kin}}$:\n7291: \n7292: $$\n7293: \\text{Ent}_{\\pi_{\\text{kin}}}(f^2) \\leq C_{\\text{LSI}}^{\\text{kin}} \\cdot \\mathbb{E}_{\\pi_{\\text{kin}}}[|\\nabla f|^2]\n7294: $$\n7295: \n7296: where:\n7297: $$\n7298: C_{\\text{LSI}}^{\\text{kin}} = \\frac{1}{2\\lambda_{\\text{hypo}}}, \\quad \\lambda_{\\text{hypo}} = c \\cdot \\min\\left(\\gamma, \\frac{\\alpha_U}{\\sigma_v^2}\\right)\n7299: $$\n7300: \n7301: **Crucially**: This holds for **non-convex** $U(x)$ via hypocoercivity.\n7302: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "09_kl_convergence",
        "chapter_index": 101,
        "chapter_file": "chapter_101.json",
        "section_id": "## 1.2 Hypocoercivity for Kinetic Operator"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-conditional-gaussian-qsd-euclidean",
      "title": "Conditional Gaussian Structure (Euclidean Gas)",
      "start_line": 581,
      "end_line": 605,
      "header_lines": [
        582
      ],
      "content_start": 584,
      "content_end": 604,
      "content": "584: :label: lem-conditional-gaussian-qsd-euclidean\n585: \n586: For fixed positions $\\mathbf{x} = (x_1, \\ldots, x_N)$, the conditional velocity distribution in the Euclidean Gas is a product of independent Gaussians:\n587: \n588: $$\n589: \\pi_N(\\mathbf{v} | \\mathbf{x}) = \\prod_{i=1}^N \\mathcal{N}(0, \\Sigma_{v_i})\n590: $$\n591: \n592: where each $\\Sigma_{v_i}$ is the stationary covariance for the individual Langevin dynamics (no coupling between walkers).\n593: \n594: For the Euclidean Gas with constant diffusion $\\sigma I$, the conditional covariance is:\n595: \n596: $$\n597: \\Sigma_{v_i} = \\frac{\\sigma^2}{2\\gamma} I\n598: $$\n599: \n600: **N-uniform eigenvalue bound**:\n601: \n602: $$\n603: \\lambda_{\\max}(\\Sigma_{v_i}) = \\frac{\\sigma^2}{2\\gamma}\n604: $$",
      "metadata": {
        "label": "lem-conditional-gaussian-qsd-euclidean"
      },
      "section": "## A1.3 N-Uniform Log-Sobolev Inequality",
      "raw_directive": "581: **Key technical lemma**:\n582: \n583: :::{prf:lemma} Conditional Gaussian Structure (Euclidean Gas)\n584: :label: lem-conditional-gaussian-qsd-euclidean\n585: \n586: For fixed positions $\\mathbf{x} = (x_1, \\ldots, x_N)$, the conditional velocity distribution in the Euclidean Gas is a product of independent Gaussians:\n587: \n588: $$\n589: \\pi_N(\\mathbf{v} | \\mathbf{x}) = \\prod_{i=1}^N \\mathcal{N}(0, \\Sigma_{v_i})\n590: $$\n591: \n592: where each $\\Sigma_{v_i}$ is the stationary covariance for the individual Langevin dynamics (no coupling between walkers).\n593: \n594: For the Euclidean Gas with constant diffusion $\\sigma I$, the conditional covariance is:\n595: \n596: $$\n597: \\Sigma_{v_i} = \\frac{\\sigma^2}{2\\gamma} I\n598: $$\n599: \n600: **N-uniform eigenvalue bound**:\n601: \n602: $$\n603: \\lambda_{\\max}(\\Sigma_{v_i}) = \\frac{\\sigma^2}{2\\gamma}\n604: $$\n605: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "10_qsd_exchangeability_theory",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## A1.3 N-Uniform Log-Sobolev Inequality"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hessian-bounded",
      "title": "N-Uniform Boundedness of the Pure Hessian",
      "start_line": 700,
      "end_line": 711,
      "header_lines": [
        701
      ],
      "content_start": 703,
      "content_end": 710,
      "content": "703: :label: lem-hessian-bounded\n704: \n705: Under the axiomatic framework of Section 3, the unregularized Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n706: \n707: $$\n708: \\|H(S)\\| \\le H_{\\max}(\\rho) < \\infty\n709: \n710: $$",
      "metadata": {
        "label": "lem-hessian-bounded"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "700: The proof proceeds in three steps: we first establish boundedness of the pure Hessian, then demonstrate why regularization is necessary, and finally prove the main theorem.\n701: \n702: :::{prf:lemma} N-Uniform Boundedness of the Pure Hessian\n703: :label: lem-hessian-bounded\n704: \n705: Under the axiomatic framework of Section 3, the unregularized Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n706: \n707: $$\n708: \\|H(S)\\| \\le H_{\\max}(\\rho) < \\infty\n709: \n710: $$\n711: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Uniform Ellipticity and Well-Posedness"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hessian-bounded-rigorous",
      "title": "Rigorous Boundedness of the Hessian",
      "start_line": 768,
      "end_line": 782,
      "header_lines": [
        769
      ],
      "content_start": 771,
      "content_end": 781,
      "content": "771: :label: lem-hessian-bounded-rigorous\n772: \n773: Under the fitness pipeline construction with regularized Z-score regularization, the Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n774: \n775: $$\n776: \\|H(S)\\| \\le H_{\\max} = \\frac{4 A g'_{\\max}^2 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} + \\frac{A g'_{\\max} \\|\\nabla^2 d\\|_{\\infty}}{\\sigma\\'_{\\min}} + \\frac{4 A g''_{\\max} \\|\\nabla d\\|^4_{\\infty}}{\\sigma'^4_{\\min,\\text{patch}}}\n777: \n778: $$\n779: \n780: for all swarm states $S$, where:\n781: - $\\|\\nabla d\\|_{\\infty}$ and $\\|\\nabla^2 d\\|_{\\infty}$ are uniform bounds on the measurement function derivatives",
      "metadata": {
        "label": "lem-hessian-bounded-rigorous"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "768: :::\n769: \n770: :::{prf:lemma} Rigorous Boundedness of the Hessian\n771: :label: lem-hessian-bounded-rigorous\n772: \n773: Under the fitness pipeline construction with regularized Z-score regularization, the Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n774: \n775: $$\n776: \\|H(S)\\| \\le H_{\\max} = \\frac{4 A g'_{\\max}^2 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} + \\frac{A g'_{\\max} \\|\\nabla^2 d\\|_{\\infty}}{\\sigma\\'_{\\min}} + \\frac{4 A g''_{\\max} \\|\\nabla d\\|^4_{\\infty}}{\\sigma'^4_{\\min,\\text{patch}}}\n777: \n778: $$\n779: \n780: for all swarm states $S$, where:\n781: - $\\|\\nabla d\\|_{\\infty}$ and $\\|\\nabla^2 d\\|_{\\infty}$ are uniform bounds on the measurement function derivatives\n782: - $g'_{\\max}$ and $g''_{\\max}$ are bounds on the rescale function derivatives",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Uniform Ellipticity and Well-Posedness"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hessian-explosion",
      "title": "Failure of Uniformity Without Regularization",
      "start_line": 881,
      "end_line": 892,
      "header_lines": [
        882
      ],
      "content_start": 884,
      "content_end": 891,
      "content": "884: :label: lem-hessian-explosion\n885: \n886: If the regularization $\\epsilon_\\Sigma = 0$ and the swarm variance $\\text{Var}_\\mu[d] \\to 0$, then:\n887: \n888: $$\n889: \\|H(\\mu)\\| \\to \\infty\n890: \n891: $$",
      "metadata": {
        "label": "lem-hessian-explosion"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "881: :::\n882: \n883: :::{prf:lemma} Failure of Uniformity Without Regularization\n884: :label: lem-hessian-explosion\n885: \n886: If the regularization $\\epsilon_\\Sigma = 0$ and the swarm variance $\\text{Var}_\\mu[d] \\to 0$, then:\n887: \n888: $$\n889: \\|H(\\mu)\\| \\to \\infty\n890: \n891: $$\n892: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Uniform Ellipticity and Well-Posedness"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-adaptive-force-bounded",
      "title": "N-Uniform Bounded Perturbation from Adaptive Force",
      "start_line": 1377,
      "end_line": 1388,
      "header_lines": [
        1378
      ],
      "content_start": 1380,
      "content_end": 1387,
      "content": "1380: :label: lem-adaptive-force-bounded\n1381: \n1382: The adaptive force $\\mathbf{F}_{\\text{adapt}} = \\epsilon_F \\nabla V_{\\text{fit}}[f_k, \\rho]$ contributes a bounded perturbation to the drift of $V_{\\text{total}}$. There exists a **ρ-dependent but N-uniform constant** $K_F(\\rho) < \\infty$ such that:\n1383: \n1384: $$\n1385: \\left| \\left\\langle \\nabla V_{\\text{total}}(S), \\, \\mathbf{F}_{\\text{adapt}}(S) \\right\\rangle \\right| \\le \\epsilon_F K_F(\\rho) (V_{\\text{total}}(S) + 1)\n1386: \n1387: $$",
      "metadata": {
        "label": "lem-adaptive-force-bounded"
      },
      "section": "## 6. Boundedness of the Adaptive Perturbations",
      "raw_directive": "1377: ### 6.2. Boundedness of the Adaptive Force Contribution\n1378: \n1379: :::{prf:lemma} N-Uniform Bounded Perturbation from Adaptive Force\n1380: :label: lem-adaptive-force-bounded\n1381: \n1382: The adaptive force $\\mathbf{F}_{\\text{adapt}} = \\epsilon_F \\nabla V_{\\text{fit}}[f_k, \\rho]$ contributes a bounded perturbation to the drift of $V_{\\text{total}}$. There exists a **ρ-dependent but N-uniform constant** $K_F(\\rho) < \\infty$ such that:\n1383: \n1384: $$\n1385: \\left| \\left\\langle \\nabla V_{\\text{total}}(S), \\, \\mathbf{F}_{\\text{adapt}}(S) \\right\\rangle \\right| \\le \\epsilon_F K_F(\\rho) (V_{\\text{total}}(S) + 1)\n1386: \n1387: $$\n1388: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 6. Boundedness of the Adaptive Perturbations"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-viscous-dissipative",
      "title": "Dissipative Contribution from Viscous Force",
      "start_line": 1473,
      "end_line": 1498,
      "header_lines": [
        1474
      ],
      "content_start": 1476,
      "content_end": 1497,
      "content": "1476: :label: lem-viscous-dissipative\n1477: \n1478: The normalized viscous force\n1479: \n1480: $$\n1481: \\mathbf{F}_{\\text{viscous}} = \\nu \\sum_{j \\neq i} \\frac{K(x_i - x_j)}{\\deg(i)} (v_j - v_i)\n1482: \n1483: $$\n1484: \n1485: contributes a **negative** (dissipative) term to the Stratonovich drift of $V_{\\text{Var},v}$:\n1486: \n1487: $$\n1488: A_{\\text{viscous}}(V_{\\text{Var},v}) = -\\nu \\mathcal{D}_{\\text{visc}}(S) \\le 0\n1489: \n1490: $$\n1491: \n1492: where\n1493: \n1494: $$\n1495: \\mathcal{D}_{\\text{visc}}(S) := \\frac{1}{N} \\sum_{i < j} K(x_i - x_j) \\left[ \\frac{1}{\\deg(i)} + \\frac{1}{\\deg(j)} \\right] \\|v_i - v_j\\|^2 \\ge 0\n1496: \n1497: $$",
      "metadata": {
        "label": "lem-viscous-dissipative"
      },
      "section": "## 6. Boundedness of the Adaptive Perturbations",
      "raw_directive": "1473: ### 6.3. Dissipativity of the Viscous Force\n1474: \n1475: :::{prf:lemma} Dissipative Contribution from Viscous Force\n1476: :label: lem-viscous-dissipative\n1477: \n1478: The normalized viscous force\n1479: \n1480: $$\n1481: \\mathbf{F}_{\\text{viscous}} = \\nu \\sum_{j \\neq i} \\frac{K(x_i - x_j)}{\\deg(i)} (v_j - v_i)\n1482: \n1483: $$\n1484: \n1485: contributes a **negative** (dissipative) term to the Stratonovich drift of $V_{\\text{Var},v}$:\n1486: \n1487: $$\n1488: A_{\\text{viscous}}(V_{\\text{Var},v}) = -\\nu \\mathcal{D}_{\\text{visc}}(S) \\le 0\n1489: \n1490: $$\n1491: \n1492: where\n1493: \n1494: $$\n1495: \\mathcal{D}_{\\text{visc}}(S) := \\frac{1}{N} \\sum_{i < j} K(x_i - x_j) \\left[ \\frac{1}{\\deg(i)} + \\frac{1}{\\deg(j)} \\right] \\|v_i - v_j\\|^2 \\ge 0\n1496: \n1497: $$\n1498: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 6. Boundedness of the Adaptive Perturbations"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-diffusion-bounded",
      "title": "Bounded Change from Adaptive Diffusion",
      "start_line": 1562,
      "end_line": 1573,
      "header_lines": [
        1563
      ],
      "content_start": 1565,
      "content_end": 1572,
      "content": "1565: :label: lem-diffusion-bounded\n1566: \n1567: Replacing the constant diffusion $\\sigma I$ with the adaptive diffusion $\\Sigma_{\\text{reg}}(x, S)$ results in a bounded change to the drift. The diffusion contribution $A_{\\text{diff}}(S)$ from Definition [](#def-strat-drift) satisfies:\n1568: \n1569: $$\n1570: |A_{\\text{diff}}(S)| \\le C_{\\text{diff}} < \\infty\n1571: \n1572: $$",
      "metadata": {
        "label": "lem-diffusion-bounded"
      },
      "section": "## 6. Boundedness of the Adaptive Perturbations",
      "raw_directive": "1562: ### 6.4. Boundedness of the Diffusion Perturbation\n1563: \n1564: :::{prf:lemma} Bounded Change from Adaptive Diffusion\n1565: :label: lem-diffusion-bounded\n1566: \n1567: Replacing the constant diffusion $\\sigma I$ with the adaptive diffusion $\\Sigma_{\\text{reg}}(x, S)$ results in a bounded change to the drift. The diffusion contribution $A_{\\text{diff}}(S)$ from Definition [](#def-strat-drift) satisfies:\n1568: \n1569: $$\n1570: |A_{\\text{diff}}(S)| \\le C_{\\text{diff}} < \\infty\n1571: \n1572: $$\n1573: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 6. Boundedness of the Adaptive Perturbations"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-dissipation-decomp",
      "title": "Decomposition of Entropy Dissipation",
      "start_line": 2544,
      "end_line": 2560,
      "header_lines": [
        2545
      ],
      "content_start": 2547,
      "content_end": 2559,
      "content": "2547: :label: lem-dissipation-decomp\n2548: \n2549: The total entropy dissipation can be decomposed as:\n2550: \n2551: $$\n2552: D(f) = D_{\\text{kin}}(f) + D_{\\text{clone}}(f) + D_{\\text{boundary}}(f)\n2553: \n2554: $$\n2555: \n2556: where:\n2557: - $D_{\\text{kin}}(f) = \\int f \\|\\nabla_v \\log(f / \\rho_{\\text{QSD}})\\|^2_{G_{\\text{reg}}} \\, dx \\, dv$ is the kinetic dissipation.\n2558: - $D_{\\text{clone}}(f) \\ge 0$ is the dissipation from the selection/cloning mechanism.\n2559: - $D_{\\text{boundary}}(f) \\ge 0$ is the dissipation from boundary flux.",
      "metadata": {
        "label": "lem-dissipation-decomp"
      },
      "section": "## 9. Main Convergence Theorems and Physical Interpretation",
      "raw_directive": "2544: **Step 1: Decomposition of Entropy Dissipation**\n2545: \n2546: :::{prf:lemma} Decomposition of Entropy Dissipation\n2547: :label: lem-dissipation-decomp\n2548: \n2549: The total entropy dissipation can be decomposed as:\n2550: \n2551: $$\n2552: D(f) = D_{\\text{kin}}(f) + D_{\\text{clone}}(f) + D_{\\text{boundary}}(f)\n2553: \n2554: $$\n2555: \n2556: where:\n2557: - $D_{\\text{kin}}(f) = \\int f \\|\\nabla_v \\log(f / \\rho_{\\text{QSD}})\\|^2_{G_{\\text{reg}}} \\, dx \\, dv$ is the kinetic dissipation.\n2558: - $D_{\\text{clone}}(f) \\ge 0$ is the dissipation from the selection/cloning mechanism.\n2559: - $D_{\\text{boundary}}(f) \\ge 0$ is the dissipation from boundary flux.\n2560: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 9. Main Convergence Theorems and Physical Interpretation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-micro-coercivity",
      "title": "Microscopic Coercivity (Step A)",
      "start_line": 2578,
      "end_line": 2589,
      "header_lines": [
        2579
      ],
      "content_start": 2581,
      "content_end": 2588,
      "content": "2581: :label: lem-micro-coercivity\n2582: \n2583: There exists $\\lambda_{\\text{mic}} > 0$ such that:\n2584: \n2585: $$\n2586: D_{\\text{kin}}(h \\cdot \\rho_{\\text{QSD}}) \\ge \\lambda_{\\text{mic}} \\|(I - \\Pi) h\\|^2_{L^2(\\rho_{\\text{QSD}})}\n2587: \n2588: $$",
      "metadata": {
        "label": "lem-micro-coercivity"
      },
      "section": "## 9. Main Convergence Theorems and Physical Interpretation",
      "raw_directive": "2578: The core technical work involves proving three lemmas:\n2579: \n2580: :::{prf:lemma} Microscopic Coercivity (Step A)\n2581: :label: lem-micro-coercivity\n2582: \n2583: There exists $\\lambda_{\\text{mic}} > 0$ such that:\n2584: \n2585: $$\n2586: D_{\\text{kin}}(h \\cdot \\rho_{\\text{QSD}}) \\ge \\lambda_{\\text{mic}} \\|(I - \\Pi) h\\|^2_{L^2(\\rho_{\\text{QSD}})}\n2587: \n2588: $$\n2589: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 9. Main Convergence Theorems and Physical Interpretation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-macro-transport",
      "title": "Macroscopic Transport in Absorption Form (Step B)",
      "start_line": 2591,
      "end_line": 2638,
      "header_lines": [
        2592
      ],
      "content_start": 2594,
      "content_end": 2637,
      "content": "2594: :label: lem-macro-transport\n2595: \n2596: **Assumption A1 (Uniform Convexity)**: The confining potential $U(x)$ satisfies:\n2597: \n2598: $$\n2599: \\nabla^2 U(x) \\succeq \\kappa_{\\text{conf}} I \\quad \\text{for all } x \\in \\mathcal{X}\n2600: \n2601: $$\n2602: \n2603: for some constant $\\kappa_{\\text{conf}} > 0$.\n2604: \n2605: **Assumption A2 (Centered Velocities)**: The conditional velocity mean under the QSD vanishes:\n2606: \n2607: $$\n2608: \\int v \\rho_{\\text{QSD}}(v | x) \\, dv = 0 \\quad \\text{for all } x \\in \\mathcal{X}\n2609: \n2610: $$\n2611: \n2612: **Assumption A3 (Bounded Perturbation)**: The position marginal $\\rho_x(x) := \\int \\rho_{\\text{QSD}}(x, v) \\, dv$ satisfies:\n2613: \n2614: $$\n2615: \\left\\| \\log\\left(\\frac{\\rho_x}{\\mu_{\\text{Gibbs}}}\\right) \\right\\|_{L^\\infty(\\mathcal{X})} < \\infty\n2616: \n2617: $$\n2618: \n2619: where $\\mu_{\\text{Gibbs}}(dx) \\propto e^{-U(x)} dx$ is the Gibbs measure.\n2620: \n2621: Under these assumptions, there exist constants $C_1, C_{\\text{aux}} > 0$ such that for all $h \\in H^1(\\rho_{\\text{QSD}})$ with $\\int h \\rho_{\\text{QSD}} = 1$:\n2622: \n2623: $$\n2624: \\|\\Pi h - 1\\|^2_{L^2(\\rho_x)} \\le C_1 \\left| \\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2(\\rho_{\\text{QSD}})} \\right| + C_{\\text{aux}} \\|(I - \\Pi) h\\|^2_{L^2(\\rho_{\\text{QSD}})}\n2625: \n2626: $$\n2627: \n2628: where:\n2629: \n2630: $$\n2631: C_1 = \\frac{2}{\\sqrt{\\kappa_x c_v}}, \\quad C_{\\text{aux}} = \\frac{1}{\\kappa_x c_v}\n2632: \n2633: $$\n2634: \n2635: with:\n2636: - $\\kappa_x \\ge \\kappa_{\\text{conf}} e^{-2 C_{\\text{pert}}}$ (position Poincaré constant)\n2637: - $c_v = \\frac{\\sigma^2}{2\\gamma}$ (velocity covariance lower bound)",
      "metadata": {
        "label": "lem-macro-transport"
      },
      "section": "## 9. Main Convergence Theorems and Physical Interpretation",
      "raw_directive": "2591: :::\n2592: \n2593: :::{prf:lemma} Macroscopic Transport in Absorption Form (Step B)\n2594: :label: lem-macro-transport\n2595: \n2596: **Assumption A1 (Uniform Convexity)**: The confining potential $U(x)$ satisfies:\n2597: \n2598: $$\n2599: \\nabla^2 U(x) \\succeq \\kappa_{\\text{conf}} I \\quad \\text{for all } x \\in \\mathcal{X}\n2600: \n2601: $$\n2602: \n2603: for some constant $\\kappa_{\\text{conf}} > 0$.\n2604: \n2605: **Assumption A2 (Centered Velocities)**: The conditional velocity mean under the QSD vanishes:\n2606: \n2607: $$\n2608: \\int v \\rho_{\\text{QSD}}(v | x) \\, dv = 0 \\quad \\text{for all } x \\in \\mathcal{X}\n2609: \n2610: $$\n2611: \n2612: **Assumption A3 (Bounded Perturbation)**: The position marginal $\\rho_x(x) := \\int \\rho_{\\text{QSD}}(x, v) \\, dv$ satisfies:\n2613: \n2614: $$\n2615: \\left\\| \\log\\left(\\frac{\\rho_x}{\\mu_{\\text{Gibbs}}}\\right) \\right\\|_{L^\\infty(\\mathcal{X})} < \\infty\n2616: \n2617: $$\n2618: \n2619: where $\\mu_{\\text{Gibbs}}(dx) \\propto e^{-U(x)} dx$ is the Gibbs measure.\n2620: \n2621: Under these assumptions, there exist constants $C_1, C_{\\text{aux}} > 0$ such that for all $h \\in H^1(\\rho_{\\text{QSD}})$ with $\\int h \\rho_{\\text{QSD}} = 1$:\n2622: \n2623: $$\n2624: \\|\\Pi h - 1\\|^2_{L^2(\\rho_x)} \\le C_1 \\left| \\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2(\\rho_{\\text{QSD}})} \\right| + C_{\\text{aux}} \\|(I - \\Pi) h\\|^2_{L^2(\\rho_{\\text{QSD}})}\n2625: \n2626: $$\n2627: \n2628: where:\n2629: \n2630: $$\n2631: C_1 = \\frac{2}{\\sqrt{\\kappa_x c_v}}, \\quad C_{\\text{aux}} = \\frac{1}{\\kappa_x c_v}\n2632: \n2633: $$\n2634: \n2635: with:\n2636: - $\\kappa_x \\ge \\kappa_{\\text{conf}} e^{-2 C_{\\text{pert}}}$ (position Poincaré constant)\n2637: - $c_v = \\frac{\\sigma^2}{2\\gamma}$ (velocity covariance lower bound)\n2638: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 9. Main Convergence Theorems and Physical Interpretation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-micro-reg",
      "title": "Microscopic Regularization (Step C)",
      "start_line": 2741,
      "end_line": 2752,
      "header_lines": [
        2742
      ],
      "content_start": 2744,
      "content_end": 2751,
      "content": "2744: :label: lem-micro-reg\n2745: \n2746: There exists $C_2 > 0$ such that:\n2747: \n2748: $$\n2749: \\left| \\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2(\\rho_{\\text{QSD}})} \\right| \\le C_2 \\sqrt{D_{\\text{kin}}(h \\cdot \\rho_{\\text{QSD}})}\n2750: \n2751: $$",
      "metadata": {
        "label": "lem-micro-reg"
      },
      "section": "## 9. Main Convergence Theorems and Physical Interpretation",
      "raw_directive": "2741: :::\n2742: \n2743: :::{prf:lemma} Microscopic Regularization (Step C)\n2744: :label: lem-micro-reg\n2745: \n2746: There exists $C_2 > 0$ such that:\n2747: \n2748: $$\n2749: \\left| \\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2(\\rho_{\\text{QSD}})} \\right| \\le C_2 \\sqrt{D_{\\text{kin}}(h \\cdot \\rho_{\\text{QSD}})}\n2750: \n2751: $$\n2752: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 9. Main Convergence Theorems and Physical Interpretation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-weight-derivatives",
      "title": "Derivatives of Localization Weights",
      "start_line": 2969,
      "end_line": 3006,
      "header_lines": [
        2970
      ],
      "content_start": 2972,
      "content_end": 3005,
      "content": "2972: :label: lem-weight-derivatives\n2973: \n2974: The localization weights $w_{ij}(\\rho)$ satisfy:\n2975: \n2976: **First Derivative:**\n2977: \n2978: $$\n2979: \\nabla_{x_i} w_{ij}(\\rho) = \\frac{1}{Z_i(\\rho)} \\left[ \\nabla_{x_i} K_\\rho(x_i, x_j) - w_{ij}(\\rho) \\sum_{\\ell \\in A_k} \\nabla_{x_i} K_\\rho(x_i, x_\\ell) \\right]\n2980: \n2981: $$\n2982: \n2983: where $Z_i(\\rho) = \\sum_{\\ell \\in A_k} K_\\rho(x_i, x_\\ell)$ is the normalization **over alive walkers only**.\n2984: \n2985: **Bound:**\n2986: \n2987: $$\n2988: \\|\\nabla_{x_i} w_{ij}(\\rho)\\| \\le \\frac{2C_{\\nabla K}(\\rho)}{\\rho}\n2989: \n2990: $$\n2991: \n2992: **Second Derivative:** The Hessian $\\nabla^2_{x_i} w_{ij}(\\rho)$ involves terms with $\\nabla^2 K_\\rho$, $(\\nabla K_\\rho) \\otimes (\\nabla K_\\rho)$, and products of weights. It satisfies:\n2993: \n2994: $$\n2995: \\|\\nabla^2_{x_i} w_{ij}(\\rho)\\| \\le C_w(\\rho) := \\frac{C_{\\nabla^2 K}(\\rho)}{\\rho^2} + \\frac{4C_{\\nabla K}(\\rho)^2}{\\rho^2}\n2996: \n2997: $$\n2998: \n2999: **Proof:**\n3000: The first derivative follows from the quotient rule applied to $w_{ij} = K_\\rho(x_i, x_j) / Z_i(\\rho)$. The bound uses $\\sum_k w_{ik} = 1$ and the triangle inequality.\n3001: \n3002: The second derivative involves differentiating the quotient rule expression, yielding terms of the form:\n3003: - $\\nabla^2 K_\\rho / Z_i$ (bounded by $C_{\\nabla^2 K}/\\rho^2$)\n3004: - $(\\nabla K_\\rho) \\otimes (\\nabla K_\\rho) / Z_i^2$ (bounded by $C_{\\nabla K}^2/\\rho^2$ after using $Z_i \\ge 1/N$)\n3005: - Products involving $w_{ij}$ and sums over $k$",
      "metadata": {
        "label": "lem-weight-derivatives"
      },
      "section": "## Appendix A: Regularity of the ρ-Localized Fitness Potential",
      "raw_directive": "2969: Before tackling the full derivatives, we establish bounds on the derivatives of the weighted sums.\n2970: \n2971: :::{prf:lemma} Derivatives of Localization Weights\n2972: :label: lem-weight-derivatives\n2973: \n2974: The localization weights $w_{ij}(\\rho)$ satisfy:\n2975: \n2976: **First Derivative:**\n2977: \n2978: $$\n2979: \\nabla_{x_i} w_{ij}(\\rho) = \\frac{1}{Z_i(\\rho)} \\left[ \\nabla_{x_i} K_\\rho(x_i, x_j) - w_{ij}(\\rho) \\sum_{\\ell \\in A_k} \\nabla_{x_i} K_\\rho(x_i, x_\\ell) \\right]\n2980: \n2981: $$\n2982: \n2983: where $Z_i(\\rho) = \\sum_{\\ell \\in A_k} K_\\rho(x_i, x_\\ell)$ is the normalization **over alive walkers only**.\n2984: \n2985: **Bound:**\n2986: \n2987: $$\n2988: \\|\\nabla_{x_i} w_{ij}(\\rho)\\| \\le \\frac{2C_{\\nabla K}(\\rho)}{\\rho}\n2989: \n2990: $$\n2991: \n2992: **Second Derivative:** The Hessian $\\nabla^2_{x_i} w_{ij}(\\rho)$ involves terms with $\\nabla^2 K_\\rho$, $(\\nabla K_\\rho) \\otimes (\\nabla K_\\rho)$, and products of weights. It satisfies:\n2993: \n2994: $$\n2995: \\|\\nabla^2_{x_i} w_{ij}(\\rho)\\| \\le C_w(\\rho) := \\frac{C_{\\nabla^2 K}(\\rho)}{\\rho^2} + \\frac{4C_{\\nabla K}(\\rho)^2}{\\rho^2}\n2996: \n2997: $$\n2998: \n2999: **Proof:**\n3000: The first derivative follows from the quotient rule applied to $w_{ij} = K_\\rho(x_i, x_j) / Z_i(\\rho)$. The bound uses $\\sum_k w_{ik} = 1$ and the triangle inequality.\n3001: \n3002: The second derivative involves differentiating the quotient rule expression, yielding terms of the form:\n3003: - $\\nabla^2 K_\\rho / Z_i$ (bounded by $C_{\\nabla^2 K}/\\rho^2$)\n3004: - $(\\nabla K_\\rho) \\otimes (\\nabla K_\\rho) / Z_i^2$ (bounded by $C_{\\nabla K}^2/\\rho^2$ after using $Z_i \\ge 1/N$)\n3005: - Products involving $w_{ij}$ and sums over $k$\n3006: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## Appendix A: Regularity of the ρ-Localized Fitness Potential"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mean-first-derivative",
      "title": "First Derivative of Localized Mean",
      "start_line": 3008,
      "end_line": 3094,
      "header_lines": [
        3009
      ],
      "content_start": 3011,
      "content_end": 3093,
      "content": "3011: :label: lem-mean-first-derivative\n3012: \n3013: The gradient of the localized mean satisfies:\n3014: \n3015: $$\n3016: \\nabla_{x_i} \\mu_\\rho^{(i)} = \\nabla_{x_i} d(x_i) \\cdot w_{ii}(\\rho) + \\sum_{j \\in A_k} d(x_j) \\nabla_{x_i} w_{ij}(\\rho)\n3017: \n3018: $$\n3019: \n3020: **k-Uniform Bound:**\n3021: \n3022: $$\n3023: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + \\frac{4 d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n3024: \n3025: $$\n3026: \n3027: **Proof:**\n3028: \n3029: Differentiate $\\mu_\\rho^{(i)} = \\sum_{j \\in A_k} w_{ij}(\\rho) d(x_j)$ using the product rule. The term with $j=i$ contributes $\\nabla d(x_i) \\cdot w_{ii}$. For $j \\ne i$, only the weights depend on $x_i$.\n3030: \n3031: **Step 1: Exploit the Telescoping Property.** Since $\\sum_{j \\in A_k} w_{ij} = 1$ is constant, differentiating yields:\n3032: \n3033: $$\n3034: \\sum_{j \\in A_k} \\nabla_{x_i} w_{ij}(\\rho) = 0\n3035: \n3036: $$\n3037: \n3038: This is the key telescoping property that enables k-uniformity. Using this identity, we can rewrite:\n3039: \n3040: $$\n3041: \\sum_{j \\in A_k} d(x_j) \\nabla_{x_i} w_{ij}(\\rho) = \\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}(\\rho)\n3042: \n3043: $$\n3044: \n3045: **Why this matters:** The term $[d(x_j) - d(x_i)]$ is only non-zero when $j \\ne i$, and crucially, it is **localized by the kernel's structure**, not by counting walkers.\n3046: \n3047: **Step 2: Bound Using Kernel Localization.** The gradient $\\nabla_{x_i} w_{ij}(\\rho)$ is significant only when $K_\\rho(x_i, x_j)$ is non-negligible, which requires $\\|x_i - x_j\\| = O(\\rho)$. For such $j$, by smoothness of $d$:\n3048: \n3049: $$\n3050: |d(x_j) - d(x_i)| \\le d'_{\\max} \\|x_j - x_i\\| \\le d'_{\\max} \\cdot C_K \\rho\n3051: \n3052: $$\n3053: \n3054: where $C_K$ is a constant depending on the kernel's effective radius (e.g., $C_K \\approx 3$ for a Gaussian kernel with 99.7% mass within 3σ).\n3055: \n3056: **Step 3: Apply the Triangle Inequality.** Combining with the bound $\\|\\nabla w_{ij}\\| \\le 2C_{\\nabla K}(\\rho)/\\rho$:\n3057: \n3058: $$\n3059: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}\\right\\| \\le \\sum_{j \\in A_k} |d(x_j) - d(x_i)| \\cdot \\|\\nabla_{x_i} w_{ij}\\|\n3060: \n3061: $$\n3062: \n3063: Now, **the key insight**: While the sum is over all $k$ alive walkers, the terms are **non-zero only for j in the ρ-neighborhood** of $i$ (by kernel localization). For such $j$:\n3064: \n3065: $$\n3066: |d(x_j) - d(x_i)| \\cdot \\|\\nabla_{x_i} w_{ij}\\| \\le d'_{\\max} C_K \\rho \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = 2d'_{\\max} C_K C_{\\nabla K}(\\rho)\n3067: \n3068: $$\n3069: \n3070: For walkers outside the ρ-neighborhood, $K_\\rho(x_i, x_j) \\approx 0$, so $\\nabla_{x_i} w_{ij} \\approx 0$ (exponentially small for Gaussian kernels).\n3071: \n3072: **Step 4: Sum the Contributions.** The total bound is:\n3073: \n3074: $$\n3075: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}\\right\\| \\le \\underbrace{\\left[\\text{bound per term}\\right]}_{2d'_{\\max} C_K C_{\\nabla K}(\\rho)} \\cdot \\underbrace{\\left[\\text{sum of weights}\\right]}_{\\sum_{j \\in A_k} w_{ij} = 1}\n3076: \n3077: $$\n3078: \n3079: The critical observation is that **the weighted sum collapses via telescoping**, not via counting effective walkers. The terms are automatically bounded by the normalization $\\sum w_{ij} = 1$, independent of $k$.\n3080: \n3081: **Step 5: Final Bound.** Including the diagonal term $\\nabla d(x_i) \\cdot w_{ii}$:\n3082: \n3083: $$\n3084: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + 2d'_{\\max} C_K C_{\\nabla K}(\\rho)\n3085: \n3086: $$\n3087: \n3088: For a conservative bound, we absorb $C_K$ into a rescaled constant and use $|d(x_j)| \\le d_{\\max}$ directly (without telescoping for the outer triangle inequality):\n3089: \n3090: $$\n3091: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + \\frac{4 d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n3092: \n3093: $$",
      "metadata": {
        "label": "lem-mean-first-derivative"
      },
      "section": "## Appendix A: Regularity of the ρ-Localized Fitness Potential",
      "raw_directive": "3008: :::\n3009: \n3010: :::{prf:lemma} First Derivative of Localized Mean\n3011: :label: lem-mean-first-derivative\n3012: \n3013: The gradient of the localized mean satisfies:\n3014: \n3015: $$\n3016: \\nabla_{x_i} \\mu_\\rho^{(i)} = \\nabla_{x_i} d(x_i) \\cdot w_{ii}(\\rho) + \\sum_{j \\in A_k} d(x_j) \\nabla_{x_i} w_{ij}(\\rho)\n3017: \n3018: $$\n3019: \n3020: **k-Uniform Bound:**\n3021: \n3022: $$\n3023: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + \\frac{4 d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n3024: \n3025: $$\n3026: \n3027: **Proof:**\n3028: \n3029: Differentiate $\\mu_\\rho^{(i)} = \\sum_{j \\in A_k} w_{ij}(\\rho) d(x_j)$ using the product rule. The term with $j=i$ contributes $\\nabla d(x_i) \\cdot w_{ii}$. For $j \\ne i$, only the weights depend on $x_i$.\n3030: \n3031: **Step 1: Exploit the Telescoping Property.** Since $\\sum_{j \\in A_k} w_{ij} = 1$ is constant, differentiating yields:\n3032: \n3033: $$\n3034: \\sum_{j \\in A_k} \\nabla_{x_i} w_{ij}(\\rho) = 0\n3035: \n3036: $$\n3037: \n3038: This is the key telescoping property that enables k-uniformity. Using this identity, we can rewrite:\n3039: \n3040: $$\n3041: \\sum_{j \\in A_k} d(x_j) \\nabla_{x_i} w_{ij}(\\rho) = \\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}(\\rho)\n3042: \n3043: $$\n3044: \n3045: **Why this matters:** The term $[d(x_j) - d(x_i)]$ is only non-zero when $j \\ne i$, and crucially, it is **localized by the kernel's structure**, not by counting walkers.\n3046: \n3047: **Step 2: Bound Using Kernel Localization.** The gradient $\\nabla_{x_i} w_{ij}(\\rho)$ is significant only when $K_\\rho(x_i, x_j)$ is non-negligible, which requires $\\|x_i - x_j\\| = O(\\rho)$. For such $j$, by smoothness of $d$:\n3048: \n3049: $$\n3050: |d(x_j) - d(x_i)| \\le d'_{\\max} \\|x_j - x_i\\| \\le d'_{\\max} \\cdot C_K \\rho\n3051: \n3052: $$\n3053: \n3054: where $C_K$ is a constant depending on the kernel's effective radius (e.g., $C_K \\approx 3$ for a Gaussian kernel with 99.7% mass within 3σ).\n3055: \n3056: **Step 3: Apply the Triangle Inequality.** Combining with the bound $\\|\\nabla w_{ij}\\| \\le 2C_{\\nabla K}(\\rho)/\\rho$:\n3057: \n3058: $$\n3059: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}\\right\\| \\le \\sum_{j \\in A_k} |d(x_j) - d(x_i)| \\cdot \\|\\nabla_{x_i} w_{ij}\\|\n3060: \n3061: $$\n3062: \n3063: Now, **the key insight**: While the sum is over all $k$ alive walkers, the terms are **non-zero only for j in the ρ-neighborhood** of $i$ (by kernel localization). For such $j$:\n3064: \n3065: $$\n3066: |d(x_j) - d(x_i)| \\cdot \\|\\nabla_{x_i} w_{ij}\\| \\le d'_{\\max} C_K \\rho \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = 2d'_{\\max} C_K C_{\\nabla K}(\\rho)\n3067: \n3068: $$\n3069: \n3070: For walkers outside the ρ-neighborhood, $K_\\rho(x_i, x_j) \\approx 0$, so $\\nabla_{x_i} w_{ij} \\approx 0$ (exponentially small for Gaussian kernels).\n3071: \n3072: **Step 4: Sum the Contributions.** The total bound is:\n3073: \n3074: $$\n3075: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}\\right\\| \\le \\underbrace{\\left[\\text{bound per term}\\right]}_{2d'_{\\max} C_K C_{\\nabla K}(\\rho)} \\cdot \\underbrace{\\left[\\text{sum of weights}\\right]}_{\\sum_{j \\in A_k} w_{ij} = 1}\n3076: \n3077: $$\n3078: \n3079: The critical observation is that **the weighted sum collapses via telescoping**, not via counting effective walkers. The terms are automatically bounded by the normalization $\\sum w_{ij} = 1$, independent of $k$.\n3080: \n3081: **Step 5: Final Bound.** Including the diagonal term $\\nabla d(x_i) \\cdot w_{ii}$:\n3082: \n3083: $$\n3084: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + 2d'_{\\max} C_K C_{\\nabla K}(\\rho)\n3085: \n3086: $$\n3087: \n3088: For a conservative bound, we absorb $C_K$ into a rescaled constant and use $|d(x_j)| \\le d_{\\max}$ directly (without telescoping for the outer triangle inequality):\n3089: \n3090: $$\n3091: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + \\frac{4 d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n3092: \n3093: $$\n3094: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## Appendix A: Regularity of the ρ-Localized Fitness Potential"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mean-second-derivative",
      "title": "Second Derivative of Localized Mean",
      "start_line": 3096,
      "end_line": 3183,
      "header_lines": [
        3097
      ],
      "content_start": 3099,
      "content_end": 3182,
      "content": "3099: :label: lem-mean-second-derivative\n3100: \n3101: The Hessian of the localized mean satisfies:\n3102: \n3103: $$\n3104: \\nabla^2_{x_i} \\mu_\\rho^{(i)} = \\nabla^2_{x_i} d(x_i) \\cdot w_{ii}(\\rho) + 2 \\nabla_{x_i} d(x_i) \\otimes \\nabla_{x_i} w_{ii}(\\rho) + \\sum_{j \\in A_k} d(x_j) \\nabla^2_{x_i} w_{ij}(\\rho)\n3105: \n3106: $$\n3107: \n3108: **k-Uniform Bound:**\n3109: \n3110: $$\n3111: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} C_w(\\rho)\n3112: \n3113: $$\n3114: \n3115: **Proof:**\n3116: \n3117: Differentiate the expression from Lemma {prf:ref}`lem-mean-first-derivative`. The diagonal term ($j=i$) contributes $\\nabla^2 d(x_i)$ and $\\nabla d(x_i) \\otimes \\nabla w_{ii}$.\n3118: \n3119: **Step 1: Exploit the Telescoping Property.** Differentiating the constraint $\\sum_{j \\in A_k} w_{ij} = 1$ twice yields:\n3120: \n3121: $$\n3122: \\sum_{j \\in A_k} \\nabla^2_{x_i} w_{ij} = 0\n3123: \n3124: $$\n3125: \n3126: This telescoping identity allows us to rewrite:\n3127: \n3128: $$\n3129: \\sum_{j \\in A_k} d(x_j) \\nabla^2_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\n3130: \n3131: $$\n3132: \n3133: **Step 2: Bound Using Kernel Localization.** The Hessian $\\nabla^2_{x_i} w_{ij}$ is significant only when $K_\\rho(x_i, x_j)$ is non-negligible, requiring $\\|x_i - x_j\\| = O(\\rho)$. For such $j$:\n3134: \n3135: $$\n3136: |d(x_j) - d(x_i)| \\le d'_{\\max} C_K \\rho\n3137: \n3138: $$\n3139: \n3140: where $C_K$ is the kernel's effective radius constant.\n3141: \n3142: **Step 3: Apply the Hessian Bound.** Combining with $\\|\\nabla^2 w_{ij}\\| \\le C_w(\\rho)$ from Lemma {prf:ref}`lem-weight-derivatives`:\n3143: \n3144: $$\n3145: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\\right\\| \\le \\sum_{j \\in A_k} |d(x_j) - d(x_i)| \\cdot \\|\\nabla^2_{x_i} w_{ij}\\|\n3146: \n3147: $$\n3148: \n3149: For walkers in the ρ-neighborhood (the only ones contributing significantly):\n3150: \n3151: $$\n3152: |d(x_j) - d(x_i)| \\cdot \\|\\nabla^2_{x_i} w_{ij}\\| \\le d'_{\\max} C_K \\rho \\cdot C_w(\\rho)\n3153: \n3154: $$\n3155: \n3156: **Step 4: Sum via Telescoping.** The weighted sum collapses using the normalization $\\sum_{j \\in A_k} w_{ij} = 1$:\n3157: \n3158: $$\n3159: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\\right\\| \\le d'_{\\max} C_K \\rho \\cdot C_w(\\rho) \\cdot \\underbrace{\\left[\\text{normalized weight sum}\\right]}_{O(1)}\n3160: \n3161: $$\n3162: \n3163: **Step 5: Final Bound.** For the term $\\nabla d(x_i) \\otimes \\nabla w_{ii}$:\n3164: \n3165: $$\n3166: \\|2 \\nabla_{x_i} d(x_i) \\otimes \\nabla_{x_i} w_{ii}\\| \\le 2d'_{\\max} \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n3167: \n3168: $$\n3169: \n3170: Combining all terms (diagonal $\\nabla^2 d(x_i)$, cross-term, and the sum):\n3171: \n3172: $$\n3173: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + d'_{\\max} C_K \\rho C_w(\\rho)\n3174: \n3175: $$\n3176: \n3177: For a conservative bound, we use $|d(x_j)| \\le d_{\\max}$ directly and absorb constants:\n3178: \n3179: $$\n3180: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} C_w(\\rho)\n3181: \n3182: $$",
      "metadata": {
        "label": "lem-mean-second-derivative"
      },
      "section": "## Appendix A: Regularity of the ρ-Localized Fitness Potential",
      "raw_directive": "3096: :::\n3097: \n3098: :::{prf:lemma} Second Derivative of Localized Mean\n3099: :label: lem-mean-second-derivative\n3100: \n3101: The Hessian of the localized mean satisfies:\n3102: \n3103: $$\n3104: \\nabla^2_{x_i} \\mu_\\rho^{(i)} = \\nabla^2_{x_i} d(x_i) \\cdot w_{ii}(\\rho) + 2 \\nabla_{x_i} d(x_i) \\otimes \\nabla_{x_i} w_{ii}(\\rho) + \\sum_{j \\in A_k} d(x_j) \\nabla^2_{x_i} w_{ij}(\\rho)\n3105: \n3106: $$\n3107: \n3108: **k-Uniform Bound:**\n3109: \n3110: $$\n3111: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} C_w(\\rho)\n3112: \n3113: $$\n3114: \n3115: **Proof:**\n3116: \n3117: Differentiate the expression from Lemma {prf:ref}`lem-mean-first-derivative`. The diagonal term ($j=i$) contributes $\\nabla^2 d(x_i)$ and $\\nabla d(x_i) \\otimes \\nabla w_{ii}$.\n3118: \n3119: **Step 1: Exploit the Telescoping Property.** Differentiating the constraint $\\sum_{j \\in A_k} w_{ij} = 1$ twice yields:\n3120: \n3121: $$\n3122: \\sum_{j \\in A_k} \\nabla^2_{x_i} w_{ij} = 0\n3123: \n3124: $$\n3125: \n3126: This telescoping identity allows us to rewrite:\n3127: \n3128: $$\n3129: \\sum_{j \\in A_k} d(x_j) \\nabla^2_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\n3130: \n3131: $$\n3132: \n3133: **Step 2: Bound Using Kernel Localization.** The Hessian $\\nabla^2_{x_i} w_{ij}$ is significant only when $K_\\rho(x_i, x_j)$ is non-negligible, requiring $\\|x_i - x_j\\| = O(\\rho)$. For such $j$:\n3134: \n3135: $$\n3136: |d(x_j) - d(x_i)| \\le d'_{\\max} C_K \\rho\n3137: \n3138: $$\n3139: \n3140: where $C_K$ is the kernel's effective radius constant.\n3141: \n3142: **Step 3: Apply the Hessian Bound.** Combining with $\\|\\nabla^2 w_{ij}\\| \\le C_w(\\rho)$ from Lemma {prf:ref}`lem-weight-derivatives`:\n3143: \n3144: $$\n3145: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\\right\\| \\le \\sum_{j \\in A_k} |d(x_j) - d(x_i)| \\cdot \\|\\nabla^2_{x_i} w_{ij}\\|\n3146: \n3147: $$\n3148: \n3149: For walkers in the ρ-neighborhood (the only ones contributing significantly):\n3150: \n3151: $$\n3152: |d(x_j) - d(x_i)| \\cdot \\|\\nabla^2_{x_i} w_{ij}\\| \\le d'_{\\max} C_K \\rho \\cdot C_w(\\rho)\n3153: \n3154: $$\n3155: \n3156: **Step 4: Sum via Telescoping.** The weighted sum collapses using the normalization $\\sum_{j \\in A_k} w_{ij} = 1$:\n3157: \n3158: $$\n3159: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\\right\\| \\le d'_{\\max} C_K \\rho \\cdot C_w(\\rho) \\cdot \\underbrace{\\left[\\text{normalized weight sum}\\right]}_{O(1)}\n3160: \n3161: $$\n3162: \n3163: **Step 5: Final Bound.** For the term $\\nabla d(x_i) \\otimes \\nabla w_{ii}$:\n3164: \n3165: $$\n3166: \\|2 \\nabla_{x_i} d(x_i) \\otimes \\nabla_{x_i} w_{ii}\\| \\le 2d'_{\\max} \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n3167: \n3168: $$\n3169: \n3170: Combining all terms (diagonal $\\nabla^2 d(x_i)$, cross-term, and the sum):\n3171: \n3172: $$\n3173: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + d'_{\\max} C_K \\rho C_w(\\rho)\n3174: \n3175: $$\n3176: \n3177: For a conservative bound, we use $|d(x_j)| \\le d_{\\max}$ directly and absorb constants:\n3178: \n3179: $$\n3180: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} C_w(\\rho)\n3181: \n3182: $$\n3183: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## Appendix A: Regularity of the ρ-Localized Fitness Potential"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-gradient",
      "title": "k-Uniform Gradient of Localized Variance",
      "start_line": 3185,
      "end_line": 3235,
      "header_lines": [
        3186
      ],
      "content_start": 3188,
      "content_end": 3234,
      "content": "3188: :label: lem-variance-gradient\n3189: \n3190: The gradient of the localized variance satisfies:\n3191: \n3192: $$\n3193: \\|\\nabla_{x_i} V_\\rho^{(i)}\\| \\le C_{V,\\nabla}(\\rho)\n3194: \n3195: $$\n3196: \n3197: where $C_{V,\\nabla}(\\rho)$ is a ρ-dependent but **k-uniform** constant:\n3198: \n3199: $$\n3200: C_{V,\\nabla}(\\rho) = 4d_{\\max} d'_{\\max} + 4d_{\\max}^2 \\frac{C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} \\left(d'_{\\max} + \\frac{4d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\\right)\n3201: \n3202: $$\n3203: \n3204: **Proof:**\n3205: \n3206: The variance is $V_\\rho^{(i)} = \\sum_{j \\in A_k} w_{ij} d(x_j)^2 - (\\mu_\\rho^{(i)})^2$. Differentiating:\n3207: \n3208: $$\n3209: \\nabla_{x_i} V_\\rho^{(i)} = \\nabla_{x_i}\\left(\\sum_{j \\in A_k} w_{ij} d(x_j)^2\\right) - 2\\mu_\\rho^{(i)} \\nabla_{x_i} \\mu_\\rho^{(i)}\n3210: \n3211: $$\n3212: \n3213: **Term 1:** For the first term, apply the telescoping property $\\sum_j \\nabla w_{ij} = 0$:\n3214: \n3215: $$\n3216: \\sum_{j \\in A_k} d(x_j)^2 \\nabla_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla_{x_i} w_{ij}\n3217: \n3218: $$\n3219: \n3220: Using $|d(x_j)^2 - d(x_i)^2| = |d(x_j) - d(x_i)| \\cdot |d(x_j) + d(x_i)| \\le |d(x_j) - d(x_i)| \\cdot 2d_{\\max}$ and the kernel localization $|d(x_j) - d(x_i)| \\le d'_{\\max} C_K \\rho$:\n3221: \n3222: $$\n3223: \\left\\|\\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla w_{ij}\\right\\| \\le 2d_{\\max} d'_{\\max} C_K \\rho \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = 4d_{\\max} d'_{\\max} C_K C_{\\nabla K}(\\rho)\n3224: \n3225: $$\n3226: \n3227: The diagonal term contributes $2d(x_i) d'_{\\max} w_{ii} \\le 2d_{\\max} d'_{\\max}$.\n3228: \n3229: **Term 2:** The second term uses the bound from Lemma {prf:ref}`lem-mean-first-derivative`:\n3230: \n3231: $$\n3232: \\|2\\mu_\\rho^{(i)} \\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le 2d_{\\max} \\left(d'_{\\max} + \\frac{4d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\\right)\n3233: \n3234: $$",
      "metadata": {
        "label": "lem-variance-gradient"
      },
      "section": "## Appendix A: Regularity of the ρ-Localized Fitness Potential",
      "raw_directive": "3185: :::\n3186: \n3187: :::{prf:lemma} k-Uniform Gradient of Localized Variance\n3188: :label: lem-variance-gradient\n3189: \n3190: The gradient of the localized variance satisfies:\n3191: \n3192: $$\n3193: \\|\\nabla_{x_i} V_\\rho^{(i)}\\| \\le C_{V,\\nabla}(\\rho)\n3194: \n3195: $$\n3196: \n3197: where $C_{V,\\nabla}(\\rho)$ is a ρ-dependent but **k-uniform** constant:\n3198: \n3199: $$\n3200: C_{V,\\nabla}(\\rho) = 4d_{\\max} d'_{\\max} + 4d_{\\max}^2 \\frac{C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} \\left(d'_{\\max} + \\frac{4d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\\right)\n3201: \n3202: $$\n3203: \n3204: **Proof:**\n3205: \n3206: The variance is $V_\\rho^{(i)} = \\sum_{j \\in A_k} w_{ij} d(x_j)^2 - (\\mu_\\rho^{(i)})^2$. Differentiating:\n3207: \n3208: $$\n3209: \\nabla_{x_i} V_\\rho^{(i)} = \\nabla_{x_i}\\left(\\sum_{j \\in A_k} w_{ij} d(x_j)^2\\right) - 2\\mu_\\rho^{(i)} \\nabla_{x_i} \\mu_\\rho^{(i)}\n3210: \n3211: $$\n3212: \n3213: **Term 1:** For the first term, apply the telescoping property $\\sum_j \\nabla w_{ij} = 0$:\n3214: \n3215: $$\n3216: \\sum_{j \\in A_k} d(x_j)^2 \\nabla_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla_{x_i} w_{ij}\n3217: \n3218: $$\n3219: \n3220: Using $|d(x_j)^2 - d(x_i)^2| = |d(x_j) - d(x_i)| \\cdot |d(x_j) + d(x_i)| \\le |d(x_j) - d(x_i)| \\cdot 2d_{\\max}$ and the kernel localization $|d(x_j) - d(x_i)| \\le d'_{\\max} C_K \\rho$:\n3221: \n3222: $$\n3223: \\left\\|\\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla w_{ij}\\right\\| \\le 2d_{\\max} d'_{\\max} C_K \\rho \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = 4d_{\\max} d'_{\\max} C_K C_{\\nabla K}(\\rho)\n3224: \n3225: $$\n3226: \n3227: The diagonal term contributes $2d(x_i) d'_{\\max} w_{ii} \\le 2d_{\\max} d'_{\\max}$.\n3228: \n3229: **Term 2:** The second term uses the bound from Lemma {prf:ref}`lem-mean-first-derivative`:\n3230: \n3231: $$\n3232: \\|2\\mu_\\rho^{(i)} \\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le 2d_{\\max} \\left(d'_{\\max} + \\frac{4d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\\right)\n3233: \n3234: $$\n3235: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## Appendix A: Regularity of the ρ-Localized Fitness Potential"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-hessian",
      "title": "k-Uniform Hessian of Localized Variance",
      "start_line": 3237,
      "end_line": 3266,
      "header_lines": [
        3238
      ],
      "content_start": 3240,
      "content_end": 3265,
      "content": "3240: :label: lem-variance-hessian\n3241: \n3242: The Hessian of the localized variance satisfies:\n3243: \n3244: $$\n3245: \\|\\nabla^2_{x_i} V_\\rho^{(i)}\\| \\le C_{V,\\nabla^2}(\\rho)\n3246: \n3247: $$\n3248: \n3249: where $C_{V,\\nabla^2}(\\rho)$ is a ρ-dependent but **k-uniform** constant involving $d''_{\\max}$, $C_{\\nabla K}(\\rho)/\\rho$, $C_w(\\rho)$, and the first-order bounds.\n3250: \n3251: **Proof:**\n3252: \n3253: Differentiate the expression from Lemma {prf:ref}`lem-variance-gradient`. Apply the telescoping property $\\sum_j \\nabla^2 w_{ij} = 0$ to:\n3254: \n3255: $$\n3256: \\sum_{j \\in A_k} d(x_j)^2 \\nabla^2_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla^2_{x_i} w_{ij}\n3257: \n3258: $$\n3259: \n3260: Using kernel localization and the bound $\\|\\nabla^2 w_{ij}\\| \\le C_w(\\rho)$, the sum collapses via the normalization constraint. The second derivative of the product $\\mu_\\rho^2$ involves:\n3261: \n3262: $$\n3263: \\nabla^2(\\mu_\\rho^2) = 2(\\nabla \\mu_\\rho) \\otimes (\\nabla \\mu_\\rho) + 2\\mu_\\rho \\nabla^2 \\mu_\\rho\n3264: \n3265: $$",
      "metadata": {
        "label": "lem-variance-hessian"
      },
      "section": "## Appendix A: Regularity of the ρ-Localized Fitness Potential",
      "raw_directive": "3237: :::\n3238: \n3239: :::{prf:lemma} k-Uniform Hessian of Localized Variance\n3240: :label: lem-variance-hessian\n3241: \n3242: The Hessian of the localized variance satisfies:\n3243: \n3244: $$\n3245: \\|\\nabla^2_{x_i} V_\\rho^{(i)}\\| \\le C_{V,\\nabla^2}(\\rho)\n3246: \n3247: $$\n3248: \n3249: where $C_{V,\\nabla^2}(\\rho)$ is a ρ-dependent but **k-uniform** constant involving $d''_{\\max}$, $C_{\\nabla K}(\\rho)/\\rho$, $C_w(\\rho)$, and the first-order bounds.\n3250: \n3251: **Proof:**\n3252: \n3253: Differentiate the expression from Lemma {prf:ref}`lem-variance-gradient`. Apply the telescoping property $\\sum_j \\nabla^2 w_{ij} = 0$ to:\n3254: \n3255: $$\n3256: \\sum_{j \\in A_k} d(x_j)^2 \\nabla^2_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla^2_{x_i} w_{ij}\n3257: \n3258: $$\n3259: \n3260: Using kernel localization and the bound $\\|\\nabla^2 w_{ij}\\| \\le C_w(\\rho)$, the sum collapses via the normalization constraint. The second derivative of the product $\\mu_\\rho^2$ involves:\n3261: \n3262: $$\n3263: \\nabla^2(\\mu_\\rho^2) = 2(\\nabla \\mu_\\rho) \\otimes (\\nabla \\mu_\\rho) + 2\\mu_\\rho \\nabla^2 \\mu_\\rho\n3264: \n3265: $$\n3266: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## Appendix A: Regularity of the ρ-Localized Fitness Potential"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-to-gap-adaptive",
      "title": "Variance-to-Gap (Universal Statistical Inequality)",
      "start_line": 3638,
      "end_line": 3649,
      "header_lines": [
        3639
      ],
      "content_start": 3641,
      "content_end": 3648,
      "content": "3641: :label: lem-variance-to-gap-adaptive\n3642: \n3643: For any random variable $X$ with mean $\\mu$ and variance $\\sigma^2 > 0$:\n3644: \n3645: $$\n3646: \\sup_{x \\in \\text{supp}(X)} |x - \\mu| \\ge \\sigma\n3647: \n3648: $$",
      "metadata": {
        "label": "lem-variance-to-gap-adaptive"
      },
      "section": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model",
      "raw_directive": "3638: #### B.3.1. The Variance-to-Gap Lemma (Universal)\n3639: \n3640: :::{prf:lemma} Variance-to-Gap (Universal Statistical Inequality)\n3641: :label: lem-variance-to-gap-adaptive\n3642: \n3643: For any random variable $X$ with mean $\\mu$ and variance $\\sigma^2 > 0$:\n3644: \n3645: $$\n3646: \\sup_{x \\in \\text{supp}(X)} |x - \\mu| \\ge \\sigma\n3647: \n3648: $$\n3649: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-rho-pipeline-bounds",
      "title": "Uniform Bounds on the ρ-Localized Pipeline",
      "start_line": 3767,
      "end_line": 3802,
      "header_lines": [
        3768
      ],
      "content_start": 3770,
      "content_end": 3801,
      "content": "3770: :label: lem-rho-pipeline-bounds\n3771: \n3772: For the ρ-localized rescaling pipeline with bounded measurements $d \\in [0, d_{\\max}]$:\n3773: \n3774: **1. Upper Bound on Localized Standard Deviation:**\n3775: \n3776: $$\n3777: \\sigma'_\\rho[f, d, x] \\le \\sigma'_{\\rho,\\max} := d_{\\max}\n3778: \n3779: $$\n3780: \n3781: for all $f, x, \\rho$. This bound is **N-uniform** and **ρ-dependent** (it could be tighter for specific ρ, but this worst-case bound suffices).\n3782: \n3783: **2. Lower Bound on Rescale Derivative:**\n3784: \n3785: $$\n3786: g'_A(z) \\ge g'_{\\min} > 0\n3787: \n3788: $$\n3789: \n3790: for all $z \\in \\mathbb{R}$, where $g_A$ is the smooth, monotone rescale function. This bound is **ρ-independent**.\n3791: \n3792: **Proof:**\n3793: \n3794: **Part 1:** The localized standard deviation is bounded by the range of the measurement function:\n3795: \n3796: $$\n3797: \\sigma'_\\rho[f, d, x] = \\max\\{\\sigma_\\rho[f, d, x], \\kappa_{\\text{var,min}}\\} \\le \\max_{x \\in \\mathcal{X}} d(x) = d_{\\max}\n3798: \n3799: $$\n3800: \n3801: This holds for all ρ because even in the hyper-local limit, the standard deviation of bounded measurements remains bounded.",
      "metadata": {
        "label": "lem-rho-pipeline-bounds"
      },
      "section": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model",
      "raw_directive": "3767: #### B.3.2. Uniform Bounds on ρ-Dependent Pipeline Components\n3768: \n3769: :::{prf:lemma} Uniform Bounds on the ρ-Localized Pipeline\n3770: :label: lem-rho-pipeline-bounds\n3771: \n3772: For the ρ-localized rescaling pipeline with bounded measurements $d \\in [0, d_{\\max}]$:\n3773: \n3774: **1. Upper Bound on Localized Standard Deviation:**\n3775: \n3776: $$\n3777: \\sigma'_\\rho[f, d, x] \\le \\sigma'_{\\rho,\\max} := d_{\\max}\n3778: \n3779: $$\n3780: \n3781: for all $f, x, \\rho$. This bound is **N-uniform** and **ρ-dependent** (it could be tighter for specific ρ, but this worst-case bound suffices).\n3782: \n3783: **2. Lower Bound on Rescale Derivative:**\n3784: \n3785: $$\n3786: g'_A(z) \\ge g'_{\\min} > 0\n3787: \n3788: $$\n3789: \n3790: for all $z \\in \\mathbb{R}$, where $g_A$ is the smooth, monotone rescale function. This bound is **ρ-independent**.\n3791: \n3792: **Proof:**\n3793: \n3794: **Part 1:** The localized standard deviation is bounded by the range of the measurement function:\n3795: \n3796: $$\n3797: \\sigma'_\\rho[f, d, x] = \\max\\{\\sigma_\\rho[f, d, x], \\kappa_{\\text{var,min}}\\} \\le \\max_{x \\in \\mathcal{X}} d(x) = d_{\\max}\n3798: \n3799: $$\n3800: \n3801: This holds for all ρ because even in the hyper-local limit, the standard deviation of bounded measurements remains bounded.\n3802: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-raw-to-rescaled-gap-rho",
      "title": "Raw-Gap to Rescaled-Gap for ρ-Localized Pipeline",
      "start_line": 3806,
      "end_line": 3852,
      "header_lines": [
        3807
      ],
      "content_start": 3809,
      "content_end": 3851,
      "content": "3809: :label: lem-raw-to-rescaled-gap-rho\n3810: \n3811: If the raw measurements satisfy:\n3812: \n3813: $$\n3814: \\max_{i \\in \\{1, \\ldots, N\\}} |d_i - \\mu_\\rho[f_k, d, x_{\\text{ref}}]| \\ge \\kappa_{\\text{raw}}\n3815: \n3816: $$\n3817: \n3818: for some reference point $x_{\\text{ref}}$ and raw gap $\\kappa_{\\text{raw}} > 0$, then the rescaled measurements satisfy:\n3819: \n3820: $$\n3821: \\max_{i \\in \\{1, \\ldots, N\\}} |d'_i - \\mu[d']| \\ge \\kappa_{\\text{rescaled}}(\\kappa_{\\text{raw}}, \\rho)\n3822: \n3823: $$\n3824: \n3825: where:\n3826: \n3827: $$\n3828: \\kappa_{\\text{rescaled}}(\\kappa_{\\text{raw}}, \\rho) := g'_{\\min} \\cdot \\frac{\\kappa_{\\text{raw}}}{\\sigma'_{\\rho,\\max}}\n3829: \n3830: $$\n3831: \n3832: **Proof:** By the Mean Value Theorem applied to the composition $d'_i = g_A(Z_\\rho[f_k, d, x_i])$:\n3833: \n3834: $$\n3835: |d'_i - d'_j| \\ge g'_{\\min} \\cdot |Z_\\rho[f_k, d, x_i] - Z_\\rho[f_k, d, x_j]|\n3836: \n3837: $$\n3838: \n3839: The Z-score difference satisfies:\n3840: \n3841: $$\n3842: |Z_\\rho[f_k, d, x_i] - Z_\\rho[f_k, d, x_j]| \\ge \\frac{|d_i - d_j|}{\\sigma'_{\\rho,\\max}}\n3843: \n3844: $$\n3845: \n3846: Combining these and using the raw gap:\n3847: \n3848: $$\n3849: \\max_{i,j} |d'_i - d'_j| \\ge g'_{\\min} \\cdot \\frac{\\kappa_{\\text{raw}}}{\\sigma'_{\\rho,\\max}}\n3850: \n3851: $$",
      "metadata": {
        "label": "lem-raw-to-rescaled-gap-rho"
      },
      "section": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model",
      "raw_directive": "3806: #### B.3.3. Raw-Gap to Rescaled-Gap Propagation (ρ-Dependent)\n3807: \n3808: :::{prf:lemma} Raw-Gap to Rescaled-Gap for ρ-Localized Pipeline\n3809: :label: lem-raw-to-rescaled-gap-rho\n3810: \n3811: If the raw measurements satisfy:\n3812: \n3813: $$\n3814: \\max_{i \\in \\{1, \\ldots, N\\}} |d_i - \\mu_\\rho[f_k, d, x_{\\text{ref}}]| \\ge \\kappa_{\\text{raw}}\n3815: \n3816: $$\n3817: \n3818: for some reference point $x_{\\text{ref}}$ and raw gap $\\kappa_{\\text{raw}} > 0$, then the rescaled measurements satisfy:\n3819: \n3820: $$\n3821: \\max_{i \\in \\{1, \\ldots, N\\}} |d'_i - \\mu[d']| \\ge \\kappa_{\\text{rescaled}}(\\kappa_{\\text{raw}}, \\rho)\n3822: \n3823: $$\n3824: \n3825: where:\n3826: \n3827: $$\n3828: \\kappa_{\\text{rescaled}}(\\kappa_{\\text{raw}}, \\rho) := g'_{\\min} \\cdot \\frac{\\kappa_{\\text{raw}}}{\\sigma'_{\\rho,\\max}}\n3829: \n3830: $$\n3831: \n3832: **Proof:** By the Mean Value Theorem applied to the composition $d'_i = g_A(Z_\\rho[f_k, d, x_i])$:\n3833: \n3834: $$\n3835: |d'_i - d'_j| \\ge g'_{\\min} \\cdot |Z_\\rho[f_k, d, x_i] - Z_\\rho[f_k, d, x_j]|\n3836: \n3837: $$\n3838: \n3839: The Z-score difference satisfies:\n3840: \n3841: $$\n3842: |Z_\\rho[f_k, d, x_i] - Z_\\rho[f_k, d, x_j]| \\ge \\frac{|d_i - d_j|}{\\sigma'_{\\rho,\\max}}\n3843: \n3844: $$\n3845: \n3846: Combining these and using the raw gap:\n3847: \n3848: $$\n3849: \\max_{i,j} |d'_i - d'_j| \\ge g'_{\\min} \\cdot \\frac{\\kappa_{\\text{raw}}}{\\sigma'_{\\rho,\\max}}\n3850: \n3851: $$\n3852: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-log-gap-bounds-adaptive",
      "title": "Logarithmic Gap Bounds (from 03_cloning.md, Lemma 7.5.1)",
      "start_line": 3868,
      "end_line": 3888,
      "header_lines": [
        3869
      ],
      "content_start": 3871,
      "content_end": 3887,
      "content": "3871: :label: lem-log-gap-bounds-adaptive\n3872: \n3873: For any random variable $X \\in [a, b]$ with mean $\\mu$ and $a < \\mu < b$:\n3874: \n3875: **Lower Bound:**\n3876: \n3877: $$\n3878: \\mathbb{E}[\\log X] \\le \\log \\mu\n3879: \n3880: $$\n3881: \n3882: **Upper Bound (Gap to Extremal Point):**\n3883: \n3884: $$\n3885: |\\log b - \\mathbb{E}[\\log X]| \\ge \\log(b) - \\log(\\mu)\n3886: \n3887: $$",
      "metadata": {
        "label": "lem-log-gap-bounds-adaptive"
      },
      "section": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model",
      "raw_directive": "3868: #### B.4.1. Foundational Statistical Lemmas (ρ-Independent)\n3869: \n3870: :::{prf:lemma} Logarithmic Gap Bounds (from 03_cloning.md, Lemma 7.5.1)\n3871: :label: lem-log-gap-bounds-adaptive\n3872: \n3873: For any random variable $X \\in [a, b]$ with mean $\\mu$ and $a < \\mu < b$:\n3874: \n3875: **Lower Bound:**\n3876: \n3877: $$\n3878: \\mathbb{E}[\\log X] \\le \\log \\mu\n3879: \n3880: $$\n3881: \n3882: **Upper Bound (Gap to Extremal Point):**\n3883: \n3884: $$\n3885: |\\log b - \\mathbb{E}[\\log X]| \\ge \\log(b) - \\log(\\mu)\n3886: \n3887: $$\n3888: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hessian-bounded",
      "title": "N-Uniform Boundedness of the Pure Hessian",
      "start_line": 665,
      "end_line": 675,
      "header_lines": [
        666
      ],
      "content_start": 668,
      "content_end": 674,
      "content": "668: :label: lem-hessian-bounded\n669: \n670: Under the axiomatic framework of Section 3, the unregularized Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n671: \n672: $$\n673: \\|H(S)\\| \\le H_{\\max}(\\rho) < \\infty\n674: $$",
      "metadata": {
        "label": "lem-hessian-bounded"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "665: The proof proceeds in three steps: we first establish boundedness of the pure Hessian, then demonstrate why regularization is necessary, and finally prove the main theorem.\n666: \n667: :::{prf:lemma} N-Uniform Boundedness of the Pure Hessian\n668: :label: lem-hessian-bounded\n669: \n670: Under the axiomatic framework of Section 3, the unregularized Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n671: \n672: $$\n673: \\|H(S)\\| \\le H_{\\max}(\\rho) < \\infty\n674: $$\n675: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Uniform Ellipticity and Well-Posedness"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hessian-bounded-rigorous",
      "title": "Rigorous Boundedness of the Hessian",
      "start_line": 724,
      "end_line": 737,
      "header_lines": [
        725
      ],
      "content_start": 727,
      "content_end": 736,
      "content": "727: :label: lem-hessian-bounded-rigorous\n728: \n729: Under the fitness pipeline construction with regularized Z-score regularization, the Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n730: \n731: $$\n732: \\|H(S)\\| \\le H_{\\max} = \\frac{4 A g'_{\\max}^2 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} + \\frac{A g'_{\\max} \\|\\nabla^2 d\\|_{\\infty}}{\\sigma\\'_{\\min}} + \\frac{4 A g''_{\\max} \\|\\nabla d\\|^4_{\\infty}}{\\sigma'^4_{\\min,\\text{patch}}}\n733: $$\n734: \n735: for all swarm states $S$, where:\n736: - $\\|\\nabla d\\|_{\\infty}$ and $\\|\\nabla^2 d\\|_{\\infty}$ are uniform bounds on the measurement function derivatives",
      "metadata": {
        "label": "lem-hessian-bounded-rigorous"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "724: :::\n725: \n726: :::{prf:lemma} Rigorous Boundedness of the Hessian\n727: :label: lem-hessian-bounded-rigorous\n728: \n729: Under the fitness pipeline construction with regularized Z-score regularization, the Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n730: \n731: $$\n732: \\|H(S)\\| \\le H_{\\max} = \\frac{4 A g'_{\\max}^2 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} + \\frac{A g'_{\\max} \\|\\nabla^2 d\\|_{\\infty}}{\\sigma\\'_{\\min}} + \\frac{4 A g''_{\\max} \\|\\nabla d\\|^4_{\\infty}}{\\sigma'^4_{\\min,\\text{patch}}}\n733: $$\n734: \n735: for all swarm states $S$, where:\n736: - $\\|\\nabla d\\|_{\\infty}$ and $\\|\\nabla^2 d\\|_{\\infty}$ are uniform bounds on the measurement function derivatives\n737: - $g'_{\\max}$ and $g''_{\\max}$ are bounds on the rescale function derivatives",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Uniform Ellipticity and Well-Posedness"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hessian-explosion",
      "title": "Failure of Uniformity Without Regularization",
      "start_line": 822,
      "end_line": 832,
      "header_lines": [
        823
      ],
      "content_start": 825,
      "content_end": 831,
      "content": "825: :label: lem-hessian-explosion\n826: \n827: If the regularization $\\epsilon_\\Sigma = 0$ and the swarm variance $\\text{Var}_\\mu[d] \\to 0$, then:\n828: \n829: $$\n830: \\|H(\\mu)\\| \\to \\infty\n831: $$",
      "metadata": {
        "label": "lem-hessian-explosion"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "822: :::\n823: \n824: :::{prf:lemma} Failure of Uniformity Without Regularization\n825: :label: lem-hessian-explosion\n826: \n827: If the regularization $\\epsilon_\\Sigma = 0$ and the swarm variance $\\text{Var}_\\mu[d] \\to 0$, then:\n828: \n829: $$\n830: \\|H(\\mu)\\| \\to \\infty\n831: $$\n832: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Uniform Ellipticity and Well-Posedness"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-adaptive-force-bounded",
      "title": "N-Uniform Bounded Perturbation from Adaptive Force",
      "start_line": 1230,
      "end_line": 1240,
      "header_lines": [
        1231
      ],
      "content_start": 1233,
      "content_end": 1239,
      "content": "1233: :label: lem-adaptive-force-bounded\n1234: \n1235: The adaptive force $\\mathbf{F}_{\\text{adapt}} = \\epsilon_F \\nabla V_{\\text{fit}}[f_k, \\rho]$ contributes a bounded perturbation to the drift of $V_{\\text{total}}$. There exists a **ρ-dependent but N-uniform constant** $K_F(\\rho) < \\infty$ such that:\n1236: \n1237: $$\n1238: \\left| \\left\\langle \\nabla V_{\\text{total}}(S), \\, \\mathbf{F}_{\\text{adapt}}(S) \\right\\rangle \\right| \\le \\epsilon_F K_F(\\rho) (V_{\\text{total}}(S) + 1)\n1239: $$",
      "metadata": {
        "label": "lem-adaptive-force-bounded"
      },
      "section": "## 6. Boundedness of the Adaptive Perturbations",
      "raw_directive": "1230: ### 6.2. Boundedness of the Adaptive Force Contribution\n1231: \n1232: :::{prf:lemma} N-Uniform Bounded Perturbation from Adaptive Force\n1233: :label: lem-adaptive-force-bounded\n1234: \n1235: The adaptive force $\\mathbf{F}_{\\text{adapt}} = \\epsilon_F \\nabla V_{\\text{fit}}[f_k, \\rho]$ contributes a bounded perturbation to the drift of $V_{\\text{total}}$. There exists a **ρ-dependent but N-uniform constant** $K_F(\\rho) < \\infty$ such that:\n1236: \n1237: $$\n1238: \\left| \\left\\langle \\nabla V_{\\text{total}}(S), \\, \\mathbf{F}_{\\text{adapt}}(S) \\right\\rangle \\right| \\le \\epsilon_F K_F(\\rho) (V_{\\text{total}}(S) + 1)\n1239: $$\n1240: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 6. Boundedness of the Adaptive Perturbations"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-viscous-dissipative",
      "title": "Dissipative Contribution from Viscous Force",
      "start_line": 1315,
      "end_line": 1337,
      "header_lines": [
        1316
      ],
      "content_start": 1318,
      "content_end": 1336,
      "content": "1318: :label: lem-viscous-dissipative\n1319: \n1320: The normalized viscous force\n1321: \n1322: $$\n1323: \\mathbf{F}_{\\text{viscous}} = \\nu \\sum_{j \\neq i} \\frac{K(x_i - x_j)}{\\deg(i)} (v_j - v_i)\n1324: $$\n1325: \n1326: contributes a **negative** (dissipative) term to the Stratonovich drift of $V_{\\text{Var},v}$:\n1327: \n1328: $$\n1329: A_{\\text{viscous}}(V_{\\text{Var},v}) = -\\nu \\mathcal{D}_{\\text{visc}}(S) \\le 0\n1330: $$\n1331: \n1332: where\n1333: \n1334: $$\n1335: \\mathcal{D}_{\\text{visc}}(S) := \\frac{1}{N} \\sum_{i < j} K(x_i - x_j) \\left[ \\frac{1}{\\deg(i)} + \\frac{1}{\\deg(j)} \\right] \\|v_i - v_j\\|^2 \\ge 0\n1336: $$",
      "metadata": {
        "label": "lem-viscous-dissipative"
      },
      "section": "## 6. Boundedness of the Adaptive Perturbations",
      "raw_directive": "1315: ### 6.3. Dissipativity of the Viscous Force\n1316: \n1317: :::{prf:lemma} Dissipative Contribution from Viscous Force\n1318: :label: lem-viscous-dissipative\n1319: \n1320: The normalized viscous force\n1321: \n1322: $$\n1323: \\mathbf{F}_{\\text{viscous}} = \\nu \\sum_{j \\neq i} \\frac{K(x_i - x_j)}{\\deg(i)} (v_j - v_i)\n1324: $$\n1325: \n1326: contributes a **negative** (dissipative) term to the Stratonovich drift of $V_{\\text{Var},v}$:\n1327: \n1328: $$\n1329: A_{\\text{viscous}}(V_{\\text{Var},v}) = -\\nu \\mathcal{D}_{\\text{visc}}(S) \\le 0\n1330: $$\n1331: \n1332: where\n1333: \n1334: $$\n1335: \\mathcal{D}_{\\text{visc}}(S) := \\frac{1}{N} \\sum_{i < j} K(x_i - x_j) \\left[ \\frac{1}{\\deg(i)} + \\frac{1}{\\deg(j)} \\right] \\|v_i - v_j\\|^2 \\ge 0\n1336: $$\n1337: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 6. Boundedness of the Adaptive Perturbations"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-diffusion-bounded",
      "title": "Bounded Change from Adaptive Diffusion",
      "start_line": 1393,
      "end_line": 1403,
      "header_lines": [
        1394
      ],
      "content_start": 1396,
      "content_end": 1402,
      "content": "1396: :label: lem-diffusion-bounded\n1397: \n1398: Replacing the constant diffusion $\\sigma I$ with the adaptive diffusion $\\Sigma_{\\text{reg}}(x, S)$ results in a bounded change to the drift. The diffusion contribution $A_{\\text{diff}}(S)$ from Definition [](#def-strat-drift) satisfies:\n1399: \n1400: $$\n1401: |A_{\\text{diff}}(S)| \\le C_{\\text{diff}} < \\infty\n1402: $$",
      "metadata": {
        "label": "lem-diffusion-bounded"
      },
      "section": "## 6. Boundedness of the Adaptive Perturbations",
      "raw_directive": "1393: ### 6.4. Boundedness of the Diffusion Perturbation\n1394: \n1395: :::{prf:lemma} Bounded Change from Adaptive Diffusion\n1396: :label: lem-diffusion-bounded\n1397: \n1398: Replacing the constant diffusion $\\sigma I$ with the adaptive diffusion $\\Sigma_{\\text{reg}}(x, S)$ results in a bounded change to the drift. The diffusion contribution $A_{\\text{diff}}(S)$ from Definition [](#def-strat-drift) satisfies:\n1399: \n1400: $$\n1401: |A_{\\text{diff}}(S)| \\le C_{\\text{diff}} < \\infty\n1402: $$\n1403: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 6. Boundedness of the Adaptive Perturbations"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-dissipation-decomp",
      "title": "Decomposition of Entropy Dissipation",
      "start_line": 2269,
      "end_line": 2284,
      "header_lines": [
        2270
      ],
      "content_start": 2272,
      "content_end": 2283,
      "content": "2272: :label: lem-dissipation-decomp\n2273: \n2274: The total entropy dissipation can be decomposed as:\n2275: \n2276: $$\n2277: D(f) = D_{\\text{kin}}(f) + D_{\\text{clone}}(f) + D_{\\text{boundary}}(f)\n2278: $$\n2279: \n2280: where:\n2281: - $D_{\\text{kin}}(f) = \\int f \\|\\nabla_v \\log(f / \\rho_{\\text{QSD}})\\|^2_{G_{\\text{reg}}} \\, dx \\, dv$ is the kinetic dissipation.\n2282: - $D_{\\text{clone}}(f) \\ge 0$ is the dissipation from the selection/cloning mechanism.\n2283: - $D_{\\text{boundary}}(f) \\ge 0$ is the dissipation from boundary flux.",
      "metadata": {
        "label": "lem-dissipation-decomp"
      },
      "section": "## 9. Main Convergence Theorems and Physical Interpretation",
      "raw_directive": "2269: **Step 1: Decomposition of Entropy Dissipation**\n2270: \n2271: :::{prf:lemma} Decomposition of Entropy Dissipation\n2272: :label: lem-dissipation-decomp\n2273: \n2274: The total entropy dissipation can be decomposed as:\n2275: \n2276: $$\n2277: D(f) = D_{\\text{kin}}(f) + D_{\\text{clone}}(f) + D_{\\text{boundary}}(f)\n2278: $$\n2279: \n2280: where:\n2281: - $D_{\\text{kin}}(f) = \\int f \\|\\nabla_v \\log(f / \\rho_{\\text{QSD}})\\|^2_{G_{\\text{reg}}} \\, dx \\, dv$ is the kinetic dissipation.\n2282: - $D_{\\text{clone}}(f) \\ge 0$ is the dissipation from the selection/cloning mechanism.\n2283: - $D_{\\text{boundary}}(f) \\ge 0$ is the dissipation from boundary flux.\n2284: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 9. Main Convergence Theorems and Physical Interpretation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-micro-coercivity",
      "title": "Microscopic Coercivity (Step A)",
      "start_line": 2302,
      "end_line": 2312,
      "header_lines": [
        2303
      ],
      "content_start": 2305,
      "content_end": 2311,
      "content": "2305: :label: lem-micro-coercivity\n2306: \n2307: There exists $\\lambda_{\\text{mic}} > 0$ such that:\n2308: \n2309: $$\n2310: D_{\\text{kin}}(h \\cdot \\rho_{\\text{QSD}}) \\ge \\lambda_{\\text{mic}} \\|(I - \\Pi) h\\|^2_{L^2(\\rho_{\\text{QSD}})}\n2311: $$",
      "metadata": {
        "label": "lem-micro-coercivity"
      },
      "section": "## 9. Main Convergence Theorems and Physical Interpretation",
      "raw_directive": "2302: The core technical work involves proving three lemmas:\n2303: \n2304: :::{prf:lemma} Microscopic Coercivity (Step A)\n2305: :label: lem-micro-coercivity\n2306: \n2307: There exists $\\lambda_{\\text{mic}} > 0$ such that:\n2308: \n2309: $$\n2310: D_{\\text{kin}}(h \\cdot \\rho_{\\text{QSD}}) \\ge \\lambda_{\\text{mic}} \\|(I - \\Pi) h\\|^2_{L^2(\\rho_{\\text{QSD}})}\n2311: $$\n2312: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 9. Main Convergence Theorems and Physical Interpretation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-macro-transport",
      "title": "Macroscopic Transport (Step B)",
      "start_line": 2314,
      "end_line": 2324,
      "header_lines": [
        2315
      ],
      "content_start": 2317,
      "content_end": 2323,
      "content": "2317: :label: lem-macro-transport\n2318: \n2319: There exists $C_1 > 0$ such that:\n2320: \n2321: $$\n2322: \\|\\Pi h\\|^2_{L^2(\\rho_{\\text{QSD}})} \\le C_1 \\left| \\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2(\\rho_{\\text{QSD}})} \\right|\n2323: $$",
      "metadata": {
        "label": "lem-macro-transport"
      },
      "section": "## 9. Main Convergence Theorems and Physical Interpretation",
      "raw_directive": "2314: :::\n2315: \n2316: :::{prf:lemma} Macroscopic Transport (Step B)\n2317: :label: lem-macro-transport\n2318: \n2319: There exists $C_1 > 0$ such that:\n2320: \n2321: $$\n2322: \\|\\Pi h\\|^2_{L^2(\\rho_{\\text{QSD}})} \\le C_1 \\left| \\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2(\\rho_{\\text{QSD}})} \\right|\n2323: $$\n2324: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 9. Main Convergence Theorems and Physical Interpretation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-micro-reg",
      "title": "Microscopic Regularization (Step C)",
      "start_line": 2326,
      "end_line": 2336,
      "header_lines": [
        2327
      ],
      "content_start": 2329,
      "content_end": 2335,
      "content": "2329: :label: lem-micro-reg\n2330: \n2331: There exists $C_2 > 0$ such that:\n2332: \n2333: $$\n2334: \\left| \\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2(\\rho_{\\text{QSD}})} \\right| \\le C_2 \\sqrt{D_{\\text{kin}}(h \\cdot \\rho_{\\text{QSD}})}\n2335: $$",
      "metadata": {
        "label": "lem-micro-reg"
      },
      "section": "## 9. Main Convergence Theorems and Physical Interpretation",
      "raw_directive": "2326: :::\n2327: \n2328: :::{prf:lemma} Microscopic Regularization (Step C)\n2329: :label: lem-micro-reg\n2330: \n2331: There exists $C_2 > 0$ such that:\n2332: \n2333: $$\n2334: \\left| \\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2(\\rho_{\\text{QSD}})} \\right| \\le C_2 \\sqrt{D_{\\text{kin}}(h \\cdot \\rho_{\\text{QSD}})}\n2335: $$\n2336: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 9. Main Convergence Theorems and Physical Interpretation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-weight-derivatives",
      "title": "Derivatives of Localization Weights",
      "start_line": 2548,
      "end_line": 2582,
      "header_lines": [
        2549
      ],
      "content_start": 2551,
      "content_end": 2581,
      "content": "2551: :label: lem-weight-derivatives\n2552: \n2553: The localization weights $w_{ij}(\\rho)$ satisfy:\n2554: \n2555: **First Derivative:**\n2556: \n2557: $$\n2558: \\nabla_{x_i} w_{ij}(\\rho) = \\frac{1}{Z_i(\\rho)} \\left[ \\nabla_{x_i} K_\\rho(x_i, x_j) - w_{ij}(\\rho) \\sum_{\\ell \\in A_k} \\nabla_{x_i} K_\\rho(x_i, x_\\ell) \\right]\n2559: $$\n2560: \n2561: where $Z_i(\\rho) = \\sum_{\\ell \\in A_k} K_\\rho(x_i, x_\\ell)$ is the normalization **over alive walkers only**.\n2562: \n2563: **Bound:**\n2564: \n2565: $$\n2566: \\|\\nabla_{x_i} w_{ij}(\\rho)\\| \\le \\frac{2C_{\\nabla K}(\\rho)}{\\rho}\n2567: $$\n2568: \n2569: **Second Derivative:** The Hessian $\\nabla^2_{x_i} w_{ij}(\\rho)$ involves terms with $\\nabla^2 K_\\rho$, $(\\nabla K_\\rho) \\otimes (\\nabla K_\\rho)$, and products of weights. It satisfies:\n2570: \n2571: $$\n2572: \\|\\nabla^2_{x_i} w_{ij}(\\rho)\\| \\le C_w(\\rho) := \\frac{C_{\\nabla^2 K}(\\rho)}{\\rho^2} + \\frac{4C_{\\nabla K}(\\rho)^2}{\\rho^2}\n2573: $$\n2574: \n2575: **Proof:**\n2576: The first derivative follows from the quotient rule applied to $w_{ij} = K_\\rho(x_i, x_j) / Z_i(\\rho)$. The bound uses $\\sum_k w_{ik} = 1$ and the triangle inequality.\n2577: \n2578: The second derivative involves differentiating the quotient rule expression, yielding terms of the form:\n2579: - $\\nabla^2 K_\\rho / Z_i$ (bounded by $C_{\\nabla^2 K}/\\rho^2$)\n2580: - $(\\nabla K_\\rho) \\otimes (\\nabla K_\\rho) / Z_i^2$ (bounded by $C_{\\nabla K}^2/\\rho^2$ after using $Z_i \\ge 1/N$)\n2581: - Products involving $w_{ij}$ and sums over $k$",
      "metadata": {
        "label": "lem-weight-derivatives"
      },
      "section": "## Appendix A: Regularity of the ρ-Localized Fitness Potential",
      "raw_directive": "2548: Before tackling the full derivatives, we establish bounds on the derivatives of the weighted sums.\n2549: \n2550: :::{prf:lemma} Derivatives of Localization Weights\n2551: :label: lem-weight-derivatives\n2552: \n2553: The localization weights $w_{ij}(\\rho)$ satisfy:\n2554: \n2555: **First Derivative:**\n2556: \n2557: $$\n2558: \\nabla_{x_i} w_{ij}(\\rho) = \\frac{1}{Z_i(\\rho)} \\left[ \\nabla_{x_i} K_\\rho(x_i, x_j) - w_{ij}(\\rho) \\sum_{\\ell \\in A_k} \\nabla_{x_i} K_\\rho(x_i, x_\\ell) \\right]\n2559: $$\n2560: \n2561: where $Z_i(\\rho) = \\sum_{\\ell \\in A_k} K_\\rho(x_i, x_\\ell)$ is the normalization **over alive walkers only**.\n2562: \n2563: **Bound:**\n2564: \n2565: $$\n2566: \\|\\nabla_{x_i} w_{ij}(\\rho)\\| \\le \\frac{2C_{\\nabla K}(\\rho)}{\\rho}\n2567: $$\n2568: \n2569: **Second Derivative:** The Hessian $\\nabla^2_{x_i} w_{ij}(\\rho)$ involves terms with $\\nabla^2 K_\\rho$, $(\\nabla K_\\rho) \\otimes (\\nabla K_\\rho)$, and products of weights. It satisfies:\n2570: \n2571: $$\n2572: \\|\\nabla^2_{x_i} w_{ij}(\\rho)\\| \\le C_w(\\rho) := \\frac{C_{\\nabla^2 K}(\\rho)}{\\rho^2} + \\frac{4C_{\\nabla K}(\\rho)^2}{\\rho^2}\n2573: $$\n2574: \n2575: **Proof:**\n2576: The first derivative follows from the quotient rule applied to $w_{ij} = K_\\rho(x_i, x_j) / Z_i(\\rho)$. The bound uses $\\sum_k w_{ik} = 1$ and the triangle inequality.\n2577: \n2578: The second derivative involves differentiating the quotient rule expression, yielding terms of the form:\n2579: - $\\nabla^2 K_\\rho / Z_i$ (bounded by $C_{\\nabla^2 K}/\\rho^2$)\n2580: - $(\\nabla K_\\rho) \\otimes (\\nabla K_\\rho) / Z_i^2$ (bounded by $C_{\\nabla K}^2/\\rho^2$ after using $Z_i \\ge 1/N$)\n2581: - Products involving $w_{ij}$ and sums over $k$\n2582: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## Appendix A: Regularity of the ρ-Localized Fitness Potential"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mean-first-derivative",
      "title": "First Derivative of Localized Mean",
      "start_line": 2584,
      "end_line": 2660,
      "header_lines": [
        2585
      ],
      "content_start": 2587,
      "content_end": 2659,
      "content": "2587: :label: lem-mean-first-derivative\n2588: \n2589: The gradient of the localized mean satisfies:\n2590: \n2591: $$\n2592: \\nabla_{x_i} \\mu_\\rho^{(i)} = \\nabla_{x_i} d(x_i) \\cdot w_{ii}(\\rho) + \\sum_{j \\in A_k} d(x_j) \\nabla_{x_i} w_{ij}(\\rho)\n2593: $$\n2594: \n2595: **k-Uniform Bound:**\n2596: \n2597: $$\n2598: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + \\frac{4 d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n2599: $$\n2600: \n2601: **Proof:**\n2602: \n2603: Differentiate $\\mu_\\rho^{(i)} = \\sum_{j \\in A_k} w_{ij}(\\rho) d(x_j)$ using the product rule. The term with $j=i$ contributes $\\nabla d(x_i) \\cdot w_{ii}$. For $j \\ne i$, only the weights depend on $x_i$.\n2604: \n2605: **Step 1: Exploit the Telescoping Property.** Since $\\sum_{j \\in A_k} w_{ij} = 1$ is constant, differentiating yields:\n2606: \n2607: $$\n2608: \\sum_{j \\in A_k} \\nabla_{x_i} w_{ij}(\\rho) = 0\n2609: $$\n2610: \n2611: This is the key telescoping property that enables k-uniformity. Using this identity, we can rewrite:\n2612: \n2613: $$\n2614: \\sum_{j \\in A_k} d(x_j) \\nabla_{x_i} w_{ij}(\\rho) = \\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}(\\rho)\n2615: $$\n2616: \n2617: **Why this matters:** The term $[d(x_j) - d(x_i)]$ is only non-zero when $j \\ne i$, and crucially, it is **localized by the kernel's structure**, not by counting walkers.\n2618: \n2619: **Step 2: Bound Using Kernel Localization.** The gradient $\\nabla_{x_i} w_{ij}(\\rho)$ is significant only when $K_\\rho(x_i, x_j)$ is non-negligible, which requires $\\|x_i - x_j\\| = O(\\rho)$. For such $j$, by smoothness of $d$:\n2620: \n2621: $$\n2622: |d(x_j) - d(x_i)| \\le d'_{\\max} \\|x_j - x_i\\| \\le d'_{\\max} \\cdot C_K \\rho\n2623: $$\n2624: \n2625: where $C_K$ is a constant depending on the kernel's effective radius (e.g., $C_K \\approx 3$ for a Gaussian kernel with 99.7% mass within 3σ).\n2626: \n2627: **Step 3: Apply the Triangle Inequality.** Combining with the bound $\\|\\nabla w_{ij}\\| \\le 2C_{\\nabla K}(\\rho)/\\rho$:\n2628: \n2629: $$\n2630: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}\\right\\| \\le \\sum_{j \\in A_k} |d(x_j) - d(x_i)| \\cdot \\|\\nabla_{x_i} w_{ij}\\|\n2631: $$\n2632: \n2633: Now, **the key insight**: While the sum is over all $k$ alive walkers, the terms are **non-zero only for j in the ρ-neighborhood** of $i$ (by kernel localization). For such $j$:\n2634: \n2635: $$\n2636: |d(x_j) - d(x_i)| \\cdot \\|\\nabla_{x_i} w_{ij}\\| \\le d'_{\\max} C_K \\rho \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = 2d'_{\\max} C_K C_{\\nabla K}(\\rho)\n2637: $$\n2638: \n2639: For walkers outside the ρ-neighborhood, $K_\\rho(x_i, x_j) \\approx 0$, so $\\nabla_{x_i} w_{ij} \\approx 0$ (exponentially small for Gaussian kernels).\n2640: \n2641: **Step 4: Sum the Contributions.** The total bound is:\n2642: \n2643: $$\n2644: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}\\right\\| \\le \\underbrace{\\left[\\text{bound per term}\\right]}_{2d'_{\\max} C_K C_{\\nabla K}(\\rho)} \\cdot \\underbrace{\\left[\\text{sum of weights}\\right]}_{\\sum_{j \\in A_k} w_{ij} = 1}\n2645: $$\n2646: \n2647: The critical observation is that **the weighted sum collapses via telescoping**, not via counting effective walkers. The terms are automatically bounded by the normalization $\\sum w_{ij} = 1$, independent of $k$.\n2648: \n2649: **Step 5: Final Bound.** Including the diagonal term $\\nabla d(x_i) \\cdot w_{ii}$:\n2650: \n2651: $$\n2652: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + 2d'_{\\max} C_K C_{\\nabla K}(\\rho)\n2653: $$\n2654: \n2655: For a conservative bound, we absorb $C_K$ into a rescaled constant and use $|d(x_j)| \\le d_{\\max}$ directly (without telescoping for the outer triangle inequality):\n2656: \n2657: $$\n2658: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + \\frac{4 d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n2659: $$",
      "metadata": {
        "label": "lem-mean-first-derivative"
      },
      "section": "## Appendix A: Regularity of the ρ-Localized Fitness Potential",
      "raw_directive": "2584: :::\n2585: \n2586: :::{prf:lemma} First Derivative of Localized Mean\n2587: :label: lem-mean-first-derivative\n2588: \n2589: The gradient of the localized mean satisfies:\n2590: \n2591: $$\n2592: \\nabla_{x_i} \\mu_\\rho^{(i)} = \\nabla_{x_i} d(x_i) \\cdot w_{ii}(\\rho) + \\sum_{j \\in A_k} d(x_j) \\nabla_{x_i} w_{ij}(\\rho)\n2593: $$\n2594: \n2595: **k-Uniform Bound:**\n2596: \n2597: $$\n2598: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + \\frac{4 d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n2599: $$\n2600: \n2601: **Proof:**\n2602: \n2603: Differentiate $\\mu_\\rho^{(i)} = \\sum_{j \\in A_k} w_{ij}(\\rho) d(x_j)$ using the product rule. The term with $j=i$ contributes $\\nabla d(x_i) \\cdot w_{ii}$. For $j \\ne i$, only the weights depend on $x_i$.\n2604: \n2605: **Step 1: Exploit the Telescoping Property.** Since $\\sum_{j \\in A_k} w_{ij} = 1$ is constant, differentiating yields:\n2606: \n2607: $$\n2608: \\sum_{j \\in A_k} \\nabla_{x_i} w_{ij}(\\rho) = 0\n2609: $$\n2610: \n2611: This is the key telescoping property that enables k-uniformity. Using this identity, we can rewrite:\n2612: \n2613: $$\n2614: \\sum_{j \\in A_k} d(x_j) \\nabla_{x_i} w_{ij}(\\rho) = \\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}(\\rho)\n2615: $$\n2616: \n2617: **Why this matters:** The term $[d(x_j) - d(x_i)]$ is only non-zero when $j \\ne i$, and crucially, it is **localized by the kernel's structure**, not by counting walkers.\n2618: \n2619: **Step 2: Bound Using Kernel Localization.** The gradient $\\nabla_{x_i} w_{ij}(\\rho)$ is significant only when $K_\\rho(x_i, x_j)$ is non-negligible, which requires $\\|x_i - x_j\\| = O(\\rho)$. For such $j$, by smoothness of $d$:\n2620: \n2621: $$\n2622: |d(x_j) - d(x_i)| \\le d'_{\\max} \\|x_j - x_i\\| \\le d'_{\\max} \\cdot C_K \\rho\n2623: $$\n2624: \n2625: where $C_K$ is a constant depending on the kernel's effective radius (e.g., $C_K \\approx 3$ for a Gaussian kernel with 99.7% mass within 3σ).\n2626: \n2627: **Step 3: Apply the Triangle Inequality.** Combining with the bound $\\|\\nabla w_{ij}\\| \\le 2C_{\\nabla K}(\\rho)/\\rho$:\n2628: \n2629: $$\n2630: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}\\right\\| \\le \\sum_{j \\in A_k} |d(x_j) - d(x_i)| \\cdot \\|\\nabla_{x_i} w_{ij}\\|\n2631: $$\n2632: \n2633: Now, **the key insight**: While the sum is over all $k$ alive walkers, the terms are **non-zero only for j in the ρ-neighborhood** of $i$ (by kernel localization). For such $j$:\n2634: \n2635: $$\n2636: |d(x_j) - d(x_i)| \\cdot \\|\\nabla_{x_i} w_{ij}\\| \\le d'_{\\max} C_K \\rho \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = 2d'_{\\max} C_K C_{\\nabla K}(\\rho)\n2637: $$\n2638: \n2639: For walkers outside the ρ-neighborhood, $K_\\rho(x_i, x_j) \\approx 0$, so $\\nabla_{x_i} w_{ij} \\approx 0$ (exponentially small for Gaussian kernels).\n2640: \n2641: **Step 4: Sum the Contributions.** The total bound is:\n2642: \n2643: $$\n2644: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla_{x_i} w_{ij}\\right\\| \\le \\underbrace{\\left[\\text{bound per term}\\right]}_{2d'_{\\max} C_K C_{\\nabla K}(\\rho)} \\cdot \\underbrace{\\left[\\text{sum of weights}\\right]}_{\\sum_{j \\in A_k} w_{ij} = 1}\n2645: $$\n2646: \n2647: The critical observation is that **the weighted sum collapses via telescoping**, not via counting effective walkers. The terms are automatically bounded by the normalization $\\sum w_{ij} = 1$, independent of $k$.\n2648: \n2649: **Step 5: Final Bound.** Including the diagonal term $\\nabla d(x_i) \\cdot w_{ii}$:\n2650: \n2651: $$\n2652: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + 2d'_{\\max} C_K C_{\\nabla K}(\\rho)\n2653: $$\n2654: \n2655: For a conservative bound, we absorb $C_K$ into a rescaled constant and use $|d(x_j)| \\le d_{\\max}$ directly (without telescoping for the outer triangle inequality):\n2656: \n2657: $$\n2658: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le d'_{\\max} + \\frac{4 d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n2659: $$\n2660: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## Appendix A: Regularity of the ρ-Localized Fitness Potential"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mean-second-derivative",
      "title": "Second Derivative of Localized Mean",
      "start_line": 2662,
      "end_line": 2738,
      "header_lines": [
        2663
      ],
      "content_start": 2665,
      "content_end": 2737,
      "content": "2665: :label: lem-mean-second-derivative\n2666: \n2667: The Hessian of the localized mean satisfies:\n2668: \n2669: $$\n2670: \\nabla^2_{x_i} \\mu_\\rho^{(i)} = \\nabla^2_{x_i} d(x_i) \\cdot w_{ii}(\\rho) + 2 \\nabla_{x_i} d(x_i) \\otimes \\nabla_{x_i} w_{ii}(\\rho) + \\sum_{j \\in A_k} d(x_j) \\nabla^2_{x_i} w_{ij}(\\rho)\n2671: $$\n2672: \n2673: **k-Uniform Bound:**\n2674: \n2675: $$\n2676: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} C_w(\\rho)\n2677: $$\n2678: \n2679: **Proof:**\n2680: \n2681: Differentiate the expression from Lemma {prf:ref}`lem-mean-first-derivative`. The diagonal term ($j=i$) contributes $\\nabla^2 d(x_i)$ and $\\nabla d(x_i) \\otimes \\nabla w_{ii}$.\n2682: \n2683: **Step 1: Exploit the Telescoping Property.** Differentiating the constraint $\\sum_{j \\in A_k} w_{ij} = 1$ twice yields:\n2684: \n2685: $$\n2686: \\sum_{j \\in A_k} \\nabla^2_{x_i} w_{ij} = 0\n2687: $$\n2688: \n2689: This telescoping identity allows us to rewrite:\n2690: \n2691: $$\n2692: \\sum_{j \\in A_k} d(x_j) \\nabla^2_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\n2693: $$\n2694: \n2695: **Step 2: Bound Using Kernel Localization.** The Hessian $\\nabla^2_{x_i} w_{ij}$ is significant only when $K_\\rho(x_i, x_j)$ is non-negligible, requiring $\\|x_i - x_j\\| = O(\\rho)$. For such $j$:\n2696: \n2697: $$\n2698: |d(x_j) - d(x_i)| \\le d'_{\\max} C_K \\rho\n2699: $$\n2700: \n2701: where $C_K$ is the kernel's effective radius constant.\n2702: \n2703: **Step 3: Apply the Hessian Bound.** Combining with $\\|\\nabla^2 w_{ij}\\| \\le C_w(\\rho)$ from Lemma {prf:ref}`lem-weight-derivatives`:\n2704: \n2705: $$\n2706: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\\right\\| \\le \\sum_{j \\in A_k} |d(x_j) - d(x_i)| \\cdot \\|\\nabla^2_{x_i} w_{ij}\\|\n2707: $$\n2708: \n2709: For walkers in the ρ-neighborhood (the only ones contributing significantly):\n2710: \n2711: $$\n2712: |d(x_j) - d(x_i)| \\cdot \\|\\nabla^2_{x_i} w_{ij}\\| \\le d'_{\\max} C_K \\rho \\cdot C_w(\\rho)\n2713: $$\n2714: \n2715: **Step 4: Sum via Telescoping.** The weighted sum collapses using the normalization $\\sum_{j \\in A_k} w_{ij} = 1$:\n2716: \n2717: $$\n2718: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\\right\\| \\le d'_{\\max} C_K \\rho \\cdot C_w(\\rho) \\cdot \\underbrace{\\left[\\text{normalized weight sum}\\right]}_{O(1)}\n2719: $$\n2720: \n2721: **Step 5: Final Bound.** For the term $\\nabla d(x_i) \\otimes \\nabla w_{ii}$:\n2722: \n2723: $$\n2724: \\|2 \\nabla_{x_i} d(x_i) \\otimes \\nabla_{x_i} w_{ii}\\| \\le 2d'_{\\max} \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n2725: $$\n2726: \n2727: Combining all terms (diagonal $\\nabla^2 d(x_i)$, cross-term, and the sum):\n2728: \n2729: $$\n2730: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + d'_{\\max} C_K \\rho C_w(\\rho)\n2731: $$\n2732: \n2733: For a conservative bound, we use $|d(x_j)| \\le d_{\\max}$ directly and absorb constants:\n2734: \n2735: $$\n2736: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} C_w(\\rho)\n2737: $$",
      "metadata": {
        "label": "lem-mean-second-derivative"
      },
      "section": "## Appendix A: Regularity of the ρ-Localized Fitness Potential",
      "raw_directive": "2662: :::\n2663: \n2664: :::{prf:lemma} Second Derivative of Localized Mean\n2665: :label: lem-mean-second-derivative\n2666: \n2667: The Hessian of the localized mean satisfies:\n2668: \n2669: $$\n2670: \\nabla^2_{x_i} \\mu_\\rho^{(i)} = \\nabla^2_{x_i} d(x_i) \\cdot w_{ii}(\\rho) + 2 \\nabla_{x_i} d(x_i) \\otimes \\nabla_{x_i} w_{ii}(\\rho) + \\sum_{j \\in A_k} d(x_j) \\nabla^2_{x_i} w_{ij}(\\rho)\n2671: $$\n2672: \n2673: **k-Uniform Bound:**\n2674: \n2675: $$\n2676: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} C_w(\\rho)\n2677: $$\n2678: \n2679: **Proof:**\n2680: \n2681: Differentiate the expression from Lemma {prf:ref}`lem-mean-first-derivative`. The diagonal term ($j=i$) contributes $\\nabla^2 d(x_i)$ and $\\nabla d(x_i) \\otimes \\nabla w_{ii}$.\n2682: \n2683: **Step 1: Exploit the Telescoping Property.** Differentiating the constraint $\\sum_{j \\in A_k} w_{ij} = 1$ twice yields:\n2684: \n2685: $$\n2686: \\sum_{j \\in A_k} \\nabla^2_{x_i} w_{ij} = 0\n2687: $$\n2688: \n2689: This telescoping identity allows us to rewrite:\n2690: \n2691: $$\n2692: \\sum_{j \\in A_k} d(x_j) \\nabla^2_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\n2693: $$\n2694: \n2695: **Step 2: Bound Using Kernel Localization.** The Hessian $\\nabla^2_{x_i} w_{ij}$ is significant only when $K_\\rho(x_i, x_j)$ is non-negligible, requiring $\\|x_i - x_j\\| = O(\\rho)$. For such $j$:\n2696: \n2697: $$\n2698: |d(x_j) - d(x_i)| \\le d'_{\\max} C_K \\rho\n2699: $$\n2700: \n2701: where $C_K$ is the kernel's effective radius constant.\n2702: \n2703: **Step 3: Apply the Hessian Bound.** Combining with $\\|\\nabla^2 w_{ij}\\| \\le C_w(\\rho)$ from Lemma {prf:ref}`lem-weight-derivatives`:\n2704: \n2705: $$\n2706: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\\right\\| \\le \\sum_{j \\in A_k} |d(x_j) - d(x_i)| \\cdot \\|\\nabla^2_{x_i} w_{ij}\\|\n2707: $$\n2708: \n2709: For walkers in the ρ-neighborhood (the only ones contributing significantly):\n2710: \n2711: $$\n2712: |d(x_j) - d(x_i)| \\cdot \\|\\nabla^2_{x_i} w_{ij}\\| \\le d'_{\\max} C_K \\rho \\cdot C_w(\\rho)\n2713: $$\n2714: \n2715: **Step 4: Sum via Telescoping.** The weighted sum collapses using the normalization $\\sum_{j \\in A_k} w_{ij} = 1$:\n2716: \n2717: $$\n2718: \\left\\|\\sum_{j \\in A_k} [d(x_j) - d(x_i)] \\nabla^2_{x_i} w_{ij}\\right\\| \\le d'_{\\max} C_K \\rho \\cdot C_w(\\rho) \\cdot \\underbrace{\\left[\\text{normalized weight sum}\\right]}_{O(1)}\n2719: $$\n2720: \n2721: **Step 5: Final Bound.** For the term $\\nabla d(x_i) \\otimes \\nabla w_{ii}$:\n2722: \n2723: $$\n2724: \\|2 \\nabla_{x_i} d(x_i) \\otimes \\nabla_{x_i} w_{ii}\\| \\le 2d'_{\\max} \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\n2725: $$\n2726: \n2727: Combining all terms (diagonal $\\nabla^2 d(x_i)$, cross-term, and the sum):\n2728: \n2729: $$\n2730: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + d'_{\\max} C_K \\rho C_w(\\rho)\n2731: $$\n2732: \n2733: For a conservative bound, we use $|d(x_j)| \\le d_{\\max}$ directly and absorb constants:\n2734: \n2735: $$\n2736: \\|\\nabla^2_{x_i} \\mu_\\rho^{(i)}\\| \\le d''_{\\max} + \\frac{4d'_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} C_w(\\rho)\n2737: $$\n2738: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## Appendix A: Regularity of the ρ-Localized Fitness Potential"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-gradient",
      "title": "k-Uniform Gradient of Localized Variance",
      "start_line": 2740,
      "end_line": 2784,
      "header_lines": [
        2741
      ],
      "content_start": 2743,
      "content_end": 2783,
      "content": "2743: :label: lem-variance-gradient\n2744: \n2745: The gradient of the localized variance satisfies:\n2746: \n2747: $$\n2748: \\|\\nabla_{x_i} V_\\rho^{(i)}\\| \\le C_{V,\\nabla}(\\rho)\n2749: $$\n2750: \n2751: where $C_{V,\\nabla}(\\rho)$ is a ρ-dependent but **k-uniform** constant:\n2752: \n2753: $$\n2754: C_{V,\\nabla}(\\rho) = 4d_{\\max} d'_{\\max} + 4d_{\\max}^2 \\frac{C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} \\left(d'_{\\max} + \\frac{4d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\\right)\n2755: $$\n2756: \n2757: **Proof:**\n2758: \n2759: The variance is $V_\\rho^{(i)} = \\sum_{j \\in A_k} w_{ij} d(x_j)^2 - (\\mu_\\rho^{(i)})^2$. Differentiating:\n2760: \n2761: $$\n2762: \\nabla_{x_i} V_\\rho^{(i)} = \\nabla_{x_i}\\left(\\sum_{j \\in A_k} w_{ij} d(x_j)^2\\right) - 2\\mu_\\rho^{(i)} \\nabla_{x_i} \\mu_\\rho^{(i)}\n2763: $$\n2764: \n2765: **Term 1:** For the first term, apply the telescoping property $\\sum_j \\nabla w_{ij} = 0$:\n2766: \n2767: $$\n2768: \\sum_{j \\in A_k} d(x_j)^2 \\nabla_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla_{x_i} w_{ij}\n2769: $$\n2770: \n2771: Using $|d(x_j)^2 - d(x_i)^2| = |d(x_j) - d(x_i)| \\cdot |d(x_j) + d(x_i)| \\le |d(x_j) - d(x_i)| \\cdot 2d_{\\max}$ and the kernel localization $|d(x_j) - d(x_i)| \\le d'_{\\max} C_K \\rho$:\n2772: \n2773: $$\n2774: \\left\\|\\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla w_{ij}\\right\\| \\le 2d_{\\max} d'_{\\max} C_K \\rho \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = 4d_{\\max} d'_{\\max} C_K C_{\\nabla K}(\\rho)\n2775: $$\n2776: \n2777: The diagonal term contributes $2d(x_i) d'_{\\max} w_{ii} \\le 2d_{\\max} d'_{\\max}$.\n2778: \n2779: **Term 2:** The second term uses the bound from Lemma {prf:ref}`lem-mean-first-derivative`:\n2780: \n2781: $$\n2782: \\|2\\mu_\\rho^{(i)} \\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le 2d_{\\max} \\left(d'_{\\max} + \\frac{4d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\\right)\n2783: $$",
      "metadata": {
        "label": "lem-variance-gradient"
      },
      "section": "## Appendix A: Regularity of the ρ-Localized Fitness Potential",
      "raw_directive": "2740: :::\n2741: \n2742: :::{prf:lemma} k-Uniform Gradient of Localized Variance\n2743: :label: lem-variance-gradient\n2744: \n2745: The gradient of the localized variance satisfies:\n2746: \n2747: $$\n2748: \\|\\nabla_{x_i} V_\\rho^{(i)}\\| \\le C_{V,\\nabla}(\\rho)\n2749: $$\n2750: \n2751: where $C_{V,\\nabla}(\\rho)$ is a ρ-dependent but **k-uniform** constant:\n2752: \n2753: $$\n2754: C_{V,\\nabla}(\\rho) = 4d_{\\max} d'_{\\max} + 4d_{\\max}^2 \\frac{C_{\\nabla K}(\\rho)}{\\rho} + 2d_{\\max} \\left(d'_{\\max} + \\frac{4d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\\right)\n2755: $$\n2756: \n2757: **Proof:**\n2758: \n2759: The variance is $V_\\rho^{(i)} = \\sum_{j \\in A_k} w_{ij} d(x_j)^2 - (\\mu_\\rho^{(i)})^2$. Differentiating:\n2760: \n2761: $$\n2762: \\nabla_{x_i} V_\\rho^{(i)} = \\nabla_{x_i}\\left(\\sum_{j \\in A_k} w_{ij} d(x_j)^2\\right) - 2\\mu_\\rho^{(i)} \\nabla_{x_i} \\mu_\\rho^{(i)}\n2763: $$\n2764: \n2765: **Term 1:** For the first term, apply the telescoping property $\\sum_j \\nabla w_{ij} = 0$:\n2766: \n2767: $$\n2768: \\sum_{j \\in A_k} d(x_j)^2 \\nabla_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla_{x_i} w_{ij}\n2769: $$\n2770: \n2771: Using $|d(x_j)^2 - d(x_i)^2| = |d(x_j) - d(x_i)| \\cdot |d(x_j) + d(x_i)| \\le |d(x_j) - d(x_i)| \\cdot 2d_{\\max}$ and the kernel localization $|d(x_j) - d(x_i)| \\le d'_{\\max} C_K \\rho$:\n2772: \n2773: $$\n2774: \\left\\|\\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla w_{ij}\\right\\| \\le 2d_{\\max} d'_{\\max} C_K \\rho \\cdot \\frac{2C_{\\nabla K}(\\rho)}{\\rho} = 4d_{\\max} d'_{\\max} C_K C_{\\nabla K}(\\rho)\n2775: $$\n2776: \n2777: The diagonal term contributes $2d(x_i) d'_{\\max} w_{ii} \\le 2d_{\\max} d'_{\\max}$.\n2778: \n2779: **Term 2:** The second term uses the bound from Lemma {prf:ref}`lem-mean-first-derivative`:\n2780: \n2781: $$\n2782: \\|2\\mu_\\rho^{(i)} \\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\le 2d_{\\max} \\left(d'_{\\max} + \\frac{4d_{\\max} C_{\\nabla K}(\\rho)}{\\rho}\\right)\n2783: $$\n2784: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## Appendix A: Regularity of the ρ-Localized Fitness Potential"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-hessian",
      "title": "k-Uniform Hessian of Localized Variance",
      "start_line": 2786,
      "end_line": 2812,
      "header_lines": [
        2787
      ],
      "content_start": 2789,
      "content_end": 2811,
      "content": "2789: :label: lem-variance-hessian\n2790: \n2791: The Hessian of the localized variance satisfies:\n2792: \n2793: $$\n2794: \\|\\nabla^2_{x_i} V_\\rho^{(i)}\\| \\le C_{V,\\nabla^2}(\\rho)\n2795: $$\n2796: \n2797: where $C_{V,\\nabla^2}(\\rho)$ is a ρ-dependent but **k-uniform** constant involving $d''_{\\max}$, $C_{\\nabla K}(\\rho)/\\rho$, $C_w(\\rho)$, and the first-order bounds.\n2798: \n2799: **Proof:**\n2800: \n2801: Differentiate the expression from Lemma {prf:ref}`lem-variance-gradient`. Apply the telescoping property $\\sum_j \\nabla^2 w_{ij} = 0$ to:\n2802: \n2803: $$\n2804: \\sum_{j \\in A_k} d(x_j)^2 \\nabla^2_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla^2_{x_i} w_{ij}\n2805: $$\n2806: \n2807: Using kernel localization and the bound $\\|\\nabla^2 w_{ij}\\| \\le C_w(\\rho)$, the sum collapses via the normalization constraint. The second derivative of the product $\\mu_\\rho^2$ involves:\n2808: \n2809: $$\n2810: \\nabla^2(\\mu_\\rho^2) = 2(\\nabla \\mu_\\rho) \\otimes (\\nabla \\mu_\\rho) + 2\\mu_\\rho \\nabla^2 \\mu_\\rho\n2811: $$",
      "metadata": {
        "label": "lem-variance-hessian"
      },
      "section": "## Appendix A: Regularity of the ρ-Localized Fitness Potential",
      "raw_directive": "2786: :::\n2787: \n2788: :::{prf:lemma} k-Uniform Hessian of Localized Variance\n2789: :label: lem-variance-hessian\n2790: \n2791: The Hessian of the localized variance satisfies:\n2792: \n2793: $$\n2794: \\|\\nabla^2_{x_i} V_\\rho^{(i)}\\| \\le C_{V,\\nabla^2}(\\rho)\n2795: $$\n2796: \n2797: where $C_{V,\\nabla^2}(\\rho)$ is a ρ-dependent but **k-uniform** constant involving $d''_{\\max}$, $C_{\\nabla K}(\\rho)/\\rho$, $C_w(\\rho)$, and the first-order bounds.\n2798: \n2799: **Proof:**\n2800: \n2801: Differentiate the expression from Lemma {prf:ref}`lem-variance-gradient`. Apply the telescoping property $\\sum_j \\nabla^2 w_{ij} = 0$ to:\n2802: \n2803: $$\n2804: \\sum_{j \\in A_k} d(x_j)^2 \\nabla^2_{x_i} w_{ij} = \\sum_{j \\in A_k} [d(x_j)^2 - d(x_i)^2] \\nabla^2_{x_i} w_{ij}\n2805: $$\n2806: \n2807: Using kernel localization and the bound $\\|\\nabla^2 w_{ij}\\| \\le C_w(\\rho)$, the sum collapses via the normalization constraint. The second derivative of the product $\\mu_\\rho^2$ involves:\n2808: \n2809: $$\n2810: \\nabla^2(\\mu_\\rho^2) = 2(\\nabla \\mu_\\rho) \\otimes (\\nabla \\mu_\\rho) + 2\\mu_\\rho \\nabla^2 \\mu_\\rho\n2811: $$\n2812: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## Appendix A: Regularity of the ρ-Localized Fitness Potential"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-to-gap-adaptive",
      "title": "Variance-to-Gap (from 03_cloning.md, Lemma 7.3.1)",
      "start_line": 3157,
      "end_line": 3167,
      "header_lines": [
        3158
      ],
      "content_start": 3160,
      "content_end": 3166,
      "content": "3160: :label: lem-variance-to-gap-adaptive\n3161: \n3162: For any random variable $X$ with mean $\\mu$ and variance $\\sigma^2 > 0$:\n3163: \n3164: $$\n3165: \\max_{x \\in \\text{supp}(X)} |x - \\mu| \\ge \\sigma\n3166: $$",
      "metadata": {
        "label": "lem-variance-to-gap-adaptive"
      },
      "section": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model",
      "raw_directive": "3157: #### B.3.1. The Variance-to-Gap Lemma (Universal)\n3158: \n3159: :::{prf:lemma} Variance-to-Gap (from 03_cloning.md, Lemma 7.3.1)\n3160: :label: lem-variance-to-gap-adaptive\n3161: \n3162: For any random variable $X$ with mean $\\mu$ and variance $\\sigma^2 > 0$:\n3163: \n3164: $$\n3165: \\max_{x \\in \\text{supp}(X)} |x - \\mu| \\ge \\sigma\n3166: $$\n3167: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-rho-pipeline-bounds",
      "title": "Uniform Bounds on the ρ-Localized Pipeline",
      "start_line": 3173,
      "end_line": 3205,
      "header_lines": [
        3174
      ],
      "content_start": 3176,
      "content_end": 3204,
      "content": "3176: :label: lem-rho-pipeline-bounds\n3177: \n3178: For the ρ-localized rescaling pipeline with bounded measurements $d \\in [0, d_{\\max}]$:\n3179: \n3180: **1. Upper Bound on Localized Standard Deviation:**\n3181: \n3182: $$\n3183: \\sigma'_\\rho[f, d, x] \\le \\sigma'_{\\rho,\\max} := d_{\\max}\n3184: $$\n3185: \n3186: for all $f, x, \\rho$. This bound is **N-uniform** and **ρ-dependent** (it could be tighter for specific ρ, but this worst-case bound suffices).\n3187: \n3188: **2. Lower Bound on Rescale Derivative:**\n3189: \n3190: $$\n3191: g'_A(z) \\ge g'_{\\min} > 0\n3192: $$\n3193: \n3194: for all $z \\in \\mathbb{R}$, where $g_A$ is the smooth, monotone rescale function. This bound is **ρ-independent**.\n3195: \n3196: **Proof:**\n3197: \n3198: **Part 1:** The localized standard deviation is bounded by the range of the measurement function:\n3199: \n3200: $$\n3201: \\sigma'_\\rho[f, d, x] = \\max\\{\\sigma_\\rho[f, d, x], \\kappa_{\\text{var,min}}\\} \\le \\max_{x \\in \\mathcal{X}} d(x) = d_{\\max}\n3202: $$\n3203: \n3204: This holds for all ρ because even in the hyper-local limit, the standard deviation of bounded measurements remains bounded.",
      "metadata": {
        "label": "lem-rho-pipeline-bounds"
      },
      "section": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model",
      "raw_directive": "3173: #### B.3.2. Uniform Bounds on ρ-Dependent Pipeline Components\n3174: \n3175: :::{prf:lemma} Uniform Bounds on the ρ-Localized Pipeline\n3176: :label: lem-rho-pipeline-bounds\n3177: \n3178: For the ρ-localized rescaling pipeline with bounded measurements $d \\in [0, d_{\\max}]$:\n3179: \n3180: **1. Upper Bound on Localized Standard Deviation:**\n3181: \n3182: $$\n3183: \\sigma'_\\rho[f, d, x] \\le \\sigma'_{\\rho,\\max} := d_{\\max}\n3184: $$\n3185: \n3186: for all $f, x, \\rho$. This bound is **N-uniform** and **ρ-dependent** (it could be tighter for specific ρ, but this worst-case bound suffices).\n3187: \n3188: **2. Lower Bound on Rescale Derivative:**\n3189: \n3190: $$\n3191: g'_A(z) \\ge g'_{\\min} > 0\n3192: $$\n3193: \n3194: for all $z \\in \\mathbb{R}$, where $g_A$ is the smooth, monotone rescale function. This bound is **ρ-independent**.\n3195: \n3196: **Proof:**\n3197: \n3198: **Part 1:** The localized standard deviation is bounded by the range of the measurement function:\n3199: \n3200: $$\n3201: \\sigma'_\\rho[f, d, x] = \\max\\{\\sigma_\\rho[f, d, x], \\kappa_{\\text{var,min}}\\} \\le \\max_{x \\in \\mathcal{X}} d(x) = d_{\\max}\n3202: $$\n3203: \n3204: This holds for all ρ because even in the hyper-local limit, the standard deviation of bounded measurements remains bounded.\n3205: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-raw-to-rescaled-gap-rho",
      "title": "Raw-Gap to Rescaled-Gap for ρ-Localized Pipeline",
      "start_line": 3209,
      "end_line": 3249,
      "header_lines": [
        3210
      ],
      "content_start": 3212,
      "content_end": 3248,
      "content": "3212: :label: lem-raw-to-rescaled-gap-rho\n3213: \n3214: If the raw measurements satisfy:\n3215: \n3216: $$\n3217: \\max_{i \\in \\{1, \\ldots, N\\}} |d_i - \\mu_\\rho[f_k, d, x_{\\text{ref}}]| \\ge \\kappa_{\\text{raw}}\n3218: $$\n3219: \n3220: for some reference point $x_{\\text{ref}}$ and raw gap $\\kappa_{\\text{raw}} > 0$, then the rescaled measurements satisfy:\n3221: \n3222: $$\n3223: \\max_{i \\in \\{1, \\ldots, N\\}} |d'_i - \\mu[d']| \\ge \\kappa_{\\text{rescaled}}(\\kappa_{\\text{raw}}, \\rho)\n3224: $$\n3225: \n3226: where:\n3227: \n3228: $$\n3229: \\kappa_{\\text{rescaled}}(\\kappa_{\\text{raw}}, \\rho) := g'_{\\min} \\cdot \\frac{\\kappa_{\\text{raw}}}{\\sigma'_{\\rho,\\max}}\n3230: $$\n3231: \n3232: **Proof:** By the Mean Value Theorem applied to the composition $d'_i = g_A(Z_\\rho[f_k, d, x_i])$:\n3233: \n3234: $$\n3235: |d'_i - d'_j| \\ge g'_{\\min} \\cdot |Z_\\rho[f_k, d, x_i] - Z_\\rho[f_k, d, x_j]|\n3236: $$\n3237: \n3238: The Z-score difference satisfies:\n3239: \n3240: $$\n3241: |Z_\\rho[f_k, d, x_i] - Z_\\rho[f_k, d, x_j]| \\ge \\frac{|d_i - d_j|}{\\sigma'_{\\rho,\\max}}\n3242: $$\n3243: \n3244: Combining these and using the raw gap:\n3245: \n3246: $$\n3247: \\max_{i,j} |d'_i - d'_j| \\ge g'_{\\min} \\cdot \\frac{\\kappa_{\\text{raw}}}{\\sigma'_{\\rho,\\max}}\n3248: $$",
      "metadata": {
        "label": "lem-raw-to-rescaled-gap-rho"
      },
      "section": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model",
      "raw_directive": "3209: #### B.3.3. Raw-Gap to Rescaled-Gap Propagation (ρ-Dependent)\n3210: \n3211: :::{prf:lemma} Raw-Gap to Rescaled-Gap for ρ-Localized Pipeline\n3212: :label: lem-raw-to-rescaled-gap-rho\n3213: \n3214: If the raw measurements satisfy:\n3215: \n3216: $$\n3217: \\max_{i \\in \\{1, \\ldots, N\\}} |d_i - \\mu_\\rho[f_k, d, x_{\\text{ref}}]| \\ge \\kappa_{\\text{raw}}\n3218: $$\n3219: \n3220: for some reference point $x_{\\text{ref}}$ and raw gap $\\kappa_{\\text{raw}} > 0$, then the rescaled measurements satisfy:\n3221: \n3222: $$\n3223: \\max_{i \\in \\{1, \\ldots, N\\}} |d'_i - \\mu[d']| \\ge \\kappa_{\\text{rescaled}}(\\kappa_{\\text{raw}}, \\rho)\n3224: $$\n3225: \n3226: where:\n3227: \n3228: $$\n3229: \\kappa_{\\text{rescaled}}(\\kappa_{\\text{raw}}, \\rho) := g'_{\\min} \\cdot \\frac{\\kappa_{\\text{raw}}}{\\sigma'_{\\rho,\\max}}\n3230: $$\n3231: \n3232: **Proof:** By the Mean Value Theorem applied to the composition $d'_i = g_A(Z_\\rho[f_k, d, x_i])$:\n3233: \n3234: $$\n3235: |d'_i - d'_j| \\ge g'_{\\min} \\cdot |Z_\\rho[f_k, d, x_i] - Z_\\rho[f_k, d, x_j]|\n3236: $$\n3237: \n3238: The Z-score difference satisfies:\n3239: \n3240: $$\n3241: |Z_\\rho[f_k, d, x_i] - Z_\\rho[f_k, d, x_j]| \\ge \\frac{|d_i - d_j|}{\\sigma'_{\\rho,\\max}}\n3242: $$\n3243: \n3244: Combining these and using the raw gap:\n3245: \n3246: $$\n3247: \\max_{i,j} |d'_i - d'_j| \\ge g'_{\\min} \\cdot \\frac{\\kappa_{\\text{raw}}}{\\sigma'_{\\rho,\\max}}\n3248: $$\n3249: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-log-gap-bounds-adaptive",
      "title": "Logarithmic Gap Bounds (from 03_cloning.md, Lemma 7.5.1)",
      "start_line": 3265,
      "end_line": 3283,
      "header_lines": [
        3266
      ],
      "content_start": 3268,
      "content_end": 3282,
      "content": "3268: :label: lem-log-gap-bounds-adaptive\n3269: \n3270: For any random variable $X \\in [a, b]$ with mean $\\mu$ and $a < \\mu < b$:\n3271: \n3272: **Lower Bound:**\n3273: \n3274: $$\n3275: \\mathbb{E}[\\log X] \\le \\log \\mu\n3276: $$\n3277: \n3278: **Upper Bound (Gap to Extremal Point):**\n3279: \n3280: $$\n3281: |\\log b - \\mathbb{E}[\\log X]| \\ge \\log(b) - \\log(\\mu)\n3282: $$",
      "metadata": {
        "label": "lem-log-gap-bounds-adaptive"
      },
      "section": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model",
      "raw_directive": "3265: #### B.4.1. Foundational Statistical Lemmas (ρ-Independent)\n3266: \n3267: :::{prf:lemma} Logarithmic Gap Bounds (from 03_cloning.md, Lemma 7.5.1)\n3268: :label: lem-log-gap-bounds-adaptive\n3269: \n3270: For any random variable $X \\in [a, b]$ with mean $\\mu$ and $a < \\mu < b$:\n3271: \n3272: **Lower Bound:**\n3273: \n3274: $$\n3275: \\mathbb{E}[\\log X] \\le \\log \\mu\n3276: $$\n3277: \n3278: **Upper Bound (Gap to Extremal Point):**\n3279: \n3280: $$\n3281: |\\log b - \\mathbb{E}[\\log X]| \\ge \\log(b) - \\log(\\mu)\n3282: $$\n3283: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mass-contraction-revival-death",
      "title": "Mass Contraction via Revival and Death",
      "start_line": 181,
      "end_line": 221,
      "header_lines": [
        182
      ],
      "content_start": 184,
      "content_end": 220,
      "content": "184: :label: lem-mass-contraction-revival-death\n185: \n186: Let $k_t = \\|\\mu_t\\|$ denote the number of alive walkers at time $t$ (the total mass of the empirical measure). Let $k_* = \\|\\pi_{\\text{QSD}}\\|$ denote the equilibrium alive count under the QSD.\n187: \n188: Assume:\n189: 1. **Birth Mechanism**: The Fragile Gas creates new walkers via two processes:\n190:    - Guaranteed revival of all dead walkers (from {prf:ref}`def-axiom-guaranteed-revival`)\n191:    - Cloning of alive walkers with rate $\\lambda_{\\text{clone}}(k_t)$ per walker\n192: \n193:    Total births: $B_t = (N - k_t) + C_t$ where $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$\n194: \n195: 2. **Death Mechanism**: Boundary exit causes death with rate $\\bar{p}_{\\text{kill}}(k_t)$, giving $\\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(k_t) k_t$\n196: \n197: 3. **QSD Equilibrium**: The equilibrium mass $k_*$ satisfies $(N - k_*) + \\lambda_{\\text{clone}}^* k_* = \\bar{p}_{\\text{kill}}^* k_*$\n198: \n199: 4. **Lipschitz Continuity**: Both $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k)$ are Lipschitz continuous:\n200:    - $|\\lambda_{\\text{clone}}(k_t) - \\lambda_{\\text{clone}}^*| \\leq L_\\lambda |k_t - k_*|$\n201:    - $|\\bar{p}_{\\text{kill}}(k_t) - \\bar{p}_{\\text{kill}}^*| \\leq L_p |k_t - k_*|$\n202: \n203: Then there exist constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$ such that:\n204: \n205: $$\n206: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n207: \n208: $$\n209: \n210: where:\n211: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n212: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n213: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n214: - $L_\\lambda$ is the Lipschitz constant of the cloning rate\n215: - $L_p$ is the Lipschitz constant of the killing rate\n216: - $N$ is the total number of walkers (alive + dead)\n217: \n218: **Assumptions:**\n219: 1. $\\epsilon^2 + \\epsilon < 1$, which requires $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (achieved when $L_p L_\\lambda = O(1/N^2)$ for large $N$)\n220: 2. $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with $L_g^{(2)} = O(N^{-1})$ (natural for density-dependent rates)",
      "metadata": {
        "label": "lem-mass-contraction-revival-death"
      },
      "section": "## 2. Lemma A: Mass Contraction from Revival and Death",
      "raw_directive": "181: This lemma establishes that the combined effect of the revival mechanism (Axiom of Guaranteed Revival) and boundary death causes the total alive mass to contract toward the QSD equilibrium mass. The proof analyzes the full distribution of the mass change, accounting for both revival (mass increase) and boundary death (mass decrease).\n182: \n183: :::{prf:lemma} Mass Contraction via Revival and Death\n184: :label: lem-mass-contraction-revival-death\n185: \n186: Let $k_t = \\|\\mu_t\\|$ denote the number of alive walkers at time $t$ (the total mass of the empirical measure). Let $k_* = \\|\\pi_{\\text{QSD}}\\|$ denote the equilibrium alive count under the QSD.\n187: \n188: Assume:\n189: 1. **Birth Mechanism**: The Fragile Gas creates new walkers via two processes:\n190:    - Guaranteed revival of all dead walkers (from {prf:ref}`def-axiom-guaranteed-revival`)\n191:    - Cloning of alive walkers with rate $\\lambda_{\\text{clone}}(k_t)$ per walker\n192: \n193:    Total births: $B_t = (N - k_t) + C_t$ where $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$\n194: \n195: 2. **Death Mechanism**: Boundary exit causes death with rate $\\bar{p}_{\\text{kill}}(k_t)$, giving $\\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(k_t) k_t$\n196: \n197: 3. **QSD Equilibrium**: The equilibrium mass $k_*$ satisfies $(N - k_*) + \\lambda_{\\text{clone}}^* k_* = \\bar{p}_{\\text{kill}}^* k_*$\n198: \n199: 4. **Lipschitz Continuity**: Both $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k)$ are Lipschitz continuous:\n200:    - $|\\lambda_{\\text{clone}}(k_t) - \\lambda_{\\text{clone}}^*| \\leq L_\\lambda |k_t - k_*|$\n201:    - $|\\bar{p}_{\\text{kill}}(k_t) - \\bar{p}_{\\text{kill}}^*| \\leq L_p |k_t - k_*|$\n202: \n203: Then there exist constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$ such that:\n204: \n205: $$\n206: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n207: \n208: $$\n209: \n210: where:\n211: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n212: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n213: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n214: - $L_\\lambda$ is the Lipschitz constant of the cloning rate\n215: - $L_p$ is the Lipschitz constant of the killing rate\n216: - $N$ is the total number of walkers (alive + dead)\n217: \n218: **Assumptions:**\n219: 1. $\\epsilon^2 + \\epsilon < 1$, which requires $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (achieved when $L_p L_\\lambda = O(1/N^2)$ for large $N$)\n220: 2. $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with $L_g^{(2)} = O(N^{-1})$ (natural for density-dependent rates)\n221: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Lemma A: Mass Contraction from Revival and Death"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-structural-variance-contraction",
      "title": "Exponential Contraction of Structural Variance",
      "start_line": 1004,
      "end_line": 1024,
      "header_lines": [
        1005
      ],
      "content_start": 1007,
      "content_end": 1023,
      "content": "1007: :label: lem-structural-variance-contraction\n1008: \n1009: Let $\\mu_t$ denote the empirical measure of a single realization of the Fragile Gas at time $t$, and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1010: \n1011: Then the structural variance contracts exponentially in expectation:\n1012: \n1013: $$\n1014: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} t} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}}(1 - e^{-\\lambda_{\\text{struct}} t})\n1015: \n1016: $$\n1017: \n1018: where:\n1019: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the exponential convergence rate\n1020: - $\\kappa_W > 0$ is the cloning operator Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n1021: - $\\kappa_{\\text{kin}} > 0$ is the kinetic operator contraction rate from {prf:ref}`thm-foster-lyapunov-main`\n1022: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ combines noise constants from both operators\n1023: - $\\tau$ is the time step size",
      "metadata": {
        "label": "lem-structural-variance-contraction"
      },
      "section": "## 3. Lemma B: Exponential Contraction of Structural Variance",
      "raw_directive": "1004: **Mathematical Foundation:** This lemma uses the Wasserstein contraction results established in the framework. The cloning operator ({prf:ref}`thm-main-contraction-full` from [04_wasserstein_contraction](04_wasserstein_contraction)) and the kinetic operator ({prf:ref}`thm-foster-lyapunov-main` from [06_convergence](06_convergence)) each provide contraction of the Wasserstein distance **in expectation** after one step of the dynamics.\n1005: \n1006: :::{prf:lemma} Exponential Contraction of Structural Variance\n1007: :label: lem-structural-variance-contraction\n1008: \n1009: Let $\\mu_t$ denote the empirical measure of a single realization of the Fragile Gas at time $t$, and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1010: \n1011: Then the structural variance contracts exponentially in expectation:\n1012: \n1013: $$\n1014: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} t} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}}(1 - e^{-\\lambda_{\\text{struct}} t})\n1015: \n1016: $$\n1017: \n1018: where:\n1019: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the exponential convergence rate\n1020: - $\\kappa_W > 0$ is the cloning operator Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n1021: - $\\kappa_{\\text{kin}} > 0$ is the kinetic operator contraction rate from {prf:ref}`thm-foster-lyapunov-main`\n1022: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ combines noise constants from both operators\n1023: - $\\tau$ is the time step size\n1024: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Lemma B: Exponential Contraction of Structural Variance"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-kinetic-hellinger-contraction",
      "title": "Kinetic Operator Hellinger Contraction",
      "start_line": 1169,
      "end_line": 1214,
      "header_lines": [
        1170
      ],
      "content_start": 1172,
      "content_end": 1213,
      "content": "1172: :label: lem-kinetic-hellinger-contraction\n1173: \n1174: Let $\\mu_t$ be the empirical measure of alive walkers at time $t$ and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1175: \n1176: **Assumption:** The normalized density ratio is uniformly bounded:\n1177: \n1178: $$\n1179: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n1180: \n1181: $$\n1182: \n1183: where $\\tilde{\\mu}_t = \\mu_t / \\|\\mu_t\\|$ and $\\tilde{\\pi}_{\\text{QSD}} = \\pi_{\\text{QSD}} / \\|\\pi_{\\text{QSD}}\\|$ are the normalized probability measures.\n1184: \n1185: Under this assumption and the kinetic operator $\\Psi_{\\text{kin}}$ (BAOAB + boundary killing), there exist constants $\\kappa_{\\text{kin}}(M) > 0$ and $C_{\\text{kin}} < \\infty$ such that:\n1186: \n1187: $$\n1188: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}}(M) \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n1189: \n1190: $$\n1191: \n1192: where $\\tau$ is the time step size.\n1193: \n1194: **Interpretation:** The Hellinger distance to the QSD decreases exponentially fast under the kinetic operator, with a rate constant $\\kappa_{\\text{kin}}(M)$ that depends on the density bound $M$, the friction $\\gamma$, the potential coercivity $\\alpha_U$, and the hypocoercive coupling. The $O(\\tau^2)$ term arises from the BAOAB discretization error.\n1195: \n1196: **Justification of Assumption:** This assumption is satisfied for the Euclidean Gas under the following conditions:\n1197: \n1198: 1. **Bounded initial density:** If the empirical measure at $t=0$ has a bounded density ratio $d\\mu_0/d\\pi_{\\text{QSD}} \\leq M_0 < \\infty$, which holds for any finite particle system initialized within the valid domain.\n1199: \n1200: 2. **Gaussian regularization from cloning:** The cloning operator applies Gaussian perturbations with variance $\\delta^2 > 0$ to all walkers (Axiom {prf:ref}`def-axiom-local-perturbation` from [01_fragile_gas_framework](01_fragile_gas_framework)). This acts as a convolution with a Gaussian kernel:\n1201:    $$\n1202:    \\tilde{\\mu}_{t+} = \\tilde{\\mu}_t * G_{\\delta}\n1203:    $$\n1204:    Gaussian convolution immediately regularizes any measure to have $C^\\infty$ density. Since $\\pi_{\\text{QSD}}$ also has smooth density (from the Gibbs structure with smooth potential), the ratio $d\\tilde{\\mu}_{t+}/d\\tilde{\\pi}_{\\text{QSD}}$ remains bounded.\n1205: \n1206: 3. **Preservation under Fokker-Planck evolution:** The kinetic operator evolves densities according to the Fokker-Planck PDE. The **parabolic maximum principle** ensures that if $\\sup_x (d\\mu_t/d\\pi)(x) \\leq M$ initially, then $\\sup_x (d\\mu_{t+\\tau}/d\\pi)(x) \\leq M' $ where $M'$ depends on $M$, $\\tau$, and system parameters but remains finite for finite time.\n1207: \n1208: 4. **Confinement prevents escape to low-density regions:** The confining potential $U$ from Axiom {prf:ref}`ax-confining-potential` ensures $\\pi_{\\text{QSD}}(x) \\geq c_{\\min} e^{-U(x)}$ for some $c_{\\min} > 0$. Combined with the boundary killing mechanism, walkers are concentrated in regions where $\\pi_{\\text{QSD}}$ has significant mass, preventing the ratio from diverging.\n1209: \n1210: **Practical bound:** For finite-time analysis (up to any fixed $T < \\infty$), the bound $M = M(T, M_0, \\delta, \\gamma, U)$ is guaranteed to be finite by the regularization and confinement mechanisms. The constant $M$ depends on:\n1211: - Initial bound $M_0$\n1212: - Cloning noise $\\delta$ (smaller $\\delta$ requires larger $M$)\n1213: - Friction $\\gamma$ (larger $\\gamma$ gives better regularization)",
      "metadata": {
        "label": "lem-kinetic-hellinger-contraction"
      },
      "section": "## 4. Lemma C: Kinetic Operator Hellinger Analysis",
      "raw_directive": "1169: The QSD $\\pi_{\\text{QSD}}$ is the quasi-stationary distribution—the unique invariant measure conditioned on survival (see [06_convergence](06_convergence)).\n1170: \n1171: :::{prf:lemma} Kinetic Operator Hellinger Contraction\n1172: :label: lem-kinetic-hellinger-contraction\n1173: \n1174: Let $\\mu_t$ be the empirical measure of alive walkers at time $t$ and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1175: \n1176: **Assumption:** The normalized density ratio is uniformly bounded:\n1177: \n1178: $$\n1179: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n1180: \n1181: $$\n1182: \n1183: where $\\tilde{\\mu}_t = \\mu_t / \\|\\mu_t\\|$ and $\\tilde{\\pi}_{\\text{QSD}} = \\pi_{\\text{QSD}} / \\|\\pi_{\\text{QSD}}\\|$ are the normalized probability measures.\n1184: \n1185: Under this assumption and the kinetic operator $\\Psi_{\\text{kin}}$ (BAOAB + boundary killing), there exist constants $\\kappa_{\\text{kin}}(M) > 0$ and $C_{\\text{kin}} < \\infty$ such that:\n1186: \n1187: $$\n1188: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}}(M) \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n1189: \n1190: $$\n1191: \n1192: where $\\tau$ is the time step size.\n1193: \n1194: **Interpretation:** The Hellinger distance to the QSD decreases exponentially fast under the kinetic operator, with a rate constant $\\kappa_{\\text{kin}}(M)$ that depends on the density bound $M$, the friction $\\gamma$, the potential coercivity $\\alpha_U$, and the hypocoercive coupling. The $O(\\tau^2)$ term arises from the BAOAB discretization error.\n1195: \n1196: **Justification of Assumption:** This assumption is satisfied for the Euclidean Gas under the following conditions:\n1197: \n1198: 1. **Bounded initial density:** If the empirical measure at $t=0$ has a bounded density ratio $d\\mu_0/d\\pi_{\\text{QSD}} \\leq M_0 < \\infty$, which holds for any finite particle system initialized within the valid domain.\n1199: \n1200: 2. **Gaussian regularization from cloning:** The cloning operator applies Gaussian perturbations with variance $\\delta^2 > 0$ to all walkers (Axiom {prf:ref}`def-axiom-local-perturbation` from [01_fragile_gas_framework](01_fragile_gas_framework)). This acts as a convolution with a Gaussian kernel:\n1201:    $$\n1202:    \\tilde{\\mu}_{t+} = \\tilde{\\mu}_t * G_{\\delta}\n1203:    $$\n1204:    Gaussian convolution immediately regularizes any measure to have $C^\\infty$ density. Since $\\pi_{\\text{QSD}}$ also has smooth density (from the Gibbs structure with smooth potential), the ratio $d\\tilde{\\mu}_{t+}/d\\tilde{\\pi}_{\\text{QSD}}$ remains bounded.\n1205: \n1206: 3. **Preservation under Fokker-Planck evolution:** The kinetic operator evolves densities according to the Fokker-Planck PDE. The **parabolic maximum principle** ensures that if $\\sup_x (d\\mu_t/d\\pi)(x) \\leq M$ initially, then $\\sup_x (d\\mu_{t+\\tau}/d\\pi)(x) \\leq M' $ where $M'$ depends on $M$, $\\tau$, and system parameters but remains finite for finite time.\n1207: \n1208: 4. **Confinement prevents escape to low-density regions:** The confining potential $U$ from Axiom {prf:ref}`ax-confining-potential` ensures $\\pi_{\\text{QSD}}(x) \\geq c_{\\min} e^{-U(x)}$ for some $c_{\\min} > 0$. Combined with the boundary killing mechanism, walkers are concentrated in regions where $\\pi_{\\text{QSD}}$ has significant mass, preventing the ratio from diverging.\n1209: \n1210: **Practical bound:** For finite-time analysis (up to any fixed $T < \\infty$), the bound $M = M(T, M_0, \\delta, \\gamma, U)$ is guaranteed to be finite by the regularization and confinement mechanisms. The constant $M$ depends on:\n1211: - Initial bound $M_0$\n1212: - Cloning noise $\\delta$ (smaller $\\delta$ requires larger $M$)\n1213: - Friction $\\gamma$ (larger $\\gamma$ gives better regularization)\n1214: - Potential curvature (stronger confinement gives tighter bounds)",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Lemma C: Kinetic Operator Hellinger Analysis"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hormander-bracket",
      "title": "Hörmander's Bracket Condition",
      "start_line": 1993,
      "end_line": 2021,
      "header_lines": [
        1994
      ],
      "content_start": 1996,
      "content_end": 2020,
      "content": "1996: :label: lem-hormander-bracket\n1997: \n1998: **Reference**: `06_convergence.md` Section 4.4.1, lines 892-950\n1999: \n2000: The kinetic generator $\\mathcal{L}_{\\text{kin}}$ has the form:\n2001: \n2002: $$\n2003: \\mathcal{L}_{\\text{kin}} = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v + \\frac{\\sigma_v^2}{2} \\Delta_v\n2004: \n2005: $$\n2006: \n2007: where $A(x, v) = \\frac{1}{m}F(x) - \\gamma(v - u(x))$ is the velocity drift.\n2008: \n2009: The vector fields:\n2010: - $X_0 = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v$ (drift)\n2011: - $X_j = \\sigma_v \\partial_{v_j}$ (diffusion, $j = 1, \\ldots, d$)\n2012: \n2013: satisfy Hörmander's bracket condition:\n2014: \n2015: $$\n2016: \\text{Lie}\\{X_0, X_1, \\ldots, X_d, [X_0, X_1], \\ldots, [X_0, X_d]\\} = T_{(x,v)}\\Omega\n2017: \n2018: $$\n2019: \n2020: at every point $(x, v) \\in \\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$.",
      "metadata": {
        "label": "lem-hormander-bracket"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "1993: #### 2.2. Hypoelliptic Structure of the Kinetic Operator\n1994: \n1995: :::{prf:lemma} Hörmander's Bracket Condition\n1996: :label: lem-hormander-bracket\n1997: \n1998: **Reference**: `06_convergence.md` Section 4.4.1, lines 892-950\n1999: \n2000: The kinetic generator $\\mathcal{L}_{\\text{kin}}$ has the form:\n2001: \n2002: $$\n2003: \\mathcal{L}_{\\text{kin}} = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v + \\frac{\\sigma_v^2}{2} \\Delta_v\n2004: \n2005: $$\n2006: \n2007: where $A(x, v) = \\frac{1}{m}F(x) - \\gamma(v - u(x))$ is the velocity drift.\n2008: \n2009: The vector fields:\n2010: - $X_0 = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v$ (drift)\n2011: - $X_j = \\sigma_v \\partial_{v_j}$ (diffusion, $j = 1, \\ldots, d$)\n2012: \n2013: satisfy Hörmander's bracket condition:\n2014: \n2015: $$\n2016: \\text{Lie}\\{X_0, X_1, \\ldots, X_d, [X_0, X_1], \\ldots, [X_0, X_d]\\} = T_{(x,v)}\\Omega\n2017: \n2018: $$\n2019: \n2020: at every point $(x, v) \\in \\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$.\n2021: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-linfty-full-operator",
      "title": "$L^\\infty$ Bound for the Full Operator",
      "start_line": 2072,
      "end_line": 2284,
      "header_lines": [
        2073
      ],
      "content_start": 2075,
      "content_end": 2283,
      "content": "2075: :label: lem-linfty-full-operator\n2076: \n2077: Consider the full McKean-Vlasov-Fokker-Planck equation from §2.1:\n2078: \n2079: $$\n2080: \\frac{\\partial f}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* f + \\mathcal{L}_{\\text{clone}}^* f - c(z) f + B[f, m_d]\n2081: \n2082: $$\n2083: \n2084: with initial condition $\\|f_0\\|_\\infty \\leq M_0 < \\infty$. Assume a uniform-in-time lower bound on the alive mass, $m_a(t) = \\|f(t, \\cdot)\\|_{L^1} \\geq c_{\\text{mass}} > 0$ for all $t \\geq 0$ (to be proven in Section 4).\n2085: \n2086: Then for any finite time $T > 0$:\n2087: \n2088: $$\n2089: \\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R) < \\infty\n2090: \n2091: $$\n2092: \n2093: **Proof**:\n2094: \n2095: We decompose the evolution into four components and bound each separately using the parabolic Harnack inequality.\n2096: \n2097: **Step 1: Kinetic Evolution Alone**\n2098: \n2099: Consider first the pure kinetic evolution $\\partial_t f = \\mathcal{L}_{\\text{kin}}^* f$ with reflecting boundary conditions. By the parabolic Harnack inequality (Theorem {prf:ref}`thm-parabolic-harnack`), for any cylinder $Q_R$:\n2100: \n2101: $$\n2102: \\sup_{Q_{R/2}^-} f \\leq C_H \\inf_{Q_{R/2}^+} f\n2103: \n2104: $$\n2105: \n2106: For the initial value problem with $\\|f_0\\|_\\infty \\leq M_0$, we apply this iteratively over time slices to obtain:\n2107: \n2108: $$\n2109: \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(t, \\gamma, \\sigma_v, R, d) M_0\n2110: \n2111: $$\n2112: \n2113: where $C_{\\text{kin}}(t, \\cdot)$ is the hypoelliptic smoothing constant. For $t \\geq t_{\\text{mix}}$ (mixing time), this becomes a constant independent of $t$.\n2114: \n2115: **Key Quantitative Bound**: Using the explicit Gaussian heat kernel estimates from Hérau & Nier (2004, Lemma 2.1), for $t \\geq \\tau$ (one timestep):\n2116: \n2117: $$\n2118: C_{\\text{kin}}(t, \\cdot) \\leq C_0 \\left( \\frac{R^2}{\\sigma_v^2 \\gamma t} \\right)^{d/2} + C_1\n2119: \n2120: $$\n2121: \n2122: where $C_0, C_1$ depend only on the bracket depth and dimension.\n2123: \n2124: **Step 2: Cloning Operator **\n2125: \n2126: The cloning operator with Gaussian position jitter has the form (from `03_cloning.md` line 6022):\n2127: \n2128: $$\n2129: \\mathcal{L}_{\\text{clone}}^* f = \\int_\\Omega K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n2130: \n2131: $$\n2132: \n2133: where:\n2134: - $K_{\\text{clone}}(z, z') = \\frac{1}{(2\\pi\\sigma_x^2)^{d/2}} \\exp(-\\|x - x'\\|^2 / (2\\sigma_x^2)) \\times \\delta(v - v')$ is the Gaussian kernel\n2135: - $V[f](z, z')$ is the **fitness weighting functional** (depends nonlinearly on $f$ via virtual reward)\n2136: \n2137: **Critical Observation**: The cloning operator is **NOT** a simple convolution due to the fitness weighting $V[f]$. The operator has a nonlinear source-sink structure:\n2138: \n2139: $$\n2140: \\mathcal{L}_{\\text{clone}}^* f(z) = \\underbrace{\\int K_{\\text{clone}}(z, z') V[f](z, z') f(z') dz'}_{\\text{source}} - \\underbrace{f(z) \\int K_{\\text{clone}}(z, z') V[f](z, z') dz'}_{\\text{sink}}\n2141: \n2142: $$\n2143: \n2144: **Revised $L^\\infty$ Bound**: The fitness functional satisfies (from `03_cloning.md`):\n2145: \n2146: $$\n2147: 0 \\leq V[f](z, z') \\leq V_{\\max} := \\max\\left(1, \\frac{1}{\\eta}\\right)\n2148: \n2149: $$\n2150: \n2151: where $\\eta \\in (0, 1)$ is the rescaling parameter. Therefore:\n2152: \n2153: $$\n2154: |\\mathcal{L}_{\\text{clone}}^* f(z)| \\leq V_{\\max} \\left[\\int K_{\\text{clone}}(z, z') f(z') dz' + f(z) \\int K_{\\text{clone}}(z, z') dz'\\right]\n2155: \n2156: $$\n2157: \n2158: Since $\\int K_{\\text{clone}}(z, z') dz' = 1$ (normalized kernel) and the convolution $\\int K f' dx' \\leq \\|f\\|_\\infty$:\n2159: \n2160: $$\n2161: \\|\\mathcal{L}_{\\text{clone}}^* f\\|_\\infty \\leq 2 V_{\\max} \\|f\\|_\\infty\n2162: \n2163: $$\n2164: \n2165: Over a timestep $\\tau$, using forward Euler for the source term:\n2166: \n2167: $$\n2168: \\|f_{\\text{post-clone}}\\|_\\infty \\leq (1 + 2 V_{\\max} \\tau) \\|f_{\\text{pre-clone}}\\|_\\infty\n2169: \n2170: $$\n2171: \n2172: **Impact**: This increases the hypoelliptic constant $C_{\\text{hypo}}$ by a factor $(1 + 2V_{\\max}\\tau)^{T/\\tau}$, but remains finite for finite time $T$.\n2173: \n2174: **Step 3: Killing Term**\n2175: \n2176: The killing term $-c(z) f$ with $c(z) \\geq 0$ only removes mass:\n2177: \n2178: $$\n2179: \\|f_{\\text{post-kill}}\\|_\\infty \\leq \\|f_{\\text{pre-kill}}\\|_\\infty\n2180: \n2181: $$\n2182: \n2183: **Step 4: Revival Term (Mass-Dependent Source)**\n2184: \n2185: The revival operator re-injects mass into the safe region. From `07_mean_field.md`, the revival source has the form\n2186: \n2187: $$\n2188: r_{\\text{revival}}(z) = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}(z),\n2189: $$\n2190: \n2191: where $m_a(t) = \\int f(t, z) dz$ is the alive mass and $m_d(t)$ is the dead-mass flux. The kernel $f_{\\text{safe}}$ is deterministic, compactly supported, and normalized ($\\int f_{\\text{safe}} = 1$). On the event that Section 4 proves $m_a(t) \\geq c_{\\text{mass}}$, we have\n2192: \n2193: $$\n2194: \\frac{m_d(t)}{m_a(t)} = \\frac{\\int c(z) f(t,z) dz}{m_a(t)} \\leq \\|c\\|_\\infty.\n2195: $$\n2196: \n2197: Therefore\n2198: \n2199: $$\n2200: \\|r_{\\text{revival}}\\|_\\infty \\leq \\lambda_{\\text{rev}} \\|c\\|_\\infty \\|f_{\\text{safe}}\\|_\\infty =: C_{\\text{safe}},\n2201: $$\n2202: \n2203: which is a state-independent constant (no additional factor of $\\|f\\|_\\infty$ appears).\n2204: \n2205: **Step 5: Volterra Inequality for the Supremum Norm**\n2206: \n2207: Using the Duhamel formula for the full equation over time interval $[0, T]$:\n2208: \n2209: $$\n2210: f(T, z) = \\int_\\Omega p_T^{\\text{kin}}(z, z') f_0(z') dz' + \\int_0^T \\int_\\Omega p_{T-s}^{\\text{kin}}(z, z') S[f](s, z') dz' ds\n2211: \n2212: $$\n2213: \n2214: where $S[f] = \\mathcal{L}_{\\text{clone}}^* f - c f + B[f, m_d]$ is the source term and $p_t^{\\text{kin}}$ is the kinetic heat kernel.\n2215: \n2216: Taking supremum:\n2217: \n2218: $$\n2219: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\|S[f](s, \\cdot)\\|_\\infty ds\n2220: \n2221: $$\n2222: \n2223: Since cloning and killing preserve $L^\\infty$ bounds (Steps 2-3), and revival adds at most $C_{\\text{revival}}$ per unit time (Step 4):\n2224: \n2225: $$\n2226: \\|S[f](s, \\cdot)\\|_\\infty \\leq \\|f(s, \\cdot)\\|_\\infty + C_{\\text{revival}}\n2227: \n2228: $$\n2229: \n2230: This gives the integral inequality:\n2231: \n2232: $$\n2233: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\Big[(2V_{\\max} + \\|c\\|_\\infty) \\|f(s, \\cdot)\\|_\\infty + C_{\\text{safe}}\\Big] ds.\n2234: $$\n2235: \n2236: Define $u(t) = \\|f(t, \\cdot)\\|_\\infty$, $B_* := 2V_{\\max} + \\|c\\|_\\infty$, and $\\kappa_{\\text{kin}}(T) := \\int_0^T C_{\\text{kin}}(s) ds < \\infty$ (the kinetic estimate from Step 1 implies integrability). Then\n2237: \n2238: $$\n2239: u(T) \\leq C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) + B_* \\int_0^T C_{\\text{kin}}(T - s) u(s) ds.\n2240: $$\n2241: \n2242: **Step 6: Resolvent Grönwall Argument**\n2243: \n2244: Let $C_{\\text{kin}}^{\\max}(T) = \\sup_{0 \\leq s \\leq T} C_{\\text{kin}}(s)$ and $\\Psi(T) = \\int_0^T u(s) ds$. The convolution term satisfies\n2245: \n2246: $$\n2247: \\int_0^T C_{\\text{kin}}(T - s) u(s) ds \\leq C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n2248: $$\n2249: \n2250: Hence\n2251: \n2252: $$\n2253: u(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T),\n2254: \\qquad\n2255: A_T := C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T).\n2256: $$\n2257: \n2258: Differentiating $\\Psi$ yields the Volterra inequality\n2259: \n2260: $$\n2261: \\Psi'(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n2262: $$\n2263: \n2264: Gronwall’s lemma for first-order linear ODEs gives\n2265: \n2266: $$\n2267: \\Psi(T) \\leq \\int_0^T A_s \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) (T-s)\\right) ds.\n2268: $$\n2269: \n2270: Since $A_s \\leq C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) =: A_*$ for $s \\in [0, T]$, we obtain\n2271: \n2272: $$\n2273: u(T) \\leq A_* \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n2274: $$\n2275: \n2276: Therefore the hypoelliptic $L^\\infty$ bound holds with the explicit constant\n2277: \n2278: $$\n2279: C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R)\n2280: := \\Big[C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T)\\Big]\n2281: \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n2282: $$\n2283: ",
      "metadata": {
        "label": "lem-linfty-full-operator"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "2072: The full equation includes non-local cloning terms, killing, and revival. We handle these perturbatively:\n2073: \n2074: :::{prf:lemma} $L^\\infty$ Bound for the Full Operator\n2075: :label: lem-linfty-full-operator\n2076: \n2077: Consider the full McKean-Vlasov-Fokker-Planck equation from §2.1:\n2078: \n2079: $$\n2080: \\frac{\\partial f}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* f + \\mathcal{L}_{\\text{clone}}^* f - c(z) f + B[f, m_d]\n2081: \n2082: $$\n2083: \n2084: with initial condition $\\|f_0\\|_\\infty \\leq M_0 < \\infty$. Assume a uniform-in-time lower bound on the alive mass, $m_a(t) = \\|f(t, \\cdot)\\|_{L^1} \\geq c_{\\text{mass}} > 0$ for all $t \\geq 0$ (to be proven in Section 4).\n2085: \n2086: Then for any finite time $T > 0$:\n2087: \n2088: $$\n2089: \\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R) < \\infty\n2090: \n2091: $$\n2092: \n2093: **Proof**:\n2094: \n2095: We decompose the evolution into four components and bound each separately using the parabolic Harnack inequality.\n2096: \n2097: **Step 1: Kinetic Evolution Alone**\n2098: \n2099: Consider first the pure kinetic evolution $\\partial_t f = \\mathcal{L}_{\\text{kin}}^* f$ with reflecting boundary conditions. By the parabolic Harnack inequality (Theorem {prf:ref}`thm-parabolic-harnack`), for any cylinder $Q_R$:\n2100: \n2101: $$\n2102: \\sup_{Q_{R/2}^-} f \\leq C_H \\inf_{Q_{R/2}^+} f\n2103: \n2104: $$\n2105: \n2106: For the initial value problem with $\\|f_0\\|_\\infty \\leq M_0$, we apply this iteratively over time slices to obtain:\n2107: \n2108: $$\n2109: \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(t, \\gamma, \\sigma_v, R, d) M_0\n2110: \n2111: $$\n2112: \n2113: where $C_{\\text{kin}}(t, \\cdot)$ is the hypoelliptic smoothing constant. For $t \\geq t_{\\text{mix}}$ (mixing time), this becomes a constant independent of $t$.\n2114: \n2115: **Key Quantitative Bound**: Using the explicit Gaussian heat kernel estimates from Hérau & Nier (2004, Lemma 2.1), for $t \\geq \\tau$ (one timestep):\n2116: \n2117: $$\n2118: C_{\\text{kin}}(t, \\cdot) \\leq C_0 \\left( \\frac{R^2}{\\sigma_v^2 \\gamma t} \\right)^{d/2} + C_1\n2119: \n2120: $$\n2121: \n2122: where $C_0, C_1$ depend only on the bracket depth and dimension.\n2123: \n2124: **Step 2: Cloning Operator **\n2125: \n2126: The cloning operator with Gaussian position jitter has the form (from `03_cloning.md` line 6022):\n2127: \n2128: $$\n2129: \\mathcal{L}_{\\text{clone}}^* f = \\int_\\Omega K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n2130: \n2131: $$\n2132: \n2133: where:\n2134: - $K_{\\text{clone}}(z, z') = \\frac{1}{(2\\pi\\sigma_x^2)^{d/2}} \\exp(-\\|x - x'\\|^2 / (2\\sigma_x^2)) \\times \\delta(v - v')$ is the Gaussian kernel\n2135: - $V[f](z, z')$ is the **fitness weighting functional** (depends nonlinearly on $f$ via virtual reward)\n2136: \n2137: **Critical Observation**: The cloning operator is **NOT** a simple convolution due to the fitness weighting $V[f]$. The operator has a nonlinear source-sink structure:\n2138: \n2139: $$\n2140: \\mathcal{L}_{\\text{clone}}^* f(z) = \\underbrace{\\int K_{\\text{clone}}(z, z') V[f](z, z') f(z') dz'}_{\\text{source}} - \\underbrace{f(z) \\int K_{\\text{clone}}(z, z') V[f](z, z') dz'}_{\\text{sink}}\n2141: \n2142: $$\n2143: \n2144: **Revised $L^\\infty$ Bound**: The fitness functional satisfies (from `03_cloning.md`):\n2145: \n2146: $$\n2147: 0 \\leq V[f](z, z') \\leq V_{\\max} := \\max\\left(1, \\frac{1}{\\eta}\\right)\n2148: \n2149: $$\n2150: \n2151: where $\\eta \\in (0, 1)$ is the rescaling parameter. Therefore:\n2152: \n2153: $$\n2154: |\\mathcal{L}_{\\text{clone}}^* f(z)| \\leq V_{\\max} \\left[\\int K_{\\text{clone}}(z, z') f(z') dz' + f(z) \\int K_{\\text{clone}}(z, z') dz'\\right]\n2155: \n2156: $$\n2157: \n2158: Since $\\int K_{\\text{clone}}(z, z') dz' = 1$ (normalized kernel) and the convolution $\\int K f' dx' \\leq \\|f\\|_\\infty$:\n2159: \n2160: $$\n2161: \\|\\mathcal{L}_{\\text{clone}}^* f\\|_\\infty \\leq 2 V_{\\max} \\|f\\|_\\infty\n2162: \n2163: $$\n2164: \n2165: Over a timestep $\\tau$, using forward Euler for the source term:\n2166: \n2167: $$\n2168: \\|f_{\\text{post-clone}}\\|_\\infty \\leq (1 + 2 V_{\\max} \\tau) \\|f_{\\text{pre-clone}}\\|_\\infty\n2169: \n2170: $$\n2171: \n2172: **Impact**: This increases the hypoelliptic constant $C_{\\text{hypo}}$ by a factor $(1 + 2V_{\\max}\\tau)^{T/\\tau}$, but remains finite for finite time $T$.\n2173: \n2174: **Step 3: Killing Term**\n2175: \n2176: The killing term $-c(z) f$ with $c(z) \\geq 0$ only removes mass:\n2177: \n2178: $$\n2179: \\|f_{\\text{post-kill}}\\|_\\infty \\leq \\|f_{\\text{pre-kill}}\\|_\\infty\n2180: \n2181: $$\n2182: \n2183: **Step 4: Revival Term (Mass-Dependent Source)**\n2184: \n2185: The revival operator re-injects mass into the safe region. From `07_mean_field.md`, the revival source has the form\n2186: \n2187: $$\n2188: r_{\\text{revival}}(z) = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}(z),\n2189: $$\n2190: \n2191: where $m_a(t) = \\int f(t, z) dz$ is the alive mass and $m_d(t)$ is the dead-mass flux. The kernel $f_{\\text{safe}}$ is deterministic, compactly supported, and normalized ($\\int f_{\\text{safe}} = 1$). On the event that Section 4 proves $m_a(t) \\geq c_{\\text{mass}}$, we have\n2192: \n2193: $$\n2194: \\frac{m_d(t)}{m_a(t)} = \\frac{\\int c(z) f(t,z) dz}{m_a(t)} \\leq \\|c\\|_\\infty.\n2195: $$\n2196: \n2197: Therefore\n2198: \n2199: $$\n2200: \\|r_{\\text{revival}}\\|_\\infty \\leq \\lambda_{\\text{rev}} \\|c\\|_\\infty \\|f_{\\text{safe}}\\|_\\infty =: C_{\\text{safe}},\n2201: $$\n2202: \n2203: which is a state-independent constant (no additional factor of $\\|f\\|_\\infty$ appears).\n2204: \n2205: **Step 5: Volterra Inequality for the Supremum Norm**\n2206: \n2207: Using the Duhamel formula for the full equation over time interval $[0, T]$:\n2208: \n2209: $$\n2210: f(T, z) = \\int_\\Omega p_T^{\\text{kin}}(z, z') f_0(z') dz' + \\int_0^T \\int_\\Omega p_{T-s}^{\\text{kin}}(z, z') S[f](s, z') dz' ds\n2211: \n2212: $$\n2213: \n2214: where $S[f] = \\mathcal{L}_{\\text{clone}}^* f - c f + B[f, m_d]$ is the source term and $p_t^{\\text{kin}}$ is the kinetic heat kernel.\n2215: \n2216: Taking supremum:\n2217: \n2218: $$\n2219: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\|S[f](s, \\cdot)\\|_\\infty ds\n2220: \n2221: $$\n2222: \n2223: Since cloning and killing preserve $L^\\infty$ bounds (Steps 2-3), and revival adds at most $C_{\\text{revival}}$ per unit time (Step 4):\n2224: \n2225: $$\n2226: \\|S[f](s, \\cdot)\\|_\\infty \\leq \\|f(s, \\cdot)\\|_\\infty + C_{\\text{revival}}\n2227: \n2228: $$\n2229: \n2230: This gives the integral inequality:\n2231: \n2232: $$\n2233: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\Big[(2V_{\\max} + \\|c\\|_\\infty) \\|f(s, \\cdot)\\|_\\infty + C_{\\text{safe}}\\Big] ds.\n2234: $$\n2235: \n2236: Define $u(t) = \\|f(t, \\cdot)\\|_\\infty$, $B_* := 2V_{\\max} + \\|c\\|_\\infty$, and $\\kappa_{\\text{kin}}(T) := \\int_0^T C_{\\text{kin}}(s) ds < \\infty$ (the kinetic estimate from Step 1 implies integrability). Then\n2237: \n2238: $$\n2239: u(T) \\leq C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) + B_* \\int_0^T C_{\\text{kin}}(T - s) u(s) ds.\n2240: $$\n2241: \n2242: **Step 6: Resolvent Grönwall Argument**\n2243: \n2244: Let $C_{\\text{kin}}^{\\max}(T) = \\sup_{0 \\leq s \\leq T} C_{\\text{kin}}(s)$ and $\\Psi(T) = \\int_0^T u(s) ds$. The convolution term satisfies\n2245: \n2246: $$\n2247: \\int_0^T C_{\\text{kin}}(T - s) u(s) ds \\leq C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n2248: $$\n2249: \n2250: Hence\n2251: \n2252: $$\n2253: u(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T),\n2254: \\qquad\n2255: A_T := C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T).\n2256: $$\n2257: \n2258: Differentiating $\\Psi$ yields the Volterra inequality\n2259: \n2260: $$\n2261: \\Psi'(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n2262: $$\n2263: \n2264: Gronwall’s lemma for first-order linear ODEs gives\n2265: \n2266: $$\n2267: \\Psi(T) \\leq \\int_0^T A_s \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) (T-s)\\right) ds.\n2268: $$\n2269: \n2270: Since $A_s \\leq C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) =: A_*$ for $s \\in [0, T]$, we obtain\n2271: \n2272: $$\n2273: u(T) \\leq A_* \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n2274: $$\n2275: \n2276: Therefore the hypoelliptic $L^\\infty$ bound holds with the explicit constant\n2277: \n2278: $$\n2279: C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R)\n2280: := \\Big[C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T)\\Big]\n2281: \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n2282: $$\n2283: \n2284: This constant is finite for every finite $T$, depends on all physical parameters, and controls $\\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty$. $\\square$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-gaussian-kernel-lower-bound",
      "title": "Gaussian Kernel Lower Bound",
      "start_line": 2296,
      "end_line": 2346,
      "header_lines": [
        2297
      ],
      "content_start": 2299,
      "content_end": 2345,
      "content": "2299: :label: lem-gaussian-kernel-lower-bound\n2300: \n2301: Let $G_{\\sigma_x}(y) = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-\\|y\\|^2 / (2\\sigma_x^2))$ be the Gaussian kernel with variance $\\sigma_x^2 > 0$.\n2302: \n2303: For any $x_1, x_2 \\in B_R(0) \\subset \\mathbb{R}^d$:\n2304: \n2305: $$\n2306: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} \\leq \\exp\\left( \\frac{(2R)^2}{2\\sigma_x^2} \\right)\n2307: \n2308: $$\n2309: \n2310: Moreover, for any integrable density $\\rho$ with $\\|\\rho\\|_{L^1} = m > 0$:\n2311: \n2312: $$\n2313: \\inf_{x \\in B_R} \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq m \\cdot c_{\\sigma_x, R}\n2314: \n2315: $$\n2316: \n2317: where:\n2318: \n2319: $$\n2320: c_{\\sigma_x, R} := (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) > 0\n2321: \n2322: $$\n2323: \n2324: **Proof**:\n2325: \n2326: For the ratio bound, note that for $x_1, x_2 \\in B_R$:\n2327: \n2328: $$\n2329: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} = \\exp\\left( \\frac{\\|x_2\\|^2 - \\|x_1\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{\\|x_2\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{R^2}{2\\sigma_x^2} \\right)\n2330: \n2331: $$\n2332: \n2333: For the lower bound, fix $x \\in B_R$. For any $y \\in B_R$, $\\|x - y\\| \\leq 2R$, so:\n2334: \n2335: $$\n2336: G_{\\sigma_x}(x - y) \\geq (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) = c_{\\sigma_x, R}\n2337: \n2338: $$\n2339: \n2340: Therefore:\n2341: \n2342: $$\n2343: \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq c_{\\sigma_x, R} \\int_{B_R} \\rho(y) dy = c_{\\sigma_x, R} \\cdot m\n2344: \n2345: $$",
      "metadata": {
        "label": "lem-gaussian-kernel-lower-bound"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "2296: #### 3.1. Quantitative Gaussian Mollification Bounds\n2297: \n2298: :::{prf:lemma} Gaussian Kernel Lower Bound\n2299: :label: lem-gaussian-kernel-lower-bound\n2300: \n2301: Let $G_{\\sigma_x}(y) = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-\\|y\\|^2 / (2\\sigma_x^2))$ be the Gaussian kernel with variance $\\sigma_x^2 > 0$.\n2302: \n2303: For any $x_1, x_2 \\in B_R(0) \\subset \\mathbb{R}^d$:\n2304: \n2305: $$\n2306: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} \\leq \\exp\\left( \\frac{(2R)^2}{2\\sigma_x^2} \\right)\n2307: \n2308: $$\n2309: \n2310: Moreover, for any integrable density $\\rho$ with $\\|\\rho\\|_{L^1} = m > 0$:\n2311: \n2312: $$\n2313: \\inf_{x \\in B_R} \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq m \\cdot c_{\\sigma_x, R}\n2314: \n2315: $$\n2316: \n2317: where:\n2318: \n2319: $$\n2320: c_{\\sigma_x, R} := (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) > 0\n2321: \n2322: $$\n2323: \n2324: **Proof**:\n2325: \n2326: For the ratio bound, note that for $x_1, x_2 \\in B_R$:\n2327: \n2328: $$\n2329: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} = \\exp\\left( \\frac{\\|x_2\\|^2 - \\|x_1\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{\\|x_2\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{R^2}{2\\sigma_x^2} \\right)\n2330: \n2331: $$\n2332: \n2333: For the lower bound, fix $x \\in B_R$. For any $y \\in B_R$, $\\|x - y\\| \\leq 2R$, so:\n2334: \n2335: $$\n2336: G_{\\sigma_x}(x - y) \\geq (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) = c_{\\sigma_x, R}\n2337: \n2338: $$\n2339: \n2340: Therefore:\n2341: \n2342: $$\n2343: \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq c_{\\sigma_x, R} \\int_{B_R} \\rho(y) dy = c_{\\sigma_x, R} \\cdot m\n2344: \n2345: $$\n2346: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-strict-positivity-cloning",
      "title": "Strict Positivity After Cloning",
      "start_line": 2350,
      "end_line": 2391,
      "header_lines": [
        2351
      ],
      "content_start": 2353,
      "content_end": 2390,
      "content": "2353: :label: lem-strict-positivity-cloning\n2354: \n2355: After applying the cloning operator with Gaussian position jitter $\\sigma_x > 0$, the density satisfies:\n2356: \n2357: $$\n2358: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n2359: \n2360: $$\n2361: \n2362: where $c_{\\sigma_x, R}$ is defined in Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`.\n2363: \n2364: **Proof**: From `03_cloning.md` (line 6022), the position update is:\n2365: \n2366: $$\n2367: x_i' = x_j + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n2368: \n2369: $$\n2370: \n2371: In the mean-field limit, this corresponds to convolution with the Gaussian kernel:\n2372: \n2373: $$\n2374: \\rho_{\\text{post-clone}}(x) = \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) w(y) \\rho_{\\text{pre-clone}}(y) dy\n2375: \n2376: $$\n2377: \n2378: where $w(y)$ is the fitness weighting (always positive). Since $w(y) \\geq \\eta > 0$ (floor from rescale transformation, `01_fragile_gas_framework.md`), we have:\n2379: \n2380: $$\n2381: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) \\rho_{\\text{pre-clone}}(y) dy\n2382: \n2383: $$\n2384: \n2385: Applying Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`:\n2386: \n2387: $$\n2388: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\cdot c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n2389: \n2390: $$",
      "metadata": {
        "label": "lem-strict-positivity-cloning"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "2350: #### 3.2. Lower Bound on Post-Cloning Density\n2351: \n2352: :::{prf:lemma} Strict Positivity After Cloning\n2353: :label: lem-strict-positivity-cloning\n2354: \n2355: After applying the cloning operator with Gaussian position jitter $\\sigma_x > 0$, the density satisfies:\n2356: \n2357: $$\n2358: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n2359: \n2360: $$\n2361: \n2362: where $c_{\\sigma_x, R}$ is defined in Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`.\n2363: \n2364: **Proof**: From `03_cloning.md` (line 6022), the position update is:\n2365: \n2366: $$\n2367: x_i' = x_j + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n2368: \n2369: $$\n2370: \n2371: In the mean-field limit, this corresponds to convolution with the Gaussian kernel:\n2372: \n2373: $$\n2374: \\rho_{\\text{post-clone}}(x) = \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) w(y) \\rho_{\\text{pre-clone}}(y) dy\n2375: \n2376: $$\n2377: \n2378: where $w(y)$ is the fitness weighting (always positive). Since $w(y) \\geq \\eta > 0$ (floor from rescale transformation, `01_fragile_gas_framework.md`), we have:\n2379: \n2380: $$\n2381: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) \\rho_{\\text{pre-clone}}(y) dy\n2382: \n2383: $$\n2384: \n2385: Applying Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`:\n2386: \n2387: $$\n2388: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\cdot c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n2389: \n2390: $$\n2391: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-qsd-strict-positivity",
      "title": "QSD Strict Positivity",
      "start_line": 2395,
      "end_line": 2485,
      "header_lines": [
        2396
      ],
      "content_start": 2398,
      "content_end": 2484,
      "content": "2398: :label: lem-qsd-strict-positivity\n2399: \n2400: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ has a smooth density with respect to Lebesgue measure that satisfies\n2401: \n2402: $$\n2403: \\inf_{(x,v) \\in \\Omega} \\pi_{\\text{QSD}}(x, v) \\geq c_\\pi > 0,\n2404: $$\n2405: \n2406: where $\\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$ and\n2407: \n2408: $$\n2409: c_\\pi = \\big(\\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R}\\big) \\, m_{\\text{eq}},\n2410: \\qquad\n2411: c_{\\text{vel}} := (2\\pi\\sigma_v^2 \\beta_\\star)^{-d/2} \\exp\\!\\left(-\\frac{4 V_{\\max}^2}{2 \\sigma_v^2 \\beta_\\star}\\right).\n2412: $$\n2413: \n2414: Here $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ and $\\beta_\\star = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$ for a fixed velocity-refresh time $\\tau_v > 0$.\n2415: \n2416: **Proof**:\n2417: \n2418: **Step 1 (Velocity Refresh via Ornstein-Uhlenbeck Block)**  \n2419: During a kinetic window of length $\\tau_v$, the BAOAB operator evolves the velocity according to\n2420: \n2421: $$\n2422: p_v^{\\text{OU}}(\\tau_v; v_0, v)\n2423: = (2\\pi\\sigma_v^2 \\beta(\\tau_v))^{-d/2}\n2424: \\exp\\!\\left(-\\frac{|v - e^{-\\gamma \\tau_v} v_0|^2}{2 \\sigma_v^2 \\beta(\\tau_v)}\\right),\n2425: $$\n2426: \n2427: with $\\beta(\\tau_v) = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$. Because $V_{\\text{alg}}$ is compact ($|v| \\leq V_{\\max}$), choosing $\\tau_v$ so that $\\beta(\\tau_v) \\geq \\beta_\\star>0$ gives\n2428: \n2429: $$\n2430: p_v^{\\text{OU}}(\\tau_v; v_0, v) \\geq c_{\\text{vel}}\n2431: \\quad \\text{for all } v_0, v \\in V_{\\text{alg}}.\n2432: $$\n2433: \n2434: Hence a single kinetic block already spreads mass over **all** velocity directions with a state-independent density floor.\n2435: \n2436: **Step 2 (Spatial Mollification Without Velocity Restriction)**  \n2437: Conditioned on any $(x_1, v_1)$ produced by Step 1, the cloning kernel\n2438: \n2439: $$\n2440: K_{\\text{clone}}\\big((x_1, v_1), (x, v)\\big)\n2441: = \\eta \\, G_{\\sigma_x}(x - x_1) \\, \\delta(v - v_1)\n2442: $$\n2443: \n2444: acts on the position coordinate. Lemma {prf:ref}`lem-gaussian-kernel-lower-bound` implies\n2445: \n2446: $$\n2447: G_{\\sigma_x}(x - x_1) \\geq c_{\\sigma_x, R}\n2448: \\qquad \\forall x, x_1 \\in \\mathcal{X}_{\\text{valid}},\n2449: $$\n2450: \n2451: so positions are minorized by Lebesgue measure independently of the pre-cloning state.\n2452: \n2453: **Step 3 (Two-Step Doeblin Minorization)**  \n2454: Let $P^{(2)}$ denote “kinetic over $\\tau_v$” composed with “cloning.” For any measurable $A \\subseteq \\Omega$,\n2455: \n2456: $$\n2457: P^{(2)}((x_0, v_0), A)\n2458: = \\int_\\Omega p_v^{\\text{OU}}(\\tau_v; v_0, v_1) K_{\\text{clone}}\\big((x_1, v_1), A\\big) \\, dx_1 \\, dv_1\n2459: \\geq \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R} \\, |A|,\n2460: $$\n2461: \n2462: where $|A|$ is the Lebesgue measure of $A$ in $\\Omega$. Thus $P^{(2)}$ satisfies a genuine Doeblin condition\n2463: \n2464: $$\n2465: P^{(2)}(z, A) \\geq \\delta_2 \\, \\nu(A),\n2466: \\qquad\n2467: \\delta_2 := \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R},\n2468: $$\n2469: \n2470: with state-independent minorization measure $\\nu(A) = |A|/|\\Omega|$.\n2471: \n2472: **Step 4 (Transfer to the QSD)**  \n2473: For the invariant quasi-stationary distribution,\n2474: \n2475: $$\n2476: \\pi_{\\text{QSD}}(A)\n2477: = \\int_\\Omega P^{(2)}(z, A) \\, \\pi_{\\text{QSD}}(dz)\n2478: \\geq \\delta_2 \\, m_{\\text{eq}} \\, \\nu(A),\n2479: $$\n2480: \n2481: so $\\pi_{\\text{QSD}}$ possesses a density bounded below by $c_\\pi = \\delta_2 m_{\\text{eq}} / |\\Omega|$ at every point of $\\Omega$.\n2482: \n2483: **Step 5 (Smoothness)**  \n2484: Lemma {prf:ref}`lem-linfty-full-operator` provides hypoelliptic smoothing, giving $\\pi_{\\text{QSD}} \\in C^\\infty(\\Omega)$ and promoting the almost-everywhere lower bound to a pointwise one.",
      "metadata": {
        "label": "lem-qsd-strict-positivity"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "2395: #### 3.3. QSD Density Lower Bound via Multi-Step Minorization\n2396: \n2397: :::{prf:lemma} QSD Strict Positivity\n2398: :label: lem-qsd-strict-positivity\n2399: \n2400: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ has a smooth density with respect to Lebesgue measure that satisfies\n2401: \n2402: $$\n2403: \\inf_{(x,v) \\in \\Omega} \\pi_{\\text{QSD}}(x, v) \\geq c_\\pi > 0,\n2404: $$\n2405: \n2406: where $\\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$ and\n2407: \n2408: $$\n2409: c_\\pi = \\big(\\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R}\\big) \\, m_{\\text{eq}},\n2410: \\qquad\n2411: c_{\\text{vel}} := (2\\pi\\sigma_v^2 \\beta_\\star)^{-d/2} \\exp\\!\\left(-\\frac{4 V_{\\max}^2}{2 \\sigma_v^2 \\beta_\\star}\\right).\n2412: $$\n2413: \n2414: Here $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ and $\\beta_\\star = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$ for a fixed velocity-refresh time $\\tau_v > 0$.\n2415: \n2416: **Proof**:\n2417: \n2418: **Step 1 (Velocity Refresh via Ornstein-Uhlenbeck Block)**  \n2419: During a kinetic window of length $\\tau_v$, the BAOAB operator evolves the velocity according to\n2420: \n2421: $$\n2422: p_v^{\\text{OU}}(\\tau_v; v_0, v)\n2423: = (2\\pi\\sigma_v^2 \\beta(\\tau_v))^{-d/2}\n2424: \\exp\\!\\left(-\\frac{|v - e^{-\\gamma \\tau_v} v_0|^2}{2 \\sigma_v^2 \\beta(\\tau_v)}\\right),\n2425: $$\n2426: \n2427: with $\\beta(\\tau_v) = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$. Because $V_{\\text{alg}}$ is compact ($|v| \\leq V_{\\max}$), choosing $\\tau_v$ so that $\\beta(\\tau_v) \\geq \\beta_\\star>0$ gives\n2428: \n2429: $$\n2430: p_v^{\\text{OU}}(\\tau_v; v_0, v) \\geq c_{\\text{vel}}\n2431: \\quad \\text{for all } v_0, v \\in V_{\\text{alg}}.\n2432: $$\n2433: \n2434: Hence a single kinetic block already spreads mass over **all** velocity directions with a state-independent density floor.\n2435: \n2436: **Step 2 (Spatial Mollification Without Velocity Restriction)**  \n2437: Conditioned on any $(x_1, v_1)$ produced by Step 1, the cloning kernel\n2438: \n2439: $$\n2440: K_{\\text{clone}}\\big((x_1, v_1), (x, v)\\big)\n2441: = \\eta \\, G_{\\sigma_x}(x - x_1) \\, \\delta(v - v_1)\n2442: $$\n2443: \n2444: acts on the position coordinate. Lemma {prf:ref}`lem-gaussian-kernel-lower-bound` implies\n2445: \n2446: $$\n2447: G_{\\sigma_x}(x - x_1) \\geq c_{\\sigma_x, R}\n2448: \\qquad \\forall x, x_1 \\in \\mathcal{X}_{\\text{valid}},\n2449: $$\n2450: \n2451: so positions are minorized by Lebesgue measure independently of the pre-cloning state.\n2452: \n2453: **Step 3 (Two-Step Doeblin Minorization)**  \n2454: Let $P^{(2)}$ denote “kinetic over $\\tau_v$” composed with “cloning.” For any measurable $A \\subseteq \\Omega$,\n2455: \n2456: $$\n2457: P^{(2)}((x_0, v_0), A)\n2458: = \\int_\\Omega p_v^{\\text{OU}}(\\tau_v; v_0, v_1) K_{\\text{clone}}\\big((x_1, v_1), A\\big) \\, dx_1 \\, dv_1\n2459: \\geq \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R} \\, |A|,\n2460: $$\n2461: \n2462: where $|A|$ is the Lebesgue measure of $A$ in $\\Omega$. Thus $P^{(2)}$ satisfies a genuine Doeblin condition\n2463: \n2464: $$\n2465: P^{(2)}(z, A) \\geq \\delta_2 \\, \\nu(A),\n2466: \\qquad\n2467: \\delta_2 := \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R},\n2468: $$\n2469: \n2470: with state-independent minorization measure $\\nu(A) = |A|/|\\Omega|$.\n2471: \n2472: **Step 4 (Transfer to the QSD)**  \n2473: For the invariant quasi-stationary distribution,\n2474: \n2475: $$\n2476: \\pi_{\\text{QSD}}(A)\n2477: = \\int_\\Omega P^{(2)}(z, A) \\, \\pi_{\\text{QSD}}(dz)\n2478: \\geq \\delta_2 \\, m_{\\text{eq}} \\, \\nu(A),\n2479: $$\n2480: \n2481: so $\\pi_{\\text{QSD}}$ possesses a density bounded below by $c_\\pi = \\delta_2 m_{\\text{eq}} / |\\Omega|$ at every point of $\\Omega$.\n2482: \n2483: **Step 5 (Smoothness)**  \n2484: Lemma {prf:ref}`lem-linfty-full-operator` provides hypoelliptic smoothing, giving $\\pi_{\\text{QSD}} \\in C^\\infty(\\Omega)$ and promoting the almost-everywhere lower bound to a pointwise one.\n2485: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mass-lower-bound-high-prob",
      "title": "High-Probability Alive Mass Lower Bound",
      "start_line": 2570,
      "end_line": 2689,
      "header_lines": [
        2571
      ],
      "content_start": 2573,
      "content_end": 2688,
      "content": "2573: :label: lem-mass-lower-bound-high-prob\n2574: \n2575: For the Euclidean Gas with $N$ walkers there exist constants $c_{\\text{mass}}, C, \\delta > 0$, depending only on $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ and the initial mass $m_0$, such that for every $t \\geq 0$\n2576: \n2577: $$\n2578: \\mathbb{P}\\!\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - C (1+t) e^{-\\delta N}.\n2579: $$\n2580: \n2581: **Proof (full-process spectral gap + logistic ODE)**:\n2582: \n2583: We split the argument into an **early-time deterministic floor** and a **late-time concentration regime**. Throughout we denote $k_t = k_t(\\omega)$ the number of alive walkers and $m_a(t) = \\|\\rho_t\\|_{L^1}$ the PDE mass.\n2584: \n2585: **Step 0: Deterministic floor on $[0, t_{\\text{eq}}]$ via logistic ODE**  \n2586: The mass equation derived in `07_mean_field.md` reads\n2587: \n2588: $$\n2589: \\frac{d}{dt} m_a(t) = -\\int_\\Omega c(z) \\rho_t(z) dz + \\lambda_{\\text{rev}} \\big( 1 - m_a(t) \\big).\n2590: $$\n2591: \n2592: Using $\\int c(z) \\rho_t(z) dz \\leq c_{\\max} m_a(t)$, we obtain the comparison inequality\n2593: \n2594: $$\n2595: \\frac{d}{dt} m_a(t) \\geq - (c_{\\max} + \\lambda_{\\text{rev}}) m_a(t) + \\lambda_{\\text{rev}}.\n2596: $$\n2597: \n2598: Solving gives the explicit lower envelope\n2599: \n2600: $$\n2601: m_{\\text{floor}}(t)\n2602: = m_\\infty - \\big(m_\\infty - m_0\\big) e^{-(c_{\\max} + \\lambda_{\\text{rev}}) t},\n2603: \\qquad\n2604: m_\\infty = \\frac{\\lambda_{\\text{rev}}}{c_{\\max} + \\lambda_{\\text{rev}}} > 0.\n2605: $$\n2606: \n2607: Hence $m_a(t) \\geq m_{\\text{floor}}(t)$ for all $t \\geq 0$. Choosing the equilibration time $t_{\\text{eq}} = O(\\kappa_{\\text{QSD}}^{-1} \\log N)$, we set\n2608: \n2609: $$\n2610: c_{\\text{early}} := \\frac{1}{2} \\min_{0 \\leq s \\leq t_{\\text{eq}}} m_{\\text{floor}}(s) > 0.\n2611: $$\n2612: \n2613: The propagation-of-chaos estimate proved in Section 4.5 (Proposition {prf:ref}`prop-poc-mass`) states that, for any $\\epsilon > 0$,\n2614: \n2615: $$\n2616: \\mathbb{P}\\left( \\sup_{0 \\leq s \\leq t_{\\text{eq}}} \\left| \\frac{k_s}{N} - m_a(s) \\right| > \\epsilon \\right) \\leq C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N \\epsilon^2}.\n2617: $$\n2618: \n2619: Taking $\\epsilon = c_{\\text{early}}$ yields the early-time event\n2620: \n2621: $$\n2622: \\mathbb{P}\\left( \\inf_{0 \\leq s \\leq t_{\\text{eq}}} \\frac{k_s}{N} \\geq c_{\\text{early}} \\right) \\geq 1 - C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N c_{\\text{early}}^2}.\n2623: $$\n2624: \n2625: This establishes the desired floor on $[0, t_{\\text{eq}}]$.\n2626: \n2627: **Step 1: Spectral gap for configuration observables (removing the Markov assumption on $k_t$)**  \n2628: The $N$-particle process $Z_t = (z_t^{(1)}, \\ldots, z_t^{(N)})$ is geometrically ergodic with spectral gap $\\kappa_{\\text{full}} > 0$ in $L^2(\\Pi_{\\text{QSD}}^{(N)})$ (Theorem 4.5 of `06_convergence.md`). For any observable $F : \\Omega^N \\to \\mathbb{R}$,\n2629: \n2630: $$\n2631: \\text{Var}_{\\Pi_{\\text{QSD}}^{(N)}}(F) \\leq \\frac{1}{\\kappa_{\\text{full}}} \\langle -\\mathcal{L}^{(N)} F, F \\rangle.\n2632: $$\n2633: \n2634: We apply this to $F(Z) = k(Z)/N = N^{-1} \\sum_{i=1}^N \\mathbf{1}_{\\{\\text{walker } i \\text{ alive}\\}}$. Changing a single coordinate alters $F$ by at most $1/N$, so $F$ is $1/N$-Lipschitz with respect to the Hamming metric. By the Herbst argument for Markov semigroups with spectral gap (see, e.g., Joulin & Ollivier 2010, Theorem 5.1), $F$ satisfies\n2635: \n2636: $$\n2637: \\Pi_{\\text{QSD}}^{(N)}\\!\\left( \\left| \\frac{k}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n2638: \\leq 2 \\exp\\!\\left( - \\frac{\\kappa_{\\text{full}} N^2 r^2}{2} \\right)\n2639: \\leq 2 \\exp\\!\\left( - \\beta_{\\text{gap}} N r^2 \\right),\n2640: $$\n2641: \n2642: where we set $\\beta_{\\text{gap}} := \\kappa_{\\text{full}} / 2$ (the second inequality uses $N^2 \\geq N$ so the exponent now scales linearly in $N$).\n2643: \n2644: This argument works directly on the full configuration process $Z_t$; no Markov property for the projected count $k_t$ is required, thereby correcting the earlier (invalid) reduction to a standalone birth-death chain.\n2645: \n2646: **Step 2: Finite-time concentration after equilibration**  \n2647: Let $\\mathcal{L}_t$ be the law of $Z_t$ starting from any initial configuration with alive mass at least $c_{\\text{early}}$. By Theorem 4.5 of `06_convergence.md`,\n2648: \n2649: $$\n2650: \\|\\mathcal{L}_t - \\Pi_{\\text{QSD}}^{(N)}\\|_{\\text{TV}}\n2651: \\leq C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})} \\quad \\text{for } t \\geq t_{\\text{eq}}.\n2652: $$\n2653: \n2654: Therefore, for $t \\geq t_{\\text{eq}}$ and any $r > 0$,\n2655: \n2656: $$\n2657: \\mathbb{P}\\left( \\left| \\frac{k_t}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n2658: \\leq 2 e^{-\\beta_{\\text{gap}} N r^2} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n2659: $$\n2660: \n2661: Selecting $r = m_{\\text{eq}}/2$ yields\n2662: \n2663: $$\n2664: \\mathbb{P}\\left( \\frac{k_t}{N} \\leq \\frac{m_{\\text{eq}}}{2} \\right)\n2665: \\leq 2 e^{-\\beta_{\\text{gap}} N m_{\\text{eq}}^2 / 4} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n2666: $$\n2667: \n2668: **Step 3: Survival conditioning**  \n2669: The survival estimate of Theorem {prf:ref}`thm-exponential-survival` gives\n2670: \n2671: $$\n2672: \\mathbb{P}(\\tau_\\dagger \\leq t) \\leq t e^{-C_{\\text{surv}} N}.\n2673: $$\n2674: \n2675: Intersecting the complementary survival event with the concentration events from Steps 0-2 shows that, for all $t \\geq 0$,\n2676: \n2677: $$\n2678: \\mathbb{P}\\left( \\frac{k_t}{N} \\geq \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right) \\right)\n2679: \\geq 1 - C (1+t) e^{-\\delta N},\n2680: $$\n2681: \n2682: with $\\delta = \\min(\\beta_{\\text{pc}} c_{\\text{early}}^2, \\beta_{\\text{gap}} m_{\\text{eq}}^2/4, C_{\\text{surv}})$.\n2683: \n2684: Setting\n2685: \n2686: $$\n2687: c_{\\text{mass}} := \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right)\n2688: $$",
      "metadata": {
        "label": "lem-mass-lower-bound-high-prob"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "2570: #### 4.3. High-Probability Mass Lower Bound\n2571: \n2572: :::{prf:lemma} High-Probability Alive Mass Lower Bound\n2573: :label: lem-mass-lower-bound-high-prob\n2574: \n2575: For the Euclidean Gas with $N$ walkers there exist constants $c_{\\text{mass}}, C, \\delta > 0$, depending only on $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ and the initial mass $m_0$, such that for every $t \\geq 0$\n2576: \n2577: $$\n2578: \\mathbb{P}\\!\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - C (1+t) e^{-\\delta N}.\n2579: $$\n2580: \n2581: **Proof (full-process spectral gap + logistic ODE)**:\n2582: \n2583: We split the argument into an **early-time deterministic floor** and a **late-time concentration regime**. Throughout we denote $k_t = k_t(\\omega)$ the number of alive walkers and $m_a(t) = \\|\\rho_t\\|_{L^1}$ the PDE mass.\n2584: \n2585: **Step 0: Deterministic floor on $[0, t_{\\text{eq}}]$ via logistic ODE**  \n2586: The mass equation derived in `07_mean_field.md` reads\n2587: \n2588: $$\n2589: \\frac{d}{dt} m_a(t) = -\\int_\\Omega c(z) \\rho_t(z) dz + \\lambda_{\\text{rev}} \\big( 1 - m_a(t) \\big).\n2590: $$\n2591: \n2592: Using $\\int c(z) \\rho_t(z) dz \\leq c_{\\max} m_a(t)$, we obtain the comparison inequality\n2593: \n2594: $$\n2595: \\frac{d}{dt} m_a(t) \\geq - (c_{\\max} + \\lambda_{\\text{rev}}) m_a(t) + \\lambda_{\\text{rev}}.\n2596: $$\n2597: \n2598: Solving gives the explicit lower envelope\n2599: \n2600: $$\n2601: m_{\\text{floor}}(t)\n2602: = m_\\infty - \\big(m_\\infty - m_0\\big) e^{-(c_{\\max} + \\lambda_{\\text{rev}}) t},\n2603: \\qquad\n2604: m_\\infty = \\frac{\\lambda_{\\text{rev}}}{c_{\\max} + \\lambda_{\\text{rev}}} > 0.\n2605: $$\n2606: \n2607: Hence $m_a(t) \\geq m_{\\text{floor}}(t)$ for all $t \\geq 0$. Choosing the equilibration time $t_{\\text{eq}} = O(\\kappa_{\\text{QSD}}^{-1} \\log N)$, we set\n2608: \n2609: $$\n2610: c_{\\text{early}} := \\frac{1}{2} \\min_{0 \\leq s \\leq t_{\\text{eq}}} m_{\\text{floor}}(s) > 0.\n2611: $$\n2612: \n2613: The propagation-of-chaos estimate proved in Section 4.5 (Proposition {prf:ref}`prop-poc-mass`) states that, for any $\\epsilon > 0$,\n2614: \n2615: $$\n2616: \\mathbb{P}\\left( \\sup_{0 \\leq s \\leq t_{\\text{eq}}} \\left| \\frac{k_s}{N} - m_a(s) \\right| > \\epsilon \\right) \\leq C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N \\epsilon^2}.\n2617: $$\n2618: \n2619: Taking $\\epsilon = c_{\\text{early}}$ yields the early-time event\n2620: \n2621: $$\n2622: \\mathbb{P}\\left( \\inf_{0 \\leq s \\leq t_{\\text{eq}}} \\frac{k_s}{N} \\geq c_{\\text{early}} \\right) \\geq 1 - C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N c_{\\text{early}}^2}.\n2623: $$\n2624: \n2625: This establishes the desired floor on $[0, t_{\\text{eq}}]$.\n2626: \n2627: **Step 1: Spectral gap for configuration observables (removing the Markov assumption on $k_t$)**  \n2628: The $N$-particle process $Z_t = (z_t^{(1)}, \\ldots, z_t^{(N)})$ is geometrically ergodic with spectral gap $\\kappa_{\\text{full}} > 0$ in $L^2(\\Pi_{\\text{QSD}}^{(N)})$ (Theorem 4.5 of `06_convergence.md`). For any observable $F : \\Omega^N \\to \\mathbb{R}$,\n2629: \n2630: $$\n2631: \\text{Var}_{\\Pi_{\\text{QSD}}^{(N)}}(F) \\leq \\frac{1}{\\kappa_{\\text{full}}} \\langle -\\mathcal{L}^{(N)} F, F \\rangle.\n2632: $$\n2633: \n2634: We apply this to $F(Z) = k(Z)/N = N^{-1} \\sum_{i=1}^N \\mathbf{1}_{\\{\\text{walker } i \\text{ alive}\\}}$. Changing a single coordinate alters $F$ by at most $1/N$, so $F$ is $1/N$-Lipschitz with respect to the Hamming metric. By the Herbst argument for Markov semigroups with spectral gap (see, e.g., Joulin & Ollivier 2010, Theorem 5.1), $F$ satisfies\n2635: \n2636: $$\n2637: \\Pi_{\\text{QSD}}^{(N)}\\!\\left( \\left| \\frac{k}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n2638: \\leq 2 \\exp\\!\\left( - \\frac{\\kappa_{\\text{full}} N^2 r^2}{2} \\right)\n2639: \\leq 2 \\exp\\!\\left( - \\beta_{\\text{gap}} N r^2 \\right),\n2640: $$\n2641: \n2642: where we set $\\beta_{\\text{gap}} := \\kappa_{\\text{full}} / 2$ (the second inequality uses $N^2 \\geq N$ so the exponent now scales linearly in $N$).\n2643: \n2644: This argument works directly on the full configuration process $Z_t$; no Markov property for the projected count $k_t$ is required, thereby correcting the earlier (invalid) reduction to a standalone birth-death chain.\n2645: \n2646: **Step 2: Finite-time concentration after equilibration**  \n2647: Let $\\mathcal{L}_t$ be the law of $Z_t$ starting from any initial configuration with alive mass at least $c_{\\text{early}}$. By Theorem 4.5 of `06_convergence.md`,\n2648: \n2649: $$\n2650: \\|\\mathcal{L}_t - \\Pi_{\\text{QSD}}^{(N)}\\|_{\\text{TV}}\n2651: \\leq C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})} \\quad \\text{for } t \\geq t_{\\text{eq}}.\n2652: $$\n2653: \n2654: Therefore, for $t \\geq t_{\\text{eq}}$ and any $r > 0$,\n2655: \n2656: $$\n2657: \\mathbb{P}\\left( \\left| \\frac{k_t}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n2658: \\leq 2 e^{-\\beta_{\\text{gap}} N r^2} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n2659: $$\n2660: \n2661: Selecting $r = m_{\\text{eq}}/2$ yields\n2662: \n2663: $$\n2664: \\mathbb{P}\\left( \\frac{k_t}{N} \\leq \\frac{m_{\\text{eq}}}{2} \\right)\n2665: \\leq 2 e^{-\\beta_{\\text{gap}} N m_{\\text{eq}}^2 / 4} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n2666: $$\n2667: \n2668: **Step 3: Survival conditioning**  \n2669: The survival estimate of Theorem {prf:ref}`thm-exponential-survival` gives\n2670: \n2671: $$\n2672: \\mathbb{P}(\\tau_\\dagger \\leq t) \\leq t e^{-C_{\\text{surv}} N}.\n2673: $$\n2674: \n2675: Intersecting the complementary survival event with the concentration events from Steps 0-2 shows that, for all $t \\geq 0$,\n2676: \n2677: $$\n2678: \\mathbb{P}\\left( \\frac{k_t}{N} \\geq \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right) \\right)\n2679: \\geq 1 - C (1+t) e^{-\\delta N},\n2680: $$\n2681: \n2682: with $\\delta = \\min(\\beta_{\\text{pc}} c_{\\text{early}}^2, \\beta_{\\text{gap}} m_{\\text{eq}}^2/4, C_{\\text{surv}})$.\n2683: \n2684: Setting\n2685: \n2686: $$\n2687: c_{\\text{mass}} := \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right)\n2688: $$\n2689: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-linearized-spectral-gap",
      "title": "Exponential Decay in L¹ for Linearized Dynamics",
      "start_line": 3033,
      "end_line": 3068,
      "header_lines": [
        3034
      ],
      "content_start": 3036,
      "content_end": 3067,
      "content": "3036: :label: lem-linearized-spectral-gap\n3037: \n3038: The linearized operator $\\mathbb{L}^*$ around $\\pi_{\\text{QSD}}$ has a **spectral gap** in $L^2(\\pi_{\\text{QSD}})$:\n3039: \n3040: $$\n3041: \\mathbb{L}^* = -\\kappa_{\\text{lin}} + \\text{compact}\n3042: \n3043: $$\n3044: \n3045: where $\\kappa_{\\text{lin}} > 0$ is the gap. For any perturbation $\\eta_0$ with $\\|\\eta_0\\|_{L^1} \\leq \\delta$ sufficiently small, the linearized evolution satisfies:\n3046: \n3047: $$\n3048: \\|\\eta_t\\|_{L^1} \\leq \\|\\eta_0\\|_{L^1} e^{-\\kappa_{\\text{lin}} t / 2}\n3049: \n3050: $$\n3051: \n3052: for all $t \\geq 0$, provided $\\delta < \\delta_0$ for some threshold $\\delta_0$ determined by the nonlinearity $C_{\\text{nonlin}}$.\n3053: \n3054: **Proof Sketch**:\n3055: \n3056: This follows from standard perturbation theory for nonlinear parabolic equations:\n3057: \n3058: 1. **Spectral Gap**: The operator $\\mathbb{L}^*$ is the linearization of a hypoelliptic kinetic operator with compact perturbations (cloning, killing, revival). By the results in `06_convergence.md` (geometric ergodicity with rate $\\kappa_{\\text{QSD}}$), the linearized operator has a spectral gap $\\kappa_{\\text{lin}} \\approx \\kappa_{\\text{QSD}}$.\n3059: \n3060: 2. **Nonlinear Stability**: For the nonlinear equation $\\partial_t \\eta = \\mathbb{L}^* \\eta + \\mathcal{N}[\\eta]$, we use a Grönwall-type argument. The $L^1$ norm evolves as:\n3061: \n3062: $$\n3063: \\frac{d}{dt} \\|\\eta_t\\|_{L^1} \\leq -\\kappa_{\\text{lin}} \\|\\eta_t\\|_{L^1} + C_{\\text{nonlin}} \\|\\eta_t\\|_{L^1}^2\n3064: \n3065: $$\n3066: \n3067: For $\\|\\eta_0\\|_{L^1} \\leq \\delta_0 := \\kappa_{\\text{lin}} / (2 C_{\\text{nonlin}})$, the linear term dominates and we obtain exponential decay with rate $\\kappa_{\\text{lin}} / 2$.",
      "metadata": {
        "label": "lem-linearized-spectral-gap"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "3033: **Step 2B: Spectral Gap of the Linearized Operator**\n3034: \n3035: :::{prf:lemma} Exponential Decay in L¹ for Linearized Dynamics\n3036: :label: lem-linearized-spectral-gap\n3037: \n3038: The linearized operator $\\mathbb{L}^*$ around $\\pi_{\\text{QSD}}$ has a **spectral gap** in $L^2(\\pi_{\\text{QSD}})$:\n3039: \n3040: $$\n3041: \\mathbb{L}^* = -\\kappa_{\\text{lin}} + \\text{compact}\n3042: \n3043: $$\n3044: \n3045: where $\\kappa_{\\text{lin}} > 0$ is the gap. For any perturbation $\\eta_0$ with $\\|\\eta_0\\|_{L^1} \\leq \\delta$ sufficiently small, the linearized evolution satisfies:\n3046: \n3047: $$\n3048: \\|\\eta_t\\|_{L^1} \\leq \\|\\eta_0\\|_{L^1} e^{-\\kappa_{\\text{lin}} t / 2}\n3049: \n3050: $$\n3051: \n3052: for all $t \\geq 0$, provided $\\delta < \\delta_0$ for some threshold $\\delta_0$ determined by the nonlinearity $C_{\\text{nonlin}}$.\n3053: \n3054: **Proof Sketch**:\n3055: \n3056: This follows from standard perturbation theory for nonlinear parabolic equations:\n3057: \n3058: 1. **Spectral Gap**: The operator $\\mathbb{L}^*$ is the linearization of a hypoelliptic kinetic operator with compact perturbations (cloning, killing, revival). By the results in `06_convergence.md` (geometric ergodicity with rate $\\kappa_{\\text{QSD}}$), the linearized operator has a spectral gap $\\kappa_{\\text{lin}} \\approx \\kappa_{\\text{QSD}}$.\n3059: \n3060: 2. **Nonlinear Stability**: For the nonlinear equation $\\partial_t \\eta = \\mathbb{L}^* \\eta + \\mathcal{N}[\\eta]$, we use a Grönwall-type argument. The $L^1$ norm evolves as:\n3061: \n3062: $$\n3063: \\frac{d}{dt} \\|\\eta_t\\|_{L^1} \\leq -\\kappa_{\\text{lin}} \\|\\eta_t\\|_{L^1} + C_{\\text{nonlin}} \\|\\eta_t\\|_{L^1}^2\n3064: \n3065: $$\n3066: \n3067: For $\\|\\eta_0\\|_{L^1} \\leq \\delta_0 := \\kappa_{\\text{lin}} / (2 C_{\\text{nonlin}})$, the linear term dominates and we obtain exponential decay with rate $\\kappa_{\\text{lin}} / 2$.\n3068: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hypoellipticity-full-linearized",
      "title": "Hypoellipticity Preservation via Bootstrap Argument",
      "start_line": 3074,
      "end_line": 3158,
      "header_lines": [
        3075
      ],
      "content_start": 3077,
      "content_end": 3157,
      "content": "3077: :label: lem-hypoellipticity-full-linearized\n3078: \n3079: The linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` is **hypoelliptic** in the sense that:\n3080: \n3081: If $\\partial_t \\eta = \\mathbb{L}^* \\eta$ with initial condition $\\eta_0 \\in L^1(\\Omega)$, then for any $t > 0$, the solution $\\eta_t \\in C^\\infty(\\Omega)$.\n3082: \n3083: **Proof**:\n3084: \n3085: The proof uses a **bootstrap argument** that separates the \"regularizing engine\" (kinetic operator) from the \"source terms\" (nonlocal operators).\n3086: \n3087: **Step 1: Isolate the Hypoelliptic Engine**\n3088: \n3089: Rearrange the evolution equation:\n3090: \n3091: $$\n3092: \\frac{\\partial \\eta}{\\partial t} - \\mathcal{L}_{\\text{kin}}^* \\eta = f[\\eta]\n3093: \n3094: $$\n3095: \n3096: where the \"source term\" is:\n3097: \n3098: $$\n3099: f[\\eta] := \\mathbb{L}_{\\text{clone}}^* \\eta - c(z) \\eta + \\mathbb{L}_{\\text{revival}}^* \\eta\n3100: \n3101: $$\n3102: \n3103: Define the hypoelliptic operator $\\mathbb{L}_{\\text{hypo}} := \\partial_t - \\mathcal{L}_{\\text{kin}}^*$. By Lemma {prf:ref}`lem-hormander-bracket` (Section 2.2), this operator satisfies Hörmander's bracket condition, making it hypoelliptic.\n3104: \n3105: **Step 2: Hörmander's Theorem**\n3106: \n3107: By Hörmander's theorem (Hörmander 1967, *Acta Math.* 119:147-171), if $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ and the source term $f \\in C^k(\\Omega)$ for some $k \\geq 0$, then the solution $\\eta$ is automatically smoother: $\\eta \\in C^{k+\\alpha}(\\Omega)$ for some $\\alpha > 0$ (and in fact, $\\eta \\in C^\\infty$ if $f \\in C^\\infty$).\n3108: \n3109: **Step 3: Regularity of the Source Term**\n3110: \n3111: The key observation is that **if $\\eta \\in C^k$, then $f[\\eta] \\in C^k$**. We verify each component:\n3112: \n3113: **Cloning operator**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator is:\n3114: \n3115: $$\n3116: \\mathbb{L}_{\\text{clone}}^* \\eta = \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n3117: \n3118: $$\n3119: \n3120: This is a convolution with the Gaussian kernel $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x - x') \\delta(v - v')$ plus multiplication by the fitness functional $V[\\pi]$ and its derivative $V'[\\pi]$.\n3121: \n3122: - The Gaussian kernel $G_{\\sigma_x}$ is $C^\\infty$ (analytic).\n3123: - The fitness functional $V[\\pi]$ depends on the potential $U$ and the virtual reward mechanism. From the Fragile framework (`02_euclidean_gas.md`, Axiom of Smooth Potential), the potential $U \\in C^\\infty(\\mathcal{X})$. The virtual reward is a functional of integrals of $\\pi$, which are smooth.\n3124: - **Conclusion**: Convolution with a $C^\\infty$ kernel preserves regularity. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{clone}}^* \\eta \\in C^k$.\n3125: \n3126: **Killing term**: $-c(z) \\eta$ where $c(z) \\geq 0$ is the killing rate. From the framework, $c(z)$ is smooth (defined by the domain boundaries with smooth indicator functions). If $\\eta \\in C^k$, then $c(z) \\eta \\in C^k$.\n3127: \n3128: **Revival term**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized revival operator is:\n3129: \n3130: $$\n3131: \\mathbb{L}_{\\text{revival}}^* \\eta = \\lambda_{\\text{rev}} \\frac{m_d}{m_{\\text{eq}}} \\left( f_{\\text{safe}} \\eta - \\frac{f_{\\text{safe}}}{m_{\\text{eq}}} \\int \\eta \\, dz \\right)\n3132: \n3133: $$\n3134: \n3135: where $f_{\\text{safe}}$ is the revival distribution (smooth by framework assumptions). The integral $\\int \\eta \\, dz$ is a scalar. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{revival}}^* \\eta \\in C^k$.\n3136: \n3137: **Overall**: All components of $f[\\eta]$ preserve regularity, so $\\eta \\in C^k \\Rightarrow f[\\eta] \\in C^k$.\n3138: \n3139: **Step 4: Bootstrap Loop**\n3140: \n3141: 1. **Initial regularity**: From basic parabolic theory, for short time $t > 0$, the solution $\\eta_t$ is at least continuous: $\\eta_t \\in C^0(\\Omega)$.\n3142: \n3143: 2. **Bootstrap iteration**: Assume $\\eta \\in C^k$ for some $k \\geq 0$. Then:\n3144:    - By Step 3, $f[\\eta] \\in C^k$\n3145:    - By Hörmander's theorem (Step 2), $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ implies $\\eta \\in C^{k+\\alpha}$\n3146:    - Therefore, $\\eta$ is strictly smoother than we assumed\n3147: \n3148: 3. **Infinite iteration**: Repeating this argument indefinitely, we conclude $\\eta \\in C^\\infty(\\Omega)$ for all $t > 0$.\n3149: \n3150: **Step 5: Nash-Aronson Applicability**\n3151: \n3152: Since the operator $\\mathbb{L}^*$ is hypoelliptic (produces $C^\\infty$ solutions), the standard theory of hypoelliptic parabolic equations applies. In particular:\n3153: \n3154: - The Nash inequality holds for $\\mathbb{L}^*$ (Hérau & Nier 2004, Theorem 2.1, extended to operators with smooth source terms)\n3155: - The ultracontractivity estimate (Nash-Aronson) follows from the Nash inequality via standard bootstrapping arguments (Aronson 1968; Carlen & Loss 1993)\n3156: \n3157: **Conclusion**: The full linearized operator $\\mathbb{L}^*$ is hypoelliptic, and the Nash-Aronson $L^1 \\to L^\\infty$ estimate applies to its semigroup.",
      "metadata": {
        "label": "lem-hypoellipticity-full-linearized"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "3074: Before we can apply parabolic regularity estimates (Nash-Aronson), we must establish that the full linearized operator $\\mathbb{L}^*$ (including nonlocal cloning and revival terms) preserves the hypoelliptic structure of the kinetic operator.\n3075: \n3076: :::{prf:lemma} Hypoellipticity Preservation via Bootstrap Argument\n3077: :label: lem-hypoellipticity-full-linearized\n3078: \n3079: The linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` is **hypoelliptic** in the sense that:\n3080: \n3081: If $\\partial_t \\eta = \\mathbb{L}^* \\eta$ with initial condition $\\eta_0 \\in L^1(\\Omega)$, then for any $t > 0$, the solution $\\eta_t \\in C^\\infty(\\Omega)$.\n3082: \n3083: **Proof**:\n3084: \n3085: The proof uses a **bootstrap argument** that separates the \"regularizing engine\" (kinetic operator) from the \"source terms\" (nonlocal operators).\n3086: \n3087: **Step 1: Isolate the Hypoelliptic Engine**\n3088: \n3089: Rearrange the evolution equation:\n3090: \n3091: $$\n3092: \\frac{\\partial \\eta}{\\partial t} - \\mathcal{L}_{\\text{kin}}^* \\eta = f[\\eta]\n3093: \n3094: $$\n3095: \n3096: where the \"source term\" is:\n3097: \n3098: $$\n3099: f[\\eta] := \\mathbb{L}_{\\text{clone}}^* \\eta - c(z) \\eta + \\mathbb{L}_{\\text{revival}}^* \\eta\n3100: \n3101: $$\n3102: \n3103: Define the hypoelliptic operator $\\mathbb{L}_{\\text{hypo}} := \\partial_t - \\mathcal{L}_{\\text{kin}}^*$. By Lemma {prf:ref}`lem-hormander-bracket` (Section 2.2), this operator satisfies Hörmander's bracket condition, making it hypoelliptic.\n3104: \n3105: **Step 2: Hörmander's Theorem**\n3106: \n3107: By Hörmander's theorem (Hörmander 1967, *Acta Math.* 119:147-171), if $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ and the source term $f \\in C^k(\\Omega)$ for some $k \\geq 0$, then the solution $\\eta$ is automatically smoother: $\\eta \\in C^{k+\\alpha}(\\Omega)$ for some $\\alpha > 0$ (and in fact, $\\eta \\in C^\\infty$ if $f \\in C^\\infty$).\n3108: \n3109: **Step 3: Regularity of the Source Term**\n3110: \n3111: The key observation is that **if $\\eta \\in C^k$, then $f[\\eta] \\in C^k$**. We verify each component:\n3112: \n3113: **Cloning operator**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator is:\n3114: \n3115: $$\n3116: \\mathbb{L}_{\\text{clone}}^* \\eta = \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n3117: \n3118: $$\n3119: \n3120: This is a convolution with the Gaussian kernel $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x - x') \\delta(v - v')$ plus multiplication by the fitness functional $V[\\pi]$ and its derivative $V'[\\pi]$.\n3121: \n3122: - The Gaussian kernel $G_{\\sigma_x}$ is $C^\\infty$ (analytic).\n3123: - The fitness functional $V[\\pi]$ depends on the potential $U$ and the virtual reward mechanism. From the Fragile framework (`02_euclidean_gas.md`, Axiom of Smooth Potential), the potential $U \\in C^\\infty(\\mathcal{X})$. The virtual reward is a functional of integrals of $\\pi$, which are smooth.\n3124: - **Conclusion**: Convolution with a $C^\\infty$ kernel preserves regularity. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{clone}}^* \\eta \\in C^k$.\n3125: \n3126: **Killing term**: $-c(z) \\eta$ where $c(z) \\geq 0$ is the killing rate. From the framework, $c(z)$ is smooth (defined by the domain boundaries with smooth indicator functions). If $\\eta \\in C^k$, then $c(z) \\eta \\in C^k$.\n3127: \n3128: **Revival term**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized revival operator is:\n3129: \n3130: $$\n3131: \\mathbb{L}_{\\text{revival}}^* \\eta = \\lambda_{\\text{rev}} \\frac{m_d}{m_{\\text{eq}}} \\left( f_{\\text{safe}} \\eta - \\frac{f_{\\text{safe}}}{m_{\\text{eq}}} \\int \\eta \\, dz \\right)\n3132: \n3133: $$\n3134: \n3135: where $f_{\\text{safe}}$ is the revival distribution (smooth by framework assumptions). The integral $\\int \\eta \\, dz$ is a scalar. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{revival}}^* \\eta \\in C^k$.\n3136: \n3137: **Overall**: All components of $f[\\eta]$ preserve regularity, so $\\eta \\in C^k \\Rightarrow f[\\eta] \\in C^k$.\n3138: \n3139: **Step 4: Bootstrap Loop**\n3140: \n3141: 1. **Initial regularity**: From basic parabolic theory, for short time $t > 0$, the solution $\\eta_t$ is at least continuous: $\\eta_t \\in C^0(\\Omega)$.\n3142: \n3143: 2. **Bootstrap iteration**: Assume $\\eta \\in C^k$ for some $k \\geq 0$. Then:\n3144:    - By Step 3, $f[\\eta] \\in C^k$\n3145:    - By Hörmander's theorem (Step 2), $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ implies $\\eta \\in C^{k+\\alpha}$\n3146:    - Therefore, $\\eta$ is strictly smoother than we assumed\n3147: \n3148: 3. **Infinite iteration**: Repeating this argument indefinitely, we conclude $\\eta \\in C^\\infty(\\Omega)$ for all $t > 0$.\n3149: \n3150: **Step 5: Nash-Aronson Applicability**\n3151: \n3152: Since the operator $\\mathbb{L}^*$ is hypoelliptic (produces $C^\\infty$ solutions), the standard theory of hypoelliptic parabolic equations applies. In particular:\n3153: \n3154: - The Nash inequality holds for $\\mathbb{L}^*$ (Hérau & Nier 2004, Theorem 2.1, extended to operators with smooth source terms)\n3155: - The ultracontractivity estimate (Nash-Aronson) follows from the Nash inequality via standard bootstrapping arguments (Aronson 1968; Carlen & Loss 1993)\n3156: \n3157: **Conclusion**: The full linearized operator $\\mathbb{L}^*$ is hypoelliptic, and the Nash-Aronson $L^1 \\to L^\\infty$ estimate applies to its semigroup.\n3158: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-relative-boundedness-nonlocal",
      "title": "Relative Boundedness of Nonlocal Operators",
      "start_line": 3169,
      "end_line": 3274,
      "header_lines": [
        3170
      ],
      "content_start": 3172,
      "content_end": 3273,
      "content": "3172: :label: lem-relative-boundedness-nonlocal\n3173: \n3174: The linearized nonlocal operators $\\mathbb{L}_{\\text{clone}}^*$ and $\\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` are **relatively bounded** with respect to the kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ in $L^2(\\pi_{\\text{QSD}}^{-1})$:\n3175: \n3176: $$\n3177: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2} \\leq C_1 \\|g\\|_{L^2}\n3178: $$\n3179: \n3180: $$\n3181: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq C_2 \\|g\\|_{L^2}\n3182: $$\n3183: \n3184: with constants $C_1, C_2 < \\kappa_{\\text{kin}} / 2$ where $\\kappa_{\\text{kin}} > 0$ is the kinetic spectral gap.\n3185: \n3186: **Consequence**: The full linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ retains a spectral gap:\n3187: \n3188: $$\n3189: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n3190: $$\n3191: \n3192: and the associated Dirichlet form $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle_{\\pi_{\\text{QSD}}^{-1}}$ is coercive:\n3193: \n3194: $$\n3195: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2\n3196: \n3197: $$\n3198: \n3199: **Proof**:\n3200: \n3201: **Part 1: Cloning Operator Bound**\n3202: \n3203: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator has the form:\n3204: \n3205: $$\n3206: \\mathbb{L}_{\\text{clone}}^* g(z) = \\int_\\Omega K_{\\text{clone}}(z, z') W(z, z') [g(z') - g(z)] dz'\n3207: $$\n3208: \n3209: where $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x-x') \\delta(v-v')$ is the Gaussian position kernel and $W(z, z')$ is a bounded fitness-dependent weight with $\\|W\\|_\\infty \\leq V_{\\max}$.\n3210: \n3211: By the **Schur test** for integral operators:\n3212: \n3213: $$\n3214: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2}^2 = \\int_\\Omega \\left| \\int_\\Omega K(z,z') W(z,z') [g(z') - g(z)] dz' \\right|^2 dz\n3215: $$\n3216: \n3217: Using Cauchy-Schwarz and the fact that $K$ is a probability kernel ($\\int K(z, z') dz' = 1$):\n3218: \n3219: $$\n3220: \\leq 2 V_{\\max}^2 \\left[ \\int_\\Omega |g(z')|^2 dz' + \\int_\\Omega |g(z)|^2 dz \\right] = 4 V_{\\max}^2 \\|g\\|_{L^2}^2\n3221: $$\n3222: \n3223: Therefore, $C_1 = 2 V_{\\max}$.\n3224: \n3225: **Part 2: Revival Operator Bound**\n3226: \n3227: The linearized revival operator (from Lemma {prf:ref}`lem-linearization-qsd`) has the form:\n3228: \n3229: $$\n3230: \\mathbb{L}_{\\text{revival}}^* g = \\lambda_{\\text{rev}} \\left[ \\frac{m_d}{m_{\\text{eq}}} - \\frac{\\langle g, 1 \\rangle}{m_{\\text{eq}}} \\right] f_{\\text{safe}}\n3231: $$\n3232: \n3233: where $f_{\\text{safe}}$ is the safe-region density with $\\|f_{\\text{safe}}\\|_{L^\\infty} \\leq C_{\\text{safe}}$ and $m_d, m_{\\text{eq}}$ are the dead and equilibrium masses.\n3234: \n3235: The $L^2$ norm is:\n3236: \n3237: $$\n3238: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq \\lambda_{\\text{rev}} \\left( \\frac{\\|c\\|_\\infty m_{\\text{eq}}}{m_{\\text{eq}}} + \\frac{|\\langle g, 1 \\rangle|}{m_{\\text{eq}}} \\right) \\|f_{\\text{safe}}\\|_{L^2}\n3239: $$\n3240: \n3241: Using Cauchy-Schwarz for the inner product: $|\\langle g, 1 \\rangle| \\leq \\|g\\|_{L^2} \\cdot \\|1\\|_{L^2}$:\n3242: \n3243: $$\n3244: \\leq \\lambda_{\\text{rev}} C_{\\text{safe}} \\left( \\|c\\|_\\infty + \\frac{1}{m_{\\text{eq}}} \\|1\\|_{L^2} \\right) \\|g\\|_{L^2}\n3245: $$\n3246: \n3247: Therefore, $C_2 = \\lambda_{\\text{rev}} C_{\\text{safe}} (\\|c\\|_\\infty + \\|1\\|_{L^2} / m_{\\text{eq}})$.\n3248: \n3249: **Part 3: Kato-Rellich Perturbation Theory**\n3250: \n3251: From `06_convergence.md`, the pure kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ has spectral gap $\\kappa_{\\text{kin}} > 0$. By **Kato-Rellich perturbation theory** for sectorial operators (Kato 1995, *Perturbation Theory for Linear Operators*, Springer, Theorem IV.3.17):\n3252: \n3253: If the perturbation operators $\\mathbb{L}_{\\text{clone}}^*$, $\\mathbb{L}_{\\text{revival}}^*$, and $-c(z)$ satisfy $\\|B g\\|_{L^2} \\leq \\beta \\|g\\|_{L^2}$ with $\\beta < \\kappa_{\\text{kin}}$, then the perturbed operator retains a spectral gap:\n3254: \n3255: $$\n3256: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n3257: $$\n3258: \n3259: **Part 4: Dirichlet Form Coercivity**\n3260: \n3261: The Dirichlet form is:\n3262: \n3263: $$\n3264: \\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle = \\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle + \\text{perturbation terms}\n3265: $$\n3266: \n3267: The kinetic part satisfies $\\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle \\geq \\kappa_{\\text{kin}} \\|g\\|_{L^2}^2$ (by spectral gap). The perturbation terms contribute at most $(C_1 + C_2 + \\|c\\|_\\infty) \\|g\\|_{L^2}^2$ in magnitude.\n3268: \n3269: Therefore:\n3270: \n3271: $$\n3272: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2 > 0\n3273: $$",
      "metadata": {
        "label": "lem-relative-boundedness-nonlocal"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "3169: Before applying Nash-Aronson theory, we must verify that the nonlocal cloning and revival operators do not destroy the coercive Dirichlet form structure of the kinetic operator.\n3170: \n3171: :::{prf:lemma} Relative Boundedness of Nonlocal Operators\n3172: :label: lem-relative-boundedness-nonlocal\n3173: \n3174: The linearized nonlocal operators $\\mathbb{L}_{\\text{clone}}^*$ and $\\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` are **relatively bounded** with respect to the kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ in $L^2(\\pi_{\\text{QSD}}^{-1})$:\n3175: \n3176: $$\n3177: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2} \\leq C_1 \\|g\\|_{L^2}\n3178: $$\n3179: \n3180: $$\n3181: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq C_2 \\|g\\|_{L^2}\n3182: $$\n3183: \n3184: with constants $C_1, C_2 < \\kappa_{\\text{kin}} / 2$ where $\\kappa_{\\text{kin}} > 0$ is the kinetic spectral gap.\n3185: \n3186: **Consequence**: The full linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ retains a spectral gap:\n3187: \n3188: $$\n3189: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n3190: $$\n3191: \n3192: and the associated Dirichlet form $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle_{\\pi_{\\text{QSD}}^{-1}}$ is coercive:\n3193: \n3194: $$\n3195: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2\n3196: \n3197: $$\n3198: \n3199: **Proof**:\n3200: \n3201: **Part 1: Cloning Operator Bound**\n3202: \n3203: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator has the form:\n3204: \n3205: $$\n3206: \\mathbb{L}_{\\text{clone}}^* g(z) = \\int_\\Omega K_{\\text{clone}}(z, z') W(z, z') [g(z') - g(z)] dz'\n3207: $$\n3208: \n3209: where $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x-x') \\delta(v-v')$ is the Gaussian position kernel and $W(z, z')$ is a bounded fitness-dependent weight with $\\|W\\|_\\infty \\leq V_{\\max}$.\n3210: \n3211: By the **Schur test** for integral operators:\n3212: \n3213: $$\n3214: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2}^2 = \\int_\\Omega \\left| \\int_\\Omega K(z,z') W(z,z') [g(z') - g(z)] dz' \\right|^2 dz\n3215: $$\n3216: \n3217: Using Cauchy-Schwarz and the fact that $K$ is a probability kernel ($\\int K(z, z') dz' = 1$):\n3218: \n3219: $$\n3220: \\leq 2 V_{\\max}^2 \\left[ \\int_\\Omega |g(z')|^2 dz' + \\int_\\Omega |g(z)|^2 dz \\right] = 4 V_{\\max}^2 \\|g\\|_{L^2}^2\n3221: $$\n3222: \n3223: Therefore, $C_1 = 2 V_{\\max}$.\n3224: \n3225: **Part 2: Revival Operator Bound**\n3226: \n3227: The linearized revival operator (from Lemma {prf:ref}`lem-linearization-qsd`) has the form:\n3228: \n3229: $$\n3230: \\mathbb{L}_{\\text{revival}}^* g = \\lambda_{\\text{rev}} \\left[ \\frac{m_d}{m_{\\text{eq}}} - \\frac{\\langle g, 1 \\rangle}{m_{\\text{eq}}} \\right] f_{\\text{safe}}\n3231: $$\n3232: \n3233: where $f_{\\text{safe}}$ is the safe-region density with $\\|f_{\\text{safe}}\\|_{L^\\infty} \\leq C_{\\text{safe}}$ and $m_d, m_{\\text{eq}}$ are the dead and equilibrium masses.\n3234: \n3235: The $L^2$ norm is:\n3236: \n3237: $$\n3238: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq \\lambda_{\\text{rev}} \\left( \\frac{\\|c\\|_\\infty m_{\\text{eq}}}{m_{\\text{eq}}} + \\frac{|\\langle g, 1 \\rangle|}{m_{\\text{eq}}} \\right) \\|f_{\\text{safe}}\\|_{L^2}\n3239: $$\n3240: \n3241: Using Cauchy-Schwarz for the inner product: $|\\langle g, 1 \\rangle| \\leq \\|g\\|_{L^2} \\cdot \\|1\\|_{L^2}$:\n3242: \n3243: $$\n3244: \\leq \\lambda_{\\text{rev}} C_{\\text{safe}} \\left( \\|c\\|_\\infty + \\frac{1}{m_{\\text{eq}}} \\|1\\|_{L^2} \\right) \\|g\\|_{L^2}\n3245: $$\n3246: \n3247: Therefore, $C_2 = \\lambda_{\\text{rev}} C_{\\text{safe}} (\\|c\\|_\\infty + \\|1\\|_{L^2} / m_{\\text{eq}})$.\n3248: \n3249: **Part 3: Kato-Rellich Perturbation Theory**\n3250: \n3251: From `06_convergence.md`, the pure kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ has spectral gap $\\kappa_{\\text{kin}} > 0$. By **Kato-Rellich perturbation theory** for sectorial operators (Kato 1995, *Perturbation Theory for Linear Operators*, Springer, Theorem IV.3.17):\n3252: \n3253: If the perturbation operators $\\mathbb{L}_{\\text{clone}}^*$, $\\mathbb{L}_{\\text{revival}}^*$, and $-c(z)$ satisfy $\\|B g\\|_{L^2} \\leq \\beta \\|g\\|_{L^2}$ with $\\beta < \\kappa_{\\text{kin}}$, then the perturbed operator retains a spectral gap:\n3254: \n3255: $$\n3256: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n3257: $$\n3258: \n3259: **Part 4: Dirichlet Form Coercivity**\n3260: \n3261: The Dirichlet form is:\n3262: \n3263: $$\n3264: \\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle = \\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle + \\text{perturbation terms}\n3265: $$\n3266: \n3267: The kinetic part satisfies $\\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle \\geq \\kappa_{\\text{kin}} \\|g\\|_{L^2}^2$ (by spectral gap). The perturbation terms contribute at most $(C_1 + C_2 + \\|c\\|_\\infty) \\|g\\|_{L^2}^2$ in magnitude.\n3268: \n3269: Therefore:\n3270: \n3271: $$\n3272: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2 > 0\n3273: $$\n3274: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-l1-to-linfty-near-qsd",
      "title": "Nash-Aronson Type L¹-to-L∞ Bound for Linearized Operator",
      "start_line": 3282,
      "end_line": 3346,
      "header_lines": [
        3283
      ],
      "content_start": 3285,
      "content_end": 3345,
      "content": "3285: :label: lem-l1-to-linfty-near-qsd\n3286: \n3287: For the linearized evolution $\\partial_t \\eta = \\mathbb{L}^* \\eta$ starting from $\\eta_0$ with $\\|\\eta_0\\|_{L^1} = m$ and $\\|\\eta_0\\|_{L^\\infty} \\leq M$, there exist constants $C_{\\text{Nash}}, \\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\sigma_x, R, d$) such that for any $t \\geq \\tau$ (one timestep):\n3288: \n3289: $$\n3290: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n3291: \n3292: $$\n3293: \n3294: **Interpretation**: The $L^\\infty$ norm of perturbations decays to a level controlled by the $L^1$ norm, with a heat-kernel-like rate $t^{-d/2}$.\n3295: \n3296: **Proof**:\n3297: \n3298: This is a classical result in parabolic regularity theory, adapted to the hypoelliptic kinetic setting.\n3299: \n3300: **Step 1: Nash Inequality for Kinetic Operators**\n3301: \n3302: From Hérau & Nier (2004, *Arch. Ration. Mech. Anal.* 171:151-218, Theorem 2.1), hypoelliptic kinetic operators satisfy a Nash-type inequality: for any smooth function $g$ with $\\|g\\|_{L^1} = m$:\n3303: \n3304: $$\n3305: \\|g\\|_{L^2}^{2 + 4/d} \\leq C_N \\left( \\mathcal{E}(g) \\|g\\|_{L^1}^{4/d} + \\|g\\|_{L^1}^{2 + 4/d} \\right)\n3306: \n3307: $$\n3308: \n3309: where $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle$ is the Dirichlet form (entropy production).\n3310: \n3311: **Step 2: L²-to-L∞ Bootstrapping**\n3312: \n3313: For parabolic equations, the Nash inequality implies ultracontractivity of the semigroup $e^{t \\mathbb{L}^*}$: there exists $C_U$ such that:\n3314: \n3315: $$\n3316: \\|e^{t \\mathbb{L}^*}\\|_{L^1 \\to L^\\infty} \\leq \\frac{C_U}{t^{d/2}}\n3317: \n3318: $$\n3319: \n3320: for $t \\geq \\tau$. This is the **Nash-Aronson estimate** (Aronson 1968, *Bull. Amer. Math. Soc.* 74:47-49).\n3321: \n3322: **Step 3: Semigroup Decomposition**\n3323: \n3324: For $\\eta_0$ with mixed $L^1$ and $L^\\infty$ bounds, we use the semigroup property:\n3325: \n3326: $$\n3327: \\eta_t = e^{t \\mathbb{L}^*} \\eta_0\n3328: \n3329: $$\n3330: \n3331: Decompose $\\eta_0 = \\eta_0^{\\text{small}} + \\eta_0^{\\text{large}}$ where $\\|\\eta_0^{\\text{small}}\\|_{L^\\infty}$ is small but $\\|\\eta_0^{\\text{small}}\\|_{L^1} = m$, and $\\|\\eta_0^{\\text{large}}\\|_{L^1}$ is small. Then:\n3332: \n3333: $$\n3334: \\|\\eta_t\\|_{L^\\infty} \\leq \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{small}}\\|_{L^\\infty} + \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{large}}\\|_{L^\\infty}\n3335: \n3336: $$\n3337: \n3338: The first term is bounded by the ultracontractivity estimate: $C_U m / t^{d/2}$. The second term decays exponentially by the spectral gap: $M e^{-\\alpha t}$.\n3339: \n3340: Combining these:\n3341: \n3342: $$\n3343: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n3344: \n3345: $$",
      "metadata": {
        "label": "lem-l1-to-linfty-near-qsd"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "3282: This is the key technical lemma that upgrades weak ($L^1$) convergence to strong ($L^\\infty$) bounds.\n3283: \n3284: :::{prf:lemma} Nash-Aronson Type L¹-to-L∞ Bound for Linearized Operator\n3285: :label: lem-l1-to-linfty-near-qsd\n3286: \n3287: For the linearized evolution $\\partial_t \\eta = \\mathbb{L}^* \\eta$ starting from $\\eta_0$ with $\\|\\eta_0\\|_{L^1} = m$ and $\\|\\eta_0\\|_{L^\\infty} \\leq M$, there exist constants $C_{\\text{Nash}}, \\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\sigma_x, R, d$) such that for any $t \\geq \\tau$ (one timestep):\n3288: \n3289: $$\n3290: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n3291: \n3292: $$\n3293: \n3294: **Interpretation**: The $L^\\infty$ norm of perturbations decays to a level controlled by the $L^1$ norm, with a heat-kernel-like rate $t^{-d/2}$.\n3295: \n3296: **Proof**:\n3297: \n3298: This is a classical result in parabolic regularity theory, adapted to the hypoelliptic kinetic setting.\n3299: \n3300: **Step 1: Nash Inequality for Kinetic Operators**\n3301: \n3302: From Hérau & Nier (2004, *Arch. Ration. Mech. Anal.* 171:151-218, Theorem 2.1), hypoelliptic kinetic operators satisfy a Nash-type inequality: for any smooth function $g$ with $\\|g\\|_{L^1} = m$:\n3303: \n3304: $$\n3305: \\|g\\|_{L^2}^{2 + 4/d} \\leq C_N \\left( \\mathcal{E}(g) \\|g\\|_{L^1}^{4/d} + \\|g\\|_{L^1}^{2 + 4/d} \\right)\n3306: \n3307: $$\n3308: \n3309: where $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle$ is the Dirichlet form (entropy production).\n3310: \n3311: **Step 2: L²-to-L∞ Bootstrapping**\n3312: \n3313: For parabolic equations, the Nash inequality implies ultracontractivity of the semigroup $e^{t \\mathbb{L}^*}$: there exists $C_U$ such that:\n3314: \n3315: $$\n3316: \\|e^{t \\mathbb{L}^*}\\|_{L^1 \\to L^\\infty} \\leq \\frac{C_U}{t^{d/2}}\n3317: \n3318: $$\n3319: \n3320: for $t \\geq \\tau$. This is the **Nash-Aronson estimate** (Aronson 1968, *Bull. Amer. Math. Soc.* 74:47-49).\n3321: \n3322: **Step 3: Semigroup Decomposition**\n3323: \n3324: For $\\eta_0$ with mixed $L^1$ and $L^\\infty$ bounds, we use the semigroup property:\n3325: \n3326: $$\n3327: \\eta_t = e^{t \\mathbb{L}^*} \\eta_0\n3328: \n3329: $$\n3330: \n3331: Decompose $\\eta_0 = \\eta_0^{\\text{small}} + \\eta_0^{\\text{large}}$ where $\\|\\eta_0^{\\text{small}}\\|_{L^\\infty}$ is small but $\\|\\eta_0^{\\text{small}}\\|_{L^1} = m$, and $\\|\\eta_0^{\\text{large}}\\|_{L^1}$ is small. Then:\n3332: \n3333: $$\n3334: \\|\\eta_t\\|_{L^\\infty} \\leq \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{small}}\\|_{L^\\infty} + \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{large}}\\|_{L^\\infty}\n3335: \n3336: $$\n3337: \n3338: The first term is bounded by the ultracontractivity estimate: $C_U m / t^{d/2}$. The second term decays exponentially by the spectral gap: $M e^{-\\alpha t}$.\n3339: \n3340: Combining these:\n3341: \n3342: $$\n3343: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n3344: \n3345: $$\n3346: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hormander-bracket",
      "title": "Hörmander's Bracket Condition",
      "start_line": 96,
      "end_line": 124,
      "header_lines": [
        97
      ],
      "content_start": 99,
      "content_end": 123,
      "content": "99: :label: lem-hormander-bracket\n100: \n101: **Reference**: `06_convergence.md` Section 4.4.1, lines 892-950\n102: \n103: The kinetic generator $\\mathcal{L}_{\\text{kin}}$ has the form:\n104: \n105: $$\n106: \\mathcal{L}_{\\text{kin}} = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v + \\frac{\\sigma_v^2}{2} \\Delta_v\n107: \n108: $$\n109: \n110: where $A(x, v) = \\frac{1}{m}F(x) - \\gamma(v - u(x))$ is the velocity drift.\n111: \n112: The vector fields:\n113: - $X_0 = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v$ (drift)\n114: - $X_j = \\sigma_v \\partial_{v_j}$ (diffusion, $j = 1, \\ldots, d$)\n115: \n116: satisfy Hörmander's bracket condition:\n117: \n118: $$\n119: \\text{Lie}\\{X_0, X_1, \\ldots, X_d, [X_0, X_1], \\ldots, [X_0, X_d]\\} = T_{(x,v)}\\Omega\n120: \n121: $$\n122: \n123: at every point $(x, v) \\in \\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$.",
      "metadata": {
        "label": "lem-hormander-bracket"
      },
      "section": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities",
      "raw_directive": "96: ### 2.2. Hypoelliptic Structure of the Kinetic Operator\n97: \n98: :::{prf:lemma} Hörmander's Bracket Condition\n99: :label: lem-hormander-bracket\n100: \n101: **Reference**: `06_convergence.md` Section 4.4.1, lines 892-950\n102: \n103: The kinetic generator $\\mathcal{L}_{\\text{kin}}$ has the form:\n104: \n105: $$\n106: \\mathcal{L}_{\\text{kin}} = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v + \\frac{\\sigma_v^2}{2} \\Delta_v\n107: \n108: $$\n109: \n110: where $A(x, v) = \\frac{1}{m}F(x) - \\gamma(v - u(x))$ is the velocity drift.\n111: \n112: The vector fields:\n113: - $X_0 = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v$ (drift)\n114: - $X_j = \\sigma_v \\partial_{v_j}$ (diffusion, $j = 1, \\ldots, d$)\n115: \n116: satisfy Hörmander's bracket condition:\n117: \n118: $$\n119: \\text{Lie}\\{X_0, X_1, \\ldots, X_d, [X_0, X_1], \\ldots, [X_0, X_d]\\} = T_{(x,v)}\\Omega\n120: \n121: $$\n122: \n123: at every point $(x, v) \\in \\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$.\n124: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-linfty-full-operator",
      "title": "$L^\\infty$ Bound for the Full Operator",
      "start_line": 175,
      "end_line": 387,
      "header_lines": [
        176
      ],
      "content_start": 178,
      "content_end": 386,
      "content": "178: :label: lem-linfty-full-operator\n179: \n180: Consider the full McKean-Vlasov-Fokker-Planck equation from §2.1:\n181: \n182: $$\n183: \\frac{\\partial f}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* f + \\mathcal{L}_{\\text{clone}}^* f - c(z) f + B[f, m_d]\n184: \n185: $$\n186: \n187: with initial condition $\\|f_0\\|_\\infty \\leq M_0 < \\infty$. Assume a uniform-in-time lower bound on the alive mass, $m_a(t) = \\|f(t, \\cdot)\\|_{L^1} \\geq c_{\\text{mass}} > 0$ for all $t \\geq 0$ (to be proven in Section 4).\n188: \n189: Then for any finite time $T > 0$:\n190: \n191: $$\n192: \\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R) < \\infty\n193: \n194: $$\n195: \n196: **Proof**:\n197: \n198: We decompose the evolution into four components and bound each separately using the parabolic Harnack inequality.\n199: \n200: **Step 1: Kinetic Evolution Alone**\n201: \n202: Consider first the pure kinetic evolution $\\partial_t f = \\mathcal{L}_{\\text{kin}}^* f$ with reflecting boundary conditions. By the parabolic Harnack inequality (Theorem {prf:ref}`thm-parabolic-harnack`), for any cylinder $Q_R$:\n203: \n204: $$\n205: \\sup_{Q_{R/2}^-} f \\leq C_H \\inf_{Q_{R/2}^+} f\n206: \n207: $$\n208: \n209: For the initial value problem with $\\|f_0\\|_\\infty \\leq M_0$, we apply this iteratively over time slices to obtain:\n210: \n211: $$\n212: \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(t, \\gamma, \\sigma_v, R, d) M_0\n213: \n214: $$\n215: \n216: where $C_{\\text{kin}}(t, \\cdot)$ is the hypoelliptic smoothing constant. For $t \\geq t_{\\text{mix}}$ (mixing time), this becomes a constant independent of $t$.\n217: \n218: **Key Quantitative Bound**: Using the explicit Gaussian heat kernel estimates from Hérau & Nier (2004, Lemma 2.1), for $t \\geq \\tau$ (one timestep):\n219: \n220: $$\n221: C_{\\text{kin}}(t, \\cdot) \\leq C_0 \\left( \\frac{R^2}{\\sigma_v^2 \\gamma t} \\right)^{d/2} + C_1\n222: \n223: $$\n224: \n225: where $C_0, C_1$ depend only on the bracket depth and dimension.\n226: \n227: **Step 2: Cloning Operator **\n228: \n229: The cloning operator with Gaussian position jitter has the form (from `03_cloning.md` line 6022):\n230: \n231: $$\n232: \\mathcal{L}_{\\text{clone}}^* f = \\int_\\Omega K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n233: \n234: $$\n235: \n236: where:\n237: - $K_{\\text{clone}}(z, z') = \\frac{1}{(2\\pi\\sigma_x^2)^{d/2}} \\exp(-\\|x - x'\\|^2 / (2\\sigma_x^2)) \\times \\delta(v - v')$ is the Gaussian kernel\n238: - $V[f](z, z')$ is the **fitness weighting functional** (depends nonlinearly on $f$ via virtual reward)\n239: \n240: **Critical Observation**: The cloning operator is **NOT** a simple convolution due to the fitness weighting $V[f]$. The operator has a nonlinear source-sink structure:\n241: \n242: $$\n243: \\mathcal{L}_{\\text{clone}}^* f(z) = \\underbrace{\\int K_{\\text{clone}}(z, z') V[f](z, z') f(z') dz'}_{\\text{source}} - \\underbrace{f(z) \\int K_{\\text{clone}}(z, z') V[f](z, z') dz'}_{\\text{sink}}\n244: \n245: $$\n246: \n247: **Revised $L^\\infty$ Bound**: The fitness functional satisfies (from `03_cloning.md`):\n248: \n249: $$\n250: 0 \\leq V[f](z, z') \\leq V_{\\max} := \\max\\left(1, \\frac{1}{\\eta}\\right)\n251: \n252: $$\n253: \n254: where $\\eta \\in (0, 1)$ is the rescaling parameter. Therefore:\n255: \n256: $$\n257: |\\mathcal{L}_{\\text{clone}}^* f(z)| \\leq V_{\\max} \\left[\\int K_{\\text{clone}}(z, z') f(z') dz' + f(z) \\int K_{\\text{clone}}(z, z') dz'\\right]\n258: \n259: $$\n260: \n261: Since $\\int K_{\\text{clone}}(z, z') dz' = 1$ (normalized kernel) and the convolution $\\int K f' dx' \\leq \\|f\\|_\\infty$:\n262: \n263: $$\n264: \\|\\mathcal{L}_{\\text{clone}}^* f\\|_\\infty \\leq 2 V_{\\max} \\|f\\|_\\infty\n265: \n266: $$\n267: \n268: Over a timestep $\\tau$, using forward Euler for the source term:\n269: \n270: $$\n271: \\|f_{\\text{post-clone}}\\|_\\infty \\leq (1 + 2 V_{\\max} \\tau) \\|f_{\\text{pre-clone}}\\|_\\infty\n272: \n273: $$\n274: \n275: **Impact**: This increases the hypoelliptic constant $C_{\\text{hypo}}$ by a factor $(1 + 2V_{\\max}\\tau)^{T/\\tau}$, but remains finite for finite time $T$.\n276: \n277: **Step 3: Killing Term**\n278: \n279: The killing term $-c(z) f$ with $c(z) \\geq 0$ only removes mass:\n280: \n281: $$\n282: \\|f_{\\text{post-kill}}\\|_\\infty \\leq \\|f_{\\text{pre-kill}}\\|_\\infty\n283: \n284: $$\n285: \n286: **Step 4: Revival Term (Mass-Dependent Source)**\n287: \n288: The revival operator re-injects mass into the safe region. From `07_mean_field.md`, the revival source has the form\n289: \n290: $$\n291: r_{\\text{revival}}(z) = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}(z),\n292: $$\n293: \n294: where $m_a(t) = \\int f(t, z) dz$ is the alive mass and $m_d(t)$ is the dead-mass flux. The kernel $f_{\\text{safe}}$ is deterministic, compactly supported, and normalized ($\\int f_{\\text{safe}} = 1$). On the event that Section 4 proves $m_a(t) \\geq c_{\\text{mass}}$, we have\n295: \n296: $$\n297: \\frac{m_d(t)}{m_a(t)} = \\frac{\\int c(z) f(t,z) dz}{m_a(t)} \\leq \\|c\\|_\\infty.\n298: $$\n299: \n300: Therefore\n301: \n302: $$\n303: \\|r_{\\text{revival}}\\|_\\infty \\leq \\lambda_{\\text{rev}} \\|c\\|_\\infty \\|f_{\\text{safe}}\\|_\\infty =: C_{\\text{safe}},\n304: $$\n305: \n306: which is a state-independent constant (no additional factor of $\\|f\\|_\\infty$ appears).\n307: \n308: **Step 5: Volterra Inequality for the Supremum Norm**\n309: \n310: Using the Duhamel formula for the full equation over time interval $[0, T]$:\n311: \n312: $$\n313: f(T, z) = \\int_\\Omega p_T^{\\text{kin}}(z, z') f_0(z') dz' + \\int_0^T \\int_\\Omega p_{T-s}^{\\text{kin}}(z, z') S[f](s, z') dz' ds\n314: \n315: $$\n316: \n317: where $S[f] = \\mathcal{L}_{\\text{clone}}^* f - c f + B[f, m_d]$ is the source term and $p_t^{\\text{kin}}$ is the kinetic heat kernel.\n318: \n319: Taking supremum:\n320: \n321: $$\n322: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\|S[f](s, \\cdot)\\|_\\infty ds\n323: \n324: $$\n325: \n326: Since cloning and killing preserve $L^\\infty$ bounds (Steps 2-3), and revival adds at most $C_{\\text{revival}}$ per unit time (Step 4):\n327: \n328: $$\n329: \\|S[f](s, \\cdot)\\|_\\infty \\leq \\|f(s, \\cdot)\\|_\\infty + C_{\\text{revival}}\n330: \n331: $$\n332: \n333: This gives the integral inequality:\n334: \n335: $$\n336: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\Big[(2V_{\\max} + \\|c\\|_\\infty) \\|f(s, \\cdot)\\|_\\infty + C_{\\text{safe}}\\Big] ds.\n337: $$\n338: \n339: Define $u(t) = \\|f(t, \\cdot)\\|_\\infty$, $B_* := 2V_{\\max} + \\|c\\|_\\infty$, and $\\kappa_{\\text{kin}}(T) := \\int_0^T C_{\\text{kin}}(s) ds < \\infty$ (the kinetic estimate from Step 1 implies integrability). Then\n340: \n341: $$\n342: u(T) \\leq C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) + B_* \\int_0^T C_{\\text{kin}}(T - s) u(s) ds.\n343: $$\n344: \n345: **Step 6: Resolvent Grönwall Argument**\n346: \n347: Let $C_{\\text{kin}}^{\\max}(T) = \\sup_{0 \\leq s \\leq T} C_{\\text{kin}}(s)$ and $\\Psi(T) = \\int_0^T u(s) ds$. The convolution term satisfies\n348: \n349: $$\n350: \\int_0^T C_{\\text{kin}}(T - s) u(s) ds \\leq C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n351: $$\n352: \n353: Hence\n354: \n355: $$\n356: u(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T),\n357: \\qquad\n358: A_T := C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T).\n359: $$\n360: \n361: Differentiating $\\Psi$ yields the Volterra inequality\n362: \n363: $$\n364: \\Psi'(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n365: $$\n366: \n367: Gronwall’s lemma for first-order linear ODEs gives\n368: \n369: $$\n370: \\Psi(T) \\leq \\int_0^T A_s \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) (T-s)\\right) ds.\n371: $$\n372: \n373: Since $A_s \\leq C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) =: A_*$ for $s \\in [0, T]$, we obtain\n374: \n375: $$\n376: u(T) \\leq A_* \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n377: $$\n378: \n379: Therefore the hypoelliptic $L^\\infty$ bound holds with the explicit constant\n380: \n381: $$\n382: C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R)\n383: := \\Big[C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T)\\Big]\n384: \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n385: $$\n386: ",
      "metadata": {
        "label": "lem-linfty-full-operator"
      },
      "section": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities",
      "raw_directive": "175: The full equation includes non-local cloning terms, killing, and revival. We handle these perturbatively:\n176: \n177: :::{prf:lemma} $L^\\infty$ Bound for the Full Operator\n178: :label: lem-linfty-full-operator\n179: \n180: Consider the full McKean-Vlasov-Fokker-Planck equation from §2.1:\n181: \n182: $$\n183: \\frac{\\partial f}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* f + \\mathcal{L}_{\\text{clone}}^* f - c(z) f + B[f, m_d]\n184: \n185: $$\n186: \n187: with initial condition $\\|f_0\\|_\\infty \\leq M_0 < \\infty$. Assume a uniform-in-time lower bound on the alive mass, $m_a(t) = \\|f(t, \\cdot)\\|_{L^1} \\geq c_{\\text{mass}} > 0$ for all $t \\geq 0$ (to be proven in Section 4).\n188: \n189: Then for any finite time $T > 0$:\n190: \n191: $$\n192: \\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R) < \\infty\n193: \n194: $$\n195: \n196: **Proof**:\n197: \n198: We decompose the evolution into four components and bound each separately using the parabolic Harnack inequality.\n199: \n200: **Step 1: Kinetic Evolution Alone**\n201: \n202: Consider first the pure kinetic evolution $\\partial_t f = \\mathcal{L}_{\\text{kin}}^* f$ with reflecting boundary conditions. By the parabolic Harnack inequality (Theorem {prf:ref}`thm-parabolic-harnack`), for any cylinder $Q_R$:\n203: \n204: $$\n205: \\sup_{Q_{R/2}^-} f \\leq C_H \\inf_{Q_{R/2}^+} f\n206: \n207: $$\n208: \n209: For the initial value problem with $\\|f_0\\|_\\infty \\leq M_0$, we apply this iteratively over time slices to obtain:\n210: \n211: $$\n212: \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(t, \\gamma, \\sigma_v, R, d) M_0\n213: \n214: $$\n215: \n216: where $C_{\\text{kin}}(t, \\cdot)$ is the hypoelliptic smoothing constant. For $t \\geq t_{\\text{mix}}$ (mixing time), this becomes a constant independent of $t$.\n217: \n218: **Key Quantitative Bound**: Using the explicit Gaussian heat kernel estimates from Hérau & Nier (2004, Lemma 2.1), for $t \\geq \\tau$ (one timestep):\n219: \n220: $$\n221: C_{\\text{kin}}(t, \\cdot) \\leq C_0 \\left( \\frac{R^2}{\\sigma_v^2 \\gamma t} \\right)^{d/2} + C_1\n222: \n223: $$\n224: \n225: where $C_0, C_1$ depend only on the bracket depth and dimension.\n226: \n227: **Step 2: Cloning Operator **\n228: \n229: The cloning operator with Gaussian position jitter has the form (from `03_cloning.md` line 6022):\n230: \n231: $$\n232: \\mathcal{L}_{\\text{clone}}^* f = \\int_\\Omega K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n233: \n234: $$\n235: \n236: where:\n237: - $K_{\\text{clone}}(z, z') = \\frac{1}{(2\\pi\\sigma_x^2)^{d/2}} \\exp(-\\|x - x'\\|^2 / (2\\sigma_x^2)) \\times \\delta(v - v')$ is the Gaussian kernel\n238: - $V[f](z, z')$ is the **fitness weighting functional** (depends nonlinearly on $f$ via virtual reward)\n239: \n240: **Critical Observation**: The cloning operator is **NOT** a simple convolution due to the fitness weighting $V[f]$. The operator has a nonlinear source-sink structure:\n241: \n242: $$\n243: \\mathcal{L}_{\\text{clone}}^* f(z) = \\underbrace{\\int K_{\\text{clone}}(z, z') V[f](z, z') f(z') dz'}_{\\text{source}} - \\underbrace{f(z) \\int K_{\\text{clone}}(z, z') V[f](z, z') dz'}_{\\text{sink}}\n244: \n245: $$\n246: \n247: **Revised $L^\\infty$ Bound**: The fitness functional satisfies (from `03_cloning.md`):\n248: \n249: $$\n250: 0 \\leq V[f](z, z') \\leq V_{\\max} := \\max\\left(1, \\frac{1}{\\eta}\\right)\n251: \n252: $$\n253: \n254: where $\\eta \\in (0, 1)$ is the rescaling parameter. Therefore:\n255: \n256: $$\n257: |\\mathcal{L}_{\\text{clone}}^* f(z)| \\leq V_{\\max} \\left[\\int K_{\\text{clone}}(z, z') f(z') dz' + f(z) \\int K_{\\text{clone}}(z, z') dz'\\right]\n258: \n259: $$\n260: \n261: Since $\\int K_{\\text{clone}}(z, z') dz' = 1$ (normalized kernel) and the convolution $\\int K f' dx' \\leq \\|f\\|_\\infty$:\n262: \n263: $$\n264: \\|\\mathcal{L}_{\\text{clone}}^* f\\|_\\infty \\leq 2 V_{\\max} \\|f\\|_\\infty\n265: \n266: $$\n267: \n268: Over a timestep $\\tau$, using forward Euler for the source term:\n269: \n270: $$\n271: \\|f_{\\text{post-clone}}\\|_\\infty \\leq (1 + 2 V_{\\max} \\tau) \\|f_{\\text{pre-clone}}\\|_\\infty\n272: \n273: $$\n274: \n275: **Impact**: This increases the hypoelliptic constant $C_{\\text{hypo}}$ by a factor $(1 + 2V_{\\max}\\tau)^{T/\\tau}$, but remains finite for finite time $T$.\n276: \n277: **Step 3: Killing Term**\n278: \n279: The killing term $-c(z) f$ with $c(z) \\geq 0$ only removes mass:\n280: \n281: $$\n282: \\|f_{\\text{post-kill}}\\|_\\infty \\leq \\|f_{\\text{pre-kill}}\\|_\\infty\n283: \n284: $$\n285: \n286: **Step 4: Revival Term (Mass-Dependent Source)**\n287: \n288: The revival operator re-injects mass into the safe region. From `07_mean_field.md`, the revival source has the form\n289: \n290: $$\n291: r_{\\text{revival}}(z) = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}(z),\n292: $$\n293: \n294: where $m_a(t) = \\int f(t, z) dz$ is the alive mass and $m_d(t)$ is the dead-mass flux. The kernel $f_{\\text{safe}}$ is deterministic, compactly supported, and normalized ($\\int f_{\\text{safe}} = 1$). On the event that Section 4 proves $m_a(t) \\geq c_{\\text{mass}}$, we have\n295: \n296: $$\n297: \\frac{m_d(t)}{m_a(t)} = \\frac{\\int c(z) f(t,z) dz}{m_a(t)} \\leq \\|c\\|_\\infty.\n298: $$\n299: \n300: Therefore\n301: \n302: $$\n303: \\|r_{\\text{revival}}\\|_\\infty \\leq \\lambda_{\\text{rev}} \\|c\\|_\\infty \\|f_{\\text{safe}}\\|_\\infty =: C_{\\text{safe}},\n304: $$\n305: \n306: which is a state-independent constant (no additional factor of $\\|f\\|_\\infty$ appears).\n307: \n308: **Step 5: Volterra Inequality for the Supremum Norm**\n309: \n310: Using the Duhamel formula for the full equation over time interval $[0, T]$:\n311: \n312: $$\n313: f(T, z) = \\int_\\Omega p_T^{\\text{kin}}(z, z') f_0(z') dz' + \\int_0^T \\int_\\Omega p_{T-s}^{\\text{kin}}(z, z') S[f](s, z') dz' ds\n314: \n315: $$\n316: \n317: where $S[f] = \\mathcal{L}_{\\text{clone}}^* f - c f + B[f, m_d]$ is the source term and $p_t^{\\text{kin}}$ is the kinetic heat kernel.\n318: \n319: Taking supremum:\n320: \n321: $$\n322: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\|S[f](s, \\cdot)\\|_\\infty ds\n323: \n324: $$\n325: \n326: Since cloning and killing preserve $L^\\infty$ bounds (Steps 2-3), and revival adds at most $C_{\\text{revival}}$ per unit time (Step 4):\n327: \n328: $$\n329: \\|S[f](s, \\cdot)\\|_\\infty \\leq \\|f(s, \\cdot)\\|_\\infty + C_{\\text{revival}}\n330: \n331: $$\n332: \n333: This gives the integral inequality:\n334: \n335: $$\n336: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\Big[(2V_{\\max} + \\|c\\|_\\infty) \\|f(s, \\cdot)\\|_\\infty + C_{\\text{safe}}\\Big] ds.\n337: $$\n338: \n339: Define $u(t) = \\|f(t, \\cdot)\\|_\\infty$, $B_* := 2V_{\\max} + \\|c\\|_\\infty$, and $\\kappa_{\\text{kin}}(T) := \\int_0^T C_{\\text{kin}}(s) ds < \\infty$ (the kinetic estimate from Step 1 implies integrability). Then\n340: \n341: $$\n342: u(T) \\leq C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) + B_* \\int_0^T C_{\\text{kin}}(T - s) u(s) ds.\n343: $$\n344: \n345: **Step 6: Resolvent Grönwall Argument**\n346: \n347: Let $C_{\\text{kin}}^{\\max}(T) = \\sup_{0 \\leq s \\leq T} C_{\\text{kin}}(s)$ and $\\Psi(T) = \\int_0^T u(s) ds$. The convolution term satisfies\n348: \n349: $$\n350: \\int_0^T C_{\\text{kin}}(T - s) u(s) ds \\leq C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n351: $$\n352: \n353: Hence\n354: \n355: $$\n356: u(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T),\n357: \\qquad\n358: A_T := C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T).\n359: $$\n360: \n361: Differentiating $\\Psi$ yields the Volterra inequality\n362: \n363: $$\n364: \\Psi'(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n365: $$\n366: \n367: Gronwall’s lemma for first-order linear ODEs gives\n368: \n369: $$\n370: \\Psi(T) \\leq \\int_0^T A_s \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) (T-s)\\right) ds.\n371: $$\n372: \n373: Since $A_s \\leq C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) =: A_*$ for $s \\in [0, T]$, we obtain\n374: \n375: $$\n376: u(T) \\leq A_* \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n377: $$\n378: \n379: Therefore the hypoelliptic $L^\\infty$ bound holds with the explicit constant\n380: \n381: $$\n382: C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R)\n383: := \\Big[C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T)\\Big]\n384: \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n385: $$\n386: \n387: This constant is finite for every finite $T$, depends on all physical parameters, and controls $\\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty$. $\\square$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-gaussian-kernel-lower-bound",
      "title": "Gaussian Kernel Lower Bound",
      "start_line": 399,
      "end_line": 449,
      "header_lines": [
        400
      ],
      "content_start": 402,
      "content_end": 448,
      "content": "402: :label: lem-gaussian-kernel-lower-bound\n403: \n404: Let $G_{\\sigma_x}(y) = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-\\|y\\|^2 / (2\\sigma_x^2))$ be the Gaussian kernel with variance $\\sigma_x^2 > 0$.\n405: \n406: For any $x_1, x_2 \\in B_R(0) \\subset \\mathbb{R}^d$:\n407: \n408: $$\n409: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} \\leq \\exp\\left( \\frac{(2R)^2}{2\\sigma_x^2} \\right)\n410: \n411: $$\n412: \n413: Moreover, for any integrable density $\\rho$ with $\\|\\rho\\|_{L^1} = m > 0$:\n414: \n415: $$\n416: \\inf_{x \\in B_R} \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq m \\cdot c_{\\sigma_x, R}\n417: \n418: $$\n419: \n420: where:\n421: \n422: $$\n423: c_{\\sigma_x, R} := (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) > 0\n424: \n425: $$\n426: \n427: **Proof**:\n428: \n429: For the ratio bound, note that for $x_1, x_2 \\in B_R$:\n430: \n431: $$\n432: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} = \\exp\\left( \\frac{\\|x_2\\|^2 - \\|x_1\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{\\|x_2\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{R^2}{2\\sigma_x^2} \\right)\n433: \n434: $$\n435: \n436: For the lower bound, fix $x \\in B_R$. For any $y \\in B_R$, $\\|x - y\\| \\leq 2R$, so:\n437: \n438: $$\n439: G_{\\sigma_x}(x - y) \\geq (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) = c_{\\sigma_x, R}\n440: \n441: $$\n442: \n443: Therefore:\n444: \n445: $$\n446: \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq c_{\\sigma_x, R} \\int_{B_R} \\rho(y) dy = c_{\\sigma_x, R} \\cdot m\n447: \n448: $$",
      "metadata": {
        "label": "lem-gaussian-kernel-lower-bound"
      },
      "section": "## 3. Gaussian Mollification and Uniform Lower Bounds",
      "raw_directive": "399: ### 3.1. Quantitative Gaussian Mollification Bounds\n400: \n401: :::{prf:lemma} Gaussian Kernel Lower Bound\n402: :label: lem-gaussian-kernel-lower-bound\n403: \n404: Let $G_{\\sigma_x}(y) = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-\\|y\\|^2 / (2\\sigma_x^2))$ be the Gaussian kernel with variance $\\sigma_x^2 > 0$.\n405: \n406: For any $x_1, x_2 \\in B_R(0) \\subset \\mathbb{R}^d$:\n407: \n408: $$\n409: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} \\leq \\exp\\left( \\frac{(2R)^2}{2\\sigma_x^2} \\right)\n410: \n411: $$\n412: \n413: Moreover, for any integrable density $\\rho$ with $\\|\\rho\\|_{L^1} = m > 0$:\n414: \n415: $$\n416: \\inf_{x \\in B_R} \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq m \\cdot c_{\\sigma_x, R}\n417: \n418: $$\n419: \n420: where:\n421: \n422: $$\n423: c_{\\sigma_x, R} := (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) > 0\n424: \n425: $$\n426: \n427: **Proof**:\n428: \n429: For the ratio bound, note that for $x_1, x_2 \\in B_R$:\n430: \n431: $$\n432: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} = \\exp\\left( \\frac{\\|x_2\\|^2 - \\|x_1\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{\\|x_2\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{R^2}{2\\sigma_x^2} \\right)\n433: \n434: $$\n435: \n436: For the lower bound, fix $x \\in B_R$. For any $y \\in B_R$, $\\|x - y\\| \\leq 2R$, so:\n437: \n438: $$\n439: G_{\\sigma_x}(x - y) \\geq (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) = c_{\\sigma_x, R}\n440: \n441: $$\n442: \n443: Therefore:\n444: \n445: $$\n446: \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq c_{\\sigma_x, R} \\int_{B_R} \\rho(y) dy = c_{\\sigma_x, R} \\cdot m\n447: \n448: $$\n449: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Gaussian Mollification and Uniform Lower Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-strict-positivity-cloning",
      "title": "Strict Positivity After Cloning",
      "start_line": 453,
      "end_line": 494,
      "header_lines": [
        454
      ],
      "content_start": 456,
      "content_end": 493,
      "content": "456: :label: lem-strict-positivity-cloning\n457: \n458: After applying the cloning operator with Gaussian position jitter $\\sigma_x > 0$, the density satisfies:\n459: \n460: $$\n461: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n462: \n463: $$\n464: \n465: where $c_{\\sigma_x, R}$ is defined in Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`.\n466: \n467: **Proof**: From `03_cloning.md` (line 6022), the position update is:\n468: \n469: $$\n470: x_i' = x_j + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n471: \n472: $$\n473: \n474: In the mean-field limit, this corresponds to convolution with the Gaussian kernel:\n475: \n476: $$\n477: \\rho_{\\text{post-clone}}(x) = \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) w(y) \\rho_{\\text{pre-clone}}(y) dy\n478: \n479: $$\n480: \n481: where $w(y)$ is the fitness weighting (always positive). Since $w(y) \\geq \\eta > 0$ (floor from rescale transformation, `01_fragile_gas_framework.md`), we have:\n482: \n483: $$\n484: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) \\rho_{\\text{pre-clone}}(y) dy\n485: \n486: $$\n487: \n488: Applying Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`:\n489: \n490: $$\n491: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\cdot c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n492: \n493: $$",
      "metadata": {
        "label": "lem-strict-positivity-cloning"
      },
      "section": "## 3. Gaussian Mollification and Uniform Lower Bounds",
      "raw_directive": "453: ### 3.2. Lower Bound on Post-Cloning Density\n454: \n455: :::{prf:lemma} Strict Positivity After Cloning\n456: :label: lem-strict-positivity-cloning\n457: \n458: After applying the cloning operator with Gaussian position jitter $\\sigma_x > 0$, the density satisfies:\n459: \n460: $$\n461: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n462: \n463: $$\n464: \n465: where $c_{\\sigma_x, R}$ is defined in Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`.\n466: \n467: **Proof**: From `03_cloning.md` (line 6022), the position update is:\n468: \n469: $$\n470: x_i' = x_j + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n471: \n472: $$\n473: \n474: In the mean-field limit, this corresponds to convolution with the Gaussian kernel:\n475: \n476: $$\n477: \\rho_{\\text{post-clone}}(x) = \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) w(y) \\rho_{\\text{pre-clone}}(y) dy\n478: \n479: $$\n480: \n481: where $w(y)$ is the fitness weighting (always positive). Since $w(y) \\geq \\eta > 0$ (floor from rescale transformation, `01_fragile_gas_framework.md`), we have:\n482: \n483: $$\n484: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) \\rho_{\\text{pre-clone}}(y) dy\n485: \n486: $$\n487: \n488: Applying Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`:\n489: \n490: $$\n491: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\cdot c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n492: \n493: $$\n494: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Gaussian Mollification and Uniform Lower Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-qsd-strict-positivity",
      "title": "QSD Strict Positivity",
      "start_line": 498,
      "end_line": 588,
      "header_lines": [
        499
      ],
      "content_start": 501,
      "content_end": 587,
      "content": "501: :label: lem-qsd-strict-positivity\n502: \n503: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ has a smooth density with respect to Lebesgue measure that satisfies\n504: \n505: $$\n506: \\inf_{(x,v) \\in \\Omega} \\pi_{\\text{QSD}}(x, v) \\geq c_\\pi > 0,\n507: $$\n508: \n509: where $\\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$ and\n510: \n511: $$\n512: c_\\pi = \\big(\\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R}\\big) \\, m_{\\text{eq}},\n513: \\qquad\n514: c_{\\text{vel}} := (2\\pi\\sigma_v^2 \\beta_\\star)^{-d/2} \\exp\\!\\left(-\\frac{4 V_{\\max}^2}{2 \\sigma_v^2 \\beta_\\star}\\right).\n515: $$\n516: \n517: Here $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ and $\\beta_\\star = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$ for a fixed velocity-refresh time $\\tau_v > 0$.\n518: \n519: **Proof**:\n520: \n521: **Step 1 (Velocity Refresh via Ornstein-Uhlenbeck Block)**  \n522: During a kinetic window of length $\\tau_v$, the BAOAB operator evolves the velocity according to\n523: \n524: $$\n525: p_v^{\\text{OU}}(\\tau_v; v_0, v)\n526: = (2\\pi\\sigma_v^2 \\beta(\\tau_v))^{-d/2}\n527: \\exp\\!\\left(-\\frac{|v - e^{-\\gamma \\tau_v} v_0|^2}{2 \\sigma_v^2 \\beta(\\tau_v)}\\right),\n528: $$\n529: \n530: with $\\beta(\\tau_v) = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$. Because $V_{\\text{alg}}$ is compact ($|v| \\leq V_{\\max}$), choosing $\\tau_v$ so that $\\beta(\\tau_v) \\geq \\beta_\\star>0$ gives\n531: \n532: $$\n533: p_v^{\\text{OU}}(\\tau_v; v_0, v) \\geq c_{\\text{vel}}\n534: \\quad \\text{for all } v_0, v \\in V_{\\text{alg}}.\n535: $$\n536: \n537: Hence a single kinetic block already spreads mass over **all** velocity directions with a state-independent density floor. This removes the previous restriction to velocity balls around $v_0$.\n538: \n539: **Step 2 (Spatial Mollification Without Velocity Restriction)**  \n540: Conditioned on any $(x_1, v_1)$ produced by Step 1, the cloning kernel\n541: \n542: $$\n543: K_{\\text{clone}}\\big((x_1, v_1), (x, v)\\big)\n544: = \\eta \\, G_{\\sigma_x}(x - x_1) \\, \\delta(v - v_1)\n545: $$\n546: \n547: acts on the position coordinate. Lemma {prf:ref}`lem-gaussian-kernel-lower-bound` implies\n548: \n549: $$\n550: G_{\\sigma_x}(x - x_1) \\geq c_{\\sigma_x, R}\n551: \\qquad \\forall x, x_1 \\in \\mathcal{X}_{\\text{valid}},\n552: $$\n553: \n554: so positions are minorized by Lebesgue measure independently of the pre-cloning state.\n555: \n556: **Step 3 (Two-Step Doeblin Minorization)**  \n557: Let $P^{(2)}$ denote “kinetic over $\\tau_v$” composed with “cloning.” For any measurable $A \\subseteq \\Omega$,\n558: \n559: $$\n560: P^{(2)}((x_0, v_0), A)\n561: = \\int_\\Omega p_v^{\\text{OU}}(\\tau_v; v_0, v_1) K_{\\text{clone}}\\big((x_1, v_1), A\\big) \\, dx_1 \\, dv_1\n562: \\geq \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R} \\, |A|,\n563: $$\n564: \n565: where $|A|$ is the Lebesgue measure of $A$ in $\\Omega$. Thus $P^{(2)}$ satisfies a genuine Doeblin condition\n566: \n567: $$\n568: P^{(2)}(z, A) \\geq \\delta_2 \\, \\nu(A),\n569: \\qquad\n570: \\delta_2 := \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R},\n571: $$\n572: \n573: with state-independent minorization measure $\\nu(A) = |A|/|\\Omega|$.\n574: \n575: **Step 4 (Transfer to the QSD)**  \n576: For the invariant quasi-stationary distribution,\n577: \n578: $$\n579: \\pi_{\\text{QSD}}(A)\n580: = \\int_\\Omega P^{(2)}(z, A) \\, \\pi_{\\text{QSD}}(dz)\n581: \\geq \\delta_2 \\, m_{\\text{eq}} \\, \\nu(A),\n582: $$\n583: \n584: so $\\pi_{\\text{QSD}}$ possesses a density bounded below by $c_\\pi = \\delta_2 m_{\\text{eq}} / |\\Omega|$ at every point of $\\Omega$.\n585: \n586: **Step 5 (Smoothness)**  \n587: Lemma {prf:ref}`lem-linfty-full-operator` provides hypoelliptic smoothing, giving $\\pi_{\\text{QSD}} \\in C^\\infty(\\Omega)$ and promoting the almost-everywhere lower bound to a pointwise one.",
      "metadata": {
        "label": "lem-qsd-strict-positivity"
      },
      "section": "## 3. Gaussian Mollification and Uniform Lower Bounds",
      "raw_directive": "498: ### 3.3. QSD Density Lower Bound via Multi-Step Minorization\n499: \n500: :::{prf:lemma} QSD Strict Positivity\n501: :label: lem-qsd-strict-positivity\n502: \n503: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ has a smooth density with respect to Lebesgue measure that satisfies\n504: \n505: $$\n506: \\inf_{(x,v) \\in \\Omega} \\pi_{\\text{QSD}}(x, v) \\geq c_\\pi > 0,\n507: $$\n508: \n509: where $\\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$ and\n510: \n511: $$\n512: c_\\pi = \\big(\\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R}\\big) \\, m_{\\text{eq}},\n513: \\qquad\n514: c_{\\text{vel}} := (2\\pi\\sigma_v^2 \\beta_\\star)^{-d/2} \\exp\\!\\left(-\\frac{4 V_{\\max}^2}{2 \\sigma_v^2 \\beta_\\star}\\right).\n515: $$\n516: \n517: Here $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ and $\\beta_\\star = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$ for a fixed velocity-refresh time $\\tau_v > 0$.\n518: \n519: **Proof**:\n520: \n521: **Step 1 (Velocity Refresh via Ornstein-Uhlenbeck Block)**  \n522: During a kinetic window of length $\\tau_v$, the BAOAB operator evolves the velocity according to\n523: \n524: $$\n525: p_v^{\\text{OU}}(\\tau_v; v_0, v)\n526: = (2\\pi\\sigma_v^2 \\beta(\\tau_v))^{-d/2}\n527: \\exp\\!\\left(-\\frac{|v - e^{-\\gamma \\tau_v} v_0|^2}{2 \\sigma_v^2 \\beta(\\tau_v)}\\right),\n528: $$\n529: \n530: with $\\beta(\\tau_v) = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$. Because $V_{\\text{alg}}$ is compact ($|v| \\leq V_{\\max}$), choosing $\\tau_v$ so that $\\beta(\\tau_v) \\geq \\beta_\\star>0$ gives\n531: \n532: $$\n533: p_v^{\\text{OU}}(\\tau_v; v_0, v) \\geq c_{\\text{vel}}\n534: \\quad \\text{for all } v_0, v \\in V_{\\text{alg}}.\n535: $$\n536: \n537: Hence a single kinetic block already spreads mass over **all** velocity directions with a state-independent density floor. This removes the previous restriction to velocity balls around $v_0$.\n538: \n539: **Step 2 (Spatial Mollification Without Velocity Restriction)**  \n540: Conditioned on any $(x_1, v_1)$ produced by Step 1, the cloning kernel\n541: \n542: $$\n543: K_{\\text{clone}}\\big((x_1, v_1), (x, v)\\big)\n544: = \\eta \\, G_{\\sigma_x}(x - x_1) \\, \\delta(v - v_1)\n545: $$\n546: \n547: acts on the position coordinate. Lemma {prf:ref}`lem-gaussian-kernel-lower-bound` implies\n548: \n549: $$\n550: G_{\\sigma_x}(x - x_1) \\geq c_{\\sigma_x, R}\n551: \\qquad \\forall x, x_1 \\in \\mathcal{X}_{\\text{valid}},\n552: $$\n553: \n554: so positions are minorized by Lebesgue measure independently of the pre-cloning state.\n555: \n556: **Step 3 (Two-Step Doeblin Minorization)**  \n557: Let $P^{(2)}$ denote “kinetic over $\\tau_v$” composed with “cloning.” For any measurable $A \\subseteq \\Omega$,\n558: \n559: $$\n560: P^{(2)}((x_0, v_0), A)\n561: = \\int_\\Omega p_v^{\\text{OU}}(\\tau_v; v_0, v_1) K_{\\text{clone}}\\big((x_1, v_1), A\\big) \\, dx_1 \\, dv_1\n562: \\geq \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R} \\, |A|,\n563: $$\n564: \n565: where $|A|$ is the Lebesgue measure of $A$ in $\\Omega$. Thus $P^{(2)}$ satisfies a genuine Doeblin condition\n566: \n567: $$\n568: P^{(2)}(z, A) \\geq \\delta_2 \\, \\nu(A),\n569: \\qquad\n570: \\delta_2 := \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R},\n571: $$\n572: \n573: with state-independent minorization measure $\\nu(A) = |A|/|\\Omega|$.\n574: \n575: **Step 4 (Transfer to the QSD)**  \n576: For the invariant quasi-stationary distribution,\n577: \n578: $$\n579: \\pi_{\\text{QSD}}(A)\n580: = \\int_\\Omega P^{(2)}(z, A) \\, \\pi_{\\text{QSD}}(dz)\n581: \\geq \\delta_2 \\, m_{\\text{eq}} \\, \\nu(A),\n582: $$\n583: \n584: so $\\pi_{\\text{QSD}}$ possesses a density bounded below by $c_\\pi = \\delta_2 m_{\\text{eq}} / |\\Omega|$ at every point of $\\Omega$.\n585: \n586: **Step 5 (Smoothness)**  \n587: Lemma {prf:ref}`lem-linfty-full-operator` provides hypoelliptic smoothing, giving $\\pi_{\\text{QSD}} \\in C^\\infty(\\Omega)$ and promoting the almost-everywhere lower bound to a pointwise one.\n588: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Gaussian Mollification and Uniform Lower Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mass-lower-bound-high-prob",
      "title": "High-Probability Alive Mass Lower Bound",
      "start_line": 673,
      "end_line": 792,
      "header_lines": [
        674
      ],
      "content_start": 676,
      "content_end": 791,
      "content": "676: :label: lem-mass-lower-bound-high-prob\n677: \n678: For the Euclidean Gas with $N$ walkers there exist constants $c_{\\text{mass}}, C, \\delta > 0$, depending only on $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ and the initial mass $m_0$, such that for every $t \\geq 0$\n679: \n680: $$\n681: \\mathbb{P}\\!\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - C (1+t) e^{-\\delta N}.\n682: $$\n683: \n684: **Proof (full-process spectral gap + logistic ODE)**:\n685: \n686: We split the argument into an **early-time deterministic floor** and a **late-time concentration regime**. Throughout we denote $k_t = k_t(\\omega)$ the number of alive walkers and $m_a(t) = \\|\\rho_t\\|_{L^1}$ the PDE mass.\n687: \n688: **Step 0: Deterministic floor on $[0, t_{\\text{eq}}]$ via logistic ODE**  \n689: The mass equation derived in `07_mean_field.md` reads\n690: \n691: $$\n692: \\frac{d}{dt} m_a(t) = -\\int_\\Omega c(z) \\rho_t(z) dz + \\lambda_{\\text{rev}} \\big( 1 - m_a(t) \\big).\n693: $$\n694: \n695: Using $\\int c(z) \\rho_t(z) dz \\leq c_{\\max} m_a(t)$, we obtain the comparison inequality\n696: \n697: $$\n698: \\frac{d}{dt} m_a(t) \\geq - (c_{\\max} + \\lambda_{\\text{rev}}) m_a(t) + \\lambda_{\\text{rev}}.\n699: $$\n700: \n701: Solving gives the explicit lower envelope\n702: \n703: $$\n704: m_{\\text{floor}}(t)\n705: = m_\\infty - \\big(m_\\infty - m_0\\big) e^{-(c_{\\max} + \\lambda_{\\text{rev}}) t},\n706: \\qquad\n707: m_\\infty = \\frac{\\lambda_{\\text{rev}}}{c_{\\max} + \\lambda_{\\text{rev}}} > 0.\n708: $$\n709: \n710: Hence $m_a(t) \\geq m_{\\text{floor}}(t)$ for all $t \\geq 0$. Choosing the equilibration time $t_{\\text{eq}} = O(\\kappa_{\\text{QSD}}^{-1} \\log N)$, we set\n711: \n712: $$\n713: c_{\\text{early}} := \\frac{1}{2} \\min_{0 \\leq s \\leq t_{\\text{eq}}} m_{\\text{floor}}(s) > 0.\n714: $$\n715: \n716: The propagation-of-chaos estimate proved in Section 4.5 (Proposition {prf:ref}`prop-poc-mass`) states that, for any $\\epsilon > 0$,\n717: \n718: $$\n719: \\mathbb{P}\\left( \\sup_{0 \\leq s \\leq t_{\\text{eq}}} \\left| \\frac{k_s}{N} - m_a(s) \\right| > \\epsilon \\right) \\leq C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N \\epsilon^2}.\n720: $$\n721: \n722: Taking $\\epsilon = c_{\\text{early}}$ yields the early-time event\n723: \n724: $$\n725: \\mathbb{P}\\left( \\inf_{0 \\leq s \\leq t_{\\text{eq}}} \\frac{k_s}{N} \\geq c_{\\text{early}} \\right) \\geq 1 - C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N c_{\\text{early}}^2}.\n726: $$\n727: \n728: This establishes the desired floor on $[0, t_{\\text{eq}}]$.\n729: \n730: **Step 1: Spectral gap for configuration observables (removing the Markov assumption on $k_t$)**  \n731: The $N$-particle process $Z_t = (z_t^{(1)}, \\ldots, z_t^{(N)})$ is geometrically ergodic with spectral gap $\\kappa_{\\text{full}} > 0$ in $L^2(\\Pi_{\\text{QSD}}^{(N)})$ (Theorem 4.5 of `06_convergence.md`). For any observable $F : \\Omega^N \\to \\mathbb{R}$,\n732: \n733: $$\n734: \\text{Var}_{\\Pi_{\\text{QSD}}^{(N)}}(F) \\leq \\frac{1}{\\kappa_{\\text{full}}} \\langle -\\mathcal{L}^{(N)} F, F \\rangle.\n735: $$\n736: \n737: We apply this to $F(Z) = k(Z)/N = N^{-1} \\sum_{i=1}^N \\mathbf{1}_{\\{\\text{walker } i \\text{ alive}\\}}$. Changing a single coordinate alters $F$ by at most $1/N$, so $F$ is $1/N$-Lipschitz with respect to the Hamming metric. By the Herbst argument for Markov semigroups with spectral gap (see, e.g., Joulin & Ollivier 2010, Theorem 5.1), $F$ satisfies\n738: \n739: $$\n740: \\Pi_{\\text{QSD}}^{(N)}\\!\\left( \\left| \\frac{k}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n741: \\leq 2 \\exp\\!\\left( - \\frac{\\kappa_{\\text{full}} N^2 r^2}{2} \\right)\n742: \\leq 2 \\exp\\!\\left( - \\beta_{\\text{gap}} N r^2 \\right),\n743: $$\n744: \n745: where we set $\\beta_{\\text{gap}} := \\kappa_{\\text{full}} / 2$ (the second inequality uses $N^2 \\geq N$ so the exponent now scales linearly in $N$).\n746: \n747: This argument works directly on the full configuration process $Z_t$; no Markov property for the projected count $k_t$ is required, thereby correcting the earlier (invalid) reduction to a standalone birth-death chain.\n748: \n749: **Step 2: Finite-time concentration after equilibration**  \n750: Let $\\mathcal{L}_t$ be the law of $Z_t$ starting from any initial configuration with alive mass at least $c_{\\text{early}}$. By Theorem 4.5 of `06_convergence.md`,\n751: \n752: $$\n753: \\|\\mathcal{L}_t - \\Pi_{\\text{QSD}}^{(N)}\\|_{\\text{TV}}\n754: \\leq C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})} \\quad \\text{for } t \\geq t_{\\text{eq}}.\n755: $$\n756: \n757: Therefore, for $t \\geq t_{\\text{eq}}$ and any $r > 0$,\n758: \n759: $$\n760: \\mathbb{P}\\left( \\left| \\frac{k_t}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n761: \\leq 2 e^{-\\beta_{\\text{gap}} N r^2} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n762: $$\n763: \n764: Selecting $r = m_{\\text{eq}}/2$ yields\n765: \n766: $$\n767: \\mathbb{P}\\left( \\frac{k_t}{N} \\leq \\frac{m_{\\text{eq}}}{2} \\right)\n768: \\leq 2 e^{-\\beta_{\\text{gap}} N m_{\\text{eq}}^2 / 4} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n769: $$\n770: \n771: **Step 3: Survival conditioning**  \n772: The survival estimate of Theorem {prf:ref}`thm-exponential-survival` gives\n773: \n774: $$\n775: \\mathbb{P}(\\tau_\\dagger \\leq t) \\leq t e^{-C_{\\text{surv}} N}.\n776: $$\n777: \n778: Intersecting the complementary survival event with the concentration events from Steps 0-2 shows that, for all $t \\geq 0$,\n779: \n780: $$\n781: \\mathbb{P}\\left( \\frac{k_t}{N} \\geq \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right) \\right)\n782: \\geq 1 - C (1+t) e^{-\\delta N},\n783: $$\n784: \n785: with $\\delta = \\min(\\beta_{\\text{pc}} c_{\\text{early}}^2, \\beta_{\\text{gap}} m_{\\text{eq}}^2/4, C_{\\text{surv}})$.\n786: \n787: Setting\n788: \n789: $$\n790: c_{\\text{mass}} := \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right)\n791: $$",
      "metadata": {
        "label": "lem-mass-lower-bound-high-prob"
      },
      "section": "## 4. Stochastic Mass Conservation and High-Probability Bounds",
      "raw_directive": "673: ### 4.3. High-Probability Mass Lower Bound\n674: \n675: :::{prf:lemma} High-Probability Alive Mass Lower Bound\n676: :label: lem-mass-lower-bound-high-prob\n677: \n678: For the Euclidean Gas with $N$ walkers there exist constants $c_{\\text{mass}}, C, \\delta > 0$, depending only on $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ and the initial mass $m_0$, such that for every $t \\geq 0$\n679: \n680: $$\n681: \\mathbb{P}\\!\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - C (1+t) e^{-\\delta N}.\n682: $$\n683: \n684: **Proof (full-process spectral gap + logistic ODE)**:\n685: \n686: We split the argument into an **early-time deterministic floor** and a **late-time concentration regime**. Throughout we denote $k_t = k_t(\\omega)$ the number of alive walkers and $m_a(t) = \\|\\rho_t\\|_{L^1}$ the PDE mass.\n687: \n688: **Step 0: Deterministic floor on $[0, t_{\\text{eq}}]$ via logistic ODE**  \n689: The mass equation derived in `07_mean_field.md` reads\n690: \n691: $$\n692: \\frac{d}{dt} m_a(t) = -\\int_\\Omega c(z) \\rho_t(z) dz + \\lambda_{\\text{rev}} \\big( 1 - m_a(t) \\big).\n693: $$\n694: \n695: Using $\\int c(z) \\rho_t(z) dz \\leq c_{\\max} m_a(t)$, we obtain the comparison inequality\n696: \n697: $$\n698: \\frac{d}{dt} m_a(t) \\geq - (c_{\\max} + \\lambda_{\\text{rev}}) m_a(t) + \\lambda_{\\text{rev}}.\n699: $$\n700: \n701: Solving gives the explicit lower envelope\n702: \n703: $$\n704: m_{\\text{floor}}(t)\n705: = m_\\infty - \\big(m_\\infty - m_0\\big) e^{-(c_{\\max} + \\lambda_{\\text{rev}}) t},\n706: \\qquad\n707: m_\\infty = \\frac{\\lambda_{\\text{rev}}}{c_{\\max} + \\lambda_{\\text{rev}}} > 0.\n708: $$\n709: \n710: Hence $m_a(t) \\geq m_{\\text{floor}}(t)$ for all $t \\geq 0$. Choosing the equilibration time $t_{\\text{eq}} = O(\\kappa_{\\text{QSD}}^{-1} \\log N)$, we set\n711: \n712: $$\n713: c_{\\text{early}} := \\frac{1}{2} \\min_{0 \\leq s \\leq t_{\\text{eq}}} m_{\\text{floor}}(s) > 0.\n714: $$\n715: \n716: The propagation-of-chaos estimate proved in Section 4.5 (Proposition {prf:ref}`prop-poc-mass`) states that, for any $\\epsilon > 0$,\n717: \n718: $$\n719: \\mathbb{P}\\left( \\sup_{0 \\leq s \\leq t_{\\text{eq}}} \\left| \\frac{k_s}{N} - m_a(s) \\right| > \\epsilon \\right) \\leq C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N \\epsilon^2}.\n720: $$\n721: \n722: Taking $\\epsilon = c_{\\text{early}}$ yields the early-time event\n723: \n724: $$\n725: \\mathbb{P}\\left( \\inf_{0 \\leq s \\leq t_{\\text{eq}}} \\frac{k_s}{N} \\geq c_{\\text{early}} \\right) \\geq 1 - C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N c_{\\text{early}}^2}.\n726: $$\n727: \n728: This establishes the desired floor on $[0, t_{\\text{eq}}]$.\n729: \n730: **Step 1: Spectral gap for configuration observables (removing the Markov assumption on $k_t$)**  \n731: The $N$-particle process $Z_t = (z_t^{(1)}, \\ldots, z_t^{(N)})$ is geometrically ergodic with spectral gap $\\kappa_{\\text{full}} > 0$ in $L^2(\\Pi_{\\text{QSD}}^{(N)})$ (Theorem 4.5 of `06_convergence.md`). For any observable $F : \\Omega^N \\to \\mathbb{R}$,\n732: \n733: $$\n734: \\text{Var}_{\\Pi_{\\text{QSD}}^{(N)}}(F) \\leq \\frac{1}{\\kappa_{\\text{full}}} \\langle -\\mathcal{L}^{(N)} F, F \\rangle.\n735: $$\n736: \n737: We apply this to $F(Z) = k(Z)/N = N^{-1} \\sum_{i=1}^N \\mathbf{1}_{\\{\\text{walker } i \\text{ alive}\\}}$. Changing a single coordinate alters $F$ by at most $1/N$, so $F$ is $1/N$-Lipschitz with respect to the Hamming metric. By the Herbst argument for Markov semigroups with spectral gap (see, e.g., Joulin & Ollivier 2010, Theorem 5.1), $F$ satisfies\n738: \n739: $$\n740: \\Pi_{\\text{QSD}}^{(N)}\\!\\left( \\left| \\frac{k}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n741: \\leq 2 \\exp\\!\\left( - \\frac{\\kappa_{\\text{full}} N^2 r^2}{2} \\right)\n742: \\leq 2 \\exp\\!\\left( - \\beta_{\\text{gap}} N r^2 \\right),\n743: $$\n744: \n745: where we set $\\beta_{\\text{gap}} := \\kappa_{\\text{full}} / 2$ (the second inequality uses $N^2 \\geq N$ so the exponent now scales linearly in $N$).\n746: \n747: This argument works directly on the full configuration process $Z_t$; no Markov property for the projected count $k_t$ is required, thereby correcting the earlier (invalid) reduction to a standalone birth-death chain.\n748: \n749: **Step 2: Finite-time concentration after equilibration**  \n750: Let $\\mathcal{L}_t$ be the law of $Z_t$ starting from any initial configuration with alive mass at least $c_{\\text{early}}$. By Theorem 4.5 of `06_convergence.md`,\n751: \n752: $$\n753: \\|\\mathcal{L}_t - \\Pi_{\\text{QSD}}^{(N)}\\|_{\\text{TV}}\n754: \\leq C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})} \\quad \\text{for } t \\geq t_{\\text{eq}}.\n755: $$\n756: \n757: Therefore, for $t \\geq t_{\\text{eq}}$ and any $r > 0$,\n758: \n759: $$\n760: \\mathbb{P}\\left( \\left| \\frac{k_t}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n761: \\leq 2 e^{-\\beta_{\\text{gap}} N r^2} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n762: $$\n763: \n764: Selecting $r = m_{\\text{eq}}/2$ yields\n765: \n766: $$\n767: \\mathbb{P}\\left( \\frac{k_t}{N} \\leq \\frac{m_{\\text{eq}}}{2} \\right)\n768: \\leq 2 e^{-\\beta_{\\text{gap}} N m_{\\text{eq}}^2 / 4} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n769: $$\n770: \n771: **Step 3: Survival conditioning**  \n772: The survival estimate of Theorem {prf:ref}`thm-exponential-survival` gives\n773: \n774: $$\n775: \\mathbb{P}(\\tau_\\dagger \\leq t) \\leq t e^{-C_{\\text{surv}} N}.\n776: $$\n777: \n778: Intersecting the complementary survival event with the concentration events from Steps 0-2 shows that, for all $t \\geq 0$,\n779: \n780: $$\n781: \\mathbb{P}\\left( \\frac{k_t}{N} \\geq \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right) \\right)\n782: \\geq 1 - C (1+t) e^{-\\delta N},\n783: $$\n784: \n785: with $\\delta = \\min(\\beta_{\\text{pc}} c_{\\text{early}}^2, \\beta_{\\text{gap}} m_{\\text{eq}}^2/4, C_{\\text{surv}})$.\n786: \n787: Setting\n788: \n789: $$\n790: c_{\\text{mass}} := \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right)\n791: $$\n792: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Stochastic Mass Conservation and High-Probability Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-linearized-spectral-gap",
      "title": "Exponential Decay in L¹ for Linearized Dynamics",
      "start_line": 1138,
      "end_line": 1173,
      "header_lines": [
        1139
      ],
      "content_start": 1141,
      "content_end": 1172,
      "content": "1141: :label: lem-linearized-spectral-gap\n1142: \n1143: The linearized operator $\\mathbb{L}^*$ around $\\pi_{\\text{QSD}}$ has a **spectral gap** in $L^2(\\pi_{\\text{QSD}})$:\n1144: \n1145: $$\n1146: \\mathbb{L}^* = -\\kappa_{\\text{lin}} + \\text{compact}\n1147: \n1148: $$\n1149: \n1150: where $\\kappa_{\\text{lin}} > 0$ is the gap. For any perturbation $\\eta_0$ with $\\|\\eta_0\\|_{L^1} \\leq \\delta$ sufficiently small, the linearized evolution satisfies:\n1151: \n1152: $$\n1153: \\|\\eta_t\\|_{L^1} \\leq \\|\\eta_0\\|_{L^1} e^{-\\kappa_{\\text{lin}} t / 2}\n1154: \n1155: $$\n1156: \n1157: for all $t \\geq 0$, provided $\\delta < \\delta_0$ for some threshold $\\delta_0$ determined by the nonlinearity $C_{\\text{nonlin}}$.\n1158: \n1159: **Proof Sketch**:\n1160: \n1161: This follows from standard perturbation theory for nonlinear parabolic equations:\n1162: \n1163: 1. **Spectral Gap**: The operator $\\mathbb{L}^*$ is the linearization of a hypoelliptic kinetic operator with compact perturbations (cloning, killing, revival). By the results in `06_convergence.md` (geometric ergodicity with rate $\\kappa_{\\text{QSD}}$), the linearized operator has a spectral gap $\\kappa_{\\text{lin}} \\approx \\kappa_{\\text{QSD}}$.\n1164: \n1165: 2. **Nonlinear Stability**: For the nonlinear equation $\\partial_t \\eta = \\mathbb{L}^* \\eta + \\mathcal{N}[\\eta]$, we use a Grönwall-type argument. The $L^1$ norm evolves as:\n1166: \n1167: $$\n1168: \\frac{d}{dt} \\|\\eta_t\\|_{L^1} \\leq -\\kappa_{\\text{lin}} \\|\\eta_t\\|_{L^1} + C_{\\text{nonlin}} \\|\\eta_t\\|_{L^1}^2\n1169: \n1170: $$\n1171: \n1172: For $\\|\\eta_0\\|_{L^1} \\leq \\delta_0 := \\kappa_{\\text{lin}} / (2 C_{\\text{nonlin}})$, the linear term dominates and we obtain exponential decay with rate $\\kappa_{\\text{lin}} / 2$.",
      "metadata": {
        "label": "lem-linearized-spectral-gap"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1138: **Step 2B: Spectral Gap of the Linearized Operator**\n1139: \n1140: :::{prf:lemma} Exponential Decay in L¹ for Linearized Dynamics\n1141: :label: lem-linearized-spectral-gap\n1142: \n1143: The linearized operator $\\mathbb{L}^*$ around $\\pi_{\\text{QSD}}$ has a **spectral gap** in $L^2(\\pi_{\\text{QSD}})$:\n1144: \n1145: $$\n1146: \\mathbb{L}^* = -\\kappa_{\\text{lin}} + \\text{compact}\n1147: \n1148: $$\n1149: \n1150: where $\\kappa_{\\text{lin}} > 0$ is the gap. For any perturbation $\\eta_0$ with $\\|\\eta_0\\|_{L^1} \\leq \\delta$ sufficiently small, the linearized evolution satisfies:\n1151: \n1152: $$\n1153: \\|\\eta_t\\|_{L^1} \\leq \\|\\eta_0\\|_{L^1} e^{-\\kappa_{\\text{lin}} t / 2}\n1154: \n1155: $$\n1156: \n1157: for all $t \\geq 0$, provided $\\delta < \\delta_0$ for some threshold $\\delta_0$ determined by the nonlinearity $C_{\\text{nonlin}}$.\n1158: \n1159: **Proof Sketch**:\n1160: \n1161: This follows from standard perturbation theory for nonlinear parabolic equations:\n1162: \n1163: 1. **Spectral Gap**: The operator $\\mathbb{L}^*$ is the linearization of a hypoelliptic kinetic operator with compact perturbations (cloning, killing, revival). By the results in `06_convergence.md` (geometric ergodicity with rate $\\kappa_{\\text{QSD}}$), the linearized operator has a spectral gap $\\kappa_{\\text{lin}} \\approx \\kappa_{\\text{QSD}}$.\n1164: \n1165: 2. **Nonlinear Stability**: For the nonlinear equation $\\partial_t \\eta = \\mathbb{L}^* \\eta + \\mathcal{N}[\\eta]$, we use a Grönwall-type argument. The $L^1$ norm evolves as:\n1166: \n1167: $$\n1168: \\frac{d}{dt} \\|\\eta_t\\|_{L^1} \\leq -\\kappa_{\\text{lin}} \\|\\eta_t\\|_{L^1} + C_{\\text{nonlin}} \\|\\eta_t\\|_{L^1}^2\n1169: \n1170: $$\n1171: \n1172: For $\\|\\eta_0\\|_{L^1} \\leq \\delta_0 := \\kappa_{\\text{lin}} / (2 C_{\\text{nonlin}})$, the linear term dominates and we obtain exponential decay with rate $\\kappa_{\\text{lin}} / 2$.\n1173: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Main Theorem: Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hypoellipticity-full-linearized",
      "title": "Hypoellipticity Preservation via Bootstrap Argument",
      "start_line": 1179,
      "end_line": 1263,
      "header_lines": [
        1180
      ],
      "content_start": 1182,
      "content_end": 1262,
      "content": "1182: :label: lem-hypoellipticity-full-linearized\n1183: \n1184: The linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` is **hypoelliptic** in the sense that:\n1185: \n1186: If $\\partial_t \\eta = \\mathbb{L}^* \\eta$ with initial condition $\\eta_0 \\in L^1(\\Omega)$, then for any $t > 0$, the solution $\\eta_t \\in C^\\infty(\\Omega)$.\n1187: \n1188: **Proof**:\n1189: \n1190: The proof uses a **bootstrap argument** that separates the \"regularizing engine\" (kinetic operator) from the \"source terms\" (nonlocal operators).\n1191: \n1192: **Step 1: Isolate the Hypoelliptic Engine**\n1193: \n1194: Rearrange the evolution equation:\n1195: \n1196: $$\n1197: \\frac{\\partial \\eta}{\\partial t} - \\mathcal{L}_{\\text{kin}}^* \\eta = f[\\eta]\n1198: \n1199: $$\n1200: \n1201: where the \"source term\" is:\n1202: \n1203: $$\n1204: f[\\eta] := \\mathbb{L}_{\\text{clone}}^* \\eta - c(z) \\eta + \\mathbb{L}_{\\text{revival}}^* \\eta\n1205: \n1206: $$\n1207: \n1208: Define the hypoelliptic operator $\\mathbb{L}_{\\text{hypo}} := \\partial_t - \\mathcal{L}_{\\text{kin}}^*$. By Lemma {prf:ref}`lem-hormander-bracket` (Section 2.2), this operator satisfies Hörmander's bracket condition, making it hypoelliptic.\n1209: \n1210: **Step 2: Hörmander's Theorem**\n1211: \n1212: By Hörmander's theorem (Hörmander 1967, *Acta Math.* 119:147-171), if $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ and the source term $f \\in C^k(\\Omega)$ for some $k \\geq 0$, then the solution $\\eta$ is automatically smoother: $\\eta \\in C^{k+\\alpha}(\\Omega)$ for some $\\alpha > 0$ (and in fact, $\\eta \\in C^\\infty$ if $f \\in C^\\infty$).\n1213: \n1214: **Step 3: Regularity of the Source Term**\n1215: \n1216: The key observation is that **if $\\eta \\in C^k$, then $f[\\eta] \\in C^k$**. We verify each component:\n1217: \n1218: **Cloning operator**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator is:\n1219: \n1220: $$\n1221: \\mathbb{L}_{\\text{clone}}^* \\eta = \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n1222: \n1223: $$\n1224: \n1225: This is a convolution with the Gaussian kernel $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x - x') \\delta(v - v')$ plus multiplication by the fitness functional $V[\\pi]$ and its derivative $V'[\\pi]$.\n1226: \n1227: - The Gaussian kernel $G_{\\sigma_x}$ is $C^\\infty$ (analytic).\n1228: - The fitness functional $V[\\pi]$ depends on the potential $U$ and the virtual reward mechanism. From the Fragile framework (`02_euclidean_gas.md`, Axiom of Smooth Potential), the potential $U \\in C^\\infty(\\mathcal{X})$. The virtual reward is a functional of integrals of $\\pi$, which are smooth.\n1229: - **Conclusion**: Convolution with a $C^\\infty$ kernel preserves regularity. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{clone}}^* \\eta \\in C^k$.\n1230: \n1231: **Killing term**: $-c(z) \\eta$ where $c(z) \\geq 0$ is the killing rate. From the framework, $c(z)$ is smooth (defined by the domain boundaries with smooth indicator functions). If $\\eta \\in C^k$, then $c(z) \\eta \\in C^k$.\n1232: \n1233: **Revival term**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized revival operator is:\n1234: \n1235: $$\n1236: \\mathbb{L}_{\\text{revival}}^* \\eta = \\lambda_{\\text{rev}} \\frac{m_d}{m_{\\text{eq}}} \\left( f_{\\text{safe}} \\eta - \\frac{f_{\\text{safe}}}{m_{\\text{eq}}} \\int \\eta \\, dz \\right)\n1237: \n1238: $$\n1239: \n1240: where $f_{\\text{safe}}$ is the revival distribution (smooth by framework assumptions). The integral $\\int \\eta \\, dz$ is a scalar. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{revival}}^* \\eta \\in C^k$.\n1241: \n1242: **Overall**: All components of $f[\\eta]$ preserve regularity, so $\\eta \\in C^k \\Rightarrow f[\\eta] \\in C^k$.\n1243: \n1244: **Step 4: Bootstrap Loop**\n1245: \n1246: 1. **Initial regularity**: From basic parabolic theory, for short time $t > 0$, the solution $\\eta_t$ is at least continuous: $\\eta_t \\in C^0(\\Omega)$.\n1247: \n1248: 2. **Bootstrap iteration**: Assume $\\eta \\in C^k$ for some $k \\geq 0$. Then:\n1249:    - By Step 3, $f[\\eta] \\in C^k$\n1250:    - By Hörmander's theorem (Step 2), $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ implies $\\eta \\in C^{k+\\alpha}$\n1251:    - Therefore, $\\eta$ is strictly smoother than we assumed\n1252: \n1253: 3. **Infinite iteration**: Repeating this argument indefinitely, we conclude $\\eta \\in C^\\infty(\\Omega)$ for all $t > 0$.\n1254: \n1255: **Step 5: Nash-Aronson Applicability**\n1256: \n1257: Since the operator $\\mathbb{L}^*$ is hypoelliptic (produces $C^\\infty$ solutions), the standard theory of hypoelliptic parabolic equations applies. In particular:\n1258: \n1259: - The Nash inequality holds for $\\mathbb{L}^*$ (Hérau & Nier 2004, Theorem 2.1, extended to operators with smooth source terms)\n1260: - The ultracontractivity estimate (Nash-Aronson) follows from the Nash inequality via standard bootstrapping arguments (Aronson 1968; Carlen & Loss 1993)\n1261: \n1262: **Conclusion**: The full linearized operator $\\mathbb{L}^*$ is hypoelliptic, and the Nash-Aronson $L^1 \\to L^\\infty$ estimate applies to its semigroup.",
      "metadata": {
        "label": "lem-hypoellipticity-full-linearized"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1179: Before we can apply parabolic regularity estimates (Nash-Aronson), we must establish that the full linearized operator $\\mathbb{L}^*$ (including nonlocal cloning and revival terms) preserves the hypoelliptic structure of the kinetic operator.\n1180: \n1181: :::{prf:lemma} Hypoellipticity Preservation via Bootstrap Argument\n1182: :label: lem-hypoellipticity-full-linearized\n1183: \n1184: The linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` is **hypoelliptic** in the sense that:\n1185: \n1186: If $\\partial_t \\eta = \\mathbb{L}^* \\eta$ with initial condition $\\eta_0 \\in L^1(\\Omega)$, then for any $t > 0$, the solution $\\eta_t \\in C^\\infty(\\Omega)$.\n1187: \n1188: **Proof**:\n1189: \n1190: The proof uses a **bootstrap argument** that separates the \"regularizing engine\" (kinetic operator) from the \"source terms\" (nonlocal operators).\n1191: \n1192: **Step 1: Isolate the Hypoelliptic Engine**\n1193: \n1194: Rearrange the evolution equation:\n1195: \n1196: $$\n1197: \\frac{\\partial \\eta}{\\partial t} - \\mathcal{L}_{\\text{kin}}^* \\eta = f[\\eta]\n1198: \n1199: $$\n1200: \n1201: where the \"source term\" is:\n1202: \n1203: $$\n1204: f[\\eta] := \\mathbb{L}_{\\text{clone}}^* \\eta - c(z) \\eta + \\mathbb{L}_{\\text{revival}}^* \\eta\n1205: \n1206: $$\n1207: \n1208: Define the hypoelliptic operator $\\mathbb{L}_{\\text{hypo}} := \\partial_t - \\mathcal{L}_{\\text{kin}}^*$. By Lemma {prf:ref}`lem-hormander-bracket` (Section 2.2), this operator satisfies Hörmander's bracket condition, making it hypoelliptic.\n1209: \n1210: **Step 2: Hörmander's Theorem**\n1211: \n1212: By Hörmander's theorem (Hörmander 1967, *Acta Math.* 119:147-171), if $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ and the source term $f \\in C^k(\\Omega)$ for some $k \\geq 0$, then the solution $\\eta$ is automatically smoother: $\\eta \\in C^{k+\\alpha}(\\Omega)$ for some $\\alpha > 0$ (and in fact, $\\eta \\in C^\\infty$ if $f \\in C^\\infty$).\n1213: \n1214: **Step 3: Regularity of the Source Term**\n1215: \n1216: The key observation is that **if $\\eta \\in C^k$, then $f[\\eta] \\in C^k$**. We verify each component:\n1217: \n1218: **Cloning operator**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator is:\n1219: \n1220: $$\n1221: \\mathbb{L}_{\\text{clone}}^* \\eta = \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n1222: \n1223: $$\n1224: \n1225: This is a convolution with the Gaussian kernel $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x - x') \\delta(v - v')$ plus multiplication by the fitness functional $V[\\pi]$ and its derivative $V'[\\pi]$.\n1226: \n1227: - The Gaussian kernel $G_{\\sigma_x}$ is $C^\\infty$ (analytic).\n1228: - The fitness functional $V[\\pi]$ depends on the potential $U$ and the virtual reward mechanism. From the Fragile framework (`02_euclidean_gas.md`, Axiom of Smooth Potential), the potential $U \\in C^\\infty(\\mathcal{X})$. The virtual reward is a functional of integrals of $\\pi$, which are smooth.\n1229: - **Conclusion**: Convolution with a $C^\\infty$ kernel preserves regularity. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{clone}}^* \\eta \\in C^k$.\n1230: \n1231: **Killing term**: $-c(z) \\eta$ where $c(z) \\geq 0$ is the killing rate. From the framework, $c(z)$ is smooth (defined by the domain boundaries with smooth indicator functions). If $\\eta \\in C^k$, then $c(z) \\eta \\in C^k$.\n1232: \n1233: **Revival term**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized revival operator is:\n1234: \n1235: $$\n1236: \\mathbb{L}_{\\text{revival}}^* \\eta = \\lambda_{\\text{rev}} \\frac{m_d}{m_{\\text{eq}}} \\left( f_{\\text{safe}} \\eta - \\frac{f_{\\text{safe}}}{m_{\\text{eq}}} \\int \\eta \\, dz \\right)\n1237: \n1238: $$\n1239: \n1240: where $f_{\\text{safe}}$ is the revival distribution (smooth by framework assumptions). The integral $\\int \\eta \\, dz$ is a scalar. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{revival}}^* \\eta \\in C^k$.\n1241: \n1242: **Overall**: All components of $f[\\eta]$ preserve regularity, so $\\eta \\in C^k \\Rightarrow f[\\eta] \\in C^k$.\n1243: \n1244: **Step 4: Bootstrap Loop**\n1245: \n1246: 1. **Initial regularity**: From basic parabolic theory, for short time $t > 0$, the solution $\\eta_t$ is at least continuous: $\\eta_t \\in C^0(\\Omega)$.\n1247: \n1248: 2. **Bootstrap iteration**: Assume $\\eta \\in C^k$ for some $k \\geq 0$. Then:\n1249:    - By Step 3, $f[\\eta] \\in C^k$\n1250:    - By Hörmander's theorem (Step 2), $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ implies $\\eta \\in C^{k+\\alpha}$\n1251:    - Therefore, $\\eta$ is strictly smoother than we assumed\n1252: \n1253: 3. **Infinite iteration**: Repeating this argument indefinitely, we conclude $\\eta \\in C^\\infty(\\Omega)$ for all $t > 0$.\n1254: \n1255: **Step 5: Nash-Aronson Applicability**\n1256: \n1257: Since the operator $\\mathbb{L}^*$ is hypoelliptic (produces $C^\\infty$ solutions), the standard theory of hypoelliptic parabolic equations applies. In particular:\n1258: \n1259: - The Nash inequality holds for $\\mathbb{L}^*$ (Hérau & Nier 2004, Theorem 2.1, extended to operators with smooth source terms)\n1260: - The ultracontractivity estimate (Nash-Aronson) follows from the Nash inequality via standard bootstrapping arguments (Aronson 1968; Carlen & Loss 1993)\n1261: \n1262: **Conclusion**: The full linearized operator $\\mathbb{L}^*$ is hypoelliptic, and the Nash-Aronson $L^1 \\to L^\\infty$ estimate applies to its semigroup.\n1263: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Main Theorem: Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-relative-boundedness-nonlocal",
      "title": "Relative Boundedness of Nonlocal Operators",
      "start_line": 1274,
      "end_line": 1379,
      "header_lines": [
        1275
      ],
      "content_start": 1277,
      "content_end": 1378,
      "content": "1277: :label: lem-relative-boundedness-nonlocal\n1278: \n1279: The linearized nonlocal operators $\\mathbb{L}_{\\text{clone}}^*$ and $\\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` are **relatively bounded** with respect to the kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ in $L^2(\\pi_{\\text{QSD}}^{-1})$:\n1280: \n1281: $$\n1282: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2} \\leq C_1 \\|g\\|_{L^2}\n1283: $$\n1284: \n1285: $$\n1286: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq C_2 \\|g\\|_{L^2}\n1287: $$\n1288: \n1289: with constants $C_1, C_2 < \\kappa_{\\text{kin}} / 2$ where $\\kappa_{\\text{kin}} > 0$ is the kinetic spectral gap.\n1290: \n1291: **Consequence**: The full linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ retains a spectral gap:\n1292: \n1293: $$\n1294: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1295: $$\n1296: \n1297: and the associated Dirichlet form $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle_{\\pi_{\\text{QSD}}^{-1}}$ is coercive:\n1298: \n1299: $$\n1300: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2\n1301: \n1302: $$\n1303: \n1304: **Proof**:\n1305: \n1306: **Part 1: Cloning Operator Bound**\n1307: \n1308: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator has the form:\n1309: \n1310: $$\n1311: \\mathbb{L}_{\\text{clone}}^* g(z) = \\int_\\Omega K_{\\text{clone}}(z, z') W(z, z') [g(z') - g(z)] dz'\n1312: $$\n1313: \n1314: where $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x-x') \\delta(v-v')$ is the Gaussian position kernel and $W(z, z')$ is a bounded fitness-dependent weight with $\\|W\\|_\\infty \\leq V_{\\max}$.\n1315: \n1316: By the **Schur test** for integral operators:\n1317: \n1318: $$\n1319: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2}^2 = \\int_\\Omega \\left| \\int_\\Omega K(z,z') W(z,z') [g(z') - g(z)] dz' \\right|^2 dz\n1320: $$\n1321: \n1322: Using Cauchy-Schwarz and the fact that $K$ is a probability kernel ($\\int K(z, z') dz' = 1$):\n1323: \n1324: $$\n1325: \\leq 2 V_{\\max}^2 \\left[ \\int_\\Omega |g(z')|^2 dz' + \\int_\\Omega |g(z)|^2 dz \\right] = 4 V_{\\max}^2 \\|g\\|_{L^2}^2\n1326: $$\n1327: \n1328: Therefore, $C_1 = 2 V_{\\max}$.\n1329: \n1330: **Part 2: Revival Operator Bound**\n1331: \n1332: The linearized revival operator (from Lemma {prf:ref}`lem-linearization-qsd`) has the form:\n1333: \n1334: $$\n1335: \\mathbb{L}_{\\text{revival}}^* g = \\lambda_{\\text{rev}} \\left[ \\frac{m_d}{m_{\\text{eq}}} - \\frac{\\langle g, 1 \\rangle}{m_{\\text{eq}}} \\right] f_{\\text{safe}}\n1336: $$\n1337: \n1338: where $f_{\\text{safe}}$ is the safe-region density with $\\|f_{\\text{safe}}\\|_{L^\\infty} \\leq C_{\\text{safe}}$ and $m_d, m_{\\text{eq}}$ are the dead and equilibrium masses.\n1339: \n1340: The $L^2$ norm is:\n1341: \n1342: $$\n1343: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq \\lambda_{\\text{rev}} \\left( \\frac{\\|c\\|_\\infty m_{\\text{eq}}}{m_{\\text{eq}}} + \\frac{|\\langle g, 1 \\rangle|}{m_{\\text{eq}}} \\right) \\|f_{\\text{safe}}\\|_{L^2}\n1344: $$\n1345: \n1346: Using Cauchy-Schwarz for the inner product: $|\\langle g, 1 \\rangle| \\leq \\|g\\|_{L^2} \\cdot \\|1\\|_{L^2}$:\n1347: \n1348: $$\n1349: \\leq \\lambda_{\\text{rev}} C_{\\text{safe}} \\left( \\|c\\|_\\infty + \\frac{1}{m_{\\text{eq}}} \\|1\\|_{L^2} \\right) \\|g\\|_{L^2}\n1350: $$\n1351: \n1352: Therefore, $C_2 = \\lambda_{\\text{rev}} C_{\\text{safe}} (\\|c\\|_\\infty + \\|1\\|_{L^2} / m_{\\text{eq}})$.\n1353: \n1354: **Part 3: Kato-Rellich Perturbation Theory**\n1355: \n1356: From `06_convergence.md`, the pure kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ has spectral gap $\\kappa_{\\text{kin}} > 0$. By **Kato-Rellich perturbation theory** for sectorial operators (Kato 1995, *Perturbation Theory for Linear Operators*, Springer, Theorem IV.3.17):\n1357: \n1358: If the perturbation operators $\\mathbb{L}_{\\text{clone}}^*$, $\\mathbb{L}_{\\text{revival}}^*$, and $-c(z)$ satisfy $\\|B g\\|_{L^2} \\leq \\beta \\|g\\|_{L^2}$ with $\\beta < \\kappa_{\\text{kin}}$, then the perturbed operator retains a spectral gap:\n1359: \n1360: $$\n1361: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1362: $$\n1363: \n1364: **Part 4: Dirichlet Form Coercivity**\n1365: \n1366: The Dirichlet form is:\n1367: \n1368: $$\n1369: \\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle = \\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle + \\text{perturbation terms}\n1370: $$\n1371: \n1372: The kinetic part satisfies $\\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle \\geq \\kappa_{\\text{kin}} \\|g\\|_{L^2}^2$ (by spectral gap). The perturbation terms contribute at most $(C_1 + C_2 + \\|c\\|_\\infty) \\|g\\|_{L^2}^2$ in magnitude.\n1373: \n1374: Therefore:\n1375: \n1376: $$\n1377: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2 > 0\n1378: $$",
      "metadata": {
        "label": "lem-relative-boundedness-nonlocal"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1274: Before applying Nash-Aronson theory, we must verify that the nonlocal cloning and revival operators do not destroy the coercive Dirichlet form structure of the kinetic operator.\n1275: \n1276: :::{prf:lemma} Relative Boundedness of Nonlocal Operators\n1277: :label: lem-relative-boundedness-nonlocal\n1278: \n1279: The linearized nonlocal operators $\\mathbb{L}_{\\text{clone}}^*$ and $\\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` are **relatively bounded** with respect to the kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ in $L^2(\\pi_{\\text{QSD}}^{-1})$:\n1280: \n1281: $$\n1282: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2} \\leq C_1 \\|g\\|_{L^2}\n1283: $$\n1284: \n1285: $$\n1286: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq C_2 \\|g\\|_{L^2}\n1287: $$\n1288: \n1289: with constants $C_1, C_2 < \\kappa_{\\text{kin}} / 2$ where $\\kappa_{\\text{kin}} > 0$ is the kinetic spectral gap.\n1290: \n1291: **Consequence**: The full linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ retains a spectral gap:\n1292: \n1293: $$\n1294: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1295: $$\n1296: \n1297: and the associated Dirichlet form $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle_{\\pi_{\\text{QSD}}^{-1}}$ is coercive:\n1298: \n1299: $$\n1300: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2\n1301: \n1302: $$\n1303: \n1304: **Proof**:\n1305: \n1306: **Part 1: Cloning Operator Bound**\n1307: \n1308: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator has the form:\n1309: \n1310: $$\n1311: \\mathbb{L}_{\\text{clone}}^* g(z) = \\int_\\Omega K_{\\text{clone}}(z, z') W(z, z') [g(z') - g(z)] dz'\n1312: $$\n1313: \n1314: where $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x-x') \\delta(v-v')$ is the Gaussian position kernel and $W(z, z')$ is a bounded fitness-dependent weight with $\\|W\\|_\\infty \\leq V_{\\max}$.\n1315: \n1316: By the **Schur test** for integral operators:\n1317: \n1318: $$\n1319: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2}^2 = \\int_\\Omega \\left| \\int_\\Omega K(z,z') W(z,z') [g(z') - g(z)] dz' \\right|^2 dz\n1320: $$\n1321: \n1322: Using Cauchy-Schwarz and the fact that $K$ is a probability kernel ($\\int K(z, z') dz' = 1$):\n1323: \n1324: $$\n1325: \\leq 2 V_{\\max}^2 \\left[ \\int_\\Omega |g(z')|^2 dz' + \\int_\\Omega |g(z)|^2 dz \\right] = 4 V_{\\max}^2 \\|g\\|_{L^2}^2\n1326: $$\n1327: \n1328: Therefore, $C_1 = 2 V_{\\max}$.\n1329: \n1330: **Part 2: Revival Operator Bound**\n1331: \n1332: The linearized revival operator (from Lemma {prf:ref}`lem-linearization-qsd`) has the form:\n1333: \n1334: $$\n1335: \\mathbb{L}_{\\text{revival}}^* g = \\lambda_{\\text{rev}} \\left[ \\frac{m_d}{m_{\\text{eq}}} - \\frac{\\langle g, 1 \\rangle}{m_{\\text{eq}}} \\right] f_{\\text{safe}}\n1336: $$\n1337: \n1338: where $f_{\\text{safe}}$ is the safe-region density with $\\|f_{\\text{safe}}\\|_{L^\\infty} \\leq C_{\\text{safe}}$ and $m_d, m_{\\text{eq}}$ are the dead and equilibrium masses.\n1339: \n1340: The $L^2$ norm is:\n1341: \n1342: $$\n1343: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq \\lambda_{\\text{rev}} \\left( \\frac{\\|c\\|_\\infty m_{\\text{eq}}}{m_{\\text{eq}}} + \\frac{|\\langle g, 1 \\rangle|}{m_{\\text{eq}}} \\right) \\|f_{\\text{safe}}\\|_{L^2}\n1344: $$\n1345: \n1346: Using Cauchy-Schwarz for the inner product: $|\\langle g, 1 \\rangle| \\leq \\|g\\|_{L^2} \\cdot \\|1\\|_{L^2}$:\n1347: \n1348: $$\n1349: \\leq \\lambda_{\\text{rev}} C_{\\text{safe}} \\left( \\|c\\|_\\infty + \\frac{1}{m_{\\text{eq}}} \\|1\\|_{L^2} \\right) \\|g\\|_{L^2}\n1350: $$\n1351: \n1352: Therefore, $C_2 = \\lambda_{\\text{rev}} C_{\\text{safe}} (\\|c\\|_\\infty + \\|1\\|_{L^2} / m_{\\text{eq}})$.\n1353: \n1354: **Part 3: Kato-Rellich Perturbation Theory**\n1355: \n1356: From `06_convergence.md`, the pure kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ has spectral gap $\\kappa_{\\text{kin}} > 0$. By **Kato-Rellich perturbation theory** for sectorial operators (Kato 1995, *Perturbation Theory for Linear Operators*, Springer, Theorem IV.3.17):\n1357: \n1358: If the perturbation operators $\\mathbb{L}_{\\text{clone}}^*$, $\\mathbb{L}_{\\text{revival}}^*$, and $-c(z)$ satisfy $\\|B g\\|_{L^2} \\leq \\beta \\|g\\|_{L^2}$ with $\\beta < \\kappa_{\\text{kin}}$, then the perturbed operator retains a spectral gap:\n1359: \n1360: $$\n1361: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1362: $$\n1363: \n1364: **Part 4: Dirichlet Form Coercivity**\n1365: \n1366: The Dirichlet form is:\n1367: \n1368: $$\n1369: \\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle = \\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle + \\text{perturbation terms}\n1370: $$\n1371: \n1372: The kinetic part satisfies $\\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle \\geq \\kappa_{\\text{kin}} \\|g\\|_{L^2}^2$ (by spectral gap). The perturbation terms contribute at most $(C_1 + C_2 + \\|c\\|_\\infty) \\|g\\|_{L^2}^2$ in magnitude.\n1373: \n1374: Therefore:\n1375: \n1376: $$\n1377: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2 > 0\n1378: $$\n1379: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Main Theorem: Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-l1-to-linfty-near-qsd",
      "title": "Nash-Aronson Type L¹-to-L∞ Bound for Linearized Operator",
      "start_line": 1387,
      "end_line": 1451,
      "header_lines": [
        1388
      ],
      "content_start": 1390,
      "content_end": 1450,
      "content": "1390: :label: lem-l1-to-linfty-near-qsd\n1391: \n1392: For the linearized evolution $\\partial_t \\eta = \\mathbb{L}^* \\eta$ starting from $\\eta_0$ with $\\|\\eta_0\\|_{L^1} = m$ and $\\|\\eta_0\\|_{L^\\infty} \\leq M$, there exist constants $C_{\\text{Nash}}, \\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\sigma_x, R, d$) such that for any $t \\geq \\tau$ (one timestep):\n1393: \n1394: $$\n1395: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1396: \n1397: $$\n1398: \n1399: **Interpretation**: The $L^\\infty$ norm of perturbations decays to a level controlled by the $L^1$ norm, with a heat-kernel-like rate $t^{-d/2}$.\n1400: \n1401: **Proof**:\n1402: \n1403: This is a classical result in parabolic regularity theory, adapted to the hypoelliptic kinetic setting.\n1404: \n1405: **Step 1: Nash Inequality for Kinetic Operators**\n1406: \n1407: From Hérau & Nier (2004, *Arch. Ration. Mech. Anal.* 171:151-218, Theorem 2.1), hypoelliptic kinetic operators satisfy a Nash-type inequality: for any smooth function $g$ with $\\|g\\|_{L^1} = m$:\n1408: \n1409: $$\n1410: \\|g\\|_{L^2}^{2 + 4/d} \\leq C_N \\left( \\mathcal{E}(g) \\|g\\|_{L^1}^{4/d} + \\|g\\|_{L^1}^{2 + 4/d} \\right)\n1411: \n1412: $$\n1413: \n1414: where $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle$ is the Dirichlet form (entropy production).\n1415: \n1416: **Step 2: L²-to-L∞ Bootstrapping**\n1417: \n1418: For parabolic equations, the Nash inequality implies ultracontractivity of the semigroup $e^{t \\mathbb{L}^*}$: there exists $C_U$ such that:\n1419: \n1420: $$\n1421: \\|e^{t \\mathbb{L}^*}\\|_{L^1 \\to L^\\infty} \\leq \\frac{C_U}{t^{d/2}}\n1422: \n1423: $$\n1424: \n1425: for $t \\geq \\tau$. This is the **Nash-Aronson estimate** (Aronson 1968, *Bull. Amer. Math. Soc.* 74:47-49).\n1426: \n1427: **Step 3: Semigroup Decomposition**\n1428: \n1429: For $\\eta_0$ with mixed $L^1$ and $L^\\infty$ bounds, we use the semigroup property:\n1430: \n1431: $$\n1432: \\eta_t = e^{t \\mathbb{L}^*} \\eta_0\n1433: \n1434: $$\n1435: \n1436: Decompose $\\eta_0 = \\eta_0^{\\text{small}} + \\eta_0^{\\text{large}}$ where $\\|\\eta_0^{\\text{small}}\\|_{L^\\infty}$ is small but $\\|\\eta_0^{\\text{small}}\\|_{L^1} = m$, and $\\|\\eta_0^{\\text{large}}\\|_{L^1}$ is small. Then:\n1437: \n1438: $$\n1439: \\|\\eta_t\\|_{L^\\infty} \\leq \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{small}}\\|_{L^\\infty} + \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{large}}\\|_{L^\\infty}\n1440: \n1441: $$\n1442: \n1443: The first term is bounded by the ultracontractivity estimate: $C_U m / t^{d/2}$. The second term decays exponentially by the spectral gap: $M e^{-\\alpha t}$.\n1444: \n1445: Combining these:\n1446: \n1447: $$\n1448: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1449: \n1450: $$",
      "metadata": {
        "label": "lem-l1-to-linfty-near-qsd"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1387: This is the key technical lemma that upgrades weak ($L^1$) convergence to strong ($L^\\infty$) bounds.\n1388: \n1389: :::{prf:lemma} Nash-Aronson Type L¹-to-L∞ Bound for Linearized Operator\n1390: :label: lem-l1-to-linfty-near-qsd\n1391: \n1392: For the linearized evolution $\\partial_t \\eta = \\mathbb{L}^* \\eta$ starting from $\\eta_0$ with $\\|\\eta_0\\|_{L^1} = m$ and $\\|\\eta_0\\|_{L^\\infty} \\leq M$, there exist constants $C_{\\text{Nash}}, \\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\sigma_x, R, d$) such that for any $t \\geq \\tau$ (one timestep):\n1393: \n1394: $$\n1395: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1396: \n1397: $$\n1398: \n1399: **Interpretation**: The $L^\\infty$ norm of perturbations decays to a level controlled by the $L^1$ norm, with a heat-kernel-like rate $t^{-d/2}$.\n1400: \n1401: **Proof**:\n1402: \n1403: This is a classical result in parabolic regularity theory, adapted to the hypoelliptic kinetic setting.\n1404: \n1405: **Step 1: Nash Inequality for Kinetic Operators**\n1406: \n1407: From Hérau & Nier (2004, *Arch. Ration. Mech. Anal.* 171:151-218, Theorem 2.1), hypoelliptic kinetic operators satisfy a Nash-type inequality: for any smooth function $g$ with $\\|g\\|_{L^1} = m$:\n1408: \n1409: $$\n1410: \\|g\\|_{L^2}^{2 + 4/d} \\leq C_N \\left( \\mathcal{E}(g) \\|g\\|_{L^1}^{4/d} + \\|g\\|_{L^1}^{2 + 4/d} \\right)\n1411: \n1412: $$\n1413: \n1414: where $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle$ is the Dirichlet form (entropy production).\n1415: \n1416: **Step 2: L²-to-L∞ Bootstrapping**\n1417: \n1418: For parabolic equations, the Nash inequality implies ultracontractivity of the semigroup $e^{t \\mathbb{L}^*}$: there exists $C_U$ such that:\n1419: \n1420: $$\n1421: \\|e^{t \\mathbb{L}^*}\\|_{L^1 \\to L^\\infty} \\leq \\frac{C_U}{t^{d/2}}\n1422: \n1423: $$\n1424: \n1425: for $t \\geq \\tau$. This is the **Nash-Aronson estimate** (Aronson 1968, *Bull. Amer. Math. Soc.* 74:47-49).\n1426: \n1427: **Step 3: Semigroup Decomposition**\n1428: \n1429: For $\\eta_0$ with mixed $L^1$ and $L^\\infty$ bounds, we use the semigroup property:\n1430: \n1431: $$\n1432: \\eta_t = e^{t \\mathbb{L}^*} \\eta_0\n1433: \n1434: $$\n1435: \n1436: Decompose $\\eta_0 = \\eta_0^{\\text{small}} + \\eta_0^{\\text{large}}$ where $\\|\\eta_0^{\\text{small}}\\|_{L^\\infty}$ is small but $\\|\\eta_0^{\\text{small}}\\|_{L^1} = m$, and $\\|\\eta_0^{\\text{large}}\\|_{L^1}$ is small. Then:\n1437: \n1438: $$\n1439: \\|\\eta_t\\|_{L^\\infty} \\leq \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{small}}\\|_{L^\\infty} + \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{large}}\\|_{L^\\infty}\n1440: \n1441: $$\n1442: \n1443: The first term is bounded by the ultracontractivity estimate: $C_U m / t^{d/2}$. The second term decays exponentially by the spectral gap: $M e^{-\\alpha t}$.\n1444: \n1445: Combining these:\n1446: \n1447: $$\n1448: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1449: \n1450: $$\n1451: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Main Theorem: Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mass-contraction-revival-death",
      "title": "Mass Contraction via Revival and Death",
      "start_line": 186,
      "end_line": 226,
      "header_lines": [
        187
      ],
      "content_start": 189,
      "content_end": 225,
      "content": "189: :label: lem-mass-contraction-revival-death\n190: \n191: Let $k_t = \\|\\mu_t\\|$ denote the number of alive walkers at time $t$ (the total mass of the empirical measure). Let $k_* = \\|\\pi_{\\text{QSD}}\\|$ denote the equilibrium alive count under the QSD.\n192: \n193: Assume:\n194: 1. **Birth Mechanism**: The Fragile Gas creates new walkers via two processes:\n195:    - Guaranteed revival of all dead walkers (from {prf:ref}`def-axiom-guaranteed-revival`)\n196:    - Cloning of alive walkers with rate $\\lambda_{\\text{clone}}(k_t)$ per walker\n197: \n198:    Total births: $B_t = (N - k_t) + C_t$ where $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$\n199: \n200: 2. **Death Mechanism**: Boundary exit causes death with rate $\\bar{p}_{\\text{kill}}(k_t)$, giving $\\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(k_t) k_t$\n201: \n202: 3. **QSD Equilibrium**: The equilibrium mass $k_*$ satisfies $(N - k_*) + \\lambda_{\\text{clone}}^* k_* = \\bar{p}_{\\text{kill}}^* k_*$\n203: \n204: 4. **Lipschitz Continuity**: Both $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k)$ are Lipschitz continuous:\n205:    - $|\\lambda_{\\text{clone}}(k_t) - \\lambda_{\\text{clone}}^*| \\leq L_\\lambda |k_t - k_*|$\n206:    - $|\\bar{p}_{\\text{kill}}(k_t) - \\bar{p}_{\\text{kill}}^*| \\leq L_p |k_t - k_*|$\n207: \n208: Then there exist constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$ such that:\n209: \n210: $$\n211: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n212: \n213: $$\n214: \n215: where:\n216: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n217: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n218: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n219: - $L_\\lambda$ is the Lipschitz constant of the cloning rate\n220: - $L_p$ is the Lipschitz constant of the killing rate\n221: - $N$ is the total number of walkers (alive + dead)\n222: \n223: **Assumptions:**\n224: 1. $\\epsilon^2 + \\epsilon < 1$, which requires $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (achieved when $L_p L_\\lambda = O(1/N^2)$ for large $N$)\n225: 2. $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with $L_g^{(2)} = O(N^{-1})$ (natural for density-dependent rates)",
      "metadata": {
        "label": "lem-mass-contraction-revival-death"
      },
      "section": "## 2. Lemma A: Mass Contraction from Revival and Death",
      "raw_directive": "186: This lemma establishes that the combined effect of the revival mechanism (Axiom of Guaranteed Revival) and boundary death causes the total alive mass to contract toward the QSD equilibrium mass. The proof analyzes the full distribution of the mass change, accounting for both revival (mass increase) and boundary death (mass decrease).\n187: \n188: :::{prf:lemma} Mass Contraction via Revival and Death\n189: :label: lem-mass-contraction-revival-death\n190: \n191: Let $k_t = \\|\\mu_t\\|$ denote the number of alive walkers at time $t$ (the total mass of the empirical measure). Let $k_* = \\|\\pi_{\\text{QSD}}\\|$ denote the equilibrium alive count under the QSD.\n192: \n193: Assume:\n194: 1. **Birth Mechanism**: The Fragile Gas creates new walkers via two processes:\n195:    - Guaranteed revival of all dead walkers (from {prf:ref}`def-axiom-guaranteed-revival`)\n196:    - Cloning of alive walkers with rate $\\lambda_{\\text{clone}}(k_t)$ per walker\n197: \n198:    Total births: $B_t = (N - k_t) + C_t$ where $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$\n199: \n200: 2. **Death Mechanism**: Boundary exit causes death with rate $\\bar{p}_{\\text{kill}}(k_t)$, giving $\\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(k_t) k_t$\n201: \n202: 3. **QSD Equilibrium**: The equilibrium mass $k_*$ satisfies $(N - k_*) + \\lambda_{\\text{clone}}^* k_* = \\bar{p}_{\\text{kill}}^* k_*$\n203: \n204: 4. **Lipschitz Continuity**: Both $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k)$ are Lipschitz continuous:\n205:    - $|\\lambda_{\\text{clone}}(k_t) - \\lambda_{\\text{clone}}^*| \\leq L_\\lambda |k_t - k_*|$\n206:    - $|\\bar{p}_{\\text{kill}}(k_t) - \\bar{p}_{\\text{kill}}^*| \\leq L_p |k_t - k_*|$\n207: \n208: Then there exist constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$ such that:\n209: \n210: $$\n211: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n212: \n213: $$\n214: \n215: where:\n216: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n217: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n218: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n219: - $L_\\lambda$ is the Lipschitz constant of the cloning rate\n220: - $L_p$ is the Lipschitz constant of the killing rate\n221: - $N$ is the total number of walkers (alive + dead)\n222: \n223: **Assumptions:**\n224: 1. $\\epsilon^2 + \\epsilon < 1$, which requires $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (achieved when $L_p L_\\lambda = O(1/N^2)$ for large $N$)\n225: 2. $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with $L_g^{(2)} = O(N^{-1})$ (natural for density-dependent rates)\n226: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_original",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Lemma A: Mass Contraction from Revival and Death"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-structural-variance-contraction",
      "title": "Exponential Contraction of Structural Variance",
      "start_line": 1009,
      "end_line": 1029,
      "header_lines": [
        1010
      ],
      "content_start": 1012,
      "content_end": 1028,
      "content": "1012: :label: lem-structural-variance-contraction\n1013: \n1014: Let $\\mu_t$ denote the empirical measure of a single realization of the Fragile Gas at time $t$, and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1015: \n1016: Then the structural variance contracts exponentially in expectation:\n1017: \n1018: $$\n1019: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} t} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}}(1 - e^{-\\lambda_{\\text{struct}} t})\n1020: \n1021: $$\n1022: \n1023: where:\n1024: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the exponential convergence rate\n1025: - $\\kappa_W > 0$ is the cloning operator Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n1026: - $\\kappa_{\\text{kin}} > 0$ is the kinetic operator contraction rate from {prf:ref}`thm-foster-lyapunov-main`\n1027: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ combines noise constants from both operators\n1028: - $\\tau$ is the time step size",
      "metadata": {
        "label": "lem-structural-variance-contraction"
      },
      "section": "## 3. Lemma B: Exponential Contraction of Structural Variance",
      "raw_directive": "1009: **Mathematical Foundation:** This lemma uses the Wasserstein contraction results established in the framework. The cloning operator ({prf:ref}`thm-main-contraction-full` from [04_wasserstein_contraction](04_wasserstein_contraction)) and the kinetic operator ({prf:ref}`thm-foster-lyapunov-main` from [06_convergence](06_convergence)) each provide contraction of the Wasserstein distance **in expectation** after one step of the dynamics.\n1010: \n1011: :::{prf:lemma} Exponential Contraction of Structural Variance\n1012: :label: lem-structural-variance-contraction\n1013: \n1014: Let $\\mu_t$ denote the empirical measure of a single realization of the Fragile Gas at time $t$, and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1015: \n1016: Then the structural variance contracts exponentially in expectation:\n1017: \n1018: $$\n1019: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} t} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}}(1 - e^{-\\lambda_{\\text{struct}} t})\n1020: \n1021: $$\n1022: \n1023: where:\n1024: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the exponential convergence rate\n1025: - $\\kappa_W > 0$ is the cloning operator Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n1026: - $\\kappa_{\\text{kin}} > 0$ is the kinetic operator contraction rate from {prf:ref}`thm-foster-lyapunov-main`\n1027: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ combines noise constants from both operators\n1028: - $\\tau$ is the time step size\n1029: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_original",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Lemma B: Exponential Contraction of Structural Variance"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-kinetic-hellinger-contraction",
      "title": "Kinetic Operator Hellinger Contraction",
      "start_line": 1174,
      "end_line": 1220,
      "header_lines": [
        1175
      ],
      "content_start": 1177,
      "content_end": 1219,
      "content": "1177: :label: lem-kinetic-hellinger-contraction\n1178: \n1179: Let $\\mu_t$ be the empirical measure of alive walkers at time $t$ and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1180: \n1181: **Assumption:** The normalized density ratio is uniformly bounded:\n1182: \n1183: $$\n1184: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n1185: \n1186: $$\n1187: \n1188: where $\\tilde{\\mu}_t = \\mu_t / \\|\\mu_t\\|$ and $\\tilde{\\pi}_{\\text{QSD}} = \\pi_{\\text{QSD}} / \\|\\pi_{\\text{QSD}}\\|$ are the normalized probability measures.\n1189: \n1190: Under this assumption and the kinetic operator $\\Psi_{\\text{kin}}$ (BAOAB + boundary killing), there exist constants $\\kappa_{\\text{kin}}(M) > 0$ and $C_{\\text{kin}} < \\infty$ such that:\n1191: \n1192: $$\n1193: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}}(M) \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n1194: \n1195: $$\n1196: \n1197: where $\\tau$ is the time step size.\n1198: \n1199: **Interpretation:** The Hellinger distance to the QSD decreases exponentially fast under the kinetic operator, with a rate constant $\\kappa_{\\text{kin}}(M)$ that depends on the density bound $M$, the friction $\\gamma$, the potential coercivity $\\alpha_U$, and the hypocoercive coupling. The $O(\\tau^2)$ term arises from the BAOAB discretization error.\n1200: \n1201: **Justification of Assumption:** This assumption is satisfied for the Euclidean Gas under the following conditions:\n1202: \n1203: 1. **Bounded initial density:** If the empirical measure at $t=0$ has a bounded density ratio $d\\mu_0/d\\pi_{\\text{QSD}} \\leq M_0 < \\infty$, which holds for any finite particle system initialized within the valid domain.\n1204: \n1205: 2. **Gaussian regularization from cloning:** The cloning operator applies Gaussian perturbations with variance $\\delta^2 > 0$ to all walkers (Axiom {prf:ref}`def-axiom-local-perturbation` from [01_fragile_gas_framework](01_fragile_gas_framework)). This acts as a convolution with a Gaussian kernel:\n1206:    $$\n1207:    \\tilde{\\mu}_{t+} = \\tilde{\\mu}_t * G_{\\delta}\n1208:    $$\n1209:    Gaussian convolution immediately regularizes any measure to have $C^\\infty$ density. Since $\\pi_{\\text{QSD}}$ also has smooth density (from the Gibbs structure with smooth potential), the ratio $d\\tilde{\\mu}_{t+}/d\\tilde{\\pi}_{\\text{QSD}}$ remains bounded.\n1210: \n1211: 3. **Preservation under Fokker-Planck evolution:** The kinetic operator evolves densities according to the Fokker-Planck PDE. The **parabolic maximum principle** ensures that if $\\sup_x (d\\mu_t/d\\pi)(x) \\leq M$ initially, then $\\sup_x (d\\mu_{t+\\tau}/d\\pi)(x) \\leq M' $ where $M'$ depends on $M$, $\\tau$, and system parameters but remains finite for finite time.\n1212: \n1213: 4. **Confinement prevents escape to low-density regions:** The confining potential $U$ from Axiom {prf:ref}`ax-confining-potential` ensures $\\pi_{\\text{QSD}}(x) \\geq c_{\\min} e^{-U(x)}$ for some $c_{\\min} > 0$. Combined with the boundary killing mechanism, walkers are concentrated in regions where $\\pi_{\\text{QSD}}$ has significant mass, preventing the ratio from diverging.\n1214: \n1215: **Practical bound:** For finite-time analysis (up to any fixed $T < \\infty$), the bound $M = M(T, M_0, \\delta, \\gamma, U)$ is guaranteed to be finite by the regularization and confinement mechanisms. The constant $M$ depends on:\n1216: - Initial bound $M_0$\n1217: - Cloning noise $\\delta$ (smaller $\\delta$ requires larger $M$)\n1218: - Friction $\\gamma$ (larger $\\gamma$ gives better regularization)\n1219: - Potential curvature (stronger confinement gives tighter bounds)",
      "metadata": {
        "label": "lem-kinetic-hellinger-contraction"
      },
      "section": "## 4. Lemma C: Kinetic Operator Hellinger Analysis",
      "raw_directive": "1174: The QSD $\\pi_{\\text{QSD}}$ is the quasi-stationary distribution—the unique invariant measure conditioned on survival (see [06_convergence](06_convergence)).\n1175: \n1176: :::{prf:lemma} Kinetic Operator Hellinger Contraction\n1177: :label: lem-kinetic-hellinger-contraction\n1178: \n1179: Let $\\mu_t$ be the empirical measure of alive walkers at time $t$ and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1180: \n1181: **Assumption:** The normalized density ratio is uniformly bounded:\n1182: \n1183: $$\n1184: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n1185: \n1186: $$\n1187: \n1188: where $\\tilde{\\mu}_t = \\mu_t / \\|\\mu_t\\|$ and $\\tilde{\\pi}_{\\text{QSD}} = \\pi_{\\text{QSD}} / \\|\\pi_{\\text{QSD}}\\|$ are the normalized probability measures.\n1189: \n1190: Under this assumption and the kinetic operator $\\Psi_{\\text{kin}}$ (BAOAB + boundary killing), there exist constants $\\kappa_{\\text{kin}}(M) > 0$ and $C_{\\text{kin}} < \\infty$ such that:\n1191: \n1192: $$\n1193: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}}(M) \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n1194: \n1195: $$\n1196: \n1197: where $\\tau$ is the time step size.\n1198: \n1199: **Interpretation:** The Hellinger distance to the QSD decreases exponentially fast under the kinetic operator, with a rate constant $\\kappa_{\\text{kin}}(M)$ that depends on the density bound $M$, the friction $\\gamma$, the potential coercivity $\\alpha_U$, and the hypocoercive coupling. The $O(\\tau^2)$ term arises from the BAOAB discretization error.\n1200: \n1201: **Justification of Assumption:** This assumption is satisfied for the Euclidean Gas under the following conditions:\n1202: \n1203: 1. **Bounded initial density:** If the empirical measure at $t=0$ has a bounded density ratio $d\\mu_0/d\\pi_{\\text{QSD}} \\leq M_0 < \\infty$, which holds for any finite particle system initialized within the valid domain.\n1204: \n1205: 2. **Gaussian regularization from cloning:** The cloning operator applies Gaussian perturbations with variance $\\delta^2 > 0$ to all walkers (Axiom {prf:ref}`def-axiom-local-perturbation` from [01_fragile_gas_framework](01_fragile_gas_framework)). This acts as a convolution with a Gaussian kernel:\n1206:    $$\n1207:    \\tilde{\\mu}_{t+} = \\tilde{\\mu}_t * G_{\\delta}\n1208:    $$\n1209:    Gaussian convolution immediately regularizes any measure to have $C^\\infty$ density. Since $\\pi_{\\text{QSD}}$ also has smooth density (from the Gibbs structure with smooth potential), the ratio $d\\tilde{\\mu}_{t+}/d\\tilde{\\pi}_{\\text{QSD}}$ remains bounded.\n1210: \n1211: 3. **Preservation under Fokker-Planck evolution:** The kinetic operator evolves densities according to the Fokker-Planck PDE. The **parabolic maximum principle** ensures that if $\\sup_x (d\\mu_t/d\\pi)(x) \\leq M$ initially, then $\\sup_x (d\\mu_{t+\\tau}/d\\pi)(x) \\leq M' $ where $M'$ depends on $M$, $\\tau$, and system parameters but remains finite for finite time.\n1212: \n1213: 4. **Confinement prevents escape to low-density regions:** The confining potential $U$ from Axiom {prf:ref}`ax-confining-potential` ensures $\\pi_{\\text{QSD}}(x) \\geq c_{\\min} e^{-U(x)}$ for some $c_{\\min} > 0$. Combined with the boundary killing mechanism, walkers are concentrated in regions where $\\pi_{\\text{QSD}}$ has significant mass, preventing the ratio from diverging.\n1214: \n1215: **Practical bound:** For finite-time analysis (up to any fixed $T < \\infty$), the bound $M = M(T, M_0, \\delta, \\gamma, U)$ is guaranteed to be finite by the regularization and confinement mechanisms. The constant $M$ depends on:\n1216: - Initial bound $M_0$\n1217: - Cloning noise $\\delta$ (smaller $\\delta$ requires larger $M$)\n1218: - Friction $\\gamma$ (larger $\\gamma$ gives better regularization)\n1219: - Potential curvature (stronger confinement gives tighter bounds)\n1220: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_original",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Lemma C: Kinetic Operator Hellinger Analysis"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hypoelliptic-density-bound",
      "title": "Hypoelliptic Regularity Provides Density Bounds",
      "start_line": 1945,
      "end_line": 2033,
      "header_lines": [
        1946
      ],
      "content_start": 1948,
      "content_end": 2032,
      "content": "1948: :label: lem-hypoelliptic-density-bound\n1949: \n1950: **References**:\n1951: - [06_convergence.md](06_convergence), Section 4.4.1 \"Hypoellipticity and Gaussian Accessibility\"\n1952: - [09_kl_convergence.md](09_kl_convergence), Section 2 \"The Hypoelliptic Kinetic Operator\"\n1953: \n1954: The kinetic operator $\\mathcal{L}_{\\text{kin}}$ is **hypoelliptic** by Hörmander's theorem (Hörmander 1967, *Acta Math.* 119:147-171). The full McKean-Vlasov-Fokker-Planck generator including cloning, killing, and revival satisfies:\n1955: \n1956: 1. **Hörmander's Bracket Condition**: The drift vector field $v \\cdot \\nabla_x$ and diffusion operator $\\Delta_v$ satisfy the bracket condition, ensuring that iterating Lie brackets spans the full tangent space (see [06_convergence.md](06_convergence), Section 4.4.1).\n1957: \n1958: 2. **Smoothing Property**: Hypoelliptic operators have a smoothing property: if $\\rho_0 \\in L^1(\\Omega)$, then for $t > 0$, $\\rho(t, \\cdot) \\in C^\\infty(\\Omega)$ (smooth density).\n1959: \n1960: 3. **Gaussian Bounds**: The transition kernel satisfies Gaussian-type bounds (see [09_kl_convergence.md](09_kl_convergence), Section 2 \"The Hypoelliptic Kinetic Operator\"):\n1961: \n1962: $$\n1963: p_t(z, z') \\leq C t^{-d/\\alpha} \\exp\\left(-\\frac{d_{\\text{cc}}(z,z')^2}{Dt}\\right)\n1964: \n1965: $$\n1966: \n1967: where $d_{\\text{cc}}$ is the Carnot-Carathéodory distance and $\\alpha$ depends on the bracket depth.\n1968: \n1969: 4. **L^∞ Bounds for Full Operator**: The density $\\rho_t$ solving the McKean-Vlasov-Fokker-Planck equation with initial condition $\\|\\rho_0\\|_\\infty \\leq M_0$ satisfies:\n1970: \n1971: $$\n1972: \\|\\rho(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, t, \\gamma, \\sigma, U, R) < \\infty \\quad \\forall t \\in [0,T]\n1973: \n1974: $$\n1975: \n1976: **Proof Sketch**:\n1977: \n1978: The full operator decomposes as: kinetic evolution + cloning + killing + revival. We control the $L^\\infty$ norm of each component:\n1979: \n1980: **a) Kinetic Evolution Alone**:\n1981: \n1982: By hypoelliptic smoothing (Villani 2009, *Hypocoercivity*; Hérau & Nier 2004), the kinetic step $\\Psi_{\\text{kin}}$ maps $L^\\infty \\to L^\\infty$ with polynomial growth. Using Duhamel's principle and the Gaussian kernel bounds (point 3), for density $\\rho$ evolved by $\\mathcal{L}_{\\text{kin}}$ alone:\n1983: \n1984: $$\n1985: \\rho_t(z) = \\int p_t(z, z') \\rho_0(z') dz' \\leq \\|\\rho_0\\|_\\infty \\int p_t(z, z') dz' \\leq C_{\\text{kin}}(t) M_0\n1986: \n1987: $$\n1988: \n1989: where $C_{\\text{kin}}(t) = O(t^{-d/\\alpha})$ for small $t$ and $C_{\\text{kin}}(t) = O(1)$ for $t \\geq t_0 > 0$.\n1990: \n1991: **b) Cloning Step**:\n1992: \n1993: The Gaussian convolution in Section 5.4 preserves $L^\\infty$ bounds. For any density $\\rho_{\\text{pre}}$:\n1994: \n1995: $$\n1996: \\|\\rho_{\\text{post-clone}}\\|_\\infty = \\left\\|\\int \\rho_{\\text{pre}}(y) G_{\\sigma_x}(\\cdot - y) dy\\right\\|_\\infty \\leq \\|\\rho_{\\text{pre}}\\|_\\infty \\int G_{\\sigma_x}(z) dz = \\|\\rho_{\\text{pre}}\\|_\\infty\n1997: \n1998: $$\n1999: \n2000: where $G_{\\sigma_x}$ is the Gaussian kernel with variance $\\sigma_x^2$.\n2001: \n2002: **c) Killing Term**:\n2003: \n2004: The boundary killing $-c(z) f$ only removes mass:\n2005: \n2006: $$\n2007: \\|\\rho_{\\text{post-kill}}\\|_\\infty \\leq \\|\\rho_{\\text{pre-kill}}\\|_\\infty\n2008: \n2009: $$\n2010: \n2011: since $c(z) \\geq 0$ and mass removal cannot increase the supremum.\n2012: \n2013: **d) Revival Term**:\n2014: \n2015: The revival source $r_{\\text{revival}} f$ is localized to the safe region with bounded magnitude $\\|r_{\\text{revival}}\\|_\\infty \\leq C_{\\text{revival}}$ (determined by the revival rate and safe region geometry). Over a time step $\\tau$:\n2016: \n2017: $$\n2018: \\|\\rho_{\\text{post-revival}}\\|_\\infty \\leq \\|\\rho_{\\text{pre-revival}}\\|_\\infty + C_{\\text{revival}} \\tau\n2019: \n2020: $$\n2021: \n2022: **e) Combined Bound**:\n2023: \n2024: Iterating the composed operator $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ with killing and revival over $n = T/\\tau$ steps:\n2025: \n2026: $$\n2027: \\|\\rho_t\\|_\\infty \\leq C_{\\text{kin}}(t) M_0 + n \\cdot C_{\\text{revival}} \\tau = C_{\\text{kin}}(t) M_0 + C_{\\text{revival}} T\n2028: \n2029: $$\n2030: \n2031: Defining $C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma, U, R) := C_{\\text{kin}}(T) M_0 + C_{\\text{revival}} T$ yields the stated bound.\n2032: ",
      "metadata": {
        "label": "lem-hypoelliptic-density-bound"
      },
      "section": "## 5. Justification for the Bounded Density Ratio Assumption",
      "raw_directive": "1945: - $r_{\\text{revival}}$ is the revival source term\n1946: \n1947: :::{prf:lemma} Hypoelliptic Regularity Provides Density Bounds\n1948: :label: lem-hypoelliptic-density-bound\n1949: \n1950: **References**:\n1951: - [06_convergence.md](06_convergence), Section 4.4.1 \"Hypoellipticity and Gaussian Accessibility\"\n1952: - [09_kl_convergence.md](09_kl_convergence), Section 2 \"The Hypoelliptic Kinetic Operator\"\n1953: \n1954: The kinetic operator $\\mathcal{L}_{\\text{kin}}$ is **hypoelliptic** by Hörmander's theorem (Hörmander 1967, *Acta Math.* 119:147-171). The full McKean-Vlasov-Fokker-Planck generator including cloning, killing, and revival satisfies:\n1955: \n1956: 1. **Hörmander's Bracket Condition**: The drift vector field $v \\cdot \\nabla_x$ and diffusion operator $\\Delta_v$ satisfy the bracket condition, ensuring that iterating Lie brackets spans the full tangent space (see [06_convergence.md](06_convergence), Section 4.4.1).\n1957: \n1958: 2. **Smoothing Property**: Hypoelliptic operators have a smoothing property: if $\\rho_0 \\in L^1(\\Omega)$, then for $t > 0$, $\\rho(t, \\cdot) \\in C^\\infty(\\Omega)$ (smooth density).\n1959: \n1960: 3. **Gaussian Bounds**: The transition kernel satisfies Gaussian-type bounds (see [09_kl_convergence.md](09_kl_convergence), Section 2 \"The Hypoelliptic Kinetic Operator\"):\n1961: \n1962: $$\n1963: p_t(z, z') \\leq C t^{-d/\\alpha} \\exp\\left(-\\frac{d_{\\text{cc}}(z,z')^2}{Dt}\\right)\n1964: \n1965: $$\n1966: \n1967: where $d_{\\text{cc}}$ is the Carnot-Carathéodory distance and $\\alpha$ depends on the bracket depth.\n1968: \n1969: 4. **L^∞ Bounds for Full Operator**: The density $\\rho_t$ solving the McKean-Vlasov-Fokker-Planck equation with initial condition $\\|\\rho_0\\|_\\infty \\leq M_0$ satisfies:\n1970: \n1971: $$\n1972: \\|\\rho(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, t, \\gamma, \\sigma, U, R) < \\infty \\quad \\forall t \\in [0,T]\n1973: \n1974: $$\n1975: \n1976: **Proof Sketch**:\n1977: \n1978: The full operator decomposes as: kinetic evolution + cloning + killing + revival. We control the $L^\\infty$ norm of each component:\n1979: \n1980: **a) Kinetic Evolution Alone**:\n1981: \n1982: By hypoelliptic smoothing (Villani 2009, *Hypocoercivity*; Hérau & Nier 2004), the kinetic step $\\Psi_{\\text{kin}}$ maps $L^\\infty \\to L^\\infty$ with polynomial growth. Using Duhamel's principle and the Gaussian kernel bounds (point 3), for density $\\rho$ evolved by $\\mathcal{L}_{\\text{kin}}$ alone:\n1983: \n1984: $$\n1985: \\rho_t(z) = \\int p_t(z, z') \\rho_0(z') dz' \\leq \\|\\rho_0\\|_\\infty \\int p_t(z, z') dz' \\leq C_{\\text{kin}}(t) M_0\n1986: \n1987: $$\n1988: \n1989: where $C_{\\text{kin}}(t) = O(t^{-d/\\alpha})$ for small $t$ and $C_{\\text{kin}}(t) = O(1)$ for $t \\geq t_0 > 0$.\n1990: \n1991: **b) Cloning Step**:\n1992: \n1993: The Gaussian convolution in Section 5.4 preserves $L^\\infty$ bounds. For any density $\\rho_{\\text{pre}}$:\n1994: \n1995: $$\n1996: \\|\\rho_{\\text{post-clone}}\\|_\\infty = \\left\\|\\int \\rho_{\\text{pre}}(y) G_{\\sigma_x}(\\cdot - y) dy\\right\\|_\\infty \\leq \\|\\rho_{\\text{pre}}\\|_\\infty \\int G_{\\sigma_x}(z) dz = \\|\\rho_{\\text{pre}}\\|_\\infty\n1997: \n1998: $$\n1999: \n2000: where $G_{\\sigma_x}$ is the Gaussian kernel with variance $\\sigma_x^2$.\n2001: \n2002: **c) Killing Term**:\n2003: \n2004: The boundary killing $-c(z) f$ only removes mass:\n2005: \n2006: $$\n2007: \\|\\rho_{\\text{post-kill}}\\|_\\infty \\leq \\|\\rho_{\\text{pre-kill}}\\|_\\infty\n2008: \n2009: $$\n2010: \n2011: since $c(z) \\geq 0$ and mass removal cannot increase the supremum.\n2012: \n2013: **d) Revival Term**:\n2014: \n2015: The revival source $r_{\\text{revival}} f$ is localized to the safe region with bounded magnitude $\\|r_{\\text{revival}}\\|_\\infty \\leq C_{\\text{revival}}$ (determined by the revival rate and safe region geometry). Over a time step $\\tau$:\n2016: \n2017: $$\n2018: \\|\\rho_{\\text{post-revival}}\\|_\\infty \\leq \\|\\rho_{\\text{pre-revival}}\\|_\\infty + C_{\\text{revival}} \\tau\n2019: \n2020: $$\n2021: \n2022: **e) Combined Bound**:\n2023: \n2024: Iterating the composed operator $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ with killing and revival over $n = T/\\tau$ steps:\n2025: \n2026: $$\n2027: \\|\\rho_t\\|_\\infty \\leq C_{\\text{kin}}(t) M_0 + n \\cdot C_{\\text{revival}} \\tau = C_{\\text{kin}}(t) M_0 + C_{\\text{revival}} T\n2028: \n2029: $$\n2030: \n2031: Defining $C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma, U, R) := C_{\\text{kin}}(T) M_0 + C_{\\text{revival}} T$ yields the stated bound.\n2032: \n2033: **Reference**: For complete proofs of $L^\\infty$ bounds for hypoelliptic kinetic equations, see Hérau & Nier (2004, Theorem 1.1). The extension to include the non-local cloning and source terms follows from the argument above. $\\square$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_original",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Justification for the Bounded Density Ratio Assumption"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-gaussian-lower-bound",
      "title": "Gaussian Mollification Provides Uniform Lower Bound",
      "start_line": 2048,
      "end_line": 2081,
      "header_lines": [
        2049
      ],
      "content_start": 2051,
      "content_end": 2080,
      "content": "2051: :label: lem-gaussian-lower-bound\n2052: \n2053: **Reference**: Standard mollification theory (see [03_cloning.md](03_cloning), line 247 for mollifier construction)\n2054: \n2055: After applying the cloning operator with position jitter scale $\\sigma_x > 0$, the particle density convolves with the Gaussian kernel:\n2056: \n2057: $$\n2058: \\rho_{\\text{post-clone}}(x) = \\int_{B_R} \\rho_{\\text{pre-clone}}(y) \\frac{1}{(2\\pi \\sigma_x^2)^{d/2}} e^{-\\|x-y\\|^2/(2\\sigma_x^2)} dy\n2059: \n2060: $$\n2061: \n2062: This Gaussian mollification provides:\n2063: \n2064: 1. **Strict positivity**: $\\rho_{\\text{post-clone}}(x) > 0$ for all $x \\in B_R$ whenever $\\|\\rho_{\\text{pre-clone}}\\|_{L^1} > 0$\n2065: \n2066: 2. **Uniform lower bound**:\n2067: \n2068: $$\n2069: \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n2070: \n2071: $$\n2072: \n2073: where $c_{\\sigma_x, R} = (2\\pi \\sigma_x^2)^{-d/2} \\exp(-(2R)^2/(2\\sigma_x^2)) > 0$\n2074: \n2075: 3. **Density ratio bound**: For any $x_1, x_2 \\in B_R$:\n2076: \n2077: $$\n2078: \\frac{\\rho_{\\text{post-clone}}(x_1)}{\\rho_{\\text{post-clone}}(x_2)} \\leq \\exp\\left(\\frac{(2R)^2}{\\sigma_x^2}\\right) =: M_{\\text{Gaussian}}(\\sigma_x, R)\n2079: \n2080: $$",
      "metadata": {
        "label": "lem-gaussian-lower-bound"
      },
      "section": "## 5. Justification for the Bounded Density Ratio Assumption",
      "raw_directive": "2048: where $\\sigma_x > 0$ is the **position jitter scale** parameter.\n2049: \n2050: :::{prf:lemma} Gaussian Mollification Provides Uniform Lower Bound\n2051: :label: lem-gaussian-lower-bound\n2052: \n2053: **Reference**: Standard mollification theory (see [03_cloning.md](03_cloning), line 247 for mollifier construction)\n2054: \n2055: After applying the cloning operator with position jitter scale $\\sigma_x > 0$, the particle density convolves with the Gaussian kernel:\n2056: \n2057: $$\n2058: \\rho_{\\text{post-clone}}(x) = \\int_{B_R} \\rho_{\\text{pre-clone}}(y) \\frac{1}{(2\\pi \\sigma_x^2)^{d/2}} e^{-\\|x-y\\|^2/(2\\sigma_x^2)} dy\n2059: \n2060: $$\n2061: \n2062: This Gaussian mollification provides:\n2063: \n2064: 1. **Strict positivity**: $\\rho_{\\text{post-clone}}(x) > 0$ for all $x \\in B_R$ whenever $\\|\\rho_{\\text{pre-clone}}\\|_{L^1} > 0$\n2065: \n2066: 2. **Uniform lower bound**:\n2067: \n2068: $$\n2069: \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n2070: \n2071: $$\n2072: \n2073: where $c_{\\sigma_x, R} = (2\\pi \\sigma_x^2)^{-d/2} \\exp(-(2R)^2/(2\\sigma_x^2)) > 0$\n2074: \n2075: 3. **Density ratio bound**: For any $x_1, x_2 \\in B_R$:\n2076: \n2077: $$\n2078: \\frac{\\rho_{\\text{post-clone}}(x_1)}{\\rho_{\\text{post-clone}}(x_2)} \\leq \\exp\\left(\\frac{(2R)^2}{\\sigma_x^2}\\right) =: M_{\\text{Gaussian}}(\\sigma_x, R)\n2079: \n2080: $$\n2081: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_original",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Justification for the Bounded Density Ratio Assumption"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-qsd-lower-bound",
      "title": "QSD Density Has Uniform Lower Bound",
      "start_line": 2085,
      "end_line": 2149,
      "header_lines": [
        2086
      ],
      "content_start": 2088,
      "content_end": 2148,
      "content": "2088: :label: lem-qsd-lower-bound\n2089: \n2090: **References**:\n2091: - [06_convergence.md](06_convergence), Section 6.4.1 \"φ-Irreducibility\"\n2092: - [06_convergence.md](06_convergence), Theorem 4.5 \"Geometric Ergodicity and Convergence to QSD\"\n2093: \n2094: Under the Euclidean Gas dynamics with cloning position jitter $\\sigma_x > 0$, the quasi-stationary distribution $\\pi_{\\text{QSD}}$ satisfies:\n2095: \n2096: $$\n2097: \\pi_{\\text{QSD}}(x) \\geq c_\\pi > 0 \\quad \\forall x \\in B_R\n2098: \n2099: $$\n2100: \n2101: where $c_\\pi = c_{\\sigma_x, R} \\cdot m_{\\text{eq}}$, with $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ the equilibrium mass.\n2102: \n2103: **Proof**:\n2104: \n2105: **Step 1: φ-Irreducibility**\n2106: \n2107: By [06_convergence.md](06_convergence), Section 6.4.1 (Theorem {prf:ref}`thm-phi-irreducibility`), the Euclidean Gas is φ-irreducible: from any initial state, the system can reach any neighborhood of any point in the state space with positive probability. This is proven via a two-stage construction that uses the kinetic operator for local exploration and the cloning mechanism for global jumps.\n2108: \n2109: **Step 2: Gaussian Accessibility**\n2110: \n2111: The cloning mechanism with Gaussian jitter provides \"global teleportation\" ([06_convergence.md](06_convergence), line 891). Specifically: for any $x, y \\in B_R$, there is positive probability that:\n2112: 1. A walker at position $x$ becomes a companion (selected for cloning)\n2113: 2. Another walker clones from this companion\n2114: 3. The Gaussian noise $\\sigma_x \\zeta^x$ with $\\zeta^x \\sim \\mathcal{N}(0, I_d)$ places the cloner in any neighborhood of $y$\n2115: \n2116: This Gaussian accessibility ensures the state space is fully connected.\n2117: \n2118: **Step 3: Support of Invariant Measure**\n2119: \n2120: For an irreducible Markov process, any invariant probability measure $\\pi$ has support equal to the entire accessible state space (Meyn & Tweedie 2009, *Markov Chains and Stochastic Stability*, Theorem 4.2.2). Since $\\pi_{\\text{QSD}}$ is the unique invariant measure on the alive state space $B_R$ (by [06_convergence.md](06_convergence), Theorem 4.5), we have:\n2121: \n2122: $$\n2123: \\text{supp}(\\pi_{\\text{QSD}}) = B_R\n2124: \n2125: $$\n2126: \n2127: **Step 4: Smooth Density with Full Support Implies Positive Infimum**\n2128: \n2129: By Lemma {prf:ref}`lem-hypoelliptic-density-bound`, $\\pi_{\\text{QSD}}$ has a smooth density (hypoelliptic regularity gives $\\pi_{\\text{QSD}} \\in C^\\infty(B_R)$). A smooth function on a compact set $B_R$ that has full support must be strictly positive everywhere:\n2130: \n2131: $$\n2132: \\inf_{x \\in B_R} \\pi_{\\text{QSD}}(x) > 0\n2133: \n2134: $$\n2135: \n2136: If the infimum were zero, there would exist a sequence $x_n \\to x_* \\in B_R$ with $\\pi_{\\text{QSD}}(x_n) \\to 0$. But by continuity, $\\pi_{\\text{QSD}}(x_*) = 0$, contradicting full support.\n2137: \n2138: **Step 5: Explicit Lower Bound via Gaussian Mollification**\n2139: \n2140: The Gaussian mollification bound from Lemma {prf:ref}`lem-gaussian-lower-bound`, applied to the invariant measure, gives an explicit lower bound. Since the QSD is preserved by the cloning operator (it is an invariant measure), we have:\n2141: \n2142: $$\n2143: \\pi_{\\text{QSD}}(x) \\geq c_{\\sigma_x, R} \\|\\pi_{\\text{QSD}}\\|_{L^1} = c_{\\sigma_x, R} \\cdot m_{\\text{eq}}\n2144: \n2145: $$\n2146: \n2147: where $c_{\\sigma_x, R} = (2\\pi \\sigma_x^2)^{-d/2} \\exp(-(2R)^2/(2\\sigma_x^2)) > 0$.\n2148: ",
      "metadata": {
        "label": "lem-qsd-lower-bound"
      },
      "section": "## 5. Justification for the Bounded Density Ratio Assumption",
      "raw_directive": "2085: ### 5.4.1. QSD Inherits Gaussian Lower Bound\n2086: \n2087: :::{prf:lemma} QSD Density Has Uniform Lower Bound\n2088: :label: lem-qsd-lower-bound\n2089: \n2090: **References**:\n2091: - [06_convergence.md](06_convergence), Section 6.4.1 \"φ-Irreducibility\"\n2092: - [06_convergence.md](06_convergence), Theorem 4.5 \"Geometric Ergodicity and Convergence to QSD\"\n2093: \n2094: Under the Euclidean Gas dynamics with cloning position jitter $\\sigma_x > 0$, the quasi-stationary distribution $\\pi_{\\text{QSD}}$ satisfies:\n2095: \n2096: $$\n2097: \\pi_{\\text{QSD}}(x) \\geq c_\\pi > 0 \\quad \\forall x \\in B_R\n2098: \n2099: $$\n2100: \n2101: where $c_\\pi = c_{\\sigma_x, R} \\cdot m_{\\text{eq}}$, with $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ the equilibrium mass.\n2102: \n2103: **Proof**:\n2104: \n2105: **Step 1: φ-Irreducibility**\n2106: \n2107: By [06_convergence.md](06_convergence), Section 6.4.1 (Theorem {prf:ref}`thm-phi-irreducibility`), the Euclidean Gas is φ-irreducible: from any initial state, the system can reach any neighborhood of any point in the state space with positive probability. This is proven via a two-stage construction that uses the kinetic operator for local exploration and the cloning mechanism for global jumps.\n2108: \n2109: **Step 2: Gaussian Accessibility**\n2110: \n2111: The cloning mechanism with Gaussian jitter provides \"global teleportation\" ([06_convergence.md](06_convergence), line 891). Specifically: for any $x, y \\in B_R$, there is positive probability that:\n2112: 1. A walker at position $x$ becomes a companion (selected for cloning)\n2113: 2. Another walker clones from this companion\n2114: 3. The Gaussian noise $\\sigma_x \\zeta^x$ with $\\zeta^x \\sim \\mathcal{N}(0, I_d)$ places the cloner in any neighborhood of $y$\n2115: \n2116: This Gaussian accessibility ensures the state space is fully connected.\n2117: \n2118: **Step 3: Support of Invariant Measure**\n2119: \n2120: For an irreducible Markov process, any invariant probability measure $\\pi$ has support equal to the entire accessible state space (Meyn & Tweedie 2009, *Markov Chains and Stochastic Stability*, Theorem 4.2.2). Since $\\pi_{\\text{QSD}}$ is the unique invariant measure on the alive state space $B_R$ (by [06_convergence.md](06_convergence), Theorem 4.5), we have:\n2121: \n2122: $$\n2123: \\text{supp}(\\pi_{\\text{QSD}}) = B_R\n2124: \n2125: $$\n2126: \n2127: **Step 4: Smooth Density with Full Support Implies Positive Infimum**\n2128: \n2129: By Lemma {prf:ref}`lem-hypoelliptic-density-bound`, $\\pi_{\\text{QSD}}$ has a smooth density (hypoelliptic regularity gives $\\pi_{\\text{QSD}} \\in C^\\infty(B_R)$). A smooth function on a compact set $B_R$ that has full support must be strictly positive everywhere:\n2130: \n2131: $$\n2132: \\inf_{x \\in B_R} \\pi_{\\text{QSD}}(x) > 0\n2133: \n2134: $$\n2135: \n2136: If the infimum were zero, there would exist a sequence $x_n \\to x_* \\in B_R$ with $\\pi_{\\text{QSD}}(x_n) \\to 0$. But by continuity, $\\pi_{\\text{QSD}}(x_*) = 0$, contradicting full support.\n2137: \n2138: **Step 5: Explicit Lower Bound via Gaussian Mollification**\n2139: \n2140: The Gaussian mollification bound from Lemma {prf:ref}`lem-gaussian-lower-bound`, applied to the invariant measure, gives an explicit lower bound. Since the QSD is preserved by the cloning operator (it is an invariant measure), we have:\n2141: \n2142: $$\n2143: \\pi_{\\text{QSD}}(x) \\geq c_{\\sigma_x, R} \\|\\pi_{\\text{QSD}}\\|_{L^1} = c_{\\sigma_x, R} \\cdot m_{\\text{eq}}\n2144: \n2145: $$\n2146: \n2147: where $c_{\\sigma_x, R} = (2\\pi \\sigma_x^2)^{-d/2} \\exp(-(2R)^2/(2\\sigma_x^2)) > 0$.\n2148: \n2149: Thus, $c_\\pi = c_{\\sigma_x, R} \\cdot m_{\\text{eq}} > 0$. $\\square$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_original",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Justification for the Bounded Density Ratio Assumption"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-wasserstein-entropy",
      "title": "Wasserstein-Entropy Inequality",
      "start_line": 35,
      "end_line": 45,
      "header_lines": [
        36
      ],
      "content_start": 38,
      "content_end": 44,
      "content": "38: :label: lem-wasserstein-entropy\n39: \n40: Under the N-uniform LSI ({prf:ref}`thm-kl-convergence-euclidean` from [09_kl_convergence](09_kl_convergence)), the 2-Wasserstein distance between $\\nu_N^{QSD}$ (the N-particle quasi-stationary distribution) and $\\rho_0^{\\otimes N}$ (the product of mean-field invariant measures) satisfies:\n41: \n42: $$\n43: W_2^2(\\nu_N^{QSD}, \\rho_0^{\\otimes N}) \\leq \\frac{2}{\\lambda_{\\text{LSI}}} \\cdot D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N})\n44: $$",
      "metadata": {
        "label": "lem-wasserstein-entropy"
      },
      "section": "## Part I: Mean-Field Convergence via Relative Entropy",
      "raw_directive": "35: ### 1. Wasserstein-Entropy Inequality\n36: \n37: :::{prf:lemma} Wasserstein-Entropy Inequality\n38: :label: lem-wasserstein-entropy\n39: \n40: Under the N-uniform LSI ({prf:ref}`thm-kl-convergence-euclidean` from [09_kl_convergence](09_kl_convergence)), the 2-Wasserstein distance between $\\nu_N^{QSD}$ (the N-particle quasi-stationary distribution) and $\\rho_0^{\\otimes N}$ (the product of mean-field invariant measures) satisfies:\n41: \n42: $$\n43: W_2^2(\\nu_N^{QSD}, \\rho_0^{\\otimes N}) \\leq \\frac{2}{\\lambda_{\\text{LSI}}} \\cdot D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N})\n44: $$\n45: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 0,
        "chapter_file": "chapter_0.json",
        "section_id": "## Part I: Mean-Field Convergence via Relative Entropy"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-quantitative-kl-bound",
      "title": "Quantitative KL Bound",
      "start_line": 172,
      "end_line": 190,
      "header_lines": [
        173
      ],
      "content_start": 175,
      "content_end": 189,
      "content": "175: :label: lem-quantitative-kl-bound\n176: \n177: Let $\\mathcal{H}_N := D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N})$ be the relative entropy between the N-particle QSD and the product of mean-field measures. Under the cloning mechanism with rate $\\lambda$ and the N-uniform LSI, we have:\n178: \n179: $$\n180: \\mathcal{H}_N \\leq \\frac{C_{\\text{int}}}{N}\n181: $$\n182: \n183: where $C_{\\text{int}}$ is the **interaction complexity constant**, which quantifies the strength of particle interactions through the diversity companion probability.\n184: \n185: **Explicit form:**\n186: \n187: $$\n188: C_{\\text{int}} := \\sup_{Z \\in \\Omega^N} \\left\\{ \\sum_{i=1}^N \\left| \\mathbb{E}_{j \\sim P_{\\text{comp}}^i(Z)} [\\Phi_j - \\Phi_i] \\right| \\right\\}\n189: $$",
      "metadata": {
        "label": "lem-quantitative-kl-bound"
      },
      "section": "## Part I: Mean-Field Convergence via Relative Entropy",
      "raw_directive": "172: The next step is to bound the KL-divergence $D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N})$ with an explicit $O(1/N)$ rate.\n173: \n174: :::{prf:lemma} Quantitative KL Bound\n175: :label: lem-quantitative-kl-bound\n176: \n177: Let $\\mathcal{H}_N := D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N})$ be the relative entropy between the N-particle QSD and the product of mean-field measures. Under the cloning mechanism with rate $\\lambda$ and the N-uniform LSI, we have:\n178: \n179: $$\n180: \\mathcal{H}_N \\leq \\frac{C_{\\text{int}}}{N}\n181: $$\n182: \n183: where $C_{\\text{int}}$ is the **interaction complexity constant**, which quantifies the strength of particle interactions through the diversity companion probability.\n184: \n185: **Explicit form:**\n186: \n187: $$\n188: C_{\\text{int}} := \\sup_{Z \\in \\Omega^N} \\left\\{ \\sum_{i=1}^N \\left| \\mathbb{E}_{j \\sim P_{\\text{comp}}^i(Z)} [\\Phi_j - \\Phi_i] \\right| \\right\\}\n189: $$\n190: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 0,
        "chapter_file": "chapter_0.json",
        "section_id": "## Part I: Mean-Field Convergence via Relative Entropy"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-lipschitz-observable-error",
      "title": "Empirical Measure Observable Error",
      "start_line": 346,
      "end_line": 364,
      "header_lines": [
        347
      ],
      "content_start": 349,
      "content_end": 363,
      "content": "349: :label: lem-lipschitz-observable-error\n350: \n351: For any Lipschitz observable $\\phi: \\Omega \\to \\mathbb{R}$ with constant $L_\\phi$, the expected Wasserstein distance between the empirical measure and the target measure controls the observable error:\n352: \n353: $$\n354: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\int_\\Omega \\phi(z) \\rho_0(z) dz \\right| \\leq L_\\phi \\cdot \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right]\n355: $$\n356: \n357: where $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{z_i}$ is the empirical measure.\n358: \n359: Furthermore:\n360: \n361: $$\n362: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\sqrt{\\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right]} \\leq C_W \\cdot \\frac{1}{\\sqrt{N}}\n363: $$",
      "metadata": {
        "label": "lem-lipschitz-observable-error"
      },
      "section": "## Part I: Mean-Field Convergence via Relative Entropy",
      "raw_directive": "346: Now we convert the Wasserstein bound into an error bound for Lipschitz observables.\n347: \n348: :::{prf:lemma} Empirical Measure Observable Error\n349: :label: lem-lipschitz-observable-error\n350: \n351: For any Lipschitz observable $\\phi: \\Omega \\to \\mathbb{R}$ with constant $L_\\phi$, the expected Wasserstein distance between the empirical measure and the target measure controls the observable error:\n352: \n353: $$\n354: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\int_\\Omega \\phi(z) \\rho_0(z) dz \\right| \\leq L_\\phi \\cdot \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right]\n355: $$\n356: \n357: where $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{z_i}$ is the empirical measure.\n358: \n359: Furthermore:\n360: \n361: $$\n362: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\sqrt{\\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right]} \\leq C_W \\cdot \\frac{1}{\\sqrt{N}}\n363: $$\n364: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 0,
        "chapter_file": "chapter_0.json",
        "section_id": "## Part I: Mean-Field Convergence via Relative Entropy"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-baoab-weak-error",
      "title": "BAOAB Second-Order Weak Convergence",
      "start_line": 1089,
      "end_line": 1114,
      "header_lines": [
        1090
      ],
      "content_start": 1092,
      "content_end": 1113,
      "content": "1092: :label: lem-baoab-weak-error\n1093: \n1094: Let $Z(t)$ be the solution of the continuous-time Langevin SDE:\n1095: \n1096: $$\n1097: \\begin{cases}\n1098: dX_t = V_t dt \\\\\n1099: dV_t = -\\nabla U(X_t) dt - \\gamma V_t dt + \\sigma dW_t\n1100: \\end{cases}\n1101: $$\n1102: \n1103: and let $Z_k$ be the BAOAB approximation with step size $\\Delta t$ starting from $Z_0 = Z(0)$. For any test function $\\phi \\in C^4(\\Omega)$ with bounded derivatives up to order 4, we have:\n1104: \n1105: $$\n1106: |\\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]| \\leq C_{\\text{weak}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2 \\cdot k\\Delta t\n1107: $$\n1108: \n1109: where $C_{\\text{weak}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4$ but not on $\\Delta t$ or $k$.\n1110: \n1111: In particular, for fixed time $T = k\\Delta t$:\n1112: \n1113: $$",
      "metadata": {
        "label": "lem-baoab-weak-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1089: Now we establish the second-order weak convergence of BAOAB for finite time.\n1090: \n1091: :::{prf:lemma} BAOAB Second-Order Weak Convergence\n1092: :label: lem-baoab-weak-error\n1093: \n1094: Let $Z(t)$ be the solution of the continuous-time Langevin SDE:\n1095: \n1096: $$\n1097: \\begin{cases}\n1098: dX_t = V_t dt \\\\\n1099: dV_t = -\\nabla U(X_t) dt - \\gamma V_t dt + \\sigma dW_t\n1100: \\end{cases}\n1101: $$\n1102: \n1103: and let $Z_k$ be the BAOAB approximation with step size $\\Delta t$ starting from $Z_0 = Z(0)$. For any test function $\\phi \\in C^4(\\Omega)$ with bounded derivatives up to order 4, we have:\n1104: \n1105: $$\n1106: |\\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]| \\leq C_{\\text{weak}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2 \\cdot k\\Delta t\n1107: $$\n1108: \n1109: where $C_{\\text{weak}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4$ but not on $\\Delta t$ or $k$.\n1110: \n1111: In particular, for fixed time $T = k\\Delta t$:\n1112: \n1113: $$\n1114: |\\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(T))]| = O((\\Delta t)^2)",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## Part II: Time Discretization Error Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-baoab-invariant-measure-error",
      "title": "BAOAB Invariant Measure Error",
      "start_line": 1206,
      "end_line": 1218,
      "header_lines": [
        1207
      ],
      "content_start": 1209,
      "content_end": 1217,
      "content": "1209: :label: lem-baoab-invariant-measure-error\n1210: \n1211: Let $\\nu^{\\text{cont}}$ be the invariant measure of the continuous-time Langevin dynamics and let $\\nu^{\\Delta t}$ be the invariant measure of the BAOAB chain with step size $\\Delta t$. For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1212: \n1213: $$\n1214: \\left| \\mathbb{E}_{\\nu^{\\Delta t}} [\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}} [\\phi] \\right| \\leq C_{\\text{inv}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2\n1215: $$\n1216: \n1217: where $C_{\\text{inv}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4, \\kappa_{\\text{mix}}$ but not on $\\Delta t$.",
      "metadata": {
        "label": "lem-baoab-invariant-measure-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1206: Now we convert the finite-time weak error to an invariant measure error.\n1207: \n1208: :::{prf:lemma} BAOAB Invariant Measure Error\n1209: :label: lem-baoab-invariant-measure-error\n1210: \n1211: Let $\\nu^{\\text{cont}}$ be the invariant measure of the continuous-time Langevin dynamics and let $\\nu^{\\Delta t}$ be the invariant measure of the BAOAB chain with step size $\\Delta t$. For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1212: \n1213: $$\n1214: \\left| \\mathbb{E}_{\\nu^{\\Delta t}} [\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}} [\\phi] \\right| \\leq C_{\\text{inv}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2\n1215: $$\n1216: \n1217: where $C_{\\text{inv}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4, \\kappa_{\\text{mix}}$ but not on $\\Delta t$.\n1218: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## Part II: Time Discretization Error Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-lie-splitting-weak-error",
      "title": "One-Step Weak Error for Lie Splitting",
      "start_line": 1584,
      "end_line": 1596,
      "header_lines": [
        1585
      ],
      "content_start": 1587,
      "content_end": 1595,
      "content": "1587: :label: lem-lie-splitting-weak-error\n1588: \n1589: For the Lie splitting $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, the local weak error is:\n1590: \n1591: $$\n1592: \\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1593: $$\n1594: \n1595: where $C_{\\text{split}}$ depends on $\\gamma, \\sigma, \\lambda, \\delta, M_4$ but not on $\\Delta t$.",
      "metadata": {
        "label": "lem-lie-splitting-weak-error"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "1584: $$\n1585: \n1586: :::{prf:lemma} One-Step Weak Error for Lie Splitting\n1587: :label: lem-lie-splitting-weak-error\n1588: \n1589: For the Lie splitting $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, the local weak error is:\n1590: \n1591: $$\n1592: \\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1593: $$\n1594: \n1595: where $C_{\\text{split}}$ depends on $\\gamma, \\sigma, \\lambda, \\delta, M_4$ but not on $\\Delta t$.\n1596: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## Part III: Cloning Mechanism Error Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniform-geometric-ergodicity",
      "title": "Uniform Geometric Ergodicity",
      "start_line": 1826,
      "end_line": 1838,
      "header_lines": [
        1827
      ],
      "content_start": 1829,
      "content_end": 1837,
      "content": "1829: :label: lem-uniform-geometric-ergodicity\n1830: \n1831: Under the confinement axiom, there exist constants $\\kappa_{\\text{mix}} > 0$ and $C_{\\text{erg}} < \\infty$ such that for all $\\Delta t < \\Delta t_0$, the discrete-time Markov chain with transition kernel $\\mathcal{T}^{\\Delta t}$ satisfies:\n1832: \n1833: $$\n1834: \\left\\|\\mathcal{P}_k - \\nu_N^{\\text{discrete}}\\right\\|_{\\text{TV}} \\leq C_{\\text{erg}} e^{-\\kappa_{\\text{mix}} k \\Delta t}\n1835: $$\n1836: \n1837: where $\\mathcal{P}_k$ is the distribution after $k$ steps starting from an arbitrary initial condition with finite fourth moment.",
      "metadata": {
        "label": "lem-uniform-geometric-ergodicity"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "1826: To connect the local weak error to the error in invariant measures, we need uniform geometric ergodicity.\n1827: \n1828: :::{prf:lemma} Uniform Geometric Ergodicity\n1829: :label: lem-uniform-geometric-ergodicity\n1830: \n1831: Under the confinement axiom, there exist constants $\\kappa_{\\text{mix}} > 0$ and $C_{\\text{erg}} < \\infty$ such that for all $\\Delta t < \\Delta t_0$, the discrete-time Markov chain with transition kernel $\\mathcal{T}^{\\Delta t}$ satisfies:\n1832: \n1833: $$\n1834: \\left\\|\\mathcal{P}_k - \\nu_N^{\\text{discrete}}\\right\\|_{\\text{TV}} \\leq C_{\\text{erg}} e^{-\\kappa_{\\text{mix}} k \\Delta t}\n1835: $$\n1836: \n1837: where $\\mathcal{P}_k$ is the distribution after $k$ steps starting from an arbitrary initial condition with finite fourth moment.\n1838: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## Part III: Cloning Mechanism Error Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-derivative-locality-c3",
      "title": "Derivative Locality for Third Derivatives (Complete)",
      "start_line": 468,
      "end_line": 499,
      "header_lines": [
        469
      ],
      "content_start": 471,
      "content_end": 498,
      "content": "471: :label: lem-derivative-locality-c3\n472: \n473: For walkers $i, j \\in \\mathcal{A}$ with $i \\neq j$, the companion-dependent measurement $d_j = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{j\\}} \\mathbb{P}(c(j) = \\ell) \\cdot d_{\\text{alg}}(j, \\ell)$ satisfies:\n474: \n475: **First derivative**:\n476: $$\n477: \\nabla_{x_i} d_j = P_{ji} A_{ji} \\nabla_{x_i} d_{\\text{alg}}(j,i)\n478: $$\n479: \n480: where $P_{ji} = \\mathbb{P}(c(j)=i)$ and $A_{ji} = 1 - \\frac{d_{\\text{alg}}(j,i)(d_{\\text{alg}}(j,i) - d_j)}{\\varepsilon_c^2}$.\n481: \n482: **KEY INSIGHT**: In the sum over companions $\\ell \\in \\mathcal{A} \\setminus \\{j\\}$, only the term **$\\ell = i$** contributes to $\\nabla_{x_i} d_{\\text{alg}}(j, \\ell)$ because $d_{\\text{alg}}(j,\\ell)$ depends only on $(x_j, v_j, x_\\ell, v_\\ell)$, not on $(x_i, v_i)$ for $\\ell \\neq i$.\n483: \n484: **Derivative bounds** (using $d_{\\text{alg}}(j,i) = \\sqrt{\\|x_j - x_i\\|^2 + \\lambda_{\\text{alg}}\\|v_j - v_i\\|^2 + \\varepsilon_d^2}$):\n485: $$\n486: \\|\\nabla_{x_i} d_{\\text{alg}}(j,i)\\| \\leq 1, \\quad \\|\\nabla^2_{x_i} d_{\\text{alg}}(j,i)\\| \\leq \\frac{2}{\\varepsilon_d}, \\quad \\|\\nabla^3_{x_i} d_{\\text{alg}}(j,i)\\| \\leq \\frac{6}{\\varepsilon_d^2}\n487: $$\n488: \n489: **Bounds for companion-dependent measurement** (with $P_{ji} \\leq 1$ and $|A_{ji}| \\leq 1 + D_{\\max}^2/\\varepsilon_c^2$):\n490: $$\n491: \\|\\nabla_{x_i} d_j\\| \\leq C_{d,1} := 1 + \\frac{D_{\\max}^2}{\\varepsilon_c^2}\n492: $$\n493: $$\n494: \\|\\nabla^2_{x_i} d_j\\| \\leq C_{d,2} \\varepsilon_d^{-1} \\quad \\text{where} \\quad C_{d,2} = 2\\left(1 + \\frac{D_{\\max}^2}{\\varepsilon_c^2}\\right) + \\frac{3D_{\\max}^3}{\\varepsilon_c^4}\n495: $$\n496: $$\n497: \\|\\nabla^3_{x_i} d_j\\| \\leq C_{d,3} \\varepsilon_d^{-2} \\quad \\text{where} \\quad C_{d,3} = 6\\left(1 + \\frac{D_{\\max}^2}{\\varepsilon_c^2}\\right) + \\frac{15D_{\\max}^3}{\\varepsilon_c^4}\n498: $$",
      "metadata": {
        "label": "lem-derivative-locality-c3"
      },
      "section": "## 2. Mathematical Framework and Notation",
      "raw_directive": "468: #### 2.5.4. Derivative Locality Lemma (KEY for k-Uniformity)\n469: \n470: :::{prf:lemma} Derivative Locality for Third Derivatives (Complete)\n471: :label: lem-derivative-locality-c3\n472: \n473: For walkers $i, j \\in \\mathcal{A}$ with $i \\neq j$, the companion-dependent measurement $d_j = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{j\\}} \\mathbb{P}(c(j) = \\ell) \\cdot d_{\\text{alg}}(j, \\ell)$ satisfies:\n474: \n475: **First derivative**:\n476: $$\n477: \\nabla_{x_i} d_j = P_{ji} A_{ji} \\nabla_{x_i} d_{\\text{alg}}(j,i)\n478: $$\n479: \n480: where $P_{ji} = \\mathbb{P}(c(j)=i)$ and $A_{ji} = 1 - \\frac{d_{\\text{alg}}(j,i)(d_{\\text{alg}}(j,i) - d_j)}{\\varepsilon_c^2}$.\n481: \n482: **KEY INSIGHT**: In the sum over companions $\\ell \\in \\mathcal{A} \\setminus \\{j\\}$, only the term **$\\ell = i$** contributes to $\\nabla_{x_i} d_{\\text{alg}}(j, \\ell)$ because $d_{\\text{alg}}(j,\\ell)$ depends only on $(x_j, v_j, x_\\ell, v_\\ell)$, not on $(x_i, v_i)$ for $\\ell \\neq i$.\n483: \n484: **Derivative bounds** (using $d_{\\text{alg}}(j,i) = \\sqrt{\\|x_j - x_i\\|^2 + \\lambda_{\\text{alg}}\\|v_j - v_i\\|^2 + \\varepsilon_d^2}$):\n485: $$\n486: \\|\\nabla_{x_i} d_{\\text{alg}}(j,i)\\| \\leq 1, \\quad \\|\\nabla^2_{x_i} d_{\\text{alg}}(j,i)\\| \\leq \\frac{2}{\\varepsilon_d}, \\quad \\|\\nabla^3_{x_i} d_{\\text{alg}}(j,i)\\| \\leq \\frac{6}{\\varepsilon_d^2}\n487: $$\n488: \n489: **Bounds for companion-dependent measurement** (with $P_{ji} \\leq 1$ and $|A_{ji}| \\leq 1 + D_{\\max}^2/\\varepsilon_c^2$):\n490: $$\n491: \\|\\nabla_{x_i} d_j\\| \\leq C_{d,1} := 1 + \\frac{D_{\\max}^2}{\\varepsilon_c^2}\n492: $$\n493: $$\n494: \\|\\nabla^2_{x_i} d_j\\| \\leq C_{d,2} \\varepsilon_d^{-1} \\quad \\text{where} \\quad C_{d,2} = 2\\left(1 + \\frac{D_{\\max}^2}{\\varepsilon_c^2}\\right) + \\frac{3D_{\\max}^3}{\\varepsilon_c^4}\n495: $$\n496: $$\n497: \\|\\nabla^3_{x_i} d_j\\| \\leq C_{d,3} \\varepsilon_d^{-2} \\quad \\text{where} \\quad C_{d,3} = 6\\left(1 + \\frac{D_{\\max}^2}{\\varepsilon_c^2}\\right) + \\frac{15D_{\\max}^3}{\\varepsilon_c^4}\n498: $$\n499: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Mathematical Framework and Notation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-self-measurement-derivatives",
      "title": "Self-Measurement Derivative Bounds (j=i Case)",
      "start_line": 614,
      "end_line": 659,
      "header_lines": [
        615
      ],
      "content_start": 617,
      "content_end": 658,
      "content": "617: :label: lem-self-measurement-derivatives\n618: \n619: For the self-measurement where walker $i$ selects a companion from the alive set:\n620: \n621: $$\n622: d_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} P_{i\\ell} \\, d_{\\text{alg}}(i,\\ell), \\quad P_{i\\ell} = \\frac{\\exp(-d_{i\\ell}^2/(2\\varepsilon_c^2))}{Z_i}\n623: $$\n624: \n625: the third derivative with respect to walker $i$'s position is **k-uniform** despite the sum over $k_{\\text{eff}}^{(\\varepsilon_c)} = O((\\log k)^d)$ companions.\n626: \n627: **Key Mechanism**: The normalization $\\sum_{\\ell} P_{i\\ell} = 1$ ensures all derivatives are **probability-weighted expectations**, canceling the sum over companions.\n628: \n629: **First derivative** (covariance form):\n630: \n631: $$\n632: \\nabla_{x_i} d_i = \\mathbb{E}_{P_i}[\\nabla_{x_i} d_{i\\ell}] - \\text{Cov}_{P_i}(d_{i\\ell}, S_{i\\ell})\n633: $$\n634: \n635: where $S_{i\\ell} := \\frac{d_{i\\ell}}{\\varepsilon_c^2} \\nabla_{x_i} d_{i\\ell}$.\n636: \n637: **Third derivative** (expectation form):\n638: \n639: $$\n640: \\begin{aligned}\n641: \\nabla^3_{x_i} d_i &= \\sum_{\\ell} P_{i\\ell} \\nabla^3 d_{i\\ell}\n642: + 3\\,\\text{sym}\\sum_{\\ell} P_{i\\ell} (\\Delta_{i\\ell} \\otimes \\nabla^2 d_{i\\ell}) \\\\\n643: &\\quad + 3\\,\\text{sym}\\sum_{\\ell} P_{i\\ell} [(\\Delta_{i\\ell} \\otimes \\Delta_{i\\ell}) + \\Gamma_{i\\ell}] \\otimes \\nabla d_{i\\ell} \\\\\n644: &\\quad + \\sum_{\\ell} P_{i\\ell} [\\Delta_{i\\ell}^{\\otimes 3} + \\text{sym}(\\Delta_{i\\ell} \\otimes \\Gamma_{i\\ell}) + \\Xi_{i\\ell}] d_{i\\ell}\n645: \\end{aligned}\n646: $$\n647: \n648: where $\\Delta_{i\\ell} = \\bar{S}_i - S_{i\\ell}$ with $\\bar{S}_i = \\sum_r P_{ir} S_{ir}$ (expectation), and $\\Gamma_{i\\ell}, \\Xi_{i\\ell}$ are derivatives of $\\Delta_{i\\ell}$ (also expectations).\n649: \n650: **Bounds** (using $\\|\\nabla d_{i\\ell}\\| \\leq 1$, $\\|\\nabla^2 d_{i\\ell}\\| \\leq 2/\\varepsilon_d$, $\\|\\nabla^3 d_{i\\ell}\\| \\leq 6/\\varepsilon_d^2$, $d_{i\\ell} \\leq D_{\\max}$):\n651: \n652: $$\n653: \\|\\nabla_{x_i} d_i\\| \\leq C_{d,1} := 1 + \\frac{D_{\\max}^2}{\\varepsilon_c^2}\n654: $$\n655: \n656: $$\n657: \\|\\nabla^3_{x_i} d_i\\| \\leq C_{d,3} \\varepsilon_d^{-2} \\quad \\text{with} \\quad C_{d,3} = 6\\left(1 + \\frac{D_{\\max}^2}{\\varepsilon_c^2}\\right) + \\frac{15 D_{\\max}^3}{\\varepsilon_c^4}\n658: $$",
      "metadata": {
        "label": "lem-self-measurement-derivatives"
      },
      "section": "## 2. Mathematical Framework and Notation",
      "raw_directive": "614: ### 2.6. Two-Scale Framework for k-Uniformity\n615: \n616: :::{prf:lemma} Self-Measurement Derivative Bounds (j=i Case)\n617: :label: lem-self-measurement-derivatives\n618: \n619: For the self-measurement where walker $i$ selects a companion from the alive set:\n620: \n621: $$\n622: d_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} P_{i\\ell} \\, d_{\\text{alg}}(i,\\ell), \\quad P_{i\\ell} = \\frac{\\exp(-d_{i\\ell}^2/(2\\varepsilon_c^2))}{Z_i}\n623: $$\n624: \n625: the third derivative with respect to walker $i$'s position is **k-uniform** despite the sum over $k_{\\text{eff}}^{(\\varepsilon_c)} = O((\\log k)^d)$ companions.\n626: \n627: **Key Mechanism**: The normalization $\\sum_{\\ell} P_{i\\ell} = 1$ ensures all derivatives are **probability-weighted expectations**, canceling the sum over companions.\n628: \n629: **First derivative** (covariance form):\n630: \n631: $$\n632: \\nabla_{x_i} d_i = \\mathbb{E}_{P_i}[\\nabla_{x_i} d_{i\\ell}] - \\text{Cov}_{P_i}(d_{i\\ell}, S_{i\\ell})\n633: $$\n634: \n635: where $S_{i\\ell} := \\frac{d_{i\\ell}}{\\varepsilon_c^2} \\nabla_{x_i} d_{i\\ell}$.\n636: \n637: **Third derivative** (expectation form):\n638: \n639: $$\n640: \\begin{aligned}\n641: \\nabla^3_{x_i} d_i &= \\sum_{\\ell} P_{i\\ell} \\nabla^3 d_{i\\ell}\n642: + 3\\,\\text{sym}\\sum_{\\ell} P_{i\\ell} (\\Delta_{i\\ell} \\otimes \\nabla^2 d_{i\\ell}) \\\\\n643: &\\quad + 3\\,\\text{sym}\\sum_{\\ell} P_{i\\ell} [(\\Delta_{i\\ell} \\otimes \\Delta_{i\\ell}) + \\Gamma_{i\\ell}] \\otimes \\nabla d_{i\\ell} \\\\\n644: &\\quad + \\sum_{\\ell} P_{i\\ell} [\\Delta_{i\\ell}^{\\otimes 3} + \\text{sym}(\\Delta_{i\\ell} \\otimes \\Gamma_{i\\ell}) + \\Xi_{i\\ell}] d_{i\\ell}\n645: \\end{aligned}\n646: $$\n647: \n648: where $\\Delta_{i\\ell} = \\bar{S}_i - S_{i\\ell}$ with $\\bar{S}_i = \\sum_r P_{ir} S_{ir}$ (expectation), and $\\Gamma_{i\\ell}, \\Xi_{i\\ell}$ are derivatives of $\\Delta_{i\\ell}$ (also expectations).\n649: \n650: **Bounds** (using $\\|\\nabla d_{i\\ell}\\| \\leq 1$, $\\|\\nabla^2 d_{i\\ell}\\| \\leq 2/\\varepsilon_d$, $\\|\\nabla^3 d_{i\\ell}\\| \\leq 6/\\varepsilon_d^2$, $d_{i\\ell} \\leq D_{\\max}$):\n651: \n652: $$\n653: \\|\\nabla_{x_i} d_i\\| \\leq C_{d,1} := 1 + \\frac{D_{\\max}^2}{\\varepsilon_c^2}\n654: $$\n655: \n656: $$\n657: \\|\\nabla^3_{x_i} d_i\\| \\leq C_{d,3} \\varepsilon_d^{-2} \\quad \\text{with} \\quad C_{d,3} = 6\\left(1 + \\frac{D_{\\max}^2}{\\varepsilon_c^2}\\right) + \\frac{15 D_{\\max}^3}{\\varepsilon_c^4}\n658: $$\n659: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Mathematical Framework and Notation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-weight-third-derivative",
      "title": "Third Derivative of Localization Weights",
      "start_line": 1047,
      "end_line": 1061,
      "header_lines": [
        1048
      ],
      "content_start": 1050,
      "content_end": 1060,
      "content": "1050: :label: lem-weight-third-derivative\n1051: \n1052: The localization weights $w_{ij}(\\rho) = K_\\rho(x_i, x_j) / Z_i(\\rho)$ where $Z_i(\\rho) = \\sum_{\\ell \\in A_k} K_\\rho(x_i, x_\\ell)$ satisfy:\n1053: $$\n1054: \\|\\nabla^3_{x_i} w_{ij}(\\rho)\\| \\le C_{w,3}(\\rho)\n1055: $$\n1056: \n1057: where\n1058: $$\n1059: C_{w,3}(\\rho) := \\frac{C_{\\nabla^3 K}(\\rho)}{\\rho^3} + \\frac{12 C_{\\nabla K}(\\rho) C_{\\nabla^2 K}(\\rho)}{\\rho^3} + \\frac{16 C_{\\nabla K}(\\rho)^3}{\\rho^3}\n1060: $$",
      "metadata": {
        "label": "lem-weight-third-derivative"
      },
      "section": "## 4. Third Derivatives of Localization Weights",
      "raw_directive": "1047: where $d_{\\text{alg}}(i,j) = \\sqrt{\\|x_i - x_j\\|^2 + \\lambda_{\\text{alg}}\\|v_i - v_j\\|^2 + \\varepsilon_d^2}$ (from §2.5.1). The weights $w_{ij} = K_\\rho(i,j) / Z_i$ do NOT involve companion selection (they use direct pairwise distances), so the quotient analysis below applies with minor adaptations. The key difference: derivatives of $K_\\rho$ now involve derivatives of $d_{\\text{alg}}$, which are regularized by $\\varepsilon_d > 0$.\n1048: \n1049: :::{prf:lemma} Third Derivative of Localization Weights\n1050: :label: lem-weight-third-derivative\n1051: \n1052: The localization weights $w_{ij}(\\rho) = K_\\rho(x_i, x_j) / Z_i(\\rho)$ where $Z_i(\\rho) = \\sum_{\\ell \\in A_k} K_\\rho(x_i, x_\\ell)$ satisfy:\n1053: $$\n1054: \\|\\nabla^3_{x_i} w_{ij}(\\rho)\\| \\le C_{w,3}(\\rho)\n1055: $$\n1056: \n1057: where\n1058: $$\n1059: C_{w,3}(\\rho) := \\frac{C_{\\nabla^3 K}(\\rho)}{\\rho^3} + \\frac{12 C_{\\nabla K}(\\rho) C_{\\nabla^2 K}(\\rho)}{\\rho^3} + \\frac{16 C_{\\nabla K}(\\rho)^3}{\\rho^3}\n1060: $$\n1061: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 4. Third Derivatives of Localization Weights"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mean-third-derivative",
      "title": "k-Uniform Third Derivative of Localized Mean (Full Model)",
      "start_line": 1149,
      "end_line": 1166,
      "header_lines": [
        1150
      ],
      "content_start": 1152,
      "content_end": 1165,
      "content": "1152: :label: lem-mean-third-derivative\n1153: \n1154: The localized mean for the companion-dependent model $\\mu_\\rho^{(i)} := \\sum_{j \\in \\mathcal{A}} w_{ij}(\\rho) \\, d_j$ (where $d_j = \\mathbb{E}[d_{\\text{alg}}(j, c(j))]$) satisfies:\n1155: $$\n1156: \\|\\nabla^3_{x_i} \\mu_\\rho^{(i)}\\| \\leq K_{\\mu,3}(\\rho, \\varepsilon_d, \\varepsilon_c)\n1157: $$\n1158: \n1159: where $C_{d,m}$ denote constants from the bounds $\\|\\nabla^m d_j\\|$ (from Lemma {prf:ref}`lem-derivative-locality-c3`), and:\n1160: \n1161: $$\n1162: K_{\\mu,3}(\\rho, \\varepsilon_d, \\varepsilon_c) := C_{d,3} \\varepsilon_d^{-2} + \\frac{6 C_{d,2} \\varepsilon_d^{-1} C_{\\nabla K}(\\rho)}{\\rho} k_{\\text{eff}}^{(\\rho)} + \\frac{6 C_{d,1} C_{\\nabla^2 K}(\\rho)}{\\rho^2} k_{\\text{eff}}^{(\\rho)} + 2 D_{\\max} C_{w,3}(\\rho) k_{\\text{eff}}^{(\\rho)}\n1163: $$\n1164: \n1165: **Note on $k_{\\text{eff}}^{(\\rho)}$ dependence**: The last three terms (those involving weight derivatives) scale with $k_{\\text{eff}}^{(\\rho)} \\leq C_{\\text{vol}} \\rho_{\\max} \\rho^{2d}$. When $C_{w,3}(\\rho) = O(\\rho^{-3})$, the bound scales as $K_{\\mu,3} = O(\\varepsilon_d^{-2}) + O(\\rho^{2d-1}) + O(\\rho^{2d-2}) + O(\\rho^{2d-3})$, matching Document 20's $m=3$ formula.",
      "metadata": {
        "label": "lem-mean-third-derivative"
      },
      "section": "## 5. Third Derivatives of Localized Moments",
      "raw_directive": "1149: ### 5.1. Third Derivative of Localized Mean (Companion-Dependent Model)\n1150: \n1151: :::{prf:lemma} k-Uniform Third Derivative of Localized Mean (Full Model)\n1152: :label: lem-mean-third-derivative\n1153: \n1154: The localized mean for the companion-dependent model $\\mu_\\rho^{(i)} := \\sum_{j \\in \\mathcal{A}} w_{ij}(\\rho) \\, d_j$ (where $d_j = \\mathbb{E}[d_{\\text{alg}}(j, c(j))]$) satisfies:\n1155: $$\n1156: \\|\\nabla^3_{x_i} \\mu_\\rho^{(i)}\\| \\leq K_{\\mu,3}(\\rho, \\varepsilon_d, \\varepsilon_c)\n1157: $$\n1158: \n1159: where $C_{d,m}$ denote constants from the bounds $\\|\\nabla^m d_j\\|$ (from Lemma {prf:ref}`lem-derivative-locality-c3`), and:\n1160: \n1161: $$\n1162: K_{\\mu,3}(\\rho, \\varepsilon_d, \\varepsilon_c) := C_{d,3} \\varepsilon_d^{-2} + \\frac{6 C_{d,2} \\varepsilon_d^{-1} C_{\\nabla K}(\\rho)}{\\rho} k_{\\text{eff}}^{(\\rho)} + \\frac{6 C_{d,1} C_{\\nabla^2 K}(\\rho)}{\\rho^2} k_{\\text{eff}}^{(\\rho)} + 2 D_{\\max} C_{w,3}(\\rho) k_{\\text{eff}}^{(\\rho)}\n1163: $$\n1164: \n1165: **Note on $k_{\\text{eff}}^{(\\rho)}$ dependence**: The last three terms (those involving weight derivatives) scale with $k_{\\text{eff}}^{(\\rho)} \\leq C_{\\text{vol}} \\rho_{\\max} \\rho^{2d}$. When $C_{w,3}(\\rho) = O(\\rho^{-3})$, the bound scales as $K_{\\mu,3} = O(\\varepsilon_d^{-2}) + O(\\rho^{2d-1}) + O(\\rho^{2d-2}) + O(\\rho^{2d-3})$, matching Document 20's $m=3$ formula.\n1166: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 5. Third Derivatives of Localized Moments"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-third-derivative",
      "title": "k-Uniform Third Derivative of Localized Variance (Full Model)",
      "start_line": 1273,
      "end_line": 1284,
      "header_lines": [
        1274
      ],
      "content_start": 1276,
      "content_end": 1283,
      "content": "1276: :label: lem-variance-third-derivative\n1277: \n1278: The localized variance for the companion-dependent model $V_\\rho^{(i)} := \\sigma^2_\\rho[f_k, x_i] = \\sum_{j \\in \\mathcal{A}} w_{ij}(\\rho) d_j^2 - (\\mu_\\rho^{(i)})^2$ (where $d_j = \\mathbb{E}[d_{\\text{alg}}(j, c(j))]$) satisfies:\n1279: $$\n1280: \\|\\nabla^3_{x_i} V_\\rho^{(i)}\\| \\leq K_{V,3}(\\rho, \\varepsilon_d, \\varepsilon_c)\n1281: $$\n1282: \n1283: where $K_{V,3}(\\rho, \\varepsilon_d, \\varepsilon_c)$ is a k-uniform constant (explicit formula in proof).",
      "metadata": {
        "label": "lem-variance-third-derivative"
      },
      "section": "## 5. Third Derivatives of Localized Moments",
      "raw_directive": "1273: \n1274: \n1275: :::{prf:lemma} k-Uniform Third Derivative of Localized Variance (Full Model)\n1276: :label: lem-variance-third-derivative\n1277: \n1278: The localized variance for the companion-dependent model $V_\\rho^{(i)} := \\sigma^2_\\rho[f_k, x_i] = \\sum_{j \\in \\mathcal{A}} w_{ij}(\\rho) d_j^2 - (\\mu_\\rho^{(i)})^2$ (where $d_j = \\mathbb{E}[d_{\\text{alg}}(j, c(j))]$) satisfies:\n1279: $$\n1280: \\|\\nabla^3_{x_i} V_\\rho^{(i)}\\| \\leq K_{V,3}(\\rho, \\varepsilon_d, \\varepsilon_c)\n1281: $$\n1282: \n1283: where $K_{V,3}(\\rho, \\varepsilon_d, \\varepsilon_c)$ is a k-uniform constant (explicit formula in proof).\n1284: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 5. Third Derivatives of Localized Moments"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-patch-chain-rule",
      "title": "Chain Rule for Regularized Standard Deviation",
      "start_line": 1436,
      "end_line": 1457,
      "header_lines": [
        1437
      ],
      "content_start": 1439,
      "content_end": 1456,
      "content": "1439: :label: lem-patch-chain-rule\n1440: \n1441: Let $\\sigma\\'_{\\text{reg}}: \\mathbb{R}_{\\ge 0} \\to \\mathbb{R}_{>0}$ satisfy Assumption {prf:ref}`assump-c3-patch` ($C^3$ regularity). For a smooth function $V: \\mathbb{R}^d \\to \\mathbb{R}_{\\ge 0}$, the composition $h(x) := \\sigma\\'_{\\text{reg}}(V(x))$ has third derivative given by the **Faà di Bruno formula**:\n1442: $$\n1443: \\nabla^3 h = (\\sigma\\'_{\\text{reg}})'''(V) \\cdot (\\nabla V)^{\\otimes 3} + 3(\\sigma\\'_{\\text{reg}})''(V) \\cdot \\text{sym}(\\nabla V \\otimes \\nabla^2 V) + (\\sigma\\'_{\\text{reg}})'(V) \\cdot \\nabla^3 V\n1444: $$\n1445: \n1446: where $\\text{sym}(\\nabla V \\otimes \\nabla^2 V)$ denotes the symmetrized tensor product (sum over all permutations).\n1447: \n1448: More explicitly, using index notation for clarity:\n1449: $$\n1450: \\frac{\\partial^3 h}{\\partial x_i \\partial x_j \\partial x_k} = (\\sigma\\'_{\\text{reg}})'''(V) \\frac{\\partial V}{\\partial x_i} \\frac{\\partial V}{\\partial x_j} \\frac{\\partial V}{\\partial x_k} + (\\sigma\\'_{\\text{reg}})''(V) \\left[\\frac{\\partial V}{\\partial x_i} \\frac{\\partial^2 V}{\\partial x_j \\partial x_k} + \\text{perms}\\right] + (\\sigma\\'_{\\text{reg}})'(V) \\frac{\\partial^3 V}{\\partial x_i \\partial x_j \\partial x_k}\n1451: $$\n1452: \n1453: **Norm bound:**\n1454: $$\n1455: \\|\\nabla^3 h\\| \\le L_{\\sigma\\'\\'\\'_{\\text{reg}}} \\cdot \\|\\nabla V\\|^3 + 3 L_{\\sigma\\'\\'_{\\text{reg}}} \\cdot \\|\\nabla V\\| \\cdot \\|\\nabla^2 V\\| + L_{\\sigma\\'_{\\text{reg}}} \\cdot \\|\\nabla^3 V\\|\n1456: $$",
      "metadata": {
        "label": "lem-patch-chain-rule"
      },
      "section": "## 6. Third Derivatives of Regularized Standard Deviation",
      "raw_directive": "1436: The Z-score denominator involves the regularized standard deviation $\\sigma\\'_{\\text{reg}}(V_\\rho^{(i)})$, which is a composition requiring the chain rule.\n1437: \n1438: :::{prf:lemma} Chain Rule for Regularized Standard Deviation\n1439: :label: lem-patch-chain-rule\n1440: \n1441: Let $\\sigma\\'_{\\text{reg}}: \\mathbb{R}_{\\ge 0} \\to \\mathbb{R}_{>0}$ satisfy Assumption {prf:ref}`assump-c3-patch` ($C^3$ regularity). For a smooth function $V: \\mathbb{R}^d \\to \\mathbb{R}_{\\ge 0}$, the composition $h(x) := \\sigma\\'_{\\text{reg}}(V(x))$ has third derivative given by the **Faà di Bruno formula**:\n1442: $$\n1443: \\nabla^3 h = (\\sigma\\'_{\\text{reg}})'''(V) \\cdot (\\nabla V)^{\\otimes 3} + 3(\\sigma\\'_{\\text{reg}})''(V) \\cdot \\text{sym}(\\nabla V \\otimes \\nabla^2 V) + (\\sigma\\'_{\\text{reg}})'(V) \\cdot \\nabla^3 V\n1444: $$\n1445: \n1446: where $\\text{sym}(\\nabla V \\otimes \\nabla^2 V)$ denotes the symmetrized tensor product (sum over all permutations).\n1447: \n1448: More explicitly, using index notation for clarity:\n1449: $$\n1450: \\frac{\\partial^3 h}{\\partial x_i \\partial x_j \\partial x_k} = (\\sigma\\'_{\\text{reg}})'''(V) \\frac{\\partial V}{\\partial x_i} \\frac{\\partial V}{\\partial x_j} \\frac{\\partial V}{\\partial x_k} + (\\sigma\\'_{\\text{reg}})''(V) \\left[\\frac{\\partial V}{\\partial x_i} \\frac{\\partial^2 V}{\\partial x_j \\partial x_k} + \\text{perms}\\right] + (\\sigma\\'_{\\text{reg}})'(V) \\frac{\\partial^3 V}{\\partial x_i \\partial x_j \\partial x_k}\n1451: $$\n1452: \n1453: **Norm bound:**\n1454: $$\n1455: \\|\\nabla^3 h\\| \\le L_{\\sigma\\'\\'\\'_{\\text{reg}}} \\cdot \\|\\nabla V\\|^3 + 3 L_{\\sigma\\'\\'_{\\text{reg}}} \\cdot \\|\\nabla V\\| \\cdot \\|\\nabla^2 V\\| + L_{\\sigma\\'_{\\text{reg}}} \\cdot \\|\\nabla^3 V\\|\n1456: $$\n1457: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 6. Third Derivatives of Regularized Standard Deviation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-patch-third-derivative",
      "title": "Third Derivative Bound for Regularized Standard Deviation",
      "start_line": 1493,
      "end_line": 1504,
      "header_lines": [
        1494
      ],
      "content_start": 1496,
      "content_end": 1503,
      "content": "1496: :label: lem-patch-third-derivative\n1497: \n1498: The regularized standard deviation $\\sigma'_{\\rho}^{(i)} := \\sigma\\'_{\\text{reg}}(V_\\rho^{(i)})$ satisfies:\n1499: $$\n1500: \\|\\nabla^3_{x_i} \\sigma'_{\\rho}^{(i)}\\| \\le L_{\\sigma\\'\\'\\'_{\\text{reg}}} \\cdot (C_{V,\\nabla}(\\rho))^3 + 3 L_{\\sigma\\'\\'_{\\text{reg}}} \\cdot C_{V,\\nabla}(\\rho) \\cdot C_{V,\\nabla^2}(\\rho) + L_{\\sigma\\'_{\\text{reg}}} \\cdot C_{V,\\nabla^3}(\\rho)\n1501: $$\n1502: \n1503: where $C_{V,\\nabla}(\\rho)$, $C_{V,\\nabla^2}(\\rho)$, $C_{V,\\nabla^3}(\\rho)$ are the bounds from Lemmas {prf:ref}`lem-variance-gradient`, {prf:ref}`lem-variance-hessian`, and {prf:ref}`lem-variance-third-derivative` (the latter two from Appendix A of [11_geometric_gas.md](11_geometric_gas.md) and Lemma {prf:ref}`lem-variance-third-derivative` above).",
      "metadata": {
        "label": "lem-patch-third-derivative"
      },
      "section": "## 6. Third Derivatives of Regularized Standard Deviation",
      "raw_directive": "1493: :::\n1494: \n1495: :::{prf:lemma} Third Derivative Bound for Regularized Standard Deviation\n1496: :label: lem-patch-third-derivative\n1497: \n1498: The regularized standard deviation $\\sigma'_{\\rho}^{(i)} := \\sigma\\'_{\\text{reg}}(V_\\rho^{(i)})$ satisfies:\n1499: $$\n1500: \\|\\nabla^3_{x_i} \\sigma'_{\\rho}^{(i)}\\| \\le L_{\\sigma\\'\\'\\'_{\\text{reg}}} \\cdot (C_{V,\\nabla}(\\rho))^3 + 3 L_{\\sigma\\'\\'_{\\text{reg}}} \\cdot C_{V,\\nabla}(\\rho) \\cdot C_{V,\\nabla^2}(\\rho) + L_{\\sigma\\'_{\\text{reg}}} \\cdot C_{V,\\nabla^3}(\\rho)\n1501: $$\n1502: \n1503: where $C_{V,\\nabla}(\\rho)$, $C_{V,\\nabla^2}(\\rho)$, $C_{V,\\nabla^3}(\\rho)$ are the bounds from Lemmas {prf:ref}`lem-variance-gradient`, {prf:ref}`lem-variance-hessian`, and {prf:ref}`lem-variance-third-derivative` (the latter two from Appendix A of [11_geometric_gas.md](11_geometric_gas.md) and Lemma {prf:ref}`lem-variance-third-derivative` above).\n1504: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 6. Third Derivatives of Regularized Standard Deviation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-zscore-third-derivative",
      "title": "k-Uniform Third Derivative of Z-Score",
      "start_line": 1524,
      "end_line": 1549,
      "header_lines": [
        1525
      ],
      "content_start": 1527,
      "content_end": 1548,
      "content": "1527: :label: lem-zscore-third-derivative\n1528: \n1529: The Z-score $Z_\\rho^{(i)} := Z_\\rho[f_k, d, x_i]$ satisfies:\n1530: $$\n1531: \\|\\nabla^3_{x_i} Z_\\rho^{(i)}\\| \\le K_{Z,3}(\\rho)\n1532: $$\n1533: \n1534: where $K_{Z,3}(\\rho)$ is a k-uniform constant:\n1535: $$\n1536: \\begin{aligned}\n1537: K_{Z,3}(\\rho) := &\\, \\frac{1}{\\sigma\\'_{\\min}} \\Big[C_{u,\\nabla^3}(\\rho) + 3 C_{u,\\nabla}(\\rho) C_{v,\\nabla^2}(\\rho) \\\\\n1538: &\\quad + 3 C_{u,\\nabla^2}(\\rho) C_{v,\\nabla}(\\rho) + 6 C_{u,\\nabla}(\\rho) (C_{v,\\nabla}(\\rho))^2 \\\\\n1539: &\\quad + (d_{\\max} + C_{\\mu,\\nabla}(\\rho)) C_{v,\\nabla^3}(\\rho) \\Big]\n1540: \\end{aligned}\n1541: $$\n1542: \n1543: where:\n1544: - $u(x_i) := d_i (companion-dependent measurement) - \\mu_\\rho^{(i)}$ (numerator)\n1545: - $v(x_i) := \\sigma'_{\\rho}^{(i)}$ (denominator)\n1546: - $C_{u,\\nabla^m}(\\rho)$ are bounds on $\\nabla^m u$ (from measurement and mean)\n1547: - $C_{v,\\nabla^m}(\\rho)$ are bounds on $\\nabla^m v$ (from Lemma {prf:ref}`lem-patch-third-derivative`)\n1548: - **Numerator bounds**: For $d_i$, use Lemma {prf:ref}`lem-derivative-locality-c3`: $\\|\\nabla^3 d_i\\| \\leq C_{d,3} \\varepsilon_d^{-2}$ (companion-dependent, k-uniform)",
      "metadata": {
        "label": "lem-zscore-third-derivative"
      },
      "section": "## 7. Third Derivative of the Z-Score",
      "raw_directive": "1524: The Z-score $Z_\\rho[f_k, d, x_i] = (d_i - \\mu_\\rho^{(i)}) / \\sigma'_{\\rho}^{(i)}$ is a quotient of smooth functions. We now compute its third derivative.\n1525: \n1526: :::{prf:lemma} k-Uniform Third Derivative of Z-Score\n1527: :label: lem-zscore-third-derivative\n1528: \n1529: The Z-score $Z_\\rho^{(i)} := Z_\\rho[f_k, d, x_i]$ satisfies:\n1530: $$\n1531: \\|\\nabla^3_{x_i} Z_\\rho^{(i)}\\| \\le K_{Z,3}(\\rho)\n1532: $$\n1533: \n1534: where $K_{Z,3}(\\rho)$ is a k-uniform constant:\n1535: $$\n1536: \\begin{aligned}\n1537: K_{Z,3}(\\rho) := &\\, \\frac{1}{\\sigma\\'_{\\min}} \\Big[C_{u,\\nabla^3}(\\rho) + 3 C_{u,\\nabla}(\\rho) C_{v,\\nabla^2}(\\rho) \\\\\n1538: &\\quad + 3 C_{u,\\nabla^2}(\\rho) C_{v,\\nabla}(\\rho) + 6 C_{u,\\nabla}(\\rho) (C_{v,\\nabla}(\\rho))^2 \\\\\n1539: &\\quad + (d_{\\max} + C_{\\mu,\\nabla}(\\rho)) C_{v,\\nabla^3}(\\rho) \\Big]\n1540: \\end{aligned}\n1541: $$\n1542: \n1543: where:\n1544: - $u(x_i) := d_i (companion-dependent measurement) - \\mu_\\rho^{(i)}$ (numerator)\n1545: - $v(x_i) := \\sigma'_{\\rho}^{(i)}$ (denominator)\n1546: - $C_{u,\\nabla^m}(\\rho)$ are bounds on $\\nabla^m u$ (from measurement and mean)\n1547: - $C_{v,\\nabla^m}(\\rho)$ are bounds on $\\nabla^m v$ (from Lemma {prf:ref}`lem-patch-third-derivative`)\n1548: - **Numerator bounds**: For $d_i$, use Lemma {prf:ref}`lem-derivative-locality-c3`: $\\|\\nabla^3 d_i\\| \\leq C_{d,3} \\varepsilon_d^{-2}$ (companion-dependent, k-uniform)\n1549: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 7. Third Derivative of the Z-Score"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-telescoping-derivatives",
      "title": "Telescoping Identity for Derivatives",
      "start_line": 197,
      "end_line": 207,
      "header_lines": [
        198
      ],
      "content_start": 200,
      "content_end": 206,
      "content": "200: :label: lem-telescoping-derivatives\n201: \n202: For any derivative order $m \\in \\{1, 2, 3\\}$, the localization weights satisfy:\n203: \n204: $$\n205: \\sum_{j \\in A_k} \\nabla^m_{x_i} w_{ij}(\\rho) = 0\n206: $$",
      "metadata": {
        "label": "lem-telescoping-derivatives"
      },
      "section": "## 2. Mathematical Framework and Notation",
      "raw_directive": "197: A bound is **k-uniform** if it is independent of the alive walker count $k = |A_k|$. The key technical tool for proving k-uniformity is the **telescoping property** of normalized weights:\n198: \n199: :::{prf:lemma} Telescoping Identity for Derivatives\n200: :label: lem-telescoping-derivatives\n201: \n202: For any derivative order $m \\in \\{1, 2, 3\\}$, the localization weights satisfy:\n203: \n204: $$\n205: \\sum_{j \\in A_k} \\nabla^m_{x_i} w_{ij}(\\rho) = 0\n206: $$\n207: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Mathematical Framework and Notation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-weight-third-derivative",
      "title": "Third Derivative of Localization Weights",
      "start_line": 327,
      "end_line": 343,
      "header_lines": [
        328
      ],
      "content_start": 330,
      "content_end": 342,
      "content": "330: :label: lem-weight-third-derivative\n331: \n332: The localization weights $w_{ij}(\\rho) = K_\\rho(x_i, x_j) / Z_i(\\rho)$ where $Z_i(\\rho) = \\sum_{\\ell \\in A_k} K_\\rho(x_i, x_\\ell)$ satisfy:\n333: \n334: $$\n335: \\|\\nabla^3_{x_i} w_{ij}(\\rho)\\| \\le C_{w,3}(\\rho)\n336: $$\n337: \n338: where\n339: \n340: $$\n341: C_{w,3}(\\rho) := \\frac{C_{\\nabla^3 K}(\\rho)}{\\rho^3} + \\frac{12 C_{\\nabla K}(\\rho) C_{\\nabla^2 K}(\\rho)}{\\rho^3} + \\frac{16 C_{\\nabla K}(\\rho)^3}{\\rho^3}\n342: $$",
      "metadata": {
        "label": "lem-weight-third-derivative"
      },
      "section": "## 4. Third Derivatives of Localization Weights",
      "raw_directive": "327: The localization weights $w_{ij}(\\rho)$ are the fundamental building blocks of the �-localized pipeline. We now establish bounds on their third derivatives.\n328: \n329: :::{prf:lemma} Third Derivative of Localization Weights\n330: :label: lem-weight-third-derivative\n331: \n332: The localization weights $w_{ij}(\\rho) = K_\\rho(x_i, x_j) / Z_i(\\rho)$ where $Z_i(\\rho) = \\sum_{\\ell \\in A_k} K_\\rho(x_i, x_\\ell)$ satisfy:\n333: \n334: $$\n335: \\|\\nabla^3_{x_i} w_{ij}(\\rho)\\| \\le C_{w,3}(\\rho)\n336: $$\n337: \n338: where\n339: \n340: $$\n341: C_{w,3}(\\rho) := \\frac{C_{\\nabla^3 K}(\\rho)}{\\rho^3} + \\frac{12 C_{\\nabla K}(\\rho) C_{\\nabla^2 K}(\\rho)}{\\rho^3} + \\frac{16 C_{\\nabla K}(\\rho)^3}{\\rho^3}\n342: $$\n343: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Third Derivatives of Localization Weights"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mean-third-derivative",
      "title": "k-Uniform Third Derivative of Localized Mean",
      "start_line": 442,
      "end_line": 452,
      "header_lines": [
        443
      ],
      "content_start": 445,
      "content_end": 451,
      "content": "445: :label: lem-mean-third-derivative\n446: \n447: The localized mean $\\mu_\\rho^{(i)} := \\mu_\\rho[f_k, d, x_i] = \\sum_{j \\in A_k} w_{ij}(\\rho) \\, d(x_j)$ satisfies:\n448: \n449: $$\n450: \\|\\nabla^3_{x_i} \\mu_\\rho^{(i)}\\| \\le d'''_{\\max} + \\frac{6 d'_{\\max} C_{\\nabla^2 K}(\\rho)}{\\rho^2} + \\frac{6 d''_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2 d_{\\max} C_{w,3}(\\rho)\n451: $$",
      "metadata": {
        "label": "lem-mean-third-derivative"
      },
      "section": "## 5. Third Derivatives of Localized Moments",
      "raw_directive": "442: ### 5.1. Third Derivative of Localized Mean\n443: \n444: :::{prf:lemma} k-Uniform Third Derivative of Localized Mean\n445: :label: lem-mean-third-derivative\n446: \n447: The localized mean $\\mu_\\rho^{(i)} := \\mu_\\rho[f_k, d, x_i] = \\sum_{j \\in A_k} w_{ij}(\\rho) \\, d(x_j)$ satisfies:\n448: \n449: $$\n450: \\|\\nabla^3_{x_i} \\mu_\\rho^{(i)}\\| \\le d'''_{\\max} + \\frac{6 d'_{\\max} C_{\\nabla^2 K}(\\rho)}{\\rho^2} + \\frac{6 d''_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2 d_{\\max} C_{w,3}(\\rho)\n451: $$\n452: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Third Derivatives of Localized Moments"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-third-derivative",
      "title": "k-Uniform Third Derivative of Localized Variance",
      "start_line": 551,
      "end_line": 576,
      "header_lines": [
        552
      ],
      "content_start": 554,
      "content_end": 575,
      "content": "554: :label: lem-variance-third-derivative\n555: \n556: The localized variance $V_\\rho^{(i)} := \\sigma^2_\\rho[f_k, d, x_i]$ satisfies:\n557: \n558: $$\n559: \\|\\nabla^3_{x_i} V_\\rho^{(i)}\\| \\le C_{V,\\nabla^3}(\\rho)\n560: $$\n561: \n562: where $C_{V,\\nabla^3}(\\rho)$ is a k-uniform constant depending on:\n563: - Measurement function bounds $(d_{\\max}, d'_{\\max}, d''_{\\max}, d'''_{\\max})$\n564: - Kernel derivative bounds $(C_{\\nabla K}(\\rho)/\\rho, C_{\\nabla^2 K}(\\rho)/\\rho^2, C_{w,3}(\\rho))$\n565: - First and second derivatives of $\\mu_\\rho^{(i)}$ (from previous lemmas)\n566: \n567: Explicitly:\n568: \n569: $$\n570: \\begin{aligned}\n571: C_{V,\\nabla^3}(\\rho) := &\\, 6 d_{\\max} d'''_{\\max} + 12 d'_{\\max} d''_{\\max} + 8 d_{\\max}^2 C_{w,3}(\\rho) \\\\\n572: &+ 12 d_{\\max} d'_{\\max} \\frac{C_{\\nabla^2 K}(\\rho)}{\\rho^2} + 24 d_{\\max}^2 \\frac{C_{\\nabla K}(\\rho) C_{\\nabla^2 K}(\\rho)}{\\rho^3} \\\\\n573: &+ 6 d_{\\max} \\cdot C_{\\mu,\\nabla^3}(\\rho)\n574: \\end{aligned}\n575: $$",
      "metadata": {
        "label": "lem-variance-third-derivative"
      },
      "section": "## 5. Third Derivatives of Localized Moments",
      "raw_directive": "551: ### 5.2. Third Derivative of Localized Variance\n552: \n553: :::{prf:lemma} k-Uniform Third Derivative of Localized Variance\n554: :label: lem-variance-third-derivative\n555: \n556: The localized variance $V_\\rho^{(i)} := \\sigma^2_\\rho[f_k, d, x_i]$ satisfies:\n557: \n558: $$\n559: \\|\\nabla^3_{x_i} V_\\rho^{(i)}\\| \\le C_{V,\\nabla^3}(\\rho)\n560: $$\n561: \n562: where $C_{V,\\nabla^3}(\\rho)$ is a k-uniform constant depending on:\n563: - Measurement function bounds $(d_{\\max}, d'_{\\max}, d''_{\\max}, d'''_{\\max})$\n564: - Kernel derivative bounds $(C_{\\nabla K}(\\rho)/\\rho, C_{\\nabla^2 K}(\\rho)/\\rho^2, C_{w,3}(\\rho))$\n565: - First and second derivatives of $\\mu_\\rho^{(i)}$ (from previous lemmas)\n566: \n567: Explicitly:\n568: \n569: $$\n570: \\begin{aligned}\n571: C_{V,\\nabla^3}(\\rho) := &\\, 6 d_{\\max} d'''_{\\max} + 12 d'_{\\max} d''_{\\max} + 8 d_{\\max}^2 C_{w,3}(\\rho) \\\\\n572: &+ 12 d_{\\max} d'_{\\max} \\frac{C_{\\nabla^2 K}(\\rho)}{\\rho^2} + 24 d_{\\max}^2 \\frac{C_{\\nabla K}(\\rho) C_{\\nabla^2 K}(\\rho)}{\\rho^3} \\\\\n573: &+ 6 d_{\\max} \\cdot C_{\\mu,\\nabla^3}(\\rho)\n574: \\end{aligned}\n575: $$\n576: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Third Derivatives of Localized Moments"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-patch-chain-rule",
      "title": "Chain Rule for Regularized Standard Deviation",
      "start_line": 668,
      "end_line": 692,
      "header_lines": [
        669
      ],
      "content_start": 671,
      "content_end": 691,
      "content": "671: :label: lem-patch-chain-rule\n672: \n673: Let $\\sigma\\'_{\\text{reg}}: \\mathbb{R}_{\\ge 0} \\to \\mathbb{R}_{>0}$ satisfy Assumption {prf:ref}`assump-c3-patch` ($C^3$ regularity). For a smooth function $V: \\mathbb{R}^d \\to \\mathbb{R}_{\\ge 0}$, the composition $h(x) := \\sigma\\'_{\\text{reg}}(V(x))$ has third derivative given by the **Faà di Bruno formula**:\n674: \n675: $$\n676: \\nabla^3 h = (\\sigma\\'_{\\text{reg}})'''(V) \\cdot (\\nabla V)^{\\otimes 3} + 3(\\sigma\\'_{\\text{reg}})''(V) \\cdot \\text{sym}(\\nabla V \\otimes \\nabla^2 V) + (\\sigma\\'_{\\text{reg}})'(V) \\cdot \\nabla^3 V\n677: $$\n678: \n679: where $\\text{sym}(\\nabla V \\otimes \\nabla^2 V)$ denotes the symmetrized tensor product (sum over all permutations).\n680: \n681: More explicitly, using index notation for clarity:\n682: \n683: $$\n684: \\frac{\\partial^3 h}{\\partial x_i \\partial x_j \\partial x_k} = (\\sigma\\'_{\\text{reg}})'''(V) \\frac{\\partial V}{\\partial x_i} \\frac{\\partial V}{\\partial x_j} \\frac{\\partial V}{\\partial x_k} + (\\sigma\\'_{\\text{reg}})''(V) \\left[\\frac{\\partial V}{\\partial x_i} \\frac{\\partial^2 V}{\\partial x_j \\partial x_k} + \\text{perms}\\right] + (\\sigma\\'_{\\text{reg}})'(V) \\frac{\\partial^3 V}{\\partial x_i \\partial x_j \\partial x_k}\n685: $$\n686: \n687: **Norm bound:**\n688: \n689: $$\n690: \\|\\nabla^3 h\\| \\le L_{\\sigma\\'\\'\\'_{\\text{reg}}} \\cdot \\|\\nabla V\\|^3 + 3 L_{\\sigma\\'\\'_{\\text{reg}}} \\cdot \\|\\nabla V\\| \\cdot \\|\\nabla^2 V\\| + L_{\\sigma\\'_{\\text{reg}}} \\cdot \\|\\nabla^3 V\\|\n691: $$",
      "metadata": {
        "label": "lem-patch-chain-rule"
      },
      "section": "## 6. Third Derivatives of Regularized Standard Deviation",
      "raw_directive": "668: The Z-score denominator involves the regularized standard deviation $\\sigma\\'_{\\text{reg}}(V_\\rho^{(i)})$, which is a composition requiring the chain rule.\n669: \n670: :::{prf:lemma} Chain Rule for Regularized Standard Deviation\n671: :label: lem-patch-chain-rule\n672: \n673: Let $\\sigma\\'_{\\text{reg}}: \\mathbb{R}_{\\ge 0} \\to \\mathbb{R}_{>0}$ satisfy Assumption {prf:ref}`assump-c3-patch` ($C^3$ regularity). For a smooth function $V: \\mathbb{R}^d \\to \\mathbb{R}_{\\ge 0}$, the composition $h(x) := \\sigma\\'_{\\text{reg}}(V(x))$ has third derivative given by the **Faà di Bruno formula**:\n674: \n675: $$\n676: \\nabla^3 h = (\\sigma\\'_{\\text{reg}})'''(V) \\cdot (\\nabla V)^{\\otimes 3} + 3(\\sigma\\'_{\\text{reg}})''(V) \\cdot \\text{sym}(\\nabla V \\otimes \\nabla^2 V) + (\\sigma\\'_{\\text{reg}})'(V) \\cdot \\nabla^3 V\n677: $$\n678: \n679: where $\\text{sym}(\\nabla V \\otimes \\nabla^2 V)$ denotes the symmetrized tensor product (sum over all permutations).\n680: \n681: More explicitly, using index notation for clarity:\n682: \n683: $$\n684: \\frac{\\partial^3 h}{\\partial x_i \\partial x_j \\partial x_k} = (\\sigma\\'_{\\text{reg}})'''(V) \\frac{\\partial V}{\\partial x_i} \\frac{\\partial V}{\\partial x_j} \\frac{\\partial V}{\\partial x_k} + (\\sigma\\'_{\\text{reg}})''(V) \\left[\\frac{\\partial V}{\\partial x_i} \\frac{\\partial^2 V}{\\partial x_j \\partial x_k} + \\text{perms}\\right] + (\\sigma\\'_{\\text{reg}})'(V) \\frac{\\partial^3 V}{\\partial x_i \\partial x_j \\partial x_k}\n685: $$\n686: \n687: **Norm bound:**\n688: \n689: $$\n690: \\|\\nabla^3 h\\| \\le L_{\\sigma\\'\\'\\'_{\\text{reg}}} \\cdot \\|\\nabla V\\|^3 + 3 L_{\\sigma\\'\\'_{\\text{reg}}} \\cdot \\|\\nabla V\\| \\cdot \\|\\nabla^2 V\\| + L_{\\sigma\\'_{\\text{reg}}} \\cdot \\|\\nabla^3 V\\|\n691: $$\n692: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. Third Derivatives of Regularized Standard Deviation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-patch-third-derivative",
      "title": "Third Derivative Bound for Regularized Standard Deviation",
      "start_line": 730,
      "end_line": 742,
      "header_lines": [
        731
      ],
      "content_start": 733,
      "content_end": 741,
      "content": "733: :label: lem-patch-third-derivative\n734: \n735: The regularized standard deviation $\\sigma'_{\\rho}^{(i)} := \\sigma\\'_{\\text{reg}}(V_\\rho^{(i)})$ satisfies:\n736: \n737: $$\n738: \\|\\nabla^3_{x_i} \\sigma'_{\\rho}^{(i)}\\| \\le L_{\\sigma\\'\\'\\'_{\\text{reg}}} \\cdot (C_{V,\\nabla}(\\rho))^3 + 3 L_{\\sigma\\'\\'_{\\text{reg}}} \\cdot C_{V,\\nabla}(\\rho) \\cdot C_{V,\\nabla^2}(\\rho) + L_{\\sigma\\'_{\\text{reg}}} \\cdot C_{V,\\nabla^3}(\\rho)\n739: $$\n740: \n741: where $C_{V,\\nabla}(\\rho)$, $C_{V,\\nabla^2}(\\rho)$, $C_{V,\\nabla^3}(\\rho)$ are the bounds from Lemmas {prf:ref}`lem-variance-gradient`, {prf:ref}`lem-variance-hessian`, and {prf:ref}`lem-variance-third-derivative` (the latter two from Appendix A of [11_geometric_gas.md](11_geometric_gas.md) and Lemma {prf:ref}`lem-variance-third-derivative` above).",
      "metadata": {
        "label": "lem-patch-third-derivative"
      },
      "section": "## 6. Third Derivatives of Regularized Standard Deviation",
      "raw_directive": "730: :::\n731: \n732: :::{prf:lemma} Third Derivative Bound for Regularized Standard Deviation\n733: :label: lem-patch-third-derivative\n734: \n735: The regularized standard deviation $\\sigma'_{\\rho}^{(i)} := \\sigma\\'_{\\text{reg}}(V_\\rho^{(i)})$ satisfies:\n736: \n737: $$\n738: \\|\\nabla^3_{x_i} \\sigma'_{\\rho}^{(i)}\\| \\le L_{\\sigma\\'\\'\\'_{\\text{reg}}} \\cdot (C_{V,\\nabla}(\\rho))^3 + 3 L_{\\sigma\\'\\'_{\\text{reg}}} \\cdot C_{V,\\nabla}(\\rho) \\cdot C_{V,\\nabla^2}(\\rho) + L_{\\sigma\\'_{\\text{reg}}} \\cdot C_{V,\\nabla^3}(\\rho)\n739: $$\n740: \n741: where $C_{V,\\nabla}(\\rho)$, $C_{V,\\nabla^2}(\\rho)$, $C_{V,\\nabla^3}(\\rho)$ are the bounds from Lemmas {prf:ref}`lem-variance-gradient`, {prf:ref}`lem-variance-hessian`, and {prf:ref}`lem-variance-third-derivative` (the latter two from Appendix A of [11_geometric_gas.md](11_geometric_gas.md) and Lemma {prf:ref}`lem-variance-third-derivative` above).\n742: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. Third Derivatives of Regularized Standard Deviation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-zscore-third-derivative",
      "title": "k-Uniform Third Derivative of Z-Score",
      "start_line": 760,
      "end_line": 786,
      "header_lines": [
        761
      ],
      "content_start": 763,
      "content_end": 785,
      "content": "763: :label: lem-zscore-third-derivative\n764: \n765: The Z-score $Z_\\rho^{(i)} := Z_\\rho[f_k, d, x_i]$ satisfies:\n766: \n767: $$\n768: \\|\\nabla^3_{x_i} Z_\\rho^{(i)}\\| \\le K_{Z,3}(\\rho)\n769: $$\n770: \n771: where $K_{Z,3}(\\rho)$ is a k-uniform constant:\n772: \n773: $$\n774: \\begin{aligned}\n775: K_{Z,3}(\\rho) := &\\, \\frac{1}{\\sigma\\'_{\\min}} \\Big[C_{u,\\nabla^3}(\\rho) + 3 C_{u,\\nabla}(\\rho) C_{v,\\nabla^2}(\\rho) \\\\\n776: &\\quad + 3 C_{u,\\nabla^2}(\\rho) C_{v,\\nabla}(\\rho) + 6 C_{u,\\nabla}(\\rho) (C_{v,\\nabla}(\\rho))^2 \\\\\n777: &\\quad + (d_{\\max} + C_{\\mu,\\nabla}(\\rho)) C_{v,\\nabla^3}(\\rho) \\Big]\n778: \\end{aligned}\n779: $$\n780: \n781: where:\n782: - $u(x_i) := d(x_i) - \\mu_\\rho^{(i)}$ (numerator)\n783: - $v(x_i) := \\sigma'_{\\rho}^{(i)}$ (denominator)\n784: - $C_{u,\\nabla^m}(\\rho)$ are bounds on $\\nabla^m u$ (from measurement and mean)\n785: - $C_{v,\\nabla^m}(\\rho)$ are bounds on $\\nabla^m v$ (from Lemma {prf:ref}`lem-patch-third-derivative`)",
      "metadata": {
        "label": "lem-zscore-third-derivative"
      },
      "section": "## 7. Third Derivative of the Z-Score",
      "raw_directive": "760: The Z-score $Z_\\rho[f_k, d, x_i] = (d(x_i) - \\mu_\\rho^{(i)}) / \\sigma'_{\\rho}^{(i)}$ is a quotient of smooth functions. We now compute its third derivative.\n761: \n762: :::{prf:lemma} k-Uniform Third Derivative of Z-Score\n763: :label: lem-zscore-third-derivative\n764: \n765: The Z-score $Z_\\rho^{(i)} := Z_\\rho[f_k, d, x_i]$ satisfies:\n766: \n767: $$\n768: \\|\\nabla^3_{x_i} Z_\\rho^{(i)}\\| \\le K_{Z,3}(\\rho)\n769: $$\n770: \n771: where $K_{Z,3}(\\rho)$ is a k-uniform constant:\n772: \n773: $$\n774: \\begin{aligned}\n775: K_{Z,3}(\\rho) := &\\, \\frac{1}{\\sigma\\'_{\\min}} \\Big[C_{u,\\nabla^3}(\\rho) + 3 C_{u,\\nabla}(\\rho) C_{v,\\nabla^2}(\\rho) \\\\\n776: &\\quad + 3 C_{u,\\nabla^2}(\\rho) C_{v,\\nabla}(\\rho) + 6 C_{u,\\nabla}(\\rho) (C_{v,\\nabla}(\\rho))^2 \\\\\n777: &\\quad + (d_{\\max} + C_{\\mu,\\nabla}(\\rho)) C_{v,\\nabla^3}(\\rho) \\Big]\n778: \\end{aligned}\n779: $$\n780: \n781: where:\n782: - $u(x_i) := d(x_i) - \\mu_\\rho^{(i)}$ (numerator)\n783: - $v(x_i) := \\sigma'_{\\rho}^{(i)}$ (denominator)\n784: - $C_{u,\\nabla^m}(\\rho)$ are bounds on $\\nabla^m u$ (from measurement and mean)\n785: - $C_{v,\\nabla^m}(\\rho)$ are bounds on $\\nabla^m v$ (from Lemma {prf:ref}`lem-patch-third-derivative`)\n786: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "13_geometric_gas_c3_regularity",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. Third Derivative of the Z-Score"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-weight-fourth-derivative",
      "title": "Fourth Derivative of Localization Weights",
      "start_line": 395,
      "end_line": 413,
      "header_lines": [
        396
      ],
      "content_start": 398,
      "content_end": 412,
      "content": "398: :label: lem-weight-fourth-derivative\n399: \n400: $$\n401: \\|\\nabla^4_{x_i} w_{ij}(\\rho)\\| \\le C_{w,4}(\\rho) = O(\\rho^{-4})\n402: \n403: $$\n404: \n405: where the constant $C_{w,4}(\\rho)$ is derived from the quotient rule applied to:\n406: \n407: $$\n408: w_{ij}(\\rho) = \\frac{K_\\rho(x_i, x_j)}{\\sum_{j' \\in A_k} K_\\rho(x_i, x_{j'})}\n409: \n410: $$\n411: \n412: The fourth derivative involves sums of products of kernel derivatives up to order 4, with dominant term $C_{\\nabla^4 K}(\\rho) = 24/\\rho^4$ from the Gaussian kernel.",
      "metadata": {
        "label": "lem-weight-fourth-derivative"
      },
      "section": "## 4. Fourth Derivatives of Localization Weights",
      "raw_directive": "395: ## 4. Fourth Derivatives of Localization Weights\n396: \n397: :::{prf:lemma} Fourth Derivative of Localization Weights\n398: :label: lem-weight-fourth-derivative\n399: \n400: $$\n401: \\|\\nabla^4_{x_i} w_{ij}(\\rho)\\| \\le C_{w,4}(\\rho) = O(\\rho^{-4})\n402: \n403: $$\n404: \n405: where the constant $C_{w,4}(\\rho)$ is derived from the quotient rule applied to:\n406: \n407: $$\n408: w_{ij}(\\rho) = \\frac{K_\\rho(x_i, x_j)}{\\sum_{j' \\in A_k} K_\\rho(x_i, x_{j'})}\n409: \n410: $$\n411: \n412: The fourth derivative involves sums of products of kernel derivatives up to order 4, with dominant term $C_{\\nabla^4 K}(\\rho) = 24/\\rho^4$ from the Gaussian kernel.\n413: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_c4_regularity",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Fourth Derivatives of Localization Weights"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-weight-telescoping-fourth",
      "title": "Telescoping Property for Fourth Derivative",
      "start_line": 427,
      "end_line": 436,
      "header_lines": [
        428
      ],
      "content_start": 430,
      "content_end": 435,
      "content": "430: :label: lem-weight-telescoping-fourth\n431: \n432: $$\n433: \\sum_{j \\in A_k} \\nabla^4_{x_i} w_{ij}(\\rho) = 0\n434: \n435: $$",
      "metadata": {
        "label": "lem-weight-telescoping-fourth"
      },
      "section": "## 4. Fourth Derivatives of Localization Weights",
      "raw_directive": "427: :::\n428: \n429: :::{prf:lemma} Telescoping Property for Fourth Derivative\n430: :label: lem-weight-telescoping-fourth\n431: \n432: $$\n433: \\sum_{j \\in A_k} \\nabla^4_{x_i} w_{ij}(\\rho) = 0\n434: \n435: $$\n436: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_c4_regularity",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Fourth Derivatives of Localization Weights"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mean-fourth-derivative",
      "title": "Fourth Derivative of Localized Mean",
      "start_line": 455,
      "end_line": 466,
      "header_lines": [
        456
      ],
      "content_start": 458,
      "content_end": 465,
      "content": "458: :label: lem-mean-fourth-derivative\n459: \n460: The localized mean $\\mu_\\rho[f_k, d, x_i] = \\sum_{j \\in A_k} w_{ij}(\\rho) d(x_j)$ satisfies:\n461: \n462: $$\n463: \\|\\nabla^4_{x_i} \\mu_\\rho\\| \\le C_{\\mu,\\nabla^4}(\\rho) = d^{(4)}_{\\max} + \\frac{12 d'_{\\max} C_{\\nabla^3 K}(\\rho)}{\\rho^3} + \\frac{24 d''_{\\max} C_{\\nabla^2 K}(\\rho)}{\\rho^2} + \\frac{24 d'''_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2 d_{\\max} C_{w,4}(\\rho)\n464: \n465: $$",
      "metadata": {
        "label": "lem-mean-fourth-derivative"
      },
      "section": "## 5. Fourth Derivatives of Localized Moments",
      "raw_directive": "455: ## 5. Fourth Derivatives of Localized Moments\n456: \n457: :::{prf:lemma} Fourth Derivative of Localized Mean\n458: :label: lem-mean-fourth-derivative\n459: \n460: The localized mean $\\mu_\\rho[f_k, d, x_i] = \\sum_{j \\in A_k} w_{ij}(\\rho) d(x_j)$ satisfies:\n461: \n462: $$\n463: \\|\\nabla^4_{x_i} \\mu_\\rho\\| \\le C_{\\mu,\\nabla^4}(\\rho) = d^{(4)}_{\\max} + \\frac{12 d'_{\\max} C_{\\nabla^3 K}(\\rho)}{\\rho^3} + \\frac{24 d''_{\\max} C_{\\nabla^2 K}(\\rho)}{\\rho^2} + \\frac{24 d'''_{\\max} C_{\\nabla K}(\\rho)}{\\rho} + 2 d_{\\max} C_{w,4}(\\rho)\n464: \n465: $$\n466: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_c4_regularity",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Fourth Derivatives of Localized Moments"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-fourth-derivative",
      "title": "Fourth Derivative of Localized Variance",
      "start_line": 552,
      "end_line": 563,
      "header_lines": [
        553
      ],
      "content_start": 555,
      "content_end": 562,
      "content": "555: :label: lem-variance-fourth-derivative\n556: \n557: The localized variance $\\sigma^2_\\rho[f_k, d, x_i] = \\sum_{j \\in A_k} w_{ij}(\\rho) [d(x_j) - \\mu_\\rho[f_k, d, x_i]]^2$ satisfies:\n558: \n559: $$\n560: \\|\\nabla^4_{x_i} \\sigma^2_\\rho\\| \\le C_{V,\\nabla^4}(\\rho) = O(\\rho^{-3})\n561: \n562: $$",
      "metadata": {
        "label": "lem-variance-fourth-derivative"
      },
      "section": "## 5. Fourth Derivatives of Localized Moments",
      "raw_directive": "552: :::\n553: \n554: :::{prf:lemma} Fourth Derivative of Localized Variance\n555: :label: lem-variance-fourth-derivative\n556: \n557: The localized variance $\\sigma^2_\\rho[f_k, d, x_i] = \\sum_{j \\in A_k} w_{ij}(\\rho) [d(x_j) - \\mu_\\rho[f_k, d, x_i]]^2$ satisfies:\n558: \n559: $$\n560: \\|\\nabla^4_{x_i} \\sigma^2_\\rho\\| \\le C_{V,\\nabla^4}(\\rho) = O(\\rho^{-3})\n561: \n562: $$\n563: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_c4_regularity",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Fourth Derivatives of Localized Moments"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-reg-fourth-chain",
      "title": "Chain Rule for $\\sigma'_{\\text{reg}}$",
      "start_line": 687,
      "end_line": 715,
      "header_lines": [
        688
      ],
      "content_start": 690,
      "content_end": 714,
      "content": "690: :label: lem-reg-fourth-chain\n691: \n692: For $h(x) = \\sigma'_{\\text{reg}}(V(x))$ where $V(x) = \\sigma^2_\\rho[f_k, d, x]$, the fourth derivative is:\n693: \n694: $$\n695: \\begin{align}\n696: \\nabla^4 h = \\,&(\\sigma'_{\\text{reg}})^{(4)}(V) \\cdot (\\nabla V)^{\\otimes 4} + 6 (\\sigma'_{\\text{reg}})^{(3)}(V) \\cdot (\\nabla V)^{\\otimes 2} \\otimes \\nabla^2 V \\\\\n697: &+ 3 (\\sigma'_{\\text{reg}})^{(2)}(V) \\cdot (\\nabla^2 V)^{\\otimes 2} + 4 (\\sigma'_{\\text{reg}})^{(2)}(V) \\cdot \\nabla V \\otimes \\nabla^3 V \\\\\n698: &+ (\\sigma'_{\\text{reg}})^{(1)}(V) \\cdot \\nabla^4 V\n699: \\end{align}\n700: \n701: $$\n702: \n703: **Norm bound:**\n704: \n705: $$\n706: \\|\\nabla^4 h\\| \\le \\frac{15}{16\\sigma'^7_{\\min}} \\|\\nabla V\\|^4 + \\frac{6 \\cdot 3}{8\\sigma'^5_{\\min}} \\|\\nabla V\\|^2 \\|\\nabla^2 V\\| + \\frac{3}{4\\sigma'^3_{\\min}} \\|\\nabla^2 V\\|^2 + \\frac{4}{4\\sigma'^3_{\\min}} \\|\\nabla V\\| \\|\\nabla^3 V\\| + \\frac{1}{2\\sigma'_{\\min}} \\|\\nabla^4 V\\|\n707: \n708: $$\n709: \n710: Simplifying:\n711: \n712: $$\n713: \\|\\nabla^4 h\\| \\le \\frac{15}{16\\sigma'^7_{\\min}} \\|\\nabla V\\|^4 + \\frac{9}{4\\sigma'^5_{\\min}} \\|\\nabla V\\|^2 \\|\\nabla^2 V\\| + \\frac{3}{4\\sigma'^3_{\\min}} \\|\\nabla^2 V\\|^2 + \\frac{1}{\\sigma'^3_{\\min}} \\|\\nabla V\\| \\|\\nabla^3 V\\| + \\frac{1}{2\\sigma'_{\\min}} \\|\\nabla^4 V\\|\n714: ",
      "metadata": {
        "label": "lem-reg-fourth-chain"
      },
      "section": "## 6. Fourth Derivative Chain Rule for Regularized Standard Deviation",
      "raw_directive": "687: ## 6. Fourth Derivative Chain Rule for Regularized Standard Deviation\n688: \n689: :::{prf:lemma} Chain Rule for $\\sigma'_{\\text{reg}}$\n690: :label: lem-reg-fourth-chain\n691: \n692: For $h(x) = \\sigma'_{\\text{reg}}(V(x))$ where $V(x) = \\sigma^2_\\rho[f_k, d, x]$, the fourth derivative is:\n693: \n694: $$\n695: \\begin{align}\n696: \\nabla^4 h = \\,&(\\sigma'_{\\text{reg}})^{(4)}(V) \\cdot (\\nabla V)^{\\otimes 4} + 6 (\\sigma'_{\\text{reg}})^{(3)}(V) \\cdot (\\nabla V)^{\\otimes 2} \\otimes \\nabla^2 V \\\\\n697: &+ 3 (\\sigma'_{\\text{reg}})^{(2)}(V) \\cdot (\\nabla^2 V)^{\\otimes 2} + 4 (\\sigma'_{\\text{reg}})^{(2)}(V) \\cdot \\nabla V \\otimes \\nabla^3 V \\\\\n698: &+ (\\sigma'_{\\text{reg}})^{(1)}(V) \\cdot \\nabla^4 V\n699: \\end{align}\n700: \n701: $$\n702: \n703: **Norm bound:**\n704: \n705: $$\n706: \\|\\nabla^4 h\\| \\le \\frac{15}{16\\sigma'^7_{\\min}} \\|\\nabla V\\|^4 + \\frac{6 \\cdot 3}{8\\sigma'^5_{\\min}} \\|\\nabla V\\|^2 \\|\\nabla^2 V\\| + \\frac{3}{4\\sigma'^3_{\\min}} \\|\\nabla^2 V\\|^2 + \\frac{4}{4\\sigma'^3_{\\min}} \\|\\nabla V\\| \\|\\nabla^3 V\\| + \\frac{1}{2\\sigma'_{\\min}} \\|\\nabla^4 V\\|\n707: \n708: $$\n709: \n710: Simplifying:\n711: \n712: $$\n713: \\|\\nabla^4 h\\| \\le \\frac{15}{16\\sigma'^7_{\\min}} \\|\\nabla V\\|^4 + \\frac{9}{4\\sigma'^5_{\\min}} \\|\\nabla V\\|^2 \\|\\nabla^2 V\\| + \\frac{3}{4\\sigma'^3_{\\min}} \\|\\nabla^2 V\\|^2 + \\frac{1}{\\sigma'^3_{\\min}} \\|\\nabla V\\| \\|\\nabla^3 V\\| + \\frac{1}{2\\sigma'_{\\min}} \\|\\nabla^4 V\\|\n714: \n715: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_c4_regularity",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. Fourth Derivative Chain Rule for Regularized Standard Deviation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-zscore-fourth-derivative",
      "title": "Fourth Derivative of Z-Score",
      "start_line": 733,
      "end_line": 744,
      "header_lines": [
        734
      ],
      "content_start": 736,
      "content_end": 743,
      "content": "736: :label: lem-zscore-fourth-derivative\n737: \n738: The Z-score $Z_\\rho[f_k, d, x_i] = \\frac{d(x_i) - \\mu_\\rho[f_k, d, x_i]}{\\sigma'_{\\text{reg}}(\\sigma^2_\\rho[f_k, d, x_i])}$ satisfies:\n739: \n740: $$\n741: \\|\\nabla^4_{x_i} Z_\\rho\\| \\le K_{Z,4}(\\rho) = O(\\rho^{-3})\n742: \n743: $$",
      "metadata": {
        "label": "lem-zscore-fourth-derivative"
      },
      "section": "## 7. Fourth Derivative of the Z-Score",
      "raw_directive": "733: ## 7. Fourth Derivative of the Z-Score\n734: \n735: :::{prf:lemma} Fourth Derivative of Z-Score\n736: :label: lem-zscore-fourth-derivative\n737: \n738: The Z-score $Z_\\rho[f_k, d, x_i] = \\frac{d(x_i) - \\mu_\\rho[f_k, d, x_i]}{\\sigma'_{\\text{reg}}(\\sigma^2_\\rho[f_k, d, x_i])}$ satisfies:\n739: \n740: $$\n741: \\|\\nabla^4_{x_i} Z_\\rho\\| \\le K_{Z,4}(\\rho) = O(\\rho^{-3})\n742: \n743: $$\n744: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_c4_regularity",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. Fourth Derivative of the Z-Score"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-velocity-squashing-compact-domain-full",
      "title": "Velocity Squashing Ensures Compact Phase Space",
      "start_line": 578,
      "end_line": 598,
      "header_lines": [
        579
      ],
      "content_start": 581,
      "content_end": 597,
      "content": "581: :label: lem-velocity-squashing-compact-domain-full\n582: \n583: The Geometric Gas algorithmic velocity is defined via a smooth squashing map (see {prf:ref}`doc-02-euclidean-gas` §4.2):\n584: \n585: $$\n586: v_{\\text{alg}} = \\psi(v) = V_{\\max} \\cdot \\tanh(v / V_{\\max})\n587: \n588: $$\n589: \n590: where v is the dynamical velocity evolved by the kinetic operator.\n591: \n592: **Properties**:\n593: 1. **Boundedness**: ‖ψ(v)‖ < V_max for all v ∈ ℝ^d (compact image V = B(0, V_max))\n594: 2. **Smoothness**: ψ ∈ C^∞ with ‖∇^m ψ‖ ≤ C_ψ,m V_max^{1-m} (Gevrey-1)\n595: 3. **Near-identity**: ψ(v) ≈ v for ‖v‖ ≪ V_max (non-intrusive)\n596: \n597: **Consequence**: The phase space 𝒳 × V is compact (𝒳 is assumed compact, V is bounded by squashing).",
      "metadata": {
        "label": "lem-velocity-squashing-compact-domain-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "578: Each step depends only on previous steps. The assumption ρ_max is **explicit** and **validated for consistency**.\n579: \n580: :::{prf:lemma} Velocity Squashing Ensures Compact Phase Space\n581: :label: lem-velocity-squashing-compact-domain-full\n582: \n583: The Geometric Gas algorithmic velocity is defined via a smooth squashing map (see {prf:ref}`doc-02-euclidean-gas` §4.2):\n584: \n585: $$\n586: v_{\\text{alg}} = \\psi(v) = V_{\\max} \\cdot \\tanh(v / V_{\\max})\n587: \n588: $$\n589: \n590: where v is the dynamical velocity evolved by the kinetic operator.\n591: \n592: **Properties**:\n593: 1. **Boundedness**: ‖ψ(v)‖ < V_max for all v ∈ ℝ^d (compact image V = B(0, V_max))\n594: 2. **Smoothness**: ψ ∈ C^∞ with ‖∇^m ψ‖ ≤ C_ψ,m V_max^{1-m} (Gevrey-1)\n595: 3. **Near-identity**: ψ(v) ≈ v for ‖v‖ ≪ V_max (non-intrusive)\n596: \n597: **Consequence**: The phase space 𝒳 × V is compact (𝒳 is assumed compact, V is bounded by squashing).\n598: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-fokker-planck-density-bound-conservative-full",
      "title": "Fokker-Planck Density Bound from Lipschitz Drift (Conservative Case)",
      "start_line": 600,
      "end_line": 628,
      "header_lines": [
        601
      ],
      "content_start": 603,
      "content_end": 627,
      "content": "603: :label: lem-fokker-planck-density-bound-conservative-full\n604: \n605: Consider the **conservative** Fokker-Planck equation on compact phase space 𝒳 × V:\n606: \n607: $$\n608: \\frac{\\partial \\rho}{\\partial t} = -\\psi(v) \\cdot \\nabla_x \\rho + \\nabla_v \\cdot \\left(\\gamma v \\rho + \\nabla_x V_{\\text{fit}} \\cdot \\rho\\right) + \\gamma T \\Delta_v \\rho\n609: \n610: $$\n611: \n612: **Note**: This PDE does NOT include cloning source/sink terms. It describes the conservative Langevin dynamics.\n613: \n614: Assume:\n615: - V_fit has Lipschitz gradient: ‖∇_x V_fit‖ ≤ L_V (from C³ regularity, doc-13)\n616: - Velocity domain is compact: ‖v‖ ≤ V_max (from Lemma {prf:ref}`lem-velocity-squashing-compact-domain-full`)\n617: - Spatial domain 𝒳 is compact\n618: - Kinetic diffusion γT > 0 (non-degenerate)\n619: \n620: Then the invariant measure ρ_∞ (if it exists) satisfies:\n621: \n622: $$\n623: \\rho_{\\infty}(x,v) \\leq C_{\\text{FK}}(\\gamma, T, L_V, V_{\\max}, \\text{Vol}(\\mathcal{X})) < \\infty\n624: \n625: $$\n626: \n627: where C_FK is uniform over the compact domain.",
      "metadata": {
        "label": "lem-fokker-planck-density-bound-conservative-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "600: :::\n601: \n602: :::{prf:lemma} Fokker-Planck Density Bound from Lipschitz Drift (Conservative Case)\n603: :label: lem-fokker-planck-density-bound-conservative-full\n604: \n605: Consider the **conservative** Fokker-Planck equation on compact phase space 𝒳 × V:\n606: \n607: $$\n608: \\frac{\\partial \\rho}{\\partial t} = -\\psi(v) \\cdot \\nabla_x \\rho + \\nabla_v \\cdot \\left(\\gamma v \\rho + \\nabla_x V_{\\text{fit}} \\cdot \\rho\\right) + \\gamma T \\Delta_v \\rho\n609: \n610: $$\n611: \n612: **Note**: This PDE does NOT include cloning source/sink terms. It describes the conservative Langevin dynamics.\n613: \n614: Assume:\n615: - V_fit has Lipschitz gradient: ‖∇_x V_fit‖ ≤ L_V (from C³ regularity, doc-13)\n616: - Velocity domain is compact: ‖v‖ ≤ V_max (from Lemma {prf:ref}`lem-velocity-squashing-compact-domain-full`)\n617: - Spatial domain 𝒳 is compact\n618: - Kinetic diffusion γT > 0 (non-degenerate)\n619: \n620: Then the invariant measure ρ_∞ (if it exists) satisfies:\n621: \n622: $$\n623: \\rho_{\\infty}(x,v) \\leq C_{\\text{FK}}(\\gamma, T, L_V, V_{\\max}, \\text{Vol}(\\mathcal{X})) < \\infty\n624: \n625: $$\n626: \n627: where C_FK is uniform over the compact domain.\n628: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-c3-independence-revised",
      "title": "QSD Density Bound with Cloning (Conditional Statement)",
      "start_line": 651,
      "end_line": 703,
      "header_lines": [
        652,
        676
      ],
      "content_start": 654,
      "content_end": 702,
      "content": "654: :label: lem-qsd-density-bound-with-cloning-full\n655: \n656: The Geometric Gas dynamics include cloning (birth-death process conditioned on alive set non-empty). The QSD satisfies:\n657: \n658: **Conditional result**: If the QSD π_QSD exists and is unique (established via Keystone Principle ergodicity), then under the following:\n659: \n660: 1. The **conservative** Fokker-Planck invariant measure has density bound ρ_FK ≤ C_FK (Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full`)\n661: 2. The cloning rate λ_clone is finite\n662: 3. The domain 𝒳 × V is compact (velocity squashing)\n663: \n664: The QSD density satisfies:\n665: \n666: $$\n667: \\rho_{\\text{QSD}}(x,v) \\leq C_{\\text{QSD}} \\cdot C_{\\text{FK}}\n668: \n669: $$\n670: \n671: where C_QSD depends on λ_clone and domain volume, but is **finite**.\n672: \n673: **Rigorous proof**: A complete proof requires analyzing the generator of the conditioned process (QSD generator = Fokker-Planck generator + cloning source/sink + ground state projection). This is subject of ongoing research in QSD theory for interacting particle systems (see Champagnat-Villemonais 2017, *Exponential convergence to quasi-stationary distribution*; Cloez-Thai 2018, *Quantitative results for QSD convergence*).\n674: \n675: **For this document**: We state ρ_max as an explicit assumption (Assumption {prf:ref}`assump-uniform-density-full`) below and validate consistency.\n676: \n677: :::{prf:lemma} Independence of C³ Regularity Analysis\n678: :label: lem-c3-independence-revised\n679: \n680: To ensure the logical chain is non-circular, we verify that the C³ regularity proof in {prf:ref}`doc-13-geometric-gas-c3-regularity` uses only:\n681: \n682: **Allowed inputs**:\n683: 1. **Companion availability** (Lemma {prf:ref}`lem-companion-availability-enforcement`) - derived below from Keystone + volume\n684: 2. **Bounded measurements**: d_alg ≤ diam(𝒳 × V) < ∞ (from compact domain)\n685: 3. **Regularization**: ε_d > 0 eliminates singularities\n686: 4. **Rescale function**: g_A ∈ C³ with bounded derivatives\n687: 5. **Density bound**: ρ_max (now EXPLICITLY ASSUMED, see below)\n688: \n689: **Critically, doc-13 does NOT assume**:\n690: - ✗ C^∞ regularity\n691: - ✗ k-uniform bounds at all orders\n692: - ✗ Anything from this document (doc-20)\n693: \n694: **Verification method**: Direct inspection of doc-13 confirms only the above five inputs are used.\n695: \n696: **Conclusion**: The logical chain is:\n697: 1. **Companion availability** ← Keystone + volume (§2.4 below, NO density assumption)\n698: 2. **C³ regularity** ← Companion availability + **ρ_max assumption** + elementary bounds\n699: 3. **Lipschitz gradient L_V** ← C³\n700: 4. **Fokker-Planck bound C_FK** ← L_V + compact domain + velocity squashing\n701: 5. **Consistency check** ← C_FK(L_V(ρ_max)) should have fixed point ρ_max*\n702: 6. **C^∞ regularity** ← ρ_max* + C³ + advanced machinery (this document)",
      "metadata": {
        "label": "lem-c3-independence-revised"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "651: :::\n652: \n653: :::{prf:lemma} QSD Density Bound with Cloning (Conditional Statement)\n654: :label: lem-qsd-density-bound-with-cloning-full\n655: \n656: The Geometric Gas dynamics include cloning (birth-death process conditioned on alive set non-empty). The QSD satisfies:\n657: \n658: **Conditional result**: If the QSD π_QSD exists and is unique (established via Keystone Principle ergodicity), then under the following:\n659: \n660: 1. The **conservative** Fokker-Planck invariant measure has density bound ρ_FK ≤ C_FK (Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full`)\n661: 2. The cloning rate λ_clone is finite\n662: 3. The domain 𝒳 × V is compact (velocity squashing)\n663: \n664: The QSD density satisfies:\n665: \n666: $$\n667: \\rho_{\\text{QSD}}(x,v) \\leq C_{\\text{QSD}} \\cdot C_{\\text{FK}}\n668: \n669: $$\n670: \n671: where C_QSD depends on λ_clone and domain volume, but is **finite**.\n672: \n673: **Rigorous proof**: A complete proof requires analyzing the generator of the conditioned process (QSD generator = Fokker-Planck generator + cloning source/sink + ground state projection). This is subject of ongoing research in QSD theory for interacting particle systems (see Champagnat-Villemonais 2017, *Exponential convergence to quasi-stationary distribution*; Cloez-Thai 2018, *Quantitative results for QSD convergence*).\n674: \n675: **For this document**: We state ρ_max as an explicit assumption (Assumption {prf:ref}`assump-uniform-density-full`) below and validate consistency.\n676: \n677: :::{prf:lemma} Independence of C³ Regularity Analysis\n678: :label: lem-c3-independence-revised\n679: \n680: To ensure the logical chain is non-circular, we verify that the C³ regularity proof in {prf:ref}`doc-13-geometric-gas-c3-regularity` uses only:\n681: \n682: **Allowed inputs**:\n683: 1. **Companion availability** (Lemma {prf:ref}`lem-companion-availability-enforcement`) - derived below from Keystone + volume\n684: 2. **Bounded measurements**: d_alg ≤ diam(𝒳 × V) < ∞ (from compact domain)\n685: 3. **Regularization**: ε_d > 0 eliminates singularities\n686: 4. **Rescale function**: g_A ∈ C³ with bounded derivatives\n687: 5. **Density bound**: ρ_max (now EXPLICITLY ASSUMED, see below)\n688: \n689: **Critically, doc-13 does NOT assume**:\n690: - ✗ C^∞ regularity\n691: - ✗ k-uniform bounds at all orders\n692: - ✗ Anything from this document (doc-20)\n693: \n694: **Verification method**: Direct inspection of doc-13 confirms only the above five inputs are used.\n695: \n696: **Conclusion**: The logical chain is:\n697: 1. **Companion availability** ← Keystone + volume (§2.4 below, NO density assumption)\n698: 2. **C³ regularity** ← Companion availability + **ρ_max assumption** + elementary bounds\n699: 3. **Lipschitz gradient L_V** ← C³\n700: 4. **Fokker-Planck bound C_FK** ← L_V + compact domain + velocity squashing\n701: 5. **Consistency check** ← C_FK(L_V(ρ_max)) should have fixed point ρ_max*\n702: 6. **C^∞ regularity** ← ρ_max* + C³ + advanced machinery (this document)\n703: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-companion-availability-enforcement",
      "title": "Partition Function Lower Bound from Compactness",
      "start_line": 776,
      "end_line": 792,
      "header_lines": [
        777
      ],
      "content_start": 779,
      "content_end": 791,
      "content": "779: :label: lem-companion-availability-enforcement\n780: \n781: For any walker $i \\in \\mathcal{A}$ in the alive set with $k \\geq 2$, the softmax partition function satisfies:\n782: \n783: $$\n784: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n785: \n786: $$\n787: \n788: where $D_{\\max} = \\text{diam}(\\mathcal{X} \\times V)$ is the phase-space diameter (finite by compactness).\n789: \n790: **Key properties**:\n791: 1. **Non-vanishing**: $Z_{\\min} > 0$ is strictly positive for all $i \\in \\mathcal{A}$",
      "metadata": {
        "label": "lem-companion-availability-enforcement"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "776: With the approach to the density bound clarified (explicit assumption with a posteriori validation, §2.3.5 above), we now state the three framework assumptions:\n777: \n778: :::{prf:lemma} Partition Function Lower Bound from Compactness\n779: :label: lem-companion-availability-enforcement\n780: \n781: For any walker $i \\in \\mathcal{A}$ in the alive set with $k \\geq 2$, the softmax partition function satisfies:\n782: \n783: $$\n784: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n785: \n786: $$\n787: \n788: where $D_{\\max} = \\text{diam}(\\mathcal{X} \\times V)$ is the phase-space diameter (finite by compactness).\n789: \n790: **Key properties**:\n791: 1. **Non-vanishing**: $Z_{\\min} > 0$ is strictly positive for all $i \\in \\mathcal{A}$\n792: 2. **k-uniform**: The bound depends only on domain diameter $D_{\\max}$ and parameter $\\varepsilon_c$, **not on the number of walkers** $k$ or $N$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-high-prob-min-separation-full",
      "title": "High-Probability Minimum Separation",
      "start_line": 879,
      "end_line": 899,
      "header_lines": [
        880
      ],
      "content_start": 882,
      "content_end": 898,
      "content": "882: :label: lem-high-prob-min-separation-full\n883: \n884: For the Geometric Gas with Langevin kinetic operator (temperature $T > 0$, friction $\\gamma > 0$) and cloning operator maintaining swarm diversity, there exist constants $r_{\\min}(T, \\gamma, k) > 0$ and $C_{\\text{sep}}(k) > 0$ such that:\n885: \n886: $$\n887: \\mathbb{P}\\left(\\min_{i \\neq j \\in \\mathcal{A}} d_{\\text{alg}}(i,j) < r_{\\min}\\right) \\leq C_{\\text{sep}} \\cdot e^{-c_{\\text{sep}} k}\n888: \n889: $$\n890: \n891: where $c_{\\text{sep}} > 0$ depends on $T, \\gamma, \\text{Vol}(\\mathcal{X})$ but not on $k$.\n892: \n893: **Physical mechanism**: The kinetic diffusion with $T > 0$ continuously randomizes velocities, preventing walkers from remaining close for extended periods. The cloning operator maintains diversity by preferentially removing low-fitness walkers (which tend to cluster). Combined, these mechanisms produce exponential repulsion in the QSD.\n894: \n895: **Quantitative scaling**: For typical parameters:\n896: - $r_{\\min} = \\Omega(k^{-1/2d})$ (random packing in dimension $d$)\n897: - $C_{\\text{sep}} = O(k^2)$ (number of pairs)\n898: - Decay rate: $c_{\\text{sep}} = \\Omega(T/(d \\cdot \\text{diam}(\\mathcal{X})^2))$",
      "metadata": {
        "label": "lem-high-prob-min-separation-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "879: :::\n880: \n881: :::{prf:lemma} High-Probability Minimum Separation\n882: :label: lem-high-prob-min-separation-full\n883: \n884: For the Geometric Gas with Langevin kinetic operator (temperature $T > 0$, friction $\\gamma > 0$) and cloning operator maintaining swarm diversity, there exist constants $r_{\\min}(T, \\gamma, k) > 0$ and $C_{\\text{sep}}(k) > 0$ such that:\n885: \n886: $$\n887: \\mathbb{P}\\left(\\min_{i \\neq j \\in \\mathcal{A}} d_{\\text{alg}}(i,j) < r_{\\min}\\right) \\leq C_{\\text{sep}} \\cdot e^{-c_{\\text{sep}} k}\n888: \n889: $$\n890: \n891: where $c_{\\text{sep}} > 0$ depends on $T, \\gamma, \\text{Vol}(\\mathcal{X})$ but not on $k$.\n892: \n893: **Physical mechanism**: The kinetic diffusion with $T > 0$ continuously randomizes velocities, preventing walkers from remaining close for extended periods. The cloning operator maintains diversity by preferentially removing low-fitness walkers (which tend to cluster). Combined, these mechanisms produce exponential repulsion in the QSD.\n894: \n895: **Quantitative scaling**: For typical parameters:\n896: - $r_{\\min} = \\Omega(k^{-1/2d})$ (random packing in dimension $d$)\n897: - $C_{\\text{sep}} = O(k^2)$ (number of pairs)\n898: - Decay rate: $c_{\\text{sep}} = \\Omega(T/(d \\cdot \\text{diam}(\\mathcal{X})^2))$\n899: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sum-to-integral-bound-full",
      "title": "Sum-to-Integral Bound with Exponential Weights",
      "start_line": 971,
      "end_line": 993,
      "header_lines": [
        972
      ],
      "content_start": 974,
      "content_end": 992,
      "content": "974: :label: lem-sum-to-integral-bound-full\n975: \n976: Under {prf:ref}`assump-uniform-density-full`, for any walker $i \\in \\mathcal{A}$ and any function $f : \\mathcal{X} \\times \\mathbb{R}^d \\to \\mathbb{R}$ with $|f| \\leq M$:\n977: \n978: $$\n979: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n980: \\leq \\rho_{\\max} \\cdot M \\cdot \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,y)}{2\\varepsilon_c^2}\\right) dy\\,du\n981: \n982: $$\n983: \n984: **Key consequence for Gaussian integrals**: When $f \\equiv 1$:\n985: \n986: $$\n987: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n988: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n989: \n990: $$\n991: \n992: where $C_{\\lambda} = (1 + \\lambda_{\\text{alg}})^{d/2}$ accounts for the velocity component in $d_{\\text{alg}}$.",
      "metadata": {
        "label": "lem-sum-to-integral-bound-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "971: The following lemma makes the sum-to-integral approximation **explicit**.\n972: \n973: :::{prf:lemma} Sum-to-Integral Bound with Exponential Weights\n974: :label: lem-sum-to-integral-bound-full\n975: \n976: Under {prf:ref}`assump-uniform-density-full`, for any walker $i \\in \\mathcal{A}$ and any function $f : \\mathcal{X} \\times \\mathbb{R}^d \\to \\mathbb{R}$ with $|f| \\leq M$:\n977: \n978: $$\n979: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n980: \\leq \\rho_{\\max} \\cdot M \\cdot \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,y)}{2\\varepsilon_c^2}\\right) dy\\,du\n981: \n982: $$\n983: \n984: **Key consequence for Gaussian integrals**: When $f \\equiv 1$:\n985: \n986: $$\n987: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n988: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n989: \n990: $$\n991: \n992: where $C_{\\lambda} = (1 + \\lambda_{\\text{alg}})^{d/2}$ accounts for the velocity component in $d_{\\text{alg}}$.\n993: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-partition-derivative-bounds-full",
      "title": "Derivative Bounds for Partition Functions",
      "start_line": 1183,
      "end_line": 1194,
      "header_lines": [
        1184
      ],
      "content_start": 1186,
      "content_end": 1193,
      "content": "1186: :label: lem-partition-derivative-bounds-full\n1187: \n1188: The partition functions $\\psi_m$ satisfy:\n1189: \n1190: $$\n1191: \\|\\nabla^n \\psi_m\\|_\\infty \\leq C_{\\psi,n} \\cdot \\varepsilon_c^{-n}\n1192: \n1193: $$",
      "metadata": {
        "label": "lem-partition-derivative-bounds-full"
      },
      "section": "## 3. Smooth Phase-Space Clustering",
      "raw_directive": "1183: :::\n1184: \n1185: :::{prf:lemma} Derivative Bounds for Partition Functions\n1186: :label: lem-partition-derivative-bounds-full\n1187: \n1188: The partition functions $\\psi_m$ satisfy:\n1189: \n1190: $$\n1191: \\|\\nabla^n \\psi_m\\|_\\infty \\leq C_{\\psi,n} \\cdot \\varepsilon_c^{-n}\n1192: \n1193: $$\n1194: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 3. Smooth Phase-Space Clustering"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-effective-cluster-size-bounds-full",
      "title": "Bounds on Effective Cluster Size",
      "start_line": 1277,
      "end_line": 1295,
      "header_lines": [
        1278
      ],
      "content_start": 1280,
      "content_end": 1294,
      "content": "1280: :label: lem-effective-cluster-size-bounds-full\n1281: \n1282: Under {prf:ref}`assump-uniform-density-full`:\n1283: \n1284: $$\n1285: k_m^{\\text{eff}} \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(y_m, 2\\varepsilon_c)) = C_{\\text{vol}} \\cdot \\rho_{\\max} \\cdot \\varepsilon_c^{2d}\n1286: \n1287: $$\n1288: \n1289: where $C_{\\text{vol}}$ is the volume constant for phase-space balls.\n1290: \n1291: Moreover, the total effective population sums to $k$:\n1292: \n1293: $$\n1294: \\sum_{m=1}^M k_m^{\\text{eff}} = \\sum_{m=1}^M \\sum_{j \\in \\mathcal{A}} \\psi_m(x_j, v_j) = \\sum_{j \\in \\mathcal{A}} \\underbrace{\\sum_{m=1}^M \\psi_m(x_j, v_j)}_{= 1} = k",
      "metadata": {
        "label": "lem-effective-cluster-size-bounds-full"
      },
      "section": "## 3. Smooth Phase-Space Clustering",
      "raw_directive": "1277: :::\n1278: \n1279: :::{prf:lemma} Bounds on Effective Cluster Size\n1280: :label: lem-effective-cluster-size-bounds-full\n1281: \n1282: Under {prf:ref}`assump-uniform-density-full`:\n1283: \n1284: $$\n1285: k_m^{\\text{eff}} \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(y_m, 2\\varepsilon_c)) = C_{\\text{vol}} \\cdot \\rho_{\\max} \\cdot \\varepsilon_c^{2d}\n1286: \n1287: $$\n1288: \n1289: where $C_{\\text{vol}}$ is the volume constant for phase-space balls.\n1290: \n1291: Moreover, the total effective population sums to $k$:\n1292: \n1293: $$\n1294: \\sum_{m=1}^M k_m^{\\text{eff}} = \\sum_{m=1}^M \\sum_{j \\in \\mathcal{A}} \\psi_m(x_j, v_j) = \\sum_{j \\in \\mathcal{A}} \\underbrace{\\sum_{m=1}^M \\psi_m(x_j, v_j)}_{= 1} = k\n1295: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 3. Smooth Phase-Space Clustering"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-softmax-tail-corrected-full",
      "title": "Softmax Tail Bound",
      "start_line": 1360,
      "end_line": 1371,
      "header_lines": [
        1361
      ],
      "content_start": 1363,
      "content_end": 1370,
      "content": "1363: :label: lem-softmax-tail-corrected-full\n1364: \n1365: Under {prf:ref}`lem-companion-availability-enforcement`, for walker $i \\in \\mathcal{A}$ with companion $c(i)$ selected via softmax:\n1366: \n1367: $$\n1368: \\mathbb{P}(d_{\\text{alg}}(i, c(i)) > R \\mid \\mathcal{F}_t) \\leq k \\cdot \\exp\\left(-\\frac{R^2 - R_{\\max}^2}{2\\varepsilon_c^2}\\right)\n1369: \n1370: $$",
      "metadata": {
        "label": "lem-softmax-tail-corrected-full"
      },
      "section": "## 4. Exponential Locality and Effective Interactions",
      "raw_directive": "1360: ### 4.1 Softmax Concentration Bounds\n1361: \n1362: :::{prf:lemma} Softmax Tail Bound\n1363: :label: lem-softmax-tail-corrected-full\n1364: \n1365: Under {prf:ref}`lem-companion-availability-enforcement`, for walker $i \\in \\mathcal{A}$ with companion $c(i)$ selected via softmax:\n1366: \n1367: $$\n1368: \\mathbb{P}(d_{\\text{alg}}(i, c(i)) > R \\mid \\mathcal{F}_t) \\leq k \\cdot \\exp\\left(-\\frac{R^2 - R_{\\max}^2}{2\\varepsilon_c^2}\\right)\n1369: \n1370: $$\n1371: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Exponential Locality and Effective Interactions"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-effective-companion-count-corrected-full",
      "title": "Effective Companion Count",
      "start_line": 1454,
      "end_line": 1472,
      "header_lines": [
        1455
      ],
      "content_start": 1457,
      "content_end": 1471,
      "content": "1457: :label: lem-effective-companion-count-corrected-full\n1458: \n1459: Under {prf:ref}`assump-uniform-density-full`, the effective number of companions within $R_{\\text{eff}}$ is:\n1460: \n1461: $$\n1462: k_{\\text{eff}}(i) := \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\mathbb{1}_{d_{\\text{alg}}(i,\\ell) \\leq R_{\\text{eff}}} \\leq \\rho_{\\max} \\cdot C_{\\text{vol}} \\cdot R_{\\text{eff}}^{2d}\n1463: \n1464: $$\n1465: \n1466: Substituting $R_{\\text{eff}} = \\mathcal{O}(\\varepsilon_c \\sqrt{\\log k})$:\n1467: \n1468: $$\n1469: k_{\\text{eff}}(i) = \\mathcal{O}(\\varepsilon_c^{2d} \\cdot (\\log k)^d)\n1470: \n1471: $$",
      "metadata": {
        "label": "lem-effective-companion-count-corrected-full"
      },
      "section": "## 4. Exponential Locality and Effective Interactions",
      "raw_directive": "1454: ### 4.2 Effective Number of Interacting Companions\n1455: \n1456: :::{prf:lemma} Effective Companion Count\n1457: :label: lem-effective-companion-count-corrected-full\n1458: \n1459: Under {prf:ref}`assump-uniform-density-full`, the effective number of companions within $R_{\\text{eff}}$ is:\n1460: \n1461: $$\n1462: k_{\\text{eff}}(i) := \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\mathbb{1}_{d_{\\text{alg}}(i,\\ell) \\leq R_{\\text{eff}}} \\leq \\rho_{\\max} \\cdot C_{\\text{vol}} \\cdot R_{\\text{eff}}^{2d}\n1463: \n1464: $$\n1465: \n1466: Substituting $R_{\\text{eff}} = \\mathcal{O}(\\varepsilon_c \\sqrt{\\log k})$:\n1467: \n1468: $$\n1469: k_{\\text{eff}}(i) = \\mathcal{O}(\\varepsilon_c^{2d} \\cdot (\\log k)^d)\n1470: \n1471: $$\n1472: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Exponential Locality and Effective Interactions"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-softmax-derivative-locality-full",
      "title": "Exponential Locality of Softmax Derivatives",
      "start_line": 1505,
      "end_line": 1518,
      "header_lines": [
        1506
      ],
      "content_start": 1508,
      "content_end": 1517,
      "content": "1508: :label: lem-softmax-derivative-locality-full\n1509: \n1510: For the softmax companion selection with temperature $\\varepsilon_c$, all derivatives of the companion probability satisfy:\n1511: \n1512: $$\n1513: \\left|\\nabla^\\alpha_{x_i} P(c(j) = \\ell \\mid \\mathcal{F}_t)\\right| \\leq C_{|\\alpha|} \\cdot \\varepsilon_c^{-2|\\alpha|} \\cdot P(c(j) = \\ell \\mid \\mathcal{F}_t) \\cdot \\exp\\left(-\\frac{d_{\\text{alg}}^2(j, \\ell)}{4\\varepsilon_c^2}\\right)\n1514: \n1515: $$\n1516: \n1517: where $C_{|\\alpha|} = O(|\\alpha|!)$ (Gevrey-1 growth) and the bound is **k-uniform**.",
      "metadata": {
        "label": "lem-softmax-derivative-locality-full"
      },
      "section": "## 4. Exponential Locality and Effective Interactions",
      "raw_directive": "1505: The previous sections established exponential concentration for the **probabilities** $P(c(i) = \\ell)$. We now prove that **derivatives** of these probabilities also decay exponentially.\n1506: \n1507: :::{prf:lemma} Exponential Locality of Softmax Derivatives\n1508: :label: lem-softmax-derivative-locality-full\n1509: \n1510: For the softmax companion selection with temperature $\\varepsilon_c$, all derivatives of the companion probability satisfy:\n1511: \n1512: $$\n1513: \\left|\\nabla^\\alpha_{x_i} P(c(j) = \\ell \\mid \\mathcal{F}_t)\\right| \\leq C_{|\\alpha|} \\cdot \\varepsilon_c^{-2|\\alpha|} \\cdot P(c(j) = \\ell \\mid \\mathcal{F}_t) \\cdot \\exp\\left(-\\frac{d_{\\text{alg}}^2(j, \\ell)}{4\\varepsilon_c^2}\\right)\n1514: \n1515: $$\n1516: \n1517: where $C_{|\\alpha|} = O(|\\alpha|!)$ (Gevrey-1 growth) and the bound is **k-uniform**.\n1518: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Exponential Locality and Effective Interactions"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-dalg-derivative-bounds-full",
      "title": "Higher Derivatives of Regularized Algorithmic Distance",
      "start_line": 1608,
      "end_line": 1651,
      "header_lines": [
        1609
      ],
      "content_start": 1611,
      "content_end": 1650,
      "content": "1611: :label: lem-dalg-derivative-bounds-full\n1612: \n1613: The **regularized** algorithmic distance:\n1614: \n1615: $$\n1616: d_{\\text{alg}}(i,j) = \\sqrt{\\|x_i - x_j\\|^2 + \\lambda_{\\text{alg}} \\|v_i - v_j\\|^2 + \\varepsilon_d^2}\n1617: \n1618: $$\n1619: \n1620: where $\\varepsilon_d > 0$ is the regularization parameter, has the following properties:\n1621: \n1622: 1. **Uniform Lower Bound**: $d_{\\text{alg}}(i,j) \\geq \\varepsilon_d > 0$ for all walker configurations (no singularity)\n1623: \n1624: 2. **C^∞ Regularity**: $d_{\\text{alg}}$ is C^∞ with **uniform** derivative bounds:\n1625: \n1626: **First derivative**:\n1627: \n1628: $$\n1629: \\nabla_{x_i} d_{\\text{alg}}(i,j) = \\frac{x_i - x_j}{d_{\\text{alg}}(i,j)}, \\quad \\|\\nabla_{x_i} d_{\\text{alg}}(i,j)\\| \\leq 1\n1630: \n1631: $$\n1632: \n1633: **Second derivative** (Hessian):\n1634: \n1635: $$\n1636: \\nabla^2_{x_i} d_{\\text{alg}}(i,j) = \\frac{1}{d_{\\text{alg}}(i,j)} \\left(I - \\frac{(x_i - x_j) \\otimes (x_i - x_j)}{d_{\\text{alg}}^2(i,j)}\\right)\n1637: \n1638: $$\n1639: \n1640: $$\n1641: \\|\\nabla^2_{x_i} d_{\\text{alg}}(i,j)\\| \\leq \\frac{1}{\\varepsilon_d} \\quad \\text{(uniform bound using } d_{\\text{alg}} \\geq \\varepsilon_d\\text{)}\n1642: \n1643: $$\n1644: \n1645: **General bound**: For derivative order $n \\geq 1$:\n1646: \n1647: $$\n1648: \\|\\nabla^n_{x_i} d_{\\text{alg}}(i,j)\\| \\leq C_{d,n} \\cdot \\varepsilon_d^{1-n}\n1649: \n1650: $$",
      "metadata": {
        "label": "lem-dalg-derivative-bounds-full"
      },
      "section": "## 5. Derivatives of Algorithmic Distance (Regularized Version)",
      "raw_directive": "1608: We now establish the derivative structure for the **regularized** algorithmic distance, which eliminates the singularity at walker collisions.\n1609: \n1610: :::{prf:lemma} Higher Derivatives of Regularized Algorithmic Distance\n1611: :label: lem-dalg-derivative-bounds-full\n1612: \n1613: The **regularized** algorithmic distance:\n1614: \n1615: $$\n1616: d_{\\text{alg}}(i,j) = \\sqrt{\\|x_i - x_j\\|^2 + \\lambda_{\\text{alg}} \\|v_i - v_j\\|^2 + \\varepsilon_d^2}\n1617: \n1618: $$\n1619: \n1620: where $\\varepsilon_d > 0$ is the regularization parameter, has the following properties:\n1621: \n1622: 1. **Uniform Lower Bound**: $d_{\\text{alg}}(i,j) \\geq \\varepsilon_d > 0$ for all walker configurations (no singularity)\n1623: \n1624: 2. **C^∞ Regularity**: $d_{\\text{alg}}$ is C^∞ with **uniform** derivative bounds:\n1625: \n1626: **First derivative**:\n1627: \n1628: $$\n1629: \\nabla_{x_i} d_{\\text{alg}}(i,j) = \\frac{x_i - x_j}{d_{\\text{alg}}(i,j)}, \\quad \\|\\nabla_{x_i} d_{\\text{alg}}(i,j)\\| \\leq 1\n1630: \n1631: $$\n1632: \n1633: **Second derivative** (Hessian):\n1634: \n1635: $$\n1636: \\nabla^2_{x_i} d_{\\text{alg}}(i,j) = \\frac{1}{d_{\\text{alg}}(i,j)} \\left(I - \\frac{(x_i - x_j) \\otimes (x_i - x_j)}{d_{\\text{alg}}^2(i,j)}\\right)\n1637: \n1638: $$\n1639: \n1640: $$\n1641: \\|\\nabla^2_{x_i} d_{\\text{alg}}(i,j)\\| \\leq \\frac{1}{\\varepsilon_d} \\quad \\text{(uniform bound using } d_{\\text{alg}} \\geq \\varepsilon_d\\text{)}\n1642: \n1643: $$\n1644: \n1645: **General bound**: For derivative order $n \\geq 1$:\n1646: \n1647: $$\n1648: \\|\\nabla^n_{x_i} d_{\\text{alg}}(i,j)\\| \\leq C_{d,n} \\cdot \\varepsilon_d^{1-n}\n1649: \n1650: $$\n1651: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 5. Derivatives of Algorithmic Distance (Regularized Version)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-companion-measurement-derivatives-full",
      "title": "Derivatives of Companion-Dependent Measurements",
      "start_line": 1806,
      "end_line": 1826,
      "header_lines": [
        1807
      ],
      "content_start": 1809,
      "content_end": 1825,
      "content": "1809: :label: lem-companion-measurement-derivatives-full\n1810: \n1811: For any walker $i \\in \\mathcal{A}$ (taking derivatives with respect to $x_i$), the companion-dependent measurement for walker $j \\neq i$ satisfies:\n1812: \n1813: $$\n1814: \\|\\nabla^n_{x_i} d_j\\| \\leq C_{d_j,n} \\cdot \\max(\\varepsilon_d^{1-n}, \\varepsilon_d \\varepsilon_c^{-n})\n1815: \n1816: $$\n1817: \n1818: where $C_{d_j,n} = \\mathcal{O}(n!)$ (Gevrey-1) is **k-uniform** (independent of the number of alive walkers).\n1819: \n1820: **For typical parameters** where $\\varepsilon_d \\ll \\varepsilon_c$ and $n \\geq 2$, this simplifies to:\n1821: \n1822: $$\n1823: \\|\\nabla^n_{x_i} d_j\\| \\leq C_{d_j,n} \\cdot \\varepsilon_d^{1-n}\n1824: \n1825: $$",
      "metadata": {
        "label": "lem-companion-measurement-derivatives-full"
      },
      "section": "## 5.5 Companion-Dependent Measurements with Softmax Coupling",
      "raw_directive": "1806: ### 5.5.2 High-Order Derivatives via Faà di Bruno Formula\n1807: \n1808: :::{prf:lemma} Derivatives of Companion-Dependent Measurements\n1809: :label: lem-companion-measurement-derivatives-full\n1810: \n1811: For any walker $i \\in \\mathcal{A}$ (taking derivatives with respect to $x_i$), the companion-dependent measurement for walker $j \\neq i$ satisfies:\n1812: \n1813: $$\n1814: \\|\\nabla^n_{x_i} d_j\\| \\leq C_{d_j,n} \\cdot \\max(\\varepsilon_d^{1-n}, \\varepsilon_d \\varepsilon_c^{-n})\n1815: \n1816: $$\n1817: \n1818: where $C_{d_j,n} = \\mathcal{O}(n!)$ (Gevrey-1) is **k-uniform** (independent of the number of alive walkers).\n1819: \n1820: **For typical parameters** where $\\varepsilon_d \\ll \\varepsilon_c$ and $n \\geq 2$, this simplifies to:\n1821: \n1822: $$\n1823: \\|\\nabla^n_{x_i} d_j\\| \\leq C_{d_j,n} \\cdot \\varepsilon_d^{1-n}\n1824: \n1825: $$\n1826: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 5.5 Companion-Dependent Measurements with Softmax Coupling"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-softmax-jacobian-reduction",
      "title": "Softmax Jacobian Reduction for $j \\neq i$",
      "start_line": 1978,
      "end_line": 1996,
      "header_lines": [
        1979
      ],
      "content_start": 1981,
      "content_end": 1995,
      "content": "1981: :label: lem-softmax-jacobian-reduction\n1982: \n1983: Let $K_\\ell := \\exp(-d_{\\text{alg}}^2(j,\\ell)/(2\\varepsilon_c^2))$, $Z := \\sum_m K_m$, and $P_\\ell := K_\\ell / Z$ be the softmax probabilities. For $j \\neq i$, only $K_i$ depends on $x_i$. Then:\n1984: \n1985: $$\n1986: \\nabla_{x_i} P_\\ell = P_\\ell (\\delta_{\\ell i} - P_i) \\nabla_{x_i} \\log K_i\n1987: \n1988: $$\n1989: \n1990: and the first derivative of $d_j$ decomposes as:\n1991: \n1992: $$\n1993: \\nabla_{x_i} d_j = P_i \\nabla_{x_i} d_{\\text{alg}}(j,i) + P_i (d_{\\text{alg}}(j,i) - d_j) \\nabla_{x_i} \\log K_i\n1994: \n1995: $$",
      "metadata": {
        "label": "lem-softmax-jacobian-reduction"
      },
      "section": "## 5.5 Companion-Dependent Measurements with Softmax Coupling",
      "raw_directive": "1978: Before applying the quotient rule, we provide an alternative derivation using the probability parametrization that makes the k-uniformity mechanism explicit. This addresses potential concerns about whether $\\ell$-summations could introduce $\\mathcal{O}(k_{\\text{eff}}^{(\\varepsilon_c)}) = \\mathcal{O}((\\log k)^d)$ factors.\n1979: \n1980: :::{prf:lemma} Softmax Jacobian Reduction for $j \\neq i$\n1981: :label: lem-softmax-jacobian-reduction\n1982: \n1983: Let $K_\\ell := \\exp(-d_{\\text{alg}}^2(j,\\ell)/(2\\varepsilon_c^2))$, $Z := \\sum_m K_m$, and $P_\\ell := K_\\ell / Z$ be the softmax probabilities. For $j \\neq i$, only $K_i$ depends on $x_i$. Then:\n1984: \n1985: $$\n1986: \\nabla_{x_i} P_\\ell = P_\\ell (\\delta_{\\ell i} - P_i) \\nabla_{x_i} \\log K_i\n1987: \n1988: $$\n1989: \n1990: and the first derivative of $d_j$ decomposes as:\n1991: \n1992: $$\n1993: \\nabla_{x_i} d_j = P_i \\nabla_{x_i} d_{\\text{alg}}(j,i) + P_i (d_{\\text{alg}}(j,i) - d_j) \\nabla_{x_i} \\log K_i\n1994: \n1995: $$\n1996: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 5.5 Companion-Dependent Measurements with Softmax Coupling"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-self-measurement-derivatives-full",
      "title": "Derivatives of Self-Measurement (j=i case)",
      "start_line": 2215,
      "end_line": 2235,
      "header_lines": [
        2216
      ],
      "content_start": 2218,
      "content_end": 2234,
      "content": "2218: :label: lem-self-measurement-derivatives-full\n2219: \n2220: For walker $i \\in \\mathcal{A}$, the **self-measurement** $d_i = d_{\\text{alg}}(i, c(i))$ where $c(i)$ is selected via softmax satisfies:\n2221: \n2222: $$\n2223: \\|\\nabla^n_{x_i} d_i\\| \\leq C_{d_i,n} \\cdot \\max(\\varepsilon_d^{1-n}, \\varepsilon_d \\varepsilon_c^{-n})\n2224: \n2225: $$\n2226: \n2227: where $C_{d_i,n} = \\mathcal{O}(n!)$ (Gevrey-1) is **k-uniform** (independent of the number of alive walkers).\n2228: \n2229: **For typical parameters** where $\\varepsilon_d \\ll \\varepsilon_c$ and $n \\geq 2$:\n2230: \n2231: $$\n2232: \\|\\nabla^n_{x_i} d_i\\| \\leq C_{d_i,n} \\cdot \\varepsilon_d^{1-n}\n2233: \n2234: $$",
      "metadata": {
        "label": "lem-self-measurement-derivatives-full"
      },
      "section": "## 5.5 Companion-Dependent Measurements with Softmax Coupling",
      "raw_directive": "2215: :::\n2216: \n2217: :::{prf:lemma} Derivatives of Self-Measurement (j=i case)\n2218: :label: lem-self-measurement-derivatives-full\n2219: \n2220: For walker $i \\in \\mathcal{A}$, the **self-measurement** $d_i = d_{\\text{alg}}(i, c(i))$ where $c(i)$ is selected via softmax satisfies:\n2221: \n2222: $$\n2223: \\|\\nabla^n_{x_i} d_i\\| \\leq C_{d_i,n} \\cdot \\max(\\varepsilon_d^{1-n}, \\varepsilon_d \\varepsilon_c^{-n})\n2224: \n2225: $$\n2226: \n2227: where $C_{d_i,n} = \\mathcal{O}(n!)$ (Gevrey-1) is **k-uniform** (independent of the number of alive walkers).\n2228: \n2229: **For typical parameters** where $\\varepsilon_d \\ll \\varepsilon_c$ and $n \\geq 2$:\n2230: \n2231: $$\n2232: \\|\\nabla^n_{x_i} d_i\\| \\leq C_{d_i,n} \\cdot \\varepsilon_d^{1-n}\n2233: \n2234: $$\n2235: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 5.5 Companion-Dependent Measurements with Softmax Coupling"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-greedy-ideal-equivalence",
      "title": "Statistical Equivalence Preserves C^∞ Regularity",
      "start_line": 2655,
      "end_line": 2666,
      "header_lines": [
        2656
      ],
      "content_start": 2658,
      "content_end": 2665,
      "content": "2658: :label: lem-greedy-ideal-equivalence\n2659: \n2660: The Sequential Stochastic Greedy Pairing and the Idealized Spatially-Aware Pairing produce statistically equivalent measurements:\n2661: \n2662: $$\n2663: \\mathbb{E}_{\\text{greedy}}[d_i | S] = \\mathbb{E}_{\\text{ideal}}[d_i | S] + O(k^{-\\beta})\n2664: \n2665: $$",
      "metadata": {
        "label": "lem-greedy-ideal-equivalence"
      },
      "section": "## 5.6 Diversity Pairing Mechanism Analysis",
      "raw_directive": "2655: ### 5.6.4 Transfer from Idealized to Greedy Pairing\n2656: \n2657: :::{prf:lemma} Statistical Equivalence Preserves C^∞ Regularity\n2658: :label: lem-greedy-ideal-equivalence\n2659: \n2660: The Sequential Stochastic Greedy Pairing and the Idealized Spatially-Aware Pairing produce statistically equivalent measurements:\n2661: \n2662: $$\n2663: \\mathbb{E}_{\\text{greedy}}[d_i | S] = \\mathbb{E}_{\\text{ideal}}[d_i | S] + O(k^{-\\beta})\n2664: \n2665: $$\n2666: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 5.6 Diversity Pairing Mechanism Analysis"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-gaussian-kernel-derivatives-full",
      "title": "Gaussian Kernel Derivatives",
      "start_line": 2978,
      "end_line": 2991,
      "header_lines": [
        2979
      ],
      "content_start": 2981,
      "content_end": 2990,
      "content": "2981: :label: lem-gaussian-kernel-derivatives-full\n2982: \n2983: The Gaussian kernel $K_\\rho(i,j) = \\exp(-d_{\\text{alg}}^2(i,j)/(2\\rho^2))$ satisfies:\n2984: \n2985: For derivative order $n \\geq 1$:\n2986: \n2987: $$\n2988: \\|\\nabla^n_{x_i} K_\\rho(i,j)\\| \\leq C_{K,n} \\cdot \\rho^{-n} \\cdot K_\\rho(i,j)\n2989: \n2990: $$",
      "metadata": {
        "label": "lem-gaussian-kernel-derivatives-full"
      },
      "section": "## 6. Structure of Localization Weights",
      "raw_directive": "2978: ### 6.1 Derivative Bounds for Localization Kernel\n2979: \n2980: :::{prf:lemma} Gaussian Kernel Derivatives\n2981: :label: lem-gaussian-kernel-derivatives-full\n2982: \n2983: The Gaussian kernel $K_\\rho(i,j) = \\exp(-d_{\\text{alg}}^2(i,j)/(2\\rho^2))$ satisfies:\n2984: \n2985: For derivative order $n \\geq 1$:\n2986: \n2987: $$\n2988: \\|\\nabla^n_{x_i} K_\\rho(i,j)\\| \\leq C_{K,n} \\cdot \\rho^{-n} \\cdot K_\\rho(i,j)\n2989: \n2990: $$\n2991: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 6. Structure of Localization Weights"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-localization-weight-derivatives-full",
      "title": "Localization Weight Derivatives",
      "start_line": 3015,
      "end_line": 3026,
      "header_lines": [
        3016
      ],
      "content_start": 3018,
      "content_end": 3025,
      "content": "3018: :label: lem-localization-weight-derivatives-full\n3019: \n3020: The localization weights $w_{ij}(\\rho) = K_\\rho(i,j) / Z_i(\\rho)$ satisfy:\n3021: \n3022: $$\n3023: \\|\\nabla^n_{x_i} w_{ij}(\\rho)\\| \\leq C_{w,n} \\cdot \\rho^{-n}\n3024: \n3025: $$",
      "metadata": {
        "label": "lem-localization-weight-derivatives-full"
      },
      "section": "## 6. Structure of Localization Weights",
      "raw_directive": "3015: ### 6.2 Localization Weights: Quotient Rule Analysis\n3016: \n3017: :::{prf:lemma} Localization Weight Derivatives\n3018: :label: lem-localization-weight-derivatives-full\n3019: \n3020: The localization weights $w_{ij}(\\rho) = K_\\rho(i,j) / Z_i(\\rho)$ satisfy:\n3021: \n3022: $$\n3023: \\|\\nabla^n_{x_i} w_{ij}(\\rho)\\| \\leq C_{w,n} \\cdot \\rho^{-n}\n3024: \n3025: $$\n3026: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 6. Structure of Localization Weights"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-telescoping-localization-weights-full",
      "title": "Telescoping for Localization Weights",
      "start_line": 3119,
      "end_line": 3128,
      "header_lines": [
        3120
      ],
      "content_start": 3122,
      "content_end": 3127,
      "content": "3122: :label: lem-telescoping-localization-weights-full\n3123: \n3124: For walker $i$ and any derivative order $n \\geq 1$:\n3125: \n3126: $$\n3127: \\sum_{j \\in \\mathcal{A}} \\nabla^n_{x_i} w_{ij}(\\rho) = 0",
      "metadata": {
        "label": "lem-telescoping-localization-weights-full"
      },
      "section": "## 6. Structure of Localization Weights",
      "raw_directive": "3119: ### 6.3 Telescoping Identity for Smooth Weights\n3120: \n3121: :::{prf:lemma} Telescoping for Localization Weights\n3122: :label: lem-telescoping-localization-weights-full\n3123: \n3124: For walker $i$ and any derivative order $n \\geq 1$:\n3125: \n3126: $$\n3127: \\sum_{j \\in \\mathcal{A}} \\nabla^n_{x_i} w_{ij}(\\rho) = 0\n3128: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 6. Structure of Localization Weights"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-derivatives-companion-distance-full",
      "title": "Derivatives of Companion-Dependent Distance",
      "start_line": 3288,
      "end_line": 3300,
      "header_lines": [
        3289
      ],
      "content_start": 3291,
      "content_end": 3299,
      "content": "3291: :label: lem-derivatives-companion-distance-full\n3292: \n3293: For measurement $d_j = d_{\\text{alg}}(j, c(j))$ where $c(j)$ is selected via softmax, the derivative with respect to $x_i$ is:\n3294: \n3295: $$\n3296: \\frac{\\partial d_j}{\\partial x_i} = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{j\\}} \\mathbb{P}(c(j) = \\ell) \\cdot \\frac{\\partial d_{\\text{alg}}(j, \\ell)}{\\partial x_i}\n3297: + \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{j\\}} d_{\\text{alg}}(j, \\ell) \\cdot \\frac{\\partial \\mathbb{P}(c(j) = \\ell)}{\\partial x_i}\n3298: \n3299: $$",
      "metadata": {
        "label": "lem-derivatives-companion-distance-full"
      },
      "section": "## 7. Companion-Dependent Measurements: Handling N-Body Coupling",
      "raw_directive": "3288: ### 7.1 Derivative Structure of Companion-Dependent Measurements\n3289: \n3290: :::{prf:lemma} Derivatives of Companion-Dependent Distance\n3291: :label: lem-derivatives-companion-distance-full\n3292: \n3293: For measurement $d_j = d_{\\text{alg}}(j, c(j))$ where $c(j)$ is selected via softmax, the derivative with respect to $x_i$ is:\n3294: \n3295: $$\n3296: \\frac{\\partial d_j}{\\partial x_i} = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{j\\}} \\mathbb{P}(c(j) = \\ell) \\cdot \\frac{\\partial d_{\\text{alg}}(j, \\ell)}{\\partial x_i}\n3297: + \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{j\\}} d_{\\text{alg}}(j, \\ell) \\cdot \\frac{\\partial \\mathbb{P}(c(j) = \\ell)}{\\partial x_i}\n3298: \n3299: $$\n3300: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 13,
        "chapter_file": "chapter_13.json",
        "section_id": "## 7. Companion-Dependent Measurements: Handling N-Body Coupling"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-first-derivative-localized-mean-full",
      "title": "First Derivative of Localized Mean",
      "start_line": 3451,
      "end_line": 3460,
      "header_lines": [
        3452
      ],
      "content_start": 3454,
      "content_end": 3459,
      "content": "3454: :label: lem-first-derivative-localized-mean-full\n3455: \n3456: $$\n3457: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\leq C_{\\mu,1}(\\rho) \\cdot \\rho^{-1}\n3458: \n3459: $$",
      "metadata": {
        "label": "lem-first-derivative-localized-mean-full"
      },
      "section": "## 8. Localized Mean: Derivative Expansion",
      "raw_directive": "3451: ### 8.1 First Derivative: Telescoping with Companion Coupling\n3452: \n3453: :::{prf:lemma} First Derivative of Localized Mean\n3454: :label: lem-first-derivative-localized-mean-full\n3455: \n3456: $$\n3457: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\leq C_{\\mu,1}(\\rho) \\cdot \\rho^{-1}\n3458: \n3459: $$\n3460: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## 8. Localized Mean: Derivative Expansion"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mth-derivative-localized-mean-full",
      "title": "m-th Derivative of Localized Mean",
      "start_line": 3630,
      "end_line": 3641,
      "header_lines": [
        3631
      ],
      "content_start": 3633,
      "content_end": 3640,
      "content": "3633: :label: lem-mth-derivative-localized-mean-full\n3634: \n3635: For derivative order $m \\geq 1$:\n3636: \n3637: $$\n3638: \\|\\nabla^m_{x_i} \\mu_\\rho^{(i)}\\| \\leq C_{\\mu,m}(\\rho) \\cdot \\rho^{-m}\n3639: \n3640: $$",
      "metadata": {
        "label": "lem-mth-derivative-localized-mean-full"
      },
      "section": "## 8. Localized Mean: Derivative Expansion",
      "raw_directive": "3630: We now establish the general pattern for arbitrary derivative order $m$.\n3631: \n3632: :::{prf:lemma} m-th Derivative of Localized Mean\n3633: :label: lem-mth-derivative-localized-mean-full\n3634: \n3635: For derivative order $m \\geq 1$:\n3636: \n3637: $$\n3638: \\|\\nabla^m_{x_i} \\mu_\\rho^{(i)}\\| \\leq C_{\\mu,m}(\\rho) \\cdot \\rho^{-m}\n3639: \n3640: $$\n3641: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## 8. Localized Mean: Derivative Expansion"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-first-derivative-localized-variance-full",
      "title": "First Derivative of Localized Variance",
      "start_line": 3818,
      "end_line": 3827,
      "header_lines": [
        3819
      ],
      "content_start": 3821,
      "content_end": 3826,
      "content": "3821: :label: lem-first-derivative-localized-variance-full\n3822: \n3823: $$\n3824: \\|\\nabla_{x_i} \\sigma_\\rho^{2(i)}\\| \\leq C_{\\sigma^2,1}(\\rho) \\cdot \\rho^{-1}\n3825: \n3826: $$",
      "metadata": {
        "label": "lem-first-derivative-localized-variance-full"
      },
      "section": "## 9. Localized Variance: Full Derivative Analysis",
      "raw_directive": "3818: ### 9.1 Structure and First Derivative\n3819: \n3820: :::{prf:lemma} First Derivative of Localized Variance\n3821: :label: lem-first-derivative-localized-variance-full\n3822: \n3823: $$\n3824: \\|\\nabla_{x_i} \\sigma_\\rho^{2(i)}\\| \\leq C_{\\sigma^2,1}(\\rho) \\cdot \\rho^{-1}\n3825: \n3826: $$\n3827: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 16,
        "chapter_file": "chapter_16.json",
        "section_id": "## 9. Localized Variance: Full Derivative Analysis"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-properties-regularized-std-dev-full",
      "title": "Properties of Regularized Standard Deviation",
      "start_line": 4284,
      "end_line": 4301,
      "header_lines": [
        4285
      ],
      "content_start": 4287,
      "content_end": 4300,
      "content": "4287: :label: lem-properties-regularized-std-dev-full\n4288: \n4289: The function $\\sigma'_\\rho(i) = \\sqrt{\\sigma_\\rho^{2(i)} + \\eta_{\\min}^2}$ satisfies:\n4290: \n4291: 1. **Positive lower bound**: $\\sigma'_\\rho(i) \\geq \\eta_{\\min} > 0$ for all configurations\n4292: \n4293: 2. **C^∞ regularity**: $\\sigma'_\\rho \\in C^\\infty$ as a composition of C^∞ functions\n4294: \n4295: 3. **Derivative bounds**: For $m \\geq 1$,\n4296: \n4297: $$\n4298: \\|\\nabla^m \\sigma'_\\rho(i)\\| \\leq C_{\\sigma',m}(\\rho) \\cdot \\rho^{-m}\n4299: \n4300: $$",
      "metadata": {
        "label": "lem-properties-regularized-std-dev-full"
      },
      "section": "## 10. Regularized Standard Deviation",
      "raw_directive": "4284: ### 10.1 Smoothness and Lower Bounds\n4285: \n4286: :::{prf:lemma} Properties of Regularized Standard Deviation\n4287: :label: lem-properties-regularized-std-dev-full\n4288: \n4289: The function $\\sigma'_\\rho(i) = \\sqrt{\\sigma_\\rho^{2(i)} + \\eta_{\\min}^2}$ satisfies:\n4290: \n4291: 1. **Positive lower bound**: $\\sigma'_\\rho(i) \\geq \\eta_{\\min} > 0$ for all configurations\n4292: \n4293: 2. **C^∞ regularity**: $\\sigma'_\\rho \\in C^\\infty$ as a composition of C^∞ functions\n4294: \n4295: 3. **Derivative bounds**: For $m \\geq 1$,\n4296: \n4297: $$\n4298: \\|\\nabla^m \\sigma'_\\rho(i)\\| \\leq C_{\\sigma',m}(\\rho) \\cdot \\rho^{-m}\n4299: \n4300: $$\n4301: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "14_geometric_gas_cinf_regularity_full",
        "chapter_index": 18,
        "chapter_file": "chapter_18.json",
        "section_id": "## 10. Regularized Standard Deviation"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-wasserstein-revival",
      "title": "Wasserstein Contraction for Proportional Resampling (Conjecture)",
      "start_line": 951,
      "end_line": 964,
      "header_lines": [
        952
      ],
      "content_start": 954,
      "content_end": 963,
      "content": "954: :label: lem-wasserstein-revival\n955: \n956: If $\\mathcal{R}$ is viewed as resampling from $\\tilde{\\rho} = \\rho / \\|\\rho\\|_{L^1}$, then:\n957: \n958: $$\n959: W_2(\\mathcal{R}(\\rho), \\mathcal{R}(\\sigma)) \\le \\lambda (1-m) W_2(\\tilde{\\rho}, \\tilde{\\sigma})\n960: \n961: $$\n962: \n963: for some average dead mass $m \\approx (m_\\rho + m_\\sigma)/2$.",
      "metadata": {
        "label": "lem-wasserstein-revival"
      },
      "section": "## 3. Direct Proof Attempts",
      "raw_directive": "951: **Modified approach**: View $\\mathcal{R}$ as a **Markov kernel** (resampling) and use the Kantorovich duality for random maps.\n952: \n953: :::{prf:lemma} Wasserstein Contraction for Proportional Resampling (Conjecture)\n954: :label: lem-wasserstein-revival\n955: \n956: If $\\mathcal{R}$ is viewed as resampling from $\\tilde{\\rho} = \\rho / \\|\\rho\\|_{L^1}$, then:\n957: \n958: $$\n959: W_2(\\mathcal{R}(\\rho), \\mathcal{R}(\\sigma)) \\le \\lambda (1-m) W_2(\\tilde{\\rho}, \\tilde{\\sigma})\n960: \n961: $$\n962: \n963: for some average dead mass $m \\approx (m_\\rho + m_\\sigma)/2$.\n964: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 3. Direct Proof Attempts"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hormander",
      "title": "Hörmander's Condition",
      "start_line": 1756,
      "end_line": 1769,
      "header_lines": [
        1757
      ],
      "content_start": 1759,
      "content_end": 1768,
      "content": "1759: :label: lem-hormander\n1760: \n1761: The kinetic operator $\\mathcal{L}_{\\text{kin}}$ satisfies Hörmander's bracket condition:\n1762: \n1763: The vector fields:\n1764: \n1765: $$\n1766: X_0 = v \\cdot \\nabla_x - \\nabla_x U \\cdot \\nabla_v - \\gamma v \\cdot \\nabla_v, \\quad X_j = \\sigma \\frac{\\partial}{\\partial v_j}\n1767: \n1768: $$",
      "metadata": {
        "label": "lem-hormander"
      },
      "section": "## 2. Smoothness and Positivity (R2, R3)",
      "raw_directive": "1756: The key to proving $\\rho_\\infty \\in C^2$ is the **hypoelliptic** nature of $\\mathcal{L}_{\\text{kin}}$.\n1757: \n1758: :::{prf:lemma} Hörmander's Condition\n1759: :label: lem-hormander\n1760: \n1761: The kinetic operator $\\mathcal{L}_{\\text{kin}}$ satisfies Hörmander's bracket condition:\n1762: \n1763: The vector fields:\n1764: \n1765: $$\n1766: X_0 = v \\cdot \\nabla_x - \\nabla_x U \\cdot \\nabla_v - \\gamma v \\cdot \\nabla_v, \\quad X_j = \\sigma \\frac{\\partial}{\\partial v_j}\n1767: \n1768: $$\n1769: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 16,
        "chapter_file": "chapter_16.json",
        "section_id": "## 2. Smoothness and Positivity (R2, R3)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-irreducibility",
      "title": "Irreducibility",
      "start_line": 1842,
      "end_line": 1853,
      "header_lines": [
        1843
      ],
      "content_start": 1845,
      "content_end": 1852,
      "content": "1845: :label: lem-irreducibility\n1846: \n1847: The Markov process $(X_t, V_t)$ generated by $\\mathcal{L}$ (with revival) is **irreducible**: for any two open sets $A, B \\subset \\Omega$ and any initial point $(x_0, v_0) \\in A$, there exists $t > 0$ such that:\n1848: \n1849: $$\n1850: \\mathbb{P}_{(x_0,v_0)}[(X_t, V_t) \\in B] > 0\n1851: \n1852: $$",
      "metadata": {
        "label": "lem-irreducibility"
      },
      "section": "## 2. Smoothness and Positivity (R2, R3)",
      "raw_directive": "1842: #### Step 1: Irreducibility of the Process\n1843: \n1844: :::{prf:lemma} Irreducibility\n1845: :label: lem-irreducibility\n1846: \n1847: The Markov process $(X_t, V_t)$ generated by $\\mathcal{L}$ (with revival) is **irreducible**: for any two open sets $A, B \\subset \\Omega$ and any initial point $(x_0, v_0) \\in A$, there exists $t > 0$ such that:\n1848: \n1849: $$\n1850: \\mathbb{P}_{(x_0,v_0)}[(X_t, V_t) \\in B] > 0\n1851: \n1852: $$\n1853: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 16,
        "chapter_file": "chapter_16.json",
        "section_id": "## 2. Smoothness and Positivity (R2, R3)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-strong-max-principle",
      "title": "Strong Maximum Principle",
      "start_line": 1888,
      "end_line": 1894,
      "header_lines": [
        1889
      ],
      "content_start": 1891,
      "content_end": 1893,
      "content": "1891: :label: lem-strong-max-principle\n1892: \n1893: Let $\\rho$ satisfy $\\mathcal{L}[\\rho] = 0$ with $\\rho \\ge 0$ and $\\|\\rho\\|_{L^1} > 0$. If the process is irreducible, then either:",
      "metadata": {
        "label": "lem-strong-max-principle"
      },
      "section": "## 2. Smoothness and Positivity (R2, R3)",
      "raw_directive": "1888: #### Step 2: Strong Maximum Principle for Irreducible Processes\n1889: \n1890: :::{prf:lemma} Strong Maximum Principle\n1891: :label: lem-strong-max-principle\n1892: \n1893: Let $\\rho$ satisfy $\\mathcal{L}[\\rho] = 0$ with $\\rho \\ge 0$ and $\\|\\rho\\|_{L^1} > 0$. If the process is irreducible, then either:\n1894: 1. $\\rho(x,v) > 0$ for all $(x,v) \\in \\Omega$, OR",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 16,
        "chapter_file": "chapter_16.json",
        "section_id": "## 2. Smoothness and Positivity (R2, R3)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-drift-condition-corrected",
      "title": "Drift Condition with Quadratic Lyapunov",
      "start_line": 2563,
      "end_line": 2581,
      "header_lines": [
        2564
      ],
      "content_start": 2566,
      "content_end": 2580,
      "content": "2566: :label: lem-drift-condition-corrected\n2567: \n2568: Under Assumptions A1 (confinement) and A3 (friction), there exist constants $a, b, c > 0$ such that the quadratic Lyapunov function:\n2569: \n2570: $$\n2571: V(x,v) = a|x|^2 + 2b x \\cdot v + c|v|^2\n2572: \n2573: $$\n2574: \n2575: satisfies a drift condition with respect to the **adjoint operator** $\\mathcal{L}^*$:\n2576: \n2577: $$\n2578: \\mathcal{L}^*[V] \\le -\\beta V + C\n2579: \n2580: $$",
      "metadata": {
        "label": "lem-drift-condition-corrected"
      },
      "section": "## 4. Exponential Concentration (R6)",
      "raw_directive": "2563: Moreover, the simple Lyapunov $V = |x|^2 + |v|^2$ does NOT satisfy a drift condition due to the cross-term $x \\cdot v$. We need a **quadratic form** that handles this coupling.\n2564: \n2565: :::{prf:lemma} Drift Condition with Quadratic Lyapunov\n2566: :label: lem-drift-condition-corrected\n2567: \n2568: Under Assumptions A1 (confinement) and A3 (friction), there exist constants $a, b, c > 0$ such that the quadratic Lyapunov function:\n2569: \n2570: $$\n2571: V(x,v) = a|x|^2 + 2b x \\cdot v + c|v|^2\n2572: \n2573: $$\n2574: \n2575: satisfies a drift condition with respect to the **adjoint operator** $\\mathcal{L}^*$:\n2576: \n2577: $$\n2578: \\mathcal{L}^*[V] \\le -\\beta V + C\n2579: \n2580: $$\n2581: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 18,
        "chapter_file": "chapter_18.json",
        "section_id": "## 4. Exponential Concentration (R6)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-fisher-bound",
      "title": "Fisher Information Bound",
      "start_line": 4156,
      "end_line": 4176,
      "header_lines": [
        4157
      ],
      "content_start": 4159,
      "content_end": 4175,
      "content": "4159: :label: lem-fisher-bound\n4160: \n4161: There exists a constant $c_F > 0$ such that:\n4162: \n4163: $$\n4164: I_v(\\rho) \\ge c_F I_v(\\rho \\| \\rho_\\infty) - C_{\\text{rem}}\n4165: \n4166: $$\n4167: \n4168: where $c_F = 1/2$ and $C_{\\text{rem}} = 4C_{\\nabla v}^2$.\n4169: \n4170: Consequently:\n4171: \n4172: $$\n4173: \\boxed{I_v(\\rho) \\ge 2\\lambda_{\\text{LSI}} D_{\\text{KL}}(\\rho \\| \\rho_\\infty) - C_{\\text{LSI}}}\n4174: \n4175: $$",
      "metadata": {
        "label": "lem-fisher-bound"
      },
      "section": "## 2. Log-Sobolev Inequality for the QSD",
      "raw_directive": "4156: **Simplified bound** (sufficient for hypocoercivity):\n4157: \n4158: :::{prf:lemma} Fisher Information Bound\n4159: :label: lem-fisher-bound\n4160: \n4161: There exists a constant $c_F > 0$ such that:\n4162: \n4163: $$\n4164: I_v(\\rho) \\ge c_F I_v(\\rho \\| \\rho_\\infty) - C_{\\text{rem}}\n4165: \n4166: $$\n4167: \n4168: where $c_F = 1/2$ and $C_{\\text{rem}} = 4C_{\\nabla v}^2$.\n4169: \n4170: Consequently:\n4171: \n4172: $$\n4173: \\boxed{I_v(\\rho) \\ge 2\\lambda_{\\text{LSI}} D_{\\text{KL}}(\\rho \\| \\rho_\\infty) - C_{\\text{LSI}}}\n4174: \n4175: $$\n4176: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 28,
        "chapter_file": "chapter_28.json",
        "section_id": "## 2. Log-Sobolev Inequality for the QSD"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-kinetic-energy-bound",
      "title": "Kinetic Energy Control",
      "start_line": 4247,
      "end_line": 4258,
      "header_lines": [
        4248
      ],
      "content_start": 4250,
      "content_end": 4257,
      "content": "4250: :label: lem-kinetic-energy-bound\n4251: \n4252: The kinetic energy is controlled by the velocity Fisher information and KL divergence:\n4253: \n4254: $$\n4255: E_v[\\rho] \\le E_v[\\rho_\\infty] + C_v D_{\\text{KL}}(\\rho \\| \\rho_\\infty) + \\frac{C_v'}{\\gamma} I_v(\\rho)\n4256: \n4257: $$",
      "metadata": {
        "label": "lem-kinetic-energy-bound"
      },
      "section": "## 3. Bounding Coupling and Remainder Terms",
      "raw_directive": "4247: **Lemma (Kinetic energy bound)**:\n4248: \n4249: :::{prf:lemma} Kinetic Energy Control\n4250: :label: lem-kinetic-energy-bound\n4251: \n4252: The kinetic energy is controlled by the velocity Fisher information and KL divergence:\n4253: \n4254: $$\n4255: E_v[\\rho] \\le E_v[\\rho_\\infty] + C_v D_{\\text{KL}}(\\rho \\| \\rho_\\infty) + \\frac{C_v'}{\\gamma} I_v(\\rho)\n4256: \n4257: $$\n4258: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 29,
        "chapter_file": "chapter_29.json",
        "section_id": "## 3. Bounding Coupling and Remainder Terms"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-entropy-l1-bound",
      "title": "Entropy $L^1$ Bound",
      "start_line": 4453,
      "end_line": 4464,
      "header_lines": [
        4454
      ],
      "content_start": 4456,
      "content_end": 4463,
      "content": "4456: :label: lem-entropy-l1-bound\n4457: \n4458: For any $\\rho, \\rho_\\infty \\in \\mathcal{P}(\\Omega)$:\n4459: \n4460: $$\n4461: \\int \\rho \\left|\\log \\frac{\\rho}{\\rho_\\infty}\\right| \\le 2 D_{\\text{KL}}(\\rho \\| \\rho_\\infty) + C_{\\text{const}}\n4462: \n4463: $$",
      "metadata": {
        "label": "lem-entropy-l1-bound"
      },
      "section": "## 4. Bounding the Jump Expansion",
      "raw_directive": "4453: **Lemma (Entropy moment bound)**:\n4454: \n4455: :::{prf:lemma} Entropy $L^1$ Bound\n4456: :label: lem-entropy-l1-bound\n4457: \n4458: For any $\\rho, \\rho_\\infty \\in \\mathcal{P}(\\Omega)$:\n4459: \n4460: $$\n4461: \\int \\rho \\left|\\log \\frac{\\rho}{\\rho_\\infty}\\right| \\le 2 D_{\\text{KL}}(\\rho \\| \\rho_\\infty) + C_{\\text{const}}\n4462: \n4463: $$\n4464: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 30,
        "chapter_file": "chapter_30.json",
        "section_id": "## 4. Bounding the Jump Expansion"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-wasserstein-revival",
      "title": "Wasserstein Contraction for Proportional Resampling (Conjecture)",
      "start_line": 726,
      "end_line": 738,
      "header_lines": [
        727
      ],
      "content_start": 729,
      "content_end": 737,
      "content": "729: :label: lem-wasserstein-revival\n730: \n731: If $\\mathcal{R}$ is viewed as resampling from $\\tilde{\\rho} = \\rho / \\|\\rho\\|_{L^1}$, then:\n732: \n733: $$\n734: W_2(\\mathcal{R}(\\rho), \\mathcal{R}(\\sigma)) \\le \\lambda (1-m) W_2(\\tilde{\\rho}, \\tilde{\\sigma})\n735: $$\n736: \n737: for some average dead mass $m \\approx (m_\\rho + m_\\sigma)/2$.",
      "metadata": {
        "label": "lem-wasserstein-revival"
      },
      "section": "## 3. Direct Proof Attempts",
      "raw_directive": "726: **Modified approach**: View $\\mathcal{R}$ as a **Markov kernel** (resampling) and use the Kantorovich duality for random maps.\n727: \n728: :::{prf:lemma} Wasserstein Contraction for Proportional Resampling (Conjecture)\n729: :label: lem-wasserstein-revival\n730: \n731: If $\\mathcal{R}$ is viewed as resampling from $\\tilde{\\rho} = \\rho / \\|\\rho\\|_{L^1}$, then:\n732: \n733: $$\n734: W_2(\\mathcal{R}(\\rho), \\mathcal{R}(\\sigma)) \\le \\lambda (1-m) W_2(\\tilde{\\rho}, \\tilde{\\sigma})\n735: $$\n736: \n737: for some average dead mass $m \\approx (m_\\rho + m_\\sigma)/2$.\n738: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 3. Direct Proof Attempts"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hormander",
      "title": "Hörmander's Condition",
      "start_line": 1381,
      "end_line": 1392,
      "header_lines": [
        1382
      ],
      "content_start": 1384,
      "content_end": 1391,
      "content": "1384: :label: lem-hormander\n1385: \n1386: The kinetic operator $\\mathcal{L}_{\\text{kin}}$ satisfies Hörmander's bracket condition:\n1387: \n1388: The vector fields:\n1389: $$\n1390: X_0 = v \\cdot \\nabla_x - \\nabla_x U \\cdot \\nabla_v - \\gamma v \\cdot \\nabla_v, \\quad X_j = \\sigma \\frac{\\partial}{\\partial v_j}\n1391: $$",
      "metadata": {
        "label": "lem-hormander"
      },
      "section": "## 2. Smoothness and Positivity (R2, R3)",
      "raw_directive": "1381: The key to proving $\\rho_\\infty \\in C^2$ is the **hypoelliptic** nature of $\\mathcal{L}_{\\text{kin}}$.\n1382: \n1383: :::{prf:lemma} Hörmander's Condition\n1384: :label: lem-hormander\n1385: \n1386: The kinetic operator $\\mathcal{L}_{\\text{kin}}$ satisfies Hörmander's bracket condition:\n1387: \n1388: The vector fields:\n1389: $$\n1390: X_0 = v \\cdot \\nabla_x - \\nabla_x U \\cdot \\nabla_v - \\gamma v \\cdot \\nabla_v, \\quad X_j = \\sigma \\frac{\\partial}{\\partial v_j}\n1391: $$\n1392: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 16,
        "chapter_file": "chapter_16.json",
        "section_id": "## 2. Smoothness and Positivity (R2, R3)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-irreducibility",
      "title": "Irreducibility",
      "start_line": 1447,
      "end_line": 1457,
      "header_lines": [
        1448
      ],
      "content_start": 1450,
      "content_end": 1456,
      "content": "1450: :label: lem-irreducibility\n1451: \n1452: The Markov process $(X_t, V_t)$ generated by $\\mathcal{L}$ (with revival) is **irreducible**: for any two open sets $A, B \\subset \\Omega$ and any initial point $(x_0, v_0) \\in A$, there exists $t > 0$ such that:\n1453: \n1454: $$\n1455: \\mathbb{P}_{(x_0,v_0)}[(X_t, V_t) \\in B] > 0\n1456: $$",
      "metadata": {
        "label": "lem-irreducibility"
      },
      "section": "## 2. Smoothness and Positivity (R2, R3)",
      "raw_directive": "1447: #### Step 1: Irreducibility of the Process\n1448: \n1449: :::{prf:lemma} Irreducibility\n1450: :label: lem-irreducibility\n1451: \n1452: The Markov process $(X_t, V_t)$ generated by $\\mathcal{L}$ (with revival) is **irreducible**: for any two open sets $A, B \\subset \\Omega$ and any initial point $(x_0, v_0) \\in A$, there exists $t > 0$ such that:\n1453: \n1454: $$\n1455: \\mathbb{P}_{(x_0,v_0)}[(X_t, V_t) \\in B] > 0\n1456: $$\n1457: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 16,
        "chapter_file": "chapter_16.json",
        "section_id": "## 2. Smoothness and Positivity (R2, R3)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-strong-max-principle",
      "title": "Strong Maximum Principle",
      "start_line": 1491,
      "end_line": 1497,
      "header_lines": [
        1492
      ],
      "content_start": 1494,
      "content_end": 1496,
      "content": "1494: :label: lem-strong-max-principle\n1495: \n1496: Let $\\rho$ satisfy $\\mathcal{L}[\\rho] = 0$ with $\\rho \\ge 0$ and $\\|\\rho\\|_{L^1} > 0$. If the process is irreducible, then either:",
      "metadata": {
        "label": "lem-strong-max-principle"
      },
      "section": "## 2. Smoothness and Positivity (R2, R3)",
      "raw_directive": "1491: #### Step 2: Strong Maximum Principle for Irreducible Processes\n1492: \n1493: :::{prf:lemma} Strong Maximum Principle\n1494: :label: lem-strong-max-principle\n1495: \n1496: Let $\\rho$ satisfy $\\mathcal{L}[\\rho] = 0$ with $\\rho \\ge 0$ and $\\|\\rho\\|_{L^1} > 0$. If the process is irreducible, then either:\n1497: 1. $\\rho(x,v) > 0$ for all $(x,v) \\in \\Omega$, OR",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 16,
        "chapter_file": "chapter_16.json",
        "section_id": "## 2. Smoothness and Positivity (R2, R3)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-drift-condition-corrected",
      "title": "Drift Condition with Quadratic Lyapunov",
      "start_line": 2085,
      "end_line": 2101,
      "header_lines": [
        2086
      ],
      "content_start": 2088,
      "content_end": 2100,
      "content": "2088: :label: lem-drift-condition-corrected\n2089: \n2090: Under Assumptions A1 (confinement) and A3 (friction), there exist constants $a, b, c > 0$ such that the quadratic Lyapunov function:\n2091: \n2092: $$\n2093: V(x,v) = a|x|^2 + 2b x \\cdot v + c|v|^2\n2094: $$\n2095: \n2096: satisfies a drift condition with respect to the **adjoint operator** $\\mathcal{L}^*$:\n2097: \n2098: $$\n2099: \\mathcal{L}^*[V] \\le -\\beta V + C\n2100: $$",
      "metadata": {
        "label": "lem-drift-condition-corrected"
      },
      "section": "## 4. Exponential Concentration (R6)",
      "raw_directive": "2085: Moreover, the simple Lyapunov $V = |x|^2 + |v|^2$ does NOT satisfy a drift condition due to the cross-term $x \\cdot v$. We need a **quadratic form** that handles this coupling.\n2086: \n2087: :::{prf:lemma} Drift Condition with Quadratic Lyapunov\n2088: :label: lem-drift-condition-corrected\n2089: \n2090: Under Assumptions A1 (confinement) and A3 (friction), there exist constants $a, b, c > 0$ such that the quadratic Lyapunov function:\n2091: \n2092: $$\n2093: V(x,v) = a|x|^2 + 2b x \\cdot v + c|v|^2\n2094: $$\n2095: \n2096: satisfies a drift condition with respect to the **adjoint operator** $\\mathcal{L}^*$:\n2097: \n2098: $$\n2099: \\mathcal{L}^*[V] \\le -\\beta V + C\n2100: $$\n2101: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 18,
        "chapter_file": "chapter_18.json",
        "section_id": "## 4. Exponential Concentration (R6)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-fisher-bound",
      "title": "Fisher Information Bound",
      "start_line": 3527,
      "end_line": 3545,
      "header_lines": [
        3528
      ],
      "content_start": 3530,
      "content_end": 3544,
      "content": "3530: :label: lem-fisher-bound\n3531: \n3532: There exists a constant $c_F > 0$ such that:\n3533: \n3534: $$\n3535: I_v(\\rho) \\ge c_F I_v(\\rho \\| \\rho_\\infty) - C_{\\text{rem}}\n3536: $$\n3537: \n3538: where $c_F = 1/2$ and $C_{\\text{rem}} = 4C_{\\nabla v}^2$.\n3539: \n3540: Consequently:\n3541: \n3542: $$\n3543: \\boxed{I_v(\\rho) \\ge 2\\lambda_{\\text{LSI}} D_{\\text{KL}}(\\rho \\| \\rho_\\infty) - C_{\\text{LSI}}}\n3544: $$",
      "metadata": {
        "label": "lem-fisher-bound"
      },
      "section": "## 2. Log-Sobolev Inequality for the QSD",
      "raw_directive": "3527: **Simplified bound** (sufficient for hypocoercivity):\n3528: \n3529: :::{prf:lemma} Fisher Information Bound\n3530: :label: lem-fisher-bound\n3531: \n3532: There exists a constant $c_F > 0$ such that:\n3533: \n3534: $$\n3535: I_v(\\rho) \\ge c_F I_v(\\rho \\| \\rho_\\infty) - C_{\\text{rem}}\n3536: $$\n3537: \n3538: where $c_F = 1/2$ and $C_{\\text{rem}} = 4C_{\\nabla v}^2$.\n3539: \n3540: Consequently:\n3541: \n3542: $$\n3543: \\boxed{I_v(\\rho) \\ge 2\\lambda_{\\text{LSI}} D_{\\text{KL}}(\\rho \\| \\rho_\\infty) - C_{\\text{LSI}}}\n3544: $$\n3545: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 28,
        "chapter_file": "chapter_28.json",
        "section_id": "## 2. Log-Sobolev Inequality for the QSD"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-kinetic-energy-bound",
      "title": "Kinetic Energy Control",
      "start_line": 3608,
      "end_line": 3618,
      "header_lines": [
        3609
      ],
      "content_start": 3611,
      "content_end": 3617,
      "content": "3611: :label: lem-kinetic-energy-bound\n3612: \n3613: The kinetic energy is controlled by the velocity Fisher information and KL divergence:\n3614: \n3615: $$\n3616: E_v[\\rho] \\le E_v[\\rho_\\infty] + C_v D_{\\text{KL}}(\\rho \\| \\rho_\\infty) + \\frac{C_v'}{\\gamma} I_v(\\rho)\n3617: $$",
      "metadata": {
        "label": "lem-kinetic-energy-bound"
      },
      "section": "## 3. Bounding Coupling and Remainder Terms",
      "raw_directive": "3608: **Lemma (Kinetic energy bound)**:\n3609: \n3610: :::{prf:lemma} Kinetic Energy Control\n3611: :label: lem-kinetic-energy-bound\n3612: \n3613: The kinetic energy is controlled by the velocity Fisher information and KL divergence:\n3614: \n3615: $$\n3616: E_v[\\rho] \\le E_v[\\rho_\\infty] + C_v D_{\\text{KL}}(\\rho \\| \\rho_\\infty) + \\frac{C_v'}{\\gamma} I_v(\\rho)\n3617: $$\n3618: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 29,
        "chapter_file": "chapter_29.json",
        "section_id": "## 3. Bounding Coupling and Remainder Terms"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-entropy-l1-bound",
      "title": "Entropy $L^1$ Bound",
      "start_line": 3789,
      "end_line": 3799,
      "header_lines": [
        3790
      ],
      "content_start": 3792,
      "content_end": 3798,
      "content": "3792: :label: lem-entropy-l1-bound\n3793: \n3794: For any $\\rho, \\rho_\\infty \\in \\mathcal{P}(\\Omega)$:\n3795: \n3796: $$\n3797: \\int \\rho \\left|\\log \\frac{\\rho}{\\rho_\\infty}\\right| \\le 2 D_{\\text{KL}}(\\rho \\| \\rho_\\infty) + C_{\\text{const}}\n3798: $$",
      "metadata": {
        "label": "lem-entropy-l1-bound"
      },
      "section": "## 4. Bounding the Jump Expansion",
      "raw_directive": "3789: **Lemma (Entropy moment bound)**:\n3790: \n3791: :::{prf:lemma} Entropy $L^1$ Bound\n3792: :label: lem-entropy-l1-bound\n3793: \n3794: For any $\\rho, \\rho_\\infty \\in \\mathcal{P}(\\Omega)$:\n3795: \n3796: $$\n3797: \\int \\rho \\left|\\log \\frac{\\rho}{\\rho_\\infty}\\right| \\le 2 D_{\\text{KL}}(\\rho \\| \\rho_\\infty) + C_{\\text{const}}\n3798: $$\n3799: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "16_convergence_mean_field",
        "chapter_index": 30,
        "chapter_file": "chapter_30.json",
        "section_id": "## 4. Bounding the Jump Expansion"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-conditional-multivariate-gaussian-geometric",
      "title": "Conditional Velocity Distribution - Multivariate Gaussian (Geometric Gas)",
      "start_line": 39,
      "end_line": 57,
      "header_lines": [
        40
      ],
      "content_start": 42,
      "content_end": 56,
      "content": "42: :label: lem-conditional-multivariate-gaussian-geometric\n43: \n44: For the QSD $\\pi_N$ of the Geometric Gas, the conditional distribution of velocities given positions is a **multivariate Gaussian** (not a product):\n45: \n46: $$\n47: \\pi_N(\\mathbf{v} | \\mathbf{x}) = \\mathcal{N}(0, \\Sigma_{\\mathbf{v}}(\\mathbf{x}))\n48: $$\n49: \n50: where the covariance matrix $\\Sigma_{\\mathbf{v}}(\\mathbf{x}) \\in \\mathbb{R}^{3N \\times 3N}$ is the solution to the continuous Lyapunov equation:\n51: \n52: $$\n53: A(\\mathbf{x}) \\Sigma_{\\mathbf{v}}(\\mathbf{x}) + \\Sigma_{\\mathbf{v}}(\\mathbf{x}) A(\\mathbf{x})^T = B(\\mathbf{x}) B(\\mathbf{x})^T\n54: $$\n55: \n56: where:",
      "metadata": {
        "label": "lem-conditional-multivariate-gaussian-geometric"
      },
      "section": "## 2. Conditional Velocity Distribution with Viscous Coupling",
      "raw_directive": "39: ### 2.1. Multivariate Gaussian Structure\n40: \n41: :::{prf:lemma} Conditional Velocity Distribution - Multivariate Gaussian (Geometric Gas)\n42: :label: lem-conditional-multivariate-gaussian-geometric\n43: \n44: For the QSD $\\pi_N$ of the Geometric Gas, the conditional distribution of velocities given positions is a **multivariate Gaussian** (not a product):\n45: \n46: $$\n47: \\pi_N(\\mathbf{v} | \\mathbf{x}) = \\mathcal{N}(0, \\Sigma_{\\mathbf{v}}(\\mathbf{x}))\n48: $$\n49: \n50: where the covariance matrix $\\Sigma_{\\mathbf{v}}(\\mathbf{x}) \\in \\mathbb{R}^{3N \\times 3N}$ is the solution to the continuous Lyapunov equation:\n51: \n52: $$\n53: A(\\mathbf{x}) \\Sigma_{\\mathbf{v}}(\\mathbf{x}) + \\Sigma_{\\mathbf{v}}(\\mathbf{x}) A(\\mathbf{x})^T = B(\\mathbf{x}) B(\\mathbf{x})^T\n54: $$\n55: \n56: where:\n57: - $A(\\mathbf{x}) = \\gamma I_{3N} + \\nu \\mathcal{L}_{\\text{norm}}(\\mathbf{x}) \\otimes I_3$ is the drift matrix (friction + viscous coupling)",
      "_registry_context": {
        "stage": "directives",
        "document_id": "17_qsd_exchangeability_geometric",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Conditional Velocity Distribution with Viscous Coupling"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-eigenvalue-bound-geometric",
      "title": "N-Uniform Eigenvalue Bound for Conditional Covariance (Geometric Gas)",
      "start_line": 111,
      "end_line": 121,
      "header_lines": [
        112
      ],
      "content_start": 114,
      "content_end": 120,
      "content": "114: :label: lem-eigenvalue-bound-geometric\n115: \n116: For fixed positions $\\mathbf{x}$, the largest eigenvalue of the conditional velocity covariance satisfies:\n117: \n118: $$\n119: \\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x})) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma}\n120: $$",
      "metadata": {
        "label": "lem-eigenvalue-bound-geometric"
      },
      "section": "## 3. N-Uniform Eigenvalue Bound via Lyapunov Comparison",
      "raw_directive": "111: ### 3.1. Main Result\n112: \n113: :::{prf:lemma} N-Uniform Eigenvalue Bound for Conditional Covariance (Geometric Gas)\n114: :label: lem-eigenvalue-bound-geometric\n115: \n116: For fixed positions $\\mathbf{x}$, the largest eigenvalue of the conditional velocity covariance satisfies:\n117: \n118: $$\n119: \\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x})) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma}\n120: $$\n121: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "17_qsd_exchangeability_geometric",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. N-Uniform Eigenvalue Bound via Lyapunov Comparison"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-ito-correction-bound",
      "title": "Itô Correction Term Bound",
      "start_line": 943,
      "end_line": 965,
      "header_lines": [
        944
      ],
      "content_start": 946,
      "content_end": 964,
      "content": "946: :label: lem-ito-correction-bound\n947: \n948: For the kinetic SDE with adaptive diffusion (Definition [](#def-d-kinetic-operator-adaptive)), the Itô correction term in the drift is:\n949: \n950: $$\n951: b_{\\text{correction}}(x, v, S) = \\frac{1}{2}\\sum_{j=1}^d \\left( D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S) \\right) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\n952: $$\n953: \n954: where $\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ is the $j$-th column of $\\Sigma_{\\text{reg}}$ and $D_x$ is the Jacobian with respect to $x$.\n955: \n956: This term satisfies the bound:\n957: \n958: $$\n959: \\|b_{\\text{correction}}(x, v, S)\\| \\le C_{\\text{Itô}} := \\frac{1}{2} d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n960: $$\n961: \n962: where:\n963: - $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is the supremum of the operator norm of the Jacobian of $\\Sigma_{\\text{reg}}$ over the state space\n964: - $c_{\\max}^{1/2} = 1/\\sqrt{\\epsilon_\\Sigma}$ is the upper bound on $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}}$",
      "metadata": {
        "label": "lem-ito-correction-bound"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "943: Before proving the drift inequalities, we must analyze the **Itô correction term** that arises from the state-dependent diffusion tensor.\n944: \n945: :::{prf:lemma} Itô Correction Term Bound\n946: :label: lem-ito-correction-bound\n947: \n948: For the kinetic SDE with adaptive diffusion (Definition [](#def-d-kinetic-operator-adaptive)), the Itô correction term in the drift is:\n949: \n950: $$\n951: b_{\\text{correction}}(x, v, S) = \\frac{1}{2}\\sum_{j=1}^d \\left( D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S) \\right) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\n952: $$\n953: \n954: where $\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ is the $j$-th column of $\\Sigma_{\\text{reg}}$ and $D_x$ is the Jacobian with respect to $x$.\n955: \n956: This term satisfies the bound:\n957: \n958: $$\n959: \\|b_{\\text{correction}}(x, v, S)\\| \\le C_{\\text{Itô}} := \\frac{1}{2} d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n960: $$\n961: \n962: where:\n963: - $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is the supremum of the operator norm of the Jacobian of $\\Sigma_{\\text{reg}}$ over the state space\n964: - $c_{\\max}^{1/2} = 1/\\sqrt{\\epsilon_\\Sigma}$ is the upper bound on $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}}$\n965: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Anisotropic Kinetic Operator Analysis"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-companion-flux-balance",
      "title": "Companion Flux Balance at QSD",
      "start_line": 3829,
      "end_line": 3847,
      "header_lines": [
        3830
      ],
      "content_start": 3832,
      "content_end": 3846,
      "content": "3832: :label: lem-companion-flux-balance\n3833: \n3834: At the quasi-stationary distribution (QSD), the companion selection flux satisfies a geometric balance condition. For any walker $i$ in the alive set:\n3835: \n3836: $$\n3837: \\sum_{j \\in \\mathcal{A}, j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) = p_i(S) \\cdot \\sqrt{\\frac{\\det g(x_i)}{\\langle \\det g \\rangle}}\n3838: $$\n3839: \n3840: where:\n3841: - $P_{\\text{comp}}(i|j; S) \\propto 1/d_{\\text{alg}}(j,i)^{2+\\nu}$ is the companion selection probability\n3842: - $p_i(S) = \\mathbb{E}_{c \\sim P_{\\text{comp}}}[\\text{clip}(S_i(c)/p_{\\max})]$ is the cloning probability\n3843: - $g(x_i)$ is the emergent Riemannian metric at position $x_i$\n3844: - $\\langle \\det g \\rangle = \\frac{1}{|\\mathcal{A}|}\\sum_{k \\in \\mathcal{A}} \\sqrt{\\det g(x_k)}$ is the mean metric determinant\n3845: \n3846: **Physical interpretation**: The left side is the **rate at which walker $i$ is selected as a companion** by all other walkers. The right side is the **rate at which walker $i$ selects companions**, weighted by the local geometric volume factor $\\sqrt{\\det g(x_i)}$.",
      "metadata": {
        "label": "lem-companion-flux-balance"
      },
      "section": "## 13. Companion Selection Flux Balance at Stationarity",
      "raw_directive": "3829: This section proves a critical result connecting the microscopic companion selection dynamics to the emergent Riemannian geometry at the quasi-stationary distribution (QSD).\n3830: \n3831: :::{prf:lemma} Companion Flux Balance at QSD\n3832: :label: lem-companion-flux-balance\n3833: \n3834: At the quasi-stationary distribution (QSD), the companion selection flux satisfies a geometric balance condition. For any walker $i$ in the alive set:\n3835: \n3836: $$\n3837: \\sum_{j \\in \\mathcal{A}, j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) = p_i(S) \\cdot \\sqrt{\\frac{\\det g(x_i)}{\\langle \\det g \\rangle}}\n3838: $$\n3839: \n3840: where:\n3841: - $P_{\\text{comp}}(i|j; S) \\propto 1/d_{\\text{alg}}(j,i)^{2+\\nu}$ is the companion selection probability\n3842: - $p_i(S) = \\mathbb{E}_{c \\sim P_{\\text{comp}}}[\\text{clip}(S_i(c)/p_{\\max})]$ is the cloning probability\n3843: - $g(x_i)$ is the emergent Riemannian metric at position $x_i$\n3844: - $\\langle \\det g \\rangle = \\frac{1}{|\\mathcal{A}|}\\sum_{k \\in \\mathcal{A}} \\sqrt{\\det g(x_k)}$ is the mean metric determinant\n3845: \n3846: **Physical interpretation**: The left side is the **rate at which walker $i$ is selected as a companion** by all other walkers. The right side is the **rate at which walker $i$ selects companions**, weighted by the local geometric volume factor $\\sqrt{\\det g(x_i)}$.\n3847: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## 13. Companion Selection Flux Balance at Stationarity"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-velocity-marginalization",
      "title": "Fast Velocity Thermalization Justifies Annealed Approximation",
      "start_line": 4088,
      "end_line": 4104,
      "header_lines": [
        4089
      ],
      "content_start": 4091,
      "content_end": 4103,
      "content": "4091: :label: lem-velocity-marginalization\n4092: \n4093: Consider the full Langevin dynamics on phase space $(x, v) \\in \\mathcal{X} \\times \\mathbb{R}^d$. Under the assumptions of geometric ergodicity (Chapter 4), there is a **timescale separation**:\n4094: \n4095: $$\n4096: \\tau_v \\ll \\tau_x\n4097: $$\n4098: \n4099: where:\n4100: - $\\tau_v \\sim \\gamma^{-1}$: Velocity thermalization time\n4101: - $\\tau_x \\sim \\epsilon_c^{-2}$: Spatial exploration time (diffusion)\n4102: \n4103: with $\\epsilon_c = \\sqrt{T/\\gamma}$ the thermal coherence length.",
      "metadata": {
        "label": "lem-velocity-marginalization"
      },
      "section": "## Appendix A: Supporting Theorems",
      "raw_directive": "4088: This lemma justifies treating velocities as thermalized on the timescale of spatial dynamics.\n4089: \n4090: :::{prf:lemma} Fast Velocity Thermalization Justifies Annealed Approximation\n4091: :label: lem-velocity-marginalization\n4092: \n4093: Consider the full Langevin dynamics on phase space $(x, v) \\in \\mathcal{X} \\times \\mathbb{R}^d$. Under the assumptions of geometric ergodicity (Chapter 4), there is a **timescale separation**:\n4094: \n4095: $$\n4096: \\tau_v \\ll \\tau_x\n4097: $$\n4098: \n4099: where:\n4100: - $\\tau_v \\sim \\gamma^{-1}$: Velocity thermalization time\n4101: - $\\tau_x \\sim \\epsilon_c^{-2}$: Spatial exploration time (diffusion)\n4102: \n4103: with $\\epsilon_c = \\sqrt{T/\\gamma}$ the thermal coherence length.\n4104: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix A: Supporting Theorems"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-companion-bias-riemannian",
      "title": "Continuum Limit via Saddle-Point Approximation",
      "start_line": 4142,
      "end_line": 4160,
      "header_lines": [
        4143
      ],
      "content_start": 4145,
      "content_end": 4159,
      "content": "4145: :label: lem-companion-bias-riemannian\n4146: \n4147: In the continuum limit $N \\to \\infty$ with the QSD spatial marginal given by Theorem {prf:ref}`thm-qsd-spatial-riemannian-volume`, the companion selection dynamics satisfy:\n4148: \n4149: $$\n4150: g(X) = \\prod_{i=1}^N \\sqrt{\\det g(x_i)} \\cdot \\left(1 + O(1/\\sqrt{N})\\right)\n4151: $$\n4152: \n4153: where $g(x)$ is the Riemannian metric tensor on the state space.\n4154: \n4155: **Consequence**: The corrected stationary distribution reduces to:\n4156: \n4157: $$\n4158: \\pi'(X) = \\frac{1}{Z'} \\prod_{i=1}^N \\left[\\sqrt{\\det g(x_i)} \\exp\\left(-\\beta H_{\\text{eff}}(x_i, v_i)\\right)\\right]\n4159: $$",
      "metadata": {
        "label": "lem-companion-bias-riemannian"
      },
      "section": "## Appendix A: Supporting Theorems",
      "raw_directive": "4142: This lemma connects the microscopic companion selection mechanism to the macroscopic Riemannian measure.\n4143: \n4144: :::{prf:lemma} Continuum Limit via Saddle-Point Approximation\n4145: :label: lem-companion-bias-riemannian\n4146: \n4147: In the continuum limit $N \\to \\infty$ with the QSD spatial marginal given by Theorem {prf:ref}`thm-qsd-spatial-riemannian-volume`, the companion selection dynamics satisfy:\n4148: \n4149: $$\n4150: g(X) = \\prod_{i=1}^N \\sqrt{\\det g(x_i)} \\cdot \\left(1 + O(1/\\sqrt{N})\\right)\n4151: $$\n4152: \n4153: where $g(x)$ is the Riemannian metric tensor on the state space.\n4154: \n4155: **Consequence**: The corrected stationary distribution reduces to:\n4156: \n4157: $$\n4158: \\pi'(X) = \\frac{1}{Z'} \\prod_{i=1}^N \\left[\\sqrt{\\det g(x_i)} \\exp\\left(-\\beta H_{\\text{eff}}(x_i, v_i)\\right)\\right]\n4159: $$\n4160: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix A: Supporting Theorems"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-telescoping-all-orders-cinf",
      "title": "Telescoping Identity at All Orders",
      "start_line": 429,
      "end_line": 447,
      "header_lines": [
        430
      ],
      "content_start": 432,
      "content_end": 446,
      "content": "432: :label: lem-telescoping-all-orders-cinf\n433: \n434: The normalized localization weights satisfy:\n435: \n436: $$\n437: \\sum_{j \\in A_k} \\nabla^m_{x_i} w_{ij}(\\rho) = 0 \\quad \\text{for all } m \\geq 1\n438: $$\n439: \n440: for all walker positions, swarm configurations, ρ > 0, and derivative orders m.\n441: \n442: **Proof**: The normalization ∑_{j ∈ A_k} w_ij(ρ) = 1 holds identically for all x_i ∈ X as a function of x_i. Since the sum is over a **finite set** A_k and each w_ij(ρ) is C∞ in x_i (Assumption {prf:ref}`assump-cinf-primitives`), differentiation and summation commute:\n443: \n444: $$\n445: \\nabla^m_{x_i} \\left(\\sum_{j \\in A_k} w_{ij}(\\rho)\\right) = \\sum_{j \\in A_k} \\nabla^m_{x_i} w_{ij}(\\rho) = \\nabla^m_{x_i}(1) = 0\n446: $$",
      "metadata": {
        "label": "lem-telescoping-all-orders-cinf"
      },
      "section": "## 5. Inductive Step: From C^m to C^{m+1}",
      "raw_directive": "429: We now prove the inductive step: assuming V_fit ∈ C^m with bound K_{V,m}(ρ), we prove V_fit ∈ C^{m+1} with bound K_{V,m+1}(ρ).\n430: \n431: :::{prf:lemma} Telescoping Identity at All Orders\n432: :label: lem-telescoping-all-orders-cinf\n433: \n434: The normalized localization weights satisfy:\n435: \n436: $$\n437: \\sum_{j \\in A_k} \\nabla^m_{x_i} w_{ij}(\\rho) = 0 \\quad \\text{for all } m \\geq 1\n438: $$\n439: \n440: for all walker positions, swarm configurations, ρ > 0, and derivative orders m.\n441: \n442: **Proof**: The normalization ∑_{j ∈ A_k} w_ij(ρ) = 1 holds identically for all x_i ∈ X as a function of x_i. Since the sum is over a **finite set** A_k and each w_ij(ρ) is C∞ in x_i (Assumption {prf:ref}`assump-cinf-primitives`), differentiation and summation commute:\n443: \n444: $$\n445: \\nabla^m_{x_i} \\left(\\sum_{j \\in A_k} w_{ij}(\\rho)\\right) = \\sum_{j \\in A_k} \\nabla^m_{x_i} w_{ij}(\\rho) = \\nabla^m_{x_i}(1) = 0\n446: $$\n447: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "19_geometric_gas_cinf_regularity_simplified",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Inductive Step: From C^m to C^{m+1}"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mean-cinf-inductive",
      "title": "C^{m+1} Regularity of Localized Mean",
      "start_line": 449,
      "end_line": 487,
      "header_lines": [
        450
      ],
      "content_start": 452,
      "content_end": 486,
      "content": "452: :label: lem-mean-cinf-inductive\n453: \n454: Assume weights w_ij(ρ) are C^{m+1} in x_i with ||∇^{m+1} w_ij|| ≤ W_{m+1}(ρ). Then the localized mean μ_ρ[f_k, x_i] is C^{m+1} with:\n455: \n456: $$\n457: \\|\\nabla^{m+1}_{x_i} \\mu_\\rho\\| \\leq W_{m+1}(\\rho) \\cdot \\text{diam}(d)\n458: $$\n459: \n460: independent of k and N, where diam(d) = sup_{x,y ∈ X} |d(x) - d(y)| < ∞.\n461: \n462: **Proof**: For the simplified model where d depends only on x_j (not x_i for j ≠ i):\n463: \n464: $$\n465: \\mu_\\rho = \\sum_{j \\in A_k} w_{ij}(\\rho) \\cdot d(x_j)\n466: $$\n467: \n468: Differentiating (m+1) times:\n469: \n470: $$\n471: \\nabla^{m+1}_{x_i} \\mu_\\rho = \\sum_{j \\in A_k} \\nabla^{m+1}_{x_i} w_{ij}(\\rho) \\cdot d(x_j)\n472: $$\n473: \n474: (Terms with ∇_{x_i} d(x_j) vanish for j ≠ i in the simplified model.)\n475: \n476: Apply telescoping ({prf:ref}`lem-telescoping-all-orders-cinf`):\n477: \n478: $$\n479: = \\sum_{j \\in A_k} \\nabla^{m+1} w_{ij} \\cdot (d(x_j) - \\mu_\\rho)\n480: $$\n481: \n482: Taking norms:\n483: \n484: $$\n485: \\|\\nabla^{m+1} \\mu_\\rho\\| \\leq \\sum_j \\|\\nabla^{m+1} w_{ij}\\| \\cdot |d(x_j) - \\mu_\\rho| \\leq W_{m+1}(\\rho) \\cdot \\text{diam}(d)\n486: $$",
      "metadata": {
        "label": "lem-mean-cinf-inductive"
      },
      "section": "## 5. Inductive Step: From C^m to C^{m+1}",
      "raw_directive": "449: :::\n450: \n451: :::{prf:lemma} C^{m+1} Regularity of Localized Mean\n452: :label: lem-mean-cinf-inductive\n453: \n454: Assume weights w_ij(ρ) are C^{m+1} in x_i with ||∇^{m+1} w_ij|| ≤ W_{m+1}(ρ). Then the localized mean μ_ρ[f_k, x_i] is C^{m+1} with:\n455: \n456: $$\n457: \\|\\nabla^{m+1}_{x_i} \\mu_\\rho\\| \\leq W_{m+1}(\\rho) \\cdot \\text{diam}(d)\n458: $$\n459: \n460: independent of k and N, where diam(d) = sup_{x,y ∈ X} |d(x) - d(y)| < ∞.\n461: \n462: **Proof**: For the simplified model where d depends only on x_j (not x_i for j ≠ i):\n463: \n464: $$\n465: \\mu_\\rho = \\sum_{j \\in A_k} w_{ij}(\\rho) \\cdot d(x_j)\n466: $$\n467: \n468: Differentiating (m+1) times:\n469: \n470: $$\n471: \\nabla^{m+1}_{x_i} \\mu_\\rho = \\sum_{j \\in A_k} \\nabla^{m+1}_{x_i} w_{ij}(\\rho) \\cdot d(x_j)\n472: $$\n473: \n474: (Terms with ∇_{x_i} d(x_j) vanish for j ≠ i in the simplified model.)\n475: \n476: Apply telescoping ({prf:ref}`lem-telescoping-all-orders-cinf`):\n477: \n478: $$\n479: = \\sum_{j \\in A_k} \\nabla^{m+1} w_{ij} \\cdot (d(x_j) - \\mu_\\rho)\n480: $$\n481: \n482: Taking norms:\n483: \n484: $$\n485: \\|\\nabla^{m+1} \\mu_\\rho\\| \\leq \\sum_j \\|\\nabla^{m+1} w_{ij}\\| \\cdot |d(x_j) - \\mu_\\rho| \\leq W_{m+1}(\\rho) \\cdot \\text{diam}(d)\n486: $$\n487: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "19_geometric_gas_cinf_regularity_simplified",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Inductive Step: From C^m to C^{m+1}"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-cinf-inductive",
      "title": "C^{m+1} Regularity of Localized Variance",
      "start_line": 489,
      "end_line": 507,
      "header_lines": [
        490
      ],
      "content_start": 492,
      "content_end": 506,
      "content": "492: :label: lem-variance-cinf-inductive\n493: \n494: Under the same assumptions, σ²_ρ[f_k, x_i] is C^{m+1} with:\n495: \n496: $$\n497: \\|\\nabla^{m+1}_{x_i} \\sigma^2_\\rho\\| \\leq C_{\\text{var},m+1}(\\rho) \\cdot (\\text{diam}(d))^2\n498: $$\n499: \n500: where C_{var,m+1}(ρ) = O(W_{m+1}(ρ) + products of lower-order weight derivatives).\n501: \n502: **Proof sketch**: The variance σ²_ρ = ∑_j w_ij · (d(x_j) - μ_ρ)² involves products. Leibniz rule for (m+1)-th derivative yields terms like ∇^p w_ij · ∇^q((d - μ_ρ)²) for p + q = m+1. The highest-order term:\n503: \n504: $$\n505: \\nabla^{m+1} \\sigma^2_\\rho \\sim \\sum_j \\nabla^{m+1} w_{ij} \\cdot (d(x_j) - \\mu_\\rho)^2 + \\text{lower-order}\n506: $$",
      "metadata": {
        "label": "lem-variance-cinf-inductive"
      },
      "section": "## 5. Inductive Step: From C^m to C^{m+1}",
      "raw_directive": "489: :::\n490: \n491: :::{prf:lemma} C^{m+1} Regularity of Localized Variance\n492: :label: lem-variance-cinf-inductive\n493: \n494: Under the same assumptions, σ²_ρ[f_k, x_i] is C^{m+1} with:\n495: \n496: $$\n497: \\|\\nabla^{m+1}_{x_i} \\sigma^2_\\rho\\| \\leq C_{\\text{var},m+1}(\\rho) \\cdot (\\text{diam}(d))^2\n498: $$\n499: \n500: where C_{var,m+1}(ρ) = O(W_{m+1}(ρ) + products of lower-order weight derivatives).\n501: \n502: **Proof sketch**: The variance σ²_ρ = ∑_j w_ij · (d(x_j) - μ_ρ)² involves products. Leibniz rule for (m+1)-th derivative yields terms like ∇^p w_ij · ∇^q((d - μ_ρ)²) for p + q = m+1. The highest-order term:\n503: \n504: $$\n505: \\nabla^{m+1} \\sigma^2_\\rho \\sim \\sum_j \\nabla^{m+1} w_{ij} \\cdot (d(x_j) - \\mu_\\rho)^2 + \\text{lower-order}\n506: $$\n507: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "19_geometric_gas_cinf_regularity_simplified",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Inductive Step: From C^m to C^{m+1}"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-z-score-cinf-inductive",
      "title": "C^{m+1} Regularity of Z-Score",
      "start_line": 509,
      "end_line": 527,
      "header_lines": [
        510
      ],
      "content_start": 512,
      "content_end": 526,
      "content": "512: :label: lem-z-score-cinf-inductive\n513: \n514: Assume μ_ρ, σ²_ρ ∈ C^{m+1} and σ'_reg ∈ C∞ with σ'_reg ≥ ε_σ > 0. Then Z_ρ = (d(x_i) - μ_ρ) / σ'_reg(σ²_ρ) is C^{m+1} with:\n515: \n516: $$\n517: \\|\\nabla^{m+1}_{x_i} Z_\\rho\\| \\leq K_{Z,m+1}(\\rho)\n518: $$\n519: \n520: where K_{Z,m+1}(ρ) depends on C_d^{(m+1)}, ||∇^{m+1} μ_ρ||, ||∇^{m+1} σ²_ρ||, and bounds on σ'_reg and its derivatives.\n521: \n522: **Proof sketch**: Z_ρ = u/v where u = d(x_i) - μ_ρ, v = σ'_reg(σ²_ρ). Generalized quotient rule (Leibniz for division) yields:\n523: \n524: $$\n525: \\nabla^{m+1} Z_\\rho = \\sum \\text{(products of numerator/denominator derivatives up to order m+1)}\n526: $$",
      "metadata": {
        "label": "lem-z-score-cinf-inductive"
      },
      "section": "## 5. Inductive Step: From C^m to C^{m+1}",
      "raw_directive": "509: :::\n510: \n511: :::{prf:lemma} C^{m+1} Regularity of Z-Score\n512: :label: lem-z-score-cinf-inductive\n513: \n514: Assume μ_ρ, σ²_ρ ∈ C^{m+1} and σ'_reg ∈ C∞ with σ'_reg ≥ ε_σ > 0. Then Z_ρ = (d(x_i) - μ_ρ) / σ'_reg(σ²_ρ) is C^{m+1} with:\n515: \n516: $$\n517: \\|\\nabla^{m+1}_{x_i} Z_\\rho\\| \\leq K_{Z,m+1}(\\rho)\n518: $$\n519: \n520: where K_{Z,m+1}(ρ) depends on C_d^{(m+1)}, ||∇^{m+1} μ_ρ||, ||∇^{m+1} σ²_ρ||, and bounds on σ'_reg and its derivatives.\n521: \n522: **Proof sketch**: Z_ρ = u/v where u = d(x_i) - μ_ρ, v = σ'_reg(σ²_ρ). Generalized quotient rule (Leibniz for division) yields:\n523: \n524: $$\n525: \\nabla^{m+1} Z_\\rho = \\sum \\text{(products of numerator/denominator derivatives up to order m+1)}\n526: $$\n527: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "19_geometric_gas_cinf_regularity_simplified",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Inductive Step: From C^m to C^{m+1}"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-velocity-squashing-compact-domain-full",
      "title": "Velocity Squashing Ensures Compact Phase Space",
      "start_line": 618,
      "end_line": 637,
      "header_lines": [
        619
      ],
      "content_start": 621,
      "content_end": 636,
      "content": "621: :label: lem-velocity-squashing-compact-domain-full\n622: \n623: The Geometric Gas algorithmic velocity is defined via a smooth squashing map (see {prf:ref}`doc-02-euclidean-gas` §4.2):\n624: \n625: $$\n626: v_{\\text{alg}} = \\psi(v) = V_{\\max} \\cdot \\tanh(v / V_{\\max})\n627: $$\n628: \n629: where v is the dynamical velocity evolved by the kinetic operator.\n630: \n631: **Properties**:\n632: 1. **Boundedness**: ‖ψ(v)‖ < V_max for all v ∈ ℝ^d (compact image V = B(0, V_max))\n633: 2. **Smoothness**: ψ ∈ C^∞ with ‖∇^m ψ‖ ≤ C_ψ,m V_max^{1-m} (Gevrey-1)\n634: 3. **Near-identity**: ψ(v) ≈ v for ‖v‖ ≪ V_max (non-intrusive)\n635: \n636: **Consequence**: The phase space 𝒳 × V is compact (𝒳 is assumed compact, V is bounded by squashing).",
      "metadata": {
        "label": "lem-velocity-squashing-compact-domain-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "618: Each step depends only on previous steps. The assumption ρ_max is **explicit** and **validated for consistency**.\n619: \n620: :::{prf:lemma} Velocity Squashing Ensures Compact Phase Space\n621: :label: lem-velocity-squashing-compact-domain-full\n622: \n623: The Geometric Gas algorithmic velocity is defined via a smooth squashing map (see {prf:ref}`doc-02-euclidean-gas` §4.2):\n624: \n625: $$\n626: v_{\\text{alg}} = \\psi(v) = V_{\\max} \\cdot \\tanh(v / V_{\\max})\n627: $$\n628: \n629: where v is the dynamical velocity evolved by the kinetic operator.\n630: \n631: **Properties**:\n632: 1. **Boundedness**: ‖ψ(v)‖ < V_max for all v ∈ ℝ^d (compact image V = B(0, V_max))\n633: 2. **Smoothness**: ψ ∈ C^∞ with ‖∇^m ψ‖ ≤ C_ψ,m V_max^{1-m} (Gevrey-1)\n634: 3. **Near-identity**: ψ(v) ≈ v for ‖v‖ ≪ V_max (non-intrusive)\n635: \n636: **Consequence**: The phase space 𝒳 × V is compact (𝒳 is assumed compact, V is bounded by squashing).\n637: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-fokker-planck-density-bound-conservative-full",
      "title": "Fokker-Planck Density Bound from Lipschitz Drift (Conservative Case)",
      "start_line": 639,
      "end_line": 665,
      "header_lines": [
        640
      ],
      "content_start": 642,
      "content_end": 664,
      "content": "642: :label: lem-fokker-planck-density-bound-conservative-full\n643: \n644: Consider the **conservative** Fokker-Planck equation on compact phase space 𝒳 × V:\n645: \n646: $$\n647: \\frac{\\partial \\rho}{\\partial t} = -\\psi(v) \\cdot \\nabla_x \\rho + \\nabla_v \\cdot \\left(\\gamma v \\rho + \\nabla_x V_{\\text{fit}} \\cdot \\rho\\right) + \\gamma T \\Delta_v \\rho\n648: $$\n649: \n650: **Note**: This PDE does NOT include cloning source/sink terms. It describes the conservative Langevin dynamics.\n651: \n652: Assume:\n653: - V_fit has Lipschitz gradient: ‖∇_x V_fit‖ ≤ L_V (from C³ regularity, doc-13)\n654: - Velocity domain is compact: ‖v‖ ≤ V_max (from Lemma {prf:ref}`lem-velocity-squashing-compact-domain-full`)\n655: - Spatial domain 𝒳 is compact\n656: - Kinetic diffusion γT > 0 (non-degenerate)\n657: \n658: Then the invariant measure ρ_∞ (if it exists) satisfies:\n659: \n660: $$\n661: \\rho_{\\infty}(x,v) \\leq C_{\\text{FK}}(\\gamma, T, L_V, V_{\\max}, \\text{Vol}(\\mathcal{X})) < \\infty\n662: $$\n663: \n664: where C_FK is uniform over the compact domain.",
      "metadata": {
        "label": "lem-fokker-planck-density-bound-conservative-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "639: :::\n640: \n641: :::{prf:lemma} Fokker-Planck Density Bound from Lipschitz Drift (Conservative Case)\n642: :label: lem-fokker-planck-density-bound-conservative-full\n643: \n644: Consider the **conservative** Fokker-Planck equation on compact phase space 𝒳 × V:\n645: \n646: $$\n647: \\frac{\\partial \\rho}{\\partial t} = -\\psi(v) \\cdot \\nabla_x \\rho + \\nabla_v \\cdot \\left(\\gamma v \\rho + \\nabla_x V_{\\text{fit}} \\cdot \\rho\\right) + \\gamma T \\Delta_v \\rho\n648: $$\n649: \n650: **Note**: This PDE does NOT include cloning source/sink terms. It describes the conservative Langevin dynamics.\n651: \n652: Assume:\n653: - V_fit has Lipschitz gradient: ‖∇_x V_fit‖ ≤ L_V (from C³ regularity, doc-13)\n654: - Velocity domain is compact: ‖v‖ ≤ V_max (from Lemma {prf:ref}`lem-velocity-squashing-compact-domain-full`)\n655: - Spatial domain 𝒳 is compact\n656: - Kinetic diffusion γT > 0 (non-degenerate)\n657: \n658: Then the invariant measure ρ_∞ (if it exists) satisfies:\n659: \n660: $$\n661: \\rho_{\\infty}(x,v) \\leq C_{\\text{FK}}(\\gamma, T, L_V, V_{\\max}, \\text{Vol}(\\mathcal{X})) < \\infty\n662: $$\n663: \n664: where C_FK is uniform over the compact domain.\n665: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "verif-c3-independence-revised",
      "title": "QSD Density Bound with Cloning (Conditional Statement)",
      "start_line": 685,
      "end_line": 736,
      "header_lines": [
        686,
        709
      ],
      "content_start": 688,
      "content_end": 735,
      "content": "688: :label: lem-qsd-density-bound-with-cloning-full\n689: \n690: The Geometric Gas dynamics include cloning (birth-death process conditioned on alive set non-empty). The QSD satisfies:\n691: \n692: **Conditional result**: If the QSD π_QSD exists and is unique (established via Keystone Principle ergodicity), then under the following:\n693: \n694: 1. The **conservative** Fokker-Planck invariant measure has density bound ρ_FK ≤ C_FK (Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full`)\n695: 2. The cloning rate λ_clone is finite\n696: 3. The domain 𝒳 × V is compact (velocity squashing)\n697: \n698: The QSD density satisfies:\n699: \n700: $$\n701: \\rho_{\\text{QSD}}(x,v) \\leq C_{\\text{QSD}} \\cdot C_{\\text{FK}}\n702: $$\n703: \n704: where C_QSD depends on λ_clone and domain volume, but is **finite**.\n705: \n706: **Rigorous proof**: A complete proof requires analyzing the generator of the conditioned process (QSD generator = Fokker-Planck generator + cloning source/sink + ground state projection). This is subject of ongoing research in QSD theory for interacting particle systems (see Champagnat-Villemonais 2017, *Exponential convergence to quasi-stationary distribution*; Cloez-Thai 2018, *Quantitative results for QSD convergence*).\n707: \n708: **For this document**: We state ρ_max as an explicit assumption (Assumption {prf:ref}`assump-uniform-density-full`) below and validate consistency.\n709: \n710: :::{prf:verification} Independence of C³ Regularity Analysis\n711: :label: verif-c3-independence-revised\n712: \n713: To ensure the logical chain is non-circular, we verify that the C³ regularity proof in {prf:ref}`doc-13-geometric-gas-c3-regularity` uses only:\n714: \n715: **Allowed inputs**:\n716: 1. **Companion availability** (Lemma {prf:ref}`lem-companion-availability-enforcement`) - derived below from Keystone + volume\n717: 2. **Bounded measurements**: d_alg ≤ diam(𝒳 × V) < ∞ (from compact domain)\n718: 3. **Regularization**: ε_d > 0 eliminates singularities\n719: 4. **Rescale function**: g_A ∈ C³ with bounded derivatives\n720: 5. **Density bound**: ρ_max (now EXPLICITLY ASSUMED, see below)\n721: \n722: **Critically, doc-13 does NOT assume**:\n723: - ✗ C^∞ regularity\n724: - ✗ k-uniform bounds at all orders\n725: - ✗ Anything from this document (doc-20)\n726: \n727: **Verification method**: Direct inspection of doc-13 confirms only the above five inputs are used.\n728: \n729: **Conclusion**: The logical chain is:\n730: 1. **Companion availability** ← Keystone + volume (§2.4 below, NO density assumption)\n731: 2. **C³ regularity** ← Companion availability + **ρ_max assumption** + elementary bounds\n732: 3. **Lipschitz gradient L_V** ← C³\n733: 4. **Fokker-Planck bound C_FK** ← L_V + compact domain + velocity squashing\n734: 5. **Consistency check** ← C_FK(L_V(ρ_max)) should have fixed point ρ_max*\n735: 6. **C^∞ regularity** ← ρ_max* + C³ + advanced machinery (this document)",
      "metadata": {
        "label": "verif-c3-independence-revised"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "685: :::\n686: \n687: :::{prf:lemma} QSD Density Bound with Cloning (Conditional Statement)\n688: :label: lem-qsd-density-bound-with-cloning-full\n689: \n690: The Geometric Gas dynamics include cloning (birth-death process conditioned on alive set non-empty). The QSD satisfies:\n691: \n692: **Conditional result**: If the QSD π_QSD exists and is unique (established via Keystone Principle ergodicity), then under the following:\n693: \n694: 1. The **conservative** Fokker-Planck invariant measure has density bound ρ_FK ≤ C_FK (Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full`)\n695: 2. The cloning rate λ_clone is finite\n696: 3. The domain 𝒳 × V is compact (velocity squashing)\n697: \n698: The QSD density satisfies:\n699: \n700: $$\n701: \\rho_{\\text{QSD}}(x,v) \\leq C_{\\text{QSD}} \\cdot C_{\\text{FK}}\n702: $$\n703: \n704: where C_QSD depends on λ_clone and domain volume, but is **finite**.\n705: \n706: **Rigorous proof**: A complete proof requires analyzing the generator of the conditioned process (QSD generator = Fokker-Planck generator + cloning source/sink + ground state projection). This is subject of ongoing research in QSD theory for interacting particle systems (see Champagnat-Villemonais 2017, *Exponential convergence to quasi-stationary distribution*; Cloez-Thai 2018, *Quantitative results for QSD convergence*).\n707: \n708: **For this document**: We state ρ_max as an explicit assumption (Assumption {prf:ref}`assump-uniform-density-full`) below and validate consistency.\n709: \n710: :::{prf:verification} Independence of C³ Regularity Analysis\n711: :label: verif-c3-independence-revised\n712: \n713: To ensure the logical chain is non-circular, we verify that the C³ regularity proof in {prf:ref}`doc-13-geometric-gas-c3-regularity` uses only:\n714: \n715: **Allowed inputs**:\n716: 1. **Companion availability** (Lemma {prf:ref}`lem-companion-availability-enforcement`) - derived below from Keystone + volume\n717: 2. **Bounded measurements**: d_alg ≤ diam(𝒳 × V) < ∞ (from compact domain)\n718: 3. **Regularization**: ε_d > 0 eliminates singularities\n719: 4. **Rescale function**: g_A ∈ C³ with bounded derivatives\n720: 5. **Density bound**: ρ_max (now EXPLICITLY ASSUMED, see below)\n721: \n722: **Critically, doc-13 does NOT assume**:\n723: - ✗ C^∞ regularity\n724: - ✗ k-uniform bounds at all orders\n725: - ✗ Anything from this document (doc-20)\n726: \n727: **Verification method**: Direct inspection of doc-13 confirms only the above five inputs are used.\n728: \n729: **Conclusion**: The logical chain is:\n730: 1. **Companion availability** ← Keystone + volume (§2.4 below, NO density assumption)\n731: 2. **C³ regularity** ← Companion availability + **ρ_max assumption** + elementary bounds\n732: 3. **Lipschitz gradient L_V** ← C³\n733: 4. **Fokker-Planck bound C_FK** ← L_V + compact domain + velocity squashing\n734: 5. **Consistency check** ← C_FK(L_V(ρ_max)) should have fixed point ρ_max*\n735: 6. **C^∞ regularity** ← ρ_max* + C³ + advanced machinery (this document)\n736: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-companion-availability-enforcement",
      "title": "Partition Function Lower Bound from Compactness",
      "start_line": 814,
      "end_line": 830,
      "header_lines": [
        815
      ],
      "content_start": 817,
      "content_end": 829,
      "content": "817: :label: lem-companion-availability-enforcement\n818: \n819: For any walker $i \\in \\mathcal{A}$ in the alive set with $k \\geq 2$, the softmax partition function satisfies:\n820: \n821: $$\n822: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n823: \n824: $$\n825: \n826: where $D_{\\max} = \\text{diam}(\\mathcal{X} \\times V)$ is the phase-space diameter (finite by compactness).\n827: \n828: **Key properties**:\n829: 1. **Non-vanishing**: $Z_{\\min} > 0$ is strictly positive for all $i \\in \\mathcal{A}$",
      "metadata": {
        "label": "lem-companion-availability-enforcement"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "814: With the approach to the density bound clarified (explicit assumption with a posteriori validation, §2.3.5 above), we now state the three framework assumptions:\n815: \n816: :::{prf:lemma} Partition Function Lower Bound from Compactness\n817: :label: lem-companion-availability-enforcement\n818: \n819: For any walker $i \\in \\mathcal{A}$ in the alive set with $k \\geq 2$, the softmax partition function satisfies:\n820: \n821: $$\n822: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n823: \n824: $$\n825: \n826: where $D_{\\max} = \\text{diam}(\\mathcal{X} \\times V)$ is the phase-space diameter (finite by compactness).\n827: \n828: **Key properties**:\n829: 1. **Non-vanishing**: $Z_{\\min} > 0$ is strictly positive for all $i \\in \\mathcal{A}$\n830: 2. **k-uniform**: The bound depends only on domain diameter $D_{\\max}$ and parameter $\\varepsilon_c$, **not on the number of walkers** $k$ or $N$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-deterministic-packing-from-keystone-full",
      "title": "Deterministic Local Packing Bound from Keystone Ergodicity",
      "start_line": 889,
      "end_line": 916,
      "header_lines": [
        890
      ],
      "content_start": 892,
      "content_end": 915,
      "content": "892: :label: lem-deterministic-packing-from-keystone-full\n893: \n894: Under the Keystone Principle ({prf:ref}`doc-03-cloning`, Theorem 3.5) with kinetic diffusion (temperature $T > 0$, friction $\\gamma > 0$), the quasi-stationary distribution (QSD) satisfies a **deterministic uniform local packing bound**:\n895: \n896: For all swarm configurations $(x, v) \\in \\text{supp}(\\pi_{\\text{QSD}})$ in the support of the QSD, all walkers $i \\in \\mathcal{A}$, and all radii $r > 0$:\n897: \n898: $$\n899: \\#\\left\\{j \\in \\mathcal{A} : d_{\\text{alg}}(i,j) \\leq r\\right\\} \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(0, r))\n900: $$\n901: \n902: where:\n903: - $\\rho_{\\max} = C_{\\text{erg}}(\\gamma, T, A_{\\text{fit}}, \\text{Vol}(\\mathcal{X} \\times V))$ is a **deterministic constant** depending only on kinetic parameters and domain volume\n904: - $\\text{Vol}(B(0, r))$ is the phase-space volume of a ball of radius $r$ in the algorithmic metric\n905: - The bound holds **for all configurations**, not just with high probability\n906: \n907: **Key Properties**:\n908: 1. **Deterministic**: No probabilistic qualifier; holds on the entire QSD support\n909: 2. **k-uniform**: $\\rho_{\\max}$ is independent of the number of alive walkers $k$ or total swarm size $N$\n910: 3. **Universal**: Applies to all swarm configurations that have non-zero probability under the QSD\n911: \n912: **Physical Mechanism**: The deterministic packing bound arises from three synergistic mechanisms:\n913: 1. **Kinetic diffusion** ($T > 0$): Continuously injects random momentum, preventing walkers from remaining arbitrarily close\n914: 2. **Cloning diversity enforcement**: Preferentially removes walkers with low algorithmic diversity (those too close to companions)\n915: 3. **Keystone ergodicity**: Ensures pathological clustering states have measure zero in the QSD",
      "metadata": {
        "label": "lem-deterministic-packing-from-keystone-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "889: :::\n890: \n891: :::{prf:lemma} Deterministic Local Packing Bound from Keystone Ergodicity\n892: :label: lem-deterministic-packing-from-keystone-full\n893: \n894: Under the Keystone Principle ({prf:ref}`doc-03-cloning`, Theorem 3.5) with kinetic diffusion (temperature $T > 0$, friction $\\gamma > 0$), the quasi-stationary distribution (QSD) satisfies a **deterministic uniform local packing bound**:\n895: \n896: For all swarm configurations $(x, v) \\in \\text{supp}(\\pi_{\\text{QSD}})$ in the support of the QSD, all walkers $i \\in \\mathcal{A}$, and all radii $r > 0$:\n897: \n898: $$\n899: \\#\\left\\{j \\in \\mathcal{A} : d_{\\text{alg}}(i,j) \\leq r\\right\\} \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(0, r))\n900: $$\n901: \n902: where:\n903: - $\\rho_{\\max} = C_{\\text{erg}}(\\gamma, T, A_{\\text{fit}}, \\text{Vol}(\\mathcal{X} \\times V))$ is a **deterministic constant** depending only on kinetic parameters and domain volume\n904: - $\\text{Vol}(B(0, r))$ is the phase-space volume of a ball of radius $r$ in the algorithmic metric\n905: - The bound holds **for all configurations**, not just with high probability\n906: \n907: **Key Properties**:\n908: 1. **Deterministic**: No probabilistic qualifier; holds on the entire QSD support\n909: 2. **k-uniform**: $\\rho_{\\max}$ is independent of the number of alive walkers $k$ or total swarm size $N$\n910: 3. **Universal**: Applies to all swarm configurations that have non-zero probability under the QSD\n911: \n912: **Physical Mechanism**: The deterministic packing bound arises from three synergistic mechanisms:\n913: 1. **Kinetic diffusion** ($T > 0$): Continuously injects random momentum, preventing walkers from remaining arbitrarily close\n914: 2. **Cloning diversity enforcement**: Preferentially removes walkers with low algorithmic diversity (those too close to companions)\n915: 3. **Keystone ergodicity**: Ensures pathological clustering states have measure zero in the QSD\n916: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sum-to-integral-bound-full",
      "title": "Sum-to-Integral Bound with Exponential Weights",
      "start_line": 1009,
      "end_line": 1031,
      "header_lines": [
        1010
      ],
      "content_start": 1012,
      "content_end": 1030,
      "content": "1012: :label: lem-sum-to-integral-bound-full\n1013: \n1014: Under {prf:ref}`assump-uniform-density-full`, for any walker $i \\in \\mathcal{A}$ and any function $f : \\mathcal{X} \\times \\mathbb{R}^d \\to \\mathbb{R}$ with $|f| \\leq M$:\n1015: \n1016: $$\n1017: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1018: \\leq \\rho_{\\max} \\cdot M \\cdot \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,y)}{2\\varepsilon_c^2}\\right) dy\\,du\n1019: \n1020: $$\n1021: \n1022: **Key consequence for Gaussian integrals**: When $f \\equiv 1$:\n1023: \n1024: $$\n1025: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1026: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n1027: \n1028: $$\n1029: \n1030: where $C_{\\lambda} = (1 + \\lambda_{\\text{alg}})^{d/2}$ accounts for the velocity component in $d_{\\text{alg}}$.",
      "metadata": {
        "label": "lem-sum-to-integral-bound-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "1009: The following lemma makes the sum-to-integral approximation **explicit**.\n1010: \n1011: :::{prf:lemma} Sum-to-Integral Bound with Exponential Weights\n1012: :label: lem-sum-to-integral-bound-full\n1013: \n1014: Under {prf:ref}`assump-uniform-density-full`, for any walker $i \\in \\mathcal{A}$ and any function $f : \\mathcal{X} \\times \\mathbb{R}^d \\to \\mathbb{R}$ with $|f| \\leq M$:\n1015: \n1016: $$\n1017: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1018: \\leq \\rho_{\\max} \\cdot M \\cdot \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,y)}{2\\varepsilon_c^2}\\right) dy\\,du\n1019: \n1020: $$\n1021: \n1022: **Key consequence for Gaussian integrals**: When $f \\equiv 1$:\n1023: \n1024: $$\n1025: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1026: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n1027: \n1028: $$\n1029: \n1030: where $C_{\\lambda} = (1 + \\lambda_{\\text{alg}})^{d/2}$ accounts for the velocity component in $d_{\\text{alg}}$.\n1031: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 2. Companion Selection Mechanisms: Framework Context"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-partition-derivative-bounds-full",
      "title": "Derivative Bounds for Partition Functions",
      "start_line": 1207,
      "end_line": 1218,
      "header_lines": [
        1208
      ],
      "content_start": 1210,
      "content_end": 1217,
      "content": "1210: :label: lem-partition-derivative-bounds-full\n1211: \n1212: The partition functions $\\psi_m$ satisfy:\n1213: \n1214: $$\n1215: \\|\\nabla^n \\psi_m\\|_\\infty \\leq C_{\\psi,n} \\cdot \\varepsilon_c^{-n}\n1216: \n1217: $$",
      "metadata": {
        "label": "lem-partition-derivative-bounds-full"
      },
      "section": "## 3. Smooth Phase-Space Clustering",
      "raw_directive": "1207: :::\n1208: \n1209: :::{prf:lemma} Derivative Bounds for Partition Functions\n1210: :label: lem-partition-derivative-bounds-full\n1211: \n1212: The partition functions $\\psi_m$ satisfy:\n1213: \n1214: $$\n1215: \\|\\nabla^n \\psi_m\\|_\\infty \\leq C_{\\psi,n} \\cdot \\varepsilon_c^{-n}\n1216: \n1217: $$\n1218: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 3. Smooth Phase-Space Clustering"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-effective-cluster-size-bounds-full",
      "title": "Bounds on Effective Cluster Size",
      "start_line": 1299,
      "end_line": 1317,
      "header_lines": [
        1300
      ],
      "content_start": 1302,
      "content_end": 1316,
      "content": "1302: :label: lem-effective-cluster-size-bounds-full\n1303: \n1304: Under {prf:ref}`assump-uniform-density-full`:\n1305: \n1306: $$\n1307: k_m^{\\text{eff}} \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(y_m, 2\\varepsilon_c)) = C_{\\text{vol}} \\cdot \\rho_{\\max} \\cdot \\varepsilon_c^{2d}\n1308: \n1309: $$\n1310: \n1311: where $C_{\\text{vol}}$ is the volume constant for phase-space balls.\n1312: \n1313: Moreover, the total effective population sums to $k$:\n1314: \n1315: $$\n1316: \\sum_{m=1}^M k_m^{\\text{eff}} = \\sum_{m=1}^M \\sum_{j \\in \\mathcal{A}} \\psi_m(x_j, v_j) = \\sum_{j \\in \\mathcal{A}} \\underbrace{\\sum_{m=1}^M \\psi_m(x_j, v_j)}_{= 1} = k",
      "metadata": {
        "label": "lem-effective-cluster-size-bounds-full"
      },
      "section": "## 3. Smooth Phase-Space Clustering",
      "raw_directive": "1299: :::\n1300: \n1301: :::{prf:lemma} Bounds on Effective Cluster Size\n1302: :label: lem-effective-cluster-size-bounds-full\n1303: \n1304: Under {prf:ref}`assump-uniform-density-full`:\n1305: \n1306: $$\n1307: k_m^{\\text{eff}} \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(y_m, 2\\varepsilon_c)) = C_{\\text{vol}} \\cdot \\rho_{\\max} \\cdot \\varepsilon_c^{2d}\n1308: \n1309: $$\n1310: \n1311: where $C_{\\text{vol}}$ is the volume constant for phase-space balls.\n1312: \n1313: Moreover, the total effective population sums to $k$:\n1314: \n1315: $$\n1316: \\sum_{m=1}^M k_m^{\\text{eff}} = \\sum_{m=1}^M \\sum_{j \\in \\mathcal{A}} \\psi_m(x_j, v_j) = \\sum_{j \\in \\mathcal{A}} \\underbrace{\\sum_{m=1}^M \\psi_m(x_j, v_j)}_{= 1} = k\n1317: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 3. Smooth Phase-Space Clustering"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-softmax-tail-corrected-full",
      "title": "Softmax Tail Bound",
      "start_line": 1365,
      "end_line": 1376,
      "header_lines": [
        1366
      ],
      "content_start": 1368,
      "content_end": 1375,
      "content": "1368: :label: lem-softmax-tail-corrected-full\n1369: \n1370: Under {prf:ref}`lem-companion-availability-enforcement`, for walker $i \\in \\mathcal{A}$ with companion $c(i)$ selected via softmax:\n1371: \n1372: $$\n1373: \\mathbb{P}(d_{\\text{alg}}(i, c(i)) > R \\mid \\mathcal{F}_t) \\leq k \\cdot \\exp\\left(-\\frac{R^2 - R_{\\max}^2}{2\\varepsilon_c^2}\\right)\n1374: \n1375: $$",
      "metadata": {
        "label": "lem-softmax-tail-corrected-full"
      },
      "section": "## 4. Exponential Locality and Effective Interactions",
      "raw_directive": "1365: ### 4.1 Softmax Concentration Bounds\n1366: \n1367: :::{prf:lemma} Softmax Tail Bound\n1368: :label: lem-softmax-tail-corrected-full\n1369: \n1370: Under {prf:ref}`lem-companion-availability-enforcement`, for walker $i \\in \\mathcal{A}$ with companion $c(i)$ selected via softmax:\n1371: \n1372: $$\n1373: \\mathbb{P}(d_{\\text{alg}}(i, c(i)) > R \\mid \\mathcal{F}_t) \\leq k \\cdot \\exp\\left(-\\frac{R^2 - R_{\\max}^2}{2\\varepsilon_c^2}\\right)\n1374: \n1375: $$\n1376: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Exponential Locality and Effective Interactions"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-effective-companion-count-corrected-full",
      "title": "Effective Companion Count",
      "start_line": 1440,
      "end_line": 1458,
      "header_lines": [
        1441
      ],
      "content_start": 1443,
      "content_end": 1457,
      "content": "1443: :label: lem-effective-companion-count-corrected-full\n1444: \n1445: Under {prf:ref}`assump-uniform-density-full`, the effective number of companions within $R_{\\text{eff}}$ is:\n1446: \n1447: $$\n1448: k_{\\text{eff}}(i) := \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\mathbb{1}_{d_{\\text{alg}}(i,\\ell) \\leq R_{\\text{eff}}} \\leq \\rho_{\\max} \\cdot C_{\\text{vol}} \\cdot R_{\\text{eff}}^{2d}\n1449: \n1450: $$\n1451: \n1452: Substituting $R_{\\text{eff}} = \\mathcal{O}(\\varepsilon_c \\sqrt{\\log k})$:\n1453: \n1454: $$\n1455: k_{\\text{eff}}(i) = \\mathcal{O}(\\varepsilon_c^{2d} \\cdot (\\log k)^d)\n1456: \n1457: $$",
      "metadata": {
        "label": "lem-effective-companion-count-corrected-full"
      },
      "section": "## 4. Exponential Locality and Effective Interactions",
      "raw_directive": "1440: ### 4.2 Effective Number of Interacting Companions\n1441: \n1442: :::{prf:lemma} Effective Companion Count\n1443: :label: lem-effective-companion-count-corrected-full\n1444: \n1445: Under {prf:ref}`assump-uniform-density-full`, the effective number of companions within $R_{\\text{eff}}$ is:\n1446: \n1447: $$\n1448: k_{\\text{eff}}(i) := \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\mathbb{1}_{d_{\\text{alg}}(i,\\ell) \\leq R_{\\text{eff}}} \\leq \\rho_{\\max} \\cdot C_{\\text{vol}} \\cdot R_{\\text{eff}}^{2d}\n1449: \n1450: $$\n1451: \n1452: Substituting $R_{\\text{eff}} = \\mathcal{O}(\\varepsilon_c \\sqrt{\\log k})$:\n1453: \n1454: $$\n1455: k_{\\text{eff}}(i) = \\mathcal{O}(\\varepsilon_c^{2d} \\cdot (\\log k)^d)\n1456: \n1457: $$\n1458: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Exponential Locality and Effective Interactions"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-softmax-derivative-locality-full",
      "title": "Exponential Locality of Softmax Derivatives",
      "start_line": 1474,
      "end_line": 1487,
      "header_lines": [
        1475
      ],
      "content_start": 1477,
      "content_end": 1486,
      "content": "1477: :label: lem-softmax-derivative-locality-full\n1478: \n1479: For the softmax companion selection with temperature $\\varepsilon_c$, all derivatives of the companion probability satisfy:\n1480: \n1481: $$\n1482: \\left|\\nabla^\\alpha_{x_i} P(c(j) = \\ell \\mid \\mathcal{F}_t)\\right| \\leq C_{|\\alpha|} \\cdot \\varepsilon_c^{-2|\\alpha|} \\cdot P(c(j) = \\ell \\mid \\mathcal{F}_t) \\cdot \\exp\\left(-\\frac{d_{\\text{alg}}^2(j, \\ell)}{4\\varepsilon_c^2}\\right)\n1483: \n1484: $$\n1485: \n1486: where $C_{|\\alpha|} = O(|\\alpha|!)$ (Gevrey-1 growth) and the bound is **k-uniform**.",
      "metadata": {
        "label": "lem-softmax-derivative-locality-full"
      },
      "section": "## 4. Exponential Locality and Effective Interactions",
      "raw_directive": "1474: The previous sections established exponential concentration for the **probabilities** $P(c(i) = \\ell)$. We now prove that **derivatives** of these probabilities also decay exponentially.\n1475: \n1476: :::{prf:lemma} Exponential Locality of Softmax Derivatives\n1477: :label: lem-softmax-derivative-locality-full\n1478: \n1479: For the softmax companion selection with temperature $\\varepsilon_c$, all derivatives of the companion probability satisfy:\n1480: \n1481: $$\n1482: \\left|\\nabla^\\alpha_{x_i} P(c(j) = \\ell \\mid \\mathcal{F}_t)\\right| \\leq C_{|\\alpha|} \\cdot \\varepsilon_c^{-2|\\alpha|} \\cdot P(c(j) = \\ell \\mid \\mathcal{F}_t) \\cdot \\exp\\left(-\\frac{d_{\\text{alg}}^2(j, \\ell)}{4\\varepsilon_c^2}\\right)\n1483: \n1484: $$\n1485: \n1486: where $C_{|\\alpha|} = O(|\\alpha|!)$ (Gevrey-1 growth) and the bound is **k-uniform**.\n1487: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Exponential Locality and Effective Interactions"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-dalg-derivative-bounds-full",
      "title": "Higher Derivatives of Regularized Algorithmic Distance",
      "start_line": 1575,
      "end_line": 1618,
      "header_lines": [
        1576
      ],
      "content_start": 1578,
      "content_end": 1617,
      "content": "1578: :label: lem-dalg-derivative-bounds-full\n1579: \n1580: The **regularized** algorithmic distance:\n1581: \n1582: $$\n1583: d_{\\text{alg}}(i,j) = \\sqrt{\\|x_i - x_j\\|^2 + \\lambda_{\\text{alg}} \\|v_i - v_j\\|^2 + \\varepsilon_d^2}\n1584: \n1585: $$\n1586: \n1587: where $\\varepsilon_d > 0$ is the regularization parameter, has the following properties:\n1588: \n1589: 1. **Uniform Lower Bound**: $d_{\\text{alg}}(i,j) \\geq \\varepsilon_d > 0$ for all walker configurations (no singularity)\n1590: \n1591: 2. **C^∞ Regularity**: $d_{\\text{alg}}$ is C^∞ with **uniform** derivative bounds:\n1592: \n1593: **First derivative**:\n1594: \n1595: $$\n1596: \\nabla_{x_i} d_{\\text{alg}}(i,j) = \\frac{x_i - x_j}{d_{\\text{alg}}(i,j)}, \\quad \\|\\nabla_{x_i} d_{\\text{alg}}(i,j)\\| \\leq 1\n1597: \n1598: $$\n1599: \n1600: **Second derivative** (Hessian):\n1601: \n1602: $$\n1603: \\nabla^2_{x_i} d_{\\text{alg}}(i,j) = \\frac{1}{d_{\\text{alg}}(i,j)} \\left(I - \\frac{(x_i - x_j) \\otimes (x_i - x_j)}{d_{\\text{alg}}^2(i,j)}\\right)\n1604: \n1605: $$\n1606: \n1607: $$\n1608: \\|\\nabla^2_{x_i} d_{\\text{alg}}(i,j)\\| \\leq \\frac{1}{\\varepsilon_d} \\quad \\text{(uniform bound using } d_{\\text{alg}} \\geq \\varepsilon_d\\text{)}\n1609: \n1610: $$\n1611: \n1612: **General bound**: For derivative order $n \\geq 1$:\n1613: \n1614: $$\n1615: \\|\\nabla^n_{x_i} d_{\\text{alg}}(i,j)\\| \\leq C_{d,n} \\cdot \\varepsilon_d^{1-n}\n1616: \n1617: $$",
      "metadata": {
        "label": "lem-dalg-derivative-bounds-full"
      },
      "section": "## 5. Derivatives of Algorithmic Distance (Regularized Version)",
      "raw_directive": "1575: We now establish the derivative structure for the **regularized** algorithmic distance, which eliminates the singularity at walker collisions.\n1576: \n1577: :::{prf:lemma} Higher Derivatives of Regularized Algorithmic Distance\n1578: :label: lem-dalg-derivative-bounds-full\n1579: \n1580: The **regularized** algorithmic distance:\n1581: \n1582: $$\n1583: d_{\\text{alg}}(i,j) = \\sqrt{\\|x_i - x_j\\|^2 + \\lambda_{\\text{alg}} \\|v_i - v_j\\|^2 + \\varepsilon_d^2}\n1584: \n1585: $$\n1586: \n1587: where $\\varepsilon_d > 0$ is the regularization parameter, has the following properties:\n1588: \n1589: 1. **Uniform Lower Bound**: $d_{\\text{alg}}(i,j) \\geq \\varepsilon_d > 0$ for all walker configurations (no singularity)\n1590: \n1591: 2. **C^∞ Regularity**: $d_{\\text{alg}}$ is C^∞ with **uniform** derivative bounds:\n1592: \n1593: **First derivative**:\n1594: \n1595: $$\n1596: \\nabla_{x_i} d_{\\text{alg}}(i,j) = \\frac{x_i - x_j}{d_{\\text{alg}}(i,j)}, \\quad \\|\\nabla_{x_i} d_{\\text{alg}}(i,j)\\| \\leq 1\n1597: \n1598: $$\n1599: \n1600: **Second derivative** (Hessian):\n1601: \n1602: $$\n1603: \\nabla^2_{x_i} d_{\\text{alg}}(i,j) = \\frac{1}{d_{\\text{alg}}(i,j)} \\left(I - \\frac{(x_i - x_j) \\otimes (x_i - x_j)}{d_{\\text{alg}}^2(i,j)}\\right)\n1604: \n1605: $$\n1606: \n1607: $$\n1608: \\|\\nabla^2_{x_i} d_{\\text{alg}}(i,j)\\| \\leq \\frac{1}{\\varepsilon_d} \\quad \\text{(uniform bound using } d_{\\text{alg}} \\geq \\varepsilon_d\\text{)}\n1609: \n1610: $$\n1611: \n1612: **General bound**: For derivative order $n \\geq 1$:\n1613: \n1614: $$\n1615: \\|\\nabla^n_{x_i} d_{\\text{alg}}(i,j)\\| \\leq C_{d,n} \\cdot \\varepsilon_d^{1-n}\n1616: \n1617: $$\n1618: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 5. Derivatives of Algorithmic Distance (Regularized Version)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-companion-measurement-derivatives-full",
      "title": "Derivatives of Companion-Dependent Measurements",
      "start_line": 1771,
      "end_line": 1791,
      "header_lines": [
        1772
      ],
      "content_start": 1774,
      "content_end": 1790,
      "content": "1774: :label: lem-companion-measurement-derivatives-full\n1775: \n1776: For any walker $i \\in \\mathcal{A}$ (taking derivatives with respect to $x_i$), the companion-dependent measurement for walker $j \\neq i$ satisfies:\n1777: \n1778: $$\n1779: \\|\\nabla^n_{x_i} d_j\\| \\leq C_{d_j,n} \\cdot \\max(\\varepsilon_d^{1-n}, \\varepsilon_d \\varepsilon_c^{-n})\n1780: \n1781: $$\n1782: \n1783: where $C_{d_j,n} = \\mathcal{O}(n!)$ (Gevrey-1) is **k-uniform** (independent of the number of alive walkers).\n1784: \n1785: **For typical parameters** where $\\varepsilon_d \\ll \\varepsilon_c$ and $n \\geq 2$, this simplifies to:\n1786: \n1787: $$\n1788: \\|\\nabla^n_{x_i} d_j\\| \\leq C_{d_j,n} \\cdot \\varepsilon_d^{1-n}\n1789: \n1790: $$",
      "metadata": {
        "label": "lem-companion-measurement-derivatives-full"
      },
      "section": "## 5.5 Companion-Dependent Measurements with Softmax Coupling",
      "raw_directive": "1771: ### 5.5.2 High-Order Derivatives via Faà di Bruno Formula\n1772: \n1773: :::{prf:lemma} Derivatives of Companion-Dependent Measurements\n1774: :label: lem-companion-measurement-derivatives-full\n1775: \n1776: For any walker $i \\in \\mathcal{A}$ (taking derivatives with respect to $x_i$), the companion-dependent measurement for walker $j \\neq i$ satisfies:\n1777: \n1778: $$\n1779: \\|\\nabla^n_{x_i} d_j\\| \\leq C_{d_j,n} \\cdot \\max(\\varepsilon_d^{1-n}, \\varepsilon_d \\varepsilon_c^{-n})\n1780: \n1781: $$\n1782: \n1783: where $C_{d_j,n} = \\mathcal{O}(n!)$ (Gevrey-1) is **k-uniform** (independent of the number of alive walkers).\n1784: \n1785: **For typical parameters** where $\\varepsilon_d \\ll \\varepsilon_c$ and $n \\geq 2$, this simplifies to:\n1786: \n1787: $$\n1788: \\|\\nabla^n_{x_i} d_j\\| \\leq C_{d_j,n} \\cdot \\varepsilon_d^{1-n}\n1789: \n1790: $$\n1791: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 5.5 Companion-Dependent Measurements with Softmax Coupling"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-self-measurement-derivatives-full",
      "title": "Derivatives of Self-Measurement (j=i case)",
      "start_line": 2040,
      "end_line": 2060,
      "header_lines": [
        2041
      ],
      "content_start": 2043,
      "content_end": 2059,
      "content": "2043: :label: lem-self-measurement-derivatives-full\n2044: \n2045: For walker $i \\in \\mathcal{A}$, the **self-measurement** $d_i = d_{\\text{alg}}(i, c(i))$ where $c(i)$ is selected via softmax satisfies:\n2046: \n2047: $$\n2048: \\|\\nabla^n_{x_i} d_i\\| \\leq C_{d_i,n} \\cdot \\max(\\varepsilon_d^{1-n}, \\varepsilon_d \\varepsilon_c^{-n})\n2049: \n2050: $$\n2051: \n2052: where $C_{d_i,n} = \\mathcal{O}(n!)$ (Gevrey-1) is **k-uniform** (independent of the number of alive walkers).\n2053: \n2054: **For typical parameters** where $\\varepsilon_d \\ll \\varepsilon_c$ and $n \\geq 2$:\n2055: \n2056: $$\n2057: \\|\\nabla^n_{x_i} d_i\\| \\leq C_{d_i,n} \\cdot \\varepsilon_d^{1-n}\n2058: \n2059: $$",
      "metadata": {
        "label": "lem-self-measurement-derivatives-full"
      },
      "section": "## 5.5 Companion-Dependent Measurements with Softmax Coupling",
      "raw_directive": "2040: :::\n2041: \n2042: :::{prf:lemma} Derivatives of Self-Measurement (j=i case)\n2043: :label: lem-self-measurement-derivatives-full\n2044: \n2045: For walker $i \\in \\mathcal{A}$, the **self-measurement** $d_i = d_{\\text{alg}}(i, c(i))$ where $c(i)$ is selected via softmax satisfies:\n2046: \n2047: $$\n2048: \\|\\nabla^n_{x_i} d_i\\| \\leq C_{d_i,n} \\cdot \\max(\\varepsilon_d^{1-n}, \\varepsilon_d \\varepsilon_c^{-n})\n2049: \n2050: $$\n2051: \n2052: where $C_{d_i,n} = \\mathcal{O}(n!)$ (Gevrey-1) is **k-uniform** (independent of the number of alive walkers).\n2053: \n2054: **For typical parameters** where $\\varepsilon_d \\ll \\varepsilon_c$ and $n \\geq 2$:\n2055: \n2056: $$\n2057: \\|\\nabla^n_{x_i} d_i\\| \\leq C_{d_i,n} \\cdot \\varepsilon_d^{1-n}\n2058: \n2059: $$\n2060: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 5.5 Companion-Dependent Measurements with Softmax Coupling"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-greedy-ideal-equivalence",
      "title": "Statistical Equivalence Preserves C^∞ Regularity",
      "start_line": 2471,
      "end_line": 2482,
      "header_lines": [
        2472
      ],
      "content_start": 2474,
      "content_end": 2481,
      "content": "2474: :label: lem-greedy-ideal-equivalence\n2475: \n2476: The Sequential Stochastic Greedy Pairing and the Idealized Spatially-Aware Pairing produce statistically equivalent measurements:\n2477: \n2478: $$\n2479: \\mathbb{E}_{\\text{greedy}}[d_i | S] = \\mathbb{E}_{\\text{ideal}}[d_i | S] + O(k^{-\\beta})\n2480: \n2481: $$",
      "metadata": {
        "label": "lem-greedy-ideal-equivalence"
      },
      "section": "## 5.6 Diversity Pairing Mechanism Analysis",
      "raw_directive": "2471: ### 5.6.4 Transfer from Idealized to Greedy Pairing\n2472: \n2473: :::{prf:lemma} Statistical Equivalence Preserves C^∞ Regularity\n2474: :label: lem-greedy-ideal-equivalence\n2475: \n2476: The Sequential Stochastic Greedy Pairing and the Idealized Spatially-Aware Pairing produce statistically equivalent measurements:\n2477: \n2478: $$\n2479: \\mathbb{E}_{\\text{greedy}}[d_i | S] = \\mathbb{E}_{\\text{ideal}}[d_i | S] + O(k^{-\\beta})\n2480: \n2481: $$\n2482: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 5.6 Diversity Pairing Mechanism Analysis"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-lipschitz-pipeline-stability-full",
      "title": "Lipschitz Stability of Nonlinear Pipeline",
      "start_line": 2757,
      "end_line": 2780,
      "header_lines": [
        2758
      ],
      "content_start": 2760,
      "content_end": 2779,
      "content": "2760: :label: lem-lipschitz-pipeline-stability-full\n2761: \n2762: Let $\\{d_j\\}_{j \\in \\mathcal{A}}$ and $\\{\\tilde{d}_j\\}_{j \\in \\mathcal{A}}$ be two sets of measurements satisfying the same bounds (bounded by $\\text{diam}(\\mathcal{X} \\times V)$, C^∞ with Gevrey-1 constants). Define:\n2763: \n2764: $$\n2765: \\|\\Delta\\|_\\infty := \\max_{j \\in \\mathcal{A}} |d_j - \\tilde{d}_j|\n2766: \n2767: $$\n2768: \n2769: Then the fitness potentials computed from these measurements satisfy:\n2770: \n2771: $$\n2772: |V_{\\text{fit}}[d] - V_{\\text{fit}}[\\tilde{d}]| \\leq L_V \\cdot (\\|\\Delta\\|_\\infty + \\|\\Delta\\|_\\infty^2)\n2773: \n2774: $$\n2775: \n2776: where $L_V$ is a Lipschitz constant depending on:\n2777: - Regularization parameters: $\\eta_{\\min}$ (prevents division by zero), $\\rho$ (localization scale)\n2778: - Domain bounds: $\\text{diam}(\\mathcal{X} \\times V)$, $\\rho_{\\max}$\n2779: - Rescale function: $\\|g_A'\\|_\\infty$",
      "metadata": {
        "label": "lem-lipschitz-pipeline-stability-full"
      },
      "section": "## 5.7 Statistical Equivalence and Unified Regularity Theorem",
      "raw_directive": "2757: This section establishes that **if** measurements differ by $\\|\\Delta\\|_\\infty$, then the fitness potential difference can be bounded via Lipschitz stability analysis through the nonlinear pipeline stages. This provides the foundation for quantitative equivalence analysis (future work).\n2758: \n2759: :::{prf:lemma} Lipschitz Stability of Nonlinear Pipeline\n2760: :label: lem-lipschitz-pipeline-stability-full\n2761: \n2762: Let $\\{d_j\\}_{j \\in \\mathcal{A}}$ and $\\{\\tilde{d}_j\\}_{j \\in \\mathcal{A}}$ be two sets of measurements satisfying the same bounds (bounded by $\\text{diam}(\\mathcal{X} \\times V)$, C^∞ with Gevrey-1 constants). Define:\n2763: \n2764: $$\n2765: \\|\\Delta\\|_\\infty := \\max_{j \\in \\mathcal{A}} |d_j - \\tilde{d}_j|\n2766: \n2767: $$\n2768: \n2769: Then the fitness potentials computed from these measurements satisfy:\n2770: \n2771: $$\n2772: |V_{\\text{fit}}[d] - V_{\\text{fit}}[\\tilde{d}]| \\leq L_V \\cdot (\\|\\Delta\\|_\\infty + \\|\\Delta\\|_\\infty^2)\n2773: \n2774: $$\n2775: \n2776: where $L_V$ is a Lipschitz constant depending on:\n2777: - Regularization parameters: $\\eta_{\\min}$ (prevents division by zero), $\\rho$ (localization scale)\n2778: - Domain bounds: $\\text{diam}(\\mathcal{X} \\times V)$, $\\rho_{\\max}$\n2779: - Rescale function: $\\|g_A'\\|_\\infty$\n2780: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 10,
        "chapter_file": "chapter_10.json",
        "section_id": "## 5.7 Statistical Equivalence and Unified Regularity Theorem"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-gaussian-kernel-derivatives-full",
      "title": "Gaussian Kernel Derivatives",
      "start_line": 3027,
      "end_line": 3040,
      "header_lines": [
        3028
      ],
      "content_start": 3030,
      "content_end": 3039,
      "content": "3030: :label: lem-gaussian-kernel-derivatives-full\n3031: \n3032: The Gaussian kernel $K_\\rho(i,j) = \\exp(-d_{\\text{alg}}^2(i,j)/(2\\rho^2))$ satisfies:\n3033: \n3034: For derivative order $n \\geq 1$:\n3035: \n3036: $$\n3037: \\|\\nabla^n_{x_i} K_\\rho(i,j)\\| \\leq C_{K,n} \\cdot \\rho^{-n} \\cdot K_\\rho(i,j)\n3038: \n3039: $$",
      "metadata": {
        "label": "lem-gaussian-kernel-derivatives-full"
      },
      "section": "## 6. Structure of Localization Weights",
      "raw_directive": "3027: ### 6.1 Derivative Bounds for Localization Kernel\n3028: \n3029: :::{prf:lemma} Gaussian Kernel Derivatives\n3030: :label: lem-gaussian-kernel-derivatives-full\n3031: \n3032: The Gaussian kernel $K_\\rho(i,j) = \\exp(-d_{\\text{alg}}^2(i,j)/(2\\rho^2))$ satisfies:\n3033: \n3034: For derivative order $n \\geq 1$:\n3035: \n3036: $$\n3037: \\|\\nabla^n_{x_i} K_\\rho(i,j)\\| \\leq C_{K,n} \\cdot \\rho^{-n} \\cdot K_\\rho(i,j)\n3038: \n3039: $$\n3040: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 6. Structure of Localization Weights"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-localization-weight-derivatives-full",
      "title": "Localization Weight Derivatives",
      "start_line": 3062,
      "end_line": 3073,
      "header_lines": [
        3063
      ],
      "content_start": 3065,
      "content_end": 3072,
      "content": "3065: :label: lem-localization-weight-derivatives-full\n3066: \n3067: The localization weights $w_{ij}(\\rho) = K_\\rho(i,j) / Z_i(\\rho)$ satisfy:\n3068: \n3069: $$\n3070: \\|\\nabla^n_{x_i} w_{ij}(\\rho)\\| \\leq C_{w,n} \\cdot \\rho^{-n}\n3071: \n3072: $$",
      "metadata": {
        "label": "lem-localization-weight-derivatives-full"
      },
      "section": "## 6. Structure of Localization Weights",
      "raw_directive": "3062: ### 6.2 Localization Weights: Quotient Rule Analysis\n3063: \n3064: :::{prf:lemma} Localization Weight Derivatives\n3065: :label: lem-localization-weight-derivatives-full\n3066: \n3067: The localization weights $w_{ij}(\\rho) = K_\\rho(i,j) / Z_i(\\rho)$ satisfy:\n3068: \n3069: $$\n3070: \\|\\nabla^n_{x_i} w_{ij}(\\rho)\\| \\leq C_{w,n} \\cdot \\rho^{-n}\n3071: \n3072: $$\n3073: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 6. Structure of Localization Weights"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-telescoping-localization-weights-full",
      "title": "Telescoping for Localization Weights",
      "start_line": 3164,
      "end_line": 3173,
      "header_lines": [
        3165
      ],
      "content_start": 3167,
      "content_end": 3172,
      "content": "3167: :label: lem-telescoping-localization-weights-full\n3168: \n3169: For walker $i$ and any derivative order $n \\geq 1$:\n3170: \n3171: $$\n3172: \\sum_{j \\in \\mathcal{A}} \\nabla^n_{x_i} w_{ij}(\\rho) = 0",
      "metadata": {
        "label": "lem-telescoping-localization-weights-full"
      },
      "section": "## 6. Structure of Localization Weights",
      "raw_directive": "3164: ### 6.3 Telescoping Identity for Smooth Weights\n3165: \n3166: :::{prf:lemma} Telescoping for Localization Weights\n3167: :label: lem-telescoping-localization-weights-full\n3168: \n3169: For walker $i$ and any derivative order $n \\geq 1$:\n3170: \n3171: $$\n3172: \\sum_{j \\in \\mathcal{A}} \\nabla^n_{x_i} w_{ij}(\\rho) = 0\n3173: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 6. Structure of Localization Weights"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-derivatives-companion-distance-full",
      "title": "Derivatives of Companion-Dependent Distance",
      "start_line": 3311,
      "end_line": 3323,
      "header_lines": [
        3312
      ],
      "content_start": 3314,
      "content_end": 3322,
      "content": "3314: :label: lem-derivatives-companion-distance-full\n3315: \n3316: For measurement $d_j = d_{\\text{alg}}(j, c(j))$ where $c(j)$ is selected via softmax, the derivative with respect to $x_i$ is:\n3317: \n3318: $$\n3319: \\frac{\\partial d_j}{\\partial x_i} = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{j\\}} \\mathbb{P}(c(j) = \\ell) \\cdot \\frac{\\partial d_{\\text{alg}}(j, \\ell)}{\\partial x_i}\n3320: + \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{j\\}} d_{\\text{alg}}(j, \\ell) \\cdot \\frac{\\partial \\mathbb{P}(c(j) = \\ell)}{\\partial x_i}\n3321: \n3322: $$",
      "metadata": {
        "label": "lem-derivatives-companion-distance-full"
      },
      "section": "## 7. Companion-Dependent Measurements: Handling N-Body Coupling",
      "raw_directive": "3311: ### 7.1 Derivative Structure of Companion-Dependent Measurements\n3312: \n3313: :::{prf:lemma} Derivatives of Companion-Dependent Distance\n3314: :label: lem-derivatives-companion-distance-full\n3315: \n3316: For measurement $d_j = d_{\\text{alg}}(j, c(j))$ where $c(j)$ is selected via softmax, the derivative with respect to $x_i$ is:\n3317: \n3318: $$\n3319: \\frac{\\partial d_j}{\\partial x_i} = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{j\\}} \\mathbb{P}(c(j) = \\ell) \\cdot \\frac{\\partial d_{\\text{alg}}(j, \\ell)}{\\partial x_i}\n3320: + \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{j\\}} d_{\\text{alg}}(j, \\ell) \\cdot \\frac{\\partial \\mathbb{P}(c(j) = \\ell)}{\\partial x_i}\n3321: \n3322: $$\n3323: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 13,
        "chapter_file": "chapter_13.json",
        "section_id": "## 7. Companion-Dependent Measurements: Handling N-Body Coupling"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-first-derivative-localized-mean-full",
      "title": "First Derivative of Localized Mean",
      "start_line": 3470,
      "end_line": 3479,
      "header_lines": [
        3471
      ],
      "content_start": 3473,
      "content_end": 3478,
      "content": "3473: :label: lem-first-derivative-localized-mean-full\n3474: \n3475: $$\n3476: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\leq C_{\\mu,1}(\\rho) \\cdot \\rho^{-1}\n3477: \n3478: $$",
      "metadata": {
        "label": "lem-first-derivative-localized-mean-full"
      },
      "section": "## 8. Localized Mean: Derivative Expansion",
      "raw_directive": "3470: ### 8.1 First Derivative: Telescoping with Companion Coupling\n3471: \n3472: :::{prf:lemma} First Derivative of Localized Mean\n3473: :label: lem-first-derivative-localized-mean-full\n3474: \n3475: $$\n3476: \\|\\nabla_{x_i} \\mu_\\rho^{(i)}\\| \\leq C_{\\mu,1}(\\rho) \\cdot \\rho^{-1}\n3477: \n3478: $$\n3479: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## 8. Localized Mean: Derivative Expansion"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mth-derivative-localized-mean-full",
      "title": "m-th Derivative of Localized Mean",
      "start_line": 3647,
      "end_line": 3658,
      "header_lines": [
        3648
      ],
      "content_start": 3650,
      "content_end": 3657,
      "content": "3650: :label: lem-mth-derivative-localized-mean-full\n3651: \n3652: For derivative order $m \\geq 1$:\n3653: \n3654: $$\n3655: \\|\\nabla^m_{x_i} \\mu_\\rho^{(i)}\\| \\leq C_{\\mu,m}(\\rho) \\cdot \\rho^{-m}\n3656: \n3657: $$",
      "metadata": {
        "label": "lem-mth-derivative-localized-mean-full"
      },
      "section": "## 8. Localized Mean: Derivative Expansion",
      "raw_directive": "3647: We now establish the general pattern for arbitrary derivative order $m$.\n3648: \n3649: :::{prf:lemma} m-th Derivative of Localized Mean\n3650: :label: lem-mth-derivative-localized-mean-full\n3651: \n3652: For derivative order $m \\geq 1$:\n3653: \n3654: $$\n3655: \\|\\nabla^m_{x_i} \\mu_\\rho^{(i)}\\| \\leq C_{\\mu,m}(\\rho) \\cdot \\rho^{-m}\n3656: \n3657: $$\n3658: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## 8. Localized Mean: Derivative Expansion"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-first-derivative-localized-variance-full",
      "title": "First Derivative of Localized Variance",
      "start_line": 3834,
      "end_line": 3843,
      "header_lines": [
        3835
      ],
      "content_start": 3837,
      "content_end": 3842,
      "content": "3837: :label: lem-first-derivative-localized-variance-full\n3838: \n3839: $$\n3840: \\|\\nabla_{x_i} \\sigma_\\rho^{2(i)}\\| \\leq C_{\\sigma^2,1}(\\rho) \\cdot \\rho^{-1}\n3841: \n3842: $$",
      "metadata": {
        "label": "lem-first-derivative-localized-variance-full"
      },
      "section": "## 9. Localized Variance: Full Derivative Analysis",
      "raw_directive": "3834: ### 9.1 Structure and First Derivative\n3835: \n3836: :::{prf:lemma} First Derivative of Localized Variance\n3837: :label: lem-first-derivative-localized-variance-full\n3838: \n3839: $$\n3840: \\|\\nabla_{x_i} \\sigma_\\rho^{2(i)}\\| \\leq C_{\\sigma^2,1}(\\rho) \\cdot \\rho^{-1}\n3841: \n3842: $$\n3843: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 16,
        "chapter_file": "chapter_16.json",
        "section_id": "## 9. Localized Variance: Full Derivative Analysis"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-properties-regularized-std-dev-full",
      "title": "Properties of Regularized Standard Deviation",
      "start_line": 4296,
      "end_line": 4313,
      "header_lines": [
        4297
      ],
      "content_start": 4299,
      "content_end": 4312,
      "content": "4299: :label: lem-properties-regularized-std-dev-full\n4300: \n4301: The function $\\sigma'_\\rho(i) = \\sqrt{\\sigma_\\rho^{2(i)} + \\eta_{\\min}^2}$ satisfies:\n4302: \n4303: 1. **Positive lower bound**: $\\sigma'_\\rho(i) \\geq \\eta_{\\min} > 0$ for all configurations\n4304: \n4305: 2. **C^∞ regularity**: $\\sigma'_\\rho \\in C^\\infty$ as a composition of C^∞ functions\n4306: \n4307: 3. **Derivative bounds**: For $m \\geq 1$,\n4308: \n4309: $$\n4310: \\|\\nabla^m \\sigma'_\\rho(i)\\| \\leq C_{\\sigma',m}(\\rho) \\cdot \\rho^{-m}\n4311: \n4312: $$",
      "metadata": {
        "label": "lem-properties-regularized-std-dev-full"
      },
      "section": "## 10. Regularized Standard Deviation",
      "raw_directive": "4296: ### 10.1 Smoothness and Lower Bounds\n4297: \n4298: :::{prf:lemma} Properties of Regularized Standard Deviation\n4299: :label: lem-properties-regularized-std-dev-full\n4300: \n4301: The function $\\sigma'_\\rho(i) = \\sqrt{\\sigma_\\rho^{2(i)} + \\eta_{\\min}^2}$ satisfies:\n4302: \n4303: 1. **Positive lower bound**: $\\sigma'_\\rho(i) \\geq \\eta_{\\min} > 0$ for all configurations\n4304: \n4305: 2. **C^∞ regularity**: $\\sigma'_\\rho \\in C^\\infty$ as a composition of C^∞ functions\n4306: \n4307: 3. **Derivative bounds**: For $m \\geq 1$,\n4308: \n4309: $$\n4310: \\|\\nabla^m \\sigma'_\\rho(i)\\| \\leq C_{\\sigma',m}(\\rho) \\cdot \\rho^{-m}\n4311: \n4312: $$\n4313: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "20_geometric_gas_cinf_regularity_full",
        "chapter_index": 18,
        "chapter_file": "chapter_18.json",
        "section_id": "## 10. Regularized Standard Deviation"
      }
    }
  ]
}