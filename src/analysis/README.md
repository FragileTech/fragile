# Theorem Dependency Graph Analysis

Interactive visualization and analysis tools for the mathematical theorem dependency graph.

## Dashboard: Theorem Dependency Graph Visualization

### Overview

The `theorem_graph_dashboard.py` provides an interactive web-based dashboard for exploring the 855+ theorems across the Fragile framework documentation with their dependency relationships.

### Features

#### üé® **Interactive Graph Visualization**
- **855 nodes** representing theorems, lemmas, propositions, corollaries, definitions, and axioms
- **Hierarchical layout** using Graphviz (left-to-right flow)
- **Color-coded nodes** by recommendation status:
  - üü¢ **Accept** (green): Publication-ready
  - üü° **Minor revision** (yellow): Nearly complete
  - üü† **Major revision** (orange): Significant work needed
  - üî¥ **Reject** (red): Needs substantial development
  - üü£ **Broken** (purple): Critical issues (circular/missing deps)

#### üîç **Advanced Filtering**
- Filter by **chapter** (Euclidean Gas, Geometric Gas, Brascamp-Lieb)
- Filter by **status** (proven, has_complete_proof, has_sketch, needs_proof)
- Filter by **recommendation** (Accept, Minor revision, Major revision, Reject, Broken)
- Filter by **theorem type** (Theorem, Lemma, Proposition, etc.)
- Filter by **rigor score** (1-10 range slider)
- Filter by **strategy score** (1-10 range slider)

#### üìä **Interactive Node Details**
Click any node to see:
- Full theorem title and label
- Document location (file:line)
- Quality metrics (rigor, strategy, recommendation, status)
- **Dependencies** (what this theorem depends on)
- **Dependents** (what theorems depend on this one)
- Tags and notes

#### üìà **Real-time Statistics**
- Total nodes and edges (updates with filtering)
- Breakdown by recommendation, status, chapter, and type
- Average rigor and strategy scores

#### üéõÔ∏è **Shaolin-Powered Controls**
- **Node size**: Map to any numeric property (default: # of dependents)
- **Node color**: Map to any categorical property (default: recommendation)
- **Node alpha**: Map to any numeric property (default: rigor score)
- **Edge color**: Map to cross-chapter dependencies
- **X/Y coordinates**: Switch between different node properties
- **Zoom and pan**: Full interactive exploration

### Installation

Ensure you have the required dependencies:

```bash
# Install fragile with visualization dependencies
pip install -e ".[viz]"

# Or manually install requirements
pip install holoviews bokeh panel networkx pandas numpy
```

### Usage

#### Method 1: Panel Serve (Recommended)

```bash
cd /path/to/fragile
panel serve src/analysis/theorem_graph_dashboard.py --show
```

This starts a Panel server and opens the dashboard in your browser.

#### Method 2: Panel Serve without Auto-Open

```bash
cd /path/to/fragile
panel serve src/analysis/theorem_graph_dashboard.py
```

This starts a Panel server without opening the browser. Access at http://localhost:5006/theorem_graph_dashboard

#### Method 3: Jupyter Notebook

```python
from analysis.theorem_graph_dashboard import TheoremGraphDashboard

dashboard = TheoremGraphDashboard()
template = dashboard.create_dashboard()
template.servable()
```

### Graph Data Source

The dashboard loads data from `docs/math_graph.json`, which is generated by:

```bash
python build_math_graph.py
```

This extracts all theorems from the markdown documentation and builds the dependency graph.

### Navigation Tips

1. **Start with filtering**: The full graph (855 nodes) can be overwhelming. Filter by:
   - **Chapter**: Focus on one chapter at a time
   - **Recommendation**: See only "Accept" or "Minor revision" theorems
   - **Status**: View proven theorems only

2. **Explore dependencies**:
   - Click a node to see what it depends on and what depends on it
   - Use the dependency information to understand proof chains

3. **Assess quality**:
   - Color shows recommendation status at a glance
   - Node size shows impact (how many theorems depend on this one)
   - Filter by rigor/strategy to find high-quality proofs

4. **Find high-priority work**:
   - Large nodes with red color = high-impact theorems needing work
   - Yellow nodes = nearly complete, easy wins
   - Cross-chapter edges = important connections to verify

### Example Workflows

#### Find High-Impact Theorems to Prove

1. Filter by **Recommendation**: "Reject"
2. In the graph controls, set **Node size** to "n_dependents"
3. Look for **large red nodes** - these are unproven theorems that many others depend on
4. Click to see dependencies and start proving them

#### Assess Chapter Quality

1. Filter by **Chapter**: Select one chapter
2. View statistics panel to see:
   - Breakdown by recommendation
   - Average rigor and strategy scores
   - Proof status distribution

#### Track Cross-Chapter Dependencies

1. In edge controls, set **Edge color** to "cross_chapter"
2. Different colored edges show dependencies between chapters
3. Verify these dependencies are valid and documented

#### Find Proof Gaps

1. Filter by **Status**: "needs_proof"
2. Filter by **Type**: "Theorem" or "Lemma"
3. View the remaining theorems that need proofs
4. Sort by impact using node size

### Performance Notes

- **Initial load**: 1-2 seconds for JSON parsing
- **Layout computation**: 2-3 seconds for Graphviz hierarchical layout
- **Filtering**: Real-time updates
- **Memory**: ~50-100 MB in browser for full graph
- **Recommended**: Start filtered (one chapter) for better responsiveness

### Troubleshooting

**Dashboard won't start:**
```bash
# Check if math_graph.json exists
ls docs/math_graph.json

# If missing, regenerate:
python build_math_graph.py
```

**Graph layout issues:**
```bash
# Install graphviz system dependency
sudo apt-get install graphviz  # Ubuntu/Debian
brew install graphviz           # macOS
```

**Slow performance:**
- Filter to fewer nodes (try single chapter)
- Close other browser tabs
- Use Chrome/Firefox (best Bokeh performance)

### Technical Details

**Architecture:**
- **Backend**: NetworkX for graph data structure
- **Layout**: Graphviz DOT algorithm (hierarchical)
- **Frontend**: HoloViews + Bokeh for interactive visualization
- **Dashboard**: Panel for widget controls and layout
- **Integration**: Shaolin graph utilities for dimension mapping

**Graph Structure:**
- **Nodes**: 855 theorems with metadata (type, chapter, rigor, strategy, etc.)
- **Edges**: ~2000+ dependency relationships
- **Attributes**:
  - Node: label, type, title, chapter, document, line, rigor, strategy, status, recommendation, tags
  - Edge: cross_chapter, chapter_from, chapter_to

### Future Enhancements

Potential improvements:
- [ ] Search box to find theorems by label/title
- [ ] Export filtered graph as GraphML/DOT
- [ ] Shortest path finder between two theorems
- [ ] Critical path analysis for proof scheduling
- [ ] Integration with automated proof pipeline
- [ ] Diff view between graph versions (track progress)
- [ ] Highlight connected components on node selection
- [ ] Export publication-ready figures (SVG/PDF)

### Related Files

- `build_math_graph.py`: Generates the graph data
- `docs/math_graph.json`: Graph data file
- `docs/MATH_GRAPH_SUMMARY.md`: Analysis summary
- `src/fragile/shaolin/graph.py`: Graph visualization utilities

### License

Same as the Fragile project.

### Contact

For issues or questions, please file an issue in the project repository.
