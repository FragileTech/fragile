
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Function Optimization &#8212; Fragile 0.0a documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Atari games" href="atari.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="function-optimization">
<h1>Function Optimization<a class="headerlink" href="#function-optimization" title="Permalink to this headline">¶</a></h1>
<div class="section" id="environments">
<h2>Environments<a class="headerlink" href="#environments" title="Permalink to this headline">¶</a></h2>
<div class="section" id="function">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code><a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="fragile.optimize.env.Function">
<em class="property">class </em><code class="sig-prename descclassname">fragile.optimize.env.</code><code class="sig-name descname">Function</code><span class="sig-paren">(</span><em class="sig-param">function: Callable[[&lt;MagicMock id='140518216624336'&gt;], &lt;MagicMock id='140518216850640'&gt;], bounds: fragile.core.bounds.Bounds</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/env.html#Function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Function" title="Permalink to this definition">¶</a></dt>
<dd><p>Environment that represents an arbitrary mathematical function bounded in a     given interval.</p>
<dl class="method">
<dt id="fragile.optimize.env.Function.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">function: Callable[[&lt;MagicMock id='140518216624336'&gt;], &lt;MagicMock id='140518216850640'&gt;], bounds: fragile.core.bounds.Bounds</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/env.html#Function.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Function.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – Callable that takes a batch of vectors (batched across                       the first dimension of the array) and returns a vector of                       scalar. This function is applied to a batch of walker                       observations.</p></li>
<li><p><strong>bounds</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Bounds</span></code> that defines the domain of the function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.env.Function.calculate_end">
<code class="sig-name descname">calculate_end</code><span class="sig-paren">(</span><em class="sig-param">points: &lt;MagicMock id='140518217004112'&gt;</em><span class="sig-paren">)</span> &#x2192; &lt;MagicMock id='140518214372752'&gt;<a class="reference internal" href="../_modules/fragile/optimize/env.html#Function.calculate_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Function.calculate_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if a given batch of vectors lie inside the function domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>points</strong> – Array of batched vectors that will be checked to lie inside             the <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> bounds.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of booleans of length batch_size (points.shape[0]) that will             be <code class="docutils literal notranslate"><span class="pre">True</span></code> if a given point of the batch lies outside the bounds,             and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.env.Function.from_bounds_params">
<em class="property">classmethod </em><code class="sig-name descname">from_bounds_params</code><span class="sig-paren">(</span><em class="sig-param">function: Callable</em>, <em class="sig-param">shape: tuple = None</em>, <em class="sig-param">high: Union[int</em>, <em class="sig-param">float</em>, <em class="sig-param">&lt;MagicMock id='140518225725392'&gt;] = &lt;MagicMock id='140518216939536'&gt;</em>, <em class="sig-param">low: Union[int</em>, <em class="sig-param">float</em>, <em class="sig-param">&lt;MagicMock id='140518218233552'&gt;] = &lt;MagicMock name='mock.__neg__()' id='140518218234384'&gt;</em><span class="sig-paren">)</span> &#x2192; fragile.optimize.env.Function<a class="reference internal" href="../_modules/fragile/optimize/env.html#Function.from_bounds_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Function.from_bounds_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a function defining its shape and bounds without using a <code class="xref py py-class docutils literal notranslate"><span class="pre">Bounds</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – Callable that takes a batch of vectors (batched across                       the first dimension of the array) and returns a vector of                       scalar. This function is applied to a batch of walker                       observations.</p></li>
<li><p><strong>shape</strong> – Input shape of the solution vector without taking into account                     the batch dimension. For example, a two dimensional function                     applied to a batch of 5 walkers will have shape=(2,), even though
the observations will have shape (5, 2)</p></li>
<li><p><strong>high</strong> – Upper bound of the function domain. If it’s an scalar it will                   be the same for all dimensions. If its a numpy array it will                   be the upper bound for each dimension.</p></li>
<li><p><strong>low</strong> – Lower bound of the function domain. If it’s an scalar it will                   be the same for all dimensions. If its a numpy array it will                   be the lower bound for each dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> with its <code class="xref py py-class docutils literal notranslate"><span class="pre">Bounds</span></code> created from the provided arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.env.Function.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param">batch_size: int = 1</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; fragile.core.states.StatesEnv<a class="reference internal" href="../_modules/fragile/optimize/env.html#Function.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Function.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> to the start of a new episode and returns         an <code class="xref py py-class docutils literal notranslate"><span class="pre">StatesEnv</span></code> instance describing its internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> – Number of walkers that the returned state will have.</p></li>
<li><p><strong>**kwargs</strong> – Ignored. This environment resets without using any external data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">EnvStates</span></code> instance describing the state of the <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>.             The first dimension of the data tensors (number of walkers) will be             equal to batch_size.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.env.Function.sample_bounds">
<code class="sig-name descname">sample_bounds</code><span class="sig-paren">(</span><em class="sig-param">batch_size: int</em><span class="sig-paren">)</span> &#x2192; &lt;MagicMock id='140518214394064'&gt;<a class="reference internal" href="../_modules/fragile/optimize/env.html#Function.sample_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Function.sample_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a matrix of points sampled uniformly from the <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>         domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_size</strong> – Number of points that will be sampled.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array containing <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> points that lie inside the             <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> domain, stacked across the first dimension.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.env.Function.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">model_states: fragile.core.states.StatesModel</em>, <em class="sig-param">env_states: fragile.core.states.StatesEnv</em><span class="sig-paren">)</span> &#x2192; fragile.core.states.StatesEnv<a class="reference internal" href="../_modules/fragile/optimize/env.html#Function.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Function.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> to the target states and sums the actions         provided by the <code class="xref py py-class docutils literal notranslate"><span class="pre">StatesEnv</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_states</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">StatesModel</span></code> corresponding to the <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code> data.</p></li>
<li><p><strong>env_states</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">StatesEnv</span></code> containing the data where the function              will be evaluated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">StatesEnv</span></code> containing the information that describes the             new states sampled.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="minimizer">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code><a class="headerlink" href="#minimizer" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="fragile.optimize.env.Minimizer">
<em class="property">class </em><code class="sig-prename descclassname">fragile.optimize.env.</code><code class="sig-name descname">Minimizer</code><span class="sig-paren">(</span><em class="sig-param">function: fragile.optimize.env.Function</em>, <em class="sig-param">bounds=None</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/env.html#Minimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Minimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code> to a <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>.</p>
<dl class="method">
<dt id="fragile.optimize.env.Minimizer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">function: fragile.optimize.env.Function</em>, <em class="sig-param">bounds=None</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/env.html#Minimizer.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Minimizer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <a class="reference internal" href="#fragile.optimize.env.Minimizer" title="fragile.optimize.env.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> that will be minimized.</p></li>
<li><p><strong>bounds</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Bounds</span></code> defining the domain of the minimization                     process. If it is <code class="docutils literal notranslate"><span class="pre">None</span></code> the <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> <code class="xref py py-class docutils literal notranslate"><span class="pre">Bounds</span></code>                     will be used.</p></li>
<li><p><strong>*args</strong> – Passed to <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Passed to <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.env.Minimizer.minimize">
<code class="sig-name descname">minimize</code><span class="sig-paren">(</span><em class="sig-param">x: &lt;MagicMock id='140518214411216'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/env.html#Minimizer.minimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Minimizer.minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code> to a single point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – Array representing a single point of the function to be minimized.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Optimization result object returned by <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.env.Minimizer.minimize_batch">
<code class="sig-name descname">minimize_batch</code><span class="sig-paren">(</span><em class="sig-param">x: &lt;MagicMock id='140518214457424'&gt;</em><span class="sig-paren">)</span> &#x2192; Tuple[&lt;MagicMock id='140518216352848'&gt;, &lt;MagicMock id='140518216370000'&gt;]<a class="reference internal" href="../_modules/fragile/optimize/env.html#Minimizer.minimize_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Minimizer.minimize_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimize a batch of points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – Array representing a batch of points to be optimized, stacked                across the first dimension.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of arrays containing the local optimum found for each point,             and an array with the values assigned to each of the points found.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.env.Minimizer.minimize_point">
<code class="sig-name descname">minimize_point</code><span class="sig-paren">(</span><em class="sig-param">x: &lt;MagicMock id='140518214424272'&gt;</em><span class="sig-paren">)</span> &#x2192; Tuple[&lt;MagicMock id='140518214437328'&gt;, Union[int, &lt;MagicMock id='140518232624400'&gt;, float, &lt;MagicMock id='140518232633296'&gt;]]<a class="reference internal" href="../_modules/fragile/optimize/env.html#Minimizer.minimize_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.Minimizer.minimize_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimize the target function passing one starting point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – Array representing a single point of the function to be minimized.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple containing a numpy array representing the best solution found,             and the numerical value of the function at that point.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="minimizerwrapper">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerWrapper</span></code><a class="headerlink" href="#minimizerwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="fragile.optimize.env.MinimizerWrapper">
<em class="property">class </em><code class="sig-prename descclassname">fragile.optimize.env.</code><code class="sig-name descname">MinimizerWrapper</code><span class="sig-paren">(</span><em class="sig-param">function: fragile.optimize.env.Function</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/env.html#MinimizerWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.MinimizerWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper that applies a local minimization process to the observations     returned by a <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>.</p>
<dl class="method">
<dt id="fragile.optimize.env.MinimizerWrapper.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">function: fragile.optimize.env.Function</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/env.html#MinimizerWrapper.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.MinimizerWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <a class="reference internal" href="#fragile.optimize.env.MinimizerWrapper" title="fragile.optimize.env.MinimizerWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerWrapper</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> to be minimized after each step.</p></li>
<li><p><strong>*args</strong> – Passed to the internal <code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Passed to the internal <code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.env.MinimizerWrapper.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">model_states: fragile.core.states.StatesModel</em>, <em class="sig-param">env_states: fragile.core.states.StatesEnv</em><span class="sig-paren">)</span> &#x2192; fragile.core.states.StatesEnv<a class="reference internal" href="../_modules/fragile/optimize/env.html#MinimizerWrapper.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.env.MinimizerWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a local optimization process to the observations returned after         calling <code class="docutils literal notranslate"><span class="pre">step</span></code> on the wrapped <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_states</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">StatesModel</span></code> corresponding to the <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code> data.</p></li>
<li><p><strong>env_states</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">StatesEnv</span></code> containing the data where the function              will be evaluated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>States containing the information that describes the new state of             the <a class="reference internal" href="#fragile.optimize.env.Function" title="fragile.optimize.env.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="models">
<h2>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h2>
<div class="section" id="evolutionary-strategy-esmodel">
<h3>Evolutionary strategy (<code class="xref py py-class docutils literal notranslate"><span class="pre">ESModel</span></code>)<a class="headerlink" href="#evolutionary-strategy-esmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="fragile.optimize.models.ESModel">
<em class="property">class </em><code class="sig-prename descclassname">fragile.optimize.models.</code><code class="sig-name descname">ESModel</code><span class="sig-paren">(</span><em class="sig-param">mutation: float = 0.5</em>, <em class="sig-param">recombination: float = 0.7</em>, <em class="sig-param">random_step_prob: float = 0.1</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/models.html#ESModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.models.ESModel" title="Permalink to this definition">¶</a></dt>
<dd><p>The ESModel implements an evolutionary strategy policy.</p>
<p>It mutates randomly some of the coordinates of the best solution found by     substituting them with a proposal solution. This proposal solution is the     difference between two random permutations of the best solution found.</p>
<p>It applies a gaussian normal perturbation with a probability given by <code class="docutils literal notranslate"><span class="pre">mutation</span></code>.</p>
<dl class="method">
<dt id="fragile.optimize.models.ESModel.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">mutation: float = 0.5</em>, <em class="sig-param">recombination: float = 0.7</em>, <em class="sig-param">random_step_prob: float = 0.1</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/models.html#ESModel.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.models.ESModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <a class="reference internal" href="#fragile.optimize.models.ESModel" title="fragile.optimize.models.ESModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ESModel</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mutation</strong> – Probability of mutating a coordinate of the solution vector.</p></li>
<li><p><strong>recombination</strong> – Step size of the update applied to the best solution found.</p></li>
<li><p><strong>random_step_prob</strong> – Probability of applying a random normal perturbation.</p></li>
<li><p><strong>*args</strong> – Passed to the parent <code class="xref py py-class docutils literal notranslate"><span class="pre">NormalContinuous</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Passed to the parent <code class="xref py py-class docutils literal notranslate"><span class="pre">NormalContinuous</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.models.ESModel.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param">batch_size: int</em>, <em class="sig-param">model_states: fragile.core.states.StatesModel = None</em>, <em class="sig-param">env_states: fragile.core.states.StatesEnv = None</em>, <em class="sig-param">walkers_states: fragile.core.states.StatesWalkers = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; fragile.core.states.StatesModel<a class="reference internal" href="../_modules/fragile/optimize/models.html#ESModel.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.models.ESModel.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the corresponding data to interact with the Environment and         store it in model states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> – Number of new points to the sampled.</p></li>
<li><p><strong>model_states</strong> – States corresponding to the environment data.</p></li>
<li><p><strong>env_states</strong> – States corresponding to the model data.</p></li>
<li><p><strong>walkers_states</strong> – States corresponding to the walkers data.</p></li>
<li><p><strong>kwargs</strong> – Passed to the <code class="xref py py-class docutils literal notranslate"><span class="pre">Critic</span></code> if any.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple containing a tensor with the sampled actions and the new model states variable.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="swarm">
<h2>Swarm<a class="headerlink" href="#swarm" title="Permalink to this headline">¶</a></h2>
<div class="section" id="functionmapper">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionMapper</span></code><a class="headerlink" href="#functionmapper" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="fragile.optimize.swarm.FunctionMapper">
<em class="property">class </em><code class="sig-prename descclassname">fragile.optimize.swarm.</code><code class="sig-name descname">FunctionMapper</code><span class="sig-paren">(</span><em class="sig-param">model: Callable = &lt;function FunctionMapper.&lt;lambda&gt;&gt;</em>, <em class="sig-param">accumulate_rewards: bool = False</em>, <em class="sig-param">minimize: bool = True</em>, <em class="sig-param">start_same_pos: bool = False</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/swarm.html#FunctionMapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.swarm.FunctionMapper" title="Permalink to this definition">¶</a></dt>
<dd><p>It is a swarm adapted to minimize mathematical functions.</p>
<dl class="method">
<dt id="fragile.optimize.swarm.FunctionMapper.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">model: Callable = &lt;function FunctionMapper.&lt;lambda&gt;&gt;</em>, <em class="sig-param">accumulate_rewards: bool = False</em>, <em class="sig-param">minimize: bool = True</em>, <em class="sig-param">start_same_pos: bool = False</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/swarm.html#FunctionMapper.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.swarm.FunctionMapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <a class="reference internal" href="#fragile.optimize.swarm.FunctionMapper" title="fragile.optimize.swarm.FunctionMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionMapper</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – A function that returns an instance of a <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code>.</p></li>
<li><p><strong>accumulate_rewards</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code> the rewards obtained after transitioning                                 to a new state will accumulate. If <code class="docutils literal notranslate"><span class="pre">False</span></code> only the last                                 reward will be taken into account.</p></li>
<li><p><strong>minimize</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code> the algorithm will perform a minimization                       process. If <code class="docutils literal notranslate"><span class="pre">False</span></code> it will be a maximization process.</p></li>
<li><p><strong>start_same_pos</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code> all the walkers will have the same                             starting position.</p></li>
<li><p><strong>*args</strong> – Passed <code class="xref py py-class docutils literal notranslate"><span class="pre">Swarm</span></code> __init__.</p></li>
<li><p><strong>**kwargs</strong> – Passed <code class="xref py py-class docutils literal notranslate"><span class="pre">Swarm</span></code> __init__.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.swarm.FunctionMapper.from_function">
<em class="property">classmethod </em><code class="sig-name descname">from_function</code><span class="sig-paren">(</span><em class="sig-param">function: Callable</em>, <em class="sig-param">bounds: fragile.core.bounds.Bounds</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; fragile.optimize.swarm.FunctionMapper<a class="reference internal" href="../_modules/fragile/optimize/swarm.html#FunctionMapper.from_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.swarm.FunctionMapper.from_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <a class="reference internal" href="#fragile.optimize.swarm.FunctionMapper" title="fragile.optimize.swarm.FunctionMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionMapper</span></code></a> using a python callable and a         <code class="xref py py-class docutils literal notranslate"><span class="pre">Bounds</span></code> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – Callable representing an arbitrary function to be optimized.</p></li>
<li><p><strong>bounds</strong> – Represents the domain of the function to be optimized.</p></li>
<li><p><strong>*args</strong> – Passed to <a class="reference internal" href="#fragile.optimize.swarm.FunctionMapper" title="fragile.optimize.swarm.FunctionMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionMapper</span></code></a> __init__.</p></li>
<li><p><strong>**kwargs</strong> – Passed to <a class="reference internal" href="#fragile.optimize.swarm.FunctionMapper" title="fragile.optimize.swarm.FunctionMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionMapper</span></code></a> __init__.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Instance of <a class="reference internal" href="#fragile.optimize.swarm.FunctionMapper" title="fragile.optimize.swarm.FunctionMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionMapper</span></code></a> that optimizes the target function.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fragile.optimize.swarm.FunctionMapper.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param">walkers_states: fragile.core.states.StatesWalkers = None</em>, <em class="sig-param">model_states: fragile.core.states.StatesModel = None</em>, <em class="sig-param">env_states: fragile.core.states.StatesEnv = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fragile/optimize/swarm.html#FunctionMapper.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fragile.optimize.swarm.FunctionMapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the <code class="xref py py-class docutils literal notranslate"><span class="pre">fragile.Walkers</span></code>, the <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> environment, the         <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code> and clear the internal data to start a new search process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_states</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">StatesModel</span></code> that define the initial state of                           the <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code>.</p></li>
<li><p><strong>env_states</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">StatesEnv</span></code> that define the initial state of                         the <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p></li>
<li><p><strong>walkers_states</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">StatesWalkers</span></code> that define the internal                             states of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Walkers</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Fragile</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../resources/architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/examples/examples_index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core module</a></li>
<li class="toctree-l1"><a class="reference internal" href="atari.html">Atari games</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Function Optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#environments">Environments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#minimizerwrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerWrapper</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#models">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#evolutionary-strategy-esmodel">Evolutionary strategy (<code class="xref py py-class docutils literal notranslate"><span class="pre">ESModel</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#swarm">Swarm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#functionmapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionMapper</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="atari.html" title="previous chapter">Atari games</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Guillem Duran, Sergio Hernandez.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/module_docs/optimize.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>