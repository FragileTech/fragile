<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 520" role="img" aria-label="Phase-space neighbors mapped to softmax companion weights">
  <defs>
    <style>
      .bg { fill: #ffffff; }
      .panel { fill: #f8fbff; stroke: #c5d3df; stroke-width: 1.5; }
      .title { fill: #0b1d39; font-size: 20px; font-family: Arial, Helvetica, sans-serif; font-weight: 600; }
      .panel-title { fill: #1b2a3a; font-size: 16px; font-family: Arial, Helvetica, sans-serif; font-weight: 600; }
      .label { fill: #4b5563; font-size: 13px; font-family: Arial, Helvetica, sans-serif; }
      .node { fill: #2a9d8f; }
      .node-focus { fill: #e76f51; }
      .node-companion { fill: #f4a261; }
      .bar { fill: #2a9d8f; }
      .bar-focus { fill: #e76f51; }
      .arrow { stroke: #1f4b99; stroke-width: 2; fill: none; }
      .vel { stroke: #5f8cc4; stroke-width: 1.8; fill: none; }
      .axis { stroke: #9aa7b1; stroke-width: 1.2; }
    </style>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#1f4b99" />
    </marker>
    <marker id="vel" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#5f8cc4" />
    </marker>
  </defs>

  <rect class="bg" width="1000" height="520" />
  <text class="title" x="500" y="48" text-anchor="middle">Soft companion selection in phase space</text>

  <rect class="panel" x="60" y="80" width="400" height="360" rx="14" />
  <rect class="panel" x="540" y="80" width="400" height="360" rx="14" />

  <text class="panel-title" x="260" y="118" text-anchor="middle">Phase-space neighbors</text>
  <text class="panel-title" x="740" y="118" text-anchor="middle">Softmax weights</text>

  <circle class="node" cx="150" cy="190" r="7" />
  <path class="vel" d="M 150 190 L 135 165" marker-end="url(#vel)" />
  <circle class="node" cx="220" cy="160" r="7" />
  <path class="vel" d="M 220 160 L 250 150" marker-end="url(#vel)" />
  <circle class="node" cx="330" cy="170" r="7" />
  <path class="vel" d="M 330 170 L 350 145" marker-end="url(#vel)" />
  <circle class="node-companion" cx="350" cy="260" r="8" />
  <path class="vel" d="M 350 260 L 375 275" marker-end="url(#vel)" />
  <circle class="node" cx="190" cy="300" r="7" />
  <path class="vel" d="M 190 300 L 165 320" marker-end="url(#vel)" />
  <circle class="node" cx="300" cy="330" r="7" />
  <path class="vel" d="M 300 330 L 320 350" marker-end="url(#vel)" />

  <circle class="node-focus" cx="260" cy="250" r="10" />
  <text class="label" x="260" y="280" text-anchor="middle">walker i</text>
  <path class="arrow" d="M 268 246 L 338 258" marker-end="url(#arrow)" />
  <text class="label" x="325" y="230">d_alg</text>

  <line class="axis" x1="590" y1="400" x2="890" y2="400" />
  <rect class="bar" x="600" y="320" width="40" height="80" rx="4" />
  <rect class="bar" x="660" y="260" width="40" height="140" rx="4" />
  <rect class="bar-focus" x="720" y="220" width="40" height="180" rx="4" />
  <rect class="bar" x="780" y="300" width="40" height="100" rx="4" />
  <rect class="bar" x="840" y="340" width="40" height="60" rx="4" />

  <text class="label" x="620" y="425" text-anchor="middle">j1</text>
  <text class="label" x="680" y="425" text-anchor="middle">j2</text>
  <text class="label" x="740" y="425" text-anchor="middle">j3</text>
  <text class="label" x="800" y="425" text-anchor="middle">j4</text>
  <text class="label" x="860" y="425" text-anchor="middle">j5</text>

  <path class="arrow" d="M 460 260 L 540 260" marker-end="url(#arrow)" />
  <text class="label" x="500" y="245" text-anchor="middle">P_i(j)</text>
  <text class="label" x="740" y="455" text-anchor="middle">Higher weights for closer phase-space neighbors</text>
</svg>
