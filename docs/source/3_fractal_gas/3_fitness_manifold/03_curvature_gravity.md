(sec-curvature-from-holonomy)=
# Curvature from Discrete Holonomy

**Prerequisites**: {doc}`01_emergent_geometry`, {doc}`02_scutoid_spacetime`

---

(sec-tldr-curvature)=
## TLDR

*Notation: $g_{ab}$ = emergent metric ({prf:ref}`def-adaptive-diffusion-tensor-latent`); $\Gamma^a_{bc}$ = Christoffel symbols; $R^a_{bcd}$ = Riemann tensor; $R_{bd}$ = Ricci tensor; $R$ = Ricci scalar; $\theta$ = expansion scalar; $\sigma_{\mu\nu}$ = shear tensor; $\omega_{\mu\nu}$ = vorticity tensor; $V_{\mathrm{fit}}$ = fitness potential; $H = \nabla^2 V_{\mathrm{fit}}$ = fitness Hessian.*

**Riemann-Scutoid Dictionary**: The Riemann curvature tensor is recovered asymptotically from holonomy around scutoid plaquettes:

$$
R^a{}_{bcd}(z) V^b T^c T^d = \lim_{A_\Pi \to 0} \frac{\Delta V^a}{A_\Pi} + O(A_\Pi^{1/2})
$$

where $\Delta V^a$ is the holonomy defect for a test vector transported around a plaquette of area $A_\Pi$.

**Raychaudhuri Equation**: The expansion of geodesic bundles evolves according to:

$$
\frac{d\theta}{d\tau} = -\frac{1}{d}\theta^2 - \sigma_{\mu\nu}\sigma^{\mu\nu} + \omega_{\mu\nu}\omega^{\mu\nu} - R_{\mu\nu}u^\mu u^\nu
$$

Positive Ricci curvature causes geodesic focusing---the geometric mechanism underlying gravitational attraction.

**Discrete Raychaudhuri Correspondence** ({prf:ref}`thm-discrete-raychaudhuri`): Under regularity conditions, discrete Voronoi volume evolution converges to the continuous Raychaudhuri equation with error $O(\epsilon_N)$ where $\epsilon_N \sim N^{-1/d}$ is the inter-particle spacing.

**Focusing Theorem**: Under the strong energy condition ($R_{\mu\nu}u^\mu u^\nu \geq 0$) and vorticity-free flow, convergence occurs within time $\tau_* \leq d/|\theta_0|$.

---

(sec-introduction-curvature)=
## Introduction

:::{div} feynman-prose
Let me tell you what this chapter is really about. We have built two beautiful structures in the previous chapters: a continuous Riemannian geometry from the fitness landscape ({doc}`01_emergent_geometry`), and a discrete tessellation of spacetime from cloning events ({doc}`02_scutoid_spacetime`). Now we face the deepest question: how does *curvature* emerge from this discrete structure?

The answer is one of the most beautiful ideas in geometry: **holonomy**. Carry a vector around a closed loop in curved space, and it comes back rotated. The rotation angle measures the curvature enclosed by the loop. This works for finite loops, not just infinitesimal ones.
:::

(sec-tessellation-to-curvature)=
## From Tessellation to Curvature

:::{prf:definition} Affine Connection from Emergent Metric
:label: def-affine-connection

Let $g(z, S) = H(z, S) + \epsilon_\Sigma I$ be the emergent metric from {prf:ref}`def-adaptive-diffusion-tensor-latent`. The **Levi-Civita connection** has Christoffel symbols:

$$
\Gamma^a_{bc}(z) = \frac{1}{2} g^{ad}(z) \left( \frac{\partial g_{db}}{\partial z^c} + \frac{\partial g_{dc}}{\partial z^b} - \frac{\partial g_{bc}}{\partial z^d} \right)
$$

**Properties:**
1. **Metric compatibility**: $\nabla_a g_{bc} = 0$
2. **Torsion-free**: $\Gamma^a_{bc} = \Gamma^a_{cb}$
3. **Uniqueness**: The Levi-Civita connection is unique with (1) and (2)

The Christoffel symbols depend on **third derivatives** of $V_{\mathrm{fit}}$.
:::

(sec-parallel-transport-holonomy)=
## Parallel Transport and Holonomy

:::{prf:definition} Parallel Transport
:label: def-parallel-transport

Let $\gamma: [0, 1] \to \mathcal{Z}$ be a smooth curve. The **parallel transport** of $V^a \in T_{\gamma(0)}\mathcal{Z}$ along $\gamma$ solves:

$$
\frac{DV^a}{ds} := \frac{dV^a}{ds} + \Gamma^a_{bc}(\gamma(s)) V^b \dot{\gamma}^c = 0
$$

The parallel transport operator $P_\gamma: T_{\gamma(0)}\mathcal{Z} \to T_{\gamma(1)}\mathcal{Z}$ is the linear map $V \mapsto V(1)$.
:::

:::{prf:definition} Holonomy
:label: def-holonomy

For a closed loop $\gamma$ based at $p$, the **holonomy** $\mathrm{Hol}_\gamma: T_p\mathcal{Z} \to T_p\mathcal{Z}$ is parallel transport around the loop.

- $\mathrm{Hol}_\gamma \in O(d)$ for Levi-Civita connection
- $\mathrm{Hol}_\gamma = I$ for all contractible loops iff the manifold is flat
:::

:::{prf:theorem} Ambrose-Singer Theorem
:label: thm-ambrose-singer

The Lie algebra of the holonomy group at $p$ is generated by curvature:

$$
\mathfrak{hol}_p = \mathrm{span}\{P_\gamma^{-1} R(X, Y) P_\gamma : \gamma \text{ any curve from } p\}
$$

*Reference:* {cite}`ambrose1953theorem`
*Proof.* See Theorem {prf:ref}`appx-ambrose-singer` in {doc}`../appendices/17_geometric_gas`. $\square$
:::

:::{prf:lemma} Holonomy of Small Loops
:label: lem-holonomy-small-loops

For a small loop $\gamma = \partial \Sigma$ bounding surface $\Sigma$ with area $A$:

$$
(\mathrm{Hol}_\gamma)^a{}_b - \delta^a_b = R^a{}_{bcd} T^{cd} A + O(A^{3/2})
$$

where $T^{cd}$ is the tangent bivector to $\Sigma$.

*Proof.* See Lemma {prf:ref}`appx-holonomy-small-loops` in {doc}`../appendices/17_geometric_gas`. $\square$
:::

---

(sec-riemann-scutoid-dictionary)=
## The Riemann-Scutoid Dictionary

:::{prf:definition} Scutoid Plaquette
:label: def-scutoid-plaquette

A **scutoid plaquette** $\Pi$ is a closed quadrilateral:
1. Bottom edge $e_{\mathrm{bot}} = (z_i(t), z_j(t))$
2. Forward trajectory $\gamma_i: z_i(t) \to z_i(t + \Delta t)$
3. Top edge $e_{\mathrm{top}}$
4. Backward trajectory $\gamma_j^{-1}$

Area: $A_\Pi \approx \ell \cdot c \cdot \Delta t$ where $\ell$ is edge length.
:::

:::{prf:theorem} Riemann-Scutoid Correspondence
:label: thm-riemann-scutoid

The Riemann tensor is recovered from plaquette holonomy:

$$
R^a{}_{bcd}(z) V^b T^c T^d = \lim_{A_\Pi \to 0} \frac{(\mathcal{H}[\Pi]^a{}_b - \delta^a_b) V^b}{A_\Pi}
$$

**Error estimate:** For bounded curvature derivatives $|\nabla R| \leq C_R$:

$$
\left| \frac{\Delta V^a}{A_\Pi} - R^a{}_{bcd} V^b T^c T^d \right| \leq C_R \cdot A_\Pi^{1/2} \cdot |V|
$$

*Proof.* Direct application of Lemma {prf:ref}`lem-holonomy-small-loops`. $\square$
:::

---

(sec-riemann-tensor)=
## Riemann Tensor

:::{prf:definition} Riemann Curvature Tensor
:label: def-riemann-tensor

$$
R^a{}_{bcd} = \partial_c \Gamma^a_{bd} - \partial_d \Gamma^a_{bc} + \Gamma^a_{ce} \Gamma^e_{bd} - \Gamma^a_{de} \Gamma^e_{bc}
$$

For emergent metric $g = H + \epsilon_\Sigma I$ with $H = \nabla^2 V_{\mathrm{fit}}$, the Riemann tensor involves **fourth derivatives** of $V_{\mathrm{fit}}$.
:::

:::{prf:definition} Ricci Tensor and Scalar
:label: def-ricci-tensor-scalar

**Ricci tensor:** $R_{bd} = R^a{}_{bad}$

**Ricci scalar:** $R = g^{bd} R_{bd}$

- $R > 0$: Positive curvature, geodesics focus
- $R < 0$: Negative curvature, geodesics diverge
:::

---

(sec-discrete-connection)=
## Discrete Connection Recovery

:::{prf:definition} Edge Deformation
:label: def-edge-deformation

For Delaunay edge $e = (z_i, z_j)$, the **edge deformation** is:

$$
\Delta \ell^a_{ij} = \ell^a_{ij}(t + \Delta t) - P^a{}_b[\gamma_i] \ell^b_{ij}(t)
$$

where $\ell^a_{ij} = z^a_j - z^a_i$ and $P[\gamma_i]$ is parallel transport along walker $i$'s trajectory.
:::

:::{prf:proposition} Connection via Least Squares
:label: prop-connection-least-squares

Christoffel symbols are recovered by minimizing:

$$
\min_{\Gamma^a_{bc}} \sum_{j \in \mathcal{N}_i} \left\| \Delta \ell^a_{ij} - \Gamma^a_{bc} \ell^b_{ij} v^c_i \Delta t \right\|^2
$$

**Error:** $|\Gamma^{\mathrm{discrete}} - \Gamma^{\mathrm{true}}| = O(h)$ for mesh size $h$.
:::

---

(sec-raychaudhuri)=
## The Raychaudhuri Equation

:::{prf:definition} Kinematic Decomposition
:label: def-kinematic-decomposition

For velocity field $u^\mu$:

$$
\nabla_\mu u_\nu = \frac{1}{d}\theta \, h_{\mu\nu} + \sigma_{\mu\nu} + \omega_{\mu\nu}
$$

where:
- $\theta = \nabla_\mu u^\mu$ (expansion)
- $\sigma_{\mu\nu}$ = symmetric traceless part (shear)
- $\omega_{\mu\nu}$ = antisymmetric part (vorticity)
- $h_{\mu\nu} = g_{\mu\nu} + u_\mu u_\nu$ (projection)
:::

:::{prf:theorem} Raychaudhuri Equation
:label: thm-raychaudhuri

For a geodesic congruence:

$$
\frac{d\theta}{d\tau} = -\frac{1}{d}\theta^2 - \sigma_{\mu\nu}\sigma^{\mu\nu} + \omega_{\mu\nu}\omega^{\mu\nu} - R_{\mu\nu}u^\mu u^\nu
$$

*Proof.* See Theorem {prf:ref}`appx-raychaudhuri` in {doc}`../appendices/17_geometric_gas`. $\square$
:::

---

(sec-discrete-raychaudhuri)=
## Discrete Raychaudhuri Correspondence

:::{div} feynman-prose
This is the key theorem connecting discrete Voronoi dynamics to continuous geometry. We show that the evolution of Voronoi cell volumes converges to the Raychaudhuri equation.
:::

:::{prf:definition} Regularity Conditions
:label: def-regularity-conditions

We require:

1. **Manifold smoothness:** $(M, g)$ is $C^\infty$ with bounded sectional curvature $|K| \leq K_{\max}$
2. **Flow regularity:** Velocity field $u \in C^3(M)$
3. **Well-distributed particles:** For characteristic spacing $\epsilon_N \sim N^{-1/d}$:
   - $\mathrm{diam}(\mathrm{Vor}_i) \leq C_1 \epsilon_N$
   - $\mathrm{Vol}(\mathrm{Vor}_i) \geq C_2 \epsilon_N^d$
   - Cells have bounded aspect ratio
4. **Injectivity:** $\epsilon_N < \mathrm{inj}(M)$ (injectivity radius)
:::

:::{prf:theorem} Discrete Raychaudhuri Correspondence
:label: thm-discrete-raychaudhuri

Under regularity conditions {prf:ref}`def-regularity-conditions`, the discrete expansion $\theta_i = \frac{1}{V_i}\frac{dV_i}{d\tau}$ satisfies:

$$
\frac{d\theta_i}{d\tau} = -\frac{1}{d}\theta_i^2 - \sigma^2(z_i) + \omega^2(z_i) - R_{\mu\nu}(z_i) u^\mu u^\nu + O(\epsilon_N)
$$

where $\sigma^2 = \sigma_{\mu\nu}\sigma^{\mu\nu}$ and $\omega^2 = \omega_{\mu\nu}\omega^{\mu\nu}$ are the continuous shear and vorticity at $z_i$.

**Error bound:**

$$
\left| \frac{d\theta_i}{d\tau} - \left( -\frac{1}{d}\theta_i^2 - \sigma^2 + \omega^2 - \mathrm{Ric}(u,u) \right) \right| \leq C \epsilon_N (\|u\|_{C^3} + \|\mathrm{Riem}\|_{C^1})
$$

*Proof.*

**Step 1: Volume evolution via Reynolds transport.**

By the Reynolds transport theorem for a moving domain (Lemma {prf:ref}`appx-reynolds-transport`):

$$
\frac{dV_i}{dt} = \int_{\partial \mathrm{Vor}_i} v_b \cdot n \, dA
$$

where $v_b$ is the boundary velocity and $n$ is the outward normal.

**Step 2: Boundary velocity from particle motion.**

The Voronoi boundary between cells $i$ and $j$ is the set of points equidistant from $z_i$ and $z_j$. For a point $x$ on this boundary:

$$
\psi(x, t) := \frac{1}{2}d_g^2(x, z_i) - \frac{1}{2}d_g^2(x, z_j) = 0
$$

Taking the total derivative $\frac{D\psi}{Dt} = 0$ and solving for boundary velocity (Lemma {prf:ref}`appx-voronoi-boundary-velocity`):

$$
v_b \cdot n_{ij} \approx \frac{u(z_i) + u(z_j)}{2} \cdot n_{ij} + O(\epsilon_N)
$$

(The error arises from the term $\delta \cdot (u_i - u_j)/|z_j - z_i|$ where $\delta$ is the displacement from the midpoint on the face.)

**Step 3: Apply divergence theorem.**

For smooth $u$ on a small cell (diameter $\sim \epsilon_N$) using Lemma {prf:ref}`appx-divergence-remainder`:

$$
\int_{\partial \mathrm{Vor}_i} u \cdot n \, dA = \int_{\mathrm{Vor}_i} \nabla \cdot u \, dV = V_i (\nabla \cdot u)(z_i) + O(\epsilon_N^{d+1})
$$

Therefore:

$$
\theta_i = \frac{1}{V_i}\frac{dV_i}{dt} = (\nabla \cdot u)(z_i) + O(\epsilon_N) = \theta(z_i) + O(\epsilon_N)
$$

**Step 4: Time derivative of expansion.**

$$
\frac{d\theta_i}{dt} = \frac{d}{dt}[(\nabla \cdot u)(z_i)] = u^\nu \nabla_\nu (\nabla_\mu u^\mu)\big|_{z_i} + O(\epsilon_N)
$$

**Step 5: Apply continuous Raychaudhuri.**

By Theorem {prf:ref}`thm-raychaudhuri` (classical proof in Appendix {doc}`../appendices/17_geometric_gas`), the continuous field satisfies:

$$
u^\nu \nabla_\nu \theta = -\frac{1}{d}\theta^2 - \sigma^2 + \omega^2 - R_{\mu\nu} u^\mu u^\nu
$$

Evaluating at $z_i$ and using $\theta_i = \theta(z_i) + O(\epsilon_N)$:

$$
\frac{d\theta_i}{dt} = -\frac{1}{d}\theta_i^2 - \sigma^2(z_i) + \omega^2(z_i) - R_{\mu\nu}(z_i) u^\mu u^\nu + O(\epsilon_N)
$$

The error bound follows from Taylor expansion estimates with $\|u\|_{C^3}$ and $\|\mathrm{Riem}\|_{C^1}$ controlling the remainder terms.

$\square$
:::

:::{prf:corollary} Exponential Relaxation
:label: cor-discrete-relaxation

Under the hypotheses of Theorem {prf:ref}`thm-discrete-raychaudhuri`, perturbations to uniform expansion decay:

$$
|\theta_i(t) - \bar{\theta}| \leq |\theta_i(0) - \bar{\theta}| \cdot e^{-\lambda t} + O(\epsilon_N)
$$

for some $\lambda > 0$ depending on the curvature bounds.
:::

---

(sec-focusing-theorem)=
## Focusing Theorem

:::{prf:definition} Strong Energy Condition
:label: def-sec

The **strong energy condition (SEC)** is: $R_{\mu\nu} u^\mu u^\nu \geq 0$ for all timelike $u$.
:::

:::{prf:theorem} Focusing Theorem
:label: thm-focusing

Under SEC, vorticity-free ($\omega = 0$), and initially converging ($\theta_0 < 0$):

$$
\theta(\tau) \to -\infty \quad \text{for } \tau \leq \tau_* = \frac{d}{|\theta_0|}
$$

*Proof.* From Raychaudhuri with SEC and $\omega = 0$: $\frac{d\theta}{d\tau} \leq -\frac{1}{d}\theta^2$. This Riccati inequality integrates to $\theta^{-1}(\tau) \geq \theta_0^{-1} + \tau/d$, which diverges at $\tau_* = d/|\theta_0|$. $\square$
:::

---

(sec-curvature-topology)=
## Curvature and Topology Changes

:::{prf:definition} Regge Curvature
:label: def-regge-curvature

In **Regge calculus** {cite}`regge1961general`, curvature on a polyhedral complex concentrates at $(d-2)$-dimensional **hinges**. The deficit angle at hinge $h$ is:

$$
\varepsilon_h = 2\pi - \sum_{\text{cells meeting at } h} \theta_{\text{dihedral}}
$$

The integrated scalar curvature is:

$$
\int R \sqrt{g} \, d^d x \approx 2 \sum_h \varepsilon_h \cdot \mathrm{Vol}_{d-2}(h)
$$
:::

:::{prf:theorem} Curvature-Topology Correspondence
:label: thm-curvature-topology

For a Voronoi tessellation on a $d$-dimensional flat manifold, let $F_k$ denote the number of $k$-dimensional faces. The Euler characteristic satisfies:

$$
\chi = \sum_{k=0}^{d} (-1)^k F_k
$$

For $d = 2$: $\chi = V - E + F$ where $V$ = vertices, $E$ = edges, $F$ = faces (cells).

**Consequence:** When a cloning event changes the cell count by $\Delta N$, the face counts change in a constrained way determined by Euler's relation.
:::

:::{prf:proposition} Curvature Change at Cloning (d=2)
:label: prop-curvature-change-2d

In $d = 2$, when a cell is added (cloning) or removed (death), the total curvature contribution changes by:

$$
\Delta \left( \sum_v \varepsilon_v \right) = O(1)
$$

with the precise value depending on the local geometry.

**For regular hexagonal lattice:** Each cell has 6 vertices shared among 3 cells. Adding one cell adds (on average) 2 vertices. By Gauss-Bonnet, each vertex contributes $\varepsilon_v = 2\pi - 3 \cdot \frac{2\pi}{3} = 0$ for flat space. Deviations from regularity create nonzero curvature.

*Proof.* Apply discrete Gauss-Bonnet: $\sum_v \varepsilon_v = 2\pi \chi$. For a bounded region, $\chi$ changes by $\pm 1$ when adding/removing a cell, giving $\Delta(\sum \varepsilon) = \pm 2\pi$. For an infinite tessellation with periodic boundary conditions, $\chi = 0$ and the total curvature is conserved, though it redistributes locally. $\square$
:::

:::{prf:remark} Higher Dimensions
:label: rem-higher-dim-curvature

For $d \geq 3$, the relationship between neighbor count changes and curvature is more complex:

- **d = 3:** Curvature concentrates at edges (1-dimensional hinges)
- **d = 4:** Curvature concentrates at faces (2-dimensional hinges)

The Regge action $S = \sum_h \varepsilon_h \cdot A_h$ changes when hinges are created/destroyed. A complete formula for $C_g(d)$ requires analyzing:

1. How many hinges meet at a typical $(d-1)$-face
2. The average solid angle deficit per hinge
3. How cloning affects the hinge structure

This is studied in discrete differential geometry {cite}`cheeger1984curvature` but a simple universal formula $\Delta(\int R) = C_g(d) \cdot \Delta N$ holds only under idealized assumptions (e.g., Poisson-Voronoi in flat space).
:::

---

(sec-fg-gravity-physical-interpretation)=
## Physical Interpretation

:::{prf:remark} Gravity-Optimization Correspondence
:label: rem-gravity-optimization

| General Relativity | Latent Fractal Gas |
|--------------------|--------------------|
| Spacetime manifold | Latent space + time |
| Metric $g_{\mu\nu}$ | Emergent metric $H + \epsilon_\Sigma I$ |
| Geodesics | Walker trajectories (approx.) |
| Riemann tensor | Fourth derivatives of fitness |
| Raychaudhuri equation | Voronoi volume evolution |
| Focusing (SEC) | Concentration toward optima |

**Caveat:** This is a *structural correspondence*. The LFG operates in latent space, not physical spacetime.
:::

:::{prf:remark} Focusing and Optimization
:label: rem-focusing-optimization

The focusing theorem ({prf:ref}`thm-focusing`) provides a geometric mechanism for convergence:

1. Positive Ricci curvature (from fitness landscape structure) causes geodesic focusing
2. Walkers following approximate geodesics converge
3. Post-focusing, the discrete cloning dynamics take over

**Full optimization analysis** requires combining:
- Geometric focusing (this chapter)
- Stochastic cloning/killing ({doc}`../1_the_algorithm/03_algorithmic_sieve`)
- QSD stability ({doc}`04_field_equations`)
:::

---

(sec-symbols-curvature)=
## Table of Symbols

| Symbol | Definition | Reference |
|--------|------------|-----------|
| $g_{ab}$ | Emergent metric | {prf:ref}`def-affine-connection` |
| $\Gamma^a_{bc}$ | Christoffel symbols | {prf:ref}`def-affine-connection` |
| $R^a{}_{bcd}$ | Riemann tensor | {prf:ref}`def-riemann-tensor` |
| $R_{bd}$ | Ricci tensor | {prf:ref}`def-ricci-tensor-scalar` |
| $R$ | Ricci scalar | {prf:ref}`def-ricci-tensor-scalar` |
| $\theta$ | Expansion scalar | {prf:ref}`def-kinematic-decomposition` |
| $\sigma_{\mu\nu}$ | Shear tensor | {prf:ref}`def-kinematic-decomposition` |
| $\omega_{\mu\nu}$ | Vorticity tensor | {prf:ref}`def-kinematic-decomposition` |
| $\mathrm{Hol}_\gamma$ | Holonomy | {prf:ref}`def-holonomy` |
| $\varepsilon_h$ | Deficit angle | {prf:ref}`def-regge-curvature` |
| $\epsilon_N$ | Inter-particle spacing | {prf:ref}`def-regularity-conditions` |

---

(sec-summary-curvature)=
## Summary

:::{admonition} Key Results
:class: tip

**Rigorous Theorems:**

1. **Ambrose-Singer** ({prf:ref}`thm-ambrose-singer`): Holonomy algebra generated by curvature
2. **Riemann-Scutoid** ({prf:ref}`thm-riemann-scutoid`): Plaquette holonomy → Riemann tensor (asymptotic)
3. **Raychaudhuri** ({prf:ref}`thm-raychaudhuri`): $d\theta/d\tau = -\theta^2/d - \sigma^2 + \omega^2 - \mathrm{Ric}(u,u)$
4. **Discrete Raychaudhuri** ({prf:ref}`thm-discrete-raychaudhuri`): Voronoi evolution → Raychaudhuri with $O(\epsilon_N)$ error
5. **Focusing** ({prf:ref}`thm-focusing`): Under SEC + $\omega=0$, $\theta \to -\infty$ in finite time
6. **Curvature-Topology (2D)** ({prf:ref}`prop-curvature-change-2d`): Cloning changes curvature by $O(1)$
:::

---

## References

```{bibliography}
:filter: docname in docnames
```

**Key references:**
- Holonomy and curvature: {cite}`ambrose1953theorem,kobayashi1963foundations`
- Raychaudhuri equation: {cite}`raychaudhuri1955relativistic`
- Focusing theorems: {cite}`hawking1973large`
- Regge calculus: {cite}`regge1961general,cheeger1984curvature`
- General relativity: {cite}`wald1984general`
