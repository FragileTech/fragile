{
  "chapter_index": 4,
  "section_id": "## **4. Identification of the Limit Point**",
  "directive_count": 18,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-exchangeability",
      "title": "Exchangeability of the N-Particle QSD",
      "start_line": 214,
      "end_line": 223,
      "header_lines": [
        215
      ],
      "content_start": 217,
      "content_end": 222,
      "content": "217: :label: lem-exchangeability\n218: \n219: The unique N-particle QSD $\\nu_N^{QSD}$ is an exchangeable measure on the product space $\\Omega^N$. That is, for any permutation $\\sigma$ of the indices $\\{1, \\ldots, N\\}$ and any measurable set $A \\subseteq \\Omega^N$,\n220: \n221: $$\n222: \\nu_N^{QSD}(\\{(z_1, \\ldots, z_N) \\in A\\}) = \\nu_N^{QSD}(\\{(z_{\\sigma(1)}, \\ldots, z_{\\sigma(N)}) \\in A\\})",
      "metadata": {
        "label": "lem-exchangeability"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "214: #### **Lemma A.1: Exchangeability of the N-Particle QSD**\n215: \n216: :::{prf:lemma} Exchangeability of the N-Particle QSD\n217: :label: lem-exchangeability\n218: \n219: The unique N-particle QSD $\\nu_N^{QSD}$ is an exchangeable measure on the product space $\\Omega^N$. That is, for any permutation $\\sigma$ of the indices $\\{1, \\ldots, N\\}$ and any measurable set $A \\subseteq \\Omega^N$,\n220: \n221: $$\n222: \\nu_N^{QSD}(\\{(z_1, \\ldots, z_N) \\in A\\}) = \\nu_N^{QSD}(\\{(z_{\\sigma(1)}, \\ldots, z_{\\sigma(N)}) \\in A\\})\n223: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-exchangeability",
      "title": null,
      "start_line": 225,
      "end_line": 232,
      "header_lines": [
        226
      ],
      "content_start": 227,
      "content_end": 231,
      "content": "227: :::{prf:proof}\n228: :label: proof-lem-exchangeability\n229: The Euclidean Gas dynamics are completely symmetric under permutation of walker indices. The kinetic perturbation operator applies the same Ornstein-Uhlenbeck process to each walker independently. The cloning operator selects companions uniformly at random and applies the same fitness comparison rule regardless of walker labels. The boundary revival operator treats all walkers identically.\n230: \n231: Since the generator $\\mathcal{L}_N$ of the N-particle process is invariant under any permutation of walker indices, and since the QSD $\\nu_N^{QSD}$ is the unique stationary measure of this generator, it must inherit this symmetry. By the uniqueness of the QSD, the permuted measure must equal the original measure, establishing exchangeability.",
      "metadata": {
        "label": "proof-lem-exchangeability"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "225: :::\n226: \n227: :::{prf:proof}\n228: :label: proof-lem-exchangeability\n229: The Euclidean Gas dynamics are completely symmetric under permutation of walker indices. The kinetic perturbation operator applies the same Ornstein-Uhlenbeck process to each walker independently. The cloning operator selects companions uniformly at random and applies the same fitness comparison rule regardless of walker labels. The boundary revival operator treats all walkers identically.\n230: \n231: Since the generator $\\mathcal{L}_N$ of the N-particle process is invariant under any permutation of walker indices, and since the QSD $\\nu_N^{QSD}$ is the unique stationary measure of this generator, it must inherit this symmetry. By the uniqueness of the QSD, the permuted measure must equal the original measure, establishing exchangeability.\n232: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-empirical-convergence",
      "title": "Weak Convergence of the Empirical Companion Measure",
      "start_line": 236,
      "end_line": 252,
      "header_lines": [
        237
      ],
      "content_start": 239,
      "content_end": 251,
      "content": "239: :label: lem-empirical-convergence\n240: \n241: Let $\\{N_k\\}$ be any subsequence such that $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$. For a configuration $S_{N_k} = (z_1, \\ldots, z_{N_k})$ drawn from $\\nu_{N_k}^{QSD}$, define the empirical companion measure\n242: \n243: $$\n244: \\mu_{N_k-1}^{\\text{comp}}(S_{N_k}) := \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\delta_{z_j}\n245: \n246: $$\n247: \n248: Then for $\\nu_{N_k}^{QSD}$-almost every sequence of configurations, as $k \\to \\infty$,\n249: \n250: $$\n251: \\mu_{N_k-1}^{\\text{comp}}(S_{N_k}) \\rightharpoonup \\mu_\\infty \\quad \\text{weakly in } \\mathcal{P}(\\Omega)",
      "metadata": {
        "label": "lem-empirical-convergence"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "236: #### **Lemma A.2: Weak Convergence of the Empirical Companion Measure**\n237: \n238: :::{prf:lemma} Weak Convergence of the Empirical Companion Measure\n239: :label: lem-empirical-convergence\n240: \n241: Let $\\{N_k\\}$ be any subsequence such that $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$. For a configuration $S_{N_k} = (z_1, \\ldots, z_{N_k})$ drawn from $\\nu_{N_k}^{QSD}$, define the empirical companion measure\n242: \n243: $$\n244: \\mu_{N_k-1}^{\\text{comp}}(S_{N_k}) := \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\delta_{z_j}\n245: \n246: $$\n247: \n248: Then for $\\nu_{N_k}^{QSD}$-almost every sequence of configurations, as $k \\to \\infty$,\n249: \n250: $$\n251: \\mu_{N_k-1}^{\\text{comp}}(S_{N_k}) \\rightharpoonup \\mu_\\infty \\quad \\text{weakly in } \\mathcal{P}(\\Omega)\n252: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-empirical-convergence",
      "title": null,
      "start_line": 254,
      "end_line": 268,
      "header_lines": [
        255
      ],
      "content_start": 256,
      "content_end": 267,
      "content": "256: :::{prf:proof}\n257: :label: proof-lem-empirical-convergence\n258: By Lemma [](#lem-exchangeability), the sequence of N-particle QSDs consists of exchangeable measures. The **Hewitt-Savage theorem** (see Kallenberg, *Foundations of Modern Probability*, Theorem 11.10) states that any exchangeable sequence of random variables can be represented as a mixture of independent and identically distributed (IID) sequences.\n259: \n260: For large $N_k$, this implies that the companions $\\{z_2, \\ldots, z_{N_k}\\}$ behave asymptotically as if they were independent samples from the marginal distribution $\\mu_{N_k}$. The **Glivenko-Cantelli theorem** (or its extension to Polish spaces, Varadarajan's theorem) guarantees that for such sequences, the empirical measure\n261: \n262: $$\n263: \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\delta_{z_j}\n264: \n265: $$\n266: \n267: converges almost surely to the true underlying measure $\\mu_{N_k}$ as $N_k \\to \\infty$. Since we have assumed $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$ by hypothesis, the empirical companion measure must also converge weakly to $\\mu_\\infty$.",
      "metadata": {
        "label": "proof-lem-empirical-convergence"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "254: :::\n255: \n256: :::{prf:proof}\n257: :label: proof-lem-empirical-convergence\n258: By Lemma [](#lem-exchangeability), the sequence of N-particle QSDs consists of exchangeable measures. The **Hewitt-Savage theorem** (see Kallenberg, *Foundations of Modern Probability*, Theorem 11.10) states that any exchangeable sequence of random variables can be represented as a mixture of independent and identically distributed (IID) sequences.\n259: \n260: For large $N_k$, this implies that the companions $\\{z_2, \\ldots, z_{N_k}\\}$ behave asymptotically as if they were independent samples from the marginal distribution $\\mu_{N_k}$. The **Glivenko-Cantelli theorem** (or its extension to Polish spaces, Varadarajan's theorem) guarantees that for such sequences, the empirical measure\n261: \n262: $$\n263: \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\delta_{z_j}\n264: \n265: $$\n266: \n267: converges almost surely to the true underlying measure $\\mu_{N_k}$ as $N_k \\to \\infty$. Since we have assumed $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$ by hypothesis, the empirical companion measure must also converge weakly to $\\mu_\\infty$.\n268: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-reward-continuity",
      "title": "Continuity of the Reward Moments",
      "start_line": 278,
      "end_line": 287,
      "header_lines": [
        279
      ],
      "content_start": 281,
      "content_end": 286,
      "content": "281: :label: lem-reward-continuity\n282: \n283: The reward moment functionals $\\mu_R[\\cdot]$ and $\\sigma_R^2[\\cdot]$ are continuous with respect to weak convergence of measures. That is, if $\\{\\mu_k\\}$ converges weakly to $\\mu_\\infty$, then\n284: \n285: $$\n286: \\lim_{k \\to \\infty} \\mu_R[\\mu_k] = \\mu_R[\\mu_\\infty] \\quad \\text{and} \\quad \\lim_{k \\to \\infty} \\sigma_R^2[\\mu_k] = \\sigma_R^2[\\mu_\\infty]",
      "metadata": {
        "label": "lem-reward-continuity"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "278: #### **Lemma B.1: Continuity of the Reward Moments**\n279: \n280: :::{prf:lemma} Continuity of the Reward Moments\n281: :label: lem-reward-continuity\n282: \n283: The reward moment functionals $\\mu_R[\\cdot]$ and $\\sigma_R^2[\\cdot]$ are continuous with respect to weak convergence of measures. That is, if $\\{\\mu_k\\}$ converges weakly to $\\mu_\\infty$, then\n284: \n285: $$\n286: \\lim_{k \\to \\infty} \\mu_R[\\mu_k] = \\mu_R[\\mu_\\infty] \\quad \\text{and} \\quad \\lim_{k \\to \\infty} \\sigma_R^2[\\mu_k] = \\sigma_R^2[\\mu_\\infty]\n287: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-reward-continuity",
      "title": null,
      "start_line": 289,
      "end_line": 303,
      "header_lines": [
        290
      ],
      "content_start": 291,
      "content_end": 302,
      "content": "291: :::{prf:proof}\n292: :label: proof-lem-reward-continuity\n293: Recall that\n294: \n295: $$\n296: \\mu_R[\\mu] = \\int_\\Omega R(z) \\, d\\mu(z) \\quad \\text{and} \\quad \\sigma_R^2[\\mu] = \\int_\\Omega R(z)^2 \\, d\\mu(z) - \\left(\\int_\\Omega R(z) \\, d\\mu(z)\\right)^2\n297: \n298: $$\n299: \n300: 1. **Continuity of the mean**: The **Axiom of Reward Regularity** establishes that the reward function $R: \\Omega \\to \\mathbb{R}$ is Lipschitz continuous. Since $\\Omega$ is a compact subset of $\\mathbb{R}^{2d}$ (bounded positions and velocity-capped), $R$ is bounded and continuous. A fundamental result in weak convergence theory is that if $\\mu_k \\rightharpoonup \\mu_\\infty$ and $g$ is a bounded, continuous function, then $\\int g \\, d\\mu_k \\to \\int g \\, d\\mu_\\infty$. Applying this with $g = R$ gives the convergence of $\\mu_R[\\mu_k]$.\n301: \n302: 2. **Continuity of the variance**: The function $R(z)^2$ is also bounded and continuous on the compact domain $\\Omega$. By the same argument, $\\int R(z)^2 \\, d\\mu_k \\to \\int R(z)^2 \\, d\\mu_\\infty$. Since both terms in the variance formula converge, and the limit of a difference equals the difference of limits, the variance $\\sigma_R^2[\\mu_k]$ converges to $\\sigma_R^2[\\mu_\\infty]$.",
      "metadata": {
        "label": "proof-lem-reward-continuity"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "289: :::\n290: \n291: :::{prf:proof}\n292: :label: proof-lem-reward-continuity\n293: Recall that\n294: \n295: $$\n296: \\mu_R[\\mu] = \\int_\\Omega R(z) \\, d\\mu(z) \\quad \\text{and} \\quad \\sigma_R^2[\\mu] = \\int_\\Omega R(z)^2 \\, d\\mu(z) - \\left(\\int_\\Omega R(z) \\, d\\mu(z)\\right)^2\n297: \n298: $$\n299: \n300: 1. **Continuity of the mean**: The **Axiom of Reward Regularity** establishes that the reward function $R: \\Omega \\to \\mathbb{R}$ is Lipschitz continuous. Since $\\Omega$ is a compact subset of $\\mathbb{R}^{2d}$ (bounded positions and velocity-capped), $R$ is bounded and continuous. A fundamental result in weak convergence theory is that if $\\mu_k \\rightharpoonup \\mu_\\infty$ and $g$ is a bounded, continuous function, then $\\int g \\, d\\mu_k \\to \\int g \\, d\\mu_\\infty$. Applying this with $g = R$ gives the convergence of $\\mu_R[\\mu_k]$.\n301: \n302: 2. **Continuity of the variance**: The function $R(z)^2$ is also bounded and continuous on the compact domain $\\Omega$. By the same argument, $\\int R(z)^2 \\, d\\mu_k \\to \\int R(z)^2 \\, d\\mu_\\infty$. Since both terms in the variance formula converge, and the limit of a difference equals the difference of limits, the variance $\\sigma_R^2[\\mu_k]$ converges to $\\sigma_R^2[\\mu_\\infty]$.\n303: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-distance-continuity",
      "title": "Continuity of the Distance Moments",
      "start_line": 307,
      "end_line": 316,
      "header_lines": [
        308
      ],
      "content_start": 310,
      "content_end": 315,
      "content": "310: :label: lem-distance-continuity\n311: \n312: The distance moment functionals $\\mu_D[\\cdot]$ and $\\sigma_D^2[\\cdot]$ are continuous with respect to weak convergence of measures. That is, if $\\{\\mu_k\\}$ converges weakly to $\\mu_\\infty$, then\n313: \n314: $$\n315: \\lim_{k \\to \\infty} \\mu_D[\\mu_k] = \\mu_D[\\mu_\\infty] \\quad \\text{and} \\quad \\lim_{k \\to \\infty} \\sigma_D^2[\\mu_k] = \\sigma_D^2[\\mu_\\infty]",
      "metadata": {
        "label": "lem-distance-continuity"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "307: #### **Lemma B.2: Continuity of the Distance Moments**\n308: \n309: :::{prf:lemma} Continuity of the Distance Moments\n310: :label: lem-distance-continuity\n311: \n312: The distance moment functionals $\\mu_D[\\cdot]$ and $\\sigma_D^2[\\cdot]$ are continuous with respect to weak convergence of measures. That is, if $\\{\\mu_k\\}$ converges weakly to $\\mu_\\infty$, then\n313: \n314: $$\n315: \\lim_{k \\to \\infty} \\mu_D[\\mu_k] = \\mu_D[\\mu_\\infty] \\quad \\text{and} \\quad \\lim_{k \\to \\infty} \\sigma_D^2[\\mu_k] = \\sigma_D^2[\\mu_\\infty]\n316: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-distance-continuity",
      "title": null,
      "start_line": 318,
      "end_line": 352,
      "header_lines": [
        319
      ],
      "content_start": 320,
      "content_end": 351,
      "content": "320: :::{prf:proof}\n321: :label: proof-lem-distance-continuity\n322: Recall that\n323: \n324: $$\n325: \\mu_D[\\mu] = \\iint_{\\Omega \\times \\Omega} d(z, z') \\, d\\mu(z) \\, d\\mu(z')\n326: \n327: $$\n328: \n329: where $d(z, z')$ is the algorithmic distance between two phase-space points.\n330: \n331: 1. **Continuity of the distance function**: By the axioms of the Euclidean Gas, $d(z, z')$ is a continuous function on $\\Omega \\times \\Omega$. Since $\\Omega$ is compact, the product space $\\Omega \\times \\Omega$ is also compact, and thus $d$ is bounded and continuous on this product space.\n332: \n333: 2. **Weak convergence of product measures**: A fundamental result in measure theory states that if $\\mu_k \\rightharpoonup \\mu_\\infty$, then the product measure $\\mu_k \\otimes \\mu_k$ converges weakly to $\\mu_\\infty \\otimes \\mu_\\infty$ on the product space $\\Omega \\times \\Omega$.\n334: \n335: 3. **Convergence of the integral**: Since $d(z, z')$ is a bounded, continuous function on $\\Omega \\times \\Omega$, and $\\mu_k \\otimes \\mu_k \\rightharpoonup \\mu_\\infty \\otimes \\mu_\\infty$, the continuous mapping theorem for weak convergence implies\n336: \n337: $$\n338: \\iint d(z, z') \\, d(\\mu_k \\otimes \\mu_k)(z, z') \\to \\iint d(z, z') \\, d(\\mu_\\infty \\otimes \\mu_\\infty)(z, z')\n339: \n340: $$\n341: \n342: This establishes the convergence of $\\mu_D[\\mu_k]$.\n343: \n344: 4. **Continuity of the variance**: For the variance, we have\n345: \n346: $$\n347: \\sigma_D^2[\\mu] = \\iint (d(z, z') - \\mu_D[\\mu])^2 \\, d\\mu(z) \\, d\\mu(z')\n348: \n349: $$\n350: \n351: The function $(d(z, z') - c)^2$ is continuous in both its spatial arguments and the constant $c$. Since we have already shown that $\\mu_D[\\mu_k] \\to \\mu_D[\\mu_\\infty]$, the integrand converges point-wise. By the bounded convergence theorem (the integrand is bounded on the compact domain), the integral converges, giving $\\sigma_D^2[\\mu_k] \\to \\sigma_D^2[\\mu_\\infty]$.",
      "metadata": {
        "label": "proof-lem-distance-continuity"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "318: :::\n319: \n320: :::{prf:proof}\n321: :label: proof-lem-distance-continuity\n322: Recall that\n323: \n324: $$\n325: \\mu_D[\\mu] = \\iint_{\\Omega \\times \\Omega} d(z, z') \\, d\\mu(z) \\, d\\mu(z')\n326: \n327: $$\n328: \n329: where $d(z, z')$ is the algorithmic distance between two phase-space points.\n330: \n331: 1. **Continuity of the distance function**: By the axioms of the Euclidean Gas, $d(z, z')$ is a continuous function on $\\Omega \\times \\Omega$. Since $\\Omega$ is compact, the product space $\\Omega \\times \\Omega$ is also compact, and thus $d$ is bounded and continuous on this product space.\n332: \n333: 2. **Weak convergence of product measures**: A fundamental result in measure theory states that if $\\mu_k \\rightharpoonup \\mu_\\infty$, then the product measure $\\mu_k \\otimes \\mu_k$ converges weakly to $\\mu_\\infty \\otimes \\mu_\\infty$ on the product space $\\Omega \\times \\Omega$.\n334: \n335: 3. **Convergence of the integral**: Since $d(z, z')$ is a bounded, continuous function on $\\Omega \\times \\Omega$, and $\\mu_k \\otimes \\mu_k \\rightharpoonup \\mu_\\infty \\otimes \\mu_\\infty$, the continuous mapping theorem for weak convergence implies\n336: \n337: $$\n338: \\iint d(z, z') \\, d(\\mu_k \\otimes \\mu_k)(z, z') \\to \\iint d(z, z') \\, d(\\mu_\\infty \\otimes \\mu_\\infty)(z, z')\n339: \n340: $$\n341: \n342: This establishes the convergence of $\\mu_D[\\mu_k]$.\n343: \n344: 4. **Continuity of the variance**: For the variance, we have\n345: \n346: $$\n347: \\sigma_D^2[\\mu] = \\iint (d(z, z') - \\mu_D[\\mu])^2 \\, d\\mu(z) \\, d\\mu(z')\n348: \n349: $$\n350: \n351: The function $(d(z, z') - c)^2$ is continuous in both its spatial arguments and the constant $c$. Since we have already shown that $\\mu_D[\\mu_k] \\to \\mu_D[\\mu_\\infty]$, the integrand converges point-wise. By the bounded convergence theorem (the integrand is bounded on the compact domain), the integral converges, giving $\\sigma_D^2[\\mu_k] \\to \\sigma_D^2[\\mu_\\infty]$.\n352: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniform-integrability",
      "title": "Uniform Integrability and Interchange of Limits",
      "start_line": 362,
      "end_line": 380,
      "header_lines": [
        363
      ],
      "content_start": 365,
      "content_end": 379,
      "content": "365: :label: lem-uniform-integrability\n366: \n367: Let $\\phi \\in C_c^\\infty(\\Omega)$ be a smooth, compactly supported test function. The sequence of integrands\n368: \n369: $$\n370: \\left\\{ \\mathcal{L}_{N_k} \\phi(z_1) \\right\\}_{k=1}^\\infty\n371: \n372: $$\n373: \n374: is uniformly integrable with respect to the measures $\\{\\nu_{N_k}^{QSD}\\}$. Consequently, for any convergent subsequence $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$,\n375: \n376: $$\n377: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = \\mathbb{E}_{\\mu_\\infty}\\left[\\lim_{k \\to \\infty} \\mathbb{E}^{(N_k)}_{\\text{comp}}[\\mathcal{L}_{N_k} \\phi(z_1) \\mid z_1]\\right]\n378: \n379: $$",
      "metadata": {
        "label": "lem-uniform-integrability"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "362: #### **Lemma C.1: Uniform Integrability and Interchange of Limits**\n363: \n364: :::{prf:lemma} Uniform Integrability and Interchange of Limits\n365: :label: lem-uniform-integrability\n366: \n367: Let $\\phi \\in C_c^\\infty(\\Omega)$ be a smooth, compactly supported test function. The sequence of integrands\n368: \n369: $$\n370: \\left\\{ \\mathcal{L}_{N_k} \\phi(z_1) \\right\\}_{k=1}^\\infty\n371: \n372: $$\n373: \n374: is uniformly integrable with respect to the measures $\\{\\nu_{N_k}^{QSD}\\}$. Consequently, for any convergent subsequence $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$,\n375: \n376: $$\n377: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = \\mathbb{E}_{\\mu_\\infty}\\left[\\lim_{k \\to \\infty} \\mathbb{E}^{(N_k)}_{\\text{comp}}[\\mathcal{L}_{N_k} \\phi(z_1) \\mid z_1]\\right]\n378: \n379: $$\n380: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-uniform-integrability",
      "title": null,
      "start_line": 382,
      "end_line": 407,
      "header_lines": [
        383
      ],
      "content_start": 384,
      "content_end": 406,
      "content": "384: :::{prf:proof}\n385: :label: proof-lem-uniform-integrability\n386: We must show that all terms in the generator applied to $\\phi$ are uniformly bounded in $N_k$.\n387: \n388: 1. **Kinetic term**: The test function $\\phi$ is smooth and compactly supported, so $\\phi$ and all its derivatives are bounded. The kinetic generator $\\mathcal{L}_{\\text{kin}}$ is a second-order differential operator with smooth, bounded coefficients (from the axioms). Therefore, $|\\mathcal{L}_{\\text{kin}} \\phi(z)| \\le C_{\\text{kin}}$ for some constant $C_{\\text{kin}}$ independent of $N$.\n389: \n390: 2. **Cloning term**: The cloning generator has the form\n391: \n392: $$\n393: \\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1) = \\sum_{\\text{transitions}} \\lambda(z_1 \\to z') (\\phi(z') - \\phi(z_1))\n394: \n395: $$\n396: \n397: where the transition rates $\\lambda(z_1 \\to z')$ are derived from cloning probabilities (which are bounded by 1) and the selection rate $\\lambda_{\\text{sel}}$ (a fixed constant). The jump kernel lands in the compact domain $\\Omega$, so $|\\phi(z') - \\phi(z_1)| \\le 2 \\|\\phi\\|_\\infty < \\infty$. The total jump rate out of any state is bounded by a constant times $\\lambda_{\\text{sel}}$. Therefore, $|\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)| \\le C_{\\text{clone}}$ for some constant $C_{\\text{clone}}$ independent of $N_k$.\n398: \n399: 3. **Uniform bound**: Combining both terms,\n400: \n401: $$\n402: |\\mathcal{L}_{N_k} \\phi(z_1)| \\le C_{\\text{kin}} + C_{\\text{clone}} =: C\n403: \n404: $$\n405: \n406: Since this bound is independent of $N_k$ and independent of the state $z_1 \\in \\Omega$, the sequence of integrands is uniformly bounded. On a probability space, uniform boundedness implies uniform integrability. By the Dominated Convergence Theorem, we can interchange the limit and the expectation.",
      "metadata": {
        "label": "proof-lem-uniform-integrability"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "382: :::\n383: \n384: :::{prf:proof}\n385: :label: proof-lem-uniform-integrability\n386: We must show that all terms in the generator applied to $\\phi$ are uniformly bounded in $N_k$.\n387: \n388: 1. **Kinetic term**: The test function $\\phi$ is smooth and compactly supported, so $\\phi$ and all its derivatives are bounded. The kinetic generator $\\mathcal{L}_{\\text{kin}}$ is a second-order differential operator with smooth, bounded coefficients (from the axioms). Therefore, $|\\mathcal{L}_{\\text{kin}} \\phi(z)| \\le C_{\\text{kin}}$ for some constant $C_{\\text{kin}}$ independent of $N$.\n389: \n390: 2. **Cloning term**: The cloning generator has the form\n391: \n392: $$\n393: \\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1) = \\sum_{\\text{transitions}} \\lambda(z_1 \\to z') (\\phi(z') - \\phi(z_1))\n394: \n395: $$\n396: \n397: where the transition rates $\\lambda(z_1 \\to z')$ are derived from cloning probabilities (which are bounded by 1) and the selection rate $\\lambda_{\\text{sel}}$ (a fixed constant). The jump kernel lands in the compact domain $\\Omega$, so $|\\phi(z') - \\phi(z_1)| \\le 2 \\|\\phi\\|_\\infty < \\infty$. The total jump rate out of any state is bounded by a constant times $\\lambda_{\\text{sel}}$. Therefore, $|\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)| \\le C_{\\text{clone}}$ for some constant $C_{\\text{clone}}$ independent of $N_k$.\n398: \n399: 3. **Uniform bound**: Combining both terms,\n400: \n401: $$\n402: |\\mathcal{L}_{N_k} \\phi(z_1)| \\le C_{\\text{kin}} + C_{\\text{clone}} =: C\n403: \n404: $$\n405: \n406: Since this bound is independent of $N_k$ and independent of the state $z_1 \\in \\Omega$, the sequence of integrands is uniformly bounded. On a probability space, uniform boundedness implies uniform integrability. By the Dominated Convergence Theorem, we can interchange the limit and the expectation.\n407: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-boundary-convergence",
      "title": "Convergence of Boundary Death and Revival",
      "start_line": 411,
      "end_line": 423,
      "header_lines": [
        412
      ],
      "content_start": 414,
      "content_end": 422,
      "content": "414: :label: lem-boundary-convergence\n415: \n416: Let $\\{N_k\\}$ be any subsequence such that $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$. The discrete boundary death and revival mechanism of the N-particle system converges to the continuous interior-killing-and-revival operators. For any smooth test function $\\phi \\in C_c^\\infty(\\Omega)$:\n417: \n418: $$\n419: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n420: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n421: \n422: $$",
      "metadata": {
        "label": "lem-boundary-convergence"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "411: #### **Lemma C.2: Convergence of the Boundary Death and Revival Mechanism**\n412: \n413: :::{prf:lemma} Convergence of Boundary Death and Revival\n414: :label: lem-boundary-convergence\n415: \n416: Let $\\{N_k\\}$ be any subsequence such that $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$. The discrete boundary death and revival mechanism of the N-particle system converges to the continuous interior-killing-and-revival operators. For any smooth test function $\\phi \\in C_c^\\infty(\\Omega)$:\n417: \n418: $$\n419: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n420: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n421: \n422: $$\n423: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-boundary-convergence",
      "title": null,
      "start_line": 425,
      "end_line": 517,
      "header_lines": [
        426
      ],
      "content_start": 427,
      "content_end": 516,
      "content": "427: :::{prf:proof}\n428: :label: proof-lem-boundary-convergence\n429: This convergence is established in two steps, corresponding to the two physical processes: death at the boundary and revival from the dead reservoir.\n430: \n431: **Step 1: Discrete Death Converges to Interior Killing**\n432: \n433: In the discrete N-particle algorithm, a walker dies (status becomes 0) when its position leaves the valid domain $X_{\\text{valid}}$. This is a hard boundary condition: the walker is killed instantaneously upon crossing $\\partial X_{\\text{valid}}$.\n434: \n435: In the continuous limit, Theorem 4.4.2 of `06_mean_field.md` (Consistency of the Interior Killing Rate Approximation) rigorously proves that as the timestep $\\tau \\to 0$, the discrete exit probability per timestep converges to a smooth interior killing rate:\n436: \n437: $$\n438: \\lim_{\\tau \\to 0} \\frac{1}{\\tau} p_{\\text{exit}}(z, \\tau) = c(z)\n439: \n440: $$\n441: \n442: with uniform convergence over the phase space $\\Omega$. The killing rate $c(z)$ has the following properties:\n443: - $c(z) = 0$ for $z$ in the interior of $\\Omega$ (away from $\\partial X_{\\text{valid}}$)\n444: - $c(z) > 0$ in a smooth boundary layer near $\\partial X_{\\text{valid}}$\n445: - $c \\in C^\\infty(\\Omega)$ (smooth)\n446: \n447: The contribution of the killing mechanism to the generator is:\n448: \n449: $$\n450: \\mathcal{L}_{\\text{death}, N_k} \\phi(z_1) = -\\frac{1}{\\tau} p_{\\text{exit}}(z_1, \\tau) \\phi(z_1)\n451: \n452: $$\n453: \n454: Taking the limit as $k \\to \\infty$ (equivalently, $\\tau \\to 0$), and integrating against the marginal density:\n455: \n456: $$\n457: \\lim_{k \\to \\infty} \\mathbb{E}_{\\mu_{N_k}}\\left[\\mathcal{L}_{\\text{death}, N_k} \\phi(z_1)\\right]\n458: = -\\int_{\\Omega} c(z) \\rho_0(z) \\phi(z) \\, dz\n459: \n460: $$\n461: \n462: **Step 2: Discrete Revival Converges to the Revival Operator**\n463: \n464: In the discrete algorithm, dead walkers (status = 0) are revived at a constant rate $\\lambda_{\\text{rev}} = 1/\\tau$ by cloning from a uniformly selected alive walker and applying jitter. Let $m_{d,N_k}$ denote the fraction of dead walkers in the N-particle system at stationarity.\n465: \n466: The revival mechanism has two key components:\n467: 1. **Selection of revival target**: A companion is selected uniformly from the alive population (those with status = 1)\n468: 2. **Jitter**: The new position is the companion's position plus Gaussian noise\n469: \n470: As $N_k \\to \\infty$:\n471: - The fraction of dead walkers converges: $m_{d,N_k} \\to m_{d,\\infty}$ (by the law of large numbers for the coupled system)\n472: - The empirical distribution of alive walkers, normalized, converges: $\\frac{\\mu_{N_k}^{\\text{alive}}}{m_{a,N_k}} \\rightharpoonup \\rho_0$ (by Lemma [](#lem-empirical-convergence))\n473: - The jitter kernel $Q_\\delta(z \\mid z')$ remains fixed (Gaussian with variance $\\delta^2$)\n474: \n475: The revival operator in the mean-field model is defined as:\n476: \n477: $$\n478: B[\\rho_0, m_{d,\\infty}](z) = \\lambda_{\\text{rev}} \\cdot m_{d,\\infty} \\cdot g[\\rho_0](z)\n479: \n480: $$\n481: \n482: where $g[\\rho_0](z) = \\int_{\\Omega} Q_\\delta(z \\mid z') \\rho_0(z') \\, dz'$ is the spatial profile of revived mass.\n483: \n484: The contribution of the revival mechanism to the generator is:\n485: \n486: $$\n487: \\mathcal{L}_{\\text{revival}, N_k} \\phi(z_1) = \\lambda_{\\text{rev}} m_{d,N_k} \\int_{\\Omega} Q_\\delta(z' \\mid z_c) \\phi(z') \\, dz' \\, d\\mu_{N_k}^{\\text{comp}}(z_c)\n488: \n489: $$\n490: \n491: By the convergence of $m_{d,N_k} \\to m_{d,\\infty}$ and $\\mu_{N_k}^{\\text{comp}} \\rightharpoonup \\rho_0$, and the continuity of the integral operator with respect to weak convergence:\n492: \n493: $$\n494: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{revival}, N_k} \\phi(z_1)]\n495: = \\int_{\\Omega} B[\\rho_0, m_{d,\\infty}](z) \\phi(z) \\, dz\n496: \n497: $$\n498: \n499: **Step 3: Combine Both Terms**\n500: \n501: The net contribution from the boundary mechanism (death plus revival) is:\n502: \n503: $$\n504: \\mathcal{L}_{\\text{boundary}, N_k} = \\mathcal{L}_{\\text{death}, N_k} + \\mathcal{L}_{\\text{revival}, N_k}\n505: \n506: $$\n507: \n508: Taking the limit:\n509: \n510: $$\n511: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n512: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n513: \n514: $$\n515: \n516: This is precisely the boundary contribution in the mean-field PDE derived in `06_mean_field.md`.",
      "metadata": {
        "label": "proof-lem-boundary-convergence"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "425: :::\n426: \n427: :::{prf:proof}\n428: :label: proof-lem-boundary-convergence\n429: This convergence is established in two steps, corresponding to the two physical processes: death at the boundary and revival from the dead reservoir.\n430: \n431: **Step 1: Discrete Death Converges to Interior Killing**\n432: \n433: In the discrete N-particle algorithm, a walker dies (status becomes 0) when its position leaves the valid domain $X_{\\text{valid}}$. This is a hard boundary condition: the walker is killed instantaneously upon crossing $\\partial X_{\\text{valid}}$.\n434: \n435: In the continuous limit, Theorem 4.4.2 of `06_mean_field.md` (Consistency of the Interior Killing Rate Approximation) rigorously proves that as the timestep $\\tau \\to 0$, the discrete exit probability per timestep converges to a smooth interior killing rate:\n436: \n437: $$\n438: \\lim_{\\tau \\to 0} \\frac{1}{\\tau} p_{\\text{exit}}(z, \\tau) = c(z)\n439: \n440: $$\n441: \n442: with uniform convergence over the phase space $\\Omega$. The killing rate $c(z)$ has the following properties:\n443: - $c(z) = 0$ for $z$ in the interior of $\\Omega$ (away from $\\partial X_{\\text{valid}}$)\n444: - $c(z) > 0$ in a smooth boundary layer near $\\partial X_{\\text{valid}}$\n445: - $c \\in C^\\infty(\\Omega)$ (smooth)\n446: \n447: The contribution of the killing mechanism to the generator is:\n448: \n449: $$\n450: \\mathcal{L}_{\\text{death}, N_k} \\phi(z_1) = -\\frac{1}{\\tau} p_{\\text{exit}}(z_1, \\tau) \\phi(z_1)\n451: \n452: $$\n453: \n454: Taking the limit as $k \\to \\infty$ (equivalently, $\\tau \\to 0$), and integrating against the marginal density:\n455: \n456: $$\n457: \\lim_{k \\to \\infty} \\mathbb{E}_{\\mu_{N_k}}\\left[\\mathcal{L}_{\\text{death}, N_k} \\phi(z_1)\\right]\n458: = -\\int_{\\Omega} c(z) \\rho_0(z) \\phi(z) \\, dz\n459: \n460: $$\n461: \n462: **Step 2: Discrete Revival Converges to the Revival Operator**\n463: \n464: In the discrete algorithm, dead walkers (status = 0) are revived at a constant rate $\\lambda_{\\text{rev}} = 1/\\tau$ by cloning from a uniformly selected alive walker and applying jitter. Let $m_{d,N_k}$ denote the fraction of dead walkers in the N-particle system at stationarity.\n465: \n466: The revival mechanism has two key components:\n467: 1. **Selection of revival target**: A companion is selected uniformly from the alive population (those with status = 1)\n468: 2. **Jitter**: The new position is the companion's position plus Gaussian noise\n469: \n470: As $N_k \\to \\infty$:\n471: - The fraction of dead walkers converges: $m_{d,N_k} \\to m_{d,\\infty}$ (by the law of large numbers for the coupled system)\n472: - The empirical distribution of alive walkers, normalized, converges: $\\frac{\\mu_{N_k}^{\\text{alive}}}{m_{a,N_k}} \\rightharpoonup \\rho_0$ (by Lemma [](#lem-empirical-convergence))\n473: - The jitter kernel $Q_\\delta(z \\mid z')$ remains fixed (Gaussian with variance $\\delta^2$)\n474: \n475: The revival operator in the mean-field model is defined as:\n476: \n477: $$\n478: B[\\rho_0, m_{d,\\infty}](z) = \\lambda_{\\text{rev}} \\cdot m_{d,\\infty} \\cdot g[\\rho_0](z)\n479: \n480: $$\n481: \n482: where $g[\\rho_0](z) = \\int_{\\Omega} Q_\\delta(z \\mid z') \\rho_0(z') \\, dz'$ is the spatial profile of revived mass.\n483: \n484: The contribution of the revival mechanism to the generator is:\n485: \n486: $$\n487: \\mathcal{L}_{\\text{revival}, N_k} \\phi(z_1) = \\lambda_{\\text{rev}} m_{d,N_k} \\int_{\\Omega} Q_\\delta(z' \\mid z_c) \\phi(z') \\, dz' \\, d\\mu_{N_k}^{\\text{comp}}(z_c)\n488: \n489: $$\n490: \n491: By the convergence of $m_{d,N_k} \\to m_{d,\\infty}$ and $\\mu_{N_k}^{\\text{comp}} \\rightharpoonup \\rho_0$, and the continuity of the integral operator with respect to weak convergence:\n492: \n493: $$\n494: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{revival}, N_k} \\phi(z_1)]\n495: = \\int_{\\Omega} B[\\rho_0, m_{d,\\infty}](z) \\phi(z) \\, dz\n496: \n497: $$\n498: \n499: **Step 3: Combine Both Terms**\n500: \n501: The net contribution from the boundary mechanism (death plus revival) is:\n502: \n503: $$\n504: \\mathcal{L}_{\\text{boundary}, N_k} = \\mathcal{L}_{\\text{death}, N_k} + \\mathcal{L}_{\\text{revival}, N_k}\n505: \n506: $$\n507: \n508: Taking the limit:\n509: \n510: $$\n511: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n512: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n513: \n514: $$\n515: \n516: This is precisely the boundary contribution in the mean-field PDE derived in `06_mean_field.md`.\n517: "
    },
    {
      "directive_type": "remark",
      "label": "rem-qsd-vs-true-stationarity",
      "title": "QSD Stationarity vs. True Stationarity",
      "start_line": 527,
      "end_line": 540,
      "header_lines": [
        528
      ],
      "content_start": 530,
      "content_end": 539,
      "content": "530: :label: rem-qsd-vs-true-stationarity\n531: \n532: For a finite N-particle system, the Quasi-Stationary Distribution $\\nu_N^{QSD}$ satisfies a **modified stationarity condition** that accounts for the non-zero probability of eventual extinction. For any test function $\\Phi: \\Sigma_N \\to \\mathbb{R}$:\n533: \n534: $$\n535: \\mathbb{E}_{\\nu_N^{QSD}}[\\mathcal{L}_N \\Phi] = -\\lambda_N \\mathbb{E}_{\\nu_N^{QSD}}[\\Phi]\n536: \n537: $$\n538: \n539: where $\\lambda_N > 0$ is the **extinction rate** (also called the survival rate or quasi-stationary eigenvalue). This rate characterizes how quickly the conditioned process escapes from the quasi-stationary state toward the absorbing boundary.",
      "metadata": {
        "label": "rem-qsd-vs-true-stationarity"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "527: #### **The QSD Stationarity Condition with Extinction Rate**\n528: \n529: :::{prf:remark} QSD Stationarity vs. True Stationarity\n530: :label: rem-qsd-vs-true-stationarity\n531: \n532: For a finite N-particle system, the Quasi-Stationary Distribution $\\nu_N^{QSD}$ satisfies a **modified stationarity condition** that accounts for the non-zero probability of eventual extinction. For any test function $\\Phi: \\Sigma_N \\to \\mathbb{R}$:\n533: \n534: $$\n535: \\mathbb{E}_{\\nu_N^{QSD}}[\\mathcal{L}_N \\Phi] = -\\lambda_N \\mathbb{E}_{\\nu_N^{QSD}}[\\Phi]\n536: \n537: $$\n538: \n539: where $\\lambda_N > 0$ is the **extinction rate** (also called the survival rate or quasi-stationary eigenvalue). This rate characterizes how quickly the conditioned process escapes from the quasi-stationary state toward the absorbing boundary.\n540: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-extinction-rate-vanishes",
      "title": "Extinction Rate Vanishes in the Mean-Field Limit",
      "start_line": 544,
      "end_line": 555,
      "header_lines": [
        545
      ],
      "content_start": 547,
      "content_end": 554,
      "content": "547: :label: thm-extinction-rate-vanishes\n548: \n549: The extinction rate $\\lambda_N$ of the N-particle QSD satisfies:\n550: \n551: $$\n552: \\lim_{N \\to \\infty} \\lambda_N = 0\n553: \n554: $$",
      "metadata": {
        "label": "thm-extinction-rate-vanishes"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "544: #### **Proof of Vanishing Extinction Rate**\n545: \n546: :::{prf:theorem} Extinction Rate Vanishes in the Mean-Field Limit\n547: :label: thm-extinction-rate-vanishes\n548: \n549: The extinction rate $\\lambda_N$ of the N-particle QSD satisfies:\n550: \n551: $$\n552: \\lim_{N \\to \\infty} \\lambda_N = 0\n553: \n554: $$\n555: "
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-extinction-rate-vanishes",
      "title": null,
      "start_line": 557,
      "end_line": 672,
      "header_lines": [
        558
      ],
      "content_start": 559,
      "content_end": 671,
      "content": "559: :::{prf:proof}\n560: :label: proof-thm-extinction-rate-vanishes\n561: The proof uses the N-uniform Foster-Lyapunov condition established in `06_convergence.md` to bound the extinction rate.\n562: \n563: **Step 1: Relation Between Extinction Rate and Expected Hitting Time**\n564: \n565: A classical result in the theory of quasi-stationary distributions (Champagnat & Villemonais, *Ann. Probab.* 2012, Theorem 2.1) states that for a process killed at the boundary, the extinction rate satisfies:\n566: \n567: $$\n568: \\lambda_N = \\frac{1}{\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}]}\n569: \n570: $$\n571: \n572: where $\\tau_{\\text{ext}}$ is the **expected time to extinction** (hitting time of the absorbing state) when starting from the QSD. Thus, proving $\\lambda_N \\to 0$ is equivalent to proving that $\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\to \\infty$.\n573: \n574: **Step 2: N-Uniform Foster-Lyapunov Condition**\n575: \n576: The Foster-Lyapunov drift condition from `06_convergence.md` establishes that there exists a Lyapunov function $V: \\Sigma_N \\to \\mathbb{R}_{\\geq 0}$ and N-uniform constants $\\kappa > 0$ and $C < \\infty$ such that:\n577: \n578: $$\n579: \\mathcal{L}_N V(S) \\leq -\\kappa V(S) + C\n580: \n581: $$\n582: \n583: for all states $S \\in \\Sigma_N$ (the alive states). This drift condition holds **uniformly in N**.\n584: \n585: **Crucially**, the Lyapunov function has a specific structure tied to the mean-field limit: $V(S_N)$ is a function of the empirical measure that controls the distance from the target limiting distribution. As the number of particles grows, the typical value of $V$ under the QSD scales in a way that reflects the concentration of the empirical measure.\n586: \n587: **Step 3: Refined Argument Using Concentration of Walkers**\n588: \n589: The key insight is that as $N$ increases, the **number of alive walkers** becomes increasingly concentrated around its mean due to the law of large numbers. Let $k_N(t)$ denote the number of alive walkers at time $t$.\n590: \n591: From the coupled dynamics in `06_mean_field.md`, the alive mass fraction $m_{a,N} = k_N/N$ satisfies a balance equation at stationarity:\n592: \n593: $$\n594: \\lambda_{\\text{rev}} m_{d,N} = k_{\\text{killed}}[f_N]\n595: \n596: $$\n597: \n598: By the law of large numbers for exchangeable systems, as $N \\to \\infty$:\n599: - The empirical killing rate $k_{\\text{killed}}[f_N] \\to k_{\\text{killed}}[\\rho_0]$ (a constant)\n600: - The fraction $m_{d,N} \\to m_{d,\\infty}$ (a constant in $(0,1)$)\n601: - Therefore, $m_{a,N} \\to m_{a,\\infty} = 1 - m_{d,\\infty} \\in (0,1)$\n602: \n603: For large $N$, the number of alive walkers is approximately $k_N \\approx m_{a,\\infty} \\cdot N$. Extinction occurs when $k_N = 0$, which requires all $\\sim m_{a,\\infty} N$ walkers to die simultaneously.\n604: \n605: **Step 4: Large Deviation Estimate and Formal Connection to QSD Theory**\n606: \n607: The probability of extinction within any fixed time window $[0, T]$ can be bounded using large deviation theory. For the swarm to go extinct, we need an extreme fluctuation where the number of deaths exceeds the number of revivals by $\\sim m_{a,\\infty} N$.\n608: \n609: By Cram\u00e9r's theorem for sums of independent random variables (or its extension to weakly dependent systems via the Azuma-Hoeffding inequality), the probability of such a large deviation decays exponentially in $N$:\n610: \n611: $$\n612: \\mathbb{P}_{\\nu_N^{QSD}}(\\tau_{\\text{ext}} \\leq T) \\leq e^{-c N}\n613: \n614: $$\n615: \n616: for some constant $c > 0$ independent of $N$. Therefore:\n617: \n618: $$\n619: \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\geq T \\cdot (1 - e^{-cN})\n620: \n621: $$\n622: \n623: As $N \\to \\infty$, the right-hand side grows without bound. Since $T$ is arbitrary, we have:\n624: \n625: $$\n626: \\lim_{N \\to \\infty} \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] = \\infty\n627: \n628: $$\n629: \n630: **Formal justification via QSD theory**: The above heuristic argument can be made rigorous using the theory of quasi-stationary distributions for processes with state-dependent killing. More formally, the N-uniform Foster-Lyapunov condition from `06_convergence.md` implies a **uniform geometric ergodicity** for the process conditioned on non-extinction. By Theorem 2.1 in Champagnat & Villemonais, *\"General criteria for the study of quasi-stationarity\"*, Annals of Probability 40(4), 2012, pp. 1427-1497, such a uniform Lyapunov drift condition combined with the concentration of the empirical measure (law of large numbers) implies that the expected hitting time of the absorbing state grows **exponentially in N**:\n631: \n632: $$\n633: \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\geq C e^{\\beta N}\n634: \n635: $$\n636: \n637: for some constants $C, \\beta > 0$. This is the rigorous version of the large deviation bound above, directly connecting our N-uniform Lyapunov condition to the vanishing extinction rate.\n638: \n639: **Remark**: The key insight is that the N-uniform drift condition is not merely sufficient to control the process for each fixed $N$, but provides the uniform control necessary to prove that the extinction probability becomes negligible as $N \\to \\infty$. This bridges the gap between the Foster-Lyapunov stability analysis (which controls trajectories before extinction) and the QSD asymptotics (which control the extinction event itself).\n640: \n641: **Step 5: Conclusion**\n642: \n643: From Step 1, the extinction rate is:\n644: \n645: $$\n646: \\lambda_N = \\frac{1}{\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}]} \\to 0 \\quad \\text{as } N \\to \\infty\n647: \n648: $$\n649: \n650: **Implication for the Limit**: When we take the limit of the N-particle stationarity condition:\n651: \n652: $$\n653: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = -\\lambda_{N_k} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\phi(z_1)]\n654: \n655: $$\n656: \n657: Since $\\lambda_{N_k} \\to 0$ and $\\phi$ is bounded, the right-hand side vanishes:\n658: \n659: $$\n660: \\lim_{k \\to \\infty} \\left(-\\lambda_{N_k} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\phi(z_1)]\\right) = 0\n661: \n662: $$\n663: \n664: Therefore, the limiting equation is the **standard stationary PDE** with no extinction term:\n665: \n666: $$\n667: \\int_\\Omega \\left(L^\\dagger \\rho_0 - c(z)\\rho_0 + S[\\rho_0] + B[\\rho_0, m_{d,\\infty}]\\right) \\phi \\, dz = 0\n668: \n669: $$\n670: \n671: This rigorously justifies the identification step.",
      "metadata": {
        "label": "proof-thm-extinction-rate-vanishes"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "557: :::\n558: \n559: :::{prf:proof}\n560: :label: proof-thm-extinction-rate-vanishes\n561: The proof uses the N-uniform Foster-Lyapunov condition established in `06_convergence.md` to bound the extinction rate.\n562: \n563: **Step 1: Relation Between Extinction Rate and Expected Hitting Time**\n564: \n565: A classical result in the theory of quasi-stationary distributions (Champagnat & Villemonais, *Ann. Probab.* 2012, Theorem 2.1) states that for a process killed at the boundary, the extinction rate satisfies:\n566: \n567: $$\n568: \\lambda_N = \\frac{1}{\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}]}\n569: \n570: $$\n571: \n572: where $\\tau_{\\text{ext}}$ is the **expected time to extinction** (hitting time of the absorbing state) when starting from the QSD. Thus, proving $\\lambda_N \\to 0$ is equivalent to proving that $\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\to \\infty$.\n573: \n574: **Step 2: N-Uniform Foster-Lyapunov Condition**\n575: \n576: The Foster-Lyapunov drift condition from `06_convergence.md` establishes that there exists a Lyapunov function $V: \\Sigma_N \\to \\mathbb{R}_{\\geq 0}$ and N-uniform constants $\\kappa > 0$ and $C < \\infty$ such that:\n577: \n578: $$\n579: \\mathcal{L}_N V(S) \\leq -\\kappa V(S) + C\n580: \n581: $$\n582: \n583: for all states $S \\in \\Sigma_N$ (the alive states). This drift condition holds **uniformly in N**.\n584: \n585: **Crucially**, the Lyapunov function has a specific structure tied to the mean-field limit: $V(S_N)$ is a function of the empirical measure that controls the distance from the target limiting distribution. As the number of particles grows, the typical value of $V$ under the QSD scales in a way that reflects the concentration of the empirical measure.\n586: \n587: **Step 3: Refined Argument Using Concentration of Walkers**\n588: \n589: The key insight is that as $N$ increases, the **number of alive walkers** becomes increasingly concentrated around its mean due to the law of large numbers. Let $k_N(t)$ denote the number of alive walkers at time $t$.\n590: \n591: From the coupled dynamics in `06_mean_field.md`, the alive mass fraction $m_{a,N} = k_N/N$ satisfies a balance equation at stationarity:\n592: \n593: $$\n594: \\lambda_{\\text{rev}} m_{d,N} = k_{\\text{killed}}[f_N]\n595: \n596: $$\n597: \n598: By the law of large numbers for exchangeable systems, as $N \\to \\infty$:\n599: - The empirical killing rate $k_{\\text{killed}}[f_N] \\to k_{\\text{killed}}[\\rho_0]$ (a constant)\n600: - The fraction $m_{d,N} \\to m_{d,\\infty}$ (a constant in $(0,1)$)\n601: - Therefore, $m_{a,N} \\to m_{a,\\infty} = 1 - m_{d,\\infty} \\in (0,1)$\n602: \n603: For large $N$, the number of alive walkers is approximately $k_N \\approx m_{a,\\infty} \\cdot N$. Extinction occurs when $k_N = 0$, which requires all $\\sim m_{a,\\infty} N$ walkers to die simultaneously.\n604: \n605: **Step 4: Large Deviation Estimate and Formal Connection to QSD Theory**\n606: \n607: The probability of extinction within any fixed time window $[0, T]$ can be bounded using large deviation theory. For the swarm to go extinct, we need an extreme fluctuation where the number of deaths exceeds the number of revivals by $\\sim m_{a,\\infty} N$.\n608: \n609: By Cram\u00e9r's theorem for sums of independent random variables (or its extension to weakly dependent systems via the Azuma-Hoeffding inequality), the probability of such a large deviation decays exponentially in $N$:\n610: \n611: $$\n612: \\mathbb{P}_{\\nu_N^{QSD}}(\\tau_{\\text{ext}} \\leq T) \\leq e^{-c N}\n613: \n614: $$\n615: \n616: for some constant $c > 0$ independent of $N$. Therefore:\n617: \n618: $$\n619: \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\geq T \\cdot (1 - e^{-cN})\n620: \n621: $$\n622: \n623: As $N \\to \\infty$, the right-hand side grows without bound. Since $T$ is arbitrary, we have:\n624: \n625: $$\n626: \\lim_{N \\to \\infty} \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] = \\infty\n627: \n628: $$\n629: \n630: **Formal justification via QSD theory**: The above heuristic argument can be made rigorous using the theory of quasi-stationary distributions for processes with state-dependent killing. More formally, the N-uniform Foster-Lyapunov condition from `06_convergence.md` implies a **uniform geometric ergodicity** for the process conditioned on non-extinction. By Theorem 2.1 in Champagnat & Villemonais, *\"General criteria for the study of quasi-stationarity\"*, Annals of Probability 40(4), 2012, pp. 1427-1497, such a uniform Lyapunov drift condition combined with the concentration of the empirical measure (law of large numbers) implies that the expected hitting time of the absorbing state grows **exponentially in N**:\n631: \n632: $$\n633: \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\geq C e^{\\beta N}\n634: \n635: $$\n636: \n637: for some constants $C, \\beta > 0$. This is the rigorous version of the large deviation bound above, directly connecting our N-uniform Lyapunov condition to the vanishing extinction rate.\n638: \n639: **Remark**: The key insight is that the N-uniform drift condition is not merely sufficient to control the process for each fixed $N$, but provides the uniform control necessary to prove that the extinction probability becomes negligible as $N \\to \\infty$. This bridges the gap between the Foster-Lyapunov stability analysis (which controls trajectories before extinction) and the QSD asymptotics (which control the extinction event itself).\n640: \n641: **Step 5: Conclusion**\n642: \n643: From Step 1, the extinction rate is:\n644: \n645: $$\n646: \\lambda_N = \\frac{1}{\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}]} \\to 0 \\quad \\text{as } N \\to \\infty\n647: \n648: $$\n649: \n650: **Implication for the Limit**: When we take the limit of the N-particle stationarity condition:\n651: \n652: $$\n653: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = -\\lambda_{N_k} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\phi(z_1)]\n654: \n655: $$\n656: \n657: Since $\\lambda_{N_k} \\to 0$ and $\\phi$ is bounded, the right-hand side vanishes:\n658: \n659: $$\n660: \\lim_{k \\to \\infty} \\left(-\\lambda_{N_k} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\phi(z_1)]\\right) = 0\n661: \n662: $$\n663: \n664: Therefore, the limiting equation is the **standard stationary PDE** with no extinction term:\n665: \n666: $$\n667: \\int_\\Omega \\left(L^\\dagger \\rho_0 - c(z)\\rho_0 + S[\\rho_0] + B[\\rho_0, m_{d,\\infty}]\\right) \\phi \\, dz = 0\n668: \n669: $$\n670: \n671: This rigorously justifies the identification step.\n672: "
    },
    {
      "directive_type": "remark",
      "label": "rem-extinction-rate-physical-interpretation",
      "title": "Physical Interpretation",
      "start_line": 674,
      "end_line": 677,
      "header_lines": [
        675
      ],
      "content_start": 676,
      "content_end": 676,
      "content": "676: :::{prf:remark} Physical Interpretation",
      "metadata": {
        "label": "rem-extinction-rate-physical-interpretation"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "674: :::\n675: \n676: :::{prf:remark} Physical Interpretation\n677: :label: rem-extinction-rate-physical-interpretation"
    },
    {
      "directive_type": "theorem",
      "label": "thm-limit-is-weak-solution",
      "title": "Limit Points are Weak Solutions to the Stationary Mean-Field PDE",
      "start_line": 683,
      "end_line": 701,
      "header_lines": [
        684
      ],
      "content_start": 686,
      "content_end": 700,
      "content": "686: :label: thm-limit-is-weak-solution\n687: \n688: Let $\\{\\mu_{N_k}\\}$ be any subsequence of the marginal measures that converges weakly to a limit point $\\mu_\\infty$. Then $\\mu_\\infty$ is a weak solution to the stationary mean-field coupled system:\n689: \n690: $$\n691: L^\\dagger \\rho_0 - c(z)\\rho_0 + S[\\rho_0] + B[\\rho_0, m_{d,\\infty}] = 0\n692: \n693: $$\n694: \n695: with the equilibrium condition:\n696: \n697: $$\n698: k_{\\text{killed}}[\\rho_0] = \\lambda_{\\text{rev}} m_{d,\\infty}\n699: \n700: $$",
      "metadata": {
        "label": "thm-limit-is-weak-solution"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "683: #### **Theorem C.2: Limit Points are Weak Solutions to the Stationary Mean-Field PDE**\n684: \n685: :::{prf:theorem} Limit Points are Weak Solutions to the Stationary Mean-Field PDE\n686: :label: thm-limit-is-weak-solution\n687: \n688: Let $\\{\\mu_{N_k}\\}$ be any subsequence of the marginal measures that converges weakly to a limit point $\\mu_\\infty$. Then $\\mu_\\infty$ is a weak solution to the stationary mean-field coupled system:\n689: \n690: $$\n691: L^\\dagger \\rho_0 - c(z)\\rho_0 + S[\\rho_0] + B[\\rho_0, m_{d,\\infty}] = 0\n692: \n693: $$\n694: \n695: with the equilibrium condition:\n696: \n697: $$\n698: k_{\\text{killed}}[\\rho_0] = \\lambda_{\\text{rev}} m_{d,\\infty}\n699: \n700: $$\n701: "
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-limit-is-weak-solution",
      "title": null,
      "start_line": 703,
      "end_line": 834,
      "header_lines": [
        704
      ],
      "content_start": 705,
      "content_end": 833,
      "content": "705: :::{prf:proof}\n706: :label: proof-thm-limit-is-weak-solution\n707: **Proof.**\n708: \n709: A measure $\\mu_\\infty$ with density $\\rho_0$ is a weak solution to the stationary mean-field equation if, for any smooth, compactly supported test function $\\phi \\in C_c^\\infty(\\Omega)$, it satisfies:\n710: \n711: $$\n712: \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n713: \n714: $$\n715: \n716: We establish this by starting with the N-particle stationarity condition and taking the limit as $k \\to \\infty$.\n717: \n718: **Step 1: The N-Particle Stationarity Condition**\n719: \n720: For each $N_k$, the QSD $\\nu_{N_k}^{QSD}$ is stationary with respect to the N-particle generator $\\mathcal{L}_{N_k}$. Choosing a test function $\\Phi(S) = \\phi(z_1)$ that depends only on the first particle, the stationarity condition is:\n721: \n722: $$\n723: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = 0 \\quad \\text{for all } k\n724: \n725: $$\n726: \n727: Decomposing the generator as $\\mathcal{L}_{N_k} = \\mathcal{L}_{\\text{kin}, N_k} + \\mathcal{L}_{\\text{clone}, N_k}$, we have:\n728: \n729: $$\n730: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{kin}, N_k} \\phi(z_1)] + \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = 0 \\quad (*)\n731: \n732: $$\n733: \n734: **Step 2: Limit of the Kinetic Term**\n735: \n736: The kinetic generator acts only on walker 1, independently of all other walkers. Therefore:\n737: \n738: $$\n739: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{kin}, N_k} \\phi(z_1)] = \\int_{\\Omega} (L\\phi)(z) \\, d\\mu_{N_k}(z)\n740: \n741: $$\n742: \n743: By weak convergence $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$ and the fact that $L\\phi$ is continuous and bounded (since $\\phi$ is smooth and compactly supported), we have:\n744: \n745: $$\n746: \\lim_{k \\to \\infty} \\int_{\\Omega} (L\\phi)(z) \\, d\\mu_{N_k}(z) = \\int_{\\Omega} (L\\phi)(z) \\, \\rho_0(z) \\, dz = \\int_{\\Omega} (L^\\dagger\\rho_0)(z) \\phi(z) \\, dz\n747: \n748: $$\n749: \n750: where the last equality uses the definition of the adjoint operator.\n751: \n752: **Step 3: Limit of the Internal Cloning Term**\n753: \n754: This is the heart of the propagation of chaos argument. The **internal cloning** generator for walker 1 (distinct from the boundary death/revival mechanism) has the structure:\n755: \n756: $$\n757: \\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1) = \\int_{\\Omega} K_{N_k}(z_1, z'; S_{N_k}) (\\phi(z') - \\phi(z_1)) \\, dz'\n758: \n759: $$\n760: \n761: where $K_{N_k}(z_1, z'; S_{N_k})$ is the transition kernel that depends on the empirical statistics of the companion set $\\{z_2, \\ldots, z_{N_k}\\}$. Specifically, the fitness potential $V_N(z_1)$ that governs cloning rates is computed using empirical moments:\n762: \n763: $$\n764: V_N(z_1) = V(z_1; \\mu_R[\\mu_{N_k-1}^{\\text{comp}}], \\sigma_R^2[\\mu_{N_k-1}^{\\text{comp}}], \\mu_D[\\mu_{N_k-1}^{\\text{comp}}], \\sigma_D^2[\\mu_{N_k-1}^{\\text{comp}}])\n765: \n766: $$\n767: \n768: By Lemma [](#lem-empirical-convergence), $\\mu_{N_k-1}^{\\text{comp}} \\rightharpoonup \\mu_\\infty$. By Lemmas [](#lem-reward-continuity) and [](#lem-distance-continuity), the moment functionals converge:\n769: \n770: $$\n771: \\mu_R[\\mu_{N_k-1}^{\\text{comp}}] \\to \\mu_R[\\mu_\\infty], \\quad \\sigma_R^2[\\mu_{N_k-1}^{\\text{comp}}] \\to \\sigma_R^2[\\mu_\\infty]\n772: \n773: $$\n774: \n775: and similarly for the distance moments. Since the fitness potential $V$ is a continuous function of its arguments (by the axioms), we have:\n776: \n777: $$\n778: V_N(z_1) \\to V[\\rho_0](z_1)\n779: \n780: $$\n781: \n782: point-wise for $\\mu_\\infty$-almost every $z_1$, where $V[\\rho_0]$ is the mean-field fitness potential computed using the moments of $\\rho_0$.\n783: \n784: By Lemma [](#lem-uniform-integrability), we can interchange the limit and the expectation. The cloning rates, which involve sums of the form\n785: \n786: $$\n787: \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\pi(V_N(z_1), V_N(z_j))\n788: \n789: $$\n790: \n791: converge (by Lemma [](#lem-empirical-convergence)) to the integral\n792: \n793: $$\n794: \\int_\\Omega \\pi(V[\\rho_0](z_1), V[\\rho_0](z_c)) \\rho_0(z_c) \\, dz_c\n795: \n796: $$\n797: \n798: Therefore, the **internal cloning** term (mass-neutral redistribution within the alive population) converges:\n799: \n800: $$\n801: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = \\int_{\\Omega} S[\\rho_0](z) \\phi(z) \\, dz\n802: \n803: $$\n804: \n805: where $S[\\rho_0]$ is the mean-field internal cloning operator defined in `06_mean_field.md`.\n806: \n807: **Step 4: Limit of the Boundary Death and Revival Mechanism**\n808: \n809: By Lemma [](#lem-boundary-convergence), the discrete boundary death and revival mechanism converges to the continuous interior-killing-and-revival operators:\n810: \n811: $$\n812: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n813: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n814: \n815: $$\n816: \n817: **Step 5: Conclusion**\n818: \n819: Combining all three terms (kinetic, internal cloning, and boundary), and taking the limit $k \\to \\infty$ of the stationarity condition $(*)$, we obtain:\n820: \n821: $$\n822: \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n823: \n824: $$\n825: \n826: Additionally, at the stationary state, the total mass killed must equal the total mass revived. Integrating the killing rate over $\\Omega$ and equating to the revival rate:\n827: \n828: $$\n829: \\int_\\Omega c(z)\\rho_0(z) \\, dz = k_{\\text{killed}}[\\rho_0] = \\lambda_{\\text{rev}} m_{d,\\infty}\n830: \n831: $$\n832: \n833: Since this holds for any smooth, compactly supported test function $\\phi \\in C_c^\\infty(\\Omega)$, the density $\\rho_0$ is, by definition, a weak solution to the stationary mean-field coupled system.",
      "metadata": {
        "label": "proof-thm-limit-is-weak-solution"
      },
      "section": "## **4. Identification of the Limit Point**",
      "raw_directive": "703: :::\n704: \n705: :::{prf:proof}\n706: :label: proof-thm-limit-is-weak-solution\n707: **Proof.**\n708: \n709: A measure $\\mu_\\infty$ with density $\\rho_0$ is a weak solution to the stationary mean-field equation if, for any smooth, compactly supported test function $\\phi \\in C_c^\\infty(\\Omega)$, it satisfies:\n710: \n711: $$\n712: \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n713: \n714: $$\n715: \n716: We establish this by starting with the N-particle stationarity condition and taking the limit as $k \\to \\infty$.\n717: \n718: **Step 1: The N-Particle Stationarity Condition**\n719: \n720: For each $N_k$, the QSD $\\nu_{N_k}^{QSD}$ is stationary with respect to the N-particle generator $\\mathcal{L}_{N_k}$. Choosing a test function $\\Phi(S) = \\phi(z_1)$ that depends only on the first particle, the stationarity condition is:\n721: \n722: $$\n723: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = 0 \\quad \\text{for all } k\n724: \n725: $$\n726: \n727: Decomposing the generator as $\\mathcal{L}_{N_k} = \\mathcal{L}_{\\text{kin}, N_k} + \\mathcal{L}_{\\text{clone}, N_k}$, we have:\n728: \n729: $$\n730: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{kin}, N_k} \\phi(z_1)] + \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = 0 \\quad (*)\n731: \n732: $$\n733: \n734: **Step 2: Limit of the Kinetic Term**\n735: \n736: The kinetic generator acts only on walker 1, independently of all other walkers. Therefore:\n737: \n738: $$\n739: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{kin}, N_k} \\phi(z_1)] = \\int_{\\Omega} (L\\phi)(z) \\, d\\mu_{N_k}(z)\n740: \n741: $$\n742: \n743: By weak convergence $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$ and the fact that $L\\phi$ is continuous and bounded (since $\\phi$ is smooth and compactly supported), we have:\n744: \n745: $$\n746: \\lim_{k \\to \\infty} \\int_{\\Omega} (L\\phi)(z) \\, d\\mu_{N_k}(z) = \\int_{\\Omega} (L\\phi)(z) \\, \\rho_0(z) \\, dz = \\int_{\\Omega} (L^\\dagger\\rho_0)(z) \\phi(z) \\, dz\n747: \n748: $$\n749: \n750: where the last equality uses the definition of the adjoint operator.\n751: \n752: **Step 3: Limit of the Internal Cloning Term**\n753: \n754: This is the heart of the propagation of chaos argument. The **internal cloning** generator for walker 1 (distinct from the boundary death/revival mechanism) has the structure:\n755: \n756: $$\n757: \\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1) = \\int_{\\Omega} K_{N_k}(z_1, z'; S_{N_k}) (\\phi(z') - \\phi(z_1)) \\, dz'\n758: \n759: $$\n760: \n761: where $K_{N_k}(z_1, z'; S_{N_k})$ is the transition kernel that depends on the empirical statistics of the companion set $\\{z_2, \\ldots, z_{N_k}\\}$. Specifically, the fitness potential $V_N(z_1)$ that governs cloning rates is computed using empirical moments:\n762: \n763: $$\n764: V_N(z_1) = V(z_1; \\mu_R[\\mu_{N_k-1}^{\\text{comp}}], \\sigma_R^2[\\mu_{N_k-1}^{\\text{comp}}], \\mu_D[\\mu_{N_k-1}^{\\text{comp}}], \\sigma_D^2[\\mu_{N_k-1}^{\\text{comp}}])\n765: \n766: $$\n767: \n768: By Lemma [](#lem-empirical-convergence), $\\mu_{N_k-1}^{\\text{comp}} \\rightharpoonup \\mu_\\infty$. By Lemmas [](#lem-reward-continuity) and [](#lem-distance-continuity), the moment functionals converge:\n769: \n770: $$\n771: \\mu_R[\\mu_{N_k-1}^{\\text{comp}}] \\to \\mu_R[\\mu_\\infty], \\quad \\sigma_R^2[\\mu_{N_k-1}^{\\text{comp}}] \\to \\sigma_R^2[\\mu_\\infty]\n772: \n773: $$\n774: \n775: and similarly for the distance moments. Since the fitness potential $V$ is a continuous function of its arguments (by the axioms), we have:\n776: \n777: $$\n778: V_N(z_1) \\to V[\\rho_0](z_1)\n779: \n780: $$\n781: \n782: point-wise for $\\mu_\\infty$-almost every $z_1$, where $V[\\rho_0]$ is the mean-field fitness potential computed using the moments of $\\rho_0$.\n783: \n784: By Lemma [](#lem-uniform-integrability), we can interchange the limit and the expectation. The cloning rates, which involve sums of the form\n785: \n786: $$\n787: \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\pi(V_N(z_1), V_N(z_j))\n788: \n789: $$\n790: \n791: converge (by Lemma [](#lem-empirical-convergence)) to the integral\n792: \n793: $$\n794: \\int_\\Omega \\pi(V[\\rho_0](z_1), V[\\rho_0](z_c)) \\rho_0(z_c) \\, dz_c\n795: \n796: $$\n797: \n798: Therefore, the **internal cloning** term (mass-neutral redistribution within the alive population) converges:\n799: \n800: $$\n801: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = \\int_{\\Omega} S[\\rho_0](z) \\phi(z) \\, dz\n802: \n803: $$\n804: \n805: where $S[\\rho_0]$ is the mean-field internal cloning operator defined in `06_mean_field.md`.\n806: \n807: **Step 4: Limit of the Boundary Death and Revival Mechanism**\n808: \n809: By Lemma [](#lem-boundary-convergence), the discrete boundary death and revival mechanism converges to the continuous interior-killing-and-revival operators:\n810: \n811: $$\n812: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n813: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n814: \n815: $$\n816: \n817: **Step 5: Conclusion**\n818: \n819: Combining all three terms (kinetic, internal cloning, and boundary), and taking the limit $k \\to \\infty$ of the stationarity condition $(*)$, we obtain:\n820: \n821: $$\n822: \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n823: \n824: $$\n825: \n826: Additionally, at the stationary state, the total mass killed must equal the total mass revived. Integrating the killing rate over $\\Omega$ and equating to the revival rate:\n827: \n828: $$\n829: \\int_\\Omega c(z)\\rho_0(z) \\, dz = k_{\\text{killed}}[\\rho_0] = \\lambda_{\\text{rev}} m_{d,\\infty}\n830: \n831: $$\n832: \n833: Since this holds for any smooth, compactly supported test function $\\phi \\in C_c^\\infty(\\Omega)$, the density $\\rho_0$ is, by definition, a weak solution to the stationary mean-field coupled system.\n834: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}