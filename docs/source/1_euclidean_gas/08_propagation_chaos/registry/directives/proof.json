{
  "document_id": "08_propagation_chaos",
  "stage": "directives",
  "directive_type": "proof",
  "generated_at": "2025-11-10T13:24:29.483802+00:00",
  "count": 26,
  "items": [
    {
      "directive_type": "proof",
      "label": "proof-thm-qsd-marginals-are-tight",
      "title": null,
      "start_line": 157,
      "end_line": 191,
      "header_lines": [
        158
      ],
      "content_start": 159,
      "content_end": 190,
      "content": "159: :::{prf:proof}\n160: :label: proof-thm-qsd-marginals-are-tight\n161: **Proof.**\n162: \n163: The proof proceeds by verifying the conditions of Prokhorov's theorem. On the Polish space $\\Omega$, this is equivalent to showing that for any $\\epsilon > 0$, there exists a compact set $K_\\epsilon \\subset \\Omega$ such that the containment condition $\\mu_N(K_\\epsilon) \\ge 1 - \\epsilon$ holds uniformly for all $N \\ge 2$. We establish this uniform containment by leveraging the moment bounds provided by the Lyapunov function analysis from `06_convergence.md`.\n164: \n165: 1.  **Uniform Moment Bound from the N-Particle System:**\n166:     The geometric ergodicity of the N-particle system, established in `06_convergence.md`, relies on a Foster-Lyapunov drift condition for a Lyapunov function $V_{\\text{total}}(S)$. A standard result from the theory of Markov chains (see Meyn & Tweedie) is that such a geometric drift condition implies the existence of uniform moment bounds for the corresponding stationary measure. Specifically, there exists a constant $C < \\infty$, which is independent of the number of walkers $N$, such that the expectation of the Lyapunov function with respect to the N-particle QSD is uniformly bounded:\n167:     $$\n168:     \\mathbb{E}_{\\nu_N^{QSD}}[V_{\\text{total}}] = \\int_{\\Sigma_N} V_{\\text{total}}(S) \\, d\\nu_N^{QSD}(S) \\le C\n169:     $$\n170: \n171: 2.  **Translation to a Single-Particle Moment Bound:**\n172:     The Lyapunov function $V_{\\text{total}}$ is constructed as a sum of terms, including the average squared norms of the walkers' kinematic states, of the form $\\frac{1}{N}\\sum_i (\\|x_i\\|^2 + \\|v_i\\|^2)$. By the linearity of expectation and the exchangeability of the walkers under the symmetric measure $\\nu_N^{QSD}$, the uniform bound on the total expectation implies a uniform bound on the expected squared norm of any single walker:\n173:     $$\n174:     \\mathbb{E}_{\\mu_N}[\\|x\\|^2 + \\|v\\|^2] = \\int_\\Omega (\\|x\\|^2 + \\|v\\|^2) \\, d\\mu_N(x,v) \\le C'\n175:     $$\n176:     for some other constant $C'$ that is also independent of $N$. This demonstrates that the second moments of the measures in the sequence $\\{\\mu_N\\}$ are uniformly bounded.\n177: \n178: 3.  **Application of Markov's Inequality to Show Tightness:**\n179:     With this uniform moment control established, we can now apply Markov's inequality to demonstrate uniform containment. For any $R > 0$, let $K_R = \\{ (x,v) \\in \\Omega \\mid \\|x\\|^2 + \\|v\\|^2 \\le R^2 \\}$ be a compact ball in the phase space. The probability of a particle being outside this set is bounded as follows:\n180:     $$\n181:     \\mu_N(\\Omega \\setminus K_R) = \\mathbb{P}(\\|x\\|^2 + \\|v\\|^2 > R^2) \\le \\frac{\\mathbb{E}_{\\mu_N}[\\|x\\|^2 + \\|v\\|^2]}{R^2} \\le \\frac{C'}{R^2}\n182:     $$\n183:     For any desired tolerance $\\epsilon > 0$, we can choose a radius $R$ large enough such that $C'/R^2 \\le \\epsilon$. Specifically, we choose $R_\\epsilon = \\sqrt{C'/\\epsilon}$. This choice defines a compact set $K_\\epsilon := K_{R_\\epsilon}$ for which the following holds:\n184:     $$\n185:     \\mu_N(K_\\epsilon) = 1 - \\mu_N(\\Omega \\setminus K_\\epsilon) \\ge 1 - \\frac{C'}{R_\\epsilon^2} = 1 - \\epsilon.\n186:     $$\n187:     Critically, because the constant $C'$ is independent of $N$, our choice of the compact set $K_\\epsilon$ depends only on the tolerance $\\epsilon$ and not on $N$. This satisfies the uniformity condition required by Prokhorov's theorem.\n188: \n189: 4.  **Conclusion:**\n190:     We have shown that for any $\\epsilon > 0$, there exists a compact set $K_\\epsilon$ such that $\\mu_N(K_\\epsilon) \\ge 1 - \\epsilon$ for all measures in the sequence. By Prokhorov's theorem, this uniform containment guarantees that the sequence of marginal measures $\\{\\mu_N\\}$ is tight. This, in turn, implies the existence of at least one weakly convergent subsequence.",
      "metadata": {
        "label": "proof-thm-qsd-marginals-are-tight"
      },
      "section": "## **3. Tightness of the Marginal Sequence**",
      "references": [],
      "raw_directive": "157: The sequence of single-particle marginal measures $\\{\\mu_N\\}_{N=2}^\\infty$ is tight in the space of probability measures on $\\Omega$, $\\mathcal{P}(\\Omega)$.\n158: :::\n159: :::{prf:proof}\n160: :label: proof-thm-qsd-marginals-are-tight\n161: **Proof.**\n162: \n163: The proof proceeds by verifying the conditions of Prokhorov's theorem. On the Polish space $\\Omega$, this is equivalent to showing that for any $\\epsilon > 0$, there exists a compact set $K_\\epsilon \\subset \\Omega$ such that the containment condition $\\mu_N(K_\\epsilon) \\ge 1 - \\epsilon$ holds uniformly for all $N \\ge 2$. We establish this uniform containment by leveraging the moment bounds provided by the Lyapunov function analysis from `06_convergence.md`.\n164: \n165: 1.  **Uniform Moment Bound from the N-Particle System:**\n166:     The geometric ergodicity of the N-particle system, established in `06_convergence.md`, relies on a Foster-Lyapunov drift condition for a Lyapunov function $V_{\\text{total}}(S)$. A standard result from the theory of Markov chains (see Meyn & Tweedie) is that such a geometric drift condition implies the existence of uniform moment bounds for the corresponding stationary measure. Specifically, there exists a constant $C < \\infty$, which is independent of the number of walkers $N$, such that the expectation of the Lyapunov function with respect to the N-particle QSD is uniformly bounded:\n167:     $$\n168:     \\mathbb{E}_{\\nu_N^{QSD}}[V_{\\text{total}}] = \\int_{\\Sigma_N} V_{\\text{total}}(S) \\, d\\nu_N^{QSD}(S) \\le C\n169:     $$\n170: \n171: 2.  **Translation to a Single-Particle Moment Bound:**\n172:     The Lyapunov function $V_{\\text{total}}$ is constructed as a sum of terms, including the average squared norms of the walkers' kinematic states, of the form $\\frac{1}{N}\\sum_i (\\|x_i\\|^2 + \\|v_i\\|^2)$. By the linearity of expectation and the exchangeability of the walkers under the symmetric measure $\\nu_N^{QSD}$, the uniform bound on the total expectation implies a uniform bound on the expected squared norm of any single walker:\n173:     $$\n174:     \\mathbb{E}_{\\mu_N}[\\|x\\|^2 + \\|v\\|^2] = \\int_\\Omega (\\|x\\|^2 + \\|v\\|^2) \\, d\\mu_N(x,v) \\le C'\n175:     $$\n176:     for some other constant $C'$ that is also independent of $N$. This demonstrates that the second moments of the measures in the sequence $\\{\\mu_N\\}$ are uniformly bounded.\n177: \n178: 3.  **Application of Markov's Inequality to Show Tightness:**\n179:     With this uniform moment control established, we can now apply Markov's inequality to demonstrate uniform containment. For any $R > 0$, let $K_R = \\{ (x,v) \\in \\Omega \\mid \\|x\\|^2 + \\|v\\|^2 \\le R^2 \\}$ be a compact ball in the phase space. The probability of a particle being outside this set is bounded as follows:\n180:     $$\n181:     \\mu_N(\\Omega \\setminus K_R) = \\mathbb{P}(\\|x\\|^2 + \\|v\\|^2 > R^2) \\le \\frac{\\mathbb{E}_{\\mu_N}[\\|x\\|^2 + \\|v\\|^2]}{R^2} \\le \\frac{C'}{R^2}\n182:     $$\n183:     For any desired tolerance $\\epsilon > 0$, we can choose a radius $R$ large enough such that $C'/R^2 \\le \\epsilon$. Specifically, we choose $R_\\epsilon = \\sqrt{C'/\\epsilon}$. This choice defines a compact set $K_\\epsilon := K_{R_\\epsilon}$ for which the following holds:\n184:     $$\n185:     \\mu_N(K_\\epsilon) = 1 - \\mu_N(\\Omega \\setminus K_\\epsilon) \\ge 1 - \\frac{C'}{R_\\epsilon^2} = 1 - \\epsilon.\n186:     $$\n187:     Critically, because the constant $C'$ is independent of $N$, our choice of the compact set $K_\\epsilon$ depends only on the tolerance $\\epsilon$ and not on $N$. This satisfies the uniformity condition required by Prokhorov's theorem.\n188: \n189: 4.  **Conclusion:**\n190:     We have shown that for any $\\epsilon > 0$, there exists a compact set $K_\\epsilon$ such that $\\mu_N(K_\\epsilon) \\ge 1 - \\epsilon$ for all measures in the sequence. By Prokhorov's theorem, this uniform containment guarantees that the sequence of marginal measures $\\{\\mu_N\\}$ is tight. This, in turn, implies the existence of at least one weakly convergent subsequence.\n191: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## **3. Tightness of the Marginal Sequence**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-exchangeability",
      "title": null,
      "start_line": 225,
      "end_line": 232,
      "header_lines": [
        226
      ],
      "content_start": 227,
      "content_end": 231,
      "content": "227: :::{prf:proof}\n228: :label: proof-lem-exchangeability\n229: The Euclidean Gas dynamics are completely symmetric under permutation of walker indices. The kinetic perturbation operator applies the same Ornstein-Uhlenbeck process to each walker independently. The cloning operator selects companions uniformly at random and applies the same fitness comparison rule regardless of walker labels. The boundary revival operator treats all walkers identically.\n230: \n231: Since the generator $\\mathcal{L}_N$ of the N-particle process is invariant under any permutation of walker indices, and since the QSD $\\nu_N^{QSD}$ is the unique stationary measure of this generator, it must inherit this symmetry. By the uniqueness of the QSD, the permuted measure must equal the original measure, establishing exchangeability.",
      "metadata": {
        "label": "proof-lem-exchangeability"
      },
      "section": "## **4. Identification of the Limit Point**",
      "references": [],
      "raw_directive": "225: :::\n226: \n227: :::{prf:proof}\n228: :label: proof-lem-exchangeability\n229: The Euclidean Gas dynamics are completely symmetric under permutation of walker indices. The kinetic perturbation operator applies the same Ornstein-Uhlenbeck process to each walker independently. The cloning operator selects companions uniformly at random and applies the same fitness comparison rule regardless of walker labels. The boundary revival operator treats all walkers identically.\n230: \n231: Since the generator $\\mathcal{L}_N$ of the N-particle process is invariant under any permutation of walker indices, and since the QSD $\\nu_N^{QSD}$ is the unique stationary measure of this generator, it must inherit this symmetry. By the uniqueness of the QSD, the permuted measure must equal the original measure, establishing exchangeability.\n232: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-empirical-convergence",
      "title": null,
      "start_line": 254,
      "end_line": 268,
      "header_lines": [
        255
      ],
      "content_start": 256,
      "content_end": 267,
      "content": "256: :::{prf:proof}\n257: :label: proof-lem-empirical-convergence\n258: By Lemma [](#lem-exchangeability), the sequence of N-particle QSDs consists of exchangeable measures. The **Hewitt-Savage theorem** (see Kallenberg, *Foundations of Modern Probability*, Theorem 11.10) states that any exchangeable sequence of random variables can be represented as a mixture of independent and identically distributed (IID) sequences.\n259: \n260: For large $N_k$, this implies that the companions $\\{z_2, \\ldots, z_{N_k}\\}$ behave asymptotically as if they were independent samples from the marginal distribution $\\mu_{N_k}$. The **Glivenko-Cantelli theorem** (or its extension to Polish spaces, Varadarajan's theorem) guarantees that for such sequences, the empirical measure\n261: \n262: $$\n263: \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\delta_{z_j}\n264: \n265: $$\n266: \n267: converges almost surely to the true underlying measure $\\mu_{N_k}$ as $N_k \\to \\infty$. Since we have assumed $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$ by hypothesis, the empirical companion measure must also converge weakly to $\\mu_\\infty$.",
      "metadata": {
        "label": "proof-lem-empirical-convergence"
      },
      "section": "## **4. Identification of the Limit Point**",
      "references": [],
      "raw_directive": "254: :::\n255: \n256: :::{prf:proof}\n257: :label: proof-lem-empirical-convergence\n258: By Lemma [](#lem-exchangeability), the sequence of N-particle QSDs consists of exchangeable measures. The **Hewitt-Savage theorem** (see Kallenberg, *Foundations of Modern Probability*, Theorem 11.10) states that any exchangeable sequence of random variables can be represented as a mixture of independent and identically distributed (IID) sequences.\n259: \n260: For large $N_k$, this implies that the companions $\\{z_2, \\ldots, z_{N_k}\\}$ behave asymptotically as if they were independent samples from the marginal distribution $\\mu_{N_k}$. The **Glivenko-Cantelli theorem** (or its extension to Polish spaces, Varadarajan's theorem) guarantees that for such sequences, the empirical measure\n261: \n262: $$\n263: \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\delta_{z_j}\n264: \n265: $$\n266: \n267: converges almost surely to the true underlying measure $\\mu_{N_k}$ as $N_k \\to \\infty$. Since we have assumed $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$ by hypothesis, the empirical companion measure must also converge weakly to $\\mu_\\infty$.\n268: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-reward-continuity",
      "title": null,
      "start_line": 289,
      "end_line": 303,
      "header_lines": [
        290
      ],
      "content_start": 291,
      "content_end": 302,
      "content": "291: :::{prf:proof}\n292: :label: proof-lem-reward-continuity\n293: Recall that\n294: \n295: $$\n296: \\mu_R[\\mu] = \\int_\\Omega R(z) \\, d\\mu(z) \\quad \\text{and} \\quad \\sigma_R^2[\\mu] = \\int_\\Omega R(z)^2 \\, d\\mu(z) - \\left(\\int_\\Omega R(z) \\, d\\mu(z)\\right)^2\n297: \n298: $$\n299: \n300: 1. **Continuity of the mean**: The **Axiom of Reward Regularity** establishes that the reward function $R: \\Omega \\to \\mathbb{R}$ is Lipschitz continuous. Since $\\Omega$ is a compact subset of $\\mathbb{R}^{2d}$ (bounded positions and velocity-capped), $R$ is bounded and continuous. A fundamental result in weak convergence theory is that if $\\mu_k \\rightharpoonup \\mu_\\infty$ and $g$ is a bounded, continuous function, then $\\int g \\, d\\mu_k \\to \\int g \\, d\\mu_\\infty$. Applying this with $g = R$ gives the convergence of $\\mu_R[\\mu_k]$.\n301: \n302: 2. **Continuity of the variance**: The function $R(z)^2$ is also bounded and continuous on the compact domain $\\Omega$. By the same argument, $\\int R(z)^2 \\, d\\mu_k \\to \\int R(z)^2 \\, d\\mu_\\infty$. Since both terms in the variance formula converge, and the limit of a difference equals the difference of limits, the variance $\\sigma_R^2[\\mu_k]$ converges to $\\sigma_R^2[\\mu_\\infty]$.",
      "metadata": {
        "label": "proof-lem-reward-continuity"
      },
      "section": "## **4. Identification of the Limit Point**",
      "references": [],
      "raw_directive": "289: :::\n290: \n291: :::{prf:proof}\n292: :label: proof-lem-reward-continuity\n293: Recall that\n294: \n295: $$\n296: \\mu_R[\\mu] = \\int_\\Omega R(z) \\, d\\mu(z) \\quad \\text{and} \\quad \\sigma_R^2[\\mu] = \\int_\\Omega R(z)^2 \\, d\\mu(z) - \\left(\\int_\\Omega R(z) \\, d\\mu(z)\\right)^2\n297: \n298: $$\n299: \n300: 1. **Continuity of the mean**: The **Axiom of Reward Regularity** establishes that the reward function $R: \\Omega \\to \\mathbb{R}$ is Lipschitz continuous. Since $\\Omega$ is a compact subset of $\\mathbb{R}^{2d}$ (bounded positions and velocity-capped), $R$ is bounded and continuous. A fundamental result in weak convergence theory is that if $\\mu_k \\rightharpoonup \\mu_\\infty$ and $g$ is a bounded, continuous function, then $\\int g \\, d\\mu_k \\to \\int g \\, d\\mu_\\infty$. Applying this with $g = R$ gives the convergence of $\\mu_R[\\mu_k]$.\n301: \n302: 2. **Continuity of the variance**: The function $R(z)^2$ is also bounded and continuous on the compact domain $\\Omega$. By the same argument, $\\int R(z)^2 \\, d\\mu_k \\to \\int R(z)^2 \\, d\\mu_\\infty$. Since both terms in the variance formula converge, and the limit of a difference equals the difference of limits, the variance $\\sigma_R^2[\\mu_k]$ converges to $\\sigma_R^2[\\mu_\\infty]$.\n303: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-distance-continuity",
      "title": null,
      "start_line": 318,
      "end_line": 352,
      "header_lines": [
        319
      ],
      "content_start": 320,
      "content_end": 351,
      "content": "320: :::{prf:proof}\n321: :label: proof-lem-distance-continuity\n322: Recall that\n323: \n324: $$\n325: \\mu_D[\\mu] = \\iint_{\\Omega \\times \\Omega} d(z, z') \\, d\\mu(z) \\, d\\mu(z')\n326: \n327: $$\n328: \n329: where $d(z, z')$ is the algorithmic distance between two phase-space points.\n330: \n331: 1. **Continuity of the distance function**: By the axioms of the Euclidean Gas, $d(z, z')$ is a continuous function on $\\Omega \\times \\Omega$. Since $\\Omega$ is compact, the product space $\\Omega \\times \\Omega$ is also compact, and thus $d$ is bounded and continuous on this product space.\n332: \n333: 2. **Weak convergence of product measures**: A fundamental result in measure theory states that if $\\mu_k \\rightharpoonup \\mu_\\infty$, then the product measure $\\mu_k \\otimes \\mu_k$ converges weakly to $\\mu_\\infty \\otimes \\mu_\\infty$ on the product space $\\Omega \\times \\Omega$.\n334: \n335: 3. **Convergence of the integral**: Since $d(z, z')$ is a bounded, continuous function on $\\Omega \\times \\Omega$, and $\\mu_k \\otimes \\mu_k \\rightharpoonup \\mu_\\infty \\otimes \\mu_\\infty$, the continuous mapping theorem for weak convergence implies\n336: \n337: $$\n338: \\iint d(z, z') \\, d(\\mu_k \\otimes \\mu_k)(z, z') \\to \\iint d(z, z') \\, d(\\mu_\\infty \\otimes \\mu_\\infty)(z, z')\n339: \n340: $$\n341: \n342: This establishes the convergence of $\\mu_D[\\mu_k]$.\n343: \n344: 4. **Continuity of the variance**: For the variance, we have\n345: \n346: $$\n347: \\sigma_D^2[\\mu] = \\iint (d(z, z') - \\mu_D[\\mu])^2 \\, d\\mu(z) \\, d\\mu(z')\n348: \n349: $$\n350: \n351: The function $(d(z, z') - c)^2$ is continuous in both its spatial arguments and the constant $c$. Since we have already shown that $\\mu_D[\\mu_k] \\to \\mu_D[\\mu_\\infty]$, the integrand converges point-wise. By the bounded convergence theorem (the integrand is bounded on the compact domain), the integral converges, giving $\\sigma_D^2[\\mu_k] \\to \\sigma_D^2[\\mu_\\infty]$.",
      "metadata": {
        "label": "proof-lem-distance-continuity"
      },
      "section": "## **4. Identification of the Limit Point**",
      "references": [],
      "raw_directive": "318: :::\n319: \n320: :::{prf:proof}\n321: :label: proof-lem-distance-continuity\n322: Recall that\n323: \n324: $$\n325: \\mu_D[\\mu] = \\iint_{\\Omega \\times \\Omega} d(z, z') \\, d\\mu(z) \\, d\\mu(z')\n326: \n327: $$\n328: \n329: where $d(z, z')$ is the algorithmic distance between two phase-space points.\n330: \n331: 1. **Continuity of the distance function**: By the axioms of the Euclidean Gas, $d(z, z')$ is a continuous function on $\\Omega \\times \\Omega$. Since $\\Omega$ is compact, the product space $\\Omega \\times \\Omega$ is also compact, and thus $d$ is bounded and continuous on this product space.\n332: \n333: 2. **Weak convergence of product measures**: A fundamental result in measure theory states that if $\\mu_k \\rightharpoonup \\mu_\\infty$, then the product measure $\\mu_k \\otimes \\mu_k$ converges weakly to $\\mu_\\infty \\otimes \\mu_\\infty$ on the product space $\\Omega \\times \\Omega$.\n334: \n335: 3. **Convergence of the integral**: Since $d(z, z')$ is a bounded, continuous function on $\\Omega \\times \\Omega$, and $\\mu_k \\otimes \\mu_k \\rightharpoonup \\mu_\\infty \\otimes \\mu_\\infty$, the continuous mapping theorem for weak convergence implies\n336: \n337: $$\n338: \\iint d(z, z') \\, d(\\mu_k \\otimes \\mu_k)(z, z') \\to \\iint d(z, z') \\, d(\\mu_\\infty \\otimes \\mu_\\infty)(z, z')\n339: \n340: $$\n341: \n342: This establishes the convergence of $\\mu_D[\\mu_k]$.\n343: \n344: 4. **Continuity of the variance**: For the variance, we have\n345: \n346: $$\n347: \\sigma_D^2[\\mu] = \\iint (d(z, z') - \\mu_D[\\mu])^2 \\, d\\mu(z) \\, d\\mu(z')\n348: \n349: $$\n350: \n351: The function $(d(z, z') - c)^2$ is continuous in both its spatial arguments and the constant $c$. Since we have already shown that $\\mu_D[\\mu_k] \\to \\mu_D[\\mu_\\infty]$, the integrand converges point-wise. By the bounded convergence theorem (the integrand is bounded on the compact domain), the integral converges, giving $\\sigma_D^2[\\mu_k] \\to \\sigma_D^2[\\mu_\\infty]$.\n352: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-uniform-integrability",
      "title": null,
      "start_line": 382,
      "end_line": 407,
      "header_lines": [
        383
      ],
      "content_start": 384,
      "content_end": 406,
      "content": "384: :::{prf:proof}\n385: :label: proof-lem-uniform-integrability\n386: We must show that all terms in the generator applied to $\\phi$ are uniformly bounded in $N_k$.\n387: \n388: 1. **Kinetic term**: The test function $\\phi$ is smooth and compactly supported, so $\\phi$ and all its derivatives are bounded. The kinetic generator $\\mathcal{L}_{\\text{kin}}$ is a second-order differential operator with smooth, bounded coefficients (from the axioms). Therefore, $|\\mathcal{L}_{\\text{kin}} \\phi(z)| \\le C_{\\text{kin}}$ for some constant $C_{\\text{kin}}$ independent of $N$.\n389: \n390: 2. **Cloning term**: The cloning generator has the form\n391: \n392: $$\n393: \\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1) = \\sum_{\\text{transitions}} \\lambda(z_1 \\to z') (\\phi(z') - \\phi(z_1))\n394: \n395: $$\n396: \n397: where the transition rates $\\lambda(z_1 \\to z')$ are derived from cloning probabilities (which are bounded by 1) and the selection rate $\\lambda_{\\text{sel}}$ (a fixed constant). The jump kernel lands in the compact domain $\\Omega$, so $|\\phi(z') - \\phi(z_1)| \\le 2 \\|\\phi\\|_\\infty < \\infty$. The total jump rate out of any state is bounded by a constant times $\\lambda_{\\text{sel}}$. Therefore, $|\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)| \\le C_{\\text{clone}}$ for some constant $C_{\\text{clone}}$ independent of $N_k$.\n398: \n399: 3. **Uniform bound**: Combining both terms,\n400: \n401: $$\n402: |\\mathcal{L}_{N_k} \\phi(z_1)| \\le C_{\\text{kin}} + C_{\\text{clone}} =: C\n403: \n404: $$\n405: \n406: Since this bound is independent of $N_k$ and independent of the state $z_1 \\in \\Omega$, the sequence of integrands is uniformly bounded. On a probability space, uniform boundedness implies uniform integrability. By the Dominated Convergence Theorem, we can interchange the limit and the expectation.",
      "metadata": {
        "label": "proof-lem-uniform-integrability"
      },
      "section": "## **4. Identification of the Limit Point**",
      "references": [],
      "raw_directive": "382: :::\n383: \n384: :::{prf:proof}\n385: :label: proof-lem-uniform-integrability\n386: We must show that all terms in the generator applied to $\\phi$ are uniformly bounded in $N_k$.\n387: \n388: 1. **Kinetic term**: The test function $\\phi$ is smooth and compactly supported, so $\\phi$ and all its derivatives are bounded. The kinetic generator $\\mathcal{L}_{\\text{kin}}$ is a second-order differential operator with smooth, bounded coefficients (from the axioms). Therefore, $|\\mathcal{L}_{\\text{kin}} \\phi(z)| \\le C_{\\text{kin}}$ for some constant $C_{\\text{kin}}$ independent of $N$.\n389: \n390: 2. **Cloning term**: The cloning generator has the form\n391: \n392: $$\n393: \\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1) = \\sum_{\\text{transitions}} \\lambda(z_1 \\to z') (\\phi(z') - \\phi(z_1))\n394: \n395: $$\n396: \n397: where the transition rates $\\lambda(z_1 \\to z')$ are derived from cloning probabilities (which are bounded by 1) and the selection rate $\\lambda_{\\text{sel}}$ (a fixed constant). The jump kernel lands in the compact domain $\\Omega$, so $|\\phi(z') - \\phi(z_1)| \\le 2 \\|\\phi\\|_\\infty < \\infty$. The total jump rate out of any state is bounded by a constant times $\\lambda_{\\text{sel}}$. Therefore, $|\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)| \\le C_{\\text{clone}}$ for some constant $C_{\\text{clone}}$ independent of $N_k$.\n398: \n399: 3. **Uniform bound**: Combining both terms,\n400: \n401: $$\n402: |\\mathcal{L}_{N_k} \\phi(z_1)| \\le C_{\\text{kin}} + C_{\\text{clone}} =: C\n403: \n404: $$\n405: \n406: Since this bound is independent of $N_k$ and independent of the state $z_1 \\in \\Omega$, the sequence of integrands is uniformly bounded. On a probability space, uniform boundedness implies uniform integrability. By the Dominated Convergence Theorem, we can interchange the limit and the expectation.\n407: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-boundary-convergence",
      "title": null,
      "start_line": 425,
      "end_line": 517,
      "header_lines": [
        426
      ],
      "content_start": 427,
      "content_end": 516,
      "content": "427: :::{prf:proof}\n428: :label: proof-lem-boundary-convergence\n429: This convergence is established in two steps, corresponding to the two physical processes: death at the boundary and revival from the dead reservoir.\n430: \n431: **Step 1: Discrete Death Converges to Interior Killing**\n432: \n433: In the discrete N-particle algorithm, a walker dies (status becomes 0) when its position leaves the valid domain $X_{\\text{valid}}$. This is a hard boundary condition: the walker is killed instantaneously upon crossing $\\partial X_{\\text{valid}}$.\n434: \n435: In the continuous limit, Theorem 4.4.2 of `06_mean_field.md` (Consistency of the Interior Killing Rate Approximation) rigorously proves that as the timestep $\\tau \\to 0$, the discrete exit probability per timestep converges to a smooth interior killing rate:\n436: \n437: $$\n438: \\lim_{\\tau \\to 0} \\frac{1}{\\tau} p_{\\text{exit}}(z, \\tau) = c(z)\n439: \n440: $$\n441: \n442: with uniform convergence over the phase space $\\Omega$. The killing rate $c(z)$ has the following properties:\n443: - $c(z) = 0$ for $z$ in the interior of $\\Omega$ (away from $\\partial X_{\\text{valid}}$)\n444: - $c(z) > 0$ in a smooth boundary layer near $\\partial X_{\\text{valid}}$\n445: - $c \\in C^\\infty(\\Omega)$ (smooth)\n446: \n447: The contribution of the killing mechanism to the generator is:\n448: \n449: $$\n450: \\mathcal{L}_{\\text{death}, N_k} \\phi(z_1) = -\\frac{1}{\\tau} p_{\\text{exit}}(z_1, \\tau) \\phi(z_1)\n451: \n452: $$\n453: \n454: Taking the limit as $k \\to \\infty$ (equivalently, $\\tau \\to 0$), and integrating against the marginal density:\n455: \n456: $$\n457: \\lim_{k \\to \\infty} \\mathbb{E}_{\\mu_{N_k}}\\left[\\mathcal{L}_{\\text{death}, N_k} \\phi(z_1)\\right]\n458: = -\\int_{\\Omega} c(z) \\rho_0(z) \\phi(z) \\, dz\n459: \n460: $$\n461: \n462: **Step 2: Discrete Revival Converges to the Revival Operator**\n463: \n464: In the discrete algorithm, dead walkers (status = 0) are revived at a constant rate $\\lambda_{\\text{rev}} = 1/\\tau$ by cloning from a uniformly selected alive walker and applying jitter. Let $m_{d,N_k}$ denote the fraction of dead walkers in the N-particle system at stationarity.\n465: \n466: The revival mechanism has two key components:\n467: 1. **Selection of revival target**: A companion is selected uniformly from the alive population (those with status = 1)\n468: 2. **Jitter**: The new position is the companion's position plus Gaussian noise\n469: \n470: As $N_k \\to \\infty$:\n471: - The fraction of dead walkers converges: $m_{d,N_k} \\to m_{d,\\infty}$ (by the law of large numbers for the coupled system)\n472: - The empirical distribution of alive walkers, normalized, converges: $\\frac{\\mu_{N_k}^{\\text{alive}}}{m_{a,N_k}} \\rightharpoonup \\rho_0$ (by Lemma [](#lem-empirical-convergence))\n473: - The jitter kernel $Q_\\delta(z \\mid z')$ remains fixed (Gaussian with variance $\\delta^2$)\n474: \n475: The revival operator in the mean-field model is defined as:\n476: \n477: $$\n478: B[\\rho_0, m_{d,\\infty}](z) = \\lambda_{\\text{rev}} \\cdot m_{d,\\infty} \\cdot g[\\rho_0](z)\n479: \n480: $$\n481: \n482: where $g[\\rho_0](z) = \\int_{\\Omega} Q_\\delta(z \\mid z') \\rho_0(z') \\, dz'$ is the spatial profile of revived mass.\n483: \n484: The contribution of the revival mechanism to the generator is:\n485: \n486: $$\n487: \\mathcal{L}_{\\text{revival}, N_k} \\phi(z_1) = \\lambda_{\\text{rev}} m_{d,N_k} \\int_{\\Omega} Q_\\delta(z' \\mid z_c) \\phi(z') \\, dz' \\, d\\mu_{N_k}^{\\text{comp}}(z_c)\n488: \n489: $$\n490: \n491: By the convergence of $m_{d,N_k} \\to m_{d,\\infty}$ and $\\mu_{N_k}^{\\text{comp}} \\rightharpoonup \\rho_0$, and the continuity of the integral operator with respect to weak convergence:\n492: \n493: $$\n494: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{revival}, N_k} \\phi(z_1)]\n495: = \\int_{\\Omega} B[\\rho_0, m_{d,\\infty}](z) \\phi(z) \\, dz\n496: \n497: $$\n498: \n499: **Step 3: Combine Both Terms**\n500: \n501: The net contribution from the boundary mechanism (death plus revival) is:\n502: \n503: $$\n504: \\mathcal{L}_{\\text{boundary}, N_k} = \\mathcal{L}_{\\text{death}, N_k} + \\mathcal{L}_{\\text{revival}, N_k}\n505: \n506: $$\n507: \n508: Taking the limit:\n509: \n510: $$\n511: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n512: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n513: \n514: $$\n515: \n516: This is precisely the boundary contribution in the mean-field PDE derived in `06_mean_field.md`.",
      "metadata": {
        "label": "proof-lem-boundary-convergence"
      },
      "section": "## **4. Identification of the Limit Point**",
      "references": [],
      "raw_directive": "425: :::\n426: \n427: :::{prf:proof}\n428: :label: proof-lem-boundary-convergence\n429: This convergence is established in two steps, corresponding to the two physical processes: death at the boundary and revival from the dead reservoir.\n430: \n431: **Step 1: Discrete Death Converges to Interior Killing**\n432: \n433: In the discrete N-particle algorithm, a walker dies (status becomes 0) when its position leaves the valid domain $X_{\\text{valid}}$. This is a hard boundary condition: the walker is killed instantaneously upon crossing $\\partial X_{\\text{valid}}$.\n434: \n435: In the continuous limit, Theorem 4.4.2 of `06_mean_field.md` (Consistency of the Interior Killing Rate Approximation) rigorously proves that as the timestep $\\tau \\to 0$, the discrete exit probability per timestep converges to a smooth interior killing rate:\n436: \n437: $$\n438: \\lim_{\\tau \\to 0} \\frac{1}{\\tau} p_{\\text{exit}}(z, \\tau) = c(z)\n439: \n440: $$\n441: \n442: with uniform convergence over the phase space $\\Omega$. The killing rate $c(z)$ has the following properties:\n443: - $c(z) = 0$ for $z$ in the interior of $\\Omega$ (away from $\\partial X_{\\text{valid}}$)\n444: - $c(z) > 0$ in a smooth boundary layer near $\\partial X_{\\text{valid}}$\n445: - $c \\in C^\\infty(\\Omega)$ (smooth)\n446: \n447: The contribution of the killing mechanism to the generator is:\n448: \n449: $$\n450: \\mathcal{L}_{\\text{death}, N_k} \\phi(z_1) = -\\frac{1}{\\tau} p_{\\text{exit}}(z_1, \\tau) \\phi(z_1)\n451: \n452: $$\n453: \n454: Taking the limit as $k \\to \\infty$ (equivalently, $\\tau \\to 0$), and integrating against the marginal density:\n455: \n456: $$\n457: \\lim_{k \\to \\infty} \\mathbb{E}_{\\mu_{N_k}}\\left[\\mathcal{L}_{\\text{death}, N_k} \\phi(z_1)\\right]\n458: = -\\int_{\\Omega} c(z) \\rho_0(z) \\phi(z) \\, dz\n459: \n460: $$\n461: \n462: **Step 2: Discrete Revival Converges to the Revival Operator**\n463: \n464: In the discrete algorithm, dead walkers (status = 0) are revived at a constant rate $\\lambda_{\\text{rev}} = 1/\\tau$ by cloning from a uniformly selected alive walker and applying jitter. Let $m_{d,N_k}$ denote the fraction of dead walkers in the N-particle system at stationarity.\n465: \n466: The revival mechanism has two key components:\n467: 1. **Selection of revival target**: A companion is selected uniformly from the alive population (those with status = 1)\n468: 2. **Jitter**: The new position is the companion's position plus Gaussian noise\n469: \n470: As $N_k \\to \\infty$:\n471: - The fraction of dead walkers converges: $m_{d,N_k} \\to m_{d,\\infty}$ (by the law of large numbers for the coupled system)\n472: - The empirical distribution of alive walkers, normalized, converges: $\\frac{\\mu_{N_k}^{\\text{alive}}}{m_{a,N_k}} \\rightharpoonup \\rho_0$ (by Lemma [](#lem-empirical-convergence))\n473: - The jitter kernel $Q_\\delta(z \\mid z')$ remains fixed (Gaussian with variance $\\delta^2$)\n474: \n475: The revival operator in the mean-field model is defined as:\n476: \n477: $$\n478: B[\\rho_0, m_{d,\\infty}](z) = \\lambda_{\\text{rev}} \\cdot m_{d,\\infty} \\cdot g[\\rho_0](z)\n479: \n480: $$\n481: \n482: where $g[\\rho_0](z) = \\int_{\\Omega} Q_\\delta(z \\mid z') \\rho_0(z') \\, dz'$ is the spatial profile of revived mass.\n483: \n484: The contribution of the revival mechanism to the generator is:\n485: \n486: $$\n487: \\mathcal{L}_{\\text{revival}, N_k} \\phi(z_1) = \\lambda_{\\text{rev}} m_{d,N_k} \\int_{\\Omega} Q_\\delta(z' \\mid z_c) \\phi(z') \\, dz' \\, d\\mu_{N_k}^{\\text{comp}}(z_c)\n488: \n489: $$\n490: \n491: By the convergence of $m_{d,N_k} \\to m_{d,\\infty}$ and $\\mu_{N_k}^{\\text{comp}} \\rightharpoonup \\rho_0$, and the continuity of the integral operator with respect to weak convergence:\n492: \n493: $$\n494: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{revival}, N_k} \\phi(z_1)]\n495: = \\int_{\\Omega} B[\\rho_0, m_{d,\\infty}](z) \\phi(z) \\, dz\n496: \n497: $$\n498: \n499: **Step 3: Combine Both Terms**\n500: \n501: The net contribution from the boundary mechanism (death plus revival) is:\n502: \n503: $$\n504: \\mathcal{L}_{\\text{boundary}, N_k} = \\mathcal{L}_{\\text{death}, N_k} + \\mathcal{L}_{\\text{revival}, N_k}\n505: \n506: $$\n507: \n508: Taking the limit:\n509: \n510: $$\n511: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n512: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n513: \n514: $$\n515: \n516: This is precisely the boundary contribution in the mean-field PDE derived in `06_mean_field.md`.\n517: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-extinction-rate-vanishes",
      "title": null,
      "start_line": 557,
      "end_line": 672,
      "header_lines": [
        558
      ],
      "content_start": 559,
      "content_end": 671,
      "content": "559: :::{prf:proof}\n560: :label: proof-thm-extinction-rate-vanishes\n561: The proof uses the N-uniform Foster-Lyapunov condition established in `06_convergence.md` to bound the extinction rate.\n562: \n563: **Step 1: Relation Between Extinction Rate and Expected Hitting Time**\n564: \n565: A classical result in the theory of quasi-stationary distributions (Champagnat & Villemonais, *Ann. Probab.* 2012, Theorem 2.1) states that for a process killed at the boundary, the extinction rate satisfies:\n566: \n567: $$\n568: \\lambda_N = \\frac{1}{\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}]}\n569: \n570: $$\n571: \n572: where $\\tau_{\\text{ext}}$ is the **expected time to extinction** (hitting time of the absorbing state) when starting from the QSD. Thus, proving $\\lambda_N \\to 0$ is equivalent to proving that $\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\to \\infty$.\n573: \n574: **Step 2: N-Uniform Foster-Lyapunov Condition**\n575: \n576: The Foster-Lyapunov drift condition from `06_convergence.md` establishes that there exists a Lyapunov function $V: \\Sigma_N \\to \\mathbb{R}_{\\geq 0}$ and N-uniform constants $\\kappa > 0$ and $C < \\infty$ such that:\n577: \n578: $$\n579: \\mathcal{L}_N V(S) \\leq -\\kappa V(S) + C\n580: \n581: $$\n582: \n583: for all states $S \\in \\Sigma_N$ (the alive states). This drift condition holds **uniformly in N**.\n584: \n585: **Crucially**, the Lyapunov function has a specific structure tied to the mean-field limit: $V(S_N)$ is a function of the empirical measure that controls the distance from the target limiting distribution. As the number of particles grows, the typical value of $V$ under the QSD scales in a way that reflects the concentration of the empirical measure.\n586: \n587: **Step 3: Refined Argument Using Concentration of Walkers**\n588: \n589: The key insight is that as $N$ increases, the **number of alive walkers** becomes increasingly concentrated around its mean due to the law of large numbers. Let $k_N(t)$ denote the number of alive walkers at time $t$.\n590: \n591: From the coupled dynamics in `06_mean_field.md`, the alive mass fraction $m_{a,N} = k_N/N$ satisfies a balance equation at stationarity:\n592: \n593: $$\n594: \\lambda_{\\text{rev}} m_{d,N} = k_{\\text{killed}}[f_N]\n595: \n596: $$\n597: \n598: By the law of large numbers for exchangeable systems, as $N \\to \\infty$:\n599: - The empirical killing rate $k_{\\text{killed}}[f_N] \\to k_{\\text{killed}}[\\rho_0]$ (a constant)\n600: - The fraction $m_{d,N} \\to m_{d,\\infty}$ (a constant in $(0,1)$)\n601: - Therefore, $m_{a,N} \\to m_{a,\\infty} = 1 - m_{d,\\infty} \\in (0,1)$\n602: \n603: For large $N$, the number of alive walkers is approximately $k_N \\approx m_{a,\\infty} \\cdot N$. Extinction occurs when $k_N = 0$, which requires all $\\sim m_{a,\\infty} N$ walkers to die simultaneously.\n604: \n605: **Step 4: Large Deviation Estimate and Formal Connection to QSD Theory**\n606: \n607: The probability of extinction within any fixed time window $[0, T]$ can be bounded using large deviation theory. For the swarm to go extinct, we need an extreme fluctuation where the number of deaths exceeds the number of revivals by $\\sim m_{a,\\infty} N$.\n608: \n609: By Cramér's theorem for sums of independent random variables (or its extension to weakly dependent systems via the Azuma-Hoeffding inequality), the probability of such a large deviation decays exponentially in $N$:\n610: \n611: $$\n612: \\mathbb{P}_{\\nu_N^{QSD}}(\\tau_{\\text{ext}} \\leq T) \\leq e^{-c N}\n613: \n614: $$\n615: \n616: for some constant $c > 0$ independent of $N$. Therefore:\n617: \n618: $$\n619: \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\geq T \\cdot (1 - e^{-cN})\n620: \n621: $$\n622: \n623: As $N \\to \\infty$, the right-hand side grows without bound. Since $T$ is arbitrary, we have:\n624: \n625: $$\n626: \\lim_{N \\to \\infty} \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] = \\infty\n627: \n628: $$\n629: \n630: **Formal justification via QSD theory**: The above heuristic argument can be made rigorous using the theory of quasi-stationary distributions for processes with state-dependent killing. More formally, the N-uniform Foster-Lyapunov condition from `06_convergence.md` implies a **uniform geometric ergodicity** for the process conditioned on non-extinction. By Theorem 2.1 in Champagnat & Villemonais, *\"General criteria for the study of quasi-stationarity\"*, Annals of Probability 40(4), 2012, pp. 1427-1497, such a uniform Lyapunov drift condition combined with the concentration of the empirical measure (law of large numbers) implies that the expected hitting time of the absorbing state grows **exponentially in N**:\n631: \n632: $$\n633: \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\geq C e^{\\beta N}\n634: \n635: $$\n636: \n637: for some constants $C, \\beta > 0$. This is the rigorous version of the large deviation bound above, directly connecting our N-uniform Lyapunov condition to the vanishing extinction rate.\n638: \n639: **Remark**: The key insight is that the N-uniform drift condition is not merely sufficient to control the process for each fixed $N$, but provides the uniform control necessary to prove that the extinction probability becomes negligible as $N \\to \\infty$. This bridges the gap between the Foster-Lyapunov stability analysis (which controls trajectories before extinction) and the QSD asymptotics (which control the extinction event itself).\n640: \n641: **Step 5: Conclusion**\n642: \n643: From Step 1, the extinction rate is:\n644: \n645: $$\n646: \\lambda_N = \\frac{1}{\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}]} \\to 0 \\quad \\text{as } N \\to \\infty\n647: \n648: $$\n649: \n650: **Implication for the Limit**: When we take the limit of the N-particle stationarity condition:\n651: \n652: $$\n653: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = -\\lambda_{N_k} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\phi(z_1)]\n654: \n655: $$\n656: \n657: Since $\\lambda_{N_k} \\to 0$ and $\\phi$ is bounded, the right-hand side vanishes:\n658: \n659: $$\n660: \\lim_{k \\to \\infty} \\left(-\\lambda_{N_k} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\phi(z_1)]\\right) = 0\n661: \n662: $$\n663: \n664: Therefore, the limiting equation is the **standard stationary PDE** with no extinction term:\n665: \n666: $$\n667: \\int_\\Omega \\left(L^\\dagger \\rho_0 - c(z)\\rho_0 + S[\\rho_0] + B[\\rho_0, m_{d,\\infty}]\\right) \\phi \\, dz = 0\n668: \n669: $$\n670: \n671: This rigorously justifies the identification step.",
      "metadata": {
        "label": "proof-thm-extinction-rate-vanishes"
      },
      "section": "## **4. Identification of the Limit Point**",
      "references": [],
      "raw_directive": "557: :::\n558: \n559: :::{prf:proof}\n560: :label: proof-thm-extinction-rate-vanishes\n561: The proof uses the N-uniform Foster-Lyapunov condition established in `06_convergence.md` to bound the extinction rate.\n562: \n563: **Step 1: Relation Between Extinction Rate and Expected Hitting Time**\n564: \n565: A classical result in the theory of quasi-stationary distributions (Champagnat & Villemonais, *Ann. Probab.* 2012, Theorem 2.1) states that for a process killed at the boundary, the extinction rate satisfies:\n566: \n567: $$\n568: \\lambda_N = \\frac{1}{\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}]}\n569: \n570: $$\n571: \n572: where $\\tau_{\\text{ext}}$ is the **expected time to extinction** (hitting time of the absorbing state) when starting from the QSD. Thus, proving $\\lambda_N \\to 0$ is equivalent to proving that $\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\to \\infty$.\n573: \n574: **Step 2: N-Uniform Foster-Lyapunov Condition**\n575: \n576: The Foster-Lyapunov drift condition from `06_convergence.md` establishes that there exists a Lyapunov function $V: \\Sigma_N \\to \\mathbb{R}_{\\geq 0}$ and N-uniform constants $\\kappa > 0$ and $C < \\infty$ such that:\n577: \n578: $$\n579: \\mathcal{L}_N V(S) \\leq -\\kappa V(S) + C\n580: \n581: $$\n582: \n583: for all states $S \\in \\Sigma_N$ (the alive states). This drift condition holds **uniformly in N**.\n584: \n585: **Crucially**, the Lyapunov function has a specific structure tied to the mean-field limit: $V(S_N)$ is a function of the empirical measure that controls the distance from the target limiting distribution. As the number of particles grows, the typical value of $V$ under the QSD scales in a way that reflects the concentration of the empirical measure.\n586: \n587: **Step 3: Refined Argument Using Concentration of Walkers**\n588: \n589: The key insight is that as $N$ increases, the **number of alive walkers** becomes increasingly concentrated around its mean due to the law of large numbers. Let $k_N(t)$ denote the number of alive walkers at time $t$.\n590: \n591: From the coupled dynamics in `06_mean_field.md`, the alive mass fraction $m_{a,N} = k_N/N$ satisfies a balance equation at stationarity:\n592: \n593: $$\n594: \\lambda_{\\text{rev}} m_{d,N} = k_{\\text{killed}}[f_N]\n595: \n596: $$\n597: \n598: By the law of large numbers for exchangeable systems, as $N \\to \\infty$:\n599: - The empirical killing rate $k_{\\text{killed}}[f_N] \\to k_{\\text{killed}}[\\rho_0]$ (a constant)\n600: - The fraction $m_{d,N} \\to m_{d,\\infty}$ (a constant in $(0,1)$)\n601: - Therefore, $m_{a,N} \\to m_{a,\\infty} = 1 - m_{d,\\infty} \\in (0,1)$\n602: \n603: For large $N$, the number of alive walkers is approximately $k_N \\approx m_{a,\\infty} \\cdot N$. Extinction occurs when $k_N = 0$, which requires all $\\sim m_{a,\\infty} N$ walkers to die simultaneously.\n604: \n605: **Step 4: Large Deviation Estimate and Formal Connection to QSD Theory**\n606: \n607: The probability of extinction within any fixed time window $[0, T]$ can be bounded using large deviation theory. For the swarm to go extinct, we need an extreme fluctuation where the number of deaths exceeds the number of revivals by $\\sim m_{a,\\infty} N$.\n608: \n609: By Cramér's theorem for sums of independent random variables (or its extension to weakly dependent systems via the Azuma-Hoeffding inequality), the probability of such a large deviation decays exponentially in $N$:\n610: \n611: $$\n612: \\mathbb{P}_{\\nu_N^{QSD}}(\\tau_{\\text{ext}} \\leq T) \\leq e^{-c N}\n613: \n614: $$\n615: \n616: for some constant $c > 0$ independent of $N$. Therefore:\n617: \n618: $$\n619: \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\geq T \\cdot (1 - e^{-cN})\n620: \n621: $$\n622: \n623: As $N \\to \\infty$, the right-hand side grows without bound. Since $T$ is arbitrary, we have:\n624: \n625: $$\n626: \\lim_{N \\to \\infty} \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] = \\infty\n627: \n628: $$\n629: \n630: **Formal justification via QSD theory**: The above heuristic argument can be made rigorous using the theory of quasi-stationary distributions for processes with state-dependent killing. More formally, the N-uniform Foster-Lyapunov condition from `06_convergence.md` implies a **uniform geometric ergodicity** for the process conditioned on non-extinction. By Theorem 2.1 in Champagnat & Villemonais, *\"General criteria for the study of quasi-stationarity\"*, Annals of Probability 40(4), 2012, pp. 1427-1497, such a uniform Lyapunov drift condition combined with the concentration of the empirical measure (law of large numbers) implies that the expected hitting time of the absorbing state grows **exponentially in N**:\n631: \n632: $$\n633: \\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}] \\geq C e^{\\beta N}\n634: \n635: $$\n636: \n637: for some constants $C, \\beta > 0$. This is the rigorous version of the large deviation bound above, directly connecting our N-uniform Lyapunov condition to the vanishing extinction rate.\n638: \n639: **Remark**: The key insight is that the N-uniform drift condition is not merely sufficient to control the process for each fixed $N$, but provides the uniform control necessary to prove that the extinction probability becomes negligible as $N \\to \\infty$. This bridges the gap between the Foster-Lyapunov stability analysis (which controls trajectories before extinction) and the QSD asymptotics (which control the extinction event itself).\n640: \n641: **Step 5: Conclusion**\n642: \n643: From Step 1, the extinction rate is:\n644: \n645: $$\n646: \\lambda_N = \\frac{1}{\\mathbb{E}_{\\nu_N^{QSD}}[\\tau_{\\text{ext}}]} \\to 0 \\quad \\text{as } N \\to \\infty\n647: \n648: $$\n649: \n650: **Implication for the Limit**: When we take the limit of the N-particle stationarity condition:\n651: \n652: $$\n653: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = -\\lambda_{N_k} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\phi(z_1)]\n654: \n655: $$\n656: \n657: Since $\\lambda_{N_k} \\to 0$ and $\\phi$ is bounded, the right-hand side vanishes:\n658: \n659: $$\n660: \\lim_{k \\to \\infty} \\left(-\\lambda_{N_k} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\phi(z_1)]\\right) = 0\n661: \n662: $$\n663: \n664: Therefore, the limiting equation is the **standard stationary PDE** with no extinction term:\n665: \n666: $$\n667: \\int_\\Omega \\left(L^\\dagger \\rho_0 - c(z)\\rho_0 + S[\\rho_0] + B[\\rho_0, m_{d,\\infty}]\\right) \\phi \\, dz = 0\n668: \n669: $$\n670: \n671: This rigorously justifies the identification step.\n672: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-limit-is-weak-solution",
      "title": null,
      "start_line": 703,
      "end_line": 834,
      "header_lines": [
        704
      ],
      "content_start": 705,
      "content_end": 833,
      "content": "705: :::{prf:proof}\n706: :label: proof-thm-limit-is-weak-solution\n707: **Proof.**\n708: \n709: A measure $\\mu_\\infty$ with density $\\rho_0$ is a weak solution to the stationary mean-field equation if, for any smooth, compactly supported test function $\\phi \\in C_c^\\infty(\\Omega)$, it satisfies:\n710: \n711: $$\n712: \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n713: \n714: $$\n715: \n716: We establish this by starting with the N-particle stationarity condition and taking the limit as $k \\to \\infty$.\n717: \n718: **Step 1: The N-Particle Stationarity Condition**\n719: \n720: For each $N_k$, the QSD $\\nu_{N_k}^{QSD}$ is stationary with respect to the N-particle generator $\\mathcal{L}_{N_k}$. Choosing a test function $\\Phi(S) = \\phi(z_1)$ that depends only on the first particle, the stationarity condition is:\n721: \n722: $$\n723: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = 0 \\quad \\text{for all } k\n724: \n725: $$\n726: \n727: Decomposing the generator as $\\mathcal{L}_{N_k} = \\mathcal{L}_{\\text{kin}, N_k} + \\mathcal{L}_{\\text{clone}, N_k}$, we have:\n728: \n729: $$\n730: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{kin}, N_k} \\phi(z_1)] + \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = 0 \\quad (*)\n731: \n732: $$\n733: \n734: **Step 2: Limit of the Kinetic Term**\n735: \n736: The kinetic generator acts only on walker 1, independently of all other walkers. Therefore:\n737: \n738: $$\n739: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{kin}, N_k} \\phi(z_1)] = \\int_{\\Omega} (L\\phi)(z) \\, d\\mu_{N_k}(z)\n740: \n741: $$\n742: \n743: By weak convergence $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$ and the fact that $L\\phi$ is continuous and bounded (since $\\phi$ is smooth and compactly supported), we have:\n744: \n745: $$\n746: \\lim_{k \\to \\infty} \\int_{\\Omega} (L\\phi)(z) \\, d\\mu_{N_k}(z) = \\int_{\\Omega} (L\\phi)(z) \\, \\rho_0(z) \\, dz = \\int_{\\Omega} (L^\\dagger\\rho_0)(z) \\phi(z) \\, dz\n747: \n748: $$\n749: \n750: where the last equality uses the definition of the adjoint operator.\n751: \n752: **Step 3: Limit of the Internal Cloning Term**\n753: \n754: This is the heart of the propagation of chaos argument. The **internal cloning** generator for walker 1 (distinct from the boundary death/revival mechanism) has the structure:\n755: \n756: $$\n757: \\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1) = \\int_{\\Omega} K_{N_k}(z_1, z'; S_{N_k}) (\\phi(z') - \\phi(z_1)) \\, dz'\n758: \n759: $$\n760: \n761: where $K_{N_k}(z_1, z'; S_{N_k})$ is the transition kernel that depends on the empirical statistics of the companion set $\\{z_2, \\ldots, z_{N_k}\\}$. Specifically, the fitness potential $V_N(z_1)$ that governs cloning rates is computed using empirical moments:\n762: \n763: $$\n764: V_N(z_1) = V(z_1; \\mu_R[\\mu_{N_k-1}^{\\text{comp}}], \\sigma_R^2[\\mu_{N_k-1}^{\\text{comp}}], \\mu_D[\\mu_{N_k-1}^{\\text{comp}}], \\sigma_D^2[\\mu_{N_k-1}^{\\text{comp}}])\n765: \n766: $$\n767: \n768: By Lemma [](#lem-empirical-convergence), $\\mu_{N_k-1}^{\\text{comp}} \\rightharpoonup \\mu_\\infty$. By Lemmas [](#lem-reward-continuity) and [](#lem-distance-continuity), the moment functionals converge:\n769: \n770: $$\n771: \\mu_R[\\mu_{N_k-1}^{\\text{comp}}] \\to \\mu_R[\\mu_\\infty], \\quad \\sigma_R^2[\\mu_{N_k-1}^{\\text{comp}}] \\to \\sigma_R^2[\\mu_\\infty]\n772: \n773: $$\n774: \n775: and similarly for the distance moments. Since the fitness potential $V$ is a continuous function of its arguments (by the axioms), we have:\n776: \n777: $$\n778: V_N(z_1) \\to V[\\rho_0](z_1)\n779: \n780: $$\n781: \n782: point-wise for $\\mu_\\infty$-almost every $z_1$, where $V[\\rho_0]$ is the mean-field fitness potential computed using the moments of $\\rho_0$.\n783: \n784: By Lemma [](#lem-uniform-integrability), we can interchange the limit and the expectation. The cloning rates, which involve sums of the form\n785: \n786: $$\n787: \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\pi(V_N(z_1), V_N(z_j))\n788: \n789: $$\n790: \n791: converge (by Lemma [](#lem-empirical-convergence)) to the integral\n792: \n793: $$\n794: \\int_\\Omega \\pi(V[\\rho_0](z_1), V[\\rho_0](z_c)) \\rho_0(z_c) \\, dz_c\n795: \n796: $$\n797: \n798: Therefore, the **internal cloning** term (mass-neutral redistribution within the alive population) converges:\n799: \n800: $$\n801: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = \\int_{\\Omega} S[\\rho_0](z) \\phi(z) \\, dz\n802: \n803: $$\n804: \n805: where $S[\\rho_0]$ is the mean-field internal cloning operator defined in `06_mean_field.md`.\n806: \n807: **Step 4: Limit of the Boundary Death and Revival Mechanism**\n808: \n809: By Lemma [](#lem-boundary-convergence), the discrete boundary death and revival mechanism converges to the continuous interior-killing-and-revival operators:\n810: \n811: $$\n812: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n813: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n814: \n815: $$\n816: \n817: **Step 5: Conclusion**\n818: \n819: Combining all three terms (kinetic, internal cloning, and boundary), and taking the limit $k \\to \\infty$ of the stationarity condition $(*)$, we obtain:\n820: \n821: $$\n822: \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n823: \n824: $$\n825: \n826: Additionally, at the stationary state, the total mass killed must equal the total mass revived. Integrating the killing rate over $\\Omega$ and equating to the revival rate:\n827: \n828: $$\n829: \\int_\\Omega c(z)\\rho_0(z) \\, dz = k_{\\text{killed}}[\\rho_0] = \\lambda_{\\text{rev}} m_{d,\\infty}\n830: \n831: $$\n832: \n833: Since this holds for any smooth, compactly supported test function $\\phi \\in C_c^\\infty(\\Omega)$, the density $\\rho_0$ is, by definition, a weak solution to the stationary mean-field coupled system.",
      "metadata": {
        "label": "proof-thm-limit-is-weak-solution"
      },
      "section": "## **4. Identification of the Limit Point**",
      "references": [],
      "raw_directive": "703: :::\n704: \n705: :::{prf:proof}\n706: :label: proof-thm-limit-is-weak-solution\n707: **Proof.**\n708: \n709: A measure $\\mu_\\infty$ with density $\\rho_0$ is a weak solution to the stationary mean-field equation if, for any smooth, compactly supported test function $\\phi \\in C_c^\\infty(\\Omega)$, it satisfies:\n710: \n711: $$\n712: \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n713: \n714: $$\n715: \n716: We establish this by starting with the N-particle stationarity condition and taking the limit as $k \\to \\infty$.\n717: \n718: **Step 1: The N-Particle Stationarity Condition**\n719: \n720: For each $N_k$, the QSD $\\nu_{N_k}^{QSD}$ is stationary with respect to the N-particle generator $\\mathcal{L}_{N_k}$. Choosing a test function $\\Phi(S) = \\phi(z_1)$ that depends only on the first particle, the stationarity condition is:\n721: \n722: $$\n723: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = 0 \\quad \\text{for all } k\n724: \n725: $$\n726: \n727: Decomposing the generator as $\\mathcal{L}_{N_k} = \\mathcal{L}_{\\text{kin}, N_k} + \\mathcal{L}_{\\text{clone}, N_k}$, we have:\n728: \n729: $$\n730: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{kin}, N_k} \\phi(z_1)] + \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = 0 \\quad (*)\n731: \n732: $$\n733: \n734: **Step 2: Limit of the Kinetic Term**\n735: \n736: The kinetic generator acts only on walker 1, independently of all other walkers. Therefore:\n737: \n738: $$\n739: \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{kin}, N_k} \\phi(z_1)] = \\int_{\\Omega} (L\\phi)(z) \\, d\\mu_{N_k}(z)\n740: \n741: $$\n742: \n743: By weak convergence $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$ and the fact that $L\\phi$ is continuous and bounded (since $\\phi$ is smooth and compactly supported), we have:\n744: \n745: $$\n746: \\lim_{k \\to \\infty} \\int_{\\Omega} (L\\phi)(z) \\, d\\mu_{N_k}(z) = \\int_{\\Omega} (L\\phi)(z) \\, \\rho_0(z) \\, dz = \\int_{\\Omega} (L^\\dagger\\rho_0)(z) \\phi(z) \\, dz\n747: \n748: $$\n749: \n750: where the last equality uses the definition of the adjoint operator.\n751: \n752: **Step 3: Limit of the Internal Cloning Term**\n753: \n754: This is the heart of the propagation of chaos argument. The **internal cloning** generator for walker 1 (distinct from the boundary death/revival mechanism) has the structure:\n755: \n756: $$\n757: \\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1) = \\int_{\\Omega} K_{N_k}(z_1, z'; S_{N_k}) (\\phi(z') - \\phi(z_1)) \\, dz'\n758: \n759: $$\n760: \n761: where $K_{N_k}(z_1, z'; S_{N_k})$ is the transition kernel that depends on the empirical statistics of the companion set $\\{z_2, \\ldots, z_{N_k}\\}$. Specifically, the fitness potential $V_N(z_1)$ that governs cloning rates is computed using empirical moments:\n762: \n763: $$\n764: V_N(z_1) = V(z_1; \\mu_R[\\mu_{N_k-1}^{\\text{comp}}], \\sigma_R^2[\\mu_{N_k-1}^{\\text{comp}}], \\mu_D[\\mu_{N_k-1}^{\\text{comp}}], \\sigma_D^2[\\mu_{N_k-1}^{\\text{comp}}])\n765: \n766: $$\n767: \n768: By Lemma [](#lem-empirical-convergence), $\\mu_{N_k-1}^{\\text{comp}} \\rightharpoonup \\mu_\\infty$. By Lemmas [](#lem-reward-continuity) and [](#lem-distance-continuity), the moment functionals converge:\n769: \n770: $$\n771: \\mu_R[\\mu_{N_k-1}^{\\text{comp}}] \\to \\mu_R[\\mu_\\infty], \\quad \\sigma_R^2[\\mu_{N_k-1}^{\\text{comp}}] \\to \\sigma_R^2[\\mu_\\infty]\n772: \n773: $$\n774: \n775: and similarly for the distance moments. Since the fitness potential $V$ is a continuous function of its arguments (by the axioms), we have:\n776: \n777: $$\n778: V_N(z_1) \\to V[\\rho_0](z_1)\n779: \n780: $$\n781: \n782: point-wise for $\\mu_\\infty$-almost every $z_1$, where $V[\\rho_0]$ is the mean-field fitness potential computed using the moments of $\\rho_0$.\n783: \n784: By Lemma [](#lem-uniform-integrability), we can interchange the limit and the expectation. The cloning rates, which involve sums of the form\n785: \n786: $$\n787: \\frac{1}{N_k-1} \\sum_{j=2}^{N_k} \\pi(V_N(z_1), V_N(z_j))\n788: \n789: $$\n790: \n791: converge (by Lemma [](#lem-empirical-convergence)) to the integral\n792: \n793: $$\n794: \\int_\\Omega \\pi(V[\\rho_0](z_1), V[\\rho_0](z_c)) \\rho_0(z_c) \\, dz_c\n795: \n796: $$\n797: \n798: Therefore, the **internal cloning** term (mass-neutral redistribution within the alive population) converges:\n799: \n800: $$\n801: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = \\int_{\\Omega} S[\\rho_0](z) \\phi(z) \\, dz\n802: \n803: $$\n804: \n805: where $S[\\rho_0]$ is the mean-field internal cloning operator defined in `06_mean_field.md`.\n806: \n807: **Step 4: Limit of the Boundary Death and Revival Mechanism**\n808: \n809: By Lemma [](#lem-boundary-convergence), the discrete boundary death and revival mechanism converges to the continuous interior-killing-and-revival operators:\n810: \n811: $$\n812: \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)]\n813: = \\int_{\\Omega} \\left(-c(z)\\rho_0(z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz\n814: \n815: $$\n816: \n817: **Step 5: Conclusion**\n818: \n819: Combining all three terms (kinetic, internal cloning, and boundary), and taking the limit $k \\to \\infty$ of the stationarity condition $(*)$, we obtain:\n820: \n821: $$\n822: \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n823: \n824: $$\n825: \n826: Additionally, at the stationary state, the total mass killed must equal the total mass revived. Integrating the killing rate over $\\Omega$ and equating to the revival rate:\n827: \n828: $$\n829: \\int_\\Omega c(z)\\rho_0(z) \\, dz = k_{\\text{killed}}[\\rho_0] = \\lambda_{\\text{rev}} m_{d,\\infty}\n830: \n831: $$\n832: \n833: Since this holds for any smooth, compactly supported test function $\\phi \\in C_c^\\infty(\\Omega)$, the density $\\rho_0$ is, by definition, a weak solution to the stationary mean-field coupled system.\n834: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## **4. Identification of the Limit Point**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-uniqueness-completeness-h1w-omega",
      "title": null,
      "start_line": 878,
      "end_line": 888,
      "header_lines": [
        879
      ],
      "content_start": 880,
      "content_end": 887,
      "content": "880: :::{prf:proof}\n881: :label: proof-thm-uniqueness-completeness-h1w-omega\n882: This is a standard result from the theory of weighted Sobolev spaces. Completeness follows from:\n883: 1. The completeness of $L^2$ spaces\n884: 2. The fact that weak derivatives of Cauchy sequences converge to weak derivatives of the limit\n885: 3. The weight function $w(z)$ is locally integrable and grows polynomially at infinity\n886: \n887: See Adams & Fournier, *Sobolev Spaces*, Chapter 2.",
      "metadata": {
        "label": "proof-thm-uniqueness-completeness-h1w-omega"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "878: :::\n879: \n880: :::{prf:proof}\n881: :label: proof-thm-uniqueness-completeness-h1w-omega\n882: This is a standard result from the theory of weighted Sobolev spaces. Completeness follows from:\n883: 1. The completeness of $L^2$ spaces\n884: 2. The fact that weak derivatives of Cauchy sequences converge to weak derivatives of the limit\n885: 3. The weight function $w(z)$ is locally integrable and grows polynomially at infinity\n886: \n887: See Adams & Fournier, *Sobolev Spaces*, Chapter 2.\n888: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-uniqueness-self-mapping",
      "title": null,
      "start_line": 941,
      "end_line": 1060,
      "header_lines": [
        942
      ],
      "content_start": 943,
      "content_end": 1059,
      "content": "943: :::{prf:proof}\n944: :label: proof-lem-uniqueness-self-mapping\n945: We must prove two properties: non-negativity and mass conservation.\n946: \n947: **Part (a): Non-negativity**\n948: \n949: We need to show that if $\\rho \\geq 0$, then $\\mathcal{T}[\\rho] \\geq 0$. This follows from the **maximum principle** for the hypoelliptic operator $-\\mathcal{L}_{\\text{lin}}$.\n950: \n951: The equation $-\\mathcal{L}_{\\text{lin}} u = f$ with $\\mathcal{L}_{\\text{lin}} = L^\\dagger - C \\cdot I$ can be written as:\n952: \n953: $$\n954: (-L^\\dagger + C \\cdot I) u = f\n955: \n956: $$\n957: \n958: For $C$ sufficiently large, the operator $-L^\\dagger + C \\cdot I$ satisfies a **comparison principle**: if $f \\geq 0$, then $u \\geq 0$. This is a consequence of the hypoelliptic structure and reflecting boundary conditions.\n959: \n960: **Rigorous justification**: The kinetic Fokker-Planck operator $L^\\dagger$ with reflecting boundaries generates a Feller semigroup that is positivity-preserving (see Villani, *Hypocoercivity*, Theorem 24 for the general framework). By the **Hille-Yosida theorem** (Pazy, *Semigroups of Linear Operators*, Theorem 3.5), for any $C > 0$ such that $C \\cdot I - L^\\dagger$ is invertible, the resolvent $(C \\cdot I - L^\\dagger)^{-1}$ is also positivity-preserving: if $f \\geq 0$, then $(C \\cdot I - L^\\dagger)^{-1} f \\geq 0$.\n961: \n962: **Detailed analysis of the source term**: The source term $f = S[\\rho] + B[\\rho, m_d[\\rho]] - c(\\cdot)\\rho + C\\rho$ requires careful decomposition. Using the structure of $S[\\rho]$ from `06_mean_field.md` (Definition 2.3.3):\n963: \n964: $$\n965: S[\\rho](z) = S_{\\text{src}}[\\rho](z) - S_{\\text{sink}}[\\rho](z)\n966: \n967: $$\n968: \n969: where:\n970: - **Source term**: $S_{\\text{src}}[\\rho](z) = \\frac{1}{\\tau m_a} \\int_{\\Omega} \\int_{\\Omega} f(z_d) f(z_c) P_{\\text{clone}}(V[z_d], V[z_c]) Q_{\\delta}(z \\mid z_c) \\,\\mathrm{d}z_d\\,\\mathrm{d}z_c \\geq 0$ (pure source, quadratic in $f$)\n971: - **Sink term**: $S_{\\text{sink}}[\\rho](z) = \\frac{1}{\\tau} f(z) \\int_{\\Omega} P_{\\text{clone}}(V[z], V[z_c]) \\frac{f(z_c)}{m_a} \\,\\mathrm{d}z_c \\geq 0$ (proportional to $\\rho(z)$)\n972: \n973: The total source term is:\n974: \n975: $$\n976: f(z) = S_{\\text{src}}[\\rho](z) + B[\\rho, m_d](z) + \\rho(z)\\left[C - c(z) - \\frac{1}{\\tau}\\int_{\\Omega} P_{\\text{clone}}(V[z], V[z_c]) \\frac{f(z_c)}{m_a} \\,\\mathrm{d}z_c\\right]\n977: \n978: $$\n979: \n980: **Key observations**:\n981: 1. $S_{\\text{src}}[\\rho](z) \\geq 0$ everywhere (pure source from cloning arrivals)\n982: 2. $B[\\rho, m_d](z) \\geq 0$ everywhere (pure source from revival)\n983: 3. The coefficient of $\\rho(z)$ is: $C - c(z) - \\frac{1}{\\tau}\\int P_{\\text{clone}}(\\cdots) \\,\\mathrm{d}z_c$\n984: \n985: **Bounding the coefficient**: Since:\n986: - $c(z) \\leq \\|c\\|_{L^\\infty(\\Omega)} < \\infty$ (killing rate has compact support)\n987: - $P_{\\text{clone}} \\in [0,1]$, so $\\int P_{\\text{clone}}(\\cdots) \\,\\mathrm{d}z_c \\leq 1$\n988: - $\\frac{1}{\\tau} = \\lambda_{\\text{sel}}$ is the selection rate\n989: \n990: The coefficient satisfies:\n991: \n992: $$\n993: C - c(z) - \\frac{1}{\\tau}\\int P_{\\text{clone}}(\\cdots) \\,\\mathrm{d}z_c \\geq C - \\|c\\|_{L^\\infty} - \\lambda_{\\text{sel}}\n994: \n995: $$\n996: \n997: **Explicit construction of C**: Choose:\n998: \n999: $$\n1000: C := \\|c\\|_{L^\\infty(\\Omega)} + \\lambda_{\\text{sel}} \\cdot \\sup_{z,z' \\in \\Omega} P_{\\text{clone}}(V[\\rho](z), V[\\rho](z')) + 1\n1001: \n1002: $$\n1003: \n1004: With this choice:\n1005: 1. The coefficient of $\\rho(z)$ is $\\geq 1 > 0$ everywhere in $\\Omega$\n1006: 2. All pure source terms ($S_{\\text{src}}, B$) are non-negative\n1007: 3. Therefore, $f(z) \\geq 0$ everywhere\n1008: \n1009: Since $f \\geq 0$ and the resolvent $(C \\cdot I - L^\\dagger)^{-1}$ preserves non-negativity (by Hille-Yosida), we conclude $\\mathcal{T}[\\rho] = (C \\cdot I - L^\\dagger)^{-1} f \\geq 0$.\n1010: \n1011: **Part (b): Mass Conservation**\n1012: \n1013: We need to show that $\\int_{\\Omega} \\mathcal{T}[\\rho] \\, dz = 1$.\n1014: \n1015: Starting from the fixed-point equation:\n1016: \n1017: $$\n1018: \\mathcal{T}[\\rho] = (-\\mathcal{L}_{\\text{lin}})^{-1} (S[\\rho] + B[\\rho, m_d[\\rho]] - c(\\cdot)\\rho + C\\rho)\n1019: \n1020: $$\n1021: \n1022: Applying $-\\mathcal{L}_{\\text{lin}}$ to both sides:\n1023: \n1024: $$\n1025: -\\mathcal{L}_{\\text{lin}} \\mathcal{T}[\\rho] = S[\\rho] + B[\\rho, m_d[\\rho]] - c(\\cdot)\\rho + C\\rho\n1026: \n1027: $$\n1028: \n1029: Integrating both sides over $\\Omega$:\n1030: \n1031: $$\n1032: \\int_{\\Omega} (-L^\\dagger + C \\cdot I) \\mathcal{T}[\\rho] \\, dz\n1033: = \\int_{\\Omega} (S[\\rho] + B[\\rho, m_d[\\rho]] - c(\\cdot)\\rho + C\\rho) \\, dz\n1034: \n1035: $$\n1036: \n1037: Using the mass conservation properties from `06_mean_field.md`:\n1038: - $\\int_{\\Omega} L^\\dagger \\mathcal{T}[\\rho] \\, dz = 0$ (reflecting boundaries, Lemma 3.1 of `06_mean_field.md`)\n1039: - $\\int_{\\Omega} S[\\rho] \\, dz = 0$ (mass-neutral internal cloning, Definition 2.3.3 of `06_mean_field.md`)\n1040: - $\\int_{\\Omega} B[\\rho, m_d] \\, dz = \\lambda_{\\text{rev}} m_d$ (total revival rate, Definition 2.3.2 of `06_mean_field.md`)\n1041: - $\\int_{\\Omega} c(z)\\rho \\, dz = k_{\\text{killed}}[\\rho]$ (total killing rate, Definition 2.3.1 of `06_mean_field.md`)\n1042: \n1043: This gives:\n1044: \n1045: $$\n1046: C \\int_{\\Omega} \\mathcal{T}[\\rho] \\, dz = \\lambda_{\\text{rev}} m_d[\\rho] - k_{\\text{killed}}[\\rho] + C \\int_{\\Omega} \\rho \\, dz\n1047: \n1048: $$\n1049: \n1050: At the stationary state, the equilibrium condition $k_{\\text{killed}}[\\rho] = \\lambda_{\\text{rev}} m_d[\\rho]$ holds by construction (from our definition of $m_d[\\rho]$ in the fixed-point reformulation). Since $\\int \\rho = 1$:\n1051: \n1052: $$\n1053: C \\int_{\\Omega} \\mathcal{T}[\\rho] \\, dz = 0 + C\n1054: \n1055: $$\n1056: \n1057: Therefore, $\\int_{\\Omega} \\mathcal{T}[\\rho] \\, dz = 1$.\n1058: \n1059: **Conclusion**: The operator $\\mathcal{T}$ maps $\\mathcal{P}$ to itself, preserving both non-negativity and normalization.",
      "metadata": {
        "label": "proof-lem-uniqueness-self-mapping"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "941: :::\n942: \n943: :::{prf:proof}\n944: :label: proof-lem-uniqueness-self-mapping\n945: We must prove two properties: non-negativity and mass conservation.\n946: \n947: **Part (a): Non-negativity**\n948: \n949: We need to show that if $\\rho \\geq 0$, then $\\mathcal{T}[\\rho] \\geq 0$. This follows from the **maximum principle** for the hypoelliptic operator $-\\mathcal{L}_{\\text{lin}}$.\n950: \n951: The equation $-\\mathcal{L}_{\\text{lin}} u = f$ with $\\mathcal{L}_{\\text{lin}} = L^\\dagger - C \\cdot I$ can be written as:\n952: \n953: $$\n954: (-L^\\dagger + C \\cdot I) u = f\n955: \n956: $$\n957: \n958: For $C$ sufficiently large, the operator $-L^\\dagger + C \\cdot I$ satisfies a **comparison principle**: if $f \\geq 0$, then $u \\geq 0$. This is a consequence of the hypoelliptic structure and reflecting boundary conditions.\n959: \n960: **Rigorous justification**: The kinetic Fokker-Planck operator $L^\\dagger$ with reflecting boundaries generates a Feller semigroup that is positivity-preserving (see Villani, *Hypocoercivity*, Theorem 24 for the general framework). By the **Hille-Yosida theorem** (Pazy, *Semigroups of Linear Operators*, Theorem 3.5), for any $C > 0$ such that $C \\cdot I - L^\\dagger$ is invertible, the resolvent $(C \\cdot I - L^\\dagger)^{-1}$ is also positivity-preserving: if $f \\geq 0$, then $(C \\cdot I - L^\\dagger)^{-1} f \\geq 0$.\n961: \n962: **Detailed analysis of the source term**: The source term $f = S[\\rho] + B[\\rho, m_d[\\rho]] - c(\\cdot)\\rho + C\\rho$ requires careful decomposition. Using the structure of $S[\\rho]$ from `06_mean_field.md` (Definition 2.3.3):\n963: \n964: $$\n965: S[\\rho](z) = S_{\\text{src}}[\\rho](z) - S_{\\text{sink}}[\\rho](z)\n966: \n967: $$\n968: \n969: where:\n970: - **Source term**: $S_{\\text{src}}[\\rho](z) = \\frac{1}{\\tau m_a} \\int_{\\Omega} \\int_{\\Omega} f(z_d) f(z_c) P_{\\text{clone}}(V[z_d], V[z_c]) Q_{\\delta}(z \\mid z_c) \\,\\mathrm{d}z_d\\,\\mathrm{d}z_c \\geq 0$ (pure source, quadratic in $f$)\n971: - **Sink term**: $S_{\\text{sink}}[\\rho](z) = \\frac{1}{\\tau} f(z) \\int_{\\Omega} P_{\\text{clone}}(V[z], V[z_c]) \\frac{f(z_c)}{m_a} \\,\\mathrm{d}z_c \\geq 0$ (proportional to $\\rho(z)$)\n972: \n973: The total source term is:\n974: \n975: $$\n976: f(z) = S_{\\text{src}}[\\rho](z) + B[\\rho, m_d](z) + \\rho(z)\\left[C - c(z) - \\frac{1}{\\tau}\\int_{\\Omega} P_{\\text{clone}}(V[z], V[z_c]) \\frac{f(z_c)}{m_a} \\,\\mathrm{d}z_c\\right]\n977: \n978: $$\n979: \n980: **Key observations**:\n981: 1. $S_{\\text{src}}[\\rho](z) \\geq 0$ everywhere (pure source from cloning arrivals)\n982: 2. $B[\\rho, m_d](z) \\geq 0$ everywhere (pure source from revival)\n983: 3. The coefficient of $\\rho(z)$ is: $C - c(z) - \\frac{1}{\\tau}\\int P_{\\text{clone}}(\\cdots) \\,\\mathrm{d}z_c$\n984: \n985: **Bounding the coefficient**: Since:\n986: - $c(z) \\leq \\|c\\|_{L^\\infty(\\Omega)} < \\infty$ (killing rate has compact support)\n987: - $P_{\\text{clone}} \\in [0,1]$, so $\\int P_{\\text{clone}}(\\cdots) \\,\\mathrm{d}z_c \\leq 1$\n988: - $\\frac{1}{\\tau} = \\lambda_{\\text{sel}}$ is the selection rate\n989: \n990: The coefficient satisfies:\n991: \n992: $$\n993: C - c(z) - \\frac{1}{\\tau}\\int P_{\\text{clone}}(\\cdots) \\,\\mathrm{d}z_c \\geq C - \\|c\\|_{L^\\infty} - \\lambda_{\\text{sel}}\n994: \n995: $$\n996: \n997: **Explicit construction of C**: Choose:\n998: \n999: $$\n1000: C := \\|c\\|_{L^\\infty(\\Omega)} + \\lambda_{\\text{sel}} \\cdot \\sup_{z,z' \\in \\Omega} P_{\\text{clone}}(V[\\rho](z), V[\\rho](z')) + 1\n1001: \n1002: $$\n1003: \n1004: With this choice:\n1005: 1. The coefficient of $\\rho(z)$ is $\\geq 1 > 0$ everywhere in $\\Omega$\n1006: 2. All pure source terms ($S_{\\text{src}}, B$) are non-negative\n1007: 3. Therefore, $f(z) \\geq 0$ everywhere\n1008: \n1009: Since $f \\geq 0$ and the resolvent $(C \\cdot I - L^\\dagger)^{-1}$ preserves non-negativity (by Hille-Yosida), we conclude $\\mathcal{T}[\\rho] = (C \\cdot I - L^\\dagger)^{-1} f \\geq 0$.\n1010: \n1011: **Part (b): Mass Conservation**\n1012: \n1013: We need to show that $\\int_{\\Omega} \\mathcal{T}[\\rho] \\, dz = 1$.\n1014: \n1015: Starting from the fixed-point equation:\n1016: \n1017: $$\n1018: \\mathcal{T}[\\rho] = (-\\mathcal{L}_{\\text{lin}})^{-1} (S[\\rho] + B[\\rho, m_d[\\rho]] - c(\\cdot)\\rho + C\\rho)\n1019: \n1020: $$\n1021: \n1022: Applying $-\\mathcal{L}_{\\text{lin}}$ to both sides:\n1023: \n1024: $$\n1025: -\\mathcal{L}_{\\text{lin}} \\mathcal{T}[\\rho] = S[\\rho] + B[\\rho, m_d[\\rho]] - c(\\cdot)\\rho + C\\rho\n1026: \n1027: $$\n1028: \n1029: Integrating both sides over $\\Omega$:\n1030: \n1031: $$\n1032: \\int_{\\Omega} (-L^\\dagger + C \\cdot I) \\mathcal{T}[\\rho] \\, dz\n1033: = \\int_{\\Omega} (S[\\rho] + B[\\rho, m_d[\\rho]] - c(\\cdot)\\rho + C\\rho) \\, dz\n1034: \n1035: $$\n1036: \n1037: Using the mass conservation properties from `06_mean_field.md`:\n1038: - $\\int_{\\Omega} L^\\dagger \\mathcal{T}[\\rho] \\, dz = 0$ (reflecting boundaries, Lemma 3.1 of `06_mean_field.md`)\n1039: - $\\int_{\\Omega} S[\\rho] \\, dz = 0$ (mass-neutral internal cloning, Definition 2.3.3 of `06_mean_field.md`)\n1040: - $\\int_{\\Omega} B[\\rho, m_d] \\, dz = \\lambda_{\\text{rev}} m_d$ (total revival rate, Definition 2.3.2 of `06_mean_field.md`)\n1041: - $\\int_{\\Omega} c(z)\\rho \\, dz = k_{\\text{killed}}[\\rho]$ (total killing rate, Definition 2.3.1 of `06_mean_field.md`)\n1042: \n1043: This gives:\n1044: \n1045: $$\n1046: C \\int_{\\Omega} \\mathcal{T}[\\rho] \\, dz = \\lambda_{\\text{rev}} m_d[\\rho] - k_{\\text{killed}}[\\rho] + C \\int_{\\Omega} \\rho \\, dz\n1047: \n1048: $$\n1049: \n1050: At the stationary state, the equilibrium condition $k_{\\text{killed}}[\\rho] = \\lambda_{\\text{rev}} m_d[\\rho]$ holds by construction (from our definition of $m_d[\\rho]$ in the fixed-point reformulation). Since $\\int \\rho = 1$:\n1051: \n1052: $$\n1053: C \\int_{\\Omega} \\mathcal{T}[\\rho] \\, dz = 0 + C\n1054: \n1055: $$\n1056: \n1057: Therefore, $\\int_{\\Omega} \\mathcal{T}[\\rho] \\, dz = 1$.\n1058: \n1059: **Conclusion**: The operator $\\mathcal{T}$ maps $\\mathcal{P}$ to itself, preserving both non-negativity and normalization.\n1060: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-uniqueness-lipschitz-moments",
      "title": null,
      "start_line": 1075,
      "end_line": 1105,
      "header_lines": [
        1076
      ],
      "content_start": 1077,
      "content_end": 1104,
      "content": "1077: :::{prf:proof}\n1078: :label: proof-lem-uniqueness-lipschitz-moments\n1079: The reward moments are defined by:\n1080: \n1081: $$\n1082: \\mu_R[\\rho] = \\int_\\Omega R(z) \\rho(z) dz, \\quad \\sigma_R^2[\\rho] = \\int_\\Omega R(z)^2 \\rho(z) dz - \\mu_R[\\rho]^2\n1083: \n1084: $$\n1085: \n1086: **Step 1**: By the Axiom of Reward Regularity, $R: \\Omega \\to \\mathbb{R}$ is Lipschitz continuous and bounded. Therefore:\n1087: \n1088: $$\n1089: |\\mu_R[\\rho_1] - \\mu_R[\\rho_2]| = \\left|\\int_\\Omega R(z) (\\rho_1(z) - \\rho_2(z)) dz\\right| \\le \\|R\\|_{L^\\infty} \\|\\rho_1 - \\rho_2\\|_{L^1}\n1090: \n1091: $$\n1092: \n1093: **Step 2**: By Sobolev embedding, $H^1_w(\\Omega) \\hookrightarrow L^1_w(\\Omega) \\hookrightarrow L^1(\\Omega)$ (using the weight decay). Therefore, there exists a constant $C_{\\text{Sob}}$ such that:\n1094: \n1095: $$\n1096: \\|\\rho_1 - \\rho_2\\|_{L^1} \\le C_{\\text{Sob}} \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1097: \n1098: $$\n1099: \n1100: **Step 3**: Combining Steps 1-2 gives Lipschitz continuity of $\\mu_R$ with constant $L_{\\mu} = \\|R\\|_{L^\\infty} C_{\\text{Sob}}$.\n1101: \n1102: **Step 4**: For the variance, use the fact that $\\sigma_R^2[\\rho] = \\int R^2 \\rho - (\\int R \\rho)^2$. Both terms are Lipschitz by the same argument, using $R^2$ is also bounded and continuous.\n1103: \n1104: **Step 5**: The distance moments follow identically, using the fact that the algorithmic distance $d(z, z')$ is continuous and bounded on the compact domain $\\Omega$.",
      "metadata": {
        "label": "proof-lem-uniqueness-lipschitz-moments"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "1075: :::\n1076: \n1077: :::{prf:proof}\n1078: :label: proof-lem-uniqueness-lipschitz-moments\n1079: The reward moments are defined by:\n1080: \n1081: $$\n1082: \\mu_R[\\rho] = \\int_\\Omega R(z) \\rho(z) dz, \\quad \\sigma_R^2[\\rho] = \\int_\\Omega R(z)^2 \\rho(z) dz - \\mu_R[\\rho]^2\n1083: \n1084: $$\n1085: \n1086: **Step 1**: By the Axiom of Reward Regularity, $R: \\Omega \\to \\mathbb{R}$ is Lipschitz continuous and bounded. Therefore:\n1087: \n1088: $$\n1089: |\\mu_R[\\rho_1] - \\mu_R[\\rho_2]| = \\left|\\int_\\Omega R(z) (\\rho_1(z) - \\rho_2(z)) dz\\right| \\le \\|R\\|_{L^\\infty} \\|\\rho_1 - \\rho_2\\|_{L^1}\n1090: \n1091: $$\n1092: \n1093: **Step 2**: By Sobolev embedding, $H^1_w(\\Omega) \\hookrightarrow L^1_w(\\Omega) \\hookrightarrow L^1(\\Omega)$ (using the weight decay). Therefore, there exists a constant $C_{\\text{Sob}}$ such that:\n1094: \n1095: $$\n1096: \\|\\rho_1 - \\rho_2\\|_{L^1} \\le C_{\\text{Sob}} \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1097: \n1098: $$\n1099: \n1100: **Step 3**: Combining Steps 1-2 gives Lipschitz continuity of $\\mu_R$ with constant $L_{\\mu} = \\|R\\|_{L^\\infty} C_{\\text{Sob}}$.\n1101: \n1102: **Step 4**: For the variance, use the fact that $\\sigma_R^2[\\rho] = \\int R^2 \\rho - (\\int R \\rho)^2$. Both terms are Lipschitz by the same argument, using $R^2$ is also bounded and continuous.\n1103: \n1104: **Step 5**: The distance moments follow identically, using the fact that the algorithmic distance $d(z, z')$ is continuous and bounded on the compact domain $\\Omega$.\n1105: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-uniqueness-fixed-point-bounded",
      "title": null,
      "start_line": 1118,
      "end_line": 1239,
      "header_lines": [
        1119
      ],
      "content_start": 1120,
      "content_end": 1238,
      "content": "1120: :::{prf:proof}\n1121: :label: proof-lem-uniqueness-fixed-point-bounded\n1122: Let $\\rho^* = \\mathcal{T}[\\rho^*]$ be any fixed point. By the definition of $\\mathcal{T}$:\n1123: \n1124: $$\n1125: \\rho^* = (C \\cdot I - L^\\dagger)^{-1} (S[\\rho^*] + B[\\rho^*, m_d[\\rho^*]] - c(\\cdot)\\rho^* + C\\rho^*)\n1126: \n1127: $$\n1128: \n1129: **Step 1: Hypoelliptic regularity estimate**\n1130: \n1131: From the hypoelliptic regularity theory (Theorem [](#thm-uniqueness-hypoelliptic-regularity), established in Part C), the resolvent satisfies:\n1132: \n1133: $$\n1134: \\|\\rho^*\\|_{H^1_w} = \\|(C \\cdot I - L^\\dagger)^{-1} f\\|_{H^1_w} \\leq C_{\\text{hypo}} \\|f\\|_{L^2_w}\n1135: \n1136: $$\n1137: \n1138: where $f = S[\\rho^*] + B[\\rho^*, m_d[\\rho^*]] - c(\\cdot)\\rho^* + C\\rho^*$ is the source term.\n1139: \n1140: **Step 2: Bound the source term**\n1141: \n1142: We must show $\\|f\\|_{L^2_w}$ can be bounded in terms of $\\|\\rho^*\\|_{H^1_w}$ in a way that allows us to conclude $\\|\\rho^*\\|$ is bounded.\n1143: \n1144: **Term-by-term analysis**:\n1145: \n1146: 1. **Cloning source term**: $S_{\\text{src}}[\\rho^*](z) = \\frac{1}{\\tau m_a} \\int \\int f(z_d) f(z_c) P_{\\text{clone}}(\\cdots) Q_\\delta(z|z_c) dz_d dz_c$\n1147: \n1148:    Since $\\|\\rho^*\\|_{L^1} = 1$, $P_{\\text{clone}} \\in [0,1]$, and all kernels are bounded:\n1149: \n1150:    $$\n1151:    \\|S_{\\text{src}}[\\rho^*]\\|_{L^\\infty} \\leq \\frac{K_1}{\\tau}\n1152:    $$\n1153: \n1154:    where $K_1$ depends only on the kernel bounds. On a compact domain, $L^\\infty$ bounds imply $L^2_w$ bounds:\n1155: \n1156:    $$\n1157:    \\|S_{\\text{src}}[\\rho^*]\\|_{L^2_w} \\leq C_\\Omega \\|S_{\\text{src}}[\\rho^*]\\|_{L^\\infty} \\leq \\frac{C_\\Omega K_1}{\\tau} =: K_S\n1158:    $$\n1159: \n1160: 2. **Revival term**: $B[\\rho^*, m_d] = \\lambda_{\\text{rev}} m_d \\int Q_\\delta(z|z') \\rho^*(z') dz'$\n1161: \n1162:    Similarly, using $m_d \\leq 1$ and $\\|\\rho^*\\|_{L^1} = 1$:\n1163: \n1164:    $$\n1165:    \\|B[\\rho^*, m_d]\\|_{L^2_w} \\leq K_B\n1166:    $$\n1167: \n1168: 3. **Linear terms**: $(-c(\\cdot) + C)\\rho^*$\n1169: \n1170:    This is where we cannot naively bound. However, we use a **self-consistent argument**. The key is that $\\rho^*$ satisfies the equation:\n1171: \n1172:    $$\n1173:    (C \\cdot I - L^\\dagger)\\rho^* = S[\\rho^*] + B[\\rho^*, m_d] - c(\\cdot)\\rho^* + C\\rho^*\n1174:    $$\n1175: \n1176:    Rearranging:\n1177: \n1178:    $$\n1179:    -L^\\dagger \\rho^* = S[\\rho^*] + B[\\rho^*, m_d] - c(\\cdot)\\rho^*\n1180:    $$\n1181: \n1182: **Step 3: Key estimate**\n1183: \n1184: Integrating both sides over $\\Omega$ and using mass conservation properties:\n1185: - $\\int L^\\dagger \\rho^* = 0$ (reflecting boundaries)\n1186: - $\\int S[\\rho^*] = 0$ (mass-neutral)\n1187: - $\\int B[\\rho^*, m_d] = \\lambda_{\\text{rev}} m_d$\n1188: - $\\int c(\\cdot)\\rho^* = k_{\\text{killed}}[\\rho^*]$\n1189: \n1190: This gives: $k_{\\text{killed}}[\\rho^*] = \\lambda_{\\text{rev}} m_d$, which is the equilibrium condition we've already established.\n1191: \n1192: Now, taking $L^2_w$ norms in the fixed-point equation:\n1193: \n1194: $$\n1195: \\|\\rho^*\\|_{H^1_w} \\leq C_{\\text{hypo}} \\left(\\|S[\\rho^*]\\|_{L^2_w} + \\|B[\\rho^*, m_d]\\|_{L^2_w} + \\|c \\rho^*\\|_{L^2_w} + C\\|\\rho^*\\|_{L^2_w}\\right)\n1196: \n1197: $$\n1198: \n1199: Using the bounds from Steps 2:\n1200: \n1201: $$\n1202: \\|\\rho^*\\|_{H^1_w} \\leq C_{\\text{hypo}} \\left(K_S + K_B + (\\|c\\|_{L^\\infty} + C) \\|\\rho^*\\|_{L^2_w}\\right)\n1203: \n1204: $$\n1205: \n1206: By Sobolev embedding on the compact domain $\\Omega$: $\\|\\rho^*\\|_{L^2_w} \\leq C_{\\text{Sob}} \\|\\rho^*\\|_{H^1_w}$.\n1207: \n1208: Therefore:\n1209: \n1210: $$\n1211: \\|\\rho^*\\|_{H^1_w} \\leq C_{\\text{hypo}} (K_S + K_B) + C_{\\text{hypo}} (\\|c\\|_{L^\\infty} + C) C_{\\text{Sob}} \\|\\rho^*\\|_{H^1_w}\n1212: \n1213: $$\n1214: \n1215: Rearranging:\n1216: \n1217: $$\n1218: \\|\\rho^*\\|_{H^1_w} \\left[1 - C_{\\text{hypo}} C_{\\text{Sob}} (\\|c\\|_{L^\\infty} + C)\\right] \\leq C_{\\text{hypo}} (K_S + K_B)\n1219: \n1220: $$\n1221: \n1222: **Step 4: Conclusion**\n1223: \n1224: For the physical parameters of the system, we can choose $C$ and $\\sigma_v^2$ (which controls $C_{\\text{hypo}} \\sim 1/\\sigma_v^2$) such that:\n1225: \n1226: $$\n1227: C_{\\text{hypo}} C_{\\text{Sob}} (\\|c\\|_{L^\\infty} + C) < \\frac{1}{2}\n1228: \n1229: $$\n1230: \n1231: Then:\n1232: \n1233: $$\n1234: \\|\\rho^*\\|_{H^1_w} \\leq 2 C_{\\text{hypo}} (K_S + K_B) =: R_*\n1235: \n1236: $$\n1237: \n1238: This bound depends only on the system parameters and constants, not on the particular fixed point $\\rho^*$.",
      "metadata": {
        "label": "proof-lem-uniqueness-fixed-point-bounded"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "1118: :::\n1119: \n1120: :::{prf:proof}\n1121: :label: proof-lem-uniqueness-fixed-point-bounded\n1122: Let $\\rho^* = \\mathcal{T}[\\rho^*]$ be any fixed point. By the definition of $\\mathcal{T}$:\n1123: \n1124: $$\n1125: \\rho^* = (C \\cdot I - L^\\dagger)^{-1} (S[\\rho^*] + B[\\rho^*, m_d[\\rho^*]] - c(\\cdot)\\rho^* + C\\rho^*)\n1126: \n1127: $$\n1128: \n1129: **Step 1: Hypoelliptic regularity estimate**\n1130: \n1131: From the hypoelliptic regularity theory (Theorem [](#thm-uniqueness-hypoelliptic-regularity), established in Part C), the resolvent satisfies:\n1132: \n1133: $$\n1134: \\|\\rho^*\\|_{H^1_w} = \\|(C \\cdot I - L^\\dagger)^{-1} f\\|_{H^1_w} \\leq C_{\\text{hypo}} \\|f\\|_{L^2_w}\n1135: \n1136: $$\n1137: \n1138: where $f = S[\\rho^*] + B[\\rho^*, m_d[\\rho^*]] - c(\\cdot)\\rho^* + C\\rho^*$ is the source term.\n1139: \n1140: **Step 2: Bound the source term**\n1141: \n1142: We must show $\\|f\\|_{L^2_w}$ can be bounded in terms of $\\|\\rho^*\\|_{H^1_w}$ in a way that allows us to conclude $\\|\\rho^*\\|$ is bounded.\n1143: \n1144: **Term-by-term analysis**:\n1145: \n1146: 1. **Cloning source term**: $S_{\\text{src}}[\\rho^*](z) = \\frac{1}{\\tau m_a} \\int \\int f(z_d) f(z_c) P_{\\text{clone}}(\\cdots) Q_\\delta(z|z_c) dz_d dz_c$\n1147: \n1148:    Since $\\|\\rho^*\\|_{L^1} = 1$, $P_{\\text{clone}} \\in [0,1]$, and all kernels are bounded:\n1149: \n1150:    $$\n1151:    \\|S_{\\text{src}}[\\rho^*]\\|_{L^\\infty} \\leq \\frac{K_1}{\\tau}\n1152:    $$\n1153: \n1154:    where $K_1$ depends only on the kernel bounds. On a compact domain, $L^\\infty$ bounds imply $L^2_w$ bounds:\n1155: \n1156:    $$\n1157:    \\|S_{\\text{src}}[\\rho^*]\\|_{L^2_w} \\leq C_\\Omega \\|S_{\\text{src}}[\\rho^*]\\|_{L^\\infty} \\leq \\frac{C_\\Omega K_1}{\\tau} =: K_S\n1158:    $$\n1159: \n1160: 2. **Revival term**: $B[\\rho^*, m_d] = \\lambda_{\\text{rev}} m_d \\int Q_\\delta(z|z') \\rho^*(z') dz'$\n1161: \n1162:    Similarly, using $m_d \\leq 1$ and $\\|\\rho^*\\|_{L^1} = 1$:\n1163: \n1164:    $$\n1165:    \\|B[\\rho^*, m_d]\\|_{L^2_w} \\leq K_B\n1166:    $$\n1167: \n1168: 3. **Linear terms**: $(-c(\\cdot) + C)\\rho^*$\n1169: \n1170:    This is where we cannot naively bound. However, we use a **self-consistent argument**. The key is that $\\rho^*$ satisfies the equation:\n1171: \n1172:    $$\n1173:    (C \\cdot I - L^\\dagger)\\rho^* = S[\\rho^*] + B[\\rho^*, m_d] - c(\\cdot)\\rho^* + C\\rho^*\n1174:    $$\n1175: \n1176:    Rearranging:\n1177: \n1178:    $$\n1179:    -L^\\dagger \\rho^* = S[\\rho^*] + B[\\rho^*, m_d] - c(\\cdot)\\rho^*\n1180:    $$\n1181: \n1182: **Step 3: Key estimate**\n1183: \n1184: Integrating both sides over $\\Omega$ and using mass conservation properties:\n1185: - $\\int L^\\dagger \\rho^* = 0$ (reflecting boundaries)\n1186: - $\\int S[\\rho^*] = 0$ (mass-neutral)\n1187: - $\\int B[\\rho^*, m_d] = \\lambda_{\\text{rev}} m_d$\n1188: - $\\int c(\\cdot)\\rho^* = k_{\\text{killed}}[\\rho^*]$\n1189: \n1190: This gives: $k_{\\text{killed}}[\\rho^*] = \\lambda_{\\text{rev}} m_d$, which is the equilibrium condition we've already established.\n1191: \n1192: Now, taking $L^2_w$ norms in the fixed-point equation:\n1193: \n1194: $$\n1195: \\|\\rho^*\\|_{H^1_w} \\leq C_{\\text{hypo}} \\left(\\|S[\\rho^*]\\|_{L^2_w} + \\|B[\\rho^*, m_d]\\|_{L^2_w} + \\|c \\rho^*\\|_{L^2_w} + C\\|\\rho^*\\|_{L^2_w}\\right)\n1196: \n1197: $$\n1198: \n1199: Using the bounds from Steps 2:\n1200: \n1201: $$\n1202: \\|\\rho^*\\|_{H^1_w} \\leq C_{\\text{hypo}} \\left(K_S + K_B + (\\|c\\|_{L^\\infty} + C) \\|\\rho^*\\|_{L^2_w}\\right)\n1203: \n1204: $$\n1205: \n1206: By Sobolev embedding on the compact domain $\\Omega$: $\\|\\rho^*\\|_{L^2_w} \\leq C_{\\text{Sob}} \\|\\rho^*\\|_{H^1_w}$.\n1207: \n1208: Therefore:\n1209: \n1210: $$\n1211: \\|\\rho^*\\|_{H^1_w} \\leq C_{\\text{hypo}} (K_S + K_B) + C_{\\text{hypo}} (\\|c\\|_{L^\\infty} + C) C_{\\text{Sob}} \\|\\rho^*\\|_{H^1_w}\n1212: \n1213: $$\n1214: \n1215: Rearranging:\n1216: \n1217: $$\n1218: \\|\\rho^*\\|_{H^1_w} \\left[1 - C_{\\text{hypo}} C_{\\text{Sob}} (\\|c\\|_{L^\\infty} + C)\\right] \\leq C_{\\text{hypo}} (K_S + K_B)\n1219: \n1220: $$\n1221: \n1222: **Step 4: Conclusion**\n1223: \n1224: For the physical parameters of the system, we can choose $C$ and $\\sigma_v^2$ (which controls $C_{\\text{hypo}} \\sim 1/\\sigma_v^2$) such that:\n1225: \n1226: $$\n1227: C_{\\text{hypo}} C_{\\text{Sob}} (\\|c\\|_{L^\\infty} + C) < \\frac{1}{2}\n1228: \n1229: $$\n1230: \n1231: Then:\n1232: \n1233: $$\n1234: \\|\\rho^*\\|_{H^1_w} \\leq 2 C_{\\text{hypo}} (K_S + K_B) =: R_*\n1235: \n1236: $$\n1237: \n1238: This bound depends only on the system parameters and constants, not on the particular fixed point $\\rho^*$.\n1239: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-uniqueness-lipschitz-fitness-potential",
      "title": null,
      "start_line": 1252,
      "end_line": 1277,
      "header_lines": [
        1253
      ],
      "content_start": 1254,
      "content_end": 1276,
      "content": "1254: :::{prf:proof}\n1255: :label: proof-lem-uniqueness-lipschitz-fitness-potential\n1256: The fitness potential has the form:\n1257: \n1258: $$\n1259: V[\\rho](z) = \\alpha_R \\left(\\frac{R(z) - \\mu_R[\\rho]}{\\sigma_R[\\rho]}\\right) + \\alpha_D \\left(\\frac{D[\\rho](z) - \\mu_D[\\rho]}{\\sigma_D[\\rho]}\\right)\n1260: \n1261: $$\n1262: \n1263: where $D[\\rho](z) = \\int d(z, z') \\rho(z') dz'$ is the expected distance functional.\n1264: \n1265: **Step 1**: By Lemma [](#lem-uniqueness-lipschitz-moments), the moments $\\mu_R, \\sigma_R, \\mu_D, \\sigma_D$ are Lipschitz in $\\rho$.\n1266: \n1267: **Step 2**: The distance functional $D[\\rho](z)$ is also Lipschitz:\n1268: \n1269: $$\n1270: |D[\\rho_1](z) - D[\\rho_2](z)| \\le \\int_\\Omega d(z, z') |\\rho_1(z') - \\rho_2(z')| dz' \\le \\|d\\|_{L^\\infty} \\|\\rho_1 - \\rho_2\\|_{L^1}\n1271: \n1272: $$\n1273: \n1274: **Step 3**: The fitness potential is a composition of Lipschitz functions (ratios with denominators bounded away from zero by the non-degeneracy axioms). By the chain rule for Lipschitz functions, $V[\\rho]$ is Lipschitz.\n1275: \n1276: **Step 4**: Combining all factors, there exists $L_V = O(\\alpha_R + \\alpha_D) \\cdot C_{\\text{Sob}} \\cdot (\\|R\\|_{L^\\infty} + \\|d\\|_{L^\\infty})$.",
      "metadata": {
        "label": "proof-lem-uniqueness-lipschitz-fitness-potential"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "1252: :::\n1253: \n1254: :::{prf:proof}\n1255: :label: proof-lem-uniqueness-lipschitz-fitness-potential\n1256: The fitness potential has the form:\n1257: \n1258: $$\n1259: V[\\rho](z) = \\alpha_R \\left(\\frac{R(z) - \\mu_R[\\rho]}{\\sigma_R[\\rho]}\\right) + \\alpha_D \\left(\\frac{D[\\rho](z) - \\mu_D[\\rho]}{\\sigma_D[\\rho]}\\right)\n1260: \n1261: $$\n1262: \n1263: where $D[\\rho](z) = \\int d(z, z') \\rho(z') dz'$ is the expected distance functional.\n1264: \n1265: **Step 1**: By Lemma [](#lem-uniqueness-lipschitz-moments), the moments $\\mu_R, \\sigma_R, \\mu_D, \\sigma_D$ are Lipschitz in $\\rho$.\n1266: \n1267: **Step 2**: The distance functional $D[\\rho](z)$ is also Lipschitz:\n1268: \n1269: $$\n1270: |D[\\rho_1](z) - D[\\rho_2](z)| \\le \\int_\\Omega d(z, z') |\\rho_1(z') - \\rho_2(z')| dz' \\le \\|d\\|_{L^\\infty} \\|\\rho_1 - \\rho_2\\|_{L^1}\n1271: \n1272: $$\n1273: \n1274: **Step 3**: The fitness potential is a composition of Lipschitz functions (ratios with denominators bounded away from zero by the non-degeneracy axioms). By the chain rule for Lipschitz functions, $V[\\rho]$ is Lipschitz.\n1275: \n1276: **Step 4**: Combining all factors, there exists $L_V = O(\\alpha_R + \\alpha_D) \\cdot C_{\\text{Sob}} \\cdot (\\|R\\|_{L^\\infty} + \\|d\\|_{L^\\infty})$.\n1277: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-uniqueness-lipschitz-cloning-operator",
      "title": null,
      "start_line": 1292,
      "end_line": 1419,
      "header_lines": [
        1293
      ],
      "content_start": 1294,
      "content_end": 1418,
      "content": "1294: :::{prf:proof}\n1295: :label: proof-lem-uniqueness-lipschitz-cloning-operator\n1296: The cloning operator $S[\\rho]$ has the structure:\n1297: \n1298: $$\n1299: S[\\rho](z) = S_{\\text{src}}[\\rho](z) - S_{\\text{sink}}[\\rho](z)\n1300: \n1301: $$\n1302: \n1303: where both terms involve **quadratic** expressions in $\\rho$ due to pairwise walker-companion interactions:\n1304: \n1305: $$\n1306: S_{\\text{src}}[\\rho](z) = \\int_{\\Omega} \\int_{\\Omega} K_{\\text{jitter}}(z_d \\to z) \\pi(V[\\rho](z_d), V[\\rho](z_c)) \\rho(z_d) \\rho(z_c) \\, dz_d \\, dz_c\n1307: \n1308: $$\n1309: \n1310: **Challenge**: A quadratic operator is **not** globally Lipschitz on a vector space. However, it **is** locally Lipschitz on bounded balls in the $H^1_w$ norm.\n1311: \n1312: **Setup**: Let $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$, i.e., both satisfy $\\|\\rho_i\\|_{H^1_w} \\leq R$. We will derive a Lipschitz constant that depends explicitly on $R$.\n1313: \n1314: **Step 2: Quadratic difference expansion**\n1315: \n1316: For $\\rho_1, \\rho_2 \\in \\mathcal{P}$, the source term difference involves:\n1317: \n1318: $$\n1319: S_{\\text{src}}[\\rho_1] - S_{\\text{src}}[\\rho_2] = \\int_{\\Omega} \\int_{\\Omega} K_{\\text{jitter}}(z_d \\to z) \\left[\\pi(V[\\rho_1](z_d), V[\\rho_1](z_c)) \\rho_1(z_d) \\rho_1(z_c) - \\pi(V[\\rho_2](z_d), V[\\rho_2](z_c)) \\rho_2(z_d) \\rho_2(z_c)\\right] dz_d dz_c\n1320: \n1321: $$\n1322: \n1323: **Step 3: Decompose the difference**\n1324: \n1325: Using the algebraic identity for bilinear forms, we can write:\n1326: \n1327: $$\n1328: \\pi(V_1, V_1^c) \\rho_1 \\rho_1^c - \\pi(V_2, V_2^c) \\rho_2 \\rho_2^c\n1329: = [\\pi(V_1, V_1^c) - \\pi(V_2, V_2^c)] \\rho_1 \\rho_1^c + \\pi(V_2, V_2^c) [\\rho_1 \\rho_1^c - \\rho_2 \\rho_2^c]\n1330: \n1331: $$\n1332: \n1333: where $V_i = V[\\rho_i](z_d)$ and $V_i^c = V[\\rho_i](z_c)$.\n1334: \n1335: For the second term, using $ab - cd = a(b-d) + (a-c)d$:\n1336: \n1337: $$\n1338: \\rho_1(z_d)\\rho_1(z_c) - \\rho_2(z_d)\\rho_2(z_c)\n1339: = \\rho_1(z_d)[\\rho_1(z_c) - \\rho_2(z_c)] + [\\rho_1(z_d) - \\rho_2(z_d)]\\rho_2(z_c)\n1340: \n1341: $$\n1342: \n1343: **Step 4: Lipschitz continuity of π and V**\n1344: \n1345: By Lemma [](#lem-uniqueness-lipschitz-fitness-potential), $V[\\rho]$ is Lipschitz:\n1346: \n1347: $$\n1348: \\|V[\\rho_1] - V[\\rho_2]\\|_{L^\\infty} \\leq L_V \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1349: \n1350: $$\n1351: \n1352: By the axiom of selection probability, $\\pi(\\cdot, \\cdot)$ is Lipschitz with constant $L_\\pi$:\n1353: \n1354: $$\n1355: |\\pi(V_1, V_1^c) - \\pi(V_2, V_2^c)| \\leq L_\\pi (\\|V_1 - V_2\\|_{L^\\infty} + \\|V_1^c - V_2^c\\|_{L^\\infty})\n1356: \n1357: $$\n1358: \n1359: **Step 5: Estimate using Sobolev embedding**\n1360: \n1361: The weighted Sobolev space $H^1_w(\\Omega)$ embeds continuously into $L^2_w(\\Omega)$ and $L^\\infty_{\\text{loc}}(\\Omega)$ (locally bounded). For the phase space $\\Omega = X_{\\text{valid}} \\times V_{\\text{alg}}$, which is bounded, we have:\n1362: \n1363: $$\n1364: \\|\\rho\\|_{L^2} \\leq C_{\\text{Sob}} \\|\\rho\\|_{H^1_w}\n1365: \n1366: $$\n1367: \n1368: Using Hölder's inequality on the bilinear term:\n1369: \n1370: $$\n1371: \\left\\|\\int \\rho_1(z_d)[\\rho_1(z_c) - \\rho_2(z_c)] (\\cdots) dz_d dz_c\\right\\|_{L^2_w}\n1372: \\leq C \\|\\rho_1\\|_{L^2} \\|\\rho_1 - \\rho_2\\|_{L^2}\n1373: \n1374: $$\n1375: \n1376: **Step 6: Explicit estimate on the ball**\n1377: \n1378: For $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$ (where $\\|\\rho_i\\|_{H^1_w} \\leq R$), the Hölder estimate gives:\n1379: \n1380: $$\n1381: \\left\\|\\int \\rho_1(z_d)[\\rho_1(z_c) - \\rho_2(z_c)] (\\cdots) dz_d dz_c\\right\\|_{L^2_w}\n1382: \\leq C \\|\\rho_1\\|_{L^2} \\|\\rho_1 - \\rho_2\\|_{L^2} \\leq C C_{\\text{Sob}}^2 R \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1383: \n1384: $$\n1385: \n1386: Similarly for the other bilinear term. Combining all contributions from the quadratic structure, the source and sink terms:\n1387: \n1388: $$\n1389: \\|S[\\rho_1] - S[\\rho_2]\\|_{H^1_w} \\leq C_{\\text{quad}} \\cdot R \\cdot \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1390: \n1391: $$\n1392: \n1393: where $C_{\\text{quad}}$ depends on:\n1394: - The Sobolev embedding constant $C_{\\text{Sob}}$\n1395: - The Lipschitz constants $L_\\pi$ and $L_V$\n1396: - The selection rate $\\lambda_{\\text{sel}} = 1/\\tau$\n1397: - The kernel bounds\n1398: \n1399: **Conclusion**: Define:\n1400: \n1401: $$\n1402: L_S(R) := C_{\\text{quad}} \\cdot R + C_{\\text{linear}}\n1403: \n1404: $$\n1405: \n1406: where $C_{\\text{linear}}$ accounts for the linear part of the sink term. On the **ball** $\\mathcal{P}_R$, the cloning operator is Lipschitz continuous with constant $L_S(R) = O(R)$.\n1407: \n1408: **Similar argument for B[ρ, m_d]**: The revival operator $B[\\rho, m_d[\\rho]]$ is also locally Lipschitz. For $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$:\n1409: - $m_d[\\rho] = \\frac{1}{\\lambda_{\\text{rev}}} \\int c(z)\\rho(z) dz$ is Lipschitz in $\\rho$ (linear functional)\n1410: - The jitter convolution $g[\\rho]$ is Lipschitz (bounded kernel)\n1411: - The product $m_d[\\rho] \\cdot g[\\rho]$ satisfies:\n1412: \n1413: $$\n1414: \\|B[\\rho_1, m_d[\\rho_1]] - B[\\rho_2, m_d[\\rho_2]]\\|_{H^1_w} \\leq L_B(R) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1415: \n1416: $$\n1417: \n1418: where $L_B(R)$ grows at most linearly with $R$ due to the product structure.",
      "metadata": {
        "label": "proof-lem-uniqueness-lipschitz-cloning-operator"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "1292: :::\n1293: \n1294: :::{prf:proof}\n1295: :label: proof-lem-uniqueness-lipschitz-cloning-operator\n1296: The cloning operator $S[\\rho]$ has the structure:\n1297: \n1298: $$\n1299: S[\\rho](z) = S_{\\text{src}}[\\rho](z) - S_{\\text{sink}}[\\rho](z)\n1300: \n1301: $$\n1302: \n1303: where both terms involve **quadratic** expressions in $\\rho$ due to pairwise walker-companion interactions:\n1304: \n1305: $$\n1306: S_{\\text{src}}[\\rho](z) = \\int_{\\Omega} \\int_{\\Omega} K_{\\text{jitter}}(z_d \\to z) \\pi(V[\\rho](z_d), V[\\rho](z_c)) \\rho(z_d) \\rho(z_c) \\, dz_d \\, dz_c\n1307: \n1308: $$\n1309: \n1310: **Challenge**: A quadratic operator is **not** globally Lipschitz on a vector space. However, it **is** locally Lipschitz on bounded balls in the $H^1_w$ norm.\n1311: \n1312: **Setup**: Let $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$, i.e., both satisfy $\\|\\rho_i\\|_{H^1_w} \\leq R$. We will derive a Lipschitz constant that depends explicitly on $R$.\n1313: \n1314: **Step 2: Quadratic difference expansion**\n1315: \n1316: For $\\rho_1, \\rho_2 \\in \\mathcal{P}$, the source term difference involves:\n1317: \n1318: $$\n1319: S_{\\text{src}}[\\rho_1] - S_{\\text{src}}[\\rho_2] = \\int_{\\Omega} \\int_{\\Omega} K_{\\text{jitter}}(z_d \\to z) \\left[\\pi(V[\\rho_1](z_d), V[\\rho_1](z_c)) \\rho_1(z_d) \\rho_1(z_c) - \\pi(V[\\rho_2](z_d), V[\\rho_2](z_c)) \\rho_2(z_d) \\rho_2(z_c)\\right] dz_d dz_c\n1320: \n1321: $$\n1322: \n1323: **Step 3: Decompose the difference**\n1324: \n1325: Using the algebraic identity for bilinear forms, we can write:\n1326: \n1327: $$\n1328: \\pi(V_1, V_1^c) \\rho_1 \\rho_1^c - \\pi(V_2, V_2^c) \\rho_2 \\rho_2^c\n1329: = [\\pi(V_1, V_1^c) - \\pi(V_2, V_2^c)] \\rho_1 \\rho_1^c + \\pi(V_2, V_2^c) [\\rho_1 \\rho_1^c - \\rho_2 \\rho_2^c]\n1330: \n1331: $$\n1332: \n1333: where $V_i = V[\\rho_i](z_d)$ and $V_i^c = V[\\rho_i](z_c)$.\n1334: \n1335: For the second term, using $ab - cd = a(b-d) + (a-c)d$:\n1336: \n1337: $$\n1338: \\rho_1(z_d)\\rho_1(z_c) - \\rho_2(z_d)\\rho_2(z_c)\n1339: = \\rho_1(z_d)[\\rho_1(z_c) - \\rho_2(z_c)] + [\\rho_1(z_d) - \\rho_2(z_d)]\\rho_2(z_c)\n1340: \n1341: $$\n1342: \n1343: **Step 4: Lipschitz continuity of π and V**\n1344: \n1345: By Lemma [](#lem-uniqueness-lipschitz-fitness-potential), $V[\\rho]$ is Lipschitz:\n1346: \n1347: $$\n1348: \\|V[\\rho_1] - V[\\rho_2]\\|_{L^\\infty} \\leq L_V \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1349: \n1350: $$\n1351: \n1352: By the axiom of selection probability, $\\pi(\\cdot, \\cdot)$ is Lipschitz with constant $L_\\pi$:\n1353: \n1354: $$\n1355: |\\pi(V_1, V_1^c) - \\pi(V_2, V_2^c)| \\leq L_\\pi (\\|V_1 - V_2\\|_{L^\\infty} + \\|V_1^c - V_2^c\\|_{L^\\infty})\n1356: \n1357: $$\n1358: \n1359: **Step 5: Estimate using Sobolev embedding**\n1360: \n1361: The weighted Sobolev space $H^1_w(\\Omega)$ embeds continuously into $L^2_w(\\Omega)$ and $L^\\infty_{\\text{loc}}(\\Omega)$ (locally bounded). For the phase space $\\Omega = X_{\\text{valid}} \\times V_{\\text{alg}}$, which is bounded, we have:\n1362: \n1363: $$\n1364: \\|\\rho\\|_{L^2} \\leq C_{\\text{Sob}} \\|\\rho\\|_{H^1_w}\n1365: \n1366: $$\n1367: \n1368: Using Hölder's inequality on the bilinear term:\n1369: \n1370: $$\n1371: \\left\\|\\int \\rho_1(z_d)[\\rho_1(z_c) - \\rho_2(z_c)] (\\cdots) dz_d dz_c\\right\\|_{L^2_w}\n1372: \\leq C \\|\\rho_1\\|_{L^2} \\|\\rho_1 - \\rho_2\\|_{L^2}\n1373: \n1374: $$\n1375: \n1376: **Step 6: Explicit estimate on the ball**\n1377: \n1378: For $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$ (where $\\|\\rho_i\\|_{H^1_w} \\leq R$), the Hölder estimate gives:\n1379: \n1380: $$\n1381: \\left\\|\\int \\rho_1(z_d)[\\rho_1(z_c) - \\rho_2(z_c)] (\\cdots) dz_d dz_c\\right\\|_{L^2_w}\n1382: \\leq C \\|\\rho_1\\|_{L^2} \\|\\rho_1 - \\rho_2\\|_{L^2} \\leq C C_{\\text{Sob}}^2 R \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1383: \n1384: $$\n1385: \n1386: Similarly for the other bilinear term. Combining all contributions from the quadratic structure, the source and sink terms:\n1387: \n1388: $$\n1389: \\|S[\\rho_1] - S[\\rho_2]\\|_{H^1_w} \\leq C_{\\text{quad}} \\cdot R \\cdot \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1390: \n1391: $$\n1392: \n1393: where $C_{\\text{quad}}$ depends on:\n1394: - The Sobolev embedding constant $C_{\\text{Sob}}$\n1395: - The Lipschitz constants $L_\\pi$ and $L_V$\n1396: - The selection rate $\\lambda_{\\text{sel}} = 1/\\tau$\n1397: - The kernel bounds\n1398: \n1399: **Conclusion**: Define:\n1400: \n1401: $$\n1402: L_S(R) := C_{\\text{quad}} \\cdot R + C_{\\text{linear}}\n1403: \n1404: $$\n1405: \n1406: where $C_{\\text{linear}}$ accounts for the linear part of the sink term. On the **ball** $\\mathcal{P}_R$, the cloning operator is Lipschitz continuous with constant $L_S(R) = O(R)$.\n1407: \n1408: **Similar argument for B[ρ, m_d]**: The revival operator $B[\\rho, m_d[\\rho]]$ is also locally Lipschitz. For $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$:\n1409: - $m_d[\\rho] = \\frac{1}{\\lambda_{\\text{rev}}} \\int c(z)\\rho(z) dz$ is Lipschitz in $\\rho$ (linear functional)\n1410: - The jitter convolution $g[\\rho]$ is Lipschitz (bounded kernel)\n1411: - The product $m_d[\\rho] \\cdot g[\\rho]$ satisfies:\n1412: \n1413: $$\n1414: \\|B[\\rho_1, m_d[\\rho_1]] - B[\\rho_2, m_d[\\rho_2]]\\|_{H^1_w} \\leq L_B(R) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1415: \n1416: $$\n1417: \n1418: where $L_B(R)$ grows at most linearly with $R$ due to the product structure.\n1419: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-uniqueness-hormander",
      "title": null,
      "start_line": 1461,
      "end_line": 1466,
      "header_lines": [
        1462
      ],
      "content_start": 1463,
      "content_end": 1465,
      "content": "1463: :::{prf:proof}\n1464: :label: proof-thm-uniqueness-hormander\n1465: This is Hörmander's celebrated theorem (1967). See Hörmander, \"Hypoelliptic second order differential equations,\" *Acta Math.* 119 (1967), 147-171.",
      "metadata": {
        "label": "proof-thm-uniqueness-hormander"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "1461: :::\n1462: \n1463: :::{prf:proof}\n1464: :label: proof-thm-uniqueness-hormander\n1465: This is Hörmander's celebrated theorem (1967). See Hörmander, \"Hypoelliptic second order differential equations,\" *Acta Math.* 119 (1967), 147-171.\n1466: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-uniqueness-hormander-verification",
      "title": null,
      "start_line": 1474,
      "end_line": 1540,
      "header_lines": [
        1475
      ],
      "content_start": 1476,
      "content_end": 1539,
      "content": "1476: :::{prf:proof}\n1477: :label: proof-lem-uniqueness-hormander-verification\n1478: Write $L$ in the form required by Hörmander's theorem:\n1479: \n1480: $$\n1481: L\\phi = \\sum_{i=1}^{d} X_i^2 \\phi + X_0 \\phi\n1482: \n1483: $$\n1484: \n1485: where:\n1486: - $X_i = \\sqrt{\\sigma_v^2 \\gamma} \\frac{\\partial}{\\partial v_i}$ for $i = 1, \\ldots, d$ (diffusion vector fields)\n1487: - $X_0 = v \\cdot \\nabla_x - \\gamma v \\cdot \\nabla_v$ (drift vector field)\n1488: \n1489: **Step 1: Compute the Lie brackets**\n1490: \n1491: For any $i \\in \\{1, \\ldots, d\\}$, compute the commutator:\n1492: \n1493: $$\n1494: [X_0, X_i] = [v \\cdot \\nabla_x - \\gamma v \\cdot \\nabla_v, \\frac{\\partial}{\\partial v_i}]\n1495: \n1496: $$\n1497: \n1498: Using $[A+B, C] = [A, C] + [B, C]$:\n1499: \n1500: $$\n1501: [X_0, X_i] = [v \\cdot \\nabla_x, \\frac{\\partial}{\\partial v_i}] + [-\\gamma v \\cdot \\nabla_v, \\frac{\\partial}{\\partial v_i}]\n1502: \n1503: $$\n1504: \n1505: For the first term, note that $v \\cdot \\nabla_x = \\sum_j v_j \\partial_{x_j}$:\n1506: \n1507: $$\n1508: [v \\cdot \\nabla_x, \\frac{\\partial}{\\partial v_i}] \\phi = v \\cdot \\nabla_x \\left(\\frac{\\partial \\phi}{\\partial v_i}\\right) - \\frac{\\partial}{\\partial v_i}(v \\cdot \\nabla_x \\phi) = -\\frac{\\partial \\phi}{\\partial x_i} = -\\partial_{x_i}\n1509: \n1510: $$\n1511: \n1512: For the second term, similarly:\n1513: \n1514: $$\n1515: [-\\gamma v \\cdot \\nabla_v, \\frac{\\partial}{\\partial v_i}] \\phi = -\\gamma \\partial_{v_i}\n1516: \n1517: $$\n1518: \n1519: Therefore:\n1520: \n1521: $$\n1522: [X_0, X_i] = -\\partial_{x_i} - \\gamma \\partial_{v_i}\n1523: \n1524: $$\n1525: \n1526: **Step 2: Span the tangent space**\n1527: \n1528: At any point $(x, v) \\in \\Omega$, the vector fields $\\{X_1, \\ldots, X_d\\}$ span the velocity tangent directions $T_v$, and their commutators with $X_0$ give:\n1529: \n1530: $$\n1531: \\{[X_0, X_i] : i = 1, \\ldots, d\\} \\text{ contain } \\{-\\partial_{x_1}, \\ldots, -\\partial_{x_d}\\}\n1532: \n1533: $$\n1534: \n1535: which span the position tangent directions $T_x$. Therefore, the Lie algebra generated by $\\{X_0, X_1, \\ldots, X_d\\}$ spans $T_{(x,v)} \\Omega = T_x \\times T_v$ at every point.\n1536: \n1537: **Step 3: Conclusion**\n1538: \n1539: By Hörmander's theorem, $L$ is hypoelliptic.",
      "metadata": {
        "label": "proof-lem-uniqueness-hormander-verification"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "1474: :::\n1475: \n1476: :::{prf:proof}\n1477: :label: proof-lem-uniqueness-hormander-verification\n1478: Write $L$ in the form required by Hörmander's theorem:\n1479: \n1480: $$\n1481: L\\phi = \\sum_{i=1}^{d} X_i^2 \\phi + X_0 \\phi\n1482: \n1483: $$\n1484: \n1485: where:\n1486: - $X_i = \\sqrt{\\sigma_v^2 \\gamma} \\frac{\\partial}{\\partial v_i}$ for $i = 1, \\ldots, d$ (diffusion vector fields)\n1487: - $X_0 = v \\cdot \\nabla_x - \\gamma v \\cdot \\nabla_v$ (drift vector field)\n1488: \n1489: **Step 1: Compute the Lie brackets**\n1490: \n1491: For any $i \\in \\{1, \\ldots, d\\}$, compute the commutator:\n1492: \n1493: $$\n1494: [X_0, X_i] = [v \\cdot \\nabla_x - \\gamma v \\cdot \\nabla_v, \\frac{\\partial}{\\partial v_i}]\n1495: \n1496: $$\n1497: \n1498: Using $[A+B, C] = [A, C] + [B, C]$:\n1499: \n1500: $$\n1501: [X_0, X_i] = [v \\cdot \\nabla_x, \\frac{\\partial}{\\partial v_i}] + [-\\gamma v \\cdot \\nabla_v, \\frac{\\partial}{\\partial v_i}]\n1502: \n1503: $$\n1504: \n1505: For the first term, note that $v \\cdot \\nabla_x = \\sum_j v_j \\partial_{x_j}$:\n1506: \n1507: $$\n1508: [v \\cdot \\nabla_x, \\frac{\\partial}{\\partial v_i}] \\phi = v \\cdot \\nabla_x \\left(\\frac{\\partial \\phi}{\\partial v_i}\\right) - \\frac{\\partial}{\\partial v_i}(v \\cdot \\nabla_x \\phi) = -\\frac{\\partial \\phi}{\\partial x_i} = -\\partial_{x_i}\n1509: \n1510: $$\n1511: \n1512: For the second term, similarly:\n1513: \n1514: $$\n1515: [-\\gamma v \\cdot \\nabla_v, \\frac{\\partial}{\\partial v_i}] \\phi = -\\gamma \\partial_{v_i}\n1516: \n1517: $$\n1518: \n1519: Therefore:\n1520: \n1521: $$\n1522: [X_0, X_i] = -\\partial_{x_i} - \\gamma \\partial_{v_i}\n1523: \n1524: $$\n1525: \n1526: **Step 2: Span the tangent space**\n1527: \n1528: At any point $(x, v) \\in \\Omega$, the vector fields $\\{X_1, \\ldots, X_d\\}$ span the velocity tangent directions $T_v$, and their commutators with $X_0$ give:\n1529: \n1530: $$\n1531: \\{[X_0, X_i] : i = 1, \\ldots, d\\} \\text{ contain } \\{-\\partial_{x_1}, \\ldots, -\\partial_{x_d}\\}\n1532: \n1533: $$\n1534: \n1535: which span the position tangent directions $T_x$. Therefore, the Lie algebra generated by $\\{X_0, X_1, \\ldots, X_d\\}$ spans $T_{(x,v)} \\Omega = T_x \\times T_v$ at every point.\n1536: \n1537: **Step 3: Conclusion**\n1538: \n1539: By Hörmander's theorem, $L$ is hypoelliptic.\n1540: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-uniqueness-hypoelliptic-regularity",
      "title": null,
      "start_line": 1562,
      "end_line": 1638,
      "header_lines": [
        1563
      ],
      "content_start": 1564,
      "content_end": 1637,
      "content": "1564: :::{prf:proof}\n1565: :label: proof-thm-uniqueness-hypoelliptic-regularity\n1566: This proof uses the theory of hypoelliptic operators on weighted spaces. The key references are:\n1567: - Hérau & Nier, \"Isotropic hypoellipticity and trend to equilibrium for the Fokker-Planck equation with a high-degree potential\" *Arch. Ration. Mech. Anal.* 171 (2004), 151-218.\n1568: - Villani, \"Hypocoercivity,\" *Mem. Amer. Math. Soc.* 202 (2009), no. 950.\n1569: \n1570: **Remark on boundary conditions**: The following analysis assumes either periodic boundary conditions in $x$ or reflecting/absorbing boundaries that are compatible with the hypoellipticity analysis. For general domains with boundaries, one must verify that the boundary operator preserves the Lie bracket structure. This is a subtle point addressed in:\n1571: - Hérau, Nier, \"Isotropic hypoellipticity...\" (for boundary conditions on kinetic operators)\n1572: - Lebeau, \"Hypoelliptic second order differential equations with subelliptic boundary conditions,\" *Proc. ICM* (2006)\n1573: \n1574: For the FractalAI setting with bounded domains $\\mathcal{X}_{\\text{valid}}$, the reflecting boundaries on $\\partial \\mathcal{X}_{\\text{valid}}$ are compatible with the hypoellipticity structure, as they preserve the mass conservation property while allowing the Lie brackets to span the tangent space.\n1575: \n1576: **Step 1: The weighted bilinear form**\n1577: \n1578: Define the bilinear form associated with $-\\mathcal{L}_{\\text{lin}}$:\n1579: \n1580: $$\n1581: a(u, v) = \\int_\\Omega \\left[-L^\\dagger u + Cu\\right] v \\, w(z) \\, dz\n1582: \n1583: $$\n1584: \n1585: Using integration by parts (with boundary terms vanishing by the reflecting/absorbing boundary conditions):\n1586: \n1587: $$\n1588: a(u, v) = \\int_\\Omega \\left[\\sigma_v^2 \\gamma \\nabla_v u \\cdot \\nabla_v v + \\gamma v \\cdot \\nabla_v u \\, v + C u v\\right] w(z) \\, dz\n1589: \n1590: $$\n1591: \n1592: **Step 2: Coercivity estimate (the hypocoercivity argument)**\n1593: \n1594: The challenge is to show $a(u, u) \\ge \\alpha \\|u\\|_{H^1_w}^2$ for some $\\alpha > 0$. The naive estimate gives:\n1595: \n1596: $$\n1597: a(u, u) \\ge \\sigma_v^2 \\gamma \\int |\\nabla_v u|^2 w dz + C \\int u^2 w dz\n1598: \n1599: $$\n1600: \n1601: This provides control only over velocity derivatives, not position derivatives. **Hypocoercivity** is the technique to obtain control over $\\|\\nabla_x u\\|^2$ as well.\n1602: \n1603: The key idea (Villani 2009, Theorem 24): Define an auxiliary functional:\n1604: \n1605: $$\n1606: \\Psi[u] = a(u, u) + \\epsilon \\int u (v \\cdot \\nabla_x u) w dz\n1607: \n1608: $$\n1609: \n1610: for a carefully chosen small $\\epsilon > 0$. After integration by parts and using the weight function, one can show:\n1611: \n1612: $$\n1613: \\Psi[u] \\ge c_1 \\left(\\sigma_v^2 \\|\\nabla_v u\\|_{L^2_w}^2 + \\|\\nabla_x u\\|_{L^2_w}^2 + \\|u\\|_{L^2_w}^2\\right)\n1614: \n1615: $$\n1616: \n1617: for constants $c_1 = c_1(\\sigma_v^2, \\gamma, C, \\epsilon)$. The coupling term $v \\cdot \\nabla_x$ \"transfers\" the regularity from velocity to position.\n1618: \n1619: **Remark on the weight function**: The polynomial weight $w(z) = 1 + \\|x\\|^2 + \\|v\\|^2$ plays a crucial role in the coercivity estimate. When performing integration by parts on the coupling term $\\int u (v \\cdot \\nabla_x u) w dz$, the growth of $w$ at infinity ensures that boundary terms vanish. Moreover, the weight compensates for the polynomial growth of the velocity field in the drift term. The specific form of $w$ must be carefully chosen to balance:\n1620: 1. Polynomial growth at infinity (to control tail behavior of probability densities)\n1621: 2. Local integrability (ensuring $H^1_w$ is a Hilbert space)\n1622: 3. Compatibility with the hypocoercivity auxiliary functional (allowing the coupling estimate to close)\n1623: \n1624: This is a standard technique in kinetic theory; see Villani (2009), Section 2.2 for a detailed discussion of weight functions in hypocoercive estimates.\n1625: \n1626: **Step 3: Application of Lax-Milgram**\n1627: \n1628: The bilinear form $a(\\cdot, \\cdot)$ is:\n1629: 1. **Continuous**: $|a(u, v)| \\le C_{\\text{cont}} \\|u\\|_{H^1_w} \\|v\\|_{H^1_w}$\n1630: 2. **Coercive**: $a(u, u) \\ge c_1 \\|u\\|_{H^1_w}^2$ (from Step 2)\n1631: \n1632: By the **Lax-Milgram theorem**, for any $f \\in L^2_w$, there exists a unique $u \\in H^1_w$ solving $a(u, v) = \\int f v w dz$ for all $v \\in H^1_w$. Moreover:\n1633: \n1634: $$\n1635: \\|u\\|_{H^1_w} \\le \\frac{1}{c_1} \\|f\\|_{L^2_w} =: C_{\\text{hypo}} \\|f\\|_{L^2_w}\n1636: \n1637: $$",
      "metadata": {
        "label": "proof-thm-uniqueness-hypoelliptic-regularity"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "1562: :::\n1563: \n1564: :::{prf:proof}\n1565: :label: proof-thm-uniqueness-hypoelliptic-regularity\n1566: This proof uses the theory of hypoelliptic operators on weighted spaces. The key references are:\n1567: - Hérau & Nier, \"Isotropic hypoellipticity and trend to equilibrium for the Fokker-Planck equation with a high-degree potential\" *Arch. Ration. Mech. Anal.* 171 (2004), 151-218.\n1568: - Villani, \"Hypocoercivity,\" *Mem. Amer. Math. Soc.* 202 (2009), no. 950.\n1569: \n1570: **Remark on boundary conditions**: The following analysis assumes either periodic boundary conditions in $x$ or reflecting/absorbing boundaries that are compatible with the hypoellipticity analysis. For general domains with boundaries, one must verify that the boundary operator preserves the Lie bracket structure. This is a subtle point addressed in:\n1571: - Hérau, Nier, \"Isotropic hypoellipticity...\" (for boundary conditions on kinetic operators)\n1572: - Lebeau, \"Hypoelliptic second order differential equations with subelliptic boundary conditions,\" *Proc. ICM* (2006)\n1573: \n1574: For the FractalAI setting with bounded domains $\\mathcal{X}_{\\text{valid}}$, the reflecting boundaries on $\\partial \\mathcal{X}_{\\text{valid}}$ are compatible with the hypoellipticity structure, as they preserve the mass conservation property while allowing the Lie brackets to span the tangent space.\n1575: \n1576: **Step 1: The weighted bilinear form**\n1577: \n1578: Define the bilinear form associated with $-\\mathcal{L}_{\\text{lin}}$:\n1579: \n1580: $$\n1581: a(u, v) = \\int_\\Omega \\left[-L^\\dagger u + Cu\\right] v \\, w(z) \\, dz\n1582: \n1583: $$\n1584: \n1585: Using integration by parts (with boundary terms vanishing by the reflecting/absorbing boundary conditions):\n1586: \n1587: $$\n1588: a(u, v) = \\int_\\Omega \\left[\\sigma_v^2 \\gamma \\nabla_v u \\cdot \\nabla_v v + \\gamma v \\cdot \\nabla_v u \\, v + C u v\\right] w(z) \\, dz\n1589: \n1590: $$\n1591: \n1592: **Step 2: Coercivity estimate (the hypocoercivity argument)**\n1593: \n1594: The challenge is to show $a(u, u) \\ge \\alpha \\|u\\|_{H^1_w}^2$ for some $\\alpha > 0$. The naive estimate gives:\n1595: \n1596: $$\n1597: a(u, u) \\ge \\sigma_v^2 \\gamma \\int |\\nabla_v u|^2 w dz + C \\int u^2 w dz\n1598: \n1599: $$\n1600: \n1601: This provides control only over velocity derivatives, not position derivatives. **Hypocoercivity** is the technique to obtain control over $\\|\\nabla_x u\\|^2$ as well.\n1602: \n1603: The key idea (Villani 2009, Theorem 24): Define an auxiliary functional:\n1604: \n1605: $$\n1606: \\Psi[u] = a(u, u) + \\epsilon \\int u (v \\cdot \\nabla_x u) w dz\n1607: \n1608: $$\n1609: \n1610: for a carefully chosen small $\\epsilon > 0$. After integration by parts and using the weight function, one can show:\n1611: \n1612: $$\n1613: \\Psi[u] \\ge c_1 \\left(\\sigma_v^2 \\|\\nabla_v u\\|_{L^2_w}^2 + \\|\\nabla_x u\\|_{L^2_w}^2 + \\|u\\|_{L^2_w}^2\\right)\n1614: \n1615: $$\n1616: \n1617: for constants $c_1 = c_1(\\sigma_v^2, \\gamma, C, \\epsilon)$. The coupling term $v \\cdot \\nabla_x$ \"transfers\" the regularity from velocity to position.\n1618: \n1619: **Remark on the weight function**: The polynomial weight $w(z) = 1 + \\|x\\|^2 + \\|v\\|^2$ plays a crucial role in the coercivity estimate. When performing integration by parts on the coupling term $\\int u (v \\cdot \\nabla_x u) w dz$, the growth of $w$ at infinity ensures that boundary terms vanish. Moreover, the weight compensates for the polynomial growth of the velocity field in the drift term. The specific form of $w$ must be carefully chosen to balance:\n1620: 1. Polynomial growth at infinity (to control tail behavior of probability densities)\n1621: 2. Local integrability (ensuring $H^1_w$ is a Hilbert space)\n1622: 3. Compatibility with the hypocoercivity auxiliary functional (allowing the coupling estimate to close)\n1623: \n1624: This is a standard technique in kinetic theory; see Villani (2009), Section 2.2 for a detailed discussion of weight functions in hypocoercive estimates.\n1625: \n1626: **Step 3: Application of Lax-Milgram**\n1627: \n1628: The bilinear form $a(\\cdot, \\cdot)$ is:\n1629: 1. **Continuous**: $|a(u, v)| \\le C_{\\text{cont}} \\|u\\|_{H^1_w} \\|v\\|_{H^1_w}$\n1630: 2. **Coercive**: $a(u, u) \\ge c_1 \\|u\\|_{H^1_w}^2$ (from Step 2)\n1631: \n1632: By the **Lax-Milgram theorem**, for any $f \\in L^2_w$, there exists a unique $u \\in H^1_w$ solving $a(u, v) = \\int f v w dz$ for all $v \\in H^1_w$. Moreover:\n1633: \n1634: $$\n1635: \\|u\\|_{H^1_w} \\le \\frac{1}{c_1} \\|f\\|_{L^2_w} =: C_{\\text{hypo}} \\|f\\|_{L^2_w}\n1636: \n1637: $$\n1638: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-uniqueness-scaling-hypoelliptic-constant",
      "title": null,
      "start_line": 1660,
      "end_line": 1702,
      "header_lines": [
        1661
      ],
      "content_start": 1662,
      "content_end": 1701,
      "content": "1662: :::{prf:proof}\n1663: :label: proof-lem-uniqueness-scaling-hypoelliptic-constant\n1664: The coercivity constant $c_1$ from the hypocoercivity argument in Theorem [](#thm-uniqueness-hypoelliptic-regularity) depends on the parameters as follows:\n1665: \n1666: **From the diffusion term**:\n1667: \n1668: $$\n1669: \\int \\sigma_v^2 \\gamma |\\nabla_v u|^2 w dz \\ge \\sigma_v^2 \\gamma \\|\\nabla_v u\\|_{L^2_w}^2\n1670: \n1671: $$\n1672: \n1673: **From the auxiliary functional** (Villani's method): The term controlling position derivatives scales as:\n1674: \n1675: $$\n1676: \\epsilon \\int u (v \\cdot \\nabla_x u) w dz + O(\\epsilon^2) \\text{ terms}\n1677: \n1678: $$\n1679: \n1680: Optimizing over $\\epsilon$, one obtains (see Villani 2009, Theorem 24, equation (59)):\n1681: \n1682: $$\n1683: \\|\\nabla_x u\\|_{L^2_w}^2 \\lesssim \\frac{1}{\\sigma_v^2 \\gamma} \\text{(diffusive estimate)}\n1684: \n1685: $$\n1686: \n1687: The overall coercivity constant is:\n1688: \n1689: $$\n1690: c_1 = \\min\\left(\\sigma_v^2 \\gamma, C, \\frac{(\\sigma_v^2 \\gamma)^2}{C_{\\text{Poincaré}}}\\right)\n1691: \n1692: $$\n1693: \n1694: where $C_{\\text{Poincaré}}$ is the Poincaré constant for the domain.\n1695: \n1696: For large $\\sigma_v^2$, the bottleneck is the transfer from velocity to position, giving:\n1697: \n1698: $$\n1699: c_1 \\sim \\sigma_v^2 \\gamma \\implies C_{\\text{hypo}} = \\frac{1}{c_1} \\sim \\frac{1}{\\sigma_v^2 \\gamma}\n1700: \n1701: $$",
      "metadata": {
        "label": "proof-lem-uniqueness-scaling-hypoelliptic-constant"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "1660: :::\n1661: \n1662: :::{prf:proof}\n1663: :label: proof-lem-uniqueness-scaling-hypoelliptic-constant\n1664: The coercivity constant $c_1$ from the hypocoercivity argument in Theorem [](#thm-uniqueness-hypoelliptic-regularity) depends on the parameters as follows:\n1665: \n1666: **From the diffusion term**:\n1667: \n1668: $$\n1669: \\int \\sigma_v^2 \\gamma |\\nabla_v u|^2 w dz \\ge \\sigma_v^2 \\gamma \\|\\nabla_v u\\|_{L^2_w}^2\n1670: \n1671: $$\n1672: \n1673: **From the auxiliary functional** (Villani's method): The term controlling position derivatives scales as:\n1674: \n1675: $$\n1676: \\epsilon \\int u (v \\cdot \\nabla_x u) w dz + O(\\epsilon^2) \\text{ terms}\n1677: \n1678: $$\n1679: \n1680: Optimizing over $\\epsilon$, one obtains (see Villani 2009, Theorem 24, equation (59)):\n1681: \n1682: $$\n1683: \\|\\nabla_x u\\|_{L^2_w}^2 \\lesssim \\frac{1}{\\sigma_v^2 \\gamma} \\text{(diffusive estimate)}\n1684: \n1685: $$\n1686: \n1687: The overall coercivity constant is:\n1688: \n1689: $$\n1690: c_1 = \\min\\left(\\sigma_v^2 \\gamma, C, \\frac{(\\sigma_v^2 \\gamma)^2}{C_{\\text{Poincaré}}}\\right)\n1691: \n1692: $$\n1693: \n1694: where $C_{\\text{Poincaré}}$ is the Poincaré constant for the domain.\n1695: \n1696: For large $\\sigma_v^2$, the bottleneck is the transfer from velocity to position, giving:\n1697: \n1698: $$\n1699: c_1 \\sim \\sigma_v^2 \\gamma \\implies C_{\\text{hypo}} = \\frac{1}{c_1} \\sim \\frac{1}{\\sigma_v^2 \\gamma}\n1700: \n1701: $$\n1702: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-uniqueness-contraction-solution-operator",
      "title": null,
      "start_line": 1730,
      "end_line": 1850,
      "header_lines": [
        1731
      ],
      "content_start": 1732,
      "content_end": 1849,
      "content": "1732: :::{prf:proof}\n1733: :label: proof-thm-uniqueness-contraction-solution-operator\n1734: Recall $\\mathcal{T}[\\rho] = (-\\mathcal{L}_{\\text{lin}})^{-1} (S[\\rho] + B[\\rho, m_d[\\rho]] - c(\\cdot)\\rho + C\\rho)$.\n1735: \n1736: **Step 1: Difference equation**\n1737: \n1738: $$\n1739: \\mathcal{T}[\\rho_1] - \\mathcal{T}[\\rho_2] = (-\\mathcal{L}_{\\text{lin}})^{-1} \\left[(S[\\rho_1] - S[\\rho_2]) + (B[\\rho_1, m_d[\\rho_1]] - B[\\rho_2, m_d[\\rho_2]]) - c(\\cdot)(\\rho_1 - \\rho_2) + C(\\rho_1 - \\rho_2)\\right]\n1740: \n1741: $$\n1742: \n1743: **Step 2: Hypoelliptic regularity of the inverse operator**\n1744: \n1745: By Theorem [](#thm-uniqueness-hypoelliptic-regularity), the operator $(-\\mathcal{L}_{\\text{lin}})^{-1}$ is a bounded linear operator from $L^2_w(\\Omega)$ to $H^1_w(\\Omega)$ with operator norm:\n1746: \n1747: $$\n1748: \\|(-\\mathcal{L}_{\\text{lin}})^{-1}\\|_{L^2_w \\to H^1_w} = C_{\\text{hypo}}\n1749: \n1750: $$\n1751: \n1752: **Critical note**: The kinetic operator $L^\\dagger$ is **hypoelliptic**, not elliptic. It has second-order derivatives only in velocity variables, but Hörmander's condition (Lemma [](#lem-uniqueness-hormander-verification)) ensures that smoothness propagates to position variables through the coupling term $v \\cdot \\nabla_x$.\n1753: \n1754: **Step 3: Key scaling estimate**\n1755: \n1756: By Lemma [](#lem-uniqueness-scaling-hypoelliptic-constant), the constant $C_{\\text{hypo}}$ scales as:\n1757: \n1758: $$\n1759: C_{\\text{hypo}} \\sim \\frac{1}{\\sigma_v^2 \\gamma}\n1760: \n1761: $$\n1762: \n1763: for sufficiently large $\\sigma_v^2$. This scaling is a consequence of Villani's hypocoercivity theory, which shows that the coercivity constant for the kinetic operator is proportional to the velocity diffusion coefficient.\n1764: \n1765: **Step 4: Combining Lipschitz bounds on the ball**\n1766: \n1767: For any $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$, by Lemma [](#lem-uniqueness-lipschitz-cloning-operator), we have R-dependent Lipschitz constants:\n1768: \n1769: $$\n1770: \\|S[\\rho_1] - S[\\rho_2]\\|_{L^2_w} \\le L_S(R^*) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1771: \n1772: $$\n1773: \n1774: $$\n1775: \\|B[\\rho_1, m_d[\\rho_1]] - B[\\rho_2, m_d[\\rho_2]]\\|_{L^2_w} \\le L_B(R^*) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1776: \n1777: $$\n1778: \n1779: where both $L_S(R^*)$ and $L_B(R^*)$ grow at most linearly with $R^*$:\n1780: \n1781: $$\n1782: L_S(R^*) \\le C_S(1 + R^*), \\quad L_B(R^*) \\le C_B(1 + R^*)\n1783: \n1784: $$\n1785: \n1786: for some constants $C_S, C_B > 0$ independent of $R^*$.\n1787: \n1788: Additionally, the killing term is linear with bounded coefficient:\n1789: \n1790: $$\n1791: \\|c(\\cdot)\\rho_1 - c(\\cdot)\\rho_2\\|_{L^2_w} \\le \\|c\\|_{L^\\infty} \\|\\rho_1 - \\rho_2\\|_{L^2_w} \\le L_c \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1792: \n1793: $$\n1794: \n1795: where $L_c = \\|c\\|_{L^\\infty}$ (bounded since $c$ has compact support).\n1796: \n1797: **Step 5: Verifying self-mapping**\n1798: \n1799: We must verify that $\\mathcal{T}[\\mathcal{P}_R] \\subseteq \\mathcal{P}_R$. For any $\\rho \\in \\mathcal{P}_R$, by Lemma [](#lem-uniqueness-fixed-point-boundedness):\n1800: \n1801: $$\n1802: \\|\\mathcal{T}[\\rho]\\|_{H^1_w} \\le R^*\n1803: \n1804: $$\n1805: \n1806: Therefore, $\\mathcal{T}$ maps the ball $\\mathcal{P}_R$ into itself.\n1807: \n1808: **Step 6: The R-dependent contraction constant**\n1809: \n1810: $$\n1811: \\|\\mathcal{T}[\\rho_1] - \\mathcal{T}[\\rho_2]\\|_{H^1_w} \\le C_{\\text{hypo}} (L_S(R^*) + L_B(R^*) + L_c + C) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1812: \n1813: $$\n1814: \n1815: Define the R-dependent contraction constant:\n1816: \n1817: $$\n1818: \\kappa(R^*) := C_{\\text{hypo}} (L_S(R^*) + L_B(R^*) + L_c + C)\n1819: \n1820: $$\n1821: \n1822: Using the linear growth bounds and the scaling $C_{\\text{hypo}} \\sim 1/(\\sigma_v^2 \\gamma)$:\n1823: \n1824: $$\n1825: \\kappa(R^*) \\le \\frac{C_S(1 + R^*) + C_B(1 + R^*) + L_c + C}{\\sigma_v^2 \\gamma} = \\frac{(C_S + C_B)(1 + R^*) + L_c + C}{\\sigma_v^2 \\gamma}\n1826: \n1827: $$\n1828: \n1829: **Step 7: Ensuring $\\kappa(R^*) < 1$**\n1830: \n1831: Since $R^*$ is determined by the fixed point boundedness lemma and depends on the problem parameters but not on $\\sigma_v^2$, we can ensure:\n1832: \n1833: $$\n1834: \\kappa(R^*) = \\frac{(C_S + C_B)(1 + R^*) + L_c + C}{\\sigma_v^2 \\gamma} < 1\n1835: \n1836: $$\n1837: \n1838: by choosing the kinetic perturbation strength $\\sigma_v^2$ sufficiently large:\n1839: \n1840: $$\n1841: \\sigma_v^2 > \\frac{(C_S + C_B)(1 + R^*) + L_c + C}{\\gamma}\n1842: \n1843: $$\n1844: \n1845: **Remark**: The key insight is that even though the Lipschitz constants grow with $R^*$, they grow at most linearly, while we can increase $\\sigma_v^2$ arbitrarily. Therefore, for any fixed $R^*$, we can achieve contraction by choosing sufficiently strong kinetic diffusion.\n1846: \n1847: **Physical interpretation**: Strong kinetic diffusion dominates the non-local cloning interactions, ensuring the contraction property. This provides a rigorous criterion for the algorithm's exploration-exploitation balance: **exploration must be strong enough to guarantee uniqueness of the equilibrium**.\n1848: \n1849: **Remark on hypocoercivity**: The proof demonstrates that even though the kinetic operator has no direct diffusion in position, the coupling term $v \\cdot \\nabla_x$ allows velocity diffusion to \"transfer\" regularity to position coordinates. This is the essence of **hypocoercivity** - the system is coercive (stabilizing) not because of elliptic diffusion, but through the coupled dynamics of kinetic theory.",
      "metadata": {
        "label": "proof-thm-uniqueness-contraction-solution-operator"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "1730: :::\n1731: \n1732: :::{prf:proof}\n1733: :label: proof-thm-uniqueness-contraction-solution-operator\n1734: Recall $\\mathcal{T}[\\rho] = (-\\mathcal{L}_{\\text{lin}})^{-1} (S[\\rho] + B[\\rho, m_d[\\rho]] - c(\\cdot)\\rho + C\\rho)$.\n1735: \n1736: **Step 1: Difference equation**\n1737: \n1738: $$\n1739: \\mathcal{T}[\\rho_1] - \\mathcal{T}[\\rho_2] = (-\\mathcal{L}_{\\text{lin}})^{-1} \\left[(S[\\rho_1] - S[\\rho_2]) + (B[\\rho_1, m_d[\\rho_1]] - B[\\rho_2, m_d[\\rho_2]]) - c(\\cdot)(\\rho_1 - \\rho_2) + C(\\rho_1 - \\rho_2)\\right]\n1740: \n1741: $$\n1742: \n1743: **Step 2: Hypoelliptic regularity of the inverse operator**\n1744: \n1745: By Theorem [](#thm-uniqueness-hypoelliptic-regularity), the operator $(-\\mathcal{L}_{\\text{lin}})^{-1}$ is a bounded linear operator from $L^2_w(\\Omega)$ to $H^1_w(\\Omega)$ with operator norm:\n1746: \n1747: $$\n1748: \\|(-\\mathcal{L}_{\\text{lin}})^{-1}\\|_{L^2_w \\to H^1_w} = C_{\\text{hypo}}\n1749: \n1750: $$\n1751: \n1752: **Critical note**: The kinetic operator $L^\\dagger$ is **hypoelliptic**, not elliptic. It has second-order derivatives only in velocity variables, but Hörmander's condition (Lemma [](#lem-uniqueness-hormander-verification)) ensures that smoothness propagates to position variables through the coupling term $v \\cdot \\nabla_x$.\n1753: \n1754: **Step 3: Key scaling estimate**\n1755: \n1756: By Lemma [](#lem-uniqueness-scaling-hypoelliptic-constant), the constant $C_{\\text{hypo}}$ scales as:\n1757: \n1758: $$\n1759: C_{\\text{hypo}} \\sim \\frac{1}{\\sigma_v^2 \\gamma}\n1760: \n1761: $$\n1762: \n1763: for sufficiently large $\\sigma_v^2$. This scaling is a consequence of Villani's hypocoercivity theory, which shows that the coercivity constant for the kinetic operator is proportional to the velocity diffusion coefficient.\n1764: \n1765: **Step 4: Combining Lipschitz bounds on the ball**\n1766: \n1767: For any $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$, by Lemma [](#lem-uniqueness-lipschitz-cloning-operator), we have R-dependent Lipschitz constants:\n1768: \n1769: $$\n1770: \\|S[\\rho_1] - S[\\rho_2]\\|_{L^2_w} \\le L_S(R^*) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1771: \n1772: $$\n1773: \n1774: $$\n1775: \\|B[\\rho_1, m_d[\\rho_1]] - B[\\rho_2, m_d[\\rho_2]]\\|_{L^2_w} \\le L_B(R^*) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1776: \n1777: $$\n1778: \n1779: where both $L_S(R^*)$ and $L_B(R^*)$ grow at most linearly with $R^*$:\n1780: \n1781: $$\n1782: L_S(R^*) \\le C_S(1 + R^*), \\quad L_B(R^*) \\le C_B(1 + R^*)\n1783: \n1784: $$\n1785: \n1786: for some constants $C_S, C_B > 0$ independent of $R^*$.\n1787: \n1788: Additionally, the killing term is linear with bounded coefficient:\n1789: \n1790: $$\n1791: \\|c(\\cdot)\\rho_1 - c(\\cdot)\\rho_2\\|_{L^2_w} \\le \\|c\\|_{L^\\infty} \\|\\rho_1 - \\rho_2\\|_{L^2_w} \\le L_c \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1792: \n1793: $$\n1794: \n1795: where $L_c = \\|c\\|_{L^\\infty}$ (bounded since $c$ has compact support).\n1796: \n1797: **Step 5: Verifying self-mapping**\n1798: \n1799: We must verify that $\\mathcal{T}[\\mathcal{P}_R] \\subseteq \\mathcal{P}_R$. For any $\\rho \\in \\mathcal{P}_R$, by Lemma [](#lem-uniqueness-fixed-point-boundedness):\n1800: \n1801: $$\n1802: \\|\\mathcal{T}[\\rho]\\|_{H^1_w} \\le R^*\n1803: \n1804: $$\n1805: \n1806: Therefore, $\\mathcal{T}$ maps the ball $\\mathcal{P}_R$ into itself.\n1807: \n1808: **Step 6: The R-dependent contraction constant**\n1809: \n1810: $$\n1811: \\|\\mathcal{T}[\\rho_1] - \\mathcal{T}[\\rho_2]\\|_{H^1_w} \\le C_{\\text{hypo}} (L_S(R^*) + L_B(R^*) + L_c + C) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n1812: \n1813: $$\n1814: \n1815: Define the R-dependent contraction constant:\n1816: \n1817: $$\n1818: \\kappa(R^*) := C_{\\text{hypo}} (L_S(R^*) + L_B(R^*) + L_c + C)\n1819: \n1820: $$\n1821: \n1822: Using the linear growth bounds and the scaling $C_{\\text{hypo}} \\sim 1/(\\sigma_v^2 \\gamma)$:\n1823: \n1824: $$\n1825: \\kappa(R^*) \\le \\frac{C_S(1 + R^*) + C_B(1 + R^*) + L_c + C}{\\sigma_v^2 \\gamma} = \\frac{(C_S + C_B)(1 + R^*) + L_c + C}{\\sigma_v^2 \\gamma}\n1826: \n1827: $$\n1828: \n1829: **Step 7: Ensuring $\\kappa(R^*) < 1$**\n1830: \n1831: Since $R^*$ is determined by the fixed point boundedness lemma and depends on the problem parameters but not on $\\sigma_v^2$, we can ensure:\n1832: \n1833: $$\n1834: \\kappa(R^*) = \\frac{(C_S + C_B)(1 + R^*) + L_c + C}{\\sigma_v^2 \\gamma} < 1\n1835: \n1836: $$\n1837: \n1838: by choosing the kinetic perturbation strength $\\sigma_v^2$ sufficiently large:\n1839: \n1840: $$\n1841: \\sigma_v^2 > \\frac{(C_S + C_B)(1 + R^*) + L_c + C}{\\gamma}\n1842: \n1843: $$\n1844: \n1845: **Remark**: The key insight is that even though the Lipschitz constants grow with $R^*$, they grow at most linearly, while we can increase $\\sigma_v^2$ arbitrarily. Therefore, for any fixed $R^*$, we can achieve contraction by choosing sufficiently strong kinetic diffusion.\n1846: \n1847: **Physical interpretation**: Strong kinetic diffusion dominates the non-local cloning interactions, ensuring the contraction property. This provides a rigorous criterion for the algorithm's exploration-exploitation balance: **exploration must be strong enough to guarantee uniqueness of the equilibrium**.\n1848: \n1849: **Remark on hypocoercivity**: The proof demonstrates that even though the kinetic operator has no direct diffusion in position, the coupling term $v \\cdot \\nabla_x$ allows velocity diffusion to \"transfer\" regularity to position coordinates. This is the essence of **hypocoercivity** - the system is coercive (stabilizing) not because of elliptic diffusion, but through the coupled dynamics of kinetic theory.\n1850: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-uniqueness-uniqueness-stationary-solution",
      "title": null,
      "start_line": 1865,
      "end_line": 1890,
      "header_lines": [
        1866
      ],
      "content_start": 1867,
      "content_end": 1889,
      "content": "1867: :::{prf:proof}\n1868: :label: proof-thm-uniqueness-uniqueness-stationary-solution\n1869: We apply the Banach Fixed-Point Theorem to the operator $\\mathcal{T}: \\mathcal{P}_R \\to \\mathcal{P}_R$ on the invariant ball $\\mathcal{P}_R := \\mathcal{P} \\cap \\{\\rho : \\|\\rho\\|_{H^1_w} \\le R^*\\}$.\n1870: \n1871: **Step 1: Verification of Banach Fixed-Point hypotheses**\n1872: \n1873: 1. **Completeness**: The ball $\\mathcal{P}_R$ is a closed subset of the complete space $H^1_w(\\Omega)$, hence complete.\n1874: \n1875: 2. **Self-mapping**: By Lemma [](#lem-uniqueness-fixed-point-boundedness), $\\mathcal{T}[\\mathcal{P}_R] \\subseteq \\mathcal{P}_R$. The operator also preserves the probability measure constraint by Lemma [](#lem-uniqueness-self-mapping).\n1876: \n1877: 3. **Contraction**: By Theorem [](#thm-uniqueness-contraction-solution-operator), for sufficiently large $\\sigma_v^2$, the operator $\\mathcal{T}$ is a strict contraction on $\\mathcal{P}_R$ with constant $\\kappa(R^*) < 1$.\n1878: \n1879: **Step 2: Existence and uniqueness on the ball**\n1880: \n1881: By the Banach Fixed-Point Theorem, $\\mathcal{T}$ has a unique fixed point $\\rho_0^* \\in \\mathcal{P}_R$.\n1882: \n1883: **Step 3: Global uniqueness**\n1884: \n1885: Suppose there exist two distinct stationary solutions $\\rho_1, \\rho_2 \\in \\mathcal{P}$. Both must satisfy the fixed point equation $\\mathcal{T}[\\rho_i] = \\rho_i$.\n1886: \n1887: By Lemma [](#lem-uniqueness-fixed-point-boundedness), any fixed point of $\\mathcal{T}$ satisfies $\\|\\rho_i\\|_{H^1_w} \\le R^*$, hence both $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$.\n1888: \n1889: But we have proven uniqueness of the fixed point in $\\mathcal{P}_R$, which contradicts $\\rho_1 \\neq \\rho_2$. Therefore, there is at most one stationary solution in all of $\\mathcal{P}$.",
      "metadata": {
        "label": "proof-thm-uniqueness-uniqueness-stationary-solution"
      },
      "section": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**",
      "references": [],
      "raw_directive": "1865: :::\n1866: \n1867: :::{prf:proof}\n1868: :label: proof-thm-uniqueness-uniqueness-stationary-solution\n1869: We apply the Banach Fixed-Point Theorem to the operator $\\mathcal{T}: \\mathcal{P}_R \\to \\mathcal{P}_R$ on the invariant ball $\\mathcal{P}_R := \\mathcal{P} \\cap \\{\\rho : \\|\\rho\\|_{H^1_w} \\le R^*\\}$.\n1870: \n1871: **Step 1: Verification of Banach Fixed-Point hypotheses**\n1872: \n1873: 1. **Completeness**: The ball $\\mathcal{P}_R$ is a closed subset of the complete space $H^1_w(\\Omega)$, hence complete.\n1874: \n1875: 2. **Self-mapping**: By Lemma [](#lem-uniqueness-fixed-point-boundedness), $\\mathcal{T}[\\mathcal{P}_R] \\subseteq \\mathcal{P}_R$. The operator also preserves the probability measure constraint by Lemma [](#lem-uniqueness-self-mapping).\n1876: \n1877: 3. **Contraction**: By Theorem [](#thm-uniqueness-contraction-solution-operator), for sufficiently large $\\sigma_v^2$, the operator $\\mathcal{T}$ is a strict contraction on $\\mathcal{P}_R$ with constant $\\kappa(R^*) < 1$.\n1878: \n1879: **Step 2: Existence and uniqueness on the ball**\n1880: \n1881: By the Banach Fixed-Point Theorem, $\\mathcal{T}$ has a unique fixed point $\\rho_0^* \\in \\mathcal{P}_R$.\n1882: \n1883: **Step 3: Global uniqueness**\n1884: \n1885: Suppose there exist two distinct stationary solutions $\\rho_1, \\rho_2 \\in \\mathcal{P}$. Both must satisfy the fixed point equation $\\mathcal{T}[\\rho_i] = \\rho_i$.\n1886: \n1887: By Lemma [](#lem-uniqueness-fixed-point-boundedness), any fixed point of $\\mathcal{T}$ satisfies $\\|\\rho_i\\|_{H^1_w} \\le R^*$, hence both $\\rho_1, \\rho_2 \\in \\mathcal{P}_R$.\n1888: \n1889: But we have proven uniqueness of the fixed point in $\\mathcal{P}_R$, which contradicts $\\rho_1 \\neq \\rho_2$. Therefore, there is at most one stationary solution in all of $\\mathcal{P}$.\n1890: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## **5. Uniqueness of the Weak Solution via Contraction Mapping**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-qsd-marginals-are-tight-summary",
      "title": null,
      "start_line": 1971,
      "end_line": 2005,
      "header_lines": [
        1972
      ],
      "content_start": 1973,
      "content_end": 2004,
      "content": "1973: :::{prf:proof}\n1974: :label: proof-thm-qsd-marginals-are-tight-summary\n1975: **Proof.**\n1976: \n1977: The proof proceeds by verifying the conditions of **Prokhorov's theorem**. On the Polish space $\\Omega$, a sequence of measures is tight if and only if for every $\\epsilon > 0$, there exists a single compact set $K_\\epsilon \\subset \\Omega$ such that $\\mu_N(K_\\epsilon) \\ge 1 - \\epsilon$ uniformly for all $N \\ge 2$. We establish this uniform containment by leveraging the moment bounds from the N-particle Lyapunov analysis.\n1978: \n1979: 1.  **Uniform Moment Bound from the N-Particle System:**\n1980:     The geometric ergodicity of the N-particle system, established in `06_convergence.md`, is a consequence of a Foster-Lyapunov drift condition for a Lyapunov function $V_{\\text{total}}(S)$. A standard result from the theory of Markov chains (e.g., Meyn & Tweedie, *Markov Chains and Stochastic Stability*) is that such a geometric drift condition implies the existence of uniform moment bounds for the corresponding stationary measure. Critically, because all constants in the drift inequality (`κ_total`, `C_total`) were proven to be **N-uniform**, the resulting moment bound is also independent of $N$. Specifically, there exists a finite constant $C < \\infty$ such that:\n1981:     $$\n1982:     \\mathbb{E}_{\\nu_N^{QSD}}[V_{\\text{total}}] = \\int_{\\Sigma_N} V_{\\text{total}}(S) \\, d\\nu_N^{QSD}(S) \\le C \\quad \\text{for all } N \\ge 2.\n1983:     $$\n1984: \n1985: 2.  **Translation to a Single-Particle Moment Bound:**\n1986:     The Lyapunov function $V_{\\text{total}}$ is constructed as a sum of N-normalized terms. A suitable choice of $V_{\\text{total}}$ includes a term proportional to the average squared norm of the walkers' kinematic states, e.g., $V(S) \\propto \\frac{1}{N}\\sum_{i=1}^N (\\|x_i\\|^2 + \\|v_i\\|^2)$. By the linearity of expectation and the **exchangeability** of the walkers under the symmetric measure $\\nu_N^{QSD}$, the uniform bound on the total expectation implies a uniform bound on the expected squared norm of any single walker:\n1987:     $$\n1988:     \\mathbb{E}_{\\mu_N}[\\|x\\|^2 + \\|v\\|^2] = \\int_\\Omega (\\|x\\|^2 + \\|v\\|^2) \\, d\\mu_N(x,v) \\le C'\n1989:     $$\n1990:     for some other constant $C'$ that is also independent of $N$. This demonstrates that the second moments of the measures in the sequence $\\{\\mu_N\\}$ are uniformly bounded.\n1991: \n1992: 3.  **Application of Markov's Inequality to Show Tightness:**\n1993:     With this uniform moment control, we apply **Markov's inequality**. For any $R > 0$, let $K_R = \\{ (x,v) \\in \\Omega \\mid \\|x\\|^2 + \\|v\\|^2 \\le R^2 \\}$ be a compact ball in the phase space. The probability of a particle being outside this set is:\n1994:     $$\n1995:     \\mu_N(\\Omega \\setminus K_R) = \\mathbb{P}_{z \\sim \\mu_N}(\\|x\\|^2 + \\|v\\|^2 > R^2) \\le \\frac{\\mathbb{E}_{\\mu_N}[\\|x\\|^2 + \\|v\\|^2]}{R^2} \\le \\frac{C'}{R^2}\n1996:     $$\n1997:     For any desired tolerance $\\epsilon > 0$, we can choose a radius $R_\\epsilon = \\sqrt{C'/\\epsilon}$. This choice defines a compact set $K_\\epsilon := K_{R_\\epsilon}$ for which:\n1998:     $$\n1999:     \\mu_N(K_\\epsilon) = 1 - \\mu_N(\\Omega \\setminus K_\\epsilon) \\ge 1 - \\frac{C'}{R_\\epsilon^2} = 1 - \\epsilon.\n2000:     $$\n2001:     Because the constant $C'$ is independent of $N$, our choice of the compact set $K_\\epsilon$ depends only on the tolerance $\\epsilon$ and not on $N$. This satisfies the uniform containment condition required by Prokhorov's theorem.\n2002: \n2003: 4.  **Conclusion:**\n2004:     We have shown that for any $\\epsilon > 0$, there exists a compact set $K_\\epsilon$ such that $\\mu_N(K_\\epsilon) \\ge 1 - \\epsilon$ for all measures in the sequence. By Prokhorov's theorem, this guarantees that the sequence of marginal measures $\\{\\mu_N\\}$ is tight, which implies the existence of at least one weakly convergent subsequence.",
      "metadata": {
        "label": "proof-thm-qsd-marginals-are-tight-summary"
      },
      "section": "## **6. Justification of the Mean-Field Model: Propagation of Chaos and the Thermodynamic Limit**",
      "references": [],
      "raw_directive": "1971: The sequence of single-particle marginal measures $\\{\\mu_N\\}_{N=2}^\\infty$ is tight in the space of probability measures on $\\Omega$, $\\mathcal{P}(\\Omega)$.\n1972: :::\n1973: :::{prf:proof}\n1974: :label: proof-thm-qsd-marginals-are-tight-summary\n1975: **Proof.**\n1976: \n1977: The proof proceeds by verifying the conditions of **Prokhorov's theorem**. On the Polish space $\\Omega$, a sequence of measures is tight if and only if for every $\\epsilon > 0$, there exists a single compact set $K_\\epsilon \\subset \\Omega$ such that $\\mu_N(K_\\epsilon) \\ge 1 - \\epsilon$ uniformly for all $N \\ge 2$. We establish this uniform containment by leveraging the moment bounds from the N-particle Lyapunov analysis.\n1978: \n1979: 1.  **Uniform Moment Bound from the N-Particle System:**\n1980:     The geometric ergodicity of the N-particle system, established in `06_convergence.md`, is a consequence of a Foster-Lyapunov drift condition for a Lyapunov function $V_{\\text{total}}(S)$. A standard result from the theory of Markov chains (e.g., Meyn & Tweedie, *Markov Chains and Stochastic Stability*) is that such a geometric drift condition implies the existence of uniform moment bounds for the corresponding stationary measure. Critically, because all constants in the drift inequality (`κ_total`, `C_total`) were proven to be **N-uniform**, the resulting moment bound is also independent of $N$. Specifically, there exists a finite constant $C < \\infty$ such that:\n1981:     $$\n1982:     \\mathbb{E}_{\\nu_N^{QSD}}[V_{\\text{total}}] = \\int_{\\Sigma_N} V_{\\text{total}}(S) \\, d\\nu_N^{QSD}(S) \\le C \\quad \\text{for all } N \\ge 2.\n1983:     $$\n1984: \n1985: 2.  **Translation to a Single-Particle Moment Bound:**\n1986:     The Lyapunov function $V_{\\text{total}}$ is constructed as a sum of N-normalized terms. A suitable choice of $V_{\\text{total}}$ includes a term proportional to the average squared norm of the walkers' kinematic states, e.g., $V(S) \\propto \\frac{1}{N}\\sum_{i=1}^N (\\|x_i\\|^2 + \\|v_i\\|^2)$. By the linearity of expectation and the **exchangeability** of the walkers under the symmetric measure $\\nu_N^{QSD}$, the uniform bound on the total expectation implies a uniform bound on the expected squared norm of any single walker:\n1987:     $$\n1988:     \\mathbb{E}_{\\mu_N}[\\|x\\|^2 + \\|v\\|^2] = \\int_\\Omega (\\|x\\|^2 + \\|v\\|^2) \\, d\\mu_N(x,v) \\le C'\n1989:     $$\n1990:     for some other constant $C'$ that is also independent of $N$. This demonstrates that the second moments of the measures in the sequence $\\{\\mu_N\\}$ are uniformly bounded.\n1991: \n1992: 3.  **Application of Markov's Inequality to Show Tightness:**\n1993:     With this uniform moment control, we apply **Markov's inequality**. For any $R > 0$, let $K_R = \\{ (x,v) \\in \\Omega \\mid \\|x\\|^2 + \\|v\\|^2 \\le R^2 \\}$ be a compact ball in the phase space. The probability of a particle being outside this set is:\n1994:     $$\n1995:     \\mu_N(\\Omega \\setminus K_R) = \\mathbb{P}_{z \\sim \\mu_N}(\\|x\\|^2 + \\|v\\|^2 > R^2) \\le \\frac{\\mathbb{E}_{\\mu_N}[\\|x\\|^2 + \\|v\\|^2]}{R^2} \\le \\frac{C'}{R^2}\n1996:     $$\n1997:     For any desired tolerance $\\epsilon > 0$, we can choose a radius $R_\\epsilon = \\sqrt{C'/\\epsilon}$. This choice defines a compact set $K_\\epsilon := K_{R_\\epsilon}$ for which:\n1998:     $$\n1999:     \\mu_N(K_\\epsilon) = 1 - \\mu_N(\\Omega \\setminus K_\\epsilon) \\ge 1 - \\frac{C'}{R_\\epsilon^2} = 1 - \\epsilon.\n2000:     $$\n2001:     Because the constant $C'$ is independent of $N$, our choice of the compact set $K_\\epsilon$ depends only on the tolerance $\\epsilon$ and not on $N$. This satisfies the uniform containment condition required by Prokhorov's theorem.\n2002: \n2003: 4.  **Conclusion:**\n2004:     We have shown that for any $\\epsilon > 0$, there exists a compact set $K_\\epsilon$ such that $\\mu_N(K_\\epsilon) \\ge 1 - \\epsilon$ for all measures in the sequence. By Prokhorov's theorem, this guarantees that the sequence of marginal measures $\\{\\mu_N\\}$ is tight, which implies the existence of at least one weakly convergent subsequence.\n2005: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## **6. Justification of the Mean-Field Model: Propagation of Chaos and the Thermodynamic Limit**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-limit-is-weak-solution-summary",
      "title": null,
      "start_line": 2016,
      "end_line": 2064,
      "header_lines": [
        2017
      ],
      "content_start": 2018,
      "content_end": 2063,
      "content": "2018: :::{prf:proof}\n2019: :label: proof-thm-limit-is-weak-solution-summary\n2020: **Proof.**\n2021: \n2022: A measure $\\mu_\\infty$ with density $\\rho_0$ is a weak solution to the stationary mean-field equation if, for any smooth, compactly supported test function $\\phi \\in C_c^\\infty(\\Omega)$, it satisfies $\\int_\\Omega (\\mathcal{L}_{\\text{FG}} \\phi)(z) d\\mu_\\infty(z) = 0$, where $\\mathcal{L}_{\\text{FG}}$ is the generator of the mean-field process. This is equivalent to:\n2023: \n2024: $$\n2025: \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n2026: \n2027: $$\n2028: Our proof establishes this by starting with the stationarity condition for the finite-$N_k$ system and showing that it converges to this weak formulation as $k \\to \\infty$.\n2029: \n2030: 1.  **The N-Particle Stationarity Condition:**\n2031:     For each $N_k$, the QSD $\\nu_{N_k}^{QSD}$ is stationary with respect to the N-particle generator $\\mathcal{L}_{N_k}$. For a test function $\\Phi(S) = \\phi(z_1)$ that depends only on the state of the first particle, this implies:\n2032:     $$\n2033:     \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = 0\n2034:     $$\n2035:     Decomposing the generator, we have $\\mathbb{E}_{\\nu_{N_k}}[\\mathcal{L}_{\\text{kin}, N_k} \\phi(z_1)] + \\mathbb{E}_{\\nu_{N_k}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = 0$ for all $k$.\n2036: \n2037: 2.  **Limit of the Kinetic Term:**\n2038:     The kinetic generator $\\mathcal{L}_{\\text{kin}, N_k}$ acts only on the state of particle 1. The expectation is therefore an integral against the first marginal: $\\mathbb{E}_{\\nu_{N_k}}[\\mathcal{L}_{\\text{kin}} \\phi(z_1)] = \\int_{\\Omega} (L\\phi)(z) d\\mu_{N_k}(z)$. Since $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$ and $L\\phi$ is a bounded, continuous function (as $\\phi \\in C_c^\\infty$), the integral converges:\n2039:     $$\n2040:     \\lim_{k \\to \\infty} \\int_{\\Omega} (L\\phi)(z) d\\mu_{N_k}(z) = \\int_{\\Omega} (L\\phi)(z) d\\mu_{\\infty}(z) = \\int_{\\Omega} (L^\\dagger\\rho_0)(z)\\phi(z) \\, dz\n2041:     $$\n2042: \n2043: 3.  **Limit of the Cloning Term (Propagation of Chaos):**\n2044:     This is the critical step. The cloning rate for walker 1 depends on its fitness relative to companions drawn from the *empirical measure* of the other $N_k-1$ particles. As $k \\to \\infty$, the law of large numbers for exchangeable particles (a key consequence of the Hewitt-Savage theorem) implies that this empirical measure converges weakly to the law of a single particle, which is our limit measure $\\mu_\\infty$.\n2045: \n2046:     The cloning operator for walker 1, $\\mathcal{L}_{\\text{clone}, N_k}\\phi(z_1)$, is a function of the state of walker 1 and the empirical measure of its companions, $\\mu_{N_k-1}^{\\text{comp}}$. We have already proven:\n2047:     *   The empirical companion measure converges: $\\mu_{N_k-1}^{\\text{comp}} \\rightharpoonup \\mu_\\infty$ almost surely.\n2048:     *   The functionals for moments and fitness potentials are continuous with respect to weak convergence.\n2049: \n2050:     Therefore, the N-particle cloning and boundary operators, which are continuous functions of these empirical measures, converge point-wise to the mean-field operators. By the bounded convergence theorem (justified by the uniform boundedness of the generator's action on $\\phi$), the expectation also converges:\n2051:     $$\n2052:     \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = \\int_{\\Omega} S[\\rho_0]\\phi(z) dz\n2053:     $$\n2054:     $$\n2055:     \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)] = \\int_{\\Omega} (-c(z)\\rho_0 + B[\\rho_0, m_{d,\\infty}])\\phi(z) dz\n2056:     $$\n2057: \n2058: 4.  **Conclusion:**\n2059:     Taking the limit of the entire N-particle stationarity condition, we have shown that each term converges to its mean-field counterpart. The limit measure $\\mu_\\infty$ must therefore satisfy:\n2060:     $$\n2061:     \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n2062:     $$\n2063:     This holds for any $\\phi \\in C_c^\\infty(\\Omega)$, which is the definition of a weak solution.",
      "metadata": {
        "label": "proof-thm-limit-is-weak-solution-summary"
      },
      "section": "## **6. Justification of the Mean-Field Model: Propagation of Chaos and the Thermodynamic Limit**",
      "references": [],
      "raw_directive": "2016: Let $\\{\\mu_{N_k}\\}$ be any subsequence of the marginal measures that converges weakly to a limit point $\\mu_\\infty$. Then $\\mu_\\infty$ is a weak solution to the stationary mean-field equation $L^\\dagger \\rho_0 + S[\\rho_0] + B[\\rho_0] = 0$, where $\\rho_0$ is the density of $\\mu_\\infty$.\n2017: :::\n2018: :::{prf:proof}\n2019: :label: proof-thm-limit-is-weak-solution-summary\n2020: **Proof.**\n2021: \n2022: A measure $\\mu_\\infty$ with density $\\rho_0$ is a weak solution to the stationary mean-field equation if, for any smooth, compactly supported test function $\\phi \\in C_c^\\infty(\\Omega)$, it satisfies $\\int_\\Omega (\\mathcal{L}_{\\text{FG}} \\phi)(z) d\\mu_\\infty(z) = 0$, where $\\mathcal{L}_{\\text{FG}}$ is the generator of the mean-field process. This is equivalent to:\n2023: \n2024: $$\n2025: \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n2026: \n2027: $$\n2028: Our proof establishes this by starting with the stationarity condition for the finite-$N_k$ system and showing that it converges to this weak formulation as $k \\to \\infty$.\n2029: \n2030: 1.  **The N-Particle Stationarity Condition:**\n2031:     For each $N_k$, the QSD $\\nu_{N_k}^{QSD}$ is stationary with respect to the N-particle generator $\\mathcal{L}_{N_k}$. For a test function $\\Phi(S) = \\phi(z_1)$ that depends only on the state of the first particle, this implies:\n2032:     $$\n2033:     \\mathbb{E}_{\\nu_{N_k}^{QSD}}[\\mathcal{L}_{N_k} \\phi(z_1)] = 0\n2034:     $$\n2035:     Decomposing the generator, we have $\\mathbb{E}_{\\nu_{N_k}}[\\mathcal{L}_{\\text{kin}, N_k} \\phi(z_1)] + \\mathbb{E}_{\\nu_{N_k}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = 0$ for all $k$.\n2036: \n2037: 2.  **Limit of the Kinetic Term:**\n2038:     The kinetic generator $\\mathcal{L}_{\\text{kin}, N_k}$ acts only on the state of particle 1. The expectation is therefore an integral against the first marginal: $\\mathbb{E}_{\\nu_{N_k}}[\\mathcal{L}_{\\text{kin}} \\phi(z_1)] = \\int_{\\Omega} (L\\phi)(z) d\\mu_{N_k}(z)$. Since $\\mu_{N_k} \\rightharpoonup \\mu_\\infty$ and $L\\phi$ is a bounded, continuous function (as $\\phi \\in C_c^\\infty$), the integral converges:\n2039:     $$\n2040:     \\lim_{k \\to \\infty} \\int_{\\Omega} (L\\phi)(z) d\\mu_{N_k}(z) = \\int_{\\Omega} (L\\phi)(z) d\\mu_{\\infty}(z) = \\int_{\\Omega} (L^\\dagger\\rho_0)(z)\\phi(z) \\, dz\n2041:     $$\n2042: \n2043: 3.  **Limit of the Cloning Term (Propagation of Chaos):**\n2044:     This is the critical step. The cloning rate for walker 1 depends on its fitness relative to companions drawn from the *empirical measure* of the other $N_k-1$ particles. As $k \\to \\infty$, the law of large numbers for exchangeable particles (a key consequence of the Hewitt-Savage theorem) implies that this empirical measure converges weakly to the law of a single particle, which is our limit measure $\\mu_\\infty$.\n2045: \n2046:     The cloning operator for walker 1, $\\mathcal{L}_{\\text{clone}, N_k}\\phi(z_1)$, is a function of the state of walker 1 and the empirical measure of its companions, $\\mu_{N_k-1}^{\\text{comp}}$. We have already proven:\n2047:     *   The empirical companion measure converges: $\\mu_{N_k-1}^{\\text{comp}} \\rightharpoonup \\mu_\\infty$ almost surely.\n2048:     *   The functionals for moments and fitness potentials are continuous with respect to weak convergence.\n2049: \n2050:     Therefore, the N-particle cloning and boundary operators, which are continuous functions of these empirical measures, converge point-wise to the mean-field operators. By the bounded convergence theorem (justified by the uniform boundedness of the generator's action on $\\phi$), the expectation also converges:\n2051:     $$\n2052:     \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}}[\\mathcal{L}_{\\text{clone}, N_k} \\phi(z_1)] = \\int_{\\Omega} S[\\rho_0]\\phi(z) dz\n2053:     $$\n2054:     $$\n2055:     \\lim_{k \\to \\infty} \\mathbb{E}_{\\nu_{N_k}}[\\mathcal{L}_{\\text{boundary}, N_k} \\phi(z_1)] = \\int_{\\Omega} (-c(z)\\rho_0 + B[\\rho_0, m_{d,\\infty}])\\phi(z) dz\n2056:     $$\n2057: \n2058: 4.  **Conclusion:**\n2059:     Taking the limit of the entire N-particle stationarity condition, we have shown that each term converges to its mean-field counterpart. The limit measure $\\mu_\\infty$ must therefore satisfy:\n2060:     $$\n2061:     \\int_\\Omega \\left(L^\\dagger \\rho_0(z) - c(z)\\rho_0(z) + S[\\rho_0](z) + B[\\rho_0, m_{d,\\infty}](z)\\right) \\phi(z) \\, dz = 0\n2062:     $$\n2063:     This holds for any $\\phi \\in C_c^\\infty(\\Omega)$, which is the definition of a weak solution.\n2064: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## **6. Justification of the Mean-Field Model: Propagation of Chaos and the Thermodynamic Limit**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-uniqueness-of-qsd",
      "title": null,
      "start_line": 2075,
      "end_line": 2119,
      "header_lines": [
        2076
      ],
      "content_start": 2077,
      "content_end": 2118,
      "content": "2077: :::{prf:proof}\n2078: :label: proof-thm-uniqueness-of-qsd\n2079: **Proof (via Contraction Mapping).**\n2080: \n2081: The proof strategy is to reformulate the stationary PDE as a fixed-point problem, $\\rho = \\mathcal{T}[\\rho]$, and then to prove that the solution operator $\\mathcal{T}$ is a strict contraction on a suitable complete metric space. The Banach Fixed-Point Theorem then guarantees the uniqueness of the solution.\n2082: \n2083: 1.  **The Fixed-Point Formulation:**\n2084:     The stationary equation is $0 = L^\\dagger \\rho + S[\\rho] + B[\\rho]$. We rewrite this by isolating the linear, diffusive part. Let $\\mathcal{L}_{\\text{lin}} = L^\\dagger - C \\cdot I$ for a sufficiently large constant $C > 0$ such that $-\\mathcal{L}_{\\text{lin}}$ is an invertible, coercive operator. The equation becomes $\\rho = (-\\mathcal{L}_{\\text{lin}})^{-1}(S[\\rho] + B[\\rho] + C\\rho)$. We define the solution operator as:\n2085:     $$\n2086:     \\mathcal{T}[\\rho] := (-\\mathcal{L}_{\\text{lin}})^{-1} (S[\\rho] + B[\\rho] + C\\rho)\n2087:     $$\n2088:     A stationary solution is a fixed point of $\\mathcal{T}$.\n2089: \n2090: 2.  **The Function Space:**\n2091:     We work in the weighted Sobolev space $H^1_w(\\Omega)$, a complete metric space (a Banach space) that enforces sufficient regularity on the densities. We consider the operator $\\mathcal{T}$ acting on the closed subset of probability densities, $\\mathcal{P} \\subset H^1_w(\\Omega)$.\n2092: \n2093: 3.  **Lipschitz Continuity of the Non-Linear Operators:**\n2094:     The core of the proof is to show that the non-linear operators, $S[\\rho]$ and $B[\\rho]$, are Lipschitz continuous on $\\mathcal{P}$. That is, there exist constants $L_S$ and $L_B$ such that:\n2095:     $$\n2096:     \\|S[\\rho_1] - S[\\rho_2]\\|_{H^1_w} \\le L_S \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n2097:     $$\n2098:     and similarly for $B[\\rho]$. This proof follows from the composition of the Lipschitz properties of the underlying functionals: the moment functionals and the fitness potential are Lipschitz with respect to their input densities (as proven via Sobolev embedding), and the cloning operator itself is a smooth integral operator.\n2099: \n2100: 4.  **Hypoelliptic Regularity and Boundedness of the Inverse Kinetic Operator:**\n2101:     The inverse linear operator, $(-\\mathcal{L}_{\\text{lin}})^{-1}$, is the solution operator for a kinetic Fokker-Planck equation. This operator is not elliptic but **hypoelliptic**. A key result from the theory of hypoelliptic operators (leveraging Hörmander's theorem) is that this inverse operator is a bounded map from $L^2_w(\\Omega)$ to $H^1_w(\\Omega)$. Crucially, its operator norm, $C_{\\text{hypo}} = \\|(-\\mathcal{L}_{\\text{lin}})^{-1}\\|_{L^2_w \\to H^1_w}$, scales inversely with the strength of the velocity diffusion:\n2102:     $$\n2103:     C_{\\text{hypo}} \\sim \\frac{1}{\\sigma_v^2 \\gamma}\n2104:     $$\n2105: \n2106: 5.  **The Contraction Property:**\n2107:     We now bound the distance between the images of two densities, $\\rho_1$ and $\\rho_2$, under the full solution operator:\n2108:     $$\n2109:     \\|\\mathcal{T}[\\rho_1] - \\mathcal{T}[\\rho_2]\\|_{H^1_w} \\le C_{\\text{hypo}} \\|(S[\\rho_1]-S[\\rho_2]) + (B[\\rho_1]-B[\\rho_2]) + C(\\rho_1-\\rho_2)\\|_{L^2_w}\n2110:     $$\n2111:     Applying the triangle inequality and the Lipschitz bounds for $S$ and $B$:\n2112:     $$\n2113:     \\le C_{\\text{hypo}} (L_S + L_B + C) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n2114:     $$\n2115:     The contraction constant is $\\kappa := C_{\\text{hypo}} (L_S + L_B + C) \\sim \\frac{L_S + L_B + C}{\\sigma_v^2 \\gamma}$. Since the Lipschitz constants $L_S$ and $L_B$ depend on the cloning parameters but not the kinetic diffusion $\\sigma_v^2$, we can always choose the kinetic noise `σ_v` large enough to ensure that `κ < 1`.\n2116: \n2117: 6.  **Conclusion:**\n2118:     For a sufficiently large choice of the kinetic exploration noise relative to the cloning selection pressure, the operator $\\mathcal{T}$ is a strict contraction on the complete metric space $\\mathcal{P}$. By the **Banach Fixed-Point Theorem**, $\\mathcal{T}$ has a unique fixed point. Therefore, the stationary solution to the mean-field equation is unique.",
      "metadata": {
        "label": "proof-thm-uniqueness-of-qsd"
      },
      "section": "## **6. Justification of the Mean-Field Model: Propagation of Chaos and the Thermodynamic Limit**",
      "references": [],
      "raw_directive": "2075: There is at most one probability density $\\rho \\in \\mathcal{P}(\\Omega)$ that is a weak solution to the stationary mean-field equation.\n2076: :::\n2077: :::{prf:proof}\n2078: :label: proof-thm-uniqueness-of-qsd\n2079: **Proof (via Contraction Mapping).**\n2080: \n2081: The proof strategy is to reformulate the stationary PDE as a fixed-point problem, $\\rho = \\mathcal{T}[\\rho]$, and then to prove that the solution operator $\\mathcal{T}$ is a strict contraction on a suitable complete metric space. The Banach Fixed-Point Theorem then guarantees the uniqueness of the solution.\n2082: \n2083: 1.  **The Fixed-Point Formulation:**\n2084:     The stationary equation is $0 = L^\\dagger \\rho + S[\\rho] + B[\\rho]$. We rewrite this by isolating the linear, diffusive part. Let $\\mathcal{L}_{\\text{lin}} = L^\\dagger - C \\cdot I$ for a sufficiently large constant $C > 0$ such that $-\\mathcal{L}_{\\text{lin}}$ is an invertible, coercive operator. The equation becomes $\\rho = (-\\mathcal{L}_{\\text{lin}})^{-1}(S[\\rho] + B[\\rho] + C\\rho)$. We define the solution operator as:\n2085:     $$\n2086:     \\mathcal{T}[\\rho] := (-\\mathcal{L}_{\\text{lin}})^{-1} (S[\\rho] + B[\\rho] + C\\rho)\n2087:     $$\n2088:     A stationary solution is a fixed point of $\\mathcal{T}$.\n2089: \n2090: 2.  **The Function Space:**\n2091:     We work in the weighted Sobolev space $H^1_w(\\Omega)$, a complete metric space (a Banach space) that enforces sufficient regularity on the densities. We consider the operator $\\mathcal{T}$ acting on the closed subset of probability densities, $\\mathcal{P} \\subset H^1_w(\\Omega)$.\n2092: \n2093: 3.  **Lipschitz Continuity of the Non-Linear Operators:**\n2094:     The core of the proof is to show that the non-linear operators, $S[\\rho]$ and $B[\\rho]$, are Lipschitz continuous on $\\mathcal{P}$. That is, there exist constants $L_S$ and $L_B$ such that:\n2095:     $$\n2096:     \\|S[\\rho_1] - S[\\rho_2]\\|_{H^1_w} \\le L_S \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n2097:     $$\n2098:     and similarly for $B[\\rho]$. This proof follows from the composition of the Lipschitz properties of the underlying functionals: the moment functionals and the fitness potential are Lipschitz with respect to their input densities (as proven via Sobolev embedding), and the cloning operator itself is a smooth integral operator.\n2099: \n2100: 4.  **Hypoelliptic Regularity and Boundedness of the Inverse Kinetic Operator:**\n2101:     The inverse linear operator, $(-\\mathcal{L}_{\\text{lin}})^{-1}$, is the solution operator for a kinetic Fokker-Planck equation. This operator is not elliptic but **hypoelliptic**. A key result from the theory of hypoelliptic operators (leveraging Hörmander's theorem) is that this inverse operator is a bounded map from $L^2_w(\\Omega)$ to $H^1_w(\\Omega)$. Crucially, its operator norm, $C_{\\text{hypo}} = \\|(-\\mathcal{L}_{\\text{lin}})^{-1}\\|_{L^2_w \\to H^1_w}$, scales inversely with the strength of the velocity diffusion:\n2102:     $$\n2103:     C_{\\text{hypo}} \\sim \\frac{1}{\\sigma_v^2 \\gamma}\n2104:     $$\n2105: \n2106: 5.  **The Contraction Property:**\n2107:     We now bound the distance between the images of two densities, $\\rho_1$ and $\\rho_2$, under the full solution operator:\n2108:     $$\n2109:     \\|\\mathcal{T}[\\rho_1] - \\mathcal{T}[\\rho_2]\\|_{H^1_w} \\le C_{\\text{hypo}} \\|(S[\\rho_1]-S[\\rho_2]) + (B[\\rho_1]-B[\\rho_2]) + C(\\rho_1-\\rho_2)\\|_{L^2_w}\n2110:     $$\n2111:     Applying the triangle inequality and the Lipschitz bounds for $S$ and $B$:\n2112:     $$\n2113:     \\le C_{\\text{hypo}} (L_S + L_B + C) \\|\\rho_1 - \\rho_2\\|_{H^1_w}\n2114:     $$\n2115:     The contraction constant is $\\kappa := C_{\\text{hypo}} (L_S + L_B + C) \\sim \\frac{L_S + L_B + C}{\\sigma_v^2 \\gamma}$. Since the Lipschitz constants $L_S$ and $L_B$ depend on the cloning parameters but not the kinetic diffusion $\\sigma_v^2$, we can always choose the kinetic noise `σ_v` large enough to ensure that `κ < 1`.\n2116: \n2117: 6.  **Conclusion:**\n2118:     For a sufficiently large choice of the kinetic exploration noise relative to the cloning selection pressure, the operator $\\mathcal{T}$ is a strict contraction on the complete metric space $\\mathcal{P}$. By the **Banach Fixed-Point Theorem**, $\\mathcal{T}$ has a unique fixed point. Therefore, the stationary solution to the mean-field equation is unique.\n2119: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## **6. Justification of the Mean-Field Model: Propagation of Chaos and the Thermodynamic Limit**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-thermodynamic-limit",
      "title": null,
      "start_line": 2137,
      "end_line": 2166,
      "header_lines": [
        2138
      ],
      "content_start": 2139,
      "content_end": 2165,
      "content": "2139: :::{prf:proof}\n2140: :label: proof-thm-thermodynamic-limit\n2141: **Proof.**\n2142: \n2143: The proof demonstrates that the left-hand side is equivalent to the definition of weak convergence for the sequence of first marginals.\n2144: \n2145: 1.  **Exploit Exchangeability:** As established previously, the N-particle QSD, $\\nu_N^{QSD}$, is an exchangeable measure. By the linearity of expectation and exchangeability, the expected average of the observable is equal to the expectation of the observable for any single particle:\n2146:     $$\n2147:     \\mathbb{E}_{\\nu_N^{QSD}}\\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] = \\mathbb{E}_{\\nu_N^{QSD}}[\\phi(z_1)]\n2148:     $$\n2149: \n2150: 2.  **Relate to the First Marginal:** By definition, the expectation of a function of only the first particle is given by the integral of that function against the first marginal measure, $\\mu_N$:\n2151:     $$\n2152:     \\mathbb{E}_{\\nu_N^{QSD}}[\\phi(z_1)] = \\int_\\Omega \\phi(z) d\\mu_N(z)\n2153:     $$\n2154: \n2155: 3.  **Invoke the Main Convergence Result:** The combination of Tightness ({prf:ref}`thm-qsd-marginals-are-tight`), Identification ({prf:ref}`thm-limit-is-weak-solution`), and Uniqueness ({prf:ref}`thm-uniqueness-uniqueness-stationary-solution`) proves that the entire sequence of first marginals converges weakly to the unique mean-field QSD, $\\mu_\\infty$, whose density is $\\rho_0$:\n2156:     $$\n2157:     \\mu_N \\rightharpoonup \\mu_\\infty \\quad (\\text{as } N \\to \\infty)\n2158:     $$\n2159: \n2160: 4.  **Apply the Definition of Weak Convergence:** The definition of weak convergence states that for any bounded, continuous function $\\phi$, the integrals converge:\n2161:     $$\n2162:     \\lim_{N \\to \\infty} \\int_\\Omega \\phi(z) d\\mu_N(z) = \\int_\\Omega \\phi(z) d\\mu_\\infty(z) = \\int_\\Omega \\phi(z) \\rho_0(z) dz\n2163:     $$\n2164: \n2165: 5.  **Conclusion:** By combining the steps, we have shown that the limit of the N-particle average is equal to the mean-field expectation. This completes the proof.",
      "metadata": {
        "label": "proof-thm-thermodynamic-limit"
      },
      "section": "## **6. Justification of the Mean-Field Model: Propagation of Chaos and the Thermodynamic Limit**",
      "references": [
        "thm-qsd-marginals-are-tight",
        "thm-limit-is-weak-solution",
        "thm-uniqueness-uniqueness-stationary-solution"
      ],
      "raw_directive": "2137: $$\n2138: :::\n2139: :::{prf:proof}\n2140: :label: proof-thm-thermodynamic-limit\n2141: **Proof.**\n2142: \n2143: The proof demonstrates that the left-hand side is equivalent to the definition of weak convergence for the sequence of first marginals.\n2144: \n2145: 1.  **Exploit Exchangeability:** As established previously, the N-particle QSD, $\\nu_N^{QSD}$, is an exchangeable measure. By the linearity of expectation and exchangeability, the expected average of the observable is equal to the expectation of the observable for any single particle:\n2146:     $$\n2147:     \\mathbb{E}_{\\nu_N^{QSD}}\\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] = \\mathbb{E}_{\\nu_N^{QSD}}[\\phi(z_1)]\n2148:     $$\n2149: \n2150: 2.  **Relate to the First Marginal:** By definition, the expectation of a function of only the first particle is given by the integral of that function against the first marginal measure, $\\mu_N$:\n2151:     $$\n2152:     \\mathbb{E}_{\\nu_N^{QSD}}[\\phi(z_1)] = \\int_\\Omega \\phi(z) d\\mu_N(z)\n2153:     $$\n2154: \n2155: 3.  **Invoke the Main Convergence Result:** The combination of Tightness ({prf:ref}`thm-qsd-marginals-are-tight`), Identification ({prf:ref}`thm-limit-is-weak-solution`), and Uniqueness ({prf:ref}`thm-uniqueness-uniqueness-stationary-solution`) proves that the entire sequence of first marginals converges weakly to the unique mean-field QSD, $\\mu_\\infty$, whose density is $\\rho_0$:\n2156:     $$\n2157:     \\mu_N \\rightharpoonup \\mu_\\infty \\quad (\\text{as } N \\to \\infty)\n2158:     $$\n2159: \n2160: 4.  **Apply the Definition of Weak Convergence:** The definition of weak convergence states that for any bounded, continuous function $\\phi$, the integrals converge:\n2161:     $$\n2162:     \\lim_{N \\to \\infty} \\int_\\Omega \\phi(z) d\\mu_N(z) = \\int_\\Omega \\phi(z) d\\mu_\\infty(z) = \\int_\\Omega \\phi(z) \\rho_0(z) dz\n2163:     $$\n2164: \n2165: 5.  **Conclusion:** By combining the steps, we have shown that the limit of the N-particle average is equal to the mean-field expectation. This completes the proof.\n2166: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## **6. Justification of the Mean-Field Model: Propagation of Chaos and the Thermodynamic Limit**"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-cor-w2-convergence-thermodynamic-limit",
      "title": null,
      "start_line": 2181,
      "end_line": 2235,
      "header_lines": [
        2182
      ],
      "content_start": 2183,
      "content_end": 2234,
      "content": "2183: :::{prf:proof}\n2184: :label: proof-cor-w2-convergence-thermodynamic-limit\n2185: **Proof.**\n2186: \n2187: The upgrade from weak convergence to W2 convergence follows from a standard metrization theorem in optimal transport theory, given that we have uniform control of second moments.\n2188: \n2189: **Step 1: Uniform Second Moment Control**\n2190: \n2191: By Theorem [](#thm-qsd-marginals-are-tight), the tightness proof established that there exists a constant $C' < \\infty$ independent of $N$ such that:\n2192: \n2193: $$\n2194: \\sup_{N \\ge 2} \\mathbb{E}_{\\mu_N}[\\|z\\|^2] = \\sup_{N \\ge 2} \\int_\\Omega (\\|x\\|^2 + \\|v\\|^2) \\, d\\mu_N(x,v) \\le C'\n2195: \n2196: $$\n2197: \n2198: This uniform bound on second moments is a direct consequence of the N-uniform Foster-Lyapunov analysis in `06_convergence.md`.\n2199: \n2200: **Step 2: Weak Convergence**\n2201: \n2202: The main result of Section 5 (combining Theorems 5.2, 5.4, and 5.5) established that:\n2203: \n2204: $$\n2205: \\mu_N \\rightharpoonup \\mu_\\infty \\quad \\text{as } N \\to \\infty\n2206: \n2207: $$\n2208: \n2209: **Step 3: Apply the Metrization Theorem**\n2210: \n2211: With both weak convergence and uniform second moments established, we can invoke the following classical result from optimal transport theory:\n2212: \n2213: **Theorem (Villani, *Optimal Transport: Old and New*, Theorem 6.9):** Let $\\{\\nu_n\\}$ be a sequence of probability measures on a Polish space $\\mathcal{X}$ with a reference point $x_0 \\in \\mathcal{X}$. If:\n2214: 1. $\\nu_n \\rightharpoonup \\nu$ (weak convergence)\n2215: 2. $\\sup_n \\int d(x, x_0)^2 d\\nu_n(x) < \\infty$ (uniform second moments)\n2216: \n2217: Then $W_2(\\nu_n, \\nu) \\to 0$.\n2218: \n2219: **Application:** Our sequence $\\{\\mu_N\\}$ satisfies both hypotheses on the Polish space $\\Omega = \\mathcal{X}_{\\text{valid}} \\times \\mathbb{R}^d$ with the Euclidean metric. Therefore, by Villani's theorem:\n2220: \n2221: $$\n2222: \\lim_{N \\to \\infty} W_2(\\mu_N, \\mu_\\infty) = 0\n2223: \n2224: $$\n2225: \n2226: **Step 4: Physical Interpretation**\n2227: \n2228: The W2 metric has a natural physical interpretation as the minimal \"cost\" of transporting one probability distribution to another, where cost is measured by squared Euclidean distance. The W2 convergence result implies that:\n2229: \n2230: 1. **Position convergence**: The spatial distribution of the swarm converges in a strong sense\n2231: 2. **Velocity convergence**: The velocity distribution also converges strongly\n2232: 3. **Joint convergence**: The phase-space structure of the empirical measure converges to the mean-field prediction\n2233: \n2234: This is a stronger statement than weak convergence, which only guarantees convergence of expectations of bounded continuous functions. W2 convergence implies convergence of second moments and provides quantitative control over the distance between distributions.",
      "metadata": {
        "label": "proof-cor-w2-convergence-thermodynamic-limit"
      },
      "section": "## **6. Justification of the Mean-Field Model: Propagation of Chaos and the Thermodynamic Limit**",
      "references": [],
      "raw_directive": "2181: :::\n2182: \n2183: :::{prf:proof}\n2184: :label: proof-cor-w2-convergence-thermodynamic-limit\n2185: **Proof.**\n2186: \n2187: The upgrade from weak convergence to W2 convergence follows from a standard metrization theorem in optimal transport theory, given that we have uniform control of second moments.\n2188: \n2189: **Step 1: Uniform Second Moment Control**\n2190: \n2191: By Theorem [](#thm-qsd-marginals-are-tight), the tightness proof established that there exists a constant $C' < \\infty$ independent of $N$ such that:\n2192: \n2193: $$\n2194: \\sup_{N \\ge 2} \\mathbb{E}_{\\mu_N}[\\|z\\|^2] = \\sup_{N \\ge 2} \\int_\\Omega (\\|x\\|^2 + \\|v\\|^2) \\, d\\mu_N(x,v) \\le C'\n2195: \n2196: $$\n2197: \n2198: This uniform bound on second moments is a direct consequence of the N-uniform Foster-Lyapunov analysis in `06_convergence.md`.\n2199: \n2200: **Step 2: Weak Convergence**\n2201: \n2202: The main result of Section 5 (combining Theorems 5.2, 5.4, and 5.5) established that:\n2203: \n2204: $$\n2205: \\mu_N \\rightharpoonup \\mu_\\infty \\quad \\text{as } N \\to \\infty\n2206: \n2207: $$\n2208: \n2209: **Step 3: Apply the Metrization Theorem**\n2210: \n2211: With both weak convergence and uniform second moments established, we can invoke the following classical result from optimal transport theory:\n2212: \n2213: **Theorem (Villani, *Optimal Transport: Old and New*, Theorem 6.9):** Let $\\{\\nu_n\\}$ be a sequence of probability measures on a Polish space $\\mathcal{X}$ with a reference point $x_0 \\in \\mathcal{X}$. If:\n2214: 1. $\\nu_n \\rightharpoonup \\nu$ (weak convergence)\n2215: 2. $\\sup_n \\int d(x, x_0)^2 d\\nu_n(x) < \\infty$ (uniform second moments)\n2216: \n2217: Then $W_2(\\nu_n, \\nu) \\to 0$.\n2218: \n2219: **Application:** Our sequence $\\{\\mu_N\\}$ satisfies both hypotheses on the Polish space $\\Omega = \\mathcal{X}_{\\text{valid}} \\times \\mathbb{R}^d$ with the Euclidean metric. Therefore, by Villani's theorem:\n2220: \n2221: $$\n2222: \\lim_{N \\to \\infty} W_2(\\mu_N, \\mu_\\infty) = 0\n2223: \n2224: $$\n2225: \n2226: **Step 4: Physical Interpretation**\n2227: \n2228: The W2 metric has a natural physical interpretation as the minimal \"cost\" of transporting one probability distribution to another, where cost is measured by squared Euclidean distance. The W2 convergence result implies that:\n2229: \n2230: 1. **Position convergence**: The spatial distribution of the swarm converges in a strong sense\n2231: 2. **Velocity convergence**: The velocity distribution also converges strongly\n2232: 3. **Joint convergence**: The phase-space structure of the empirical measure converges to the mean-field prediction\n2233: \n2234: This is a stronger statement than weak convergence, which only guarantees convergence of expectations of bounded continuous functions. W2 convergence implies convergence of second moments and provides quantitative control over the distance between distributions.\n2235: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "08_propagation_chaos",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## **6. Justification of the Mean-Field Model: Propagation of Chaos and the Thermodynamic Limit**"
      }
    }
  ]
}