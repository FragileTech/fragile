{
  "chapter_index": 85,
  "section_id": "## Part 3: Dobrushin Contraction for the Full Dynamics",
  "directive_count": 7,
  "hints": [
    {
      "directive_type": "definition",
      "label": "def-status-metric",
      "title": "Discrete Status-Change Metric",
      "start_line": 5905,
      "end_line": 5921,
      "header_lines": [
        5906
      ],
      "content_start": 5908,
      "content_end": 5920,
      "content": "5908: :label: def-status-metric\n5909: \n5910: For two swarm states $\\mathcal{S}_1, \\mathcal{S}_2$ with the same number of walkers $N$, define:\n5911: \n5912: $$\n5913: d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) := n_c(\\mathcal{S}_1, \\mathcal{S}_2)\n5914: $$\n5915: \n5916: where $n_c$ is the **number of status changes**: the number of walker indices $i$ where walker $i$ has different alive/dead status in the two swarms.\n5917: \n5918: Equivalently, if $\\mathbf{s}_1, \\mathbf{s}_2 \\in \\{\\text{alive}, \\text{dead}\\}^N$ are the status vectors:\n5919: \n5920: $$",
      "metadata": {
        "label": "def-status-metric"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "raw_directive": "5905: ### 3.2. The Discrete Status-Change Metric\n5906: \n5907: :::{prf:definition} Discrete Status-Change Metric\n5908: :label: def-status-metric\n5909: \n5910: For two swarm states $\\mathcal{S}_1, \\mathcal{S}_2$ with the same number of walkers $N$, define:\n5911: \n5912: $$\n5913: d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) := n_c(\\mathcal{S}_1, \\mathcal{S}_2)\n5914: $$\n5915: \n5916: where $n_c$ is the **number of status changes**: the number of walker indices $i$ where walker $i$ has different alive/dead status in the two swarms.\n5917: \n5918: Equivalently, if $\\mathbf{s}_1, \\mathbf{s}_2 \\in \\{\\text{alive}, \\text{dead}\\}^N$ are the status vectors:\n5919: \n5920: $$\n5921: d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) = \\|\\mathbf{s}_1 - \\mathbf{s}_2\\|_0 = \\sum_{i=1}^N \\mathbb{1}[\\mathbf{s}_{1,i} \\neq \\mathbf{s}_{2,i}]"
    },
    {
      "directive_type": "lemma",
      "label": "lem-softmax-lipschitz-status",
      "title": "Lipschitz Continuity of Softmax-Weighted Companion Selection",
      "start_line": 5942,
      "end_line": 5954,
      "header_lines": [
        5943
      ],
      "content_start": 5945,
      "content_end": 5953,
      "content": "5945: :label: lem-softmax-lipschitz-status\n5946: \n5947: Let $\\mathcal{S}_1, \\mathcal{S}_2$ be two swarms with $d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) = n_c$ status changes. For a walker $i$ alive in both swarms, let $\\text{Comp}_i^{(1)}, \\text{Comp}_i^{(2)}$ be the probability distributions over companions selected by the Sequential Stochastic Greedy Pairing algorithm in each swarm.\n5948: \n5949: For any bounded function $f: \\mathcal{X} \\times \\mathcal{V} \\to \\mathbb{R}$ with $|f| \\leq M_f$, the expected value under the softmax-weighted companion selection satisfies:\n5950: \n5951: $$\n5952: |\\mathbb{E}_{j \\sim \\text{Comp}_i^{(1)}}[f(x_j, v_j)] - \\mathbb{E}_{j \\sim \\text{Comp}_i^{(2)}}[f(x_j, v_j)]| \\leq C_{\\text{softmax}} \\cdot \\frac{M_f \\cdot n_c}{k}\n5953: $$",
      "metadata": {
        "label": "lem-softmax-lipschitz-status"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "raw_directive": "5942: The framework's Theorem {prf:ref}`thm-total-error-status-bound` in [01_fragile_gas_framework](../01_fragile_gas_framework.md) proves Lipschitz continuity for **uniform random companion selection**. However, the greedy pairing uses **softmax-weighted selection** based on algorithmic distance, so we must extend the proof to this case.\n5943: \n5944: :::{prf:lemma} Lipschitz Continuity of Softmax-Weighted Companion Selection\n5945: :label: lem-softmax-lipschitz-status\n5946: \n5947: Let $\\mathcal{S}_1, \\mathcal{S}_2$ be two swarms with $d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) = n_c$ status changes. For a walker $i$ alive in both swarms, let $\\text{Comp}_i^{(1)}, \\text{Comp}_i^{(2)}$ be the probability distributions over companions selected by the Sequential Stochastic Greedy Pairing algorithm in each swarm.\n5948: \n5949: For any bounded function $f: \\mathcal{X} \\times \\mathcal{V} \\to \\mathbb{R}$ with $|f| \\leq M_f$, the expected value under the softmax-weighted companion selection satisfies:\n5950: \n5951: $$\n5952: |\\mathbb{E}_{j \\sim \\text{Comp}_i^{(1)}}[f(x_j, v_j)] - \\mathbb{E}_{j \\sim \\text{Comp}_i^{(2)}}[f(x_j, v_j)]| \\leq C_{\\text{softmax}} \\cdot \\frac{M_f \\cdot n_c}{k}\n5953: $$\n5954: "
    },
    {
      "directive_type": "proof",
      "label": "proof-softmax-lipschitz-status",
      "title": null,
      "start_line": 5956,
      "end_line": 6065,
      "header_lines": [
        5957
      ],
      "content_start": 5959,
      "content_end": 6064,
      "content": "5959: :label: proof-softmax-lipschitz-status\n5960: \n5961: **Strategy**: We directly bound the difference between softmax expectations by decomposing based on common vs. differing companions.\n5962: \n5963: **Step 1: Setup and notation**\n5964: \n5965: For walker $i$ in swarm $\\mathcal{S}_s$ (where $s \\in \\{1,2\\}$), let:\n5966: - $U_s$ = set of available companions at the time $i$ is processed\n5967: - $w_{ij} = \\exp(-d_{\\text{alg}}(i, j)^2 / 2\\epsilon_d^2)$ = weight for companion $j$ (note: this is the **same** for any $j$ present in both swarms)\n5968: - $Z_s = \\sum_{l \\in U_s} w_{il}$ = normalization constant\n5969: - $P_s(j) = w_{ij} / Z_s$ = probability of selecting companion $j$\n5970: \n5971: The expected values are:\n5972: \n5973: $$\n5974: \\mathbb{E}^{(s)}[f] = \\sum_{j \\in U_s} P_s(j) f(j) = \\sum_{j \\in U_s} \\frac{w_{ij}}{Z_s} f(j)\n5975: $$\n5976: \n5977: **Step 2: Decompose by common and differing companions**\n5978: \n5979: Let $U_c = U_1 \\cap U_2$ be the set of common companions, and $U_1 \\setminus U_c$, $U_2 \\setminus U_c$ be the companions present in only one swarm.\n5980: \n5981: $$\n5982: \\begin{align}\n5983: \\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f] &= \\sum_{j \\in U_c} (P_1(j) - P_2(j)) f(j) \\\\\n5984: &\\quad + \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) - \\sum_{j \\in U_2 \\setminus U_c} P_2(j) f(j)\n5985: \\end{align}\n5986: $$\n5987: \n5988: **Step 3: Bound the common companion term**\n5989: \n5990: For $j \\in U_c$, the difference in probabilities arises from different normalization constants:\n5991: \n5992: $$\n5993: |P_1(j) - P_2(j)| = w_{ij} \\left| \\frac{1}{Z_1} - \\frac{1}{Z_2} \\right| = w_{ij} \\frac{|Z_2 - Z_1|}{Z_1 Z_2}\n5994: $$\n5995: \n5996: **Bound on $|Z_2 - Z_1|$**: The difference in normalization is driven by the companions that differ:\n5997: \n5998: $$\n5999: |Z_2 - Z_1| = \\left| \\sum_{l \\in U_2 \\setminus U_c} w_{il} - \\sum_{l \\in U_1 \\setminus U_c} w_{il} \\right| \\leq \\sum_{l \\in U_1 \\triangle U_2} w_{il}\n6000: $$\n6001: \n6002: Since there are at most $n_c$ status changes, $|U_1 \\triangle U_2| \\leq n_c$. Using $w_{il} \\leq w_{\\max} = 1$:\n6003: \n6004: $$\n6005: |Z_2 - Z_1| \\leq n_c \\cdot w_{\\max} = n_c\n6006: $$\n6007: \n6008: **Bound on normalization denominators**: The normalization constants are bounded below by the sum over common companions:\n6009: \n6010: $$\n6011: Z_s \\geq \\sum_{l \\in U_c} w_{il} \\geq |U_c| \\cdot w_{\\min}\n6012: $$\n6013: \n6014: where $w_{\\min} = \\exp(-D_{\\max}^2 / 2\\epsilon_d^2)$ is the minimum possible weight. Since $|U_c| \\geq k - n_c$ (at least $k$ alive walkers, at most $n_c$ differ):\n6015: \n6016: $$\n6017: Z_s \\geq (k - n_c) \\cdot w_{\\min}\n6018: $$\n6019: \n6020: **Combining**: For each $j \\in U_c$:\n6021: \n6022: $$\n6023: |P_1(j) - P_2(j)| \\leq \\frac{w_{\\max} \\cdot n_c}{(k - n_c)^2 \\cdot w_{\\min}^2} \\leq \\frac{n_c}{(k - n_c)^2 \\cdot w_{\\min}^2}\n6024: $$\n6025: \n6026: For $n_c \\ll k$, this is $O(n_c / k^2)$. Summing over the $\\approx k$ common companions:\n6027: \n6028: $$\n6029: \\left| \\sum_{j \\in U_c} (P_1(j) - P_2(j)) f(j) \\right| \\leq M_f \\cdot k \\cdot \\frac{n_c}{k^2 \\cdot w_{\\min}^2} = \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}^2}\n6030: $$\n6031: \n6032: **Step 4: Bound the differing companion terms**\n6033: \n6034: The sets $U_1 \\setminus U_c$ and $U_2 \\setminus U_c$ each contain at most $n_c$ walkers (those whose status differs). For each term:\n6035: \n6036: $$\n6037: \\left| \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) \\right| \\leq M_f \\cdot \\sum_{j \\in U_1 \\setminus U_c} P_1(j)\n6038: $$\n6039: \n6040: Since $P_1(j) = w_{ij} / Z_1 \\leq w_{\\max} / (k \\cdot w_{\\min}) = 1 / (k \\cdot w_{\\min})$ and there are at most $n_c$ such terms:\n6041: \n6042: $$\n6043: \\left| \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) \\right| \\leq M_f \\cdot n_c \\cdot \\frac{1}{k \\cdot w_{\\min}} = \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}}\n6044: $$\n6045: \n6046: Similarly for the $U_2 \\setminus U_c$ term.\n6047: \n6048: **Step 5: Combine all bounds**\n6049: \n6050: $$\n6051: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}^2} + \\frac{2 M_f \\cdot n_c}{k \\cdot w_{\\min}}\n6052: $$\n6053: \n6054: Factoring:\n6055: \n6056: $$\n6057: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq \\frac{M_f \\cdot n_c}{k} \\cdot \\left( \\frac{1}{w_{\\min}^2} + \\frac{2}{w_{\\min}} \\right)\n6058: $$\n6059: \n6060: Since $w_{\\min} = \\exp(-D_{\\max}^2 / 2\\epsilon_d^2) = O(1)$ is a fixed constant (depends only on state space diameter and interaction range), we can write:\n6061: \n6062: $$\n6063: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq C_{\\text{softmax}} \\cdot \\frac{M_f \\cdot n_c}{k}\n6064: $$",
      "metadata": {
        "label": "proof-softmax-lipschitz-status"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "raw_directive": "5956: :::\n5957: \n5958: :::{prf:proof}\n5959: :label: proof-softmax-lipschitz-status\n5960: \n5961: **Strategy**: We directly bound the difference between softmax expectations by decomposing based on common vs. differing companions.\n5962: \n5963: **Step 1: Setup and notation**\n5964: \n5965: For walker $i$ in swarm $\\mathcal{S}_s$ (where $s \\in \\{1,2\\}$), let:\n5966: - $U_s$ = set of available companions at the time $i$ is processed\n5967: - $w_{ij} = \\exp(-d_{\\text{alg}}(i, j)^2 / 2\\epsilon_d^2)$ = weight for companion $j$ (note: this is the **same** for any $j$ present in both swarms)\n5968: - $Z_s = \\sum_{l \\in U_s} w_{il}$ = normalization constant\n5969: - $P_s(j) = w_{ij} / Z_s$ = probability of selecting companion $j$\n5970: \n5971: The expected values are:\n5972: \n5973: $$\n5974: \\mathbb{E}^{(s)}[f] = \\sum_{j \\in U_s} P_s(j) f(j) = \\sum_{j \\in U_s} \\frac{w_{ij}}{Z_s} f(j)\n5975: $$\n5976: \n5977: **Step 2: Decompose by common and differing companions**\n5978: \n5979: Let $U_c = U_1 \\cap U_2$ be the set of common companions, and $U_1 \\setminus U_c$, $U_2 \\setminus U_c$ be the companions present in only one swarm.\n5980: \n5981: $$\n5982: \\begin{align}\n5983: \\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f] &= \\sum_{j \\in U_c} (P_1(j) - P_2(j)) f(j) \\\\\n5984: &\\quad + \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) - \\sum_{j \\in U_2 \\setminus U_c} P_2(j) f(j)\n5985: \\end{align}\n5986: $$\n5987: \n5988: **Step 3: Bound the common companion term**\n5989: \n5990: For $j \\in U_c$, the difference in probabilities arises from different normalization constants:\n5991: \n5992: $$\n5993: |P_1(j) - P_2(j)| = w_{ij} \\left| \\frac{1}{Z_1} - \\frac{1}{Z_2} \\right| = w_{ij} \\frac{|Z_2 - Z_1|}{Z_1 Z_2}\n5994: $$\n5995: \n5996: **Bound on $|Z_2 - Z_1|$**: The difference in normalization is driven by the companions that differ:\n5997: \n5998: $$\n5999: |Z_2 - Z_1| = \\left| \\sum_{l \\in U_2 \\setminus U_c} w_{il} - \\sum_{l \\in U_1 \\setminus U_c} w_{il} \\right| \\leq \\sum_{l \\in U_1 \\triangle U_2} w_{il}\n6000: $$\n6001: \n6002: Since there are at most $n_c$ status changes, $|U_1 \\triangle U_2| \\leq n_c$. Using $w_{il} \\leq w_{\\max} = 1$:\n6003: \n6004: $$\n6005: |Z_2 - Z_1| \\leq n_c \\cdot w_{\\max} = n_c\n6006: $$\n6007: \n6008: **Bound on normalization denominators**: The normalization constants are bounded below by the sum over common companions:\n6009: \n6010: $$\n6011: Z_s \\geq \\sum_{l \\in U_c} w_{il} \\geq |U_c| \\cdot w_{\\min}\n6012: $$\n6013: \n6014: where $w_{\\min} = \\exp(-D_{\\max}^2 / 2\\epsilon_d^2)$ is the minimum possible weight. Since $|U_c| \\geq k - n_c$ (at least $k$ alive walkers, at most $n_c$ differ):\n6015: \n6016: $$\n6017: Z_s \\geq (k - n_c) \\cdot w_{\\min}\n6018: $$\n6019: \n6020: **Combining**: For each $j \\in U_c$:\n6021: \n6022: $$\n6023: |P_1(j) - P_2(j)| \\leq \\frac{w_{\\max} \\cdot n_c}{(k - n_c)^2 \\cdot w_{\\min}^2} \\leq \\frac{n_c}{(k - n_c)^2 \\cdot w_{\\min}^2}\n6024: $$\n6025: \n6026: For $n_c \\ll k$, this is $O(n_c / k^2)$. Summing over the $\\approx k$ common companions:\n6027: \n6028: $$\n6029: \\left| \\sum_{j \\in U_c} (P_1(j) - P_2(j)) f(j) \\right| \\leq M_f \\cdot k \\cdot \\frac{n_c}{k^2 \\cdot w_{\\min}^2} = \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}^2}\n6030: $$\n6031: \n6032: **Step 4: Bound the differing companion terms**\n6033: \n6034: The sets $U_1 \\setminus U_c$ and $U_2 \\setminus U_c$ each contain at most $n_c$ walkers (those whose status differs). For each term:\n6035: \n6036: $$\n6037: \\left| \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) \\right| \\leq M_f \\cdot \\sum_{j \\in U_1 \\setminus U_c} P_1(j)\n6038: $$\n6039: \n6040: Since $P_1(j) = w_{ij} / Z_1 \\leq w_{\\max} / (k \\cdot w_{\\min}) = 1 / (k \\cdot w_{\\min})$ and there are at most $n_c$ such terms:\n6041: \n6042: $$\n6043: \\left| \\sum_{j \\in U_1 \\setminus U_c} P_1(j) f(j) \\right| \\leq M_f \\cdot n_c \\cdot \\frac{1}{k \\cdot w_{\\min}} = \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}}\n6044: $$\n6045: \n6046: Similarly for the $U_2 \\setminus U_c$ term.\n6047: \n6048: **Step 5: Combine all bounds**\n6049: \n6050: $$\n6051: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq \\frac{M_f \\cdot n_c}{k \\cdot w_{\\min}^2} + \\frac{2 M_f \\cdot n_c}{k \\cdot w_{\\min}}\n6052: $$\n6053: \n6054: Factoring:\n6055: \n6056: $$\n6057: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq \\frac{M_f \\cdot n_c}{k} \\cdot \\left( \\frac{1}{w_{\\min}^2} + \\frac{2}{w_{\\min}} \\right)\n6058: $$\n6059: \n6060: Since $w_{\\min} = \\exp(-D_{\\max}^2 / 2\\epsilon_d^2) = O(1)$ is a fixed constant (depends only on state space diameter and interaction range), we can write:\n6061: \n6062: $$\n6063: |\\mathbb{E}^{(1)}[f] - \\mathbb{E}^{(2)}[f]| \\leq C_{\\text{softmax}} \\cdot \\frac{M_f \\cdot n_c}{k}\n6064: $$\n6065: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-dobrushin-contraction",
      "title": "Dobrushin Contraction for Euclidean Gas",
      "start_line": 6081,
      "end_line": 6105,
      "header_lines": [
        6082
      ],
      "content_start": 6084,
      "content_end": 6104,
      "content": "6084: :label: thm-dobrushin-contraction\n6085: \n6086: Let $\\Psi_{\\text{EG}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ be the one-step Euclidean Gas operator (cloning followed by kinetic evolution). Assume:\n6087: \n6088: 1. **Confining potential**: $U$ satisfies Axiom {prf:ref}`axiom-confining-complete`\n6089: 2. **Hypocoercivity**: The kinetic operator has LSI constant $\\lambda_{\\text{hypo}} = c \\cdot \\min(\\gamma, \\alpha_U/\\sigma_v^2)$ (Proposition {prf:ref}`prop-hypocoercivity-piecewise`)\n6090: 3. **Non-degeneracy**: The alive set has size $k \\geq k_{\\min} \\geq 2$ with positive probability\n6091: \n6092: Then there exists a **contraction coefficient** $\\gamma < 1$ and constant $K$ such that for any two swarms $\\mathcal{S}_1, \\mathcal{S}_2$ with at least $k_{\\min}$ alive walkers:\n6093: \n6094: $$\n6095: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2) \\mid \\mathcal{S}_1, \\mathcal{S}_2] \\leq \\gamma \\cdot d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) + K\n6096: $$\n6097: \n6098: where $\\mathcal{S}'_1, \\mathcal{S}'_2$ are the swarms after one step under a **synchronous coupling** (using identical random numbers for both evolutions).\n6099: \n6100: The contraction coefficient satisfies:\n6101: \n6102: $$\n6103: \\gamma = (1 - \\lambda_{\\text{clone}} \\cdot \\tau) \\cdot (1 + O(\\tau \\cdot \\lambda_{\\text{hypo}}))\n6104: $$",
      "metadata": {
        "label": "thm-dobrushin-contraction"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "raw_directive": "6081: The core idea: prove that one step of the Euclidean Gas dynamics brings two swarms **closer together** in expectation, with respect to $d_{\\text{status}}$.\n6082: \n6083: :::{prf:theorem} Dobrushin Contraction for Euclidean Gas\n6084: :label: thm-dobrushin-contraction\n6085: \n6086: Let $\\Psi_{\\text{EG}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ be the one-step Euclidean Gas operator (cloning followed by kinetic evolution). Assume:\n6087: \n6088: 1. **Confining potential**: $U$ satisfies Axiom {prf:ref}`axiom-confining-complete`\n6089: 2. **Hypocoercivity**: The kinetic operator has LSI constant $\\lambda_{\\text{hypo}} = c \\cdot \\min(\\gamma, \\alpha_U/\\sigma_v^2)$ (Proposition {prf:ref}`prop-hypocoercivity-piecewise`)\n6090: 3. **Non-degeneracy**: The alive set has size $k \\geq k_{\\min} \\geq 2$ with positive probability\n6091: \n6092: Then there exists a **contraction coefficient** $\\gamma < 1$ and constant $K$ such that for any two swarms $\\mathcal{S}_1, \\mathcal{S}_2$ with at least $k_{\\min}$ alive walkers:\n6093: \n6094: $$\n6095: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2) \\mid \\mathcal{S}_1, \\mathcal{S}_2] \\leq \\gamma \\cdot d_{\\text{status}}(\\mathcal{S}_1, \\mathcal{S}_2) + K\n6096: $$\n6097: \n6098: where $\\mathcal{S}'_1, \\mathcal{S}'_2$ are the swarms after one step under a **synchronous coupling** (using identical random numbers for both evolutions).\n6099: \n6100: The contraction coefficient satisfies:\n6101: \n6102: $$\n6103: \\gamma = (1 - \\lambda_{\\text{clone}} \\cdot \\tau) \\cdot (1 + O(\\tau \\cdot \\lambda_{\\text{hypo}}))\n6104: $$\n6105: "
    },
    {
      "directive_type": "proof",
      "label": "proof-dobrushin-contraction",
      "title": null,
      "start_line": 6107,
      "end_line": 6232,
      "header_lines": [
        6108
      ],
      "content_start": 6110,
      "content_end": 6231,
      "content": "6110: :label: proof-dobrushin-contraction\n6111: \n6112: The proof proceeds in four steps:\n6113: \n6114: **Step 1: Synchronous coupling construction**\n6115: \n6116: Given two initial swarms $\\mathcal{S}_1, \\mathcal{S}_2$, we construct a **maximal coupling** that uses identical random numbers whenever possible:\n6117: \n6118: 1. **For cloning**:\n6119:    - Use the same companion pairing algorithm random seed\n6120:    - For walker $i$: if alive in both swarms, use same threshold $T_i$ for cloning decision\n6121:    - If walker $i$ clones in both swarms, use same Gaussian jitter $\\zeta_i$ for position perturbation\n6122: \n6123: 2. **For kinetic evolution**:\n6124:    - For walker $i$: if alive in both swarms, use same Langevin noise realizations $\\xi_i^{(x)}, \\xi_i^{(v)}$\n6125: \n6126: This coupling **preserves status matches**: if walker $i$ has the same status in $\\mathcal{S}_1, \\mathcal{S}_2$, and makes the same cloning decision, it will have the same status in $\\mathcal{S}'_1, \\mathcal{S}'_2$.\n6127: \n6128: **Step 2: Bound on cloning-induced status changes**\n6129: \n6130: By the synchronous coupling, status differences after cloning can only arise from:\n6131: \n6132: **A. Walkers that already differed** ($n_c$ walkers):\n6133: - These remain different after cloning\n6134: - Contribution: at most $n_c$ differences\n6135: \n6136: **B. Walkers that matched initially but made different cloning decisions**:\n6137: \n6138: For a walker $i$ that is alive in both swarms, the cloning decision differs if the fitness differs. By Lemma {prf:ref}`lem-softmax-lipschitz-status` (extending Theorem {prf:ref}`thm-total-error-status-bound` to softmax-weighted companion selection):\n6139: \n6140: $$\n6141: |P(\\text{clone in } \\mathcal{S}_1) - P(\\text{clone in } \\mathcal{S}_2)| \\leq C_{\\text{clone}} \\cdot \\frac{n_c}{k}\n6142: $$\n6143: \n6144: where $C_{\\text{clone}} = O(1)$ depends on fitness bounds.\n6145: \n6146: The expected number of walkers that make different cloning decisions is:\n6147: \n6148: $$\n6149: \\mathbb{E}[\\text{new differences from cloning}] \\leq (N - n_c) \\cdot C_{\\text{clone}} \\cdot \\frac{n_c}{k} = O\\left(\\frac{N \\cdot n_c}{k}\\right)\n6150: $$\n6151: \n6152: **C. Walkers that cloned in one swarm but died in the other**:\n6153: \n6154: The death operator affects walkers at the boundary. By the confining potential, the probability of death is:\n6155: \n6156: $$\n6157: P(\\text{death}) = O(e^{-\\alpha_U R^2 / \\sigma_v^2})\n6158: $$\n6159: \n6160: which is exponentially small. Contribution: $O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$.\n6161: \n6162: **Combined cloning bound**:\n6163: \n6164: $$\n6165: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] \\leq n_c + O\\left(\\frac{N \\cdot n_c}{k}\\right) + O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)\n6166: $$\n6167: \n6168: For large swarms with $k \\sim N$ and small death probability:\n6169: \n6170: $$\n6171: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] \\leq (1 + \\epsilon_{\\text{clone}}) \\cdot n_c\n6172: $$\n6173: \n6174: where $\\epsilon_{\\text{clone}} = O(1)$ is a small constant.\n6175: \n6176: **Step 3: Bound on kinetic-induced status changes**\n6177: \n6178: The kinetic operator (Langevin dynamics) can change status in two ways:\n6179: \n6180: **A. Walker crosses boundary** (alive \u2192 dead or vice versa):\n6181: \n6182: By the confining potential and hypocoercivity, the probability of crossing the boundary in time $\\tau$ is exponentially small:\n6183: \n6184: $$\n6185: P(\\text{boundary crossing}) \\leq C_{\\text{boundary}} \\cdot e^{-\\alpha_U R^2 / \\sigma_v^2}\n6186: $$\n6187: \n6188: Expected contribution: $O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$\n6189: \n6190: **B. Walkers with matched positions remain matched**:\n6191: \n6192: For walkers with the same status and position in both swarms, the synchronous coupling ensures they evolve identically (same noise). They remain matched.\n6193: \n6194: **C. Walkers with different positions**:\n6195: \n6196: This is where the $d_{\\text{status}}$ metric is powerful: if two walkers have the same status but different positions, we **don't count this as a difference**! The metric only cares about alive/dead status, not spatial location.\n6197: \n6198: **Combined kinetic bound**:\n6199: \n6200: $$\n6201: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2)] \\leq \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] + O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)\n6202: $$\n6203: \n6204: **Step 4: Combine to get contraction**\n6205: \n6206: Combining Steps 2 and 3:\n6207: \n6208: $$\n6209: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2)] \\leq (1 + \\epsilon_{\\text{clone}}) \\cdot n_c + K\n6210: $$\n6211: \n6212: where $K = O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$ is the constant term from boundary effects.\n6213: \n6214: For contraction, we need $1 + \\epsilon_{\\text{clone}} < 1$, which requires **cloning to reduce differences**. This happens when:\n6215: - Unfit walkers (low fitness) are more likely to die\n6216: - Fit walkers (high fitness) are more likely to clone\n6217: - The fitness landscape provides directional pressure toward convergence\n6218: \n6219: By the Keystone Principle (Lemma {prf:ref}`lem-quantitative-keystone` in [03_cloning](../03_cloning.md)), cloning creates a **contractive force** with strength proportional to the fitness variance. When fitness variance is non-zero (guaranteed by the non-degeneracy axioms):\n6220: \n6221: $$\n6222: \\epsilon_{\\text{clone}} = -\\lambda_{\\text{clone}} \\cdot \\tau + O(\\tau^2)\n6223: $$\n6224: \n6225: where $\\lambda_{\\text{clone}} > 0$ is the cloning rate.\n6226: \n6227: Therefore:\n6228: \n6229: $$\n6230: \\gamma = 1 - \\lambda_{\\text{clone}} \\cdot \\tau + O(\\tau^2) < 1\n6231: $$",
      "metadata": {
        "label": "proof-dobrushin-contraction"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "raw_directive": "6107: :::\n6108: \n6109: :::{prf:proof}\n6110: :label: proof-dobrushin-contraction\n6111: \n6112: The proof proceeds in four steps:\n6113: \n6114: **Step 1: Synchronous coupling construction**\n6115: \n6116: Given two initial swarms $\\mathcal{S}_1, \\mathcal{S}_2$, we construct a **maximal coupling** that uses identical random numbers whenever possible:\n6117: \n6118: 1. **For cloning**:\n6119:    - Use the same companion pairing algorithm random seed\n6120:    - For walker $i$: if alive in both swarms, use same threshold $T_i$ for cloning decision\n6121:    - If walker $i$ clones in both swarms, use same Gaussian jitter $\\zeta_i$ for position perturbation\n6122: \n6123: 2. **For kinetic evolution**:\n6124:    - For walker $i$: if alive in both swarms, use same Langevin noise realizations $\\xi_i^{(x)}, \\xi_i^{(v)}$\n6125: \n6126: This coupling **preserves status matches**: if walker $i$ has the same status in $\\mathcal{S}_1, \\mathcal{S}_2$, and makes the same cloning decision, it will have the same status in $\\mathcal{S}'_1, \\mathcal{S}'_2$.\n6127: \n6128: **Step 2: Bound on cloning-induced status changes**\n6129: \n6130: By the synchronous coupling, status differences after cloning can only arise from:\n6131: \n6132: **A. Walkers that already differed** ($n_c$ walkers):\n6133: - These remain different after cloning\n6134: - Contribution: at most $n_c$ differences\n6135: \n6136: **B. Walkers that matched initially but made different cloning decisions**:\n6137: \n6138: For a walker $i$ that is alive in both swarms, the cloning decision differs if the fitness differs. By Lemma {prf:ref}`lem-softmax-lipschitz-status` (extending Theorem {prf:ref}`thm-total-error-status-bound` to softmax-weighted companion selection):\n6139: \n6140: $$\n6141: |P(\\text{clone in } \\mathcal{S}_1) - P(\\text{clone in } \\mathcal{S}_2)| \\leq C_{\\text{clone}} \\cdot \\frac{n_c}{k}\n6142: $$\n6143: \n6144: where $C_{\\text{clone}} = O(1)$ depends on fitness bounds.\n6145: \n6146: The expected number of walkers that make different cloning decisions is:\n6147: \n6148: $$\n6149: \\mathbb{E}[\\text{new differences from cloning}] \\leq (N - n_c) \\cdot C_{\\text{clone}} \\cdot \\frac{n_c}{k} = O\\left(\\frac{N \\cdot n_c}{k}\\right)\n6150: $$\n6151: \n6152: **C. Walkers that cloned in one swarm but died in the other**:\n6153: \n6154: The death operator affects walkers at the boundary. By the confining potential, the probability of death is:\n6155: \n6156: $$\n6157: P(\\text{death}) = O(e^{-\\alpha_U R^2 / \\sigma_v^2})\n6158: $$\n6159: \n6160: which is exponentially small. Contribution: $O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$.\n6161: \n6162: **Combined cloning bound**:\n6163: \n6164: $$\n6165: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] \\leq n_c + O\\left(\\frac{N \\cdot n_c}{k}\\right) + O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)\n6166: $$\n6167: \n6168: For large swarms with $k \\sim N$ and small death probability:\n6169: \n6170: $$\n6171: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] \\leq (1 + \\epsilon_{\\text{clone}}) \\cdot n_c\n6172: $$\n6173: \n6174: where $\\epsilon_{\\text{clone}} = O(1)$ is a small constant.\n6175: \n6176: **Step 3: Bound on kinetic-induced status changes**\n6177: \n6178: The kinetic operator (Langevin dynamics) can change status in two ways:\n6179: \n6180: **A. Walker crosses boundary** (alive \u2192 dead or vice versa):\n6181: \n6182: By the confining potential and hypocoercivity, the probability of crossing the boundary in time $\\tau$ is exponentially small:\n6183: \n6184: $$\n6185: P(\\text{boundary crossing}) \\leq C_{\\text{boundary}} \\cdot e^{-\\alpha_U R^2 / \\sigma_v^2}\n6186: $$\n6187: \n6188: Expected contribution: $O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$\n6189: \n6190: **B. Walkers with matched positions remain matched**:\n6191: \n6192: For walkers with the same status and position in both swarms, the synchronous coupling ensures they evolve identically (same noise). They remain matched.\n6193: \n6194: **C. Walkers with different positions**:\n6195: \n6196: This is where the $d_{\\text{status}}$ metric is powerful: if two walkers have the same status but different positions, we **don't count this as a difference**! The metric only cares about alive/dead status, not spatial location.\n6197: \n6198: **Combined kinetic bound**:\n6199: \n6200: $$\n6201: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2)] \\leq \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}^{\\text{clone}}_1, \\mathcal{S}^{\\text{clone}}_2)] + O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)\n6202: $$\n6203: \n6204: **Step 4: Combine to get contraction**\n6205: \n6206: Combining Steps 2 and 3:\n6207: \n6208: $$\n6209: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}'_1, \\mathcal{S}'_2)] \\leq (1 + \\epsilon_{\\text{clone}}) \\cdot n_c + K\n6210: $$\n6211: \n6212: where $K = O(e^{-\\alpha_U R^2 / \\sigma_v^2} \\cdot N)$ is the constant term from boundary effects.\n6213: \n6214: For contraction, we need $1 + \\epsilon_{\\text{clone}} < 1$, which requires **cloning to reduce differences**. This happens when:\n6215: - Unfit walkers (low fitness) are more likely to die\n6216: - Fit walkers (high fitness) are more likely to clone\n6217: - The fitness landscape provides directional pressure toward convergence\n6218: \n6219: By the Keystone Principle (Lemma {prf:ref}`lem-quantitative-keystone` in [03_cloning](../03_cloning.md)), cloning creates a **contractive force** with strength proportional to the fitness variance. When fitness variance is non-zero (guaranteed by the non-degeneracy axioms):\n6220: \n6221: $$\n6222: \\epsilon_{\\text{clone}} = -\\lambda_{\\text{clone}} \\cdot \\tau + O(\\tau^2)\n6223: $$\n6224: \n6225: where $\\lambda_{\\text{clone}} > 0$ is the cloning rate.\n6226: \n6227: Therefore:\n6228: \n6229: $$\n6230: \\gamma = 1 - \\lambda_{\\text{clone}} \\cdot \\tau + O(\\tau^2) < 1\n6231: $$\n6232: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-exponential-convergence-status",
      "title": "Exponential Convergence in $d_{\\text{status}}$ Metric",
      "start_line": 6238,
      "end_line": 6258,
      "header_lines": [
        6239
      ],
      "content_start": 6241,
      "content_end": 6257,
      "content": "6241: :label: thm-exponential-convergence-status\n6242: \n6243: Under the assumptions of Theorem {prf:ref}`thm-dobrushin-contraction`, the Euclidean Gas has a unique quasi-stationary distribution $\\pi_{\\text{QSD}}$ on the alive state space, and for any initial swarm $\\mathcal{S}_0$ with at least $k_{\\min}$ alive walkers:\n6244: \n6245: $$\n6246: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}_t, \\pi_{\\text{QSD}})] \\leq \\gamma^t \\cdot C_0 + \\frac{K}{1 - \\gamma}\n6247: $$\n6248: \n6249: where:\n6250: - $\\mathcal{S}_t$ is the swarm at time $t$\n6251: - $C_0 = d_{\\text{status}}(\\mathcal{S}_0, \\pi_{\\text{QSD}})$ is the initial distance\n6252: - $\\gamma < 1$ is the contraction coefficient from Theorem {prf:ref}`thm-dobrushin-contraction`\n6253: - $K$ is the boundary contribution (exponentially small)\n6254: \n6255: This gives **exponential convergence** with rate:\n6256: \n6257: $$",
      "metadata": {
        "label": "thm-exponential-convergence-status"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "raw_directive": "6238: With the Dobrushin contraction established, we can now prove exponential convergence to a unique quasi-stationary distribution.\n6239: \n6240: :::{prf:theorem} Exponential Convergence in $d_{\\text{status}}$ Metric\n6241: :label: thm-exponential-convergence-status\n6242: \n6243: Under the assumptions of Theorem {prf:ref}`thm-dobrushin-contraction`, the Euclidean Gas has a unique quasi-stationary distribution $\\pi_{\\text{QSD}}$ on the alive state space, and for any initial swarm $\\mathcal{S}_0$ with at least $k_{\\min}$ alive walkers:\n6244: \n6245: $$\n6246: \\mathbb{E}[d_{\\text{status}}(\\mathcal{S}_t, \\pi_{\\text{QSD}})] \\leq \\gamma^t \\cdot C_0 + \\frac{K}{1 - \\gamma}\n6247: $$\n6248: \n6249: where:\n6250: - $\\mathcal{S}_t$ is the swarm at time $t$\n6251: - $C_0 = d_{\\text{status}}(\\mathcal{S}_0, \\pi_{\\text{QSD}})$ is the initial distance\n6252: - $\\gamma < 1$ is the contraction coefficient from Theorem {prf:ref}`thm-dobrushin-contraction`\n6253: - $K$ is the boundary contribution (exponentially small)\n6254: \n6255: This gives **exponential convergence** with rate:\n6256: \n6257: $$\n6258: \\lambda_{\\text{converge}} = -\\log(\\gamma) \\approx \\lambda_{\\text{clone}} \\cdot \\tau"
    },
    {
      "directive_type": "proof",
      "label": "proof-exponential-convergence-status",
      "title": null,
      "start_line": 6260,
      "end_line": 6302,
      "header_lines": [
        6261
      ],
      "content_start": 6263,
      "content_end": 6301,
      "content": "6263: :label: proof-exponential-convergence-status\n6264: \n6265: This is a standard application of the **Banach fixed-point theorem for Markov chains** (see Meyn & Tweedie, \"Markov Chains and Stochastic Stability\", Theorem 16.0.2).\n6266: \n6267: **Step 1: Contraction mapping**\n6268: \n6269: Define the operator $P: \\mathcal{P}(\\mathbb{S}) \\to \\mathcal{P}(\\mathbb{S})$ where $P\\mu$ is the distribution of $\\mathcal{S}'$ when $\\mathcal{S} \\sim \\mu$.\n6270: \n6271: By Theorem {prf:ref}`thm-dobrushin-contraction`, $P$ is a contraction in the $d_{\\text{status}}$ metric:\n6272: \n6273: $$\n6274: W_{d_{\\text{status}}}(P\\mu_1, P\\mu_2) \\leq \\gamma \\cdot W_{d_{\\text{status}}}(\\mu_1, \\mu_2) + K\n6275: $$\n6276: \n6277: where $W_{d_{\\text{status}}}$ is the Wasserstein-1 distance with respect to the $d_{\\text{status}}$ metric.\n6278: \n6279: **Step 2: Fixed point exists and is unique**\n6280: \n6281: By the Banach fixed-point theorem, there exists a unique distribution $\\pi_{\\text{QSD}}$ such that $P\\pi_{\\text{QSD}} = \\pi_{\\text{QSD}}$. This is the quasi-stationary distribution.\n6282: \n6283: **Step 3: Exponential approach**\n6284: \n6285: For any initial distribution $\\mu_0$, let $\\mu_t = P^t \\mu_0$. By repeated application of contraction:\n6286: \n6287: $$\n6288: W_{d_{\\text{status}}}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\gamma^t \\cdot W_{d_{\\text{status}}}(\\mu_0, \\pi_{\\text{QSD}}) + K \\sum_{i=0}^{t-1} \\gamma^i\n6289: $$\n6290: \n6291: The geometric series sums to:\n6292: \n6293: $$\n6294: \\sum_{i=0}^{t-1} \\gamma^i = \\frac{1 - \\gamma^t}{1 - \\gamma} < \\frac{1}{1 - \\gamma}\n6295: $$\n6296: \n6297: Therefore:\n6298: \n6299: $$\n6300: W_{d_{\\text{status}}}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\gamma^t \\cdot W_{d_{\\text{status}}}(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{K}{1 - \\gamma}\n6301: $$",
      "metadata": {
        "label": "proof-exponential-convergence-status"
      },
      "section": "## Part 3: Dobrushin Contraction for the Full Dynamics",
      "raw_directive": "6260: :::\n6261: \n6262: :::{prf:proof}\n6263: :label: proof-exponential-convergence-status\n6264: \n6265: This is a standard application of the **Banach fixed-point theorem for Markov chains** (see Meyn & Tweedie, \"Markov Chains and Stochastic Stability\", Theorem 16.0.2).\n6266: \n6267: **Step 1: Contraction mapping**\n6268: \n6269: Define the operator $P: \\mathcal{P}(\\mathbb{S}) \\to \\mathcal{P}(\\mathbb{S})$ where $P\\mu$ is the distribution of $\\mathcal{S}'$ when $\\mathcal{S} \\sim \\mu$.\n6270: \n6271: By Theorem {prf:ref}`thm-dobrushin-contraction`, $P$ is a contraction in the $d_{\\text{status}}$ metric:\n6272: \n6273: $$\n6274: W_{d_{\\text{status}}}(P\\mu_1, P\\mu_2) \\leq \\gamma \\cdot W_{d_{\\text{status}}}(\\mu_1, \\mu_2) + K\n6275: $$\n6276: \n6277: where $W_{d_{\\text{status}}}$ is the Wasserstein-1 distance with respect to the $d_{\\text{status}}$ metric.\n6278: \n6279: **Step 2: Fixed point exists and is unique**\n6280: \n6281: By the Banach fixed-point theorem, there exists a unique distribution $\\pi_{\\text{QSD}}$ such that $P\\pi_{\\text{QSD}} = \\pi_{\\text{QSD}}$. This is the quasi-stationary distribution.\n6282: \n6283: **Step 3: Exponential approach**\n6284: \n6285: For any initial distribution $\\mu_0$, let $\\mu_t = P^t \\mu_0$. By repeated application of contraction:\n6286: \n6287: $$\n6288: W_{d_{\\text{status}}}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\gamma^t \\cdot W_{d_{\\text{status}}}(\\mu_0, \\pi_{\\text{QSD}}) + K \\sum_{i=0}^{t-1} \\gamma^i\n6289: $$\n6290: \n6291: The geometric series sums to:\n6292: \n6293: $$\n6294: \\sum_{i=0}^{t-1} \\gamma^i = \\frac{1 - \\gamma^t}{1 - \\gamma} < \\frac{1}{1 - \\gamma}\n6295: $$\n6296: \n6297: Therefore:\n6298: \n6299: $$\n6300: W_{d_{\\text{status}}}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\gamma^t \\cdot W_{d_{\\text{status}}}(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{K}{1 - \\gamma}\n6301: $$\n6302: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}