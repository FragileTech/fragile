{
  "chapter_index": 2,
  "section_id": "## 2. The Coupled State Space and State Differences",
  "directive_count": 6,
  "hints": [
    {
      "directive_type": "definition",
      "label": "def-single-swarm-space",
      "title": "Single-Walker and Swarm State Spaces",
      "start_line": 106,
      "end_line": 128,
      "header_lines": [
        107
      ],
      "content_start": 109,
      "content_end": 127,
      "content": "109: :label: def-single-swarm-space\n110: \n111: 1.  A **walker** is a tuple $(x, s)$, where $x \\in \\mathcal{X}$ is its position in a state space and $s \\in \\{0, 1\\}$ is its survival status. For the Euclidean Gas, this is extended to include a velocity component, making the **full state** of a single walker a tuple $(x, v, s) \\in \\mathbb{R}^d \\times \\mathbb{R}^d \\times \\{0, 1\\}$. We refer to $(x,v)$ as the **kinematic state**.\n112: \n113: 2.  A **swarm configuration**, $S$, is an N-tuple of walker states:\n114: \n115: \n116: \n117: $$\n118: S := \\left( (x_1, v_1, s_1), (x_2, v_2, s_2), \\dots, (x_N, v_N, s_N) \\right)\n119: $$\n120: \n121: 3.  The **single-swarm state space**, denoted $\\Sigma_N$, is the Cartesian product of the per-walker state spaces:\n122: \n123: \n124: \n125: $$\n126: \\Sigma_N := \\left( \\mathbb{R}^d \\times \\mathbb{R}^d \\times \\{0, 1\\} \\right)^N.\n127: $$",
      "metadata": {
        "label": "def-single-swarm-space"
      },
      "section": "## 2. The Coupled State Space and State Differences",
      "references": [
        "def-barycentres-and-centered-vectors",
        "def-coupled-state-space",
        "def-swarm-aggregation-operator"
      ],
      "raw_directive": "106: The fundamental unit of the system is the walker, and a collection of these walkers constitutes a swarm. We begin by defining their state spaces abstractly, in a manner consistent with the Fragile Gas framework.\n107: \n108: :::{prf:definition} Single-Walker and Swarm State Spaces\n109: :label: def-single-swarm-space\n110: \n111: 1.  A **walker** is a tuple $(x, s)$, where $x \\in \\mathcal{X}$ is its position in a state space and $s \\in \\{0, 1\\}$ is its survival status. For the Euclidean Gas, this is extended to include a velocity component, making the **full state** of a single walker a tuple $(x, v, s) \\in \\mathbb{R}^d \\times \\mathbb{R}^d \\times \\{0, 1\\}$. We refer to $(x,v)$ as the **kinematic state**.\n112: \n113: 2.  A **swarm configuration**, $S$, is an N-tuple of walker states:\n114: \n115: \n116: \n117: $$\n118: S := \\left( (x_1, v_1, s_1), (x_2, v_2, s_2), \\dots, (x_N, v_N, s_N) \\right)\n119: $$\n120: \n121: 3.  The **single-swarm state space**, denoted $\\Sigma_N$, is the Cartesian product of the per-walker state spaces:\n122: \n123: \n124: \n125: $$\n126: \\Sigma_N := \\left( \\mathbb{R}^d \\times \\mathbb{R}^d \\times \\{0, 1\\} \\right)^N.\n127: $$\n128: "
    },
    {
      "directive_type": "definition",
      "label": "def-coupled-state-space",
      "title": "The Coupled State Space",
      "start_line": 145,
      "end_line": 161,
      "header_lines": [
        146
      ],
      "content_start": 148,
      "content_end": 160,
      "content": "148: :label: def-coupled-state-space\n149: \n150: The **coupled state space** for the Euclidean Gas is the Cartesian product $\\Sigma_N \\times \\Sigma_N$, where $\\Sigma_N$ is defined in {prf:ref}`def-single-swarm-space`. An element of this space is an ordered pair of swarm configurations, $(S_1, S_2)$, where:\n151: \n152: $$\n153: S_1 = \\left( (x_{1,1}, v_{1,1}, s_{1,1}), \\dots, (x_{1,N}, v_{1,N}, s_{1,N}) \\right) \\in \\Sigma_N,\n154: $$\n155: \n156: $$\n157: S_2 = \\left( (x_{2,1}, v_{2,1}, s_{2,1}), \\dots, (x_{2,N}, v_{2,N}, s_{2,N}) \\right) \\in \\Sigma_N.\n158: $$\n159: \n160: The convergence analysis proceeds by tracking the evolution of a Lyapunov function $V(S_1, S_2)$ across this coupled space.",
      "metadata": {
        "label": "def-coupled-state-space"
      },
      "section": "## 2. The Coupled State Space and State Differences",
      "references": [
        "def-single-swarm-space",
        "def-coupled-cloning-expectation"
      ],
      "raw_directive": "145: This synchronous coupling is chosen because it is designed to minimize the distance between the two trajectories, making it the most suitable choice for proving a contraction. All expectations $\\mathbb{E}[\\cdot]$ in the subsequent analysis are taken with respect to this single, shared source of randomness.\n146: \n147: :::{prf:definition} The Coupled State Space\n148: :label: def-coupled-state-space\n149: \n150: The **coupled state space** for the Euclidean Gas is the Cartesian product $\\Sigma_N \\times \\Sigma_N$, where $\\Sigma_N$ is defined in {prf:ref}`def-single-swarm-space`. An element of this space is an ordered pair of swarm configurations, $(S_1, S_2)$, where:\n151: \n152: $$\n153: S_1 = \\left( (x_{1,1}, v_{1,1}, s_{1,1}), \\dots, (x_{1,N}, v_{1,N}, s_{1,N}) \\right) \\in \\Sigma_N,\n154: $$\n155: \n156: $$\n157: S_2 = \\left( (x_{2,1}, v_{2,1}, s_{2,1}), \\dots, (x_{2,N}, v_{2,N}, s_{2,N}) \\right) \\in \\Sigma_N.\n158: $$\n159: \n160: The convergence analysis proceeds by tracking the evolution of a Lyapunov function $V(S_1, S_2)$ across this coupled space.\n161: "
    },
    {
      "directive_type": "definition",
      "label": "def-state-difference-vectors",
      "title": "State Difference Vectors",
      "start_line": 167,
      "end_line": 191,
      "header_lines": [
        168
      ],
      "content_start": 170,
      "content_end": 190,
      "content": "170: :label: def-state-difference-vectors\n171: \n172: For any element $(S_1, S_2) \\in \\Sigma_N \\times \\Sigma_N$, we define the **state difference vectors** for each walker index $i \\in \\{1, \\ldots, N\\}$ as follows:\n173: \n174: 1.  The **position difference vector** for walker $i$ is:\n175: \n176: \n177: \n178: $$\n179: \\Delta x_i := x_{1,i} - x_{2,i} \\in \\mathbb{R}^d\n180: $$\n181: \n182: 2.  The **velocity difference vector** for walker $i$ is:\n183: \n184: \n185: \n186: $$\n187: \\Delta v_i := v_{1,i} - v_{2,i} \\in \\mathbb{R}^d\n188: $$\n189: \n190: The entire drift analysis will be formulated in terms of the norms and inner products of these $2N$ difference vectors. The objective is to show that, in expectation, the magnitudes of these vectors decrease over time, driving the two swarm trajectories together.",
      "metadata": {
        "label": "def-state-difference-vectors"
      },
      "section": "## 2. The Coupled State Space and State Differences",
      "references": [
        "def-location-error-component"
      ],
      "raw_directive": "167: The core of the hypocoercive analysis is not the absolute state of the swarms, but the *difference* between them (measured element-wise). We formally define the vectors that capture this relative configuration.\n168: \n169: :::{prf:definition} State Difference Vectors\n170: :label: def-state-difference-vectors\n171: \n172: For any element $(S_1, S_2) \\in \\Sigma_N \\times \\Sigma_N$, we define the **state difference vectors** for each walker index $i \\in \\{1, \\ldots, N\\}$ as follows:\n173: \n174: 1.  The **position difference vector** for walker $i$ is:\n175: \n176: \n177: \n178: $$\n179: \\Delta x_i := x_{1,i} - x_{2,i} \\in \\mathbb{R}^d\n180: $$\n181: \n182: 2.  The **velocity difference vector** for walker $i$ is:\n183: \n184: \n185: \n186: $$\n187: \\Delta v_i := v_{1,i} - v_{2,i} \\in \\mathbb{R}^d\n188: $$\n189: \n190: The entire drift analysis will be formulated in terms of the norms and inner products of these $2N$ difference vectors. The objective is to show that, in expectation, the magnitudes of these vectors decrease over time, driving the two swarm trajectories together.\n191: "
    },
    {
      "directive_type": "axiom",
      "label": "axiom-domain-regularity",
      "title": "**(Axiom EG-0): Regularity of the Domain**",
      "start_line": 201,
      "end_line": 207,
      "header_lines": [
        202
      ],
      "content_start": 204,
      "content_end": 206,
      "content": "204: :label: axiom-domain-regularity\n205: \n206: The valid domain for a single walker's position, $\\mathcal{X}_{\\text{valid}}$, is an open, bounded, and connected subset of $\\mathbb{R}^d$. Its boundary, $\\partial \\mathcal{X}_{\\text{valid}}$, is a $C^{\\infty}$-smooth compact manifold without boundary.",
      "metadata": {
        "label": "axiom-domain-regularity"
      },
      "section": "## 2. The Coupled State Space and State Differences",
      "references": [
        "prop-barrier-existence"
      ],
      "raw_directive": "201: For the construction to be valid, we impose the following standard regularity conditions on the single-walker state space $\\mathcal{X}$.\n202: \n203: :::{prf:axiom} **(Axiom EG-0): Regularity of the Domain**\n204: :label: axiom-domain-regularity\n205: \n206: The valid domain for a single walker's position, $\\mathcal{X}_{\\text{valid}}$, is an open, bounded, and connected subset of $\\mathbb{R}^d$. Its boundary, $\\partial \\mathcal{X}_{\\text{valid}}$, is a $C^{\\infty}$-smooth compact manifold without boundary.\n207: "
    },
    {
      "directive_type": "proposition",
      "label": "prop-barrier-existence",
      "title": "Existence of a Global Smooth Barrier Function",
      "start_line": 215,
      "end_line": 224,
      "header_lines": [
        216
      ],
      "content_start": 218,
      "content_end": 223,
      "content": "218: :label: prop-barrier-existence\n219: \n220: Let $\\mathcal{X}_{\\text{valid}}$ satisfy the conditions of {prf:ref}`axiom-domain-regularity`. Then there exists a function $\\varphi: \\mathcal{X}_{\\text{valid}} \\to \\mathbb{R}$ with the following properties:\n221: 1.  **Smoothness:** $\\varphi(x)$ is $C^{\\infty}$-smooth on $\\mathcal{X}_{\\text{valid}}$.\n222: 2.  **Positivity:** $\\varphi(x)$ is strictly positive for all $x \\in \\mathcal{X}_{\\text{valid}}$.\n223: 3.  **Boundary Divergence:** $\\varphi(x) \\to \\infty$ as $x \\to \\partial \\mathcal{X}_{\\text{valid}}$.",
      "metadata": {
        "label": "prop-barrier-existence"
      },
      "section": "## 2. The Coupled State Space and State Differences",
      "references": [
        "axiom-domain-regularity",
        "def-boundary-potential-recall",
        "def-full-synergistic-lyapunov-function"
      ],
      "raw_directive": "215: Under the assumption of a regular domain, we can state and prove the existence of our desired barrier function.\n216: \n217: :::{prf:proposition} Existence of a Global Smooth Barrier Function\n218: :label: prop-barrier-existence\n219: \n220: Let $\\mathcal{X}_{\\text{valid}}$ satisfy the conditions of {prf:ref}`axiom-domain-regularity`. Then there exists a function $\\varphi: \\mathcal{X}_{\\text{valid}} \\to \\mathbb{R}$ with the following properties:\n221: 1.  **Smoothness:** $\\varphi(x)$ is $C^{\\infty}$-smooth on $\\mathcal{X}_{\\text{valid}}$.\n222: 2.  **Positivity:** $\\varphi(x)$ is strictly positive for all $x \\in \\mathcal{X}_{\\text{valid}}$.\n223: 3.  **Boundary Divergence:** $\\varphi(x) \\to \\infty$ as $x \\to \\partial \\mathcal{X}_{\\text{valid}}$.\n224: "
    },
    {
      "directive_type": "proof",
      "label": "proof-prop-barrier-existence",
      "title": null,
      "start_line": 225,
      "end_line": 355,
      "header_lines": [
        226
      ],
      "content_start": 228,
      "content_end": 354,
      "content": "228: :label: proof-prop-barrier-existence\n229: \n230: **Proof.**\n231: \n232: The proof is constructive. We build the function $\\varphi(x)$ using two primary tools: the signed distance function to the boundary and a smooth cutoff function. The construction proceeds in three steps, followed by rigorous verification of all required properties.\n233: \n234: **Step 1: The Signed Distance Function.**\n235: \n236: Since $\\partial \\mathcal{X}_{\\text{valid}}$ is a $C^{\\infty}$ compact manifold without boundary embedded in $\\mathbb{R}^d$, the **Tubular Neighborhood Theorem** (see [Lee, 2013, Theorem 6.24]) guarantees the existence of an open tubular neighborhood $U \\supset \\partial \\mathcal{X}_{\\text{valid}}$ and a smooth retraction $\\pi: U \\to \\partial \\mathcal{X}_{\\text{valid}}$ such that the signed distance function\n237: \n238: $$\n239: \\rho(x) := \\begin{cases}\n240: d(x, \\partial \\mathcal{X}_{\\text{valid}}) & \\text{if } x \\in \\mathcal{X}_{\\text{valid}} \\\\\n241: -d(x, \\partial \\mathcal{X}_{\\text{valid}}) & \\text{if } x \\notin \\mathcal{X}_{\\text{valid}}\n242: \\end{cases}\n243: $$\n244: \n245: is $C^{\\infty}$-smooth on $U$. Here $d(\\cdot, \\cdot)$ denotes the Euclidean distance. For any $x \\in U \\cap \\mathcal{X}_{\\text{valid}}$, we have $\\rho(x) = \\|x - \\pi(x)\\| > 0$, and $\\nabla \\rho(x)$ is the outward-pointing unit normal vector at the closest boundary point.\n246: \n247: **Explicit construction of the tubular neighborhood width:** By compactness of $\\partial \\mathcal{X}_{\\text{valid}}$ and smoothness, there exists $\\delta_0 > 0$ such that $U := \\{x \\in \\mathbb{R}^d : d(x, \\partial \\mathcal{X}_{\\text{valid}}) < \\delta_0\\}$ is a smooth tubular neighborhood. We will use $\\delta < \\delta_0/3$ in the sequel to ensure all relevant regions lie within $U$.\n248: \n249: **Step 2: Construction of a Smooth Cutoff Function.**\n250: \n251: We require a smooth cutoff function $\\psi: \\mathbb{R} \\to [0, 1]$ with the following properties:\n252: 1. $\\psi \\in C^{\\infty}(\\mathbb{R})$\n253: 2. $\\psi(t) = 1$ for all $t \\leq 1$\n254: 3. $\\psi(t) = 0$ for all $t \\geq 2$\n255: 4. $\\psi$ is non-increasing on $\\mathbb{R}$\n256: 5. $\\psi'(t) < 0$ for all $t \\in (1, 2)$\n257: \n258: **Explicit construction:** A standard construction uses the mollifier function. Define\n259: \n260: $$\n261: \\eta(t) := \\begin{cases}\n262: \\exp\\left(-\\frac{1}{1-t^2}\\right) & \\text{if } |t| < 1 \\\\\n263: 0 & \\text{if } |t| \\geq 1\n264: \\end{cases}\n265: $$\n266: \n267: which is $C^{\\infty}$ on $\\mathbb{R}$ (see [Rudin, 1987, Theorem 1.46]). Then set\n268: \n269: $$\n270: \\psi(t) := \\frac{\\int_{t}^{\\infty} \\eta(2s - 3) \\, ds}{\\int_{-\\infty}^{\\infty} \\eta(2s - 3) \\, ds}\n271: $$\n272: \n273: This gives a smooth non-increasing function with $\\psi(t) = 1$ for $t \\leq 1$ and $\\psi(t) = 0$ for $t \\geq 2$.\n274: \n275: **Step 3: Construction of the Barrier Function.**\n276: \n277: Fix $\\delta \\in (0, \\delta_0/3)$ where $\\delta_0$ is the tubular neighborhood width from Step 1. We define $\\varphi: \\mathcal{X}_{\\text{valid}} \\to (0, \\infty)$ by\n278: \n279: $$\n280: \\varphi(x) := \\frac{1}{\\delta} + \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)\\left( \\frac{1}{\\rho(x)} - \\frac{1}{\\delta} \\right)\n281: $$\n282: \n283: **Verification of Properties:**\n284: \n285: **Property 1: Smoothness.**\n286: \n287: We verify $\\varphi \\in C^{\\infty}(\\mathcal{X}_{\\text{valid}})$ by analyzing the composition structure.\n288: \n289: For any $x \\in \\mathcal{X}_{\\text{valid}}$ with $\\rho(x) < 3\\delta < \\delta_0$, we have $x \\in U$, so $\\rho(x)$ is $C^{\\infty}$ near $x$. Since $\\rho(x) > 0$ for all $x \\in \\mathcal{X}_{\\text{valid}}$, the function $1/\\rho(x)$ is $C^{\\infty}$ on all of $\\mathcal{X}_{\\text{valid}}$. The composition $\\psi(\\rho(x)/\\delta)$ is $C^{\\infty}$ since both $\\psi$ and $\\rho$ are $C^{\\infty}$.\n290: \n291: For $x$ with $\\rho(x) \\geq 3\\delta$, we have $\\rho(x)/\\delta \\geq 3 > 2$, so $\\psi(\\rho(x)/\\delta) = 0$ identically in a neighborhood of $x$. Thus $\\varphi(x) = 1/\\delta$ (constant) in this region, which is trivially $C^{\\infty}$.\n292: \n293: The matching at $\\rho(x) = 3\\delta$ is smooth because $\\psi$ and all its derivatives vanish for arguments $\\geq 2$.\n294: \n295: Therefore, $\\varphi \\in C^{\\infty}(\\mathcal{X}_{\\text{valid}})$.\n296: \n297: **Property 2: Boundary Divergence.**\n298: \n299: We must show that for any sequence $(x_n) \\subset \\mathcal{X}_{\\text{valid}}$ with $x_n \\to x_{\\infty} \\in \\partial \\mathcal{X}_{\\text{valid}}$, we have $\\varphi(x_n) \\to \\infty$.\n300: \n301: Since $x_n \\to x_{\\infty} \\in \\partial \\mathcal{X}_{\\text{valid}}$ and $x_n \\in \\mathcal{X}_{\\text{valid}}$, by continuity of the distance function, $\\rho(x_n) = d(x_n, \\partial \\mathcal{X}_{\\text{valid}}) \\to 0^{+}$.\n302: \n303: For sufficiently large $n$, we have $\\rho(x_n) < \\delta$, which implies $\\rho(x_n)/\\delta < 1$, hence $\\psi(\\rho(x_n)/\\delta) = 1$. In this regime:\n304: \n305: $$\n306: \\varphi(x_n) = \\frac{1}{\\delta} + 1 \\cdot \\left( \\frac{1}{\\rho(x_n)} - \\frac{1}{\\delta} \\right) = \\frac{1}{\\rho(x_n)}\n307: $$\n308: \n309: Since $\\rho(x_n) \\to 0^{+}$, we have $\\varphi(x_n) = 1/\\rho(x_n) \\to +\\infty$.\n310: \n311: **Property 3: Strict Positivity.**\n312: \n313: We prove $\\varphi(x) > 0$ for all $x \\in \\mathcal{X}_{\\text{valid}}$ by case analysis.\n314: \n315: *Case 1: $0 < \\rho(x) \\leq \\delta$.*\n316: Here $\\rho(x)/\\delta \\leq 1$, so $\\psi(\\rho(x)/\\delta) = 1$. Thus:\n317: \n318: $$\n319: \\varphi(x) = \\frac{1}{\\delta} + 1 \\cdot \\left( \\frac{1}{\\rho(x)} - \\frac{1}{\\delta} \\right) = \\frac{1}{\\rho(x)} > 0\n320: $$\n321: \n322: since $\\rho(x) > 0$.\n323: \n324: *Case 2: $\\rho(x) \\geq 2\\delta$.*\n325: Here $\\rho(x)/\\delta \\geq 2$, so $\\psi(\\rho(x)/\\delta) = 0$. Thus:\n326: \n327: $$\n328: \\varphi(x) = \\frac{1}{\\delta} + 0 \\cdot \\left( \\frac{1}{\\rho(x)} - \\frac{1}{\\delta} \\right) = \\frac{1}{\\delta} > 0\n329: $$\n330: \n331: *Case 3: $\\delta < \\rho(x) < 2\\delta$.*\n332: This is the transition region. We have $1 < \\rho(x)/\\delta < 2$, so $\\psi(\\rho(x)/\\delta) \\in (0, 1)$.\n333: \n334: Rewrite $\\varphi(x)$ by expanding:\n335: \n336: $$\n337: \\begin{aligned}\n338: \\varphi(x) &= \\frac{1}{\\delta} + \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)\\left( \\frac{1}{\\rho(x)} - \\frac{1}{\\delta} \\right) \\\\\n339: &= \\frac{1}{\\delta} + \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right) \\cdot \\frac{1}{\\rho(x)} - \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right) \\cdot \\frac{1}{\\delta} \\\\\n340: &= \\frac{1}{\\delta}\\left(1 - \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)\\right) + \\frac{1}{\\rho(x)} \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)\n341: \\end{aligned}\n342: $$\n343: \n344: Since $\\psi(\\rho(x)/\\delta) \\in (0,1)$, we have $1 - \\psi(\\rho(x)/\\delta) \\in (0, 1) \\subset (0, \\infty)$. Thus:\n345: \n346: $$\n347: \\varphi(x) = \\underbrace{\\frac{1}{\\delta}\\left(1 - \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)\\right)}_{> 0} + \\underbrace{\\frac{1}{\\rho(x)} \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)}_{> 0} > 0\n348: $$\n349: \n350: Both terms are strictly positive since $\\delta > 0$, $\\rho(x) > 0$, $1 - \\psi > 0$, and $\\psi > 0$ in this regime.\n351: \n352: **Conclusion:**\n353: \n354: We have constructed a function $\\varphi: \\mathcal{X}_{\\text{valid}} \\to (0, \\infty)$ satisfying all three properties: $\\varphi \\in C^{\\infty}(\\mathcal{X}_{\\text{valid}})$, $\\varphi(x) > 0$ everywhere, and $\\varphi(x) \\to \\infty$ as $x \\to \\partial \\mathcal{X}_{\\text{valid}}$.",
      "metadata": {
        "label": "proof-prop-barrier-existence"
      },
      "section": "## 2. The Coupled State Space and State Differences",
      "references": [],
      "raw_directive": "225: Referenced by {prf:ref}`def-boundary-potential-recall` and {prf:ref}`def-full-synergistic-lyapunov-function`.\n226: :::\n227: :::{prf:proof}\n228: :label: proof-prop-barrier-existence\n229: \n230: **Proof.**\n231: \n232: The proof is constructive. We build the function $\\varphi(x)$ using two primary tools: the signed distance function to the boundary and a smooth cutoff function. The construction proceeds in three steps, followed by rigorous verification of all required properties.\n233: \n234: **Step 1: The Signed Distance Function.**\n235: \n236: Since $\\partial \\mathcal{X}_{\\text{valid}}$ is a $C^{\\infty}$ compact manifold without boundary embedded in $\\mathbb{R}^d$, the **Tubular Neighborhood Theorem** (see [Lee, 2013, Theorem 6.24]) guarantees the existence of an open tubular neighborhood $U \\supset \\partial \\mathcal{X}_{\\text{valid}}$ and a smooth retraction $\\pi: U \\to \\partial \\mathcal{X}_{\\text{valid}}$ such that the signed distance function\n237: \n238: $$\n239: \\rho(x) := \\begin{cases}\n240: d(x, \\partial \\mathcal{X}_{\\text{valid}}) & \\text{if } x \\in \\mathcal{X}_{\\text{valid}} \\\\\n241: -d(x, \\partial \\mathcal{X}_{\\text{valid}}) & \\text{if } x \\notin \\mathcal{X}_{\\text{valid}}\n242: \\end{cases}\n243: $$\n244: \n245: is $C^{\\infty}$-smooth on $U$. Here $d(\\cdot, \\cdot)$ denotes the Euclidean distance. For any $x \\in U \\cap \\mathcal{X}_{\\text{valid}}$, we have $\\rho(x) = \\|x - \\pi(x)\\| > 0$, and $\\nabla \\rho(x)$ is the outward-pointing unit normal vector at the closest boundary point.\n246: \n247: **Explicit construction of the tubular neighborhood width:** By compactness of $\\partial \\mathcal{X}_{\\text{valid}}$ and smoothness, there exists $\\delta_0 > 0$ such that $U := \\{x \\in \\mathbb{R}^d : d(x, \\partial \\mathcal{X}_{\\text{valid}}) < \\delta_0\\}$ is a smooth tubular neighborhood. We will use $\\delta < \\delta_0/3$ in the sequel to ensure all relevant regions lie within $U$.\n248: \n249: **Step 2: Construction of a Smooth Cutoff Function.**\n250: \n251: We require a smooth cutoff function $\\psi: \\mathbb{R} \\to [0, 1]$ with the following properties:\n252: 1. $\\psi \\in C^{\\infty}(\\mathbb{R})$\n253: 2. $\\psi(t) = 1$ for all $t \\leq 1$\n254: 3. $\\psi(t) = 0$ for all $t \\geq 2$\n255: 4. $\\psi$ is non-increasing on $\\mathbb{R}$\n256: 5. $\\psi'(t) < 0$ for all $t \\in (1, 2)$\n257: \n258: **Explicit construction:** A standard construction uses the mollifier function. Define\n259: \n260: $$\n261: \\eta(t) := \\begin{cases}\n262: \\exp\\left(-\\frac{1}{1-t^2}\\right) & \\text{if } |t| < 1 \\\\\n263: 0 & \\text{if } |t| \\geq 1\n264: \\end{cases}\n265: $$\n266: \n267: which is $C^{\\infty}$ on $\\mathbb{R}$ (see [Rudin, 1987, Theorem 1.46]). Then set\n268: \n269: $$\n270: \\psi(t) := \\frac{\\int_{t}^{\\infty} \\eta(2s - 3) \\, ds}{\\int_{-\\infty}^{\\infty} \\eta(2s - 3) \\, ds}\n271: $$\n272: \n273: This gives a smooth non-increasing function with $\\psi(t) = 1$ for $t \\leq 1$ and $\\psi(t) = 0$ for $t \\geq 2$.\n274: \n275: **Step 3: Construction of the Barrier Function.**\n276: \n277: Fix $\\delta \\in (0, \\delta_0/3)$ where $\\delta_0$ is the tubular neighborhood width from Step 1. We define $\\varphi: \\mathcal{X}_{\\text{valid}} \\to (0, \\infty)$ by\n278: \n279: $$\n280: \\varphi(x) := \\frac{1}{\\delta} + \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)\\left( \\frac{1}{\\rho(x)} - \\frac{1}{\\delta} \\right)\n281: $$\n282: \n283: **Verification of Properties:**\n284: \n285: **Property 1: Smoothness.**\n286: \n287: We verify $\\varphi \\in C^{\\infty}(\\mathcal{X}_{\\text{valid}})$ by analyzing the composition structure.\n288: \n289: For any $x \\in \\mathcal{X}_{\\text{valid}}$ with $\\rho(x) < 3\\delta < \\delta_0$, we have $x \\in U$, so $\\rho(x)$ is $C^{\\infty}$ near $x$. Since $\\rho(x) > 0$ for all $x \\in \\mathcal{X}_{\\text{valid}}$, the function $1/\\rho(x)$ is $C^{\\infty}$ on all of $\\mathcal{X}_{\\text{valid}}$. The composition $\\psi(\\rho(x)/\\delta)$ is $C^{\\infty}$ since both $\\psi$ and $\\rho$ are $C^{\\infty}$.\n290: \n291: For $x$ with $\\rho(x) \\geq 3\\delta$, we have $\\rho(x)/\\delta \\geq 3 > 2$, so $\\psi(\\rho(x)/\\delta) = 0$ identically in a neighborhood of $x$. Thus $\\varphi(x) = 1/\\delta$ (constant) in this region, which is trivially $C^{\\infty}$.\n292: \n293: The matching at $\\rho(x) = 3\\delta$ is smooth because $\\psi$ and all its derivatives vanish for arguments $\\geq 2$.\n294: \n295: Therefore, $\\varphi \\in C^{\\infty}(\\mathcal{X}_{\\text{valid}})$.\n296: \n297: **Property 2: Boundary Divergence.**\n298: \n299: We must show that for any sequence $(x_n) \\subset \\mathcal{X}_{\\text{valid}}$ with $x_n \\to x_{\\infty} \\in \\partial \\mathcal{X}_{\\text{valid}}$, we have $\\varphi(x_n) \\to \\infty$.\n300: \n301: Since $x_n \\to x_{\\infty} \\in \\partial \\mathcal{X}_{\\text{valid}}$ and $x_n \\in \\mathcal{X}_{\\text{valid}}$, by continuity of the distance function, $\\rho(x_n) = d(x_n, \\partial \\mathcal{X}_{\\text{valid}}) \\to 0^{+}$.\n302: \n303: For sufficiently large $n$, we have $\\rho(x_n) < \\delta$, which implies $\\rho(x_n)/\\delta < 1$, hence $\\psi(\\rho(x_n)/\\delta) = 1$. In this regime:\n304: \n305: $$\n306: \\varphi(x_n) = \\frac{1}{\\delta} + 1 \\cdot \\left( \\frac{1}{\\rho(x_n)} - \\frac{1}{\\delta} \\right) = \\frac{1}{\\rho(x_n)}\n307: $$\n308: \n309: Since $\\rho(x_n) \\to 0^{+}$, we have $\\varphi(x_n) = 1/\\rho(x_n) \\to +\\infty$.\n310: \n311: **Property 3: Strict Positivity.**\n312: \n313: We prove $\\varphi(x) > 0$ for all $x \\in \\mathcal{X}_{\\text{valid}}$ by case analysis.\n314: \n315: *Case 1: $0 < \\rho(x) \\leq \\delta$.*\n316: Here $\\rho(x)/\\delta \\leq 1$, so $\\psi(\\rho(x)/\\delta) = 1$. Thus:\n317: \n318: $$\n319: \\varphi(x) = \\frac{1}{\\delta} + 1 \\cdot \\left( \\frac{1}{\\rho(x)} - \\frac{1}{\\delta} \\right) = \\frac{1}{\\rho(x)} > 0\n320: $$\n321: \n322: since $\\rho(x) > 0$.\n323: \n324: *Case 2: $\\rho(x) \\geq 2\\delta$.*\n325: Here $\\rho(x)/\\delta \\geq 2$, so $\\psi(\\rho(x)/\\delta) = 0$. Thus:\n326: \n327: $$\n328: \\varphi(x) = \\frac{1}{\\delta} + 0 \\cdot \\left( \\frac{1}{\\rho(x)} - \\frac{1}{\\delta} \\right) = \\frac{1}{\\delta} > 0\n329: $$\n330: \n331: *Case 3: $\\delta < \\rho(x) < 2\\delta$.*\n332: This is the transition region. We have $1 < \\rho(x)/\\delta < 2$, so $\\psi(\\rho(x)/\\delta) \\in (0, 1)$.\n333: \n334: Rewrite $\\varphi(x)$ by expanding:\n335: \n336: $$\n337: \\begin{aligned}\n338: \\varphi(x) &= \\frac{1}{\\delta} + \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)\\left( \\frac{1}{\\rho(x)} - \\frac{1}{\\delta} \\right) \\\\\n339: &= \\frac{1}{\\delta} + \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right) \\cdot \\frac{1}{\\rho(x)} - \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right) \\cdot \\frac{1}{\\delta} \\\\\n340: &= \\frac{1}{\\delta}\\left(1 - \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)\\right) + \\frac{1}{\\rho(x)} \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)\n341: \\end{aligned}\n342: $$\n343: \n344: Since $\\psi(\\rho(x)/\\delta) \\in (0,1)$, we have $1 - \\psi(\\rho(x)/\\delta) \\in (0, 1) \\subset (0, \\infty)$. Thus:\n345: \n346: $$\n347: \\varphi(x) = \\underbrace{\\frac{1}{\\delta}\\left(1 - \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)\\right)}_{> 0} + \\underbrace{\\frac{1}{\\rho(x)} \\psi\\left(\\frac{\\rho(x)}{\\delta}\\right)}_{> 0} > 0\n348: $$\n349: \n350: Both terms are strictly positive since $\\delta > 0$, $\\rho(x) > 0$, $1 - \\psi > 0$, and $\\psi > 0$ in this regime.\n351: \n352: **Conclusion:**\n353: \n354: We have constructed a function $\\varphi: \\mathcal{X}_{\\text{valid}} \\to (0, \\infty)$ satisfying all three properties: $\\varphi \\in C^{\\infty}(\\mathcal{X}_{\\text{valid}})$, $\\varphi(x) > 0$ everywhere, and $\\varphi(x) \\to \\infty$ as $x \\to \\partial \\mathcal{X}_{\\text{valid}}$.\n355: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}