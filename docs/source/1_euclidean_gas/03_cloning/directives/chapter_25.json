{
  "chapter_index": 25,
  "section_id": "## 11.4. Proof of Boundary Potential Contraction",
  "directive_count": 5,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-boundary-enhanced-cloning",
      "title": "Enhanced Cloning Probability Near Boundary",
      "start_line": 7330,
      "end_line": 7340,
      "header_lines": [
        7331
      ],
      "content_start": 7333,
      "content_end": 7339,
      "content": "7333: :label: lem-boundary-enhanced-cloning\n7334: \n7335: For any walker $i$ in the boundary-exposed set $\\mathcal{E}_{\\text{boundary}}(S)$, its cloning probability satisfies:\n7336: \n7337: $$\n7338: p_i \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7339: $$",
      "metadata": {
        "label": "lem-boundary-enhanced-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [],
      "raw_directive": "7330: ### 11.4.1. Cloning Probability for Boundary-Exposed Walkers\n7331: \n7332: :::{prf:lemma} Enhanced Cloning Probability Near Boundary\n7333: :label: lem-boundary-enhanced-cloning\n7334: \n7335: For any walker $i$ in the boundary-exposed set $\\mathcal{E}_{\\text{boundary}}(S)$, its cloning probability satisfies:\n7336: \n7337: $$\n7338: p_i \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7339: $$\n7340: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-boundary-enhanced-cloning",
      "title": null,
      "start_line": 7342,
      "end_line": 7397,
      "header_lines": [
        7343
      ],
      "content_start": 7344,
      "content_end": 7396,
      "content": "7344: :::{prf:proof}\n7345: :label: proof-lem-boundary-enhanced-cloning\n7346: **Proof.**\n7347: \n7348: Let $i \\in \\mathcal{E}_{\\text{boundary}}(S)$ be a boundary-exposed walker. By definition, $\\varphi_{\\text{barrier}}(x_i) > \\phi_{\\text{thresh}}$.\n7349: \n7350: **Step 1: Fitness penalty from barrier**\n7351: \n7352: By {prf:ref}`lem-fitness-gradient-boundary`, walker $i$ has lower fitness than interior walkers. Specifically, there exists at least one interior walker $j$ (in the safe region where $\\varphi_{\\text{barrier}}(x_j) = 0$) such that:\n7353: \n7354: $$\n7355: V_{\\text{fit},i} < V_{\\text{fit},j} - f(\\phi_{\\text{thresh}})\n7356: $$\n7357: \n7358: **Step 2: Companion selection probability**\n7359: \n7360: In the companion selection operator (see {prf:ref}`def-cloning-companion-operator`), the probability that walker $i$ selects an interior walker as its companion is bounded below. Even if the selection is spatially weighted, there exists a non-zero probability mass on interior walkers:\n7361: \n7362: $$\n7363: P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq p_{\\text{interior}} > 0\n7364: $$\n7365: \n7366: where $\\mathcal{I}_{\\text{safe}} = \\{j : \\varphi_{\\text{barrier}}(x_j) = 0\\}$ is the set of safe interior walkers.\n7367: \n7368: **Step 3: Cloning score lower bound**\n7369: \n7370: Conditioning on selecting an interior companion $j$:\n7371: \n7372: $$\n7373: S_i = \\frac{V_{\\text{fit},j} - V_{\\text{fit},i}}{V_{\\text{fit},i} + \\varepsilon_{\\text{clone}}} \\geq \\frac{f(\\phi_{\\text{thresh}})}{V_{\\text{pot,max}} + \\varepsilon_{\\text{clone}}} =: s_{\\text{min}}(\\phi_{\\text{thresh}})\n7374: $$\n7375: \n7376: **Step 4: Cloning probability lower bound**\n7377: \n7378: The probability of cloning is:\n7379: \n7380: $$\n7381: p_i = P(S_i > T_i) \\cdot P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq P(s_{\\text{min}} > T_i) \\cdot p_{\\text{interior}}\n7382: $$\n7383: \n7384: Since $T_i \\sim \\text{Uniform}(0, p_{\\max})$:\n7385: \n7386: $$\n7387: P(s_{\\text{min}} > T_i) = \\min\\left(1, \\frac{s_{\\text{min}}}{p_{\\max}}\\right)\n7388: $$\n7389: \n7390: Therefore:\n7391: \n7392: $$\n7393: p_i \\geq \\min\\left(1, \\frac{s_{\\text{min}}(\\phi_{\\text{thresh}})}{p_{\\max}}\\right) \\cdot p_{\\text{interior}} =: p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7394: $$\n7395: \n7396: This bound is independent of $N$ and depends only on $\\phi_{\\text{thresh}}$ and the algorithmic parameters.",
      "metadata": {
        "label": "proof-lem-boundary-enhanced-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [
        "lem-fitness-gradient-boundary",
        "def-cloning-companion-operator"
      ],
      "raw_directive": "7342: :::\n7343: \n7344: :::{prf:proof}\n7345: :label: proof-lem-boundary-enhanced-cloning\n7346: **Proof.**\n7347: \n7348: Let $i \\in \\mathcal{E}_{\\text{boundary}}(S)$ be a boundary-exposed walker. By definition, $\\varphi_{\\text{barrier}}(x_i) > \\phi_{\\text{thresh}}$.\n7349: \n7350: **Step 1: Fitness penalty from barrier**\n7351: \n7352: By {prf:ref}`lem-fitness-gradient-boundary`, walker $i$ has lower fitness than interior walkers. Specifically, there exists at least one interior walker $j$ (in the safe region where $\\varphi_{\\text{barrier}}(x_j) = 0$) such that:\n7353: \n7354: $$\n7355: V_{\\text{fit},i} < V_{\\text{fit},j} - f(\\phi_{\\text{thresh}})\n7356: $$\n7357: \n7358: **Step 2: Companion selection probability**\n7359: \n7360: In the companion selection operator (see {prf:ref}`def-cloning-companion-operator`), the probability that walker $i$ selects an interior walker as its companion is bounded below. Even if the selection is spatially weighted, there exists a non-zero probability mass on interior walkers:\n7361: \n7362: $$\n7363: P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq p_{\\text{interior}} > 0\n7364: $$\n7365: \n7366: where $\\mathcal{I}_{\\text{safe}} = \\{j : \\varphi_{\\text{barrier}}(x_j) = 0\\}$ is the set of safe interior walkers.\n7367: \n7368: **Step 3: Cloning score lower bound**\n7369: \n7370: Conditioning on selecting an interior companion $j$:\n7371: \n7372: $$\n7373: S_i = \\frac{V_{\\text{fit},j} - V_{\\text{fit},i}}{V_{\\text{fit},i} + \\varepsilon_{\\text{clone}}} \\geq \\frac{f(\\phi_{\\text{thresh}})}{V_{\\text{pot,max}} + \\varepsilon_{\\text{clone}}} =: s_{\\text{min}}(\\phi_{\\text{thresh}})\n7374: $$\n7375: \n7376: **Step 4: Cloning probability lower bound**\n7377: \n7378: The probability of cloning is:\n7379: \n7380: $$\n7381: p_i = P(S_i > T_i) \\cdot P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq P(s_{\\text{min}} > T_i) \\cdot p_{\\text{interior}}\n7382: $$\n7383: \n7384: Since $T_i \\sim \\text{Uniform}(0, p_{\\max})$:\n7385: \n7386: $$\n7387: P(s_{\\text{min}} > T_i) = \\min\\left(1, \\frac{s_{\\text{min}}}{p_{\\max}}\\right)\n7388: $$\n7389: \n7390: Therefore:\n7391: \n7392: $$\n7393: p_i \\geq \\min\\left(1, \\frac{s_{\\text{min}}(\\phi_{\\text{thresh}})}{p_{\\max}}\\right) \\cdot p_{\\text{interior}} =: p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7394: $$\n7395: \n7396: This bound is independent of $N$ and depends only on $\\phi_{\\text{thresh}}$ and the algorithmic parameters.\n7397: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-barrier-reduction-cloning",
      "title": "Expected Barrier Reduction for Cloned Walker",
      "start_line": 7401,
      "end_line": 7418,
      "header_lines": [
        7402
      ],
      "content_start": 7404,
      "content_end": 7417,
      "content": "7404: :label: lem-barrier-reduction-cloning\n7405: \n7406: When a boundary-exposed walker $i$ clones, its expected barrier penalty after cloning satisfies:\n7407: \n7408: $$\n7409: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid i \\text{ clones}] \\leq \\mathbb{E}[\\varphi_{\\text{barrier}}(x_{c_i})] + C_{\\text{jitter}}\n7410: $$\n7411: \n7412: where $C_{\\text{jitter}} = O(\\sigma_x^2)$ accounts for the position jitter variance.\n7413: \n7414: Furthermore, if the companion is from the safe interior:\n7415: \n7416: $$\n7417: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid c_i \\in \\mathcal{I}_{\\text{safe}}] \\leq C_{\\text{jitter}}",
      "metadata": {
        "label": "lem-barrier-reduction-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [],
      "raw_directive": "7401: ### 11.4.2. Barrier Reduction from Cloning\n7402: \n7403: :::{prf:lemma} Expected Barrier Reduction for Cloned Walker\n7404: :label: lem-barrier-reduction-cloning\n7405: \n7406: When a boundary-exposed walker $i$ clones, its expected barrier penalty after cloning satisfies:\n7407: \n7408: $$\n7409: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid i \\text{ clones}] \\leq \\mathbb{E}[\\varphi_{\\text{barrier}}(x_{c_i})] + C_{\\text{jitter}}\n7410: $$\n7411: \n7412: where $C_{\\text{jitter}} = O(\\sigma_x^2)$ accounts for the position jitter variance.\n7413: \n7414: Furthermore, if the companion is from the safe interior:\n7415: \n7416: $$\n7417: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid c_i \\in \\mathcal{I}_{\\text{safe}}] \\leq C_{\\text{jitter}}\n7418: $$"
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-barrier-reduction-cloning",
      "title": null,
      "start_line": 7420,
      "end_line": 7457,
      "header_lines": [
        7421
      ],
      "content_start": 7422,
      "content_end": 7456,
      "content": "7422: :::{prf:proof}\n7423: :label: proof-lem-barrier-reduction-cloning\n7424: **Proof.**\n7425: \n7426: When walker $i$ clones from companion $c_i$, its new position is:\n7427: \n7428: $$\n7429: x'_i = x_{c_i} + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n7430: $$\n7431: \n7432: **Case 1: Companion in safe interior**\n7433: \n7434: If $c_i \\in \\mathcal{I}_{\\text{safe}}$, then $\\varphi_{\\text{barrier}}(x_{c_i}) = 0$ by definition of the safe region.\n7435: \n7436: The Gaussian jitter has variance $\\sigma_x^2$. If $\\sigma_x$ is chosen small enough (specifically, $\\sigma_x < \\delta_{\\text{safe}}$ where $\\delta_{\\text{safe}}$ is the width of the safe interior region), then with high probability, $x'_i$ remains in the safe region:\n7437: \n7438: $$\n7439: P(\\varphi_{\\text{barrier}}(x'_i) = 0) \\geq 1 - \\epsilon_{\\text{jitter}}\n7440: $$\n7441: \n7442: In the worst case (jittering into the boundary region):\n7443: \n7444: $$\n7445: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\leq \\epsilon_{\\text{jitter}} \\cdot \\varphi_{\\text{barrier,max}} =: C_{\\text{jitter}}\n7446: $$\n7447: \n7448: **Case 2: General companion**\n7449: \n7450: For a general companion, the barrier penalty of $x'_i$ is centered around $\\varphi_{\\text{barrier}}(x_{c_i})$:\n7451: \n7452: $$\n7453: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\approx \\varphi_{\\text{barrier}}(x_{c_i}) + O(\\sigma_x^2 \\|\\nabla \\varphi_{\\text{barrier}}(x_{c_i})\\|^2)\n7454: $$\n7455: \n7456: By smoothness of $\\varphi_{\\text{barrier}}$ in the interior, the second term is bounded.",
      "metadata": {
        "label": "proof-lem-barrier-reduction-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [],
      "raw_directive": "7420: :::\n7421: \n7422: :::{prf:proof}\n7423: :label: proof-lem-barrier-reduction-cloning\n7424: **Proof.**\n7425: \n7426: When walker $i$ clones from companion $c_i$, its new position is:\n7427: \n7428: $$\n7429: x'_i = x_{c_i} + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n7430: $$\n7431: \n7432: **Case 1: Companion in safe interior**\n7433: \n7434: If $c_i \\in \\mathcal{I}_{\\text{safe}}$, then $\\varphi_{\\text{barrier}}(x_{c_i}) = 0$ by definition of the safe region.\n7435: \n7436: The Gaussian jitter has variance $\\sigma_x^2$. If $\\sigma_x$ is chosen small enough (specifically, $\\sigma_x < \\delta_{\\text{safe}}$ where $\\delta_{\\text{safe}}$ is the width of the safe interior region), then with high probability, $x'_i$ remains in the safe region:\n7437: \n7438: $$\n7439: P(\\varphi_{\\text{barrier}}(x'_i) = 0) \\geq 1 - \\epsilon_{\\text{jitter}}\n7440: $$\n7441: \n7442: In the worst case (jittering into the boundary region):\n7443: \n7444: $$\n7445: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\leq \\epsilon_{\\text{jitter}} \\cdot \\varphi_{\\text{barrier,max}} =: C_{\\text{jitter}}\n7446: $$\n7447: \n7448: **Case 2: General companion**\n7449: \n7450: For a general companion, the barrier penalty of $x'_i$ is centered around $\\varphi_{\\text{barrier}}(x_{c_i})$:\n7451: \n7452: $$\n7453: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\approx \\varphi_{\\text{barrier}}(x_{c_i}) + O(\\sigma_x^2 \\|\\nabla \\varphi_{\\text{barrier}}(x_{c_i})\\|^2)\n7454: $$\n7455: \n7456: By smoothness of $\\varphi_{\\text{barrier}}$ in the interior, the second term is bounded.\n7457: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-barrier-reduction-measurement",
      "title": null,
      "start_line": 7461,
      "end_line": 7554,
      "header_lines": [
        7462
      ],
      "content_start": 7463,
      "content_end": 7553,
      "content": "7463: :::{prf:proof}\n7464: :label: proof-lem-barrier-reduction-measurement\n7465: **Proof of {prf:ref}`thm-boundary-potential-contraction`.**\n7466: \n7467: We analyze the expected change in boundary potential:\n7468: \n7469: $$\n7470: \\Delta W_b = \\sum_{k=1,2} \\left[\\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S'_k)} \\varphi_{\\text{barrier}}(x'_{k,i}) - \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\\right]\n7471: $$\n7472: \n7473: **Step 1: Decompose by cloning action**\n7474: \n7475: For each swarm $k$, split the sum into walkers that clone and walkers that persist:\n7476: \n7477: $$\n7478: \\mathbb{E}[\\Delta W_b^{(k)}] = \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} p_{k,i} \\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] + \\frac{1}{N} \\sum_{i \\in \\mathcal{D}(S_k)} \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i})]\n7479: $$\n7480: \n7481: **Step 2: Bound contribution from boundary-exposed walkers**\n7482: \n7483: For walkers in $\\mathcal{E}_{\\text{boundary}}(S_k)$:\n7484: \n7485: - By {prf:ref}`lem-boundary-enhanced-cloning`: $p_{k,i} \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}})$\n7486: - By {prf:ref}`lem-barrier-reduction-cloning`: $\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] \\leq C_{\\text{jitter}}$\n7487: \n7488: Therefore:\n7489: \n7490: $$\n7491: \\begin{aligned}\n7492: \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{k,i} &\\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] \\\\\n7493: &\\leq \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{\\text{boundary}} [C_{\\text{jitter}} - \\varphi_{\\text{barrier}}(x_{k,i})]\n7494: \\end{aligned}\n7495: $$\n7496: \n7497: Since $\\varphi_{\\text{barrier}}(x_{k,i}) > \\phi_{\\text{thresh}}$ for $i \\in \\mathcal{E}_{\\text{boundary}}$:\n7498: \n7499: $$\n7500: \\leq -p_{\\text{boundary}} \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} [\\varphi_{\\text{barrier}}(x_{k,i}) - C_{\\text{jitter}}]\n7501: $$\n7502: \n7503: $$\n7504: \\leq -p_{\\text{boundary}} \\left[\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i}) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right]\n7505: $$\n7506: \n7507: **Step 3: Relate to total boundary potential**\n7508: \n7509: The boundary-exposed mass satisfies:\n7510: \n7511: $$\n7512: M_{\\text{boundary}}(S_k) = \\frac{1}{N}\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\n7513: $$\n7514: \n7515: If most of $W_b$ comes from exposed walkers (which is true when $W_b$ is large):\n7516: \n7517: $$\n7518: M_{\\text{boundary}}(S_k) \\geq W_b(S_k) - \\frac{k_{\\text{alive}}}{N} \\phi_{\\text{thresh}}\n7519: $$\n7520: \n7521: **Step 4: Combine to get contraction**\n7522: \n7523: Combining Steps 2-3:\n7524: \n7525: $$\n7526: \\mathbb{E}[\\Delta W_b^{(k)}] \\leq -\\frac{p_{\\text{boundary}}}{N} \\left[N \\cdot M_{\\text{boundary}}(S_k) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right] + \\text{(dead walker contribution)}\n7527: $$\n7528: \n7529: $$\n7530: \\leq -p_{\\text{boundary}} M_{\\text{boundary}}(S_k) + C'_{\\text{jitter}} + C_{\\text{dead}}\n7531: $$\n7532: \n7533: Using $M_{\\text{boundary}} \\approx W_b$ when $W_b$ is large:\n7534: \n7535: $$\n7536: \\leq -p_{\\text{boundary}} W_b(S_k) + C_{\\text{total}}\n7537: $$\n7538: \n7539: Summing over both swarms:\n7540: \n7541: $$\n7542: \\mathbb{E}[\\Delta W_b] \\leq -p_{\\text{boundary}} W_b + 2C_{\\text{total}}\n7543: $$\n7544: \n7545: **Step 5: Express as geometric contraction**\n7546: \n7547: Defining $\\kappa_b := p_{\\text{boundary}}$ and $C_b := 2C_{\\text{total}}$:\n7548: \n7549: $$\n7550: \\mathbb{E}[W_b(S')] \\leq (1 - \\kappa_b) W_b(S) + C_b\n7551: $$\n7552: \n7553: The constant $\\kappa_b > 0$ is independent of $N$ by {prf:ref}`lem-boundary-enhanced-cloning`.",
      "metadata": {
        "label": "proof-lem-barrier-reduction-measurement"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [
        "thm-boundary-potential-contraction",
        "lem-boundary-enhanced-cloning",
        "lem-barrier-reduction-cloning"
      ],
      "raw_directive": "7461: ### 11.4.3. Proof of Main Theorem\n7462: \n7463: :::{prf:proof}\n7464: :label: proof-lem-barrier-reduction-measurement\n7465: **Proof of {prf:ref}`thm-boundary-potential-contraction`.**\n7466: \n7467: We analyze the expected change in boundary potential:\n7468: \n7469: $$\n7470: \\Delta W_b = \\sum_{k=1,2} \\left[\\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S'_k)} \\varphi_{\\text{barrier}}(x'_{k,i}) - \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\\right]\n7471: $$\n7472: \n7473: **Step 1: Decompose by cloning action**\n7474: \n7475: For each swarm $k$, split the sum into walkers that clone and walkers that persist:\n7476: \n7477: $$\n7478: \\mathbb{E}[\\Delta W_b^{(k)}] = \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} p_{k,i} \\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] + \\frac{1}{N} \\sum_{i \\in \\mathcal{D}(S_k)} \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i})]\n7479: $$\n7480: \n7481: **Step 2: Bound contribution from boundary-exposed walkers**\n7482: \n7483: For walkers in $\\mathcal{E}_{\\text{boundary}}(S_k)$:\n7484: \n7485: - By {prf:ref}`lem-boundary-enhanced-cloning`: $p_{k,i} \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}})$\n7486: - By {prf:ref}`lem-barrier-reduction-cloning`: $\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] \\leq C_{\\text{jitter}}$\n7487: \n7488: Therefore:\n7489: \n7490: $$\n7491: \\begin{aligned}\n7492: \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{k,i} &\\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] \\\\\n7493: &\\leq \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{\\text{boundary}} [C_{\\text{jitter}} - \\varphi_{\\text{barrier}}(x_{k,i})]\n7494: \\end{aligned}\n7495: $$\n7496: \n7497: Since $\\varphi_{\\text{barrier}}(x_{k,i}) > \\phi_{\\text{thresh}}$ for $i \\in \\mathcal{E}_{\\text{boundary}}$:\n7498: \n7499: $$\n7500: \\leq -p_{\\text{boundary}} \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} [\\varphi_{\\text{barrier}}(x_{k,i}) - C_{\\text{jitter}}]\n7501: $$\n7502: \n7503: $$\n7504: \\leq -p_{\\text{boundary}} \\left[\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i}) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right]\n7505: $$\n7506: \n7507: **Step 3: Relate to total boundary potential**\n7508: \n7509: The boundary-exposed mass satisfies:\n7510: \n7511: $$\n7512: M_{\\text{boundary}}(S_k) = \\frac{1}{N}\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\n7513: $$\n7514: \n7515: If most of $W_b$ comes from exposed walkers (which is true when $W_b$ is large):\n7516: \n7517: $$\n7518: M_{\\text{boundary}}(S_k) \\geq W_b(S_k) - \\frac{k_{\\text{alive}}}{N} \\phi_{\\text{thresh}}\n7519: $$\n7520: \n7521: **Step 4: Combine to get contraction**\n7522: \n7523: Combining Steps 2-3:\n7524: \n7525: $$\n7526: \\mathbb{E}[\\Delta W_b^{(k)}] \\leq -\\frac{p_{\\text{boundary}}}{N} \\left[N \\cdot M_{\\text{boundary}}(S_k) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right] + \\text{(dead walker contribution)}\n7527: $$\n7528: \n7529: $$\n7530: \\leq -p_{\\text{boundary}} M_{\\text{boundary}}(S_k) + C'_{\\text{jitter}} + C_{\\text{dead}}\n7531: $$\n7532: \n7533: Using $M_{\\text{boundary}} \\approx W_b$ when $W_b$ is large:\n7534: \n7535: $$\n7536: \\leq -p_{\\text{boundary}} W_b(S_k) + C_{\\text{total}}\n7537: $$\n7538: \n7539: Summing over both swarms:\n7540: \n7541: $$\n7542: \\mathbb{E}[\\Delta W_b] \\leq -p_{\\text{boundary}} W_b + 2C_{\\text{total}}\n7543: $$\n7544: \n7545: **Step 5: Express as geometric contraction**\n7546: \n7547: Defining $\\kappa_b := p_{\\text{boundary}}$ and $C_b := 2C_{\\text{total}}$:\n7548: \n7549: $$\n7550: \\mathbb{E}[W_b(S')] \\leq (1 - \\kappa_b) W_b(S) + C_b\n7551: $$\n7552: \n7553: The constant $\\kappa_b > 0$ is independent of $N$ by {prf:ref}`lem-boundary-enhanced-cloning`.\n7554: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}