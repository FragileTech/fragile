{
  "chapter_index": 25,
  "section_id": "## 11.4. Proof of Boundary Potential Contraction",
  "directive_count": 5,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-boundary-enhanced-cloning",
      "title": "Enhanced Cloning Probability Near Boundary",
      "start_line": 7322,
      "end_line": 7332,
      "header_lines": [
        7323
      ],
      "content_start": 7325,
      "content_end": 7331,
      "content": "7325: :label: lem-boundary-enhanced-cloning\n7326: \n7327: For any walker $i$ in the boundary-exposed set $\\mathcal{E}_{\\text{boundary}}(S)$, its cloning probability satisfies:\n7328: \n7329: $$\n7330: p_i \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7331: $$",
      "metadata": {
        "label": "lem-boundary-enhanced-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [],
      "raw_directive": "7322: ### 11.4.1. Cloning Probability for Boundary-Exposed Walkers\n7323: \n7324: :::{prf:lemma} Enhanced Cloning Probability Near Boundary\n7325: :label: lem-boundary-enhanced-cloning\n7326: \n7327: For any walker $i$ in the boundary-exposed set $\\mathcal{E}_{\\text{boundary}}(S)$, its cloning probability satisfies:\n7328: \n7329: $$\n7330: p_i \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7331: $$\n7332: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-boundary-enhanced-cloning",
      "title": null,
      "start_line": 7334,
      "end_line": 7389,
      "header_lines": [
        7335
      ],
      "content_start": 7336,
      "content_end": 7388,
      "content": "7336: :::{prf:proof}\n7337: :label: proof-lem-boundary-enhanced-cloning\n7338: **Proof.**\n7339: \n7340: Let $i \\in \\mathcal{E}_{\\text{boundary}}(S)$ be a boundary-exposed walker. By definition, $\\varphi_{\\text{barrier}}(x_i) > \\phi_{\\text{thresh}}$.\n7341: \n7342: **Step 1: Fitness penalty from barrier**\n7343: \n7344: By {prf:ref}`lem-fitness-gradient-boundary`, walker $i$ has lower fitness than interior walkers. Specifically, there exists at least one interior walker $j$ (in the safe region where $\\varphi_{\\text{barrier}}(x_j) = 0$) such that:\n7345: \n7346: $$\n7347: V_{\\text{fit},i} < V_{\\text{fit},j} - f(\\phi_{\\text{thresh}})\n7348: $$\n7349: \n7350: **Step 2: Companion selection probability**\n7351: \n7352: In the companion selection operator ({prf:ref}`def-decision-operator`), the probability that walker $i$ selects an interior walker as its companion is bounded below. Even if the selection is spatially weighted, there exists a non-zero probability mass on interior walkers:\n7353: \n7354: $$\n7355: P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq p_{\\text{interior}} > 0\n7356: $$\n7357: \n7358: where $\\mathcal{I}_{\\text{safe}} = \\{j : \\varphi_{\\text{barrier}}(x_j) = 0\\}$ is the set of safe interior walkers.\n7359: \n7360: **Step 3: Cloning score lower bound**\n7361: \n7362: Conditioning on selecting an interior companion $j$:\n7363: \n7364: $$\n7365: S_i = \\frac{V_{\\text{fit},j} - V_{\\text{fit},i}}{V_{\\text{fit},i} + \\varepsilon_{\\text{clone}}} \\geq \\frac{f(\\phi_{\\text{thresh}})}{V_{\\text{pot,max}} + \\varepsilon_{\\text{clone}}} =: s_{\\text{min}}(\\phi_{\\text{thresh}})\n7366: $$\n7367: \n7368: **Step 4: Cloning probability lower bound**\n7369: \n7370: The probability of cloning is:\n7371: \n7372: $$\n7373: p_i = P(S_i > T_i) \\cdot P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq P(s_{\\text{min}} > T_i) \\cdot p_{\\text{interior}}\n7374: $$\n7375: \n7376: Since $T_i \\sim \\text{Uniform}(0, p_{\\max})$:\n7377: \n7378: $$\n7379: P(s_{\\text{min}} > T_i) = \\min\\left(1, \\frac{s_{\\text{min}}}{p_{\\max}}\\right)\n7380: $$\n7381: \n7382: Therefore:\n7383: \n7384: $$\n7385: p_i \\geq \\min\\left(1, \\frac{s_{\\text{min}}(\\phi_{\\text{thresh}})}{p_{\\max}}\\right) \\cdot p_{\\text{interior}} =: p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7386: $$\n7387: \n7388: This bound is independent of $N$ and depends only on $\\phi_{\\text{thresh}}$ and the algorithmic parameters.",
      "metadata": {
        "label": "proof-lem-boundary-enhanced-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [
        "lem-fitness-gradient-boundary",
        "def-decision-operator"
      ],
      "raw_directive": "7334: :::\n7335: \n7336: :::{prf:proof}\n7337: :label: proof-lem-boundary-enhanced-cloning\n7338: **Proof.**\n7339: \n7340: Let $i \\in \\mathcal{E}_{\\text{boundary}}(S)$ be a boundary-exposed walker. By definition, $\\varphi_{\\text{barrier}}(x_i) > \\phi_{\\text{thresh}}$.\n7341: \n7342: **Step 1: Fitness penalty from barrier**\n7343: \n7344: By {prf:ref}`lem-fitness-gradient-boundary`, walker $i$ has lower fitness than interior walkers. Specifically, there exists at least one interior walker $j$ (in the safe region where $\\varphi_{\\text{barrier}}(x_j) = 0$) such that:\n7345: \n7346: $$\n7347: V_{\\text{fit},i} < V_{\\text{fit},j} - f(\\phi_{\\text{thresh}})\n7348: $$\n7349: \n7350: **Step 2: Companion selection probability**\n7351: \n7352: In the companion selection operator ({prf:ref}`def-decision-operator`), the probability that walker $i$ selects an interior walker as its companion is bounded below. Even if the selection is spatially weighted, there exists a non-zero probability mass on interior walkers:\n7353: \n7354: $$\n7355: P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq p_{\\text{interior}} > 0\n7356: $$\n7357: \n7358: where $\\mathcal{I}_{\\text{safe}} = \\{j : \\varphi_{\\text{barrier}}(x_j) = 0\\}$ is the set of safe interior walkers.\n7359: \n7360: **Step 3: Cloning score lower bound**\n7361: \n7362: Conditioning on selecting an interior companion $j$:\n7363: \n7364: $$\n7365: S_i = \\frac{V_{\\text{fit},j} - V_{\\text{fit},i}}{V_{\\text{fit},i} + \\varepsilon_{\\text{clone}}} \\geq \\frac{f(\\phi_{\\text{thresh}})}{V_{\\text{pot,max}} + \\varepsilon_{\\text{clone}}} =: s_{\\text{min}}(\\phi_{\\text{thresh}})\n7366: $$\n7367: \n7368: **Step 4: Cloning probability lower bound**\n7369: \n7370: The probability of cloning is:\n7371: \n7372: $$\n7373: p_i = P(S_i > T_i) \\cdot P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq P(s_{\\text{min}} > T_i) \\cdot p_{\\text{interior}}\n7374: $$\n7375: \n7376: Since $T_i \\sim \\text{Uniform}(0, p_{\\max})$:\n7377: \n7378: $$\n7379: P(s_{\\text{min}} > T_i) = \\min\\left(1, \\frac{s_{\\text{min}}}{p_{\\max}}\\right)\n7380: $$\n7381: \n7382: Therefore:\n7383: \n7384: $$\n7385: p_i \\geq \\min\\left(1, \\frac{s_{\\text{min}}(\\phi_{\\text{thresh}})}{p_{\\max}}\\right) \\cdot p_{\\text{interior}} =: p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7386: $$\n7387: \n7388: This bound is independent of $N$ and depends only on $\\phi_{\\text{thresh}}$ and the algorithmic parameters.\n7389: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-barrier-reduction-cloning",
      "title": "Expected Barrier Reduction for Cloned Walker",
      "start_line": 7393,
      "end_line": 7410,
      "header_lines": [
        7394
      ],
      "content_start": 7396,
      "content_end": 7409,
      "content": "7396: :label: lem-barrier-reduction-cloning\n7397: \n7398: When a boundary-exposed walker $i$ clones, its expected barrier penalty after cloning satisfies:\n7399: \n7400: $$\n7401: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid i \\text{ clones}] \\leq \\mathbb{E}[\\varphi_{\\text{barrier}}(x_{c_i})] + C_{\\text{jitter}}\n7402: $$\n7403: \n7404: where $C_{\\text{jitter}} = O(\\sigma_x^2)$ accounts for the position jitter variance.\n7405: \n7406: Furthermore, if the companion is from the safe interior:\n7407: \n7408: $$\n7409: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid c_i \\in \\mathcal{I}_{\\text{safe}}] \\leq C_{\\text{jitter}}",
      "metadata": {
        "label": "lem-barrier-reduction-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [],
      "raw_directive": "7393: ### 11.4.2. Barrier Reduction from Cloning\n7394: \n7395: :::{prf:lemma} Expected Barrier Reduction for Cloned Walker\n7396: :label: lem-barrier-reduction-cloning\n7397: \n7398: When a boundary-exposed walker $i$ clones, its expected barrier penalty after cloning satisfies:\n7399: \n7400: $$\n7401: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid i \\text{ clones}] \\leq \\mathbb{E}[\\varphi_{\\text{barrier}}(x_{c_i})] + C_{\\text{jitter}}\n7402: $$\n7403: \n7404: where $C_{\\text{jitter}} = O(\\sigma_x^2)$ accounts for the position jitter variance.\n7405: \n7406: Furthermore, if the companion is from the safe interior:\n7407: \n7408: $$\n7409: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid c_i \\in \\mathcal{I}_{\\text{safe}}] \\leq C_{\\text{jitter}}\n7410: $$"
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-barrier-reduction-cloning",
      "title": null,
      "start_line": 7412,
      "end_line": 7449,
      "header_lines": [
        7413
      ],
      "content_start": 7414,
      "content_end": 7448,
      "content": "7414: :::{prf:proof}\n7415: :label: proof-lem-barrier-reduction-cloning\n7416: **Proof.**\n7417: \n7418: When walker $i$ clones from companion $c_i$, its new position is:\n7419: \n7420: $$\n7421: x'_i = x_{c_i} + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n7422: $$\n7423: \n7424: **Case 1: Companion in safe interior**\n7425: \n7426: If $c_i \\in \\mathcal{I}_{\\text{safe}}$, then $\\varphi_{\\text{barrier}}(x_{c_i}) = 0$ by definition of the safe region.\n7427: \n7428: The Gaussian jitter has variance $\\sigma_x^2$. If $\\sigma_x$ is chosen small enough (specifically, $\\sigma_x < \\delta_{\\text{safe}}$ where $\\delta_{\\text{safe}}$ is the width of the safe interior region), then with high probability, $x'_i$ remains in the safe region:\n7429: \n7430: $$\n7431: P(\\varphi_{\\text{barrier}}(x'_i) = 0) \\geq 1 - \\epsilon_{\\text{jitter}}\n7432: $$\n7433: \n7434: In the worst case (jittering into the boundary region):\n7435: \n7436: $$\n7437: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\leq \\epsilon_{\\text{jitter}} \\cdot \\varphi_{\\text{barrier,max}} =: C_{\\text{jitter}}\n7438: $$\n7439: \n7440: **Case 2: General companion**\n7441: \n7442: For a general companion, the barrier penalty of $x'_i$ is centered around $\\varphi_{\\text{barrier}}(x_{c_i})$:\n7443: \n7444: $$\n7445: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\approx \\varphi_{\\text{barrier}}(x_{c_i}) + O(\\sigma_x^2 \\|\\nabla \\varphi_{\\text{barrier}}(x_{c_i})\\|^2)\n7446: $$\n7447: \n7448: By smoothness of $\\varphi_{\\text{barrier}}$ in the interior, the second term is bounded.",
      "metadata": {
        "label": "proof-lem-barrier-reduction-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [],
      "raw_directive": "7412: :::\n7413: \n7414: :::{prf:proof}\n7415: :label: proof-lem-barrier-reduction-cloning\n7416: **Proof.**\n7417: \n7418: When walker $i$ clones from companion $c_i$, its new position is:\n7419: \n7420: $$\n7421: x'_i = x_{c_i} + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n7422: $$\n7423: \n7424: **Case 1: Companion in safe interior**\n7425: \n7426: If $c_i \\in \\mathcal{I}_{\\text{safe}}$, then $\\varphi_{\\text{barrier}}(x_{c_i}) = 0$ by definition of the safe region.\n7427: \n7428: The Gaussian jitter has variance $\\sigma_x^2$. If $\\sigma_x$ is chosen small enough (specifically, $\\sigma_x < \\delta_{\\text{safe}}$ where $\\delta_{\\text{safe}}$ is the width of the safe interior region), then with high probability, $x'_i$ remains in the safe region:\n7429: \n7430: $$\n7431: P(\\varphi_{\\text{barrier}}(x'_i) = 0) \\geq 1 - \\epsilon_{\\text{jitter}}\n7432: $$\n7433: \n7434: In the worst case (jittering into the boundary region):\n7435: \n7436: $$\n7437: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\leq \\epsilon_{\\text{jitter}} \\cdot \\varphi_{\\text{barrier,max}} =: C_{\\text{jitter}}\n7438: $$\n7439: \n7440: **Case 2: General companion**\n7441: \n7442: For a general companion, the barrier penalty of $x'_i$ is centered around $\\varphi_{\\text{barrier}}(x_{c_i})$:\n7443: \n7444: $$\n7445: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\approx \\varphi_{\\text{barrier}}(x_{c_i}) + O(\\sigma_x^2 \\|\\nabla \\varphi_{\\text{barrier}}(x_{c_i})\\|^2)\n7446: $$\n7447: \n7448: By smoothness of $\\varphi_{\\text{barrier}}$ in the interior, the second term is bounded.\n7449: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-barrier-reduction-measurement",
      "title": null,
      "start_line": 7453,
      "end_line": 7546,
      "header_lines": [
        7454
      ],
      "content_start": 7455,
      "content_end": 7545,
      "content": "7455: :::{prf:proof}\n7456: :label: proof-lem-barrier-reduction-measurement\n7457: **Proof of {prf:ref}`thm-boundary-potential-contraction`.**\n7458: \n7459: We analyze the expected change in boundary potential:\n7460: \n7461: $$\n7462: \\Delta W_b = \\sum_{k=1,2} \\left[\\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S'_k)} \\varphi_{\\text{barrier}}(x'_{k,i}) - \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\\right]\n7463: $$\n7464: \n7465: **Step 1: Decompose by cloning action**\n7466: \n7467: For each swarm $k$, split the sum into walkers that clone and walkers that persist:\n7468: \n7469: $$\n7470: \\mathbb{E}[\\Delta W_b^{(k)}] = \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} p_{k,i} \\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] + \\frac{1}{N} \\sum_{i \\in \\mathcal{D}(S_k)} \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i})]\n7471: $$\n7472: \n7473: **Step 2: Bound contribution from boundary-exposed walkers**\n7474: \n7475: For walkers in $\\mathcal{E}_{\\text{boundary}}(S_k)$:\n7476: \n7477: - By {prf:ref}`lem-boundary-enhanced-cloning`: $p_{k,i} \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}})$\n7478: - By {prf:ref}`lem-barrier-reduction-cloning`: $\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] \\leq C_{\\text{jitter}}$\n7479: \n7480: Therefore:\n7481: \n7482: $$\n7483: \\begin{aligned}\n7484: \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{k,i} &\\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] \\\\\n7485: &\\leq \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{\\text{boundary}} [C_{\\text{jitter}} - \\varphi_{\\text{barrier}}(x_{k,i})]\n7486: \\end{aligned}\n7487: $$\n7488: \n7489: Since $\\varphi_{\\text{barrier}}(x_{k,i}) > \\phi_{\\text{thresh}}$ for $i \\in \\mathcal{E}_{\\text{boundary}}$:\n7490: \n7491: $$\n7492: \\leq -p_{\\text{boundary}} \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} [\\varphi_{\\text{barrier}}(x_{k,i}) - C_{\\text{jitter}}]\n7493: $$\n7494: \n7495: $$\n7496: \\leq -p_{\\text{boundary}} \\left[\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i}) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right]\n7497: $$\n7498: \n7499: **Step 3: Relate to total boundary potential**\n7500: \n7501: The boundary-exposed mass satisfies:\n7502: \n7503: $$\n7504: M_{\\text{boundary}}(S_k) = \\frac{1}{N}\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\n7505: $$\n7506: \n7507: If most of $W_b$ comes from exposed walkers (which is true when $W_b$ is large):\n7508: \n7509: $$\n7510: M_{\\text{boundary}}(S_k) \\geq W_b(S_k) - \\frac{k_{\\text{alive}}}{N} \\phi_{\\text{thresh}}\n7511: $$\n7512: \n7513: **Step 4: Combine to get contraction**\n7514: \n7515: Combining Steps 2-3:\n7516: \n7517: $$\n7518: \\mathbb{E}[\\Delta W_b^{(k)}] \\leq -\\frac{p_{\\text{boundary}}}{N} \\left[N \\cdot M_{\\text{boundary}}(S_k) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right] + \\text{(dead walker contribution)}\n7519: $$\n7520: \n7521: $$\n7522: \\leq -p_{\\text{boundary}} M_{\\text{boundary}}(S_k) + C'_{\\text{jitter}} + C_{\\text{dead}}\n7523: $$\n7524: \n7525: Using $M_{\\text{boundary}} \\approx W_b$ when $W_b$ is large:\n7526: \n7527: $$\n7528: \\leq -p_{\\text{boundary}} W_b(S_k) + C_{\\text{total}}\n7529: $$\n7530: \n7531: Summing over both swarms:\n7532: \n7533: $$\n7534: \\mathbb{E}[\\Delta W_b] \\leq -p_{\\text{boundary}} W_b + 2C_{\\text{total}}\n7535: $$\n7536: \n7537: **Step 5: Express as geometric contraction**\n7538: \n7539: Defining $\\kappa_b := p_{\\text{boundary}}$ and $C_b := 2C_{\\text{total}}$:\n7540: \n7541: $$\n7542: \\mathbb{E}[W_b(S')] \\leq (1 - \\kappa_b) W_b(S) + C_b\n7543: $$\n7544: \n7545: The constant $\\kappa_b > 0$ is independent of $N$ by {prf:ref}`lem-boundary-enhanced-cloning`.",
      "metadata": {
        "label": "proof-lem-barrier-reduction-measurement"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [
        "thm-boundary-potential-contraction",
        "lem-boundary-enhanced-cloning",
        "lem-barrier-reduction-cloning"
      ],
      "raw_directive": "7453: ### 11.4.3. Proof of Main Theorem\n7454: \n7455: :::{prf:proof}\n7456: :label: proof-lem-barrier-reduction-measurement\n7457: **Proof of {prf:ref}`thm-boundary-potential-contraction`.**\n7458: \n7459: We analyze the expected change in boundary potential:\n7460: \n7461: $$\n7462: \\Delta W_b = \\sum_{k=1,2} \\left[\\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S'_k)} \\varphi_{\\text{barrier}}(x'_{k,i}) - \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\\right]\n7463: $$\n7464: \n7465: **Step 1: Decompose by cloning action**\n7466: \n7467: For each swarm $k$, split the sum into walkers that clone and walkers that persist:\n7468: \n7469: $$\n7470: \\mathbb{E}[\\Delta W_b^{(k)}] = \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} p_{k,i} \\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] + \\frac{1}{N} \\sum_{i \\in \\mathcal{D}(S_k)} \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i})]\n7471: $$\n7472: \n7473: **Step 2: Bound contribution from boundary-exposed walkers**\n7474: \n7475: For walkers in $\\mathcal{E}_{\\text{boundary}}(S_k)$:\n7476: \n7477: - By {prf:ref}`lem-boundary-enhanced-cloning`: $p_{k,i} \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}})$\n7478: - By {prf:ref}`lem-barrier-reduction-cloning`: $\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] \\leq C_{\\text{jitter}}$\n7479: \n7480: Therefore:\n7481: \n7482: $$\n7483: \\begin{aligned}\n7484: \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{k,i} &\\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] \\\\\n7485: &\\leq \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{\\text{boundary}} [C_{\\text{jitter}} - \\varphi_{\\text{barrier}}(x_{k,i})]\n7486: \\end{aligned}\n7487: $$\n7488: \n7489: Since $\\varphi_{\\text{barrier}}(x_{k,i}) > \\phi_{\\text{thresh}}$ for $i \\in \\mathcal{E}_{\\text{boundary}}$:\n7490: \n7491: $$\n7492: \\leq -p_{\\text{boundary}} \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} [\\varphi_{\\text{barrier}}(x_{k,i}) - C_{\\text{jitter}}]\n7493: $$\n7494: \n7495: $$\n7496: \\leq -p_{\\text{boundary}} \\left[\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i}) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right]\n7497: $$\n7498: \n7499: **Step 3: Relate to total boundary potential**\n7500: \n7501: The boundary-exposed mass satisfies:\n7502: \n7503: $$\n7504: M_{\\text{boundary}}(S_k) = \\frac{1}{N}\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\n7505: $$\n7506: \n7507: If most of $W_b$ comes from exposed walkers (which is true when $W_b$ is large):\n7508: \n7509: $$\n7510: M_{\\text{boundary}}(S_k) \\geq W_b(S_k) - \\frac{k_{\\text{alive}}}{N} \\phi_{\\text{thresh}}\n7511: $$\n7512: \n7513: **Step 4: Combine to get contraction**\n7514: \n7515: Combining Steps 2-3:\n7516: \n7517: $$\n7518: \\mathbb{E}[\\Delta W_b^{(k)}] \\leq -\\frac{p_{\\text{boundary}}}{N} \\left[N \\cdot M_{\\text{boundary}}(S_k) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right] + \\text{(dead walker contribution)}\n7519: $$\n7520: \n7521: $$\n7522: \\leq -p_{\\text{boundary}} M_{\\text{boundary}}(S_k) + C'_{\\text{jitter}} + C_{\\text{dead}}\n7523: $$\n7524: \n7525: Using $M_{\\text{boundary}} \\approx W_b$ when $W_b$ is large:\n7526: \n7527: $$\n7528: \\leq -p_{\\text{boundary}} W_b(S_k) + C_{\\text{total}}\n7529: $$\n7530: \n7531: Summing over both swarms:\n7532: \n7533: $$\n7534: \\mathbb{E}[\\Delta W_b] \\leq -p_{\\text{boundary}} W_b + 2C_{\\text{total}}\n7535: $$\n7536: \n7537: **Step 5: Express as geometric contraction**\n7538: \n7539: Defining $\\kappa_b := p_{\\text{boundary}}$ and $C_b := 2C_{\\text{total}}$:\n7540: \n7541: $$\n7542: \\mathbb{E}[W_b(S')] \\leq (1 - \\kappa_b) W_b(S) + C_b\n7543: $$\n7544: \n7545: The constant $\\kappa_b > 0$ is independent of $N$ by {prf:ref}`lem-boundary-enhanced-cloning`.\n7546: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}