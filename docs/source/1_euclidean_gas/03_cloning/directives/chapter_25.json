{
  "chapter_index": 25,
  "section_id": "## 11.4. Proof of Boundary Potential Contraction",
  "directive_count": 5,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-boundary-enhanced-cloning",
      "title": "Enhanced Cloning Probability Near Boundary",
      "start_line": 7376,
      "end_line": 7386,
      "header_lines": [
        7377
      ],
      "content_start": 7379,
      "content_end": 7385,
      "content": "7379: :label: lem-boundary-enhanced-cloning\n7380: \n7381: For any walker $i$ in the boundary-exposed set $\\mathcal{E}_{\\text{boundary}}(S)$, its cloning probability satisfies:\n7382: \n7383: $$\n7384: p_i \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7385: $$",
      "metadata": {
        "label": "lem-boundary-enhanced-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [],
      "raw_directive": "7376: ### 11.4.1. Cloning Probability for Boundary-Exposed Walkers\n7377: \n7378: :::{prf:lemma} Enhanced Cloning Probability Near Boundary\n7379: :label: lem-boundary-enhanced-cloning\n7380: \n7381: For any walker $i$ in the boundary-exposed set $\\mathcal{E}_{\\text{boundary}}(S)$, its cloning probability satisfies:\n7382: \n7383: $$\n7384: p_i \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7385: $$\n7386: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-boundary-enhanced-cloning",
      "title": null,
      "start_line": 7388,
      "end_line": 7443,
      "header_lines": [
        7389
      ],
      "content_start": 7390,
      "content_end": 7442,
      "content": "7390: :::{prf:proof}\n7391: :label: proof-lem-boundary-enhanced-cloning\n7392: **Proof.**\n7393: \n7394: Let $i \\in \\mathcal{E}_{\\text{boundary}}(S)$ be a boundary-exposed walker. By definition, $\\varphi_{\\text{barrier}}(x_i) > \\phi_{\\text{thresh}}$.\n7395: \n7396: **Step 1: Fitness penalty from barrier**\n7397: \n7398: By {prf:ref}`lem-fitness-gradient-boundary`, walker $i$ has lower fitness than interior walkers. Specifically, there exists at least one interior walker $j$ (in the safe region where $\\varphi_{\\text{barrier}}(x_j) = 0$) such that:\n7399: \n7400: $$\n7401: V_{\\text{fit},i} < V_{\\text{fit},j} - f(\\phi_{\\text{thresh}})\n7402: $$\n7403: \n7404: **Step 2: Companion selection probability**\n7405: \n7406: In the companion selection operator (see {prf:ref}`def-cloning-companion-operator`), the probability that walker $i$ selects an interior walker as its companion is bounded below. Even if the selection is spatially weighted, there exists a non-zero probability mass on interior walkers:\n7407: \n7408: $$\n7409: P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq p_{\\text{interior}} > 0\n7410: $$\n7411: \n7412: where $\\mathcal{I}_{\\text{safe}} = \\{j : \\varphi_{\\text{barrier}}(x_j) = 0\\}$ is the set of safe interior walkers.\n7413: \n7414: **Step 3: Cloning score lower bound**\n7415: \n7416: Conditioning on selecting an interior companion $j$:\n7417: \n7418: $$\n7419: S_i = \\frac{V_{\\text{fit},j} - V_{\\text{fit},i}}{V_{\\text{fit},i} + \\varepsilon_{\\text{clone}}} \\geq \\frac{f(\\phi_{\\text{thresh}})}{V_{\\text{pot,max}} + \\varepsilon_{\\text{clone}}} =: s_{\\text{min}}(\\phi_{\\text{thresh}})\n7420: $$\n7421: \n7422: **Step 4: Cloning probability lower bound**\n7423: \n7424: The probability of cloning is:\n7425: \n7426: $$\n7427: p_i = P(S_i > T_i) \\cdot P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq P(s_{\\text{min}} > T_i) \\cdot p_{\\text{interior}}\n7428: $$\n7429: \n7430: Since $T_i \\sim \\text{Uniform}(0, p_{\\max})$:\n7431: \n7432: $$\n7433: P(s_{\\text{min}} > T_i) = \\min\\left(1, \\frac{s_{\\text{min}}}{p_{\\max}}\\right)\n7434: $$\n7435: \n7436: Therefore:\n7437: \n7438: $$\n7439: p_i \\geq \\min\\left(1, \\frac{s_{\\text{min}}(\\phi_{\\text{thresh}})}{p_{\\max}}\\right) \\cdot p_{\\text{interior}} =: p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7440: $$\n7441: \n7442: This bound is independent of $N$ and depends only on $\\phi_{\\text{thresh}}$ and the algorithmic parameters.",
      "metadata": {
        "label": "proof-lem-boundary-enhanced-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [
        "lem-fitness-gradient-boundary",
        "def-cloning-companion-operator"
      ],
      "raw_directive": "7388: :::\n7389: \n7390: :::{prf:proof}\n7391: :label: proof-lem-boundary-enhanced-cloning\n7392: **Proof.**\n7393: \n7394: Let $i \\in \\mathcal{E}_{\\text{boundary}}(S)$ be a boundary-exposed walker. By definition, $\\varphi_{\\text{barrier}}(x_i) > \\phi_{\\text{thresh}}$.\n7395: \n7396: **Step 1: Fitness penalty from barrier**\n7397: \n7398: By {prf:ref}`lem-fitness-gradient-boundary`, walker $i$ has lower fitness than interior walkers. Specifically, there exists at least one interior walker $j$ (in the safe region where $\\varphi_{\\text{barrier}}(x_j) = 0$) such that:\n7399: \n7400: $$\n7401: V_{\\text{fit},i} < V_{\\text{fit},j} - f(\\phi_{\\text{thresh}})\n7402: $$\n7403: \n7404: **Step 2: Companion selection probability**\n7405: \n7406: In the companion selection operator (see {prf:ref}`def-cloning-companion-operator`), the probability that walker $i$ selects an interior walker as its companion is bounded below. Even if the selection is spatially weighted, there exists a non-zero probability mass on interior walkers:\n7407: \n7408: $$\n7409: P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq p_{\\text{interior}} > 0\n7410: $$\n7411: \n7412: where $\\mathcal{I}_{\\text{safe}} = \\{j : \\varphi_{\\text{barrier}}(x_j) = 0\\}$ is the set of safe interior walkers.\n7413: \n7414: **Step 3: Cloning score lower bound**\n7415: \n7416: Conditioning on selecting an interior companion $j$:\n7417: \n7418: $$\n7419: S_i = \\frac{V_{\\text{fit},j} - V_{\\text{fit},i}}{V_{\\text{fit},i} + \\varepsilon_{\\text{clone}}} \\geq \\frac{f(\\phi_{\\text{thresh}})}{V_{\\text{pot,max}} + \\varepsilon_{\\text{clone}}} =: s_{\\text{min}}(\\phi_{\\text{thresh}})\n7420: $$\n7421: \n7422: **Step 4: Cloning probability lower bound**\n7423: \n7424: The probability of cloning is:\n7425: \n7426: $$\n7427: p_i = P(S_i > T_i) \\cdot P(c_i \\in \\mathcal{I}_{\\text{safe}}) \\geq P(s_{\\text{min}} > T_i) \\cdot p_{\\text{interior}}\n7428: $$\n7429: \n7430: Since $T_i \\sim \\text{Uniform}(0, p_{\\max})$:\n7431: \n7432: $$\n7433: P(s_{\\text{min}} > T_i) = \\min\\left(1, \\frac{s_{\\text{min}}}{p_{\\max}}\\right)\n7434: $$\n7435: \n7436: Therefore:\n7437: \n7438: $$\n7439: p_i \\geq \\min\\left(1, \\frac{s_{\\text{min}}(\\phi_{\\text{thresh}})}{p_{\\max}}\\right) \\cdot p_{\\text{interior}} =: p_{\\text{boundary}}(\\phi_{\\text{thresh}}) > 0\n7440: $$\n7441: \n7442: This bound is independent of $N$ and depends only on $\\phi_{\\text{thresh}}$ and the algorithmic parameters.\n7443: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-barrier-reduction-cloning",
      "title": "Expected Barrier Reduction for Cloned Walker",
      "start_line": 7447,
      "end_line": 7464,
      "header_lines": [
        7448
      ],
      "content_start": 7450,
      "content_end": 7463,
      "content": "7450: :label: lem-barrier-reduction-cloning\n7451: \n7452: When a boundary-exposed walker $i$ clones, its expected barrier penalty after cloning satisfies:\n7453: \n7454: $$\n7455: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid i \\text{ clones}] \\leq \\mathbb{E}[\\varphi_{\\text{barrier}}(x_{c_i})] + C_{\\text{jitter}}\n7456: $$\n7457: \n7458: where $C_{\\text{jitter}} = O(\\sigma_x^2)$ accounts for the position jitter variance.\n7459: \n7460: Furthermore, if the companion is from the safe interior:\n7461: \n7462: $$\n7463: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid c_i \\in \\mathcal{I}_{\\text{safe}}] \\leq C_{\\text{jitter}}",
      "metadata": {
        "label": "lem-barrier-reduction-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [],
      "raw_directive": "7447: ### 11.4.2. Barrier Reduction from Cloning\n7448: \n7449: :::{prf:lemma} Expected Barrier Reduction for Cloned Walker\n7450: :label: lem-barrier-reduction-cloning\n7451: \n7452: When a boundary-exposed walker $i$ clones, its expected barrier penalty after cloning satisfies:\n7453: \n7454: $$\n7455: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid i \\text{ clones}] \\leq \\mathbb{E}[\\varphi_{\\text{barrier}}(x_{c_i})] + C_{\\text{jitter}}\n7456: $$\n7457: \n7458: where $C_{\\text{jitter}} = O(\\sigma_x^2)$ accounts for the position jitter variance.\n7459: \n7460: Furthermore, if the companion is from the safe interior:\n7461: \n7462: $$\n7463: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i) \\mid c_i \\in \\mathcal{I}_{\\text{safe}}] \\leq C_{\\text{jitter}}\n7464: $$"
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-barrier-reduction-cloning",
      "title": null,
      "start_line": 7466,
      "end_line": 7503,
      "header_lines": [
        7467
      ],
      "content_start": 7468,
      "content_end": 7502,
      "content": "7468: :::{prf:proof}\n7469: :label: proof-lem-barrier-reduction-cloning\n7470: **Proof.**\n7471: \n7472: When walker $i$ clones from companion $c_i$, its new position is:\n7473: \n7474: $$\n7475: x'_i = x_{c_i} + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n7476: $$\n7477: \n7478: **Case 1: Companion in safe interior**\n7479: \n7480: If $c_i \\in \\mathcal{I}_{\\text{safe}}$, then $\\varphi_{\\text{barrier}}(x_{c_i}) = 0$ by definition of the safe region.\n7481: \n7482: The Gaussian jitter has variance $\\sigma_x^2$. If $\\sigma_x$ is chosen small enough (specifically, $\\sigma_x < \\delta_{\\text{safe}}$ where $\\delta_{\\text{safe}}$ is the width of the safe interior region), then with high probability, $x'_i$ remains in the safe region:\n7483: \n7484: $$\n7485: P(\\varphi_{\\text{barrier}}(x'_i) = 0) \\geq 1 - \\epsilon_{\\text{jitter}}\n7486: $$\n7487: \n7488: In the worst case (jittering into the boundary region):\n7489: \n7490: $$\n7491: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\leq \\epsilon_{\\text{jitter}} \\cdot \\varphi_{\\text{barrier,max}} =: C_{\\text{jitter}}\n7492: $$\n7493: \n7494: **Case 2: General companion**\n7495: \n7496: For a general companion, the barrier penalty of $x'_i$ is centered around $\\varphi_{\\text{barrier}}(x_{c_i})$:\n7497: \n7498: $$\n7499: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\approx \\varphi_{\\text{barrier}}(x_{c_i}) + O(\\sigma_x^2 \\|\\nabla \\varphi_{\\text{barrier}}(x_{c_i})\\|^2)\n7500: $$\n7501: \n7502: By smoothness of $\\varphi_{\\text{barrier}}$ in the interior, the second term is bounded.",
      "metadata": {
        "label": "proof-lem-barrier-reduction-cloning"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [],
      "raw_directive": "7466: :::\n7467: \n7468: :::{prf:proof}\n7469: :label: proof-lem-barrier-reduction-cloning\n7470: **Proof.**\n7471: \n7472: When walker $i$ clones from companion $c_i$, its new position is:\n7473: \n7474: $$\n7475: x'_i = x_{c_i} + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n7476: $$\n7477: \n7478: **Case 1: Companion in safe interior**\n7479: \n7480: If $c_i \\in \\mathcal{I}_{\\text{safe}}$, then $\\varphi_{\\text{barrier}}(x_{c_i}) = 0$ by definition of the safe region.\n7481: \n7482: The Gaussian jitter has variance $\\sigma_x^2$. If $\\sigma_x$ is chosen small enough (specifically, $\\sigma_x < \\delta_{\\text{safe}}$ where $\\delta_{\\text{safe}}$ is the width of the safe interior region), then with high probability, $x'_i$ remains in the safe region:\n7483: \n7484: $$\n7485: P(\\varphi_{\\text{barrier}}(x'_i) = 0) \\geq 1 - \\epsilon_{\\text{jitter}}\n7486: $$\n7487: \n7488: In the worst case (jittering into the boundary region):\n7489: \n7490: $$\n7491: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\leq \\epsilon_{\\text{jitter}} \\cdot \\varphi_{\\text{barrier,max}} =: C_{\\text{jitter}}\n7492: $$\n7493: \n7494: **Case 2: General companion**\n7495: \n7496: For a general companion, the barrier penalty of $x'_i$ is centered around $\\varphi_{\\text{barrier}}(x_{c_i})$:\n7497: \n7498: $$\n7499: \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_i)] \\approx \\varphi_{\\text{barrier}}(x_{c_i}) + O(\\sigma_x^2 \\|\\nabla \\varphi_{\\text{barrier}}(x_{c_i})\\|^2)\n7500: $$\n7501: \n7502: By smoothness of $\\varphi_{\\text{barrier}}$ in the interior, the second term is bounded.\n7503: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-barrier-reduction-measurement",
      "title": null,
      "start_line": 7507,
      "end_line": 7600,
      "header_lines": [
        7508
      ],
      "content_start": 7509,
      "content_end": 7599,
      "content": "7509: :::{prf:proof}\n7510: :label: proof-lem-barrier-reduction-measurement\n7511: **Proof of {prf:ref}`thm-boundary-potential-contraction`.**\n7512: \n7513: We analyze the expected change in boundary potential:\n7514: \n7515: $$\n7516: \\Delta W_b = \\sum_{k=1,2} \\left[\\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S'_k)} \\varphi_{\\text{barrier}}(x'_{k,i}) - \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\\right]\n7517: $$\n7518: \n7519: **Step 1: Decompose by cloning action**\n7520: \n7521: For each swarm $k$, split the sum into walkers that clone and walkers that persist:\n7522: \n7523: $$\n7524: \\mathbb{E}[\\Delta W_b^{(k)}] = \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} p_{k,i} \\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] + \\frac{1}{N} \\sum_{i \\in \\mathcal{D}(S_k)} \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i})]\n7525: $$\n7526: \n7527: **Step 2: Bound contribution from boundary-exposed walkers**\n7528: \n7529: For walkers in $\\mathcal{E}_{\\text{boundary}}(S_k)$:\n7530: \n7531: - By {prf:ref}`lem-boundary-enhanced-cloning`: $p_{k,i} \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}})$\n7532: - By {prf:ref}`lem-barrier-reduction-cloning`: $\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] \\leq C_{\\text{jitter}}$\n7533: \n7534: Therefore:\n7535: \n7536: $$\n7537: \\begin{aligned}\n7538: \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{k,i} &\\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] \\\\\n7539: &\\leq \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{\\text{boundary}} [C_{\\text{jitter}} - \\varphi_{\\text{barrier}}(x_{k,i})]\n7540: \\end{aligned}\n7541: $$\n7542: \n7543: Since $\\varphi_{\\text{barrier}}(x_{k,i}) > \\phi_{\\text{thresh}}$ for $i \\in \\mathcal{E}_{\\text{boundary}}$:\n7544: \n7545: $$\n7546: \\leq -p_{\\text{boundary}} \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} [\\varphi_{\\text{barrier}}(x_{k,i}) - C_{\\text{jitter}}]\n7547: $$\n7548: \n7549: $$\n7550: \\leq -p_{\\text{boundary}} \\left[\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i}) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right]\n7551: $$\n7552: \n7553: **Step 3: Relate to total boundary potential**\n7554: \n7555: The boundary-exposed mass satisfies:\n7556: \n7557: $$\n7558: M_{\\text{boundary}}(S_k) = \\frac{1}{N}\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\n7559: $$\n7560: \n7561: If most of $W_b$ comes from exposed walkers (which is true when $W_b$ is large):\n7562: \n7563: $$\n7564: M_{\\text{boundary}}(S_k) \\geq W_b(S_k) - \\frac{k_{\\text{alive}}}{N} \\phi_{\\text{thresh}}\n7565: $$\n7566: \n7567: **Step 4: Combine to get contraction**\n7568: \n7569: Combining Steps 2-3:\n7570: \n7571: $$\n7572: \\mathbb{E}[\\Delta W_b^{(k)}] \\leq -\\frac{p_{\\text{boundary}}}{N} \\left[N \\cdot M_{\\text{boundary}}(S_k) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right] + \\text{(dead walker contribution)}\n7573: $$\n7574: \n7575: $$\n7576: \\leq -p_{\\text{boundary}} M_{\\text{boundary}}(S_k) + C'_{\\text{jitter}} + C_{\\text{dead}}\n7577: $$\n7578: \n7579: Using $M_{\\text{boundary}} \\approx W_b$ when $W_b$ is large:\n7580: \n7581: $$\n7582: \\leq -p_{\\text{boundary}} W_b(S_k) + C_{\\text{total}}\n7583: $$\n7584: \n7585: Summing over both swarms:\n7586: \n7587: $$\n7588: \\mathbb{E}[\\Delta W_b] \\leq -p_{\\text{boundary}} W_b + 2C_{\\text{total}}\n7589: $$\n7590: \n7591: **Step 5: Express as geometric contraction**\n7592: \n7593: Defining $\\kappa_b := p_{\\text{boundary}}$ and $C_b := 2C_{\\text{total}}$:\n7594: \n7595: $$\n7596: \\mathbb{E}[W_b(S')] \\leq (1 - \\kappa_b) W_b(S) + C_b\n7597: $$\n7598: \n7599: The constant $\\kappa_b > 0$ is independent of $N$ by {prf:ref}`lem-boundary-enhanced-cloning`.",
      "metadata": {
        "label": "proof-lem-barrier-reduction-measurement"
      },
      "section": "## 11.4. Proof of Boundary Potential Contraction",
      "references": [
        "thm-boundary-potential-contraction",
        "lem-boundary-enhanced-cloning",
        "lem-barrier-reduction-cloning"
      ],
      "raw_directive": "7507: ### 11.4.3. Proof of Main Theorem\n7508: \n7509: :::{prf:proof}\n7510: :label: proof-lem-barrier-reduction-measurement\n7511: **Proof of {prf:ref}`thm-boundary-potential-contraction`.**\n7512: \n7513: We analyze the expected change in boundary potential:\n7514: \n7515: $$\n7516: \\Delta W_b = \\sum_{k=1,2} \\left[\\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S'_k)} \\varphi_{\\text{barrier}}(x'_{k,i}) - \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\\right]\n7517: $$\n7518: \n7519: **Step 1: Decompose by cloning action**\n7520: \n7521: For each swarm $k$, split the sum into walkers that clone and walkers that persist:\n7522: \n7523: $$\n7524: \\mathbb{E}[\\Delta W_b^{(k)}] = \\frac{1}{N} \\sum_{i \\in \\mathcal{A}(S_k)} p_{k,i} \\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] + \\frac{1}{N} \\sum_{i \\in \\mathcal{D}(S_k)} \\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i})]\n7525: $$\n7526: \n7527: **Step 2: Bound contribution from boundary-exposed walkers**\n7528: \n7529: For walkers in $\\mathcal{E}_{\\text{boundary}}(S_k)$:\n7530: \n7531: - By {prf:ref}`lem-boundary-enhanced-cloning`: $p_{k,i} \\geq p_{\\text{boundary}}(\\phi_{\\text{thresh}})$\n7532: - By {prf:ref}`lem-barrier-reduction-cloning`: $\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] \\leq C_{\\text{jitter}}$\n7533: \n7534: Therefore:\n7535: \n7536: $$\n7537: \\begin{aligned}\n7538: \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{k,i} &\\left[\\mathbb{E}[\\varphi_{\\text{barrier}}(x'_{k,i}) \\mid \\text{clone}] - \\varphi_{\\text{barrier}}(x_{k,i})\\right] \\\\\n7539: &\\leq \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} p_{\\text{boundary}} [C_{\\text{jitter}} - \\varphi_{\\text{barrier}}(x_{k,i})]\n7540: \\end{aligned}\n7541: $$\n7542: \n7543: Since $\\varphi_{\\text{barrier}}(x_{k,i}) > \\phi_{\\text{thresh}}$ for $i \\in \\mathcal{E}_{\\text{boundary}}$:\n7544: \n7545: $$\n7546: \\leq -p_{\\text{boundary}} \\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} [\\varphi_{\\text{barrier}}(x_{k,i}) - C_{\\text{jitter}}]\n7547: $$\n7548: \n7549: $$\n7550: \\leq -p_{\\text{boundary}} \\left[\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i}) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right]\n7551: $$\n7552: \n7553: **Step 3: Relate to total boundary potential**\n7554: \n7555: The boundary-exposed mass satisfies:\n7556: \n7557: $$\n7558: M_{\\text{boundary}}(S_k) = \\frac{1}{N}\\sum_{i \\in \\mathcal{E}_{\\text{boundary}}(S_k)} \\varphi_{\\text{barrier}}(x_{k,i})\n7559: $$\n7560: \n7561: If most of $W_b$ comes from exposed walkers (which is true when $W_b$ is large):\n7562: \n7563: $$\n7564: M_{\\text{boundary}}(S_k) \\geq W_b(S_k) - \\frac{k_{\\text{alive}}}{N} \\phi_{\\text{thresh}}\n7565: $$\n7566: \n7567: **Step 4: Combine to get contraction**\n7568: \n7569: Combining Steps 2-3:\n7570: \n7571: $$\n7572: \\mathbb{E}[\\Delta W_b^{(k)}] \\leq -\\frac{p_{\\text{boundary}}}{N} \\left[N \\cdot M_{\\text{boundary}}(S_k) - |\\mathcal{E}_{\\text{boundary}}| C_{\\text{jitter}}\\right] + \\text{(dead walker contribution)}\n7573: $$\n7574: \n7575: $$\n7576: \\leq -p_{\\text{boundary}} M_{\\text{boundary}}(S_k) + C'_{\\text{jitter}} + C_{\\text{dead}}\n7577: $$\n7578: \n7579: Using $M_{\\text{boundary}} \\approx W_b$ when $W_b$ is large:\n7580: \n7581: $$\n7582: \\leq -p_{\\text{boundary}} W_b(S_k) + C_{\\text{total}}\n7583: $$\n7584: \n7585: Summing over both swarms:\n7586: \n7587: $$\n7588: \\mathbb{E}[\\Delta W_b] \\leq -p_{\\text{boundary}} W_b + 2C_{\\text{total}}\n7589: $$\n7590: \n7591: **Step 5: Express as geometric contraction**\n7592: \n7593: Defining $\\kappa_b := p_{\\text{boundary}}$ and $C_b := 2C_{\\text{total}}$:\n7594: \n7595: $$\n7596: \\mathbb{E}[W_b(S')] \\leq (1 - \\kappa_b) W_b(S) + C_b\n7597: $$\n7598: \n7599: The constant $\\kappa_b > 0$ is independent of $N$ by {prf:ref}`lem-boundary-enhanced-cloning`.\n7600: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}