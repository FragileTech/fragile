{
  "chapter_index": 6,
  "section_id": "## Part IV: Total Error Bound",
  "directive_count": 7,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-total-error-bound",
      "title": "Total Error Bound for Discrete Fragile Gas",
      "start_line": 2340,
      "end_line": 2372,
      "header_lines": [
        2341
      ],
      "content_start": 2343,
      "content_end": 2371,
      "content": "2343: :label: thm-total-error-bound\n2344: \n2345: Let $\\nu_N^{\\text{discrete}}$ be the invariant measure of the fully discrete N-particle Fragile Gas with time step $\\Delta t$, and let $\\rho_0$ be the invariant measure of the continuous-time mean-field McKean-Vlasov equation.\n2346: \n2347: **Assumptions:**\n2348: 1. **N-uniform LSI** ({prf:ref}`thm-kl-convergence-euclidean`): The N-particle system satisfies a logarithmic Sobolev inequality with constant independent of $N$\n2349: 2. **Geometric ergodicity**: Both discrete and continuous N-particle chains mix geometrically with rates uniform in $N$ and $\\Delta t$ (for $\\Delta t < \\Delta t_0$)\n2350: 3. **Regularity**: Potential $U \\in C^4$, fitness function $F \\in C^4$, observable $\\phi \\in C^4$\n2351: 4. **Confinement**: Potential satisfies the Axiom of Confined Potential with rate $\\kappa_{\\text{conf}} > 0$\n2352: \n2353: Under these assumptions, for any single-particle observable $\\phi: \\mathcal{Z} \\to \\mathbb{R}$ with $\\|\\phi\\|_{C^4} < \\infty$, the empirical measure approximation error satisfies:\n2354: \n2355: $$\n2356: \\boxed{\n2357: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} \\left[ \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)}) \\right] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{discrete}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2358: }\n2359: $$\n2360: \n2361: where:\n2362: - $C_{\\text{MF}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}$ is the mean-field error constant (from {prf:ref}`thm-quantitative-propagation-chaos`)\n2363: - $C_{\\text{discrete}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}$ is the time discretization constant (from {prf:ref}`thm-error-propagation`)\n2364: \n2365: **Constants depend on:**\n2366: - System parameters: $\\gamma$ (friction), $\\sigma$ (noise), $\\lambda$ (cloning rate), $\\delta$ (cloning noise), $\\beta$ (fitness weight)\n2367: - Potential: $\\|\\nabla^2 U\\|_\\infty$, $\\kappa_{\\text{conf}}$ (confinement rate)\n2368: - Fitness function: $\\|F\\|_{C^4}$, Lipschitz constants\n2369: - Mixing rate: $\\kappa_{\\text{mix}}^{\\text{cont}}$ (spectral gap of continuous generator)\n2370: \n2371: **Crucially**, both constants are **independent of $N$ and $\\Delta t$** (for $\\Delta t < \\Delta t_0$ sufficiently small).",
      "metadata": {
        "label": "thm-total-error-bound"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [
        "thm-kl-convergence-euclidean",
        "thm-quantitative-propagation-chaos",
        "thm-error-propagation"
      ],
      "raw_directive": "2340: ### Main Result\n2341: \n2342: :::{prf:theorem} Total Error Bound for Discrete Fragile Gas\n2343: :label: thm-total-error-bound\n2344: \n2345: Let $\\nu_N^{\\text{discrete}}$ be the invariant measure of the fully discrete N-particle Fragile Gas with time step $\\Delta t$, and let $\\rho_0$ be the invariant measure of the continuous-time mean-field McKean-Vlasov equation.\n2346: \n2347: **Assumptions:**\n2348: 1. **N-uniform LSI** ({prf:ref}`thm-kl-convergence-euclidean`): The N-particle system satisfies a logarithmic Sobolev inequality with constant independent of $N$\n2349: 2. **Geometric ergodicity**: Both discrete and continuous N-particle chains mix geometrically with rates uniform in $N$ and $\\Delta t$ (for $\\Delta t < \\Delta t_0$)\n2350: 3. **Regularity**: Potential $U \\in C^4$, fitness function $F \\in C^4$, observable $\\phi \\in C^4$\n2351: 4. **Confinement**: Potential satisfies the Axiom of Confined Potential with rate $\\kappa_{\\text{conf}} > 0$\n2352: \n2353: Under these assumptions, for any single-particle observable $\\phi: \\mathcal{Z} \\to \\mathbb{R}$ with $\\|\\phi\\|_{C^4} < \\infty$, the empirical measure approximation error satisfies:\n2354: \n2355: $$\n2356: \\boxed{\n2357: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} \\left[ \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)}) \\right] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{discrete}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2358: }\n2359: $$\n2360: \n2361: where:\n2362: - $C_{\\text{MF}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}$ is the mean-field error constant (from {prf:ref}`thm-quantitative-propagation-chaos`)\n2363: - $C_{\\text{discrete}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}$ is the time discretization constant (from {prf:ref}`thm-error-propagation`)\n2364: \n2365: **Constants depend on:**\n2366: - System parameters: $\\gamma$ (friction), $\\sigma$ (noise), $\\lambda$ (cloning rate), $\\delta$ (cloning noise), $\\beta$ (fitness weight)\n2367: - Potential: $\\|\\nabla^2 U\\|_\\infty$, $\\kappa_{\\text{conf}}$ (confinement rate)\n2368: - Fitness function: $\\|F\\|_{C^4}$, Lipschitz constants\n2369: - Mixing rate: $\\kappa_{\\text{mix}}^{\\text{cont}}$ (spectral gap of continuous generator)\n2370: \n2371: **Crucially**, both constants are **independent of $N$ and $\\Delta t$** (for $\\Delta t < \\Delta t_0$ sufficiently small).\n2372: "
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-total-error-bound",
      "title": null,
      "start_line": 2403,
      "end_line": 2523,
      "header_lines": [
        2404
      ],
      "content_start": 2406,
      "content_end": 2522,
      "content": "2406: :label: proof-thm-total-error-bound\n2407: \n2408: **Step 1: Triangle inequality decomposition**\n2409: \n2410: For any observable $\\phi: \\mathcal{Z} \\to \\mathbb{R}$ (single-particle observable), define the empirical measure observable:\n2411: \n2412: $$\n2413: \\Phi(\\mathcal{S}) := \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)})\n2414: $$\n2415: \n2416: where $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ is the N-particle swarm state.\n2417: \n2418: The error can be decomposed as:\n2419: \n2420: $$\n2421: \\begin{align*}\n2422: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &= \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] + \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2423: &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right|\n2424: \\end{align*}\n2425: $$\n2426: \n2427: **Step 2: Bound the time discretization error**\n2428: \n2429: From Part III ({prf:ref}`thm-error-propagation`), the invariant measure error between discrete and continuous N-particle systems satisfies:\n2430: \n2431: $$\n2432: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| \\leq C_{\\text{total}} \\|\\Phi\\|_{C^4(\\Omega^N)} \\Delta t\n2433: $$\n2434: \n2435: where $C_{\\text{total}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}$.\n2436: \n2437: For an empirical measure observable $\\Phi(\\mathcal{S}) = \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)})$, the appropriate $C^4$ norm on the N-particle space $\\Omega^N$ is taken to be the $C^4$ norm of the single-particle observable $\\phi$ on $\\mathcal{Z}$. That is:\n2438: \n2439: $$\n2440: \\|\\Phi\\|_{C^4(\\Omega^N)} = \\|\\phi\\|_{C^4(\\mathcal{Z})}\n2441: $$\n2442: \n2443: This is a standard convention in mean-field theory, as the error constants in the propagation theorem are derived from single-particle dynamics and their interactions. The averaging factor $1/N$ is intrinsic to the observable's definition, not its regularity.\n2444: \n2445: Therefore, the time discretization error for the empirical observable is:\n2446: \n2447: $$\n2448: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| \\leq C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t\n2449: $$\n2450: \n2451: This bound is of order $O(\\Delta t)$ and is **independent of $N$**.\n2452: \n2453: **Step 3: Bound the mean-field error**\n2454: \n2455: From Part I ({prf:ref}`thm-quantitative-propagation-chaos`), for the continuous-time N-particle system, the empirical measure converges to the mean-field limit at rate $O(1/\\sqrt{N})$:\n2456: \n2457: $$\n2458: \\left| \\mathbb{E}_{\\bar{\\mu}_N} [\\phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{FG}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2459: $$\n2460: \n2461: where $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{Z^{(i)}}$ is the empirical measure.\n2462: \n2463: **Connection to N-particle expectations:** For the empirical observable $\\Phi(\\mathcal{S}) = \\frac{1}{N}\\sum_i \\phi(Z^{(i)})$:\n2464: \n2465: $$\n2466: \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] = \\mathbb{E}_{\\nu_N^{\\text{cont}}} \\left[ \\int \\phi(z) d\\bar{\\mu}_N(z) \\right] = \\mathbb{E}_{\\bar{\\mu}_N} [\\phi]\n2467: $$\n2468: \n2469: where the expectation is over realizations of the N-particle system drawn from $\\nu_N^{\\text{cont}}$.\n2470: \n2471: By {prf:ref}`thm-quantitative-propagation-chaos`:\n2472: \n2473: $$\n2474: \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2475: $$\n2476: \n2477: where $C_{\\text{MF}} = C_{\\text{FG}} \\sqrt{\\frac{2C_0}{\\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2}}$.\n2478: \n2479: **Step 4: Combine the bounds**\n2480: \n2481: Substituting the bounds from Steps 2 and 3 into the triangle inequality from Step 1:\n2482: \n2483: $$\n2484: \\begin{align*}\n2485: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2486: &\\leq C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t + \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4} \\\\\n2487: &= \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{total}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2488: \\end{align*}\n2489: $$\n2490: \n2491: **Key observation**: The discretization term is $O(\\Delta t)$, while the mean-field term is $O(1/\\sqrt{N})$. For a fixed small $\\Delta t$, the mean-field error will dominate as $N \\to \\infty$.\n2492: \n2493: For example, with $N = 10^4$, $\\Delta t = 0.01$, and constants $C_{\\text{MF}} \\approx C_{\\text{total}} \\approx 1$:\n2494: - Mean-field error: $\\sim 1/\\sqrt{10^4} = 0.01$\n2495: - Discretization error: $\\sim 0.01$\n2496: \n2497: Both error sources contribute comparably in this regime. To achieve better accuracy, one must **reduce both $1/\\sqrt{N}$ and $\\Delta t$ simultaneously**.\n2498: \n2499: For the theorem statement, we keep the full bound including both terms.\n2500: \n2501: **Step 5: Verify uniformity of constants**\n2502: \n2503: Both constants are independent of $N$ and $\\Delta t$:\n2504: \n2505: **Mean-field constant** $C_{\\text{MF}}$:\n2506: - Depends on: $\\gamma, \\sigma, \\lambda, \\delta, \\beta, \\kappa_{\\text{conf}}, \\kappa_W, C_0$\n2507: - Established in Part I using N-uniform LSI ({prf:ref}`thm-kl-convergence-euclidean`)\n2508: - Uniformity proven in [11_mean_field_convergence](11_mean_field_convergence/00_full.md)\n2509: \n2510: **Discretization constant** $C_{\\text{discrete}}$:\n2511: - Depends on: $C_{\\text{split}}$ (commutator bound), $C_{\\text{poisson}}$ (Poisson equation regularity), $\\kappa_{\\text{mix}}^{\\text{cont}}$ (spectral gap)\n2512: - $C_{\\text{split}}$ is N-independent by mean-field cancellation (Part III, Step 5j)\n2513: - $C_{\\text{poisson}}$ depends on generator regularity (system parameters only)\n2514: - $\\kappa_{\\text{mix}}^{\\text{cont}}$ is the continuous-time mixing rate (hypocoercivity, Part II)\n2515: - For $\\Delta t < \\Delta t_0$ sufficiently small, all constants remain bounded\n2516: \n2517: **Conclusion**: The total error bound is:\n2518: \n2519: $$\n2520: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} \\left[ \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)}) \\right] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{discrete}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2521: $$\n2522: ",
      "metadata": {
        "label": "proof-thm-total-error-bound"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [
        "thm-error-propagation",
        "thm-quantitative-propagation-chaos",
        "thm-kl-convergence-euclidean"
      ],
      "raw_directive": "2403: ---\n2404: \n2405: :::{prf:proof}\n2406: :label: proof-thm-total-error-bound\n2407: \n2408: **Step 1: Triangle inequality decomposition**\n2409: \n2410: For any observable $\\phi: \\mathcal{Z} \\to \\mathbb{R}$ (single-particle observable), define the empirical measure observable:\n2411: \n2412: $$\n2413: \\Phi(\\mathcal{S}) := \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)})\n2414: $$\n2415: \n2416: where $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ is the N-particle swarm state.\n2417: \n2418: The error can be decomposed as:\n2419: \n2420: $$\n2421: \\begin{align*}\n2422: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &= \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] + \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2423: &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right|\n2424: \\end{align*}\n2425: $$\n2426: \n2427: **Step 2: Bound the time discretization error**\n2428: \n2429: From Part III ({prf:ref}`thm-error-propagation`), the invariant measure error between discrete and continuous N-particle systems satisfies:\n2430: \n2431: $$\n2432: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| \\leq C_{\\text{total}} \\|\\Phi\\|_{C^4(\\Omega^N)} \\Delta t\n2433: $$\n2434: \n2435: where $C_{\\text{total}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}$.\n2436: \n2437: For an empirical measure observable $\\Phi(\\mathcal{S}) = \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)})$, the appropriate $C^4$ norm on the N-particle space $\\Omega^N$ is taken to be the $C^4$ norm of the single-particle observable $\\phi$ on $\\mathcal{Z}$. That is:\n2438: \n2439: $$\n2440: \\|\\Phi\\|_{C^4(\\Omega^N)} = \\|\\phi\\|_{C^4(\\mathcal{Z})}\n2441: $$\n2442: \n2443: This is a standard convention in mean-field theory, as the error constants in the propagation theorem are derived from single-particle dynamics and their interactions. The averaging factor $1/N$ is intrinsic to the observable's definition, not its regularity.\n2444: \n2445: Therefore, the time discretization error for the empirical observable is:\n2446: \n2447: $$\n2448: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| \\leq C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t\n2449: $$\n2450: \n2451: This bound is of order $O(\\Delta t)$ and is **independent of $N$**.\n2452: \n2453: **Step 3: Bound the mean-field error**\n2454: \n2455: From Part I ({prf:ref}`thm-quantitative-propagation-chaos`), for the continuous-time N-particle system, the empirical measure converges to the mean-field limit at rate $O(1/\\sqrt{N})$:\n2456: \n2457: $$\n2458: \\left| \\mathbb{E}_{\\bar{\\mu}_N} [\\phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{FG}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2459: $$\n2460: \n2461: where $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{Z^{(i)}}$ is the empirical measure.\n2462: \n2463: **Connection to N-particle expectations:** For the empirical observable $\\Phi(\\mathcal{S}) = \\frac{1}{N}\\sum_i \\phi(Z^{(i)})$:\n2464: \n2465: $$\n2466: \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] = \\mathbb{E}_{\\nu_N^{\\text{cont}}} \\left[ \\int \\phi(z) d\\bar{\\mu}_N(z) \\right] = \\mathbb{E}_{\\bar{\\mu}_N} [\\phi]\n2467: $$\n2468: \n2469: where the expectation is over realizations of the N-particle system drawn from $\\nu_N^{\\text{cont}}$.\n2470: \n2471: By {prf:ref}`thm-quantitative-propagation-chaos`:\n2472: \n2473: $$\n2474: \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2475: $$\n2476: \n2477: where $C_{\\text{MF}} = C_{\\text{FG}} \\sqrt{\\frac{2C_0}{\\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2}}$.\n2478: \n2479: **Step 4: Combine the bounds**\n2480: \n2481: Substituting the bounds from Steps 2 and 3 into the triangle inequality from Step 1:\n2482: \n2483: $$\n2484: \\begin{align*}\n2485: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2486: &\\leq C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t + \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4} \\\\\n2487: &= \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{total}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2488: \\end{align*}\n2489: $$\n2490: \n2491: **Key observation**: The discretization term is $O(\\Delta t)$, while the mean-field term is $O(1/\\sqrt{N})$. For a fixed small $\\Delta t$, the mean-field error will dominate as $N \\to \\infty$.\n2492: \n2493: For example, with $N = 10^4$, $\\Delta t = 0.01$, and constants $C_{\\text{MF}} \\approx C_{\\text{total}} \\approx 1$:\n2494: - Mean-field error: $\\sim 1/\\sqrt{10^4} = 0.01$\n2495: - Discretization error: $\\sim 0.01$\n2496: \n2497: Both error sources contribute comparably in this regime. To achieve better accuracy, one must **reduce both $1/\\sqrt{N}$ and $\\Delta t$ simultaneously**.\n2498: \n2499: For the theorem statement, we keep the full bound including both terms.\n2500: \n2501: **Step 5: Verify uniformity of constants**\n2502: \n2503: Both constants are independent of $N$ and $\\Delta t$:\n2504: \n2505: **Mean-field constant** $C_{\\text{MF}}$:\n2506: - Depends on: $\\gamma, \\sigma, \\lambda, \\delta, \\beta, \\kappa_{\\text{conf}}, \\kappa_W, C_0$\n2507: - Established in Part I using N-uniform LSI ({prf:ref}`thm-kl-convergence-euclidean`)\n2508: - Uniformity proven in [11_mean_field_convergence](11_mean_field_convergence/00_full.md)\n2509: \n2510: **Discretization constant** $C_{\\text{discrete}}$:\n2511: - Depends on: $C_{\\text{split}}$ (commutator bound), $C_{\\text{poisson}}$ (Poisson equation regularity), $\\kappa_{\\text{mix}}^{\\text{cont}}$ (spectral gap)\n2512: - $C_{\\text{split}}$ is N-independent by mean-field cancellation (Part III, Step 5j)\n2513: - $C_{\\text{poisson}}$ depends on generator regularity (system parameters only)\n2514: - $\\kappa_{\\text{mix}}^{\\text{cont}}$ is the continuous-time mixing rate (hypocoercivity, Part II)\n2515: - For $\\Delta t < \\Delta t_0$ sufficiently small, all constants remain bounded\n2516: \n2517: **Conclusion**: The total error bound is:\n2518: \n2519: $$\n2520: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} \\left[ \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)}) \\right] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{discrete}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2521: $$\n2522: \n2523: with constants uniform in $N$ and $\\Delta t$ (for $\\Delta t < \\Delta t_0$), where $C_{\\text{discrete}} = C_{\\text{total}}$ is the discretization constant from Step 2."
    },
    {
      "directive_type": "remark",
      "label": "rem-rate-interpretation",
      "title": "Rate Interpretation",
      "start_line": 2528,
      "end_line": 2560,
      "header_lines": [
        2529
      ],
      "content_start": 2531,
      "content_end": 2559,
      "content": "2531: :label: rem-rate-interpretation\n2532: \n2533: The total error bound reveals two competing sources:\n2534: \n2535: 1. **Statistical error** ($O(1/\\sqrt{N})$): From finite-sample approximation of the mean-field limit\n2536:    - Dominant for small $N$ (e.g., $N = 100 \\Rightarrow$ error $\\approx 0.1 C_{\\text{MF}}$)\n2537:    - Reduced by increasing swarm size\n2538:    - Intrinsic to particle approximations (cannot be eliminated)\n2539: \n2540: 2. **Discretization error** ($O(\\Delta t)$): From operator splitting and time discretization\n2541:    - Dominant for coarse time steps\n2542:    - Reduced by decreasing $\\Delta t$\n2543:    - First-order due to non-commutativity $[\\mathcal{L}_{\\text{Langevin}}, \\mathcal{L}_{\\text{clone}}] \\neq 0$\n2544: \n2545: **Balanced regime**: To achieve overall error $\\varepsilon$, balance the two terms:\n2546: \n2547: $$\n2548: \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\approx C_{\\text{discrete}} \\Delta t \\approx \\frac{\\varepsilon}{2}\n2549: $$\n2550: \n2551: This gives the scaling relationship:\n2552: \n2553: $$\n2554: \\Delta t \\sim \\frac{1}{\\sqrt{N}}\n2555: $$\n2556: \n2557: **Example**: For $\\varepsilon = 0.01$ and $C_{\\text{MF}} \\approx C_{\\text{discrete}} \\approx 1$:\n2558: - Choose $N = 10^4$ walkers $\\Rightarrow$ statistical error $\\approx 0.01$\n2559: - Choose $\\Delta t = 0.01$ $\\Rightarrow$ discretization error $\\approx 0.01$",
      "metadata": {
        "label": "rem-rate-interpretation"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [],
      "raw_directive": "2528: ### Interpretation and Practical Implications\n2529: \n2530: :::{prf:remark} Rate Interpretation\n2531: :label: rem-rate-interpretation\n2532: \n2533: The total error bound reveals two competing sources:\n2534: \n2535: 1. **Statistical error** ($O(1/\\sqrt{N})$): From finite-sample approximation of the mean-field limit\n2536:    - Dominant for small $N$ (e.g., $N = 100 \\Rightarrow$ error $\\approx 0.1 C_{\\text{MF}}$)\n2537:    - Reduced by increasing swarm size\n2538:    - Intrinsic to particle approximations (cannot be eliminated)\n2539: \n2540: 2. **Discretization error** ($O(\\Delta t)$): From operator splitting and time discretization\n2541:    - Dominant for coarse time steps\n2542:    - Reduced by decreasing $\\Delta t$\n2543:    - First-order due to non-commutativity $[\\mathcal{L}_{\\text{Langevin}}, \\mathcal{L}_{\\text{clone}}] \\neq 0$\n2544: \n2545: **Balanced regime**: To achieve overall error $\\varepsilon$, balance the two terms:\n2546: \n2547: $$\n2548: \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\approx C_{\\text{discrete}} \\Delta t \\approx \\frac{\\varepsilon}{2}\n2549: $$\n2550: \n2551: This gives the scaling relationship:\n2552: \n2553: $$\n2554: \\Delta t \\sim \\frac{1}{\\sqrt{N}}\n2555: $$\n2556: \n2557: **Example**: For $\\varepsilon = 0.01$ and $C_{\\text{MF}} \\approx C_{\\text{discrete}} \\approx 1$:\n2558: - Choose $N = 10^4$ walkers $\\Rightarrow$ statistical error $\\approx 0.01$\n2559: - Choose $\\Delta t = 0.01$ $\\Rightarrow$ discretization error $\\approx 0.01$\n2560: - Total error $\\approx 0.02$ (factor of 2 from triangle inequality)"
    },
    {
      "directive_type": "remark",
      "label": "rem-higher-order-splitting",
      "title": "Higher-Order Splitting Methods",
      "start_line": 2562,
      "end_line": 2601,
      "header_lines": [
        2563
      ],
      "content_start": 2565,
      "content_end": 2600,
      "content": "2565: :label: rem-higher-order-splitting\n2566: \n2567: Can we further reduce the discretization error $O(\\Delta t)$ using higher-order splitting methods?\n2568: \n2569: **General principle:** For ergodic systems with a unique invariant measure, the relationship between local and global errors is:\n2570: - A symmetric integrator with local weak error $O((\\Delta t)^{p+1})$ for even $p$\n2571: - Produces an invariant measure error of $O((\\Delta t)^p)$\n2572: \n2573: This is proven via the Poisson equation argument in Part III ({prf:ref}`thm-error-propagation`): roughly, one derivative is lost when integrating local errors over infinite time.\n2574: \n2575: **Strang splitting** (second-order symmetric):\n2576: \n2577: $$\n2578: \\mathcal{T}^{\\Delta t}_{\\text{Strang}} = \\mathcal{T}_{\\text{Langevin}}^{\\Delta t/2} \\circ \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{Langevin}}^{\\Delta t/2}\n2579: $$\n2580: \n2581: This is symmetric and achieves:\n2582: - **Local weak error**: $O((\\Delta t)^3)$ (second-order method with $p=2$)\n2583: - **Global invariant measure error**: $O((\\Delta t)^2)$ (applying the general principle)\n2584: \n2585: Therefore, Strang splitting improves the discretization term to:\n2586: \n2587: $$\n2588: C_{\\text{discrete}}^{(2)} (\\Delta t)^2\n2589: $$\n2590: \n2591: where $C_{\\text{discrete}}^{(2)}$ is typically larger than $C_{\\text{discrete}}$ due to higher-order commutator contributions, but the $(\\Delta t)^2$ dependence makes it substantially smaller for reasonable time steps.\n2592: \n2593: **Practical assessment:**\n2594: - For $\\Delta t = 0.01$ and constants $C_{\\text{discrete}} \\approx C_{\\text{discrete}}^{(2)} \\approx 1$:\n2595:   - First-order (Lie): discretization error $\\sim 0.01$\n2596:   - Second-order (Strang): discretization error $\\sim 0.0001$\n2597: - For large $N$ (e.g., $N = 10^4$): mean-field error $\\sim 0.01$\n2598: - **Trade-off**: Strang splitting can reduce discretization error below the mean-field error, but this requires smaller $\\Delta t$ or provides benefit only when $N$ is very large\n2599: - **Recommendation**: For moderate $N$ (e.g., $N \\lesssim 10^4$), simple Lie splitting suffices. For very large $N$ where mean-field error becomes small, Strang splitting can provide meaningful improvement\n2600: ",
      "metadata": {
        "label": "rem-higher-order-splitting"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [
        "thm-error-propagation"
      ],
      "raw_directive": "2562: :::\n2563: \n2564: :::{prf:remark} Higher-Order Splitting Methods\n2565: :label: rem-higher-order-splitting\n2566: \n2567: Can we further reduce the discretization error $O(\\Delta t)$ using higher-order splitting methods?\n2568: \n2569: **General principle:** For ergodic systems with a unique invariant measure, the relationship between local and global errors is:\n2570: - A symmetric integrator with local weak error $O((\\Delta t)^{p+1})$ for even $p$\n2571: - Produces an invariant measure error of $O((\\Delta t)^p)$\n2572: \n2573: This is proven via the Poisson equation argument in Part III ({prf:ref}`thm-error-propagation`): roughly, one derivative is lost when integrating local errors over infinite time.\n2574: \n2575: **Strang splitting** (second-order symmetric):\n2576: \n2577: $$\n2578: \\mathcal{T}^{\\Delta t}_{\\text{Strang}} = \\mathcal{T}_{\\text{Langevin}}^{\\Delta t/2} \\circ \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{Langevin}}^{\\Delta t/2}\n2579: $$\n2580: \n2581: This is symmetric and achieves:\n2582: - **Local weak error**: $O((\\Delta t)^3)$ (second-order method with $p=2$)\n2583: - **Global invariant measure error**: $O((\\Delta t)^2)$ (applying the general principle)\n2584: \n2585: Therefore, Strang splitting improves the discretization term to:\n2586: \n2587: $$\n2588: C_{\\text{discrete}}^{(2)} (\\Delta t)^2\n2589: $$\n2590: \n2591: where $C_{\\text{discrete}}^{(2)}$ is typically larger than $C_{\\text{discrete}}$ due to higher-order commutator contributions, but the $(\\Delta t)^2$ dependence makes it substantially smaller for reasonable time steps.\n2592: \n2593: **Practical assessment:**\n2594: - For $\\Delta t = 0.01$ and constants $C_{\\text{discrete}} \\approx C_{\\text{discrete}}^{(2)} \\approx 1$:\n2595:   - First-order (Lie): discretization error $\\sim 0.01$\n2596:   - Second-order (Strang): discretization error $\\sim 0.0001$\n2597: - For large $N$ (e.g., $N = 10^4$): mean-field error $\\sim 0.01$\n2598: - **Trade-off**: Strang splitting can reduce discretization error below the mean-field error, but this requires smaller $\\Delta t$ or provides benefit only when $N$ is very large\n2599: - **Recommendation**: For moderate $N$ (e.g., $N \\lesssim 10^4$), simple Lie splitting suffices. For very large $N$ where mean-field error becomes small, Strang splitting can provide meaningful improvement\n2600: \n2601: **Cost**: Strang splitting requires splitting the BAOAB step and increases computational overhead by ~50%."
    },
    {
      "directive_type": "remark",
      "label": "rem-optimality-mean-field-rate",
      "title": "Optimality of the Mean-Field Rate",
      "start_line": 2603,
      "end_line": 2620,
      "header_lines": [
        2604
      ],
      "content_start": 2606,
      "content_end": 2619,
      "content": "2606: :label: rem-optimality-mean-field-rate\n2607: \n2608: The $O(1/\\sqrt{N})$ rate is **optimal** for empirical measure convergence in mean-field particle systems.\n2609: \n2610: **Why?** This is the rate of the **Central Limit Theorem**:\n2611: \n2612: $$\n2613: \\sqrt{N} (\\bar{\\mu}_N - \\rho_0) \\xrightarrow{d} \\mathcal{N}(0, \\Sigma)\n2614: $$\n2615: \n2616: where $\\Sigma$ is the covariance operator of the limiting Gaussian process.\n2617: \n2618: **Implication**: No particle method can achieve better than $O(1/\\sqrt{N})$ convergence without additional structure (e.g., multilevel methods, variance reduction).\n2619: ",
      "metadata": {
        "label": "rem-optimality-mean-field-rate"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [],
      "raw_directive": "2603: :::\n2604: \n2605: :::{prf:remark} Optimality of the Mean-Field Rate\n2606: :label: rem-optimality-mean-field-rate\n2607: \n2608: The $O(1/\\sqrt{N})$ rate is **optimal** for empirical measure convergence in mean-field particle systems.\n2609: \n2610: **Why?** This is the rate of the **Central Limit Theorem**:\n2611: \n2612: $$\n2613: \\sqrt{N} (\\bar{\\mu}_N - \\rho_0) \\xrightarrow{d} \\mathcal{N}(0, \\Sigma)\n2614: $$\n2615: \n2616: where $\\Sigma$ is the covariance operator of the limiting Gaussian process.\n2617: \n2618: **Implication**: No particle method can achieve better than $O(1/\\sqrt{N})$ convergence without additional structure (e.g., multilevel methods, variance reduction).\n2619: \n2620: **Reference**: Sznitman (1991), \"Topics in propagation of chaos\" - Section 6 on optimal rates."
    },
    {
      "directive_type": "proposition",
      "label": "prop-quantitative-explicit-constants",
      "title": "Explicit Constant Formulas",
      "start_line": 2627,
      "end_line": 2670,
      "header_lines": [
        2628
      ],
      "content_start": 2630,
      "content_end": 2669,
      "content": "2630: :label: prop-quantitative-explicit-constants\n2631: \n2632: Under the framework axioms, the error constants admit the following explicit bounds:\n2633: \n2634: **1. Mean-field constant:**\n2635: \n2636: $$\n2637: C_{\\text{MF}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2638: $$\n2639: \n2640: where:\n2641: - $C_{\\text{var}}$ is the variance constant from the Fournier-Guillin bound for empirical measure fluctuations\n2642:   - Depends on metric properties and observable regularity\n2643: - $C_{\\text{int}}$ is the interaction complexity constant from {prf:ref}`lem-quantitative-kl-bound`\n2644:   - Quantifies the strength of particle interactions through the diversity companion probability\n2645:   - Explicit form: $C_{\\text{int}} = \\lambda L_{\\log \\rho_0} \\cdot \\text{diam}(\\Omega)$\n2646:   - Depends on system parameters: $\\gamma, \\sigma, \\lambda, \\delta, \\beta, \\kappa_{\\text{conf}}$\n2647: - $C'$ is a universal constant from the propagation of chaos proof\n2648: \n2649: **2. Discretization constant:**\n2650: \n2651: $$\n2652: C_{\\text{discrete}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}\n2653: $$\n2654: \n2655: where:\n2656: - $C_{\\text{split}} = \\frac{1}{2} \\lambda \\beta C_{\\text{chaos}} \\max(C_F, \\sigma^2, \\|\\nabla^2 U\\|_\\infty)$ (commutator bound)\n2657: - $C_{\\text{chaos}}$: propagation of chaos constant (Sznitman, typically $O(1)$)\n2658: - $C_{\\text{poisson}}$: Poisson equation regularity constant (depends on $\\gamma, \\sigma, \\|\\nabla^3 U\\|_\\infty$)\n2659: - $\\kappa_{\\text{mix}}^{\\text{cont}} = \\min(\\kappa_{\\text{hypo}}, \\lambda)$ (smaller of hypocoercivity gap and cloning rate)\n2660: \n2661: **Typical parameter values** (for optimization tasks):\n2662: - Friction: $\\gamma = 0.1$ to $1.0$\n2663: - Noise scale: $\\sigma = 0.1$ to $1.0$\n2664: - Cloning rate: $\\lambda = 0.01$ to $0.1$\n2665: - Cloning noise: $\\delta = 0.1$ to $0.3$\n2666: - Fitness weight: $\\beta = 1$ to $10$\n2667: \n2668: **Order-of-magnitude estimates:**\n2669: - $C_{\\text{MF}} \\sim O(10)$ for typical problems",
      "metadata": {
        "label": "prop-quantitative-explicit-constants"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [
        "lem-quantitative-kl-bound"
      ],
      "raw_directive": "2627: For practical implementation, we provide explicit formulas for the constants in terms of system parameters.\n2628: \n2629: :::{prf:proposition} Explicit Constant Formulas\n2630: :label: prop-quantitative-explicit-constants\n2631: \n2632: Under the framework axioms, the error constants admit the following explicit bounds:\n2633: \n2634: **1. Mean-field constant:**\n2635: \n2636: $$\n2637: C_{\\text{MF}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2638: $$\n2639: \n2640: where:\n2641: - $C_{\\text{var}}$ is the variance constant from the Fournier-Guillin bound for empirical measure fluctuations\n2642:   - Depends on metric properties and observable regularity\n2643: - $C_{\\text{int}}$ is the interaction complexity constant from {prf:ref}`lem-quantitative-kl-bound`\n2644:   - Quantifies the strength of particle interactions through the diversity companion probability\n2645:   - Explicit form: $C_{\\text{int}} = \\lambda L_{\\log \\rho_0} \\cdot \\text{diam}(\\Omega)$\n2646:   - Depends on system parameters: $\\gamma, \\sigma, \\lambda, \\delta, \\beta, \\kappa_{\\text{conf}}$\n2647: - $C'$ is a universal constant from the propagation of chaos proof\n2648: \n2649: **2. Discretization constant:**\n2650: \n2651: $$\n2652: C_{\\text{discrete}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}\n2653: $$\n2654: \n2655: where:\n2656: - $C_{\\text{split}} = \\frac{1}{2} \\lambda \\beta C_{\\text{chaos}} \\max(C_F, \\sigma^2, \\|\\nabla^2 U\\|_\\infty)$ (commutator bound)\n2657: - $C_{\\text{chaos}}$: propagation of chaos constant (Sznitman, typically $O(1)$)\n2658: - $C_{\\text{poisson}}$: Poisson equation regularity constant (depends on $\\gamma, \\sigma, \\|\\nabla^3 U\\|_\\infty$)\n2659: - $\\kappa_{\\text{mix}}^{\\text{cont}} = \\min(\\kappa_{\\text{hypo}}, \\lambda)$ (smaller of hypocoercivity gap and cloning rate)\n2660: \n2661: **Typical parameter values** (for optimization tasks):\n2662: - Friction: $\\gamma = 0.1$ to $1.0$\n2663: - Noise scale: $\\sigma = 0.1$ to $1.0$\n2664: - Cloning rate: $\\lambda = 0.01$ to $0.1$\n2665: - Cloning noise: $\\delta = 0.1$ to $0.3$\n2666: - Fitness weight: $\\beta = 1$ to $10$\n2667: \n2668: **Order-of-magnitude estimates:**\n2669: - $C_{\\text{MF}} \\sim O(10)$ for typical problems\n2670: - $C_{\\text{discrete}} \\sim O(1)$ to $O(10)$ depending on mixing rate"
    },
    {
      "directive_type": "proof",
      "label": "proof-prop-quantitative-explicit-constants",
      "title": null,
      "start_line": 2672,
      "end_line": 2718,
      "header_lines": [
        2673
      ],
      "content_start": 2675,
      "content_end": 2717,
      "content": "2675: :label: proof-prop-quantitative-explicit-constants\n2676: \n2677: These formulas are derived by tracing through the constants in Parts I, II, and III:\n2678: \n2679: **Mean-field constant derivation:**\n2680: \n2681: From {prf:ref}`thm-quantitative-propagation-chaos` (Part I), the mean-field error for Lipschitz observables is:\n2682: \n2683: $$\n2684: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\mathbb{E}_{\\rho_0}[\\phi] \\right| \\leq \\frac{C_{\\text{obs}} \\cdot L_\\phi}{\\sqrt{N}}\n2685: $$\n2686: \n2687: where the constant is given by:\n2688: \n2689: $$\n2690: C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2691: $$\n2692: \n2693: Here:\n2694: - $C_{\\text{var}}$ accounts for the variance of empirical fluctuations (from Fournier-Guillin)\n2695: - $C_{\\text{int}}$ is the interaction complexity constant from {prf:ref}`lem-quantitative-kl-bound`\n2696: - $C'$ is a universal constant from the proof\n2697: \n2698: For $C^4$ observables (needed for Part III Poisson equation regularity), we can bound $L_\\phi \\leq \\|\\phi\\|_{C^4}$. Therefore:\n2699: \n2700: $$\n2701: C_{\\text{MF}} = C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2702: $$\n2703: \n2704: **Note on C^4 norm dependency:** The dependence on $\\|\\phi\\|_{C^4}$ (rather than just Lipschitz constant $L_\\phi$) arises from the regularity required for the solution $\\psi$ of the Poisson equation used in Part III to relate the invariant measure error to the local weak error of the discrete scheme. The Kantorovich-Rubinstein duality relates $W_1$ distance to error for 1-Lipschitz observables (i.e., $C^1$ functions), but the higher $C^4$ regularity is needed to bound the error propagation through the Markov chain dynamics.\n2705: \n2706: **Discretization constant derivation:**\n2707: \n2708: From {prf:ref}`thm-error-propagation`, Step 4:\n2709: \n2710: $$\n2711: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] \\right| \\leq \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4} \\Delta t\n2712: $$\n2713: \n2714: The numerator combines:\n2715: - **Splitting error**: From {prf:ref}`lem-lie-splitting-weak-error`, Step 6, the commutator bound gives $C_{\\text{split}} = \\frac{1}{2} C_{\\text{comm}}$ where $C_{\\text{comm}}$ is N-uniform by propagation of chaos\n2716: - **Poisson regularity**: From Step 1 of {prf:ref}`thm-error-propagation`, $\\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}$\n2717: ",
      "metadata": {
        "label": "proof-prop-quantitative-explicit-constants"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [
        "thm-quantitative-propagation-chaos",
        "lem-quantitative-kl-bound",
        "thm-error-propagation",
        "lem-lie-splitting-weak-error"
      ],
      "raw_directive": "2672: :::\n2673: \n2674: :::{prf:proof}\n2675: :label: proof-prop-quantitative-explicit-constants\n2676: \n2677: These formulas are derived by tracing through the constants in Parts I, II, and III:\n2678: \n2679: **Mean-field constant derivation:**\n2680: \n2681: From {prf:ref}`thm-quantitative-propagation-chaos` (Part I), the mean-field error for Lipschitz observables is:\n2682: \n2683: $$\n2684: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\mathbb{E}_{\\rho_0}[\\phi] \\right| \\leq \\frac{C_{\\text{obs}} \\cdot L_\\phi}{\\sqrt{N}}\n2685: $$\n2686: \n2687: where the constant is given by:\n2688: \n2689: $$\n2690: C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2691: $$\n2692: \n2693: Here:\n2694: - $C_{\\text{var}}$ accounts for the variance of empirical fluctuations (from Fournier-Guillin)\n2695: - $C_{\\text{int}}$ is the interaction complexity constant from {prf:ref}`lem-quantitative-kl-bound`\n2696: - $C'$ is a universal constant from the proof\n2697: \n2698: For $C^4$ observables (needed for Part III Poisson equation regularity), we can bound $L_\\phi \\leq \\|\\phi\\|_{C^4}$. Therefore:\n2699: \n2700: $$\n2701: C_{\\text{MF}} = C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2702: $$\n2703: \n2704: **Note on C^4 norm dependency:** The dependence on $\\|\\phi\\|_{C^4}$ (rather than just Lipschitz constant $L_\\phi$) arises from the regularity required for the solution $\\psi$ of the Poisson equation used in Part III to relate the invariant measure error to the local weak error of the discrete scheme. The Kantorovich-Rubinstein duality relates $W_1$ distance to error for 1-Lipschitz observables (i.e., $C^1$ functions), but the higher $C^4$ regularity is needed to bound the error propagation through the Markov chain dynamics.\n2705: \n2706: **Discretization constant derivation:**\n2707: \n2708: From {prf:ref}`thm-error-propagation`, Step 4:\n2709: \n2710: $$\n2711: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] \\right| \\leq \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4} \\Delta t\n2712: $$\n2713: \n2714: The numerator combines:\n2715: - **Splitting error**: From {prf:ref}`lem-lie-splitting-weak-error`, Step 6, the commutator bound gives $C_{\\text{split}} = \\frac{1}{2} C_{\\text{comm}}$ where $C_{\\text{comm}}$ is N-uniform by propagation of chaos\n2716: - **Poisson regularity**: From Step 1 of {prf:ref}`thm-error-propagation`, $\\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}$\n2717: \n2718: The denominator is the continuous-time mixing rate, which is the spectral gap of the generator $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$."
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}