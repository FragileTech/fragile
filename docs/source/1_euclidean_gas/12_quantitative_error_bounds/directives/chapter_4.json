{
  "chapter_index": 4,
  "section_id": "## Part III: Cloning Mechanism Error Bounds",
  "directive_count": 9,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-full-system-discretization-error",
      "title": "Full System Time Discretization Error",
      "start_line": 1538,
      "end_line": 1550,
      "header_lines": [
        1539
      ],
      "content_start": 1541,
      "content_end": 1549,
      "content": "1541: :label: thm-full-system-discretization-error\n1542: \n1543: Let $\\nu_N^{\\text{cont}}$ be the QSD of the continuous-time N-particle system (Langevin dynamics + continuous-time cloning) and let $\\nu_N^{\\text{discrete}}$ be the QSD of the discrete-time system (BAOAB + discrete cloning with step size $\\Delta t$). For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1544: \n1545: $$\n1546: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\phi] \\right| \\leq C_{\\text{total}} \\cdot \\|\\phi\\|_{C^4} \\cdot \\Delta t\n1547: $$\n1548: \n1549: where $C_{\\text{total}}$ depends on $\\gamma, \\sigma, \\lambda, \\delta, M_4, \\kappa_{\\text{mix}}$ but is independent of $N$ and $\\Delta t$ (for $\\Delta t$ sufficiently small).",
      "metadata": {
        "label": "thm-full-system-discretization-error"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "1538: ### Main Result (Target)\n1539: \n1540: :::{prf:theorem} Full System Time Discretization Error\n1541: :label: thm-full-system-discretization-error\n1542: \n1543: Let $\\nu_N^{\\text{cont}}$ be the QSD of the continuous-time N-particle system (Langevin dynamics + continuous-time cloning) and let $\\nu_N^{\\text{discrete}}$ be the QSD of the discrete-time system (BAOAB + discrete cloning with step size $\\Delta t$). For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1544: \n1545: $$\n1546: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\phi] \\right| \\leq C_{\\text{total}} \\cdot \\|\\phi\\|_{C^4} \\cdot \\Delta t\n1547: $$\n1548: \n1549: where $C_{\\text{total}}$ depends on $\\gamma, \\sigma, \\lambda, \\delta, M_4, \\kappa_{\\text{mix}}$ but is independent of $N$ and $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1550: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-lie-splitting-weak-error",
      "title": "One-Step Weak Error for Lie Splitting",
      "start_line": 1584,
      "end_line": 1596,
      "header_lines": [
        1585
      ],
      "content_start": 1587,
      "content_end": 1595,
      "content": "1587: :label: lem-lie-splitting-weak-error\n1588: \n1589: For the Lie splitting $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, the local weak error is:\n1590: \n1591: $$\n1592: \\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1593: $$\n1594: \n1595: where $C_{\\text{split}}$ depends on $\\gamma, \\sigma, \\lambda, \\delta, M_4$ but not on $\\Delta t$.",
      "metadata": {
        "label": "lem-lie-splitting-weak-error"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "1584: $$\n1585: \n1586: :::{prf:lemma} One-Step Weak Error for Lie Splitting\n1587: :label: lem-lie-splitting-weak-error\n1588: \n1589: For the Lie splitting $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, the local weak error is:\n1590: \n1591: $$\n1592: \\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1593: $$\n1594: \n1595: where $C_{\\text{split}}$ depends on $\\gamma, \\sigma, \\lambda, \\delta, M_4$ but not on $\\Delta t$.\n1596: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-lie-splitting-weak-error",
      "title": null,
      "start_line": 1598,
      "end_line": 1803,
      "header_lines": [
        1599
      ],
      "content_start": 1601,
      "content_end": 1802,
      "content": "1601: :label: proof-lem-lie-splitting-weak-error\n1602: \n1603: **Step 1: Taylor expansion of semigroups**\n1604: \n1605: For the continuous-time semigroup:\n1606: \n1607: $$\n1608: \\mathcal{P}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}^2 \\phi + O((\\Delta t)^3)\n1609: $$\n1610: \n1611: where $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$.\n1612: \n1613: **Step 2: Expansion of the Lie splitting**\n1614: \n1615: For the discrete operators, using $\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^2)$ (from Part II) and $\\mathcal{T}_{\\text{clone}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + O((\\Delta t)^2)$:\n1616: \n1617: $$\n1618: \\begin{align*}\n1619: \\mathcal{T}^{\\Delta t} \\phi &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} (\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi) \\\\\n1620: &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\left(\\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi + O((\\Delta t)^3)\\right) \\\\\n1621: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1622: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^3)\n1623: \\end{align*}\n1624: $$\n1625: \n1626: **Step 3: Compare with the exact expansion**\n1627: \n1628: The exact semigroup is:\n1629: \n1630: $$\n1631: \\begin{align*}\n1632: \\mathcal{P}^{\\Delta t} \\phi &= \\phi + \\Delta t (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}) \\phi \\\\\n1633: &\\quad + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}})^2 \\phi + O((\\Delta t)^3) \\\\\n1634: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1635: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3)\n1636: \\end{align*}\n1637: $$\n1638: \n1639: **Step 4: Identify the commutator error**\n1640: \n1641: Taking the difference:\n1642: \n1643: $$\n1644: \\begin{align*}\n1645: (\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t}) \\phi &= (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi - \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3) \\\\\n1646: &= \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} - \\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}}) \\phi + O((\\Delta t)^3) \\\\\n1647: &= \\frac{(\\Delta t)^2}{2} [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\phi + O((\\Delta t)^3)\n1648: \\end{align*}\n1649: $$\n1650: \n1651: **Step 5: Bounding the Commutator $[\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}]$**\n1652: \n1653: The local error is determined by the commutator of the cloning and Langevin generators. We will show this commutator is **non-zero but bounded**.\n1654: \n1655: **Step 5a: Physical Intuition for Non-Commutativity**\n1656: \n1657: The operators $\\mathcal{L}_{\\text{clone}}$ and $\\mathcal{L}_{\\text{Langevin}}$ **do not commute**. The physical reason is:\n1658: \n1659: 1. The **Langevin operator** ($\\mathcal{L}_{\\text{Langevin}}$) evolves the positions and velocities of all particles in the swarm.\n1660: 2. The **cloning operator** ($\\mathcal{L}_{\\text{clone}}$) uses a fitness distribution, $p_{\\text{fitness}}(\\mathcal{S})$, which is calculated based on the **current state** of all particles in the swarm $\\mathcal{S}$.\n1661: 3. Therefore, applying $\\mathcal{L}_{\\text{Langevin}}$ first **changes the particle configuration**, which in turn **alters the fitness landscape** that $\\mathcal{L}_{\\text{clone}}$ subsequently acts upon.\n1662: 4. Conversely, applying $\\mathcal{L}_{\\text{clone}}$ first changes the particle distribution, and $\\mathcal{L}_{\\text{Langevin}}$ then acts on this new distribution.\n1663: 5. This coupling through the state-dependent fitness function prevents the operators from commuting. **The order of operations matters.**\n1664: \n1665: **Step 5b: Formal N-Particle Generators**\n1666: \n1667: To analyze the commutator, we must use the full N-particle generators. Let $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ be the swarm state. The cloning operator explicitly depends on the swarm state $\\mathcal{S}$ through the fitness probability $p_{\\text{fitness}}$:\n1668: \n1669: $$\n1670: \\mathcal{L}_{\\text{clone}} \\Phi(\\mathcal{S}) = \\lambda \\sum_{i=1}^N \\left( \\mathbb{E}_{j \\sim p_{\\text{fitness}}(\\mathcal{S})} [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\Phi(\\mathcal{S}) \\right)\n1671: $$\n1672: \n1673: where $\\mathcal{S}^{(i \\leftarrow j)}$ denotes the state with particle $i$ replaced by a perturbed copy of particle $j$.\n1674: \n1675: The Langevin operator acts independently on each particle:\n1676: \n1677: $$\n1678: \\mathcal{L}_{\\text{Langevin}} \\Phi(\\mathcal{S}) = \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S})\n1679: $$\n1680: \n1681: where $\\mathcal{L}_k^{\\text{Lang}}$ acts on particle $k$, given explicitly by:\n1682: \n1683: $$\n1684: \\mathcal{L}_k^{\\text{Lang}} = \\langle v^{(k)}, \\nabla_{x^{(k)}} \\rangle - \\gamma \\langle v^{(k)}, \\nabla_{v^{(k)}} \\rangle - \\langle \\nabla U(x^{(k)}), \\nabla_{v^{(k)}} \\rangle + \\frac{\\sigma^2}{2} \\Delta_{v^{(k)}}\n1685: $$\n1686: \n1687: **Step 5c: Deriving the Commutator Expression**\n1688: \n1689: The commutator is by definition:\n1690: \n1691: $$\n1692: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi) - \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)\n1693: $$\n1694: \n1695: Expanding:\n1696: \n1697: **Term 1**: $\\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)$\n1698: \n1699: $$\n1700: \\begin{align*}\n1701: \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}^{(i \\leftarrow j)}) - (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) \\right] \\\\\n1702: &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}) \\right]\n1703: \\end{align*}\n1704: $$\n1705: \n1706: **Term 2**: $\\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)$\n1707: \n1708: $$\n1709: \\begin{align*}\n1710: \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)(\\mathcal{S}) &= \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\left( \\lambda \\sum_{i=1}^N \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\Phi(\\mathcal{S})] \\right) \\\\\n1711: &= \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S})\n1712: \\end{align*}\n1713: $$\n1714: \n1715: Taking the difference:\n1716: \n1717: $$\n1718: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\lambda \\sum_{i,k} \\mathbb{E}_j [\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{i,k} \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})]\n1719: $$\n1720: \n1721: The key is that $\\mathcal{L}_k^{\\text{Lang}}$ acts on **both** $\\Phi$ and the expectation $\\mathbb{E}_j$. Since the fitness distribution $p_j(\\mathcal{S})$ depends on $\\mathcal{S}$, by the product rule:\n1722: \n1723: $$\n1724: \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] = \\mathbb{E}_j[\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] + \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1725: $$\n1726: \n1727: The second term is the **non-canceling contribution** that is non-zero precisely because $\\mathcal{L}_k^{\\text{Lang}}$ (acting on particle $k$) modifies the fitness probability $p_j(\\mathcal{S})$ for all $j$:\n1728: \n1729: $$\n1730: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = -\\lambda \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1731: $$\n1732: \n1733: **Step 5d: Bounding the Commutator via Propagation of Chaos**\n1734: \n1735: While the commutator is non-zero, its norm is bounded by a constant **independent of the number of particles, $N$**, for the class of symmetric observables relevant to mean-field systems.\n1736: \n1737: The naive bound from the double sum $\\sum_{i,k}$ gives $O(N^2)$, which is too coarse for mean-field systems. We must exploit **empirical measure fluctuations**.\n1738: \n1739: Define the empirical measure:\n1740: \n1741: $$\n1742: \\mu_N(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\delta_{Z^{(i)}}\n1743: $$\n1744: \n1745: For the N-particle system, we consider **symmetric observables** of the form:\n1746: \n1747: $$\n1748: \\Phi(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)}, \\mu_N)\n1749: $$\n1750: \n1751: where $\\phi(z, \\mu)$ is a single-particle observable that depends on the empirical measure. This is the natural class for mean-field systems.\n1752: \n1753: The fitness distribution can be written as:\n1754: \n1755: $$\n1756: p_j(\\mathcal{S}) = \\frac{e^{\\beta F(Z^{(j)})}}{\\int e^{\\beta F(z)} d\\mu_N(z)} = \\frac{e^{\\beta F(Z^{(j)})}}{\\frac{1}{N} \\sum_{\\ell=1}^N e^{\\beta F(Z^{(\\ell)})}}\n1757: $$\n1758: \n1759: When $\\mathcal{L}_k^{\\text{Lang}}$ acts on particle $k$, it changes the empirical measure by an $O(1/N)$ perturbation:\n1760: \n1761: $$\n1762: \\mu_N \\to \\mu_N + \\frac{1}{N}(\\delta_{Z'^{(k)}} - \\delta_{Z^{(k)}}) + O(\\Delta t)\n1763: $$\n1764: \n1765: where $Z'^{(k)}$ is the infinitesimally evolved state.\n1766: \n1767: Computing the derivative of the log-probability:\n1768: \n1769: $$\n1770: \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S}) = \\beta (\\delta_{jk} - p_k(\\mathcal{S})) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1771: $$\n1772: \n1773: For symmetric observables, the expectation $\\mathbb{E}_j$ over the fitness distribution can be rewritten as:\n1774: \n1775: $$\n1776: \\mathbb{E}_j[\\phi(Z^{(i \\leftarrow j)}, \\mu_N)] = \\sum_{\\ell=1}^N p_\\ell \\phi(Z^{(\\ell)}, \\mu_N) = \\mathbb{E}_{\\mu_N}[\\phi(z, \\mu_N)]\n1777: $$\n1778: \n1779: which is **independent of the index $i$**. Using the centering property $\\sum_k (\\delta_{jk} - p_k) = 0$ and the symmetry of particles, the commutator's mean contribution vanishes when averaged over the swarm. The non-zero contribution comes only from the **fluctuations** around this mean.\n1780: \n1781: As established by **Sznitman (1991)**, the theory of propagation of chaos provides bounds on the fluctuations of the N-particle system from its mean-field limit. These results imply that for the relevant class of symmetric test functions, the fluctuations are $O(1/\\sqrt{N})$ in probability, and the commutator remains a bounded operator.\n1782: \n1783: **Reference**: Sznitman, A.-S. (1991). *Topics in propagation of chaos*. In *\u00c9cole d'\u00c9t\u00e9 de Probabilit\u00e9s de Saint-Flour XIX\u20141989* (pp. 165-251). Springer, Berlin, Heidelberg. (See Section 4 on commutator estimates for mean-field systems.)\n1784: \n1785: **Step 5e: Final Commutator Bound**\n1786: \n1787: Therefore, the operator norm of the commutator is bounded:\n1788: \n1789: $$\n1790: \\|[\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}]\\| \\leq C_{\\text{comm}}\n1791: $$\n1792: \n1793: where the constant $C_{\\text{comm}}$ depends on the framework parameters ($\\lambda, \\beta, \\gamma, \\sigma$, bounds on $F$ and $U$) and properties of the test function space (e.g., $\\|\\phi\\|_{C^4}$), but is crucially **independent of $N$ and $\\Delta t$**.\n1794: \n1795: Explicitly, we have:\n1796: \n1797: $$\n1798: C_{\\text{comm}} = \\lambda \\beta C_{\\text{chaos}} \\max(C_F, \\sigma^2, \\|\\nabla^2 U\\|_\\infty)\n1799: $$\n1800: \n1801: where $C_{\\text{chaos}}$ is the propagation of chaos constant from Sznitman (1991).\n1802: ",
      "metadata": {
        "label": "proof-lem-lie-splitting-weak-error"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "1598: :::\n1599: \n1600: :::{prf:proof}\n1601: :label: proof-lem-lie-splitting-weak-error\n1602: \n1603: **Step 1: Taylor expansion of semigroups**\n1604: \n1605: For the continuous-time semigroup:\n1606: \n1607: $$\n1608: \\mathcal{P}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}^2 \\phi + O((\\Delta t)^3)\n1609: $$\n1610: \n1611: where $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$.\n1612: \n1613: **Step 2: Expansion of the Lie splitting**\n1614: \n1615: For the discrete operators, using $\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^2)$ (from Part II) and $\\mathcal{T}_{\\text{clone}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + O((\\Delta t)^2)$:\n1616: \n1617: $$\n1618: \\begin{align*}\n1619: \\mathcal{T}^{\\Delta t} \\phi &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} (\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi) \\\\\n1620: &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\left(\\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi + O((\\Delta t)^3)\\right) \\\\\n1621: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1622: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^3)\n1623: \\end{align*}\n1624: $$\n1625: \n1626: **Step 3: Compare with the exact expansion**\n1627: \n1628: The exact semigroup is:\n1629: \n1630: $$\n1631: \\begin{align*}\n1632: \\mathcal{P}^{\\Delta t} \\phi &= \\phi + \\Delta t (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}) \\phi \\\\\n1633: &\\quad + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}})^2 \\phi + O((\\Delta t)^3) \\\\\n1634: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1635: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3)\n1636: \\end{align*}\n1637: $$\n1638: \n1639: **Step 4: Identify the commutator error**\n1640: \n1641: Taking the difference:\n1642: \n1643: $$\n1644: \\begin{align*}\n1645: (\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t}) \\phi &= (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi - \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3) \\\\\n1646: &= \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} - \\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}}) \\phi + O((\\Delta t)^3) \\\\\n1647: &= \\frac{(\\Delta t)^2}{2} [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\phi + O((\\Delta t)^3)\n1648: \\end{align*}\n1649: $$\n1650: \n1651: **Step 5: Bounding the Commutator $[\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}]$**\n1652: \n1653: The local error is determined by the commutator of the cloning and Langevin generators. We will show this commutator is **non-zero but bounded**.\n1654: \n1655: **Step 5a: Physical Intuition for Non-Commutativity**\n1656: \n1657: The operators $\\mathcal{L}_{\\text{clone}}$ and $\\mathcal{L}_{\\text{Langevin}}$ **do not commute**. The physical reason is:\n1658: \n1659: 1. The **Langevin operator** ($\\mathcal{L}_{\\text{Langevin}}$) evolves the positions and velocities of all particles in the swarm.\n1660: 2. The **cloning operator** ($\\mathcal{L}_{\\text{clone}}$) uses a fitness distribution, $p_{\\text{fitness}}(\\mathcal{S})$, which is calculated based on the **current state** of all particles in the swarm $\\mathcal{S}$.\n1661: 3. Therefore, applying $\\mathcal{L}_{\\text{Langevin}}$ first **changes the particle configuration**, which in turn **alters the fitness landscape** that $\\mathcal{L}_{\\text{clone}}$ subsequently acts upon.\n1662: 4. Conversely, applying $\\mathcal{L}_{\\text{clone}}$ first changes the particle distribution, and $\\mathcal{L}_{\\text{Langevin}}$ then acts on this new distribution.\n1663: 5. This coupling through the state-dependent fitness function prevents the operators from commuting. **The order of operations matters.**\n1664: \n1665: **Step 5b: Formal N-Particle Generators**\n1666: \n1667: To analyze the commutator, we must use the full N-particle generators. Let $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ be the swarm state. The cloning operator explicitly depends on the swarm state $\\mathcal{S}$ through the fitness probability $p_{\\text{fitness}}$:\n1668: \n1669: $$\n1670: \\mathcal{L}_{\\text{clone}} \\Phi(\\mathcal{S}) = \\lambda \\sum_{i=1}^N \\left( \\mathbb{E}_{j \\sim p_{\\text{fitness}}(\\mathcal{S})} [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\Phi(\\mathcal{S}) \\right)\n1671: $$\n1672: \n1673: where $\\mathcal{S}^{(i \\leftarrow j)}$ denotes the state with particle $i$ replaced by a perturbed copy of particle $j$.\n1674: \n1675: The Langevin operator acts independently on each particle:\n1676: \n1677: $$\n1678: \\mathcal{L}_{\\text{Langevin}} \\Phi(\\mathcal{S}) = \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S})\n1679: $$\n1680: \n1681: where $\\mathcal{L}_k^{\\text{Lang}}$ acts on particle $k$, given explicitly by:\n1682: \n1683: $$\n1684: \\mathcal{L}_k^{\\text{Lang}} = \\langle v^{(k)}, \\nabla_{x^{(k)}} \\rangle - \\gamma \\langle v^{(k)}, \\nabla_{v^{(k)}} \\rangle - \\langle \\nabla U(x^{(k)}), \\nabla_{v^{(k)}} \\rangle + \\frac{\\sigma^2}{2} \\Delta_{v^{(k)}}\n1685: $$\n1686: \n1687: **Step 5c: Deriving the Commutator Expression**\n1688: \n1689: The commutator is by definition:\n1690: \n1691: $$\n1692: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi) - \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)\n1693: $$\n1694: \n1695: Expanding:\n1696: \n1697: **Term 1**: $\\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)$\n1698: \n1699: $$\n1700: \\begin{align*}\n1701: \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}^{(i \\leftarrow j)}) - (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) \\right] \\\\\n1702: &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}) \\right]\n1703: \\end{align*}\n1704: $$\n1705: \n1706: **Term 2**: $\\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)$\n1707: \n1708: $$\n1709: \\begin{align*}\n1710: \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)(\\mathcal{S}) &= \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\left( \\lambda \\sum_{i=1}^N \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\Phi(\\mathcal{S})] \\right) \\\\\n1711: &= \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S})\n1712: \\end{align*}\n1713: $$\n1714: \n1715: Taking the difference:\n1716: \n1717: $$\n1718: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\lambda \\sum_{i,k} \\mathbb{E}_j [\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{i,k} \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})]\n1719: $$\n1720: \n1721: The key is that $\\mathcal{L}_k^{\\text{Lang}}$ acts on **both** $\\Phi$ and the expectation $\\mathbb{E}_j$. Since the fitness distribution $p_j(\\mathcal{S})$ depends on $\\mathcal{S}$, by the product rule:\n1722: \n1723: $$\n1724: \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] = \\mathbb{E}_j[\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] + \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1725: $$\n1726: \n1727: The second term is the **non-canceling contribution** that is non-zero precisely because $\\mathcal{L}_k^{\\text{Lang}}$ (acting on particle $k$) modifies the fitness probability $p_j(\\mathcal{S})$ for all $j$:\n1728: \n1729: $$\n1730: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = -\\lambda \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1731: $$\n1732: \n1733: **Step 5d: Bounding the Commutator via Propagation of Chaos**\n1734: \n1735: While the commutator is non-zero, its norm is bounded by a constant **independent of the number of particles, $N$**, for the class of symmetric observables relevant to mean-field systems.\n1736: \n1737: The naive bound from the double sum $\\sum_{i,k}$ gives $O(N^2)$, which is too coarse for mean-field systems. We must exploit **empirical measure fluctuations**.\n1738: \n1739: Define the empirical measure:\n1740: \n1741: $$\n1742: \\mu_N(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\delta_{Z^{(i)}}\n1743: $$\n1744: \n1745: For the N-particle system, we consider **symmetric observables** of the form:\n1746: \n1747: $$\n1748: \\Phi(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)}, \\mu_N)\n1749: $$\n1750: \n1751: where $\\phi(z, \\mu)$ is a single-particle observable that depends on the empirical measure. This is the natural class for mean-field systems.\n1752: \n1753: The fitness distribution can be written as:\n1754: \n1755: $$\n1756: p_j(\\mathcal{S}) = \\frac{e^{\\beta F(Z^{(j)})}}{\\int e^{\\beta F(z)} d\\mu_N(z)} = \\frac{e^{\\beta F(Z^{(j)})}}{\\frac{1}{N} \\sum_{\\ell=1}^N e^{\\beta F(Z^{(\\ell)})}}\n1757: $$\n1758: \n1759: When $\\mathcal{L}_k^{\\text{Lang}}$ acts on particle $k$, it changes the empirical measure by an $O(1/N)$ perturbation:\n1760: \n1761: $$\n1762: \\mu_N \\to \\mu_N + \\frac{1}{N}(\\delta_{Z'^{(k)}} - \\delta_{Z^{(k)}}) + O(\\Delta t)\n1763: $$\n1764: \n1765: where $Z'^{(k)}$ is the infinitesimally evolved state.\n1766: \n1767: Computing the derivative of the log-probability:\n1768: \n1769: $$\n1770: \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S}) = \\beta (\\delta_{jk} - p_k(\\mathcal{S})) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1771: $$\n1772: \n1773: For symmetric observables, the expectation $\\mathbb{E}_j$ over the fitness distribution can be rewritten as:\n1774: \n1775: $$\n1776: \\mathbb{E}_j[\\phi(Z^{(i \\leftarrow j)}, \\mu_N)] = \\sum_{\\ell=1}^N p_\\ell \\phi(Z^{(\\ell)}, \\mu_N) = \\mathbb{E}_{\\mu_N}[\\phi(z, \\mu_N)]\n1777: $$\n1778: \n1779: which is **independent of the index $i$**. Using the centering property $\\sum_k (\\delta_{jk} - p_k) = 0$ and the symmetry of particles, the commutator's mean contribution vanishes when averaged over the swarm. The non-zero contribution comes only from the **fluctuations** around this mean.\n1780: \n1781: As established by **Sznitman (1991)**, the theory of propagation of chaos provides bounds on the fluctuations of the N-particle system from its mean-field limit. These results imply that for the relevant class of symmetric test functions, the fluctuations are $O(1/\\sqrt{N})$ in probability, and the commutator remains a bounded operator.\n1782: \n1783: **Reference**: Sznitman, A.-S. (1991). *Topics in propagation of chaos*. In *\u00c9cole d'\u00c9t\u00e9 de Probabilit\u00e9s de Saint-Flour XIX\u20141989* (pp. 165-251). Springer, Berlin, Heidelberg. (See Section 4 on commutator estimates for mean-field systems.)\n1784: \n1785: **Step 5e: Final Commutator Bound**\n1786: \n1787: Therefore, the operator norm of the commutator is bounded:\n1788: \n1789: $$\n1790: \\|[\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}]\\| \\leq C_{\\text{comm}}\n1791: $$\n1792: \n1793: where the constant $C_{\\text{comm}}$ depends on the framework parameters ($\\lambda, \\beta, \\gamma, \\sigma$, bounds on $F$ and $U$) and properties of the test function space (e.g., $\\|\\phi\\|_{C^4}$), but is crucially **independent of $N$ and $\\Delta t$**.\n1794: \n1795: Explicitly, we have:\n1796: \n1797: $$\n1798: C_{\\text{comm}} = \\lambda \\beta C_{\\text{chaos}} \\max(C_F, \\sigma^2, \\|\\nabla^2 U\\|_\\infty)\n1799: $$\n1800: \n1801: where $C_{\\text{chaos}}$ is the propagation of chaos constant from Sznitman (1991).\n1802: \n1803: :::{note}"
    },
    {
      "directive_type": "lemma",
      "label": "lem-uniform-geometric-ergodicity",
      "title": "Uniform Geometric Ergodicity",
      "start_line": 1826,
      "end_line": 1838,
      "header_lines": [
        1827
      ],
      "content_start": 1829,
      "content_end": 1837,
      "content": "1829: :label: lem-uniform-geometric-ergodicity\n1830: \n1831: Under the confinement axiom, there exist constants $\\kappa_{\\text{mix}} > 0$ and $C_{\\text{erg}} < \\infty$ such that for all $\\Delta t < \\Delta t_0$, the discrete-time Markov chain with transition kernel $\\mathcal{T}^{\\Delta t}$ satisfies:\n1832: \n1833: $$\n1834: \\left\\|\\mathcal{P}_k - \\nu_N^{\\text{discrete}}\\right\\|_{\\text{TV}} \\leq C_{\\text{erg}} e^{-\\kappa_{\\text{mix}} k \\Delta t}\n1835: $$\n1836: \n1837: where $\\mathcal{P}_k$ is the distribution after $k$ steps starting from an arbitrary initial condition with finite fourth moment.",
      "metadata": {
        "label": "lem-uniform-geometric-ergodicity"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "1826: To connect the local weak error to the error in invariant measures, we need uniform geometric ergodicity.\n1827: \n1828: :::{prf:lemma} Uniform Geometric Ergodicity\n1829: :label: lem-uniform-geometric-ergodicity\n1830: \n1831: Under the confinement axiom, there exist constants $\\kappa_{\\text{mix}} > 0$ and $C_{\\text{erg}} < \\infty$ such that for all $\\Delta t < \\Delta t_0$, the discrete-time Markov chain with transition kernel $\\mathcal{T}^{\\Delta t}$ satisfies:\n1832: \n1833: $$\n1834: \\left\\|\\mathcal{P}_k - \\nu_N^{\\text{discrete}}\\right\\|_{\\text{TV}} \\leq C_{\\text{erg}} e^{-\\kappa_{\\text{mix}} k \\Delta t}\n1835: $$\n1836: \n1837: where $\\mathcal{P}_k$ is the distribution after $k$ steps starting from an arbitrary initial condition with finite fourth moment.\n1838: "
    },
    {
      "directive_type": "proof",
      "label": "thm-meyn-tweedie-drift-minor",
      "title": null,
      "start_line": 1840,
      "end_line": 2061,
      "header_lines": [
        1841,
        2039
      ],
      "content_start": 1843,
      "content_end": 2060,
      "content": "1843: :label: proof-lem-uniform-geometric-ergodicity\n1844: \n1845: The proof follows the standard Lyapunov drift approach for discrete-time Markov chains (Meyn & Tweedie, 2009, Chapter 15).\n1846: \n1847: **Step 1: Discrete Lyapunov function**\n1848: \n1849: Define the Lyapunov function $V(Z) = 1 + E^2(Z)$, where $E(Z) = \\frac{1}{2} \\|v\\|^2 + U(x)$ is the total energy (same as Part II).\n1850: \n1851: **Step 2: Drift condition**\n1852: \n1853: We need to show that $V(Z) = 1 + E^2(Z)$ satisfies a drift condition for the full discrete operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, with constants uniform in $\\Delta t$.\n1854: \n1855: **Step 2a: Drift for BAOAB operator**\n1856: \n1857: From Part II ({prf:ref}`prop-fourth-moment-baoab`), we have for the BAOAB operator alone:\n1858: \n1859: $$\n1860: \\mathbb{E}[E^2(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(Z)) | Z] \\leq (1 - \\kappa_E \\Delta t) E^2(Z) + C_E \\Delta t\n1861: $$\n1862: \n1863: for $\\kappa_E > 0$ and $C_E < \\infty$ independent of $\\Delta t$ (for $\\Delta t < \\Delta t_0$). This uses:\n1864: - The BAOAB integrator is a **symplectic** and **conformal symplectic** integrator\n1865: - Energy dissipation through friction: $\\gamma > 0$\n1866: - Confinement axiom: $U(x) \\to \\infty$ as $|x| \\to \\infty$\n1867: \n1868: **Step 2b: Effect of cloning on Lyapunov function**\n1869: \n1870: The cloning operator replaces the worst-fit walker with a perturbed copy of a better walker:\n1871: \n1872: $$\n1873: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi\n1874: $$\n1875: \n1876: The energy change for the replaced walker is:\n1877: \n1878: $$\n1879: \\Delta E^{(i)} = E(Z_{\\text{new}}^{(i)}) - E(Z_{\\text{old}}^{(i)}) = \\frac{1}{2} \\|v_{\\text{new}}^{(i)}\\|^2 + U(x^{(j)}) - \\frac{1}{2} \\|v_{\\text{old}}^{(i)}\\|^2 - U(x_{\\text{old}}^{(i)})\n1880: $$\n1881: \n1882: Taking expectation over the cloning randomness (selecting $j$ and the noise $\\xi$):\n1883: \n1884: $$\n1885: \\mathbb{E}[\\Delta E^{(i)} | \\mathcal{S}] = \\mathbb{E}_j \\left[ \\frac{1}{2} ((1 - \\delta^2) \\|v^{(j)}\\|^2 + d\\delta^2) + U(x^{(j)}) \\right] - E(Z_{\\text{old}}^{(i)})\n1886: $$\n1887: \n1888: Since the fitness-proportional selection favors walkers with **higher fitness** (lower energy in our convention), we have:\n1889: \n1890: $$\n1891: \\mathbb{E}_j [E(Z^{(j)})] \\leq \\frac{1}{N} \\sum_{k=1}^N E(Z^{(k)}) + O(\\delta^2)\n1892: $$\n1893: \n1894: where the $O(\\delta^2)$ term comes from the momentum perturbation.\n1895: \n1896: For the swarm-level Lyapunov function $V(\\mathcal{S}) = 1 + \\frac{1}{N} \\sum_{i=1}^N E^2(Z^{(i)})$:\n1897: \n1898: $$\n1899: \\begin{align*}\n1900: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq (1 - \\lambda \\Delta t) V(\\mathcal{S}) + \\lambda \\Delta t \\cdot V(\\mathcal{S}_{\\text{after clone}}) \\\\\n1901: &\\leq V(\\mathcal{S}) + \\lambda \\Delta t \\cdot O(\\delta^2 + \\bar{E}^2)\n1902: \\end{align*}\n1903: $$\n1904: \n1905: where $\\bar{E} = \\frac{1}{N} \\sum_i E(Z^{(i)})$ is the average energy.\n1906: \n1907: **Step 2c: Rigorous composition of drift conditions**\n1908: \n1909: We now prove that the composed operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$ satisfies a drift condition with $\\Delta t$-uniform constants.\n1910: \n1911: **Substep 2c.i**: Tower property and conditional expectation\n1912: \n1913: $$\n1914: \\begin{align*}\n1915: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &= \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S}))) | \\mathcal{S}] \\\\\n1916: &= \\mathbb{E}[\\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\,\\big|\\, \\mathcal{S}' = \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})]\n1917: \\end{align*}\n1918: $$\n1919: \n1920: by the tower property.\n1921: \n1922: **Substep 2c.ii**: Apply cloning drift from Step 2b\n1923: \n1924: From Step 2b, the cloning operator satisfies:\n1925: \n1926: $$\n1927: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\leq V(\\mathcal{S}') + \\lambda \\Delta t C_{\\text{clone}}\n1928: $$\n1929: \n1930: where $C_{\\text{clone}} = O(\\delta^2 M_4)$ (fourth moment bound) is independent of $\\Delta t$.\n1931: \n1932: **Substep 2c.iii**: Substitute and use BAOAB drift from Step 2a\n1933: \n1934: $$\n1935: \\begin{align*}\n1936: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq \\mathbb{E}[V(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] + \\lambda \\Delta t C_{\\text{clone}} \\\\\n1937: &\\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_E \\Delta t + \\lambda \\Delta t C_{\\text{clone}}\n1938: \\end{align*}\n1939: $$\n1940: \n1941: where we used the BAOAB drift from Step 2a in the second inequality.\n1942: \n1943: **Substep 2c.iv**: Final drift condition\n1944: \n1945: Setting $C_4 = C_E + \\lambda C_{\\text{clone}}$:\n1946: \n1947: $$\n1948: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] \\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_4 \\Delta t\n1949: $$\n1950: \n1951: **Substep 2c.v**: Verify uniformity in $\\Delta t$**\n1952: \n1953: The constants are $\\Delta t$-independent because:\n1954: 1. **$\\kappa_E$**: Derived from continuous-time hypocoercivity (friction coefficient $\\gamma > 0$)\n1955: 2. **$C_E$**: BAOAB constant from Part II, depends on $(\\gamma, \\sigma, \\|\\nabla^2 U\\|)$\n1956: 3. **$C_{\\text{clone}}$**: Cloning constant $= O(\\lambda \\delta^2 M_4)$, system parameters only\n1957: \n1958: For $\\Delta t < \\Delta t_0$ sufficiently small, these constants remain bounded independently of $\\Delta t$.\n1959: \n1960: **Conclusion**: The composed operator $\\mathcal{T}^{\\Delta t}$ satisfies a **uniform drift condition** with rate $\\kappa = \\kappa_E \\Delta t$ and constant $b = C_4 \\Delta t$, where both $\\kappa_E$ and $C_4$ are independent of $\\Delta t$.\n1961: \n1962: **Step 3: Minorization condition**\n1963: \n1964: The cloning operator ensures that the chain can \"jump\" to any region of the state space with positive probability. We need to show that for any measurable set $A$ and any state in a small set $C$, there exists a uniform lower bound on the transition probability.\n1965: \n1966: **Step 3a: Cloning provides irreducibility**\n1967: \n1968: When a cloning event occurs (probability $\\lambda \\Delta t$), a walker $i$ is replaced by a perturbed copy of walker $j$ selected from the fitness distribution:\n1969: \n1970: $$\n1971: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi, \\quad \\xi \\sim \\mathcal{N}(0, I)\n1972: $$\n1973: \n1974: The Gaussian noise $\\xi$ has **full support** on $\\mathbb{R}^d$, meaning any open set in velocity space can be reached with positive probability.\n1975: \n1976: **Step 3b: Minorization on small sets**\n1977: \n1978: Define the small set $C = \\{\\mathcal{S} : V(\\mathcal{S}) \\leq M\\}$ for some large $M$. For states in $C$, the energies are bounded: $E(Z^{(i)}) \\leq \\sqrt{M}$ for all $i$.\n1979: \n1980: Consider any measurable set $A \\subset \\mathbb{R}^{Nd} \\times \\mathbb{R}^{Nd}$ (the full swarm state space). We need to bound:\n1981: \n1982: $$\n1983: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) = P(\\mathcal{T}^{\\Delta t}(\\mathcal{S}) \\in A | \\mathcal{S})\n1984: $$\n1985: \n1986: **Case 1: Set $A$ is \"large\"** (say $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$ for some $\\varepsilon > 0$)\n1987: \n1988: The transition probability can be decomposed:\n1989: \n1990: $$\n1991: \\begin{align*}\n1992: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) &\\geq P(\\text{clone occurs}) \\cdot P(\\text{land in } A | \\text{clone}) \\\\\n1993: &\\geq \\lambda \\Delta t \\cdot P(\\text{land in } A | \\text{clone})\n1994: \\end{align*}\n1995: $$\n1996: \n1997: The key observation is that the cloning mechanism with Gaussian momentum perturbation can reach **any** configuration with positive probability. Specifically:\n1998: \n1999: 1. **Position inheritance**: The cloned walker inherits position $x^{(j)}$ from a source walker\n2000: 2. **Velocity randomization**: The momentum perturbation $\\delta \\xi$ adds Gaussian noise with full support\n2001: \n2002: For states $\\mathcal{S} \\in C$, the positions and velocities are bounded (by the energy bound). The probability of landing in set $A$ after cloning is bounded below by:\n2003: \n2004: $$\n2005: P(\\text{land in } A | \\text{clone}, \\mathcal{S} \\in C) \\geq \\frac{1}{N} \\int_A p_{\\delta}(v) \\, dv \\geq c_{\\delta, A}\n2006: $$\n2007: \n2008: where $p_{\\delta}$ is the density of the Gaussian perturbation $\\mathcal{N}(0, \\delta^2 I)$ and $c_{\\delta, A} > 0$ depends on $\\delta$ and the \"size\" of $A$ but not on $\\Delta t$.\n2009: \n2010: **Step 3c: Uniform minorization constant**\n2011: \n2012: Combining the above, for $\\mathcal{S} \\in C$ and $A$ with $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$:\n2013: \n2014: $$\n2015: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) \\geq \\lambda \\Delta t \\cdot c_{\\delta, A}\n2016: $$\n2017: \n2018: However, we need a minorization that does not depend on $\\Delta t$. The standard approach (Meyn & Tweedie, Chapter 5) is to consider the **$k$-step transition kernel** $(\\mathcal{T}^{\\Delta t})^k$ for some fixed $k = k(\\Delta t_0)$ chosen such that $k \\Delta t_0 = \\tau_0$ is a fixed time.\n2019: \n2020: For $k$ steps, the probability of at least one cloning event is:\n2021: \n2022: $$\n2023: P(\\text{at least one clone in } k \\text{ steps}) = 1 - (1 - \\lambda \\Delta t)^k \\geq 1 - e^{-\\lambda k \\Delta t} \\geq \\lambda k \\Delta t / 2\n2024: $$\n2025: \n2026: for $\\lambda k \\Delta t$ small. Choosing $k = \\tau_0 / \\Delta t$ such that $\\lambda \\tau_0 = O(1)$, we get a minorization constant:\n2027: \n2028: $$\n2029: (\\mathcal{T}^{\\Delta t})^k(\\mathcal{S}, A) \\geq \\delta_{\\text{minor}} \\quad \\text{for all } \\mathcal{S} \\in C\n2030: $$\n2031: \n2032: where $\\delta_{\\text{minor}} = (\\lambda \\tau_0 / 2) \\cdot c_{\\delta, A}$ is **independent of $\\Delta t$**.\n2033: \n2034: **Conclusion**: The cloning mechanism provides a uniform minorization condition via the full-support Gaussian noise in momentum perturbation. The constant $\\delta_{\\text{minor}}$ depends on $\\lambda, \\delta, \\varepsilon$ but not on $\\Delta t$ (for $\\Delta t < \\Delta t_0$).\n2035: \n2036: **Step 4: State the geometric ergodicity theorem**\n2037: \n2038: We now apply the standard result connecting drift and minorization to geometric ergodicity.\n2039: \n2040: :::{prf:theorem} Drift-Minorization Implies Geometric Ergodicity (Meyn & Tweedie)\n2041: :label: thm-meyn-tweedie-drift-minor\n2042: \n2043: Let $\\mathcal{T}$ be a Markov transition kernel on a state space $\\mathcal{S}$ with invariant measure $\\nu$. Suppose:\n2044: \n2045: 1. **Drift condition**: There exists a Lyapunov function $V: \\mathcal{S} \\to [1, \\infty)$ and constants $\\kappa > 0$, $b < \\infty$ such that:\n2046:    $$\n2047:    \\mathcal{T}V(s) \\leq (1 - \\kappa)V(s) + b\n2048:    $$\n2049:    for all $s \\in \\mathcal{S}$.\n2050: \n2051: 2. **Minorization condition**: There exists a small set $C = \\{s : V(s) \\leq M\\}$, a probability measure $\\nu_{\\min}$, and $\\delta > 0$ such that:\n2052:    $$\n2053:    \\mathcal{T}(s, A) \\geq \\delta \\nu_{\\min}(A)\n2054:    $$\n2055:    for all $s \\in C$ and all measurable sets $A$.\n2056: \n2057: Then the chain is geometrically ergodic with rate:\n2058: $$\n2059: \\|\\mathcal{T}^n(s, \\cdot) - \\nu\\|_{\\text{TV}} \\leq C_{\\text{erg}} \\rho^n V(s)\n2060: $$",
      "metadata": {
        "label": "thm-meyn-tweedie-drift-minor"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "1840: :::\n1841: \n1842: :::{prf:proof}\n1843: :label: proof-lem-uniform-geometric-ergodicity\n1844: \n1845: The proof follows the standard Lyapunov drift approach for discrete-time Markov chains (Meyn & Tweedie, 2009, Chapter 15).\n1846: \n1847: **Step 1: Discrete Lyapunov function**\n1848: \n1849: Define the Lyapunov function $V(Z) = 1 + E^2(Z)$, where $E(Z) = \\frac{1}{2} \\|v\\|^2 + U(x)$ is the total energy (same as Part II).\n1850: \n1851: **Step 2: Drift condition**\n1852: \n1853: We need to show that $V(Z) = 1 + E^2(Z)$ satisfies a drift condition for the full discrete operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, with constants uniform in $\\Delta t$.\n1854: \n1855: **Step 2a: Drift for BAOAB operator**\n1856: \n1857: From Part II ({prf:ref}`prop-fourth-moment-baoab`), we have for the BAOAB operator alone:\n1858: \n1859: $$\n1860: \\mathbb{E}[E^2(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(Z)) | Z] \\leq (1 - \\kappa_E \\Delta t) E^2(Z) + C_E \\Delta t\n1861: $$\n1862: \n1863: for $\\kappa_E > 0$ and $C_E < \\infty$ independent of $\\Delta t$ (for $\\Delta t < \\Delta t_0$). This uses:\n1864: - The BAOAB integrator is a **symplectic** and **conformal symplectic** integrator\n1865: - Energy dissipation through friction: $\\gamma > 0$\n1866: - Confinement axiom: $U(x) \\to \\infty$ as $|x| \\to \\infty$\n1867: \n1868: **Step 2b: Effect of cloning on Lyapunov function**\n1869: \n1870: The cloning operator replaces the worst-fit walker with a perturbed copy of a better walker:\n1871: \n1872: $$\n1873: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi\n1874: $$\n1875: \n1876: The energy change for the replaced walker is:\n1877: \n1878: $$\n1879: \\Delta E^{(i)} = E(Z_{\\text{new}}^{(i)}) - E(Z_{\\text{old}}^{(i)}) = \\frac{1}{2} \\|v_{\\text{new}}^{(i)}\\|^2 + U(x^{(j)}) - \\frac{1}{2} \\|v_{\\text{old}}^{(i)}\\|^2 - U(x_{\\text{old}}^{(i)})\n1880: $$\n1881: \n1882: Taking expectation over the cloning randomness (selecting $j$ and the noise $\\xi$):\n1883: \n1884: $$\n1885: \\mathbb{E}[\\Delta E^{(i)} | \\mathcal{S}] = \\mathbb{E}_j \\left[ \\frac{1}{2} ((1 - \\delta^2) \\|v^{(j)}\\|^2 + d\\delta^2) + U(x^{(j)}) \\right] - E(Z_{\\text{old}}^{(i)})\n1886: $$\n1887: \n1888: Since the fitness-proportional selection favors walkers with **higher fitness** (lower energy in our convention), we have:\n1889: \n1890: $$\n1891: \\mathbb{E}_j [E(Z^{(j)})] \\leq \\frac{1}{N} \\sum_{k=1}^N E(Z^{(k)}) + O(\\delta^2)\n1892: $$\n1893: \n1894: where the $O(\\delta^2)$ term comes from the momentum perturbation.\n1895: \n1896: For the swarm-level Lyapunov function $V(\\mathcal{S}) = 1 + \\frac{1}{N} \\sum_{i=1}^N E^2(Z^{(i)})$:\n1897: \n1898: $$\n1899: \\begin{align*}\n1900: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq (1 - \\lambda \\Delta t) V(\\mathcal{S}) + \\lambda \\Delta t \\cdot V(\\mathcal{S}_{\\text{after clone}}) \\\\\n1901: &\\leq V(\\mathcal{S}) + \\lambda \\Delta t \\cdot O(\\delta^2 + \\bar{E}^2)\n1902: \\end{align*}\n1903: $$\n1904: \n1905: where $\\bar{E} = \\frac{1}{N} \\sum_i E(Z^{(i)})$ is the average energy.\n1906: \n1907: **Step 2c: Rigorous composition of drift conditions**\n1908: \n1909: We now prove that the composed operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$ satisfies a drift condition with $\\Delta t$-uniform constants.\n1910: \n1911: **Substep 2c.i**: Tower property and conditional expectation\n1912: \n1913: $$\n1914: \\begin{align*}\n1915: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &= \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S}))) | \\mathcal{S}] \\\\\n1916: &= \\mathbb{E}[\\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\,\\big|\\, \\mathcal{S}' = \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})]\n1917: \\end{align*}\n1918: $$\n1919: \n1920: by the tower property.\n1921: \n1922: **Substep 2c.ii**: Apply cloning drift from Step 2b\n1923: \n1924: From Step 2b, the cloning operator satisfies:\n1925: \n1926: $$\n1927: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\leq V(\\mathcal{S}') + \\lambda \\Delta t C_{\\text{clone}}\n1928: $$\n1929: \n1930: where $C_{\\text{clone}} = O(\\delta^2 M_4)$ (fourth moment bound) is independent of $\\Delta t$.\n1931: \n1932: **Substep 2c.iii**: Substitute and use BAOAB drift from Step 2a\n1933: \n1934: $$\n1935: \\begin{align*}\n1936: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq \\mathbb{E}[V(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] + \\lambda \\Delta t C_{\\text{clone}} \\\\\n1937: &\\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_E \\Delta t + \\lambda \\Delta t C_{\\text{clone}}\n1938: \\end{align*}\n1939: $$\n1940: \n1941: where we used the BAOAB drift from Step 2a in the second inequality.\n1942: \n1943: **Substep 2c.iv**: Final drift condition\n1944: \n1945: Setting $C_4 = C_E + \\lambda C_{\\text{clone}}$:\n1946: \n1947: $$\n1948: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] \\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_4 \\Delta t\n1949: $$\n1950: \n1951: **Substep 2c.v**: Verify uniformity in $\\Delta t$**\n1952: \n1953: The constants are $\\Delta t$-independent because:\n1954: 1. **$\\kappa_E$**: Derived from continuous-time hypocoercivity (friction coefficient $\\gamma > 0$)\n1955: 2. **$C_E$**: BAOAB constant from Part II, depends on $(\\gamma, \\sigma, \\|\\nabla^2 U\\|)$\n1956: 3. **$C_{\\text{clone}}$**: Cloning constant $= O(\\lambda \\delta^2 M_4)$, system parameters only\n1957: \n1958: For $\\Delta t < \\Delta t_0$ sufficiently small, these constants remain bounded independently of $\\Delta t$.\n1959: \n1960: **Conclusion**: The composed operator $\\mathcal{T}^{\\Delta t}$ satisfies a **uniform drift condition** with rate $\\kappa = \\kappa_E \\Delta t$ and constant $b = C_4 \\Delta t$, where both $\\kappa_E$ and $C_4$ are independent of $\\Delta t$.\n1961: \n1962: **Step 3: Minorization condition**\n1963: \n1964: The cloning operator ensures that the chain can \"jump\" to any region of the state space with positive probability. We need to show that for any measurable set $A$ and any state in a small set $C$, there exists a uniform lower bound on the transition probability.\n1965: \n1966: **Step 3a: Cloning provides irreducibility**\n1967: \n1968: When a cloning event occurs (probability $\\lambda \\Delta t$), a walker $i$ is replaced by a perturbed copy of walker $j$ selected from the fitness distribution:\n1969: \n1970: $$\n1971: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi, \\quad \\xi \\sim \\mathcal{N}(0, I)\n1972: $$\n1973: \n1974: The Gaussian noise $\\xi$ has **full support** on $\\mathbb{R}^d$, meaning any open set in velocity space can be reached with positive probability.\n1975: \n1976: **Step 3b: Minorization on small sets**\n1977: \n1978: Define the small set $C = \\{\\mathcal{S} : V(\\mathcal{S}) \\leq M\\}$ for some large $M$. For states in $C$, the energies are bounded: $E(Z^{(i)}) \\leq \\sqrt{M}$ for all $i$.\n1979: \n1980: Consider any measurable set $A \\subset \\mathbb{R}^{Nd} \\times \\mathbb{R}^{Nd}$ (the full swarm state space). We need to bound:\n1981: \n1982: $$\n1983: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) = P(\\mathcal{T}^{\\Delta t}(\\mathcal{S}) \\in A | \\mathcal{S})\n1984: $$\n1985: \n1986: **Case 1: Set $A$ is \"large\"** (say $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$ for some $\\varepsilon > 0$)\n1987: \n1988: The transition probability can be decomposed:\n1989: \n1990: $$\n1991: \\begin{align*}\n1992: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) &\\geq P(\\text{clone occurs}) \\cdot P(\\text{land in } A | \\text{clone}) \\\\\n1993: &\\geq \\lambda \\Delta t \\cdot P(\\text{land in } A | \\text{clone})\n1994: \\end{align*}\n1995: $$\n1996: \n1997: The key observation is that the cloning mechanism with Gaussian momentum perturbation can reach **any** configuration with positive probability. Specifically:\n1998: \n1999: 1. **Position inheritance**: The cloned walker inherits position $x^{(j)}$ from a source walker\n2000: 2. **Velocity randomization**: The momentum perturbation $\\delta \\xi$ adds Gaussian noise with full support\n2001: \n2002: For states $\\mathcal{S} \\in C$, the positions and velocities are bounded (by the energy bound). The probability of landing in set $A$ after cloning is bounded below by:\n2003: \n2004: $$\n2005: P(\\text{land in } A | \\text{clone}, \\mathcal{S} \\in C) \\geq \\frac{1}{N} \\int_A p_{\\delta}(v) \\, dv \\geq c_{\\delta, A}\n2006: $$\n2007: \n2008: where $p_{\\delta}$ is the density of the Gaussian perturbation $\\mathcal{N}(0, \\delta^2 I)$ and $c_{\\delta, A} > 0$ depends on $\\delta$ and the \"size\" of $A$ but not on $\\Delta t$.\n2009: \n2010: **Step 3c: Uniform minorization constant**\n2011: \n2012: Combining the above, for $\\mathcal{S} \\in C$ and $A$ with $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$:\n2013: \n2014: $$\n2015: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) \\geq \\lambda \\Delta t \\cdot c_{\\delta, A}\n2016: $$\n2017: \n2018: However, we need a minorization that does not depend on $\\Delta t$. The standard approach (Meyn & Tweedie, Chapter 5) is to consider the **$k$-step transition kernel** $(\\mathcal{T}^{\\Delta t})^k$ for some fixed $k = k(\\Delta t_0)$ chosen such that $k \\Delta t_0 = \\tau_0$ is a fixed time.\n2019: \n2020: For $k$ steps, the probability of at least one cloning event is:\n2021: \n2022: $$\n2023: P(\\text{at least one clone in } k \\text{ steps}) = 1 - (1 - \\lambda \\Delta t)^k \\geq 1 - e^{-\\lambda k \\Delta t} \\geq \\lambda k \\Delta t / 2\n2024: $$\n2025: \n2026: for $\\lambda k \\Delta t$ small. Choosing $k = \\tau_0 / \\Delta t$ such that $\\lambda \\tau_0 = O(1)$, we get a minorization constant:\n2027: \n2028: $$\n2029: (\\mathcal{T}^{\\Delta t})^k(\\mathcal{S}, A) \\geq \\delta_{\\text{minor}} \\quad \\text{for all } \\mathcal{S} \\in C\n2030: $$\n2031: \n2032: where $\\delta_{\\text{minor}} = (\\lambda \\tau_0 / 2) \\cdot c_{\\delta, A}$ is **independent of $\\Delta t$**.\n2033: \n2034: **Conclusion**: The cloning mechanism provides a uniform minorization condition via the full-support Gaussian noise in momentum perturbation. The constant $\\delta_{\\text{minor}}$ depends on $\\lambda, \\delta, \\varepsilon$ but not on $\\Delta t$ (for $\\Delta t < \\Delta t_0$).\n2035: \n2036: **Step 4: State the geometric ergodicity theorem**\n2037: \n2038: We now apply the standard result connecting drift and minorization to geometric ergodicity.\n2039: \n2040: :::{prf:theorem} Drift-Minorization Implies Geometric Ergodicity (Meyn & Tweedie)\n2041: :label: thm-meyn-tweedie-drift-minor\n2042: \n2043: Let $\\mathcal{T}$ be a Markov transition kernel on a state space $\\mathcal{S}$ with invariant measure $\\nu$. Suppose:\n2044: \n2045: 1. **Drift condition**: There exists a Lyapunov function $V: \\mathcal{S} \\to [1, \\infty)$ and constants $\\kappa > 0$, $b < \\infty$ such that:\n2046:    $$\n2047:    \\mathcal{T}V(s) \\leq (1 - \\kappa)V(s) + b\n2048:    $$\n2049:    for all $s \\in \\mathcal{S}$.\n2050: \n2051: 2. **Minorization condition**: There exists a small set $C = \\{s : V(s) \\leq M\\}$, a probability measure $\\nu_{\\min}$, and $\\delta > 0$ such that:\n2052:    $$\n2053:    \\mathcal{T}(s, A) \\geq \\delta \\nu_{\\min}(A)\n2054:    $$\n2055:    for all $s \\in C$ and all measurable sets $A$.\n2056: \n2057: Then the chain is geometrically ergodic with rate:\n2058: $$\n2059: \\|\\mathcal{T}^n(s, \\cdot) - \\nu\\|_{\\text{TV}} \\leq C_{\\text{erg}} \\rho^n V(s)\n2060: $$\n2061: "
    },
    {
      "directive_type": "proposition",
      "label": "prop-mixing-rate-relationship",
      "title": "Relationship Between Continuous and Discrete Mixing Rates",
      "start_line": 2120,
      "end_line": 2140,
      "header_lines": [
        2121
      ],
      "content_start": 2123,
      "content_end": 2139,
      "content": "2123: :label: prop-mixing-rate-relationship\n2124: \n2125: Let $\\mathcal{L}$ be a generator with spectral gap $\\lambda_1 > 0$ (so the continuous-time semigroup $\\mathcal{P}^t = e^{t\\mathcal{L}}$ has mixing rate $\\kappa_{\\text{mix}}^{\\text{cont}} = \\lambda_1$).\n2126: \n2127: For any fixed time step $\\tau > 0$, the discrete-time Markov chain with transition kernel $\\mathcal{P}^\\tau = e^{\\tau \\mathcal{L}}$ is geometrically ergodic with mixing rate:\n2128: \n2129: $$\n2130: \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) = -\\frac{1}{\\tau} \\log(1 - \\lambda_1(\\tau))\n2131: $$\n2132: \n2133: where $\\lambda_1(\\tau) = 1 - e^{-\\tau \\lambda_1}$ is the spectral gap of the discrete operator $I - \\mathcal{P}^\\tau$.\n2134: \n2135: For small $\\tau$, we have:\n2136: \n2137: $$\n2138: \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) = \\lambda_1 + O(\\tau) = \\kappa_{\\text{mix}}^{\\text{cont}} + O(\\tau)\n2139: $$",
      "metadata": {
        "label": "prop-mixing-rate-relationship"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "2120: ---\n2121: \n2122: :::{prf:proposition} Relationship Between Continuous and Discrete Mixing Rates\n2123: :label: prop-mixing-rate-relationship\n2124: \n2125: Let $\\mathcal{L}$ be a generator with spectral gap $\\lambda_1 > 0$ (so the continuous-time semigroup $\\mathcal{P}^t = e^{t\\mathcal{L}}$ has mixing rate $\\kappa_{\\text{mix}}^{\\text{cont}} = \\lambda_1$).\n2126: \n2127: For any fixed time step $\\tau > 0$, the discrete-time Markov chain with transition kernel $\\mathcal{P}^\\tau = e^{\\tau \\mathcal{L}}$ is geometrically ergodic with mixing rate:\n2128: \n2129: $$\n2130: \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) = -\\frac{1}{\\tau} \\log(1 - \\lambda_1(\\tau))\n2131: $$\n2132: \n2133: where $\\lambda_1(\\tau) = 1 - e^{-\\tau \\lambda_1}$ is the spectral gap of the discrete operator $I - \\mathcal{P}^\\tau$.\n2134: \n2135: For small $\\tau$, we have:\n2136: \n2137: $$\n2138: \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) = \\lambda_1 + O(\\tau) = \\kappa_{\\text{mix}}^{\\text{cont}} + O(\\tau)\n2139: $$\n2140: "
    },
    {
      "directive_type": "proof",
      "label": "proof-prop-mixing-rate-relationship",
      "title": null,
      "start_line": 2142,
      "end_line": 2177,
      "header_lines": [
        2143
      ],
      "content_start": 2145,
      "content_end": 2176,
      "content": "2145: :label: proof-prop-mixing-rate-relationship\n2146: \n2147: **Step 1: Spectral analysis**\n2148: \n2149: For a reversible ergodic Markov process with generator $\\mathcal{L}$, the spectral gap $\\lambda_1$ is defined as:\n2150: \n2151: $$\n2152: \\lambda_1 = \\inf_{\\phi: \\mathbb{E}_\\pi[\\phi]=0} \\frac{-\\langle \\phi, \\mathcal{L}\\phi \\rangle_{L^2(\\pi)}}{\\langle \\phi, \\phi \\rangle_{L^2(\\pi)}}\n2153: $$\n2154: \n2155: The semigroup satisfies $\\|\\mathcal{P}^t - \\pi\\|_{L^2(\\pi)} \\leq e^{-\\lambda_1 t}$.\n2156: \n2157: **Step 2: Discrete-time spectral gap**\n2158: \n2159: For the discrete operator $\\mathcal{P}^\\tau$, the spectrum is related to the continuous spectrum by exponentiation: if $\\mu$ is an eigenvalue of $\\mathcal{L}$, then $e^{\\tau \\mu}$ is an eigenvalue of $\\mathcal{P}^\\tau$.\n2160: \n2161: The largest non-trivial eigenvalue of $\\mathcal{P}^\\tau$ is $e^{-\\tau \\lambda_1}$, so the spectral gap of $I - \\mathcal{P}^\\tau$ is:\n2162: \n2163: $$\n2164: \\lambda_1(\\tau) = 1 - e^{-\\tau \\lambda_1}\n2165: $$\n2166: \n2167: **Step 3: Transfer to discrete chain**\n2168: \n2169: By Theorem 3.10 of Hairer, Stuart, Voss (2011), if the continuous-time generator $\\mathcal{L}$ generates a geometrically ergodic semigroup with drift and minorization constants satisfying certain regularity conditions, then the discrete-time chain with kernel $\\mathcal{P}^\\tau = e^{\\tau \\mathcal{L}}$ is also geometrically ergodic for $\\tau$ sufficiently small, with mixing rate $\\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau)$ satisfying:\n2170: \n2171: $$\n2172: c_1 \\kappa_{\\text{mix}}^{\\text{cont}} \\leq \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) \\leq c_2 \\kappa_{\\text{mix}}^{\\text{cont}}\n2173: $$\n2174: \n2175: for some constants $c_1, c_2 > 0$ independent of $\\tau$ (for $\\tau < \\tau_0$).\n2176: ",
      "metadata": {
        "label": "proof-prop-mixing-rate-relationship"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "2142: :::\n2143: \n2144: :::{prf:proof}\n2145: :label: proof-prop-mixing-rate-relationship\n2146: \n2147: **Step 1: Spectral analysis**\n2148: \n2149: For a reversible ergodic Markov process with generator $\\mathcal{L}$, the spectral gap $\\lambda_1$ is defined as:\n2150: \n2151: $$\n2152: \\lambda_1 = \\inf_{\\phi: \\mathbb{E}_\\pi[\\phi]=0} \\frac{-\\langle \\phi, \\mathcal{L}\\phi \\rangle_{L^2(\\pi)}}{\\langle \\phi, \\phi \\rangle_{L^2(\\pi)}}\n2153: $$\n2154: \n2155: The semigroup satisfies $\\|\\mathcal{P}^t - \\pi\\|_{L^2(\\pi)} \\leq e^{-\\lambda_1 t}$.\n2156: \n2157: **Step 2: Discrete-time spectral gap**\n2158: \n2159: For the discrete operator $\\mathcal{P}^\\tau$, the spectrum is related to the continuous spectrum by exponentiation: if $\\mu$ is an eigenvalue of $\\mathcal{L}$, then $e^{\\tau \\mu}$ is an eigenvalue of $\\mathcal{P}^\\tau$.\n2160: \n2161: The largest non-trivial eigenvalue of $\\mathcal{P}^\\tau$ is $e^{-\\tau \\lambda_1}$, so the spectral gap of $I - \\mathcal{P}^\\tau$ is:\n2162: \n2163: $$\n2164: \\lambda_1(\\tau) = 1 - e^{-\\tau \\lambda_1}\n2165: $$\n2166: \n2167: **Step 3: Transfer to discrete chain**\n2168: \n2169: By Theorem 3.10 of Hairer, Stuart, Voss (2011), if the continuous-time generator $\\mathcal{L}$ generates a geometrically ergodic semigroup with drift and minorization constants satisfying certain regularity conditions, then the discrete-time chain with kernel $\\mathcal{P}^\\tau = e^{\\tau \\mathcal{L}}$ is also geometrically ergodic for $\\tau$ sufficiently small, with mixing rate $\\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau)$ satisfying:\n2170: \n2171: $$\n2172: c_1 \\kappa_{\\text{mix}}^{\\text{cont}} \\leq \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) \\leq c_2 \\kappa_{\\text{mix}}^{\\text{cont}}\n2173: $$\n2174: \n2175: for some constants $c_1, c_2 > 0$ independent of $\\tau$ (for $\\tau < \\tau_0$).\n2176: \n2177: **Conclusion**: The discrete mixing rate is comparable to the continuous mixing rate, differing only by a structural constant. For the error analysis in Section 3, we will use the **continuous-time mixing rate** $\\kappa_{\\text{mix}}^{\\text{cont}}$ in the Poisson equation bounds, understanding that this determines the error constant up to a factor of order 1."
    },
    {
      "directive_type": "theorem",
      "label": "thm-quantitative-error-propagation",
      "title": "Error Propagation for Ergodic Chains",
      "start_line": 2188,
      "end_line": 2200,
      "header_lines": [
        2189
      ],
      "content_start": 2191,
      "content_end": 2199,
      "content": "2191: :label: thm-quantitative-error-propagation\n2192: \n2193: Suppose:\n2194: 1. The one-step weak error satisfies $\\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2$\n2195: 2. The discrete chain is geometrically ergodic with rate $\\kappa_{\\text{mix}}$, uniformly in $\\Delta t$\n2196: \n2197: Then the error in invariant measures is:\n2198: \n2199: $$",
      "metadata": {
        "label": "thm-quantitative-error-propagation"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "2188: Now we connect the $O((\\Delta t)^2)$ local weak error to the $O(\\Delta t)$ global error in invariant measures. The key is to relate the discrete-time invariant measure $\\nu_N^{\\text{discrete}}$ to the continuous-time invariant measure $\\nu_N^{\\text{cont}}$ using the Poisson equation.\n2189: \n2190: :::{prf:theorem} Error Propagation for Ergodic Chains\n2191: :label: thm-quantitative-error-propagation\n2192: \n2193: Suppose:\n2194: 1. The one-step weak error satisfies $\\left|\\mathbb{E}[(\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t})\\phi(Z)]\\right| \\leq C_{\\text{split}} \\|\\phi\\|_{C^4} (\\Delta t)^2$\n2195: 2. The discrete chain is geometrically ergodic with rate $\\kappa_{\\text{mix}}$, uniformly in $\\Delta t$\n2196: \n2197: Then the error in invariant measures is:\n2198: \n2199: $$\n2200: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\phi] \\right| \\leq \\frac{C_{\\text{split}}}{\\kappa_{\\text{mix}}} \\|\\phi\\|_{C^4} \\Delta t"
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-full-system-discretization-error",
      "title": "Proof of {prf:ref}`thm-full-system-discretization-error`",
      "start_line": 2202,
      "end_line": 2241,
      "header_lines": [
        2203
      ],
      "content_start": 2205,
      "content_end": 2240,
      "content": "2205: :label: proof-thm-full-system-discretization-error\n2206: \n2207: **Step 1: Centered observable and Poisson equation**\n2208: \n2209: To make the argument precise, define the centered observable:\n2210: \n2211: $$\n2212: \\phi_c := \\phi - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi]\n2213: $$\n2214: \n2215: Then $\\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi_c] = 0$ and the error is:\n2216: \n2217: $$\n2218: \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] = \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi_c]\n2219: $$\n2220: \n2221: The Poisson equation for the **continuous-time generator** $\\mathcal{L}$ is:\n2222: \n2223: $$\n2224: \\mathcal{L} \\psi = -\\phi_c\n2225: $$\n2226: \n2227: Under geometric ergodicity of the continuous-time process (with spectral gap $\\kappa_{\\text{mix}}^{\\text{cont}} > 0$), this has a unique solution $\\psi$ with:\n2228: \n2229: $$\n2230: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi_c\\|_{C^4} = \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}\n2231: $$\n2232: \n2233: where $C_{\\text{poisson}}$ is a structural constant (see Hairer 2010, Theorem 4.1).\n2234: \n2235: **Important**: The mixing rate $\\kappa_{\\text{mix}}^{\\text{cont}}$ is a property of the **continuous-time generator** $\\mathcal{L}$, not the discrete chain.\n2236: \n2237: :::{note}\n2238: **Remark on potential regularity improvement**: For generators of Langevin-type SDEs with sufficient non-degeneracy (satisfying H\u00f6rmander's bracket condition), hypoelliptic regularity theory implies that solutions $\\psi$ to the Poisson equation $\\mathcal{L}\\psi = -\\phi_c$ possess higher regularity than $\\phi_c$ itself - typically gaining two derivatives from elliptic/hypoelliptic smoothing (H\u00f6rmander 1967).\n2239: \n2240: Establishing H\u00f6rmander's condition for the full Fragile Gas generator $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$ would require verifying that the Lie algebra generated by the drift and diffusion vector fields spans the tangent space at every point. For the Langevin component alone, this is standard (see Hairer & Mattingly 2006 for similar systems). However, the addition of the jump operator $\\mathcal{L}_{\\text{clone}}$ complicates the analysis.",
      "metadata": {
        "label": "proof-thm-full-system-discretization-error"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "raw_directive": "2202: :::\n2203: \n2204: :::{prf:proof} Proof of {prf:ref}`thm-full-system-discretization-error`\n2205: :label: proof-thm-full-system-discretization-error\n2206: \n2207: **Step 1: Centered observable and Poisson equation**\n2208: \n2209: To make the argument precise, define the centered observable:\n2210: \n2211: $$\n2212: \\phi_c := \\phi - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi]\n2213: $$\n2214: \n2215: Then $\\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi_c] = 0$ and the error is:\n2216: \n2217: $$\n2218: \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] = \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi_c]\n2219: $$\n2220: \n2221: The Poisson equation for the **continuous-time generator** $\\mathcal{L}$ is:\n2222: \n2223: $$\n2224: \\mathcal{L} \\psi = -\\phi_c\n2225: $$\n2226: \n2227: Under geometric ergodicity of the continuous-time process (with spectral gap $\\kappa_{\\text{mix}}^{\\text{cont}} > 0$), this has a unique solution $\\psi$ with:\n2228: \n2229: $$\n2230: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi_c\\|_{C^4} = \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}\n2231: $$\n2232: \n2233: where $C_{\\text{poisson}}$ is a structural constant (see Hairer 2010, Theorem 4.1).\n2234: \n2235: **Important**: The mixing rate $\\kappa_{\\text{mix}}^{\\text{cont}}$ is a property of the **continuous-time generator** $\\mathcal{L}$, not the discrete chain.\n2236: \n2237: :::{note}\n2238: **Remark on potential regularity improvement**: For generators of Langevin-type SDEs with sufficient non-degeneracy (satisfying H\u00f6rmander's bracket condition), hypoelliptic regularity theory implies that solutions $\\psi$ to the Poisson equation $\\mathcal{L}\\psi = -\\phi_c$ possess higher regularity than $\\phi_c$ itself - typically gaining two derivatives from elliptic/hypoelliptic smoothing (H\u00f6rmander 1967).\n2239: \n2240: Establishing H\u00f6rmander's condition for the full Fragile Gas generator $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$ would require verifying that the Lie algebra generated by the drift and diffusion vector fields spans the tangent space at every point. For the Langevin component alone, this is standard (see Hairer & Mattingly 2006 for similar systems). However, the addition of the jump operator $\\mathcal{L}_{\\text{clone}}$ complicates the analysis.\n2241: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}