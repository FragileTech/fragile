{
  "chapter_index": 2,
  "section_id": "## Part II: Time Discretization Error Bounds",
  "directive_count": 8,
  "hints": [
    {
      "directive_type": "proposition",
      "label": "prop-fourth-moment-baoab",
      "title": "Fourth-Moment Uniform Bounds for BAOAB",
      "start_line": 743,
      "end_line": 753,
      "header_lines": [
        744
      ],
      "content_start": 746,
      "content_end": 752,
      "content": "746: :label: prop-fourth-moment-baoab\n747: \n748: Let $\\{Z_k\\}_{k \\geq 0}$ be the BAOAB chain with step size $\\Delta t$ initialized from the continuous-time invariant measure $\\nu^{\\text{cont}}$. Under the confinement axiom ({prf:ref}`def-confined-potential`), there exists a constant $M_4 < \\infty$ independent of $\\Delta t$ (for $\\Delta t$ sufficiently small) such that:\n749: \n750: $$\n751: \\sup_{k \\geq 0} \\mathbb{E}_{\\nu^{\\text{cont}}} [|Z_k|^4] \\leq M_4\n752: $$",
      "metadata": {
        "label": "prop-fourth-moment-baoab"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "743: Before proving weak convergence, we need uniform moment bounds for the BAOAB iterates.\n744: \n745: :::{prf:proposition} Fourth-Moment Uniform Bounds for BAOAB\n746: :label: prop-fourth-moment-baoab\n747: \n748: Let $\\{Z_k\\}_{k \\geq 0}$ be the BAOAB chain with step size $\\Delta t$ initialized from the continuous-time invariant measure $\\nu^{\\text{cont}}$. Under the confinement axiom ({prf:ref}`def-confined-potential`), there exists a constant $M_4 < \\infty$ independent of $\\Delta t$ (for $\\Delta t$ sufficiently small) such that:\n749: \n750: $$\n751: \\sup_{k \\geq 0} \\mathbb{E}_{\\nu^{\\text{cont}}} [|Z_k|^4] \\leq M_4\n752: $$\n753: "
    },
    {
      "directive_type": "proof",
      "label": "proof-prop-fourth-moment-baoab",
      "title": null,
      "start_line": 755,
      "end_line": 1078,
      "header_lines": [
        756
      ],
      "content_start": 758,
      "content_end": 1077,
      "content": "758: :label: proof-prop-fourth-moment-baoab\n759: \n760: The proof uses a discrete-time Lyapunov argument on the squared energy of the system. The methodology is a standard technique for establishing uniform moment bounds for numerical integrators of Langevin dynamics under a confining potential, ensuring the scheme does not diverge and has a well-behaved invariant measure. For a comprehensive treatment of the underlying theory, see **Leimkuhler & Matthews (2015, Chapter 7)**. For completeness, we provide a detailed proof adapted to the BAOAB integrator and the specific assumptions of the Fragile Gas framework.\n761: \n762: **Step 1: Energy functional**\n763: \n764: Define the discrete-time energy:\n765: \n766: $$\n767: E(Z) := \\frac{1}{2}|v|^2 + U(x)\n768: $$\n769: \n770: From the energy bounds for the continuous-time Langevin dynamics ({prf:ref}`thm-energy-bounds`), we have:\n771: \n772: $$\n773: \\mathbb{E}_{\\nu^{\\text{cont}}} [E(Z)] = \\mathbb{E}_{\\nu^{\\text{cont}}} \\left[\\frac{1}{2}|v|^2 + U(x)\\right] < \\infty\n774: $$\n775: \n776: **Step 2: BAOAB energy evolution**\n777: \n778: The BAOAB integrator consists of:\n779: - **B step** (position): $x_{k+1/5} = x_k + \\frac{\\Delta t}{2} v_k$\n780: - **A step** (friction): $v_{k+2/5} = e^{-\\gamma \\Delta t/2} v_{k+1/5}$\n781: - **O step** (Ornstein-Uhlenbeck): $v_{k+3/5} = v_{k+2/5} + \\sqrt{1 - e^{-\\gamma \\Delta t}} \\xi_k$ where $\\xi_k \\sim \\mathcal{N}(0, \\frac{\\sigma^2}{\\gamma} I)$\n782: - **A step** (friction): $v_{k+4/5} = e^{-\\gamma \\Delta t/2} v_{k+3/5}$\n783: - **B step** (position): $x_{k+1} = x_{k+1/5} + \\frac{\\Delta t}{2} v_{k+4/5}$\n784: \n785: For the O-step (where noise is added), the expected energy change is:\n786: \n787: $$\n788: \\mathbb{E}[|v_{k+3/5}|^2] = |v_{k+2/5}|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma}\n789: $$\n790: \n791: where $d$ is the dimension.\n792: \n793: **Step 3: Energy dissipation from drift**\n794: \n795: The A-steps provide exponential friction:\n796: \n797: $$\n798: |v_{k+2/5}|^2 = e^{-\\gamma \\Delta t} |v_{k+1/5}|^2 \\leq |v_{k+1/5}|^2\n799: $$\n800: \n801: The B-steps change position but not velocity magnitude. However, they couple velocity to the potential gradient.\n802: \n803: By the confinement condition:\n804: \n805: $$\n806: \\mathbb{E}[\\Delta U] \\approx \\mathbb{E}[\\langle \\nabla U(x_k), \\Delta x_k \\rangle] = \\frac{\\Delta t}{2} \\mathbb{E}[\\langle \\nabla U(x_k), v_k \\rangle]\n807: $$\n808: \n809: For large $|x|$, confinement gives $\\langle x, \\nabla U(x) \\rangle \\geq \\kappa_{\\text{conf}} |x|^2$, providing a restoring force.\n810: \n811: **Step 4: Lyapunov bound**\n812: \n813: Combining the heating (O-step) and dissipation (friction + confinement), the energy satisfies a Lyapunov inequality:\n814: \n815: $$\n816: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_E \\Delta t) E(Z_k) + C_E \\Delta t\n817: $$\n818: \n819: for some constants $\\kappa_E, C_E > 0$ (dependent on $\\gamma, \\sigma, \\kappa_{\\text{conf}}$) when $\\Delta t$ is sufficiently small.\n820: \n821: At stationarity ($k \\to \\infty$):\n822: \n823: $$\n824: \\mathbb{E}_{\\nu^{\\Delta t}} [E(Z)] \\leq \\frac{C_E}{\\kappa_E}\n825: $$\n826: \n827: **Step 5: From energy to fourth moment (Lyapunov on $E^2$)**\n828: \n829: To rigorously bound the fourth moment, we use a Lyapunov argument on $E^2(Z) = (\\frac{1}{2}|v|^2 + U(x))^2$.\n830: \n831: **Substep 5.1: Lyapunov inequality for $E^2$**\n832: \n833: We will show:\n834: \n835: $$\n836: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_4 \\Delta t) E^2(Z_k) + C_4 \\Delta t\n837: $$\n838: \n839: for some constants $\\kappa_4, C_4 > 0$ when $\\Delta t$ is sufficiently small.\n840: \n841: **Substep 5.2: Direct analysis of $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$**\n842: \n843: We will compute $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$ by tracking the evolution through all five BAOAB substeps. Define:\n844: \n845: $$\n846: V(Z) := E^2(Z) = \\left(\\frac{1}{2}|v|^2 + U(x)\\right)^2\n847: $$\n848: \n849: Let $Z_k = (x_k, v_k)$ and track the evolution:\n850: - After B: $(x', v_k)$ where $x' = x_k + \\frac{\\Delta t}{2} v_k$\n851: - After A: $(x', v')$ where $v' = e^{-\\gamma \\Delta t/2} v_k$\n852: - After O: $(x', v'')$ where $v'' = v' + \\xi$ and $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n853: - After A: $(x', v''')$ where $v''' = e^{-\\gamma \\Delta t/2} v''$\n854: - After B: $(x_{k+1}, v''')$ where $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n855: \n856: **Substep 5.3: Expansion of $E^2(Z_{k+1})$**\n857: \n858: The energy at step $k+1$ is:\n859: \n860: $$\n861: E(Z_{k+1}) = \\frac{1}{2}|v'''|^2 + U(x_{k+1})\n862: $$\n863: \n864: Expand $U(x_{k+1})$ using Taylor expansion around $x_k$:\n865: \n866: $$\n867: U(x_{k+1}) = U(x_k) + \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n868: $$\n869: \n870: where $\\xi$ is between $x_k$ and $x_{k+1}$.\n871: \n872: Since $|x_{k+1} - x_k| = O(\\Delta t |v_k|)$, we have:\n873: \n874: $$\n875: U(x_{k+1}) = U(x_k) + O(\\Delta t |v_k| |\\nabla U(x_k)|) + O((\\Delta t)^2 |v_k|^2 \\|\\nabla^2 U\\|)\n876: $$\n877: \n878: For $|v'''|^2$, after the A-O-A composition:\n879: \n880: $$\n881: |v'''|^2 = e^{-\\gamma \\Delta t} |v_k|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma} + O(\\Delta t |v_k| |\\xi|)\n882: $$\n883: \n884: where $\\mathbb{E}[|\\xi|^2] = (1-e^{-\\gamma \\Delta t})\\frac{d\\sigma^2}{\\gamma}$.\n885: \n886: **Substep 5.4: Control of $\\mathbb{E}[V(Z_{k+1}) | Z_k]$ for large $V(Z_k)$**\n887: \n888: For large energy $E(Z_k)$, the key observation is:\n889: \n890: 1. **Dissipation from friction**: The velocity magnitude decays by factor $e^{-\\gamma \\Delta t} \\approx 1 - \\gamma \\Delta t$\n891: 2. **Heating from noise**: The noise adds energy $\\sim d\\sigma^2/(2\\gamma)$\n892: 3. **Potential growth**: The potential can increase, but confinement controls this\n893: \n894: Combining these effects, for large $E(Z_k)$:\n895: \n896: $$\n897: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq E(Z_k) - \\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n898: $$\n899: \n900: where $\\kappa_E \\sim \\gamma$ (friction) and $C_E$ accounts for noise and confinement.\n901: \n902: For $V(Z_k) = E^2(Z_k)$, we need to control:\n903: \n904: $$\n905: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = \\mathbb{E}[(E(Z_k) + \\Delta E)^2 | Z_k]\n906: $$\n907: \n908: where $\\Delta E := E(Z_{k+1}) - E(Z_k)$.\n909: \n910: Expanding:\n911: \n912: $$\n913: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = E^2(Z_k) + 2 E(Z_k) \\mathbb{E}[\\Delta E | Z_k] + \\mathbb{E}[(\\Delta E)^2 | Z_k]\n914: $$\n915: \n916: **Substep 5.5: Bound the terms**\n917: \n918: From the first-moment analysis:\n919: \n920: $$\n921: \\mathbb{E}[\\Delta E | Z_k] \\leq -\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n922: $$\n923: \n924: For the second term, we need to bound the variance of the energy change. We will derive this carefully.\n925: \n926: **Proof of variance bound**: Recall $\\Delta E = E(Z_{k+1}) - E(Z_k)$ where the BAOAB evolution takes $Z_k = (x_k, v_k)$ to $Z_{k+1} = (x_{k+1}, v''')$ through:\n927: - B: $x' = x_k + \\frac{\\Delta t}{2} v_k$\n928: - A: $v' = e^{-\\gamma \\Delta t/2} v_k$\n929: - O: $v'' = v' + \\xi$ where $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n930: - A: $v''' = e^{-\\gamma \\Delta t/2} v''$\n931: - B: $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n932: \n933: The energy change is:\n934: \n935: $$\n936: \\Delta E = \\frac{1}{2}(|v'''|^2 - |v_k|^2) + (U(x_{k+1}) - U(x_k))\n937: $$\n938: \n939: **Velocity contribution**: After A-O-A composition:\n940: \n941: $$\n942: v''' = e^{-\\gamma \\Delta t/2}(e^{-\\gamma \\Delta t/2} v_k + \\xi) = e^{-\\gamma \\Delta t} v_k + e^{-\\gamma \\Delta t/2} \\xi\n943: $$\n944: \n945: Therefore:\n946: \n947: $$\n948: |v'''|^2 = e^{-2\\gamma \\Delta t} |v_k|^2 + 2 e^{-3\\gamma \\Delta t/2} \\langle v_k, \\xi \\rangle + e^{-\\gamma \\Delta t} |\\xi|^2\n949: $$\n950: \n951: The variance of the velocity contribution:\n952: \n953: $$\n954: \\text{Var}[\\frac{1}{2}(|v'''|^2 - |v_k|^2) | Z_k] \\leq C_v (\\Delta t)^2 |v_k|^4 + C'_v \\Delta t |v_k|^2 + C''_v \\Delta t\n955: $$\n956: \n957: where we used $\\mathbb{E}[|\\xi|^2] = O(\\Delta t)$, $\\mathbb{E}[|\\xi|^4] = O((\\Delta t)^2)$, and $\\mathbb{E}[\\langle v_k, \\xi \\rangle^2] = |v_k|^2 \\mathbb{E}[|\\xi|^2] = O(\\Delta t |v_k|^2)$.\n958: \n959: **Potential contribution**: Using Taylor expansion:\n960: \n961: $$\n962: U(x_{k+1}) - U(x_k) = \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n963: $$\n964: \n965: Since $|x_{k+1} - x_k| = O(\\Delta t (|v_k| + |v'''|)) = O(\\Delta t |v_k|) + O((\\Delta t)^{3/2})$, we have:\n966: \n967: $$\n968: \\text{Var}[U(x_{k+1}) - U(x_k) | Z_k] \\leq C_U (\\Delta t)^2 |v_k|^2 \\|\\nabla U\\|^2 + C'_U \\Delta t \\|\\nabla U\\|^2\n969: $$\n970: \n971: **Cross-term**: The expansion $(\\Delta E)^2 = (\\Delta E_v)^2 + (\\Delta E_U)^2 + 2 \\Delta E_v \\Delta E_U$ includes a cross-term. By Cauchy-Schwarz:\n972: \n973: $$\n974: 2|\\mathbb{E}[\\Delta E_v \\Delta E_U | Z_k]| \\leq 2\\sqrt{\\text{Var}[\\Delta E_v | Z_k] \\cdot \\text{Var}[\\Delta E_U | Z_k]} \\leq \\text{Var}[\\Delta E_v | Z_k] + \\text{Var}[\\Delta E_U | Z_k]\n975: $$\n976: \n977: This is absorbed into the bounds for the squared terms.\n978: \n979: **Combine**: Using $|v_k|^2 \\leq 2 E(Z_k)$ and combining all terms (velocity, potential, and cross-term):\n980: \n981: $$\n982: \\mathbb{E}[(\\Delta E)^2 | Z_k] \\leq C_{\\text{var}} \\Delta t (1 + E(Z_k))\n983: $$\n984: \n985: where $C_{\\text{var}} = 2\\max\\{C_v + C_U, C'_v + C'_U, C''_v\\}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|, \\|\\nabla^2 U\\|$.\n986: \n987: Combining:\n988: \n989: $$\n990: \\begin{align*}\n991: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) + 2 E(Z_k) (-\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t) + C_{\\text{var}} \\Delta t (1 + E(Z_k)) \\\\\n992: &= E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) + C_{\\text{var}} \\Delta t\n993: \\end{align*}\n994: $$\n995: \n996: **Handle the linear term using Young's inequality**: The term $(2 C_E + C_{\\text{var}}) \\Delta t E(Z_k)$ grows with $E(Z_k)$ and cannot be absorbed into a constant. We use Young's inequality: for any $\\epsilon > 0$,\n997: \n998: $$\n999: E(Z_k) \\leq \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon}\n1000: $$\n1001: \n1002: Therefore:\n1003: \n1004: $$\n1005: (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) \\leq (2 C_E + C_{\\text{var}}) \\Delta t \\left[ \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon} \\right]\n1006: $$\n1007: \n1008: **Choose $\\epsilon$ to absorb into dissipation**: Set\n1009: \n1010: $$\n1011: \\epsilon := \\frac{\\kappa_E}{2 C_E + C_{\\text{var}}}\n1012: $$\n1013: \n1014: Then:\n1015: \n1016: $$\n1017: (2 C_E + C_{\\text{var}}) \\Delta t \\epsilon E^2(Z_k) = \\kappa_E \\Delta t E^2(Z_k)\n1018: $$\n1019: \n1020: Substituting back:\n1021: \n1022: $$\n1023: \\begin{align*}\n1024: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + \\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t \\cdot \\frac{1}{4\\epsilon} + C_{\\text{var}} \\Delta t \\\\\n1025: &= E^2(Z_k) - \\kappa_E \\Delta t E^2(Z_k) + \\left[ \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}} \\right] \\Delta t \\\\\n1026: &= (1 - \\kappa_E \\Delta t) E^2(Z_k) + C'_4 \\Delta t\n1027: \\end{align*}\n1028: $$\n1029: \n1030: where:\n1031: \n1032: $$\n1033: C'_4 := \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\n1034: $$\n1035: \n1036: This gives the Lyapunov inequality with $\\kappa_4 := \\kappa_E$ and $C_4 := C'_4$.\n1037: \n1038: **Substep 5.6: Stationary second moment**\n1039: \n1040: At stationarity:\n1041: \n1042: $$\n1043: \\mathbb{E}_{\\nu^{\\Delta t}} [E^2(Z)] \\leq \\frac{C_4}{\\kappa_4} = \\frac{C'_4}{\\kappa_E} = \\frac{1}{\\kappa_E}\\left[\\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\\right]\n1044: $$\n1045: \n1046: **Substep 5.7: From $E^2$ to fourth moment**\n1047: \n1048: Since $E(Z) = \\frac{1}{2}|v|^2 + U(x)$, we have:\n1049: \n1050: $$\n1051: |Z|^4 = (|x|^2 + |v|^2)^2 \\leq C_{\\text{coeff}} (|v|^4 + |x|^4)\n1052: $$\n1053: \n1054: By confinement, $U(x) \\geq \\kappa_{\\text{conf}} |x|^2 - C_{\\text{conf}}$, so:\n1055: \n1056: $$\n1057: |x|^2 \\leq \\frac{1}{\\kappa_{\\text{conf}}} (U(x) + C_{\\text{conf}}) \\leq \\frac{1}{\\kappa_{\\text{conf}}} (E(Z) + C_{\\text{conf}})\n1058: $$\n1059: \n1060: Therefore:\n1061: \n1062: $$\n1063: |x|^4 \\leq \\frac{1}{\\kappa_{\\text{conf}}^2} (E(Z) + C_{\\text{conf}})^2 \\leq \\frac{2}{\\kappa_{\\text{conf}}^2} (E^2(Z) + C_{\\text{conf}}^2)\n1064: $$\n1065: \n1066: Similarly, $|v|^4 \\leq 4 E^2(Z)$ since $|v|^2 \\leq 2 E(Z)$.\n1067: \n1068: Combining:\n1069: \n1070: $$\n1071: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq C_{\\text{coeff}} \\left( 4 \\mathbb{E}[E^2(Z)] + \\frac{2}{\\kappa_{\\text{conf}}^2} (\\mathbb{E}[E^2(Z)] + C_{\\text{conf}}^2) \\right)\n1072: $$\n1073: \n1074: $$\n1075: \\leq M_4 := C_{\\text{coeff}} \\left( 4 + \\frac{2}{\\kappa_{\\text{conf}}^2} \\right) \\frac{C_4}{\\kappa_4} + \\frac{2 C_{\\text{coeff}} C_{\\text{conf}}^2}{\\kappa_{\\text{conf}}^2}\n1076: $$\n1077: ",
      "metadata": {
        "label": "proof-prop-fourth-moment-baoab"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "755: :::\n756: \n757: :::{prf:proof}\n758: :label: proof-prop-fourth-moment-baoab\n759: \n760: The proof uses a discrete-time Lyapunov argument on the squared energy of the system. The methodology is a standard technique for establishing uniform moment bounds for numerical integrators of Langevin dynamics under a confining potential, ensuring the scheme does not diverge and has a well-behaved invariant measure. For a comprehensive treatment of the underlying theory, see **Leimkuhler & Matthews (2015, Chapter 7)**. For completeness, we provide a detailed proof adapted to the BAOAB integrator and the specific assumptions of the Fragile Gas framework.\n761: \n762: **Step 1: Energy functional**\n763: \n764: Define the discrete-time energy:\n765: \n766: $$\n767: E(Z) := \\frac{1}{2}|v|^2 + U(x)\n768: $$\n769: \n770: From the energy bounds for the continuous-time Langevin dynamics ({prf:ref}`thm-energy-bounds`), we have:\n771: \n772: $$\n773: \\mathbb{E}_{\\nu^{\\text{cont}}} [E(Z)] = \\mathbb{E}_{\\nu^{\\text{cont}}} \\left[\\frac{1}{2}|v|^2 + U(x)\\right] < \\infty\n774: $$\n775: \n776: **Step 2: BAOAB energy evolution**\n777: \n778: The BAOAB integrator consists of:\n779: - **B step** (position): $x_{k+1/5} = x_k + \\frac{\\Delta t}{2} v_k$\n780: - **A step** (friction): $v_{k+2/5} = e^{-\\gamma \\Delta t/2} v_{k+1/5}$\n781: - **O step** (Ornstein-Uhlenbeck): $v_{k+3/5} = v_{k+2/5} + \\sqrt{1 - e^{-\\gamma \\Delta t}} \\xi_k$ where $\\xi_k \\sim \\mathcal{N}(0, \\frac{\\sigma^2}{\\gamma} I)$\n782: - **A step** (friction): $v_{k+4/5} = e^{-\\gamma \\Delta t/2} v_{k+3/5}$\n783: - **B step** (position): $x_{k+1} = x_{k+1/5} + \\frac{\\Delta t}{2} v_{k+4/5}$\n784: \n785: For the O-step (where noise is added), the expected energy change is:\n786: \n787: $$\n788: \\mathbb{E}[|v_{k+3/5}|^2] = |v_{k+2/5}|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma}\n789: $$\n790: \n791: where $d$ is the dimension.\n792: \n793: **Step 3: Energy dissipation from drift**\n794: \n795: The A-steps provide exponential friction:\n796: \n797: $$\n798: |v_{k+2/5}|^2 = e^{-\\gamma \\Delta t} |v_{k+1/5}|^2 \\leq |v_{k+1/5}|^2\n799: $$\n800: \n801: The B-steps change position but not velocity magnitude. However, they couple velocity to the potential gradient.\n802: \n803: By the confinement condition:\n804: \n805: $$\n806: \\mathbb{E}[\\Delta U] \\approx \\mathbb{E}[\\langle \\nabla U(x_k), \\Delta x_k \\rangle] = \\frac{\\Delta t}{2} \\mathbb{E}[\\langle \\nabla U(x_k), v_k \\rangle]\n807: $$\n808: \n809: For large $|x|$, confinement gives $\\langle x, \\nabla U(x) \\rangle \\geq \\kappa_{\\text{conf}} |x|^2$, providing a restoring force.\n810: \n811: **Step 4: Lyapunov bound**\n812: \n813: Combining the heating (O-step) and dissipation (friction + confinement), the energy satisfies a Lyapunov inequality:\n814: \n815: $$\n816: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_E \\Delta t) E(Z_k) + C_E \\Delta t\n817: $$\n818: \n819: for some constants $\\kappa_E, C_E > 0$ (dependent on $\\gamma, \\sigma, \\kappa_{\\text{conf}}$) when $\\Delta t$ is sufficiently small.\n820: \n821: At stationarity ($k \\to \\infty$):\n822: \n823: $$\n824: \\mathbb{E}_{\\nu^{\\Delta t}} [E(Z)] \\leq \\frac{C_E}{\\kappa_E}\n825: $$\n826: \n827: **Step 5: From energy to fourth moment (Lyapunov on $E^2$)**\n828: \n829: To rigorously bound the fourth moment, we use a Lyapunov argument on $E^2(Z) = (\\frac{1}{2}|v|^2 + U(x))^2$.\n830: \n831: **Substep 5.1: Lyapunov inequality for $E^2$**\n832: \n833: We will show:\n834: \n835: $$\n836: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_4 \\Delta t) E^2(Z_k) + C_4 \\Delta t\n837: $$\n838: \n839: for some constants $\\kappa_4, C_4 > 0$ when $\\Delta t$ is sufficiently small.\n840: \n841: **Substep 5.2: Direct analysis of $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$**\n842: \n843: We will compute $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$ by tracking the evolution through all five BAOAB substeps. Define:\n844: \n845: $$\n846: V(Z) := E^2(Z) = \\left(\\frac{1}{2}|v|^2 + U(x)\\right)^2\n847: $$\n848: \n849: Let $Z_k = (x_k, v_k)$ and track the evolution:\n850: - After B: $(x', v_k)$ where $x' = x_k + \\frac{\\Delta t}{2} v_k$\n851: - After A: $(x', v')$ where $v' = e^{-\\gamma \\Delta t/2} v_k$\n852: - After O: $(x', v'')$ where $v'' = v' + \\xi$ and $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n853: - After A: $(x', v''')$ where $v''' = e^{-\\gamma \\Delta t/2} v''$\n854: - After B: $(x_{k+1}, v''')$ where $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n855: \n856: **Substep 5.3: Expansion of $E^2(Z_{k+1})$**\n857: \n858: The energy at step $k+1$ is:\n859: \n860: $$\n861: E(Z_{k+1}) = \\frac{1}{2}|v'''|^2 + U(x_{k+1})\n862: $$\n863: \n864: Expand $U(x_{k+1})$ using Taylor expansion around $x_k$:\n865: \n866: $$\n867: U(x_{k+1}) = U(x_k) + \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n868: $$\n869: \n870: where $\\xi$ is between $x_k$ and $x_{k+1}$.\n871: \n872: Since $|x_{k+1} - x_k| = O(\\Delta t |v_k|)$, we have:\n873: \n874: $$\n875: U(x_{k+1}) = U(x_k) + O(\\Delta t |v_k| |\\nabla U(x_k)|) + O((\\Delta t)^2 |v_k|^2 \\|\\nabla^2 U\\|)\n876: $$\n877: \n878: For $|v'''|^2$, after the A-O-A composition:\n879: \n880: $$\n881: |v'''|^2 = e^{-\\gamma \\Delta t} |v_k|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma} + O(\\Delta t |v_k| |\\xi|)\n882: $$\n883: \n884: where $\\mathbb{E}[|\\xi|^2] = (1-e^{-\\gamma \\Delta t})\\frac{d\\sigma^2}{\\gamma}$.\n885: \n886: **Substep 5.4: Control of $\\mathbb{E}[V(Z_{k+1}) | Z_k]$ for large $V(Z_k)$**\n887: \n888: For large energy $E(Z_k)$, the key observation is:\n889: \n890: 1. **Dissipation from friction**: The velocity magnitude decays by factor $e^{-\\gamma \\Delta t} \\approx 1 - \\gamma \\Delta t$\n891: 2. **Heating from noise**: The noise adds energy $\\sim d\\sigma^2/(2\\gamma)$\n892: 3. **Potential growth**: The potential can increase, but confinement controls this\n893: \n894: Combining these effects, for large $E(Z_k)$:\n895: \n896: $$\n897: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq E(Z_k) - \\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n898: $$\n899: \n900: where $\\kappa_E \\sim \\gamma$ (friction) and $C_E$ accounts for noise and confinement.\n901: \n902: For $V(Z_k) = E^2(Z_k)$, we need to control:\n903: \n904: $$\n905: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = \\mathbb{E}[(E(Z_k) + \\Delta E)^2 | Z_k]\n906: $$\n907: \n908: where $\\Delta E := E(Z_{k+1}) - E(Z_k)$.\n909: \n910: Expanding:\n911: \n912: $$\n913: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = E^2(Z_k) + 2 E(Z_k) \\mathbb{E}[\\Delta E | Z_k] + \\mathbb{E}[(\\Delta E)^2 | Z_k]\n914: $$\n915: \n916: **Substep 5.5: Bound the terms**\n917: \n918: From the first-moment analysis:\n919: \n920: $$\n921: \\mathbb{E}[\\Delta E | Z_k] \\leq -\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n922: $$\n923: \n924: For the second term, we need to bound the variance of the energy change. We will derive this carefully.\n925: \n926: **Proof of variance bound**: Recall $\\Delta E = E(Z_{k+1}) - E(Z_k)$ where the BAOAB evolution takes $Z_k = (x_k, v_k)$ to $Z_{k+1} = (x_{k+1}, v''')$ through:\n927: - B: $x' = x_k + \\frac{\\Delta t}{2} v_k$\n928: - A: $v' = e^{-\\gamma \\Delta t/2} v_k$\n929: - O: $v'' = v' + \\xi$ where $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n930: - A: $v''' = e^{-\\gamma \\Delta t/2} v''$\n931: - B: $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n932: \n933: The energy change is:\n934: \n935: $$\n936: \\Delta E = \\frac{1}{2}(|v'''|^2 - |v_k|^2) + (U(x_{k+1}) - U(x_k))\n937: $$\n938: \n939: **Velocity contribution**: After A-O-A composition:\n940: \n941: $$\n942: v''' = e^{-\\gamma \\Delta t/2}(e^{-\\gamma \\Delta t/2} v_k + \\xi) = e^{-\\gamma \\Delta t} v_k + e^{-\\gamma \\Delta t/2} \\xi\n943: $$\n944: \n945: Therefore:\n946: \n947: $$\n948: |v'''|^2 = e^{-2\\gamma \\Delta t} |v_k|^2 + 2 e^{-3\\gamma \\Delta t/2} \\langle v_k, \\xi \\rangle + e^{-\\gamma \\Delta t} |\\xi|^2\n949: $$\n950: \n951: The variance of the velocity contribution:\n952: \n953: $$\n954: \\text{Var}[\\frac{1}{2}(|v'''|^2 - |v_k|^2) | Z_k] \\leq C_v (\\Delta t)^2 |v_k|^4 + C'_v \\Delta t |v_k|^2 + C''_v \\Delta t\n955: $$\n956: \n957: where we used $\\mathbb{E}[|\\xi|^2] = O(\\Delta t)$, $\\mathbb{E}[|\\xi|^4] = O((\\Delta t)^2)$, and $\\mathbb{E}[\\langle v_k, \\xi \\rangle^2] = |v_k|^2 \\mathbb{E}[|\\xi|^2] = O(\\Delta t |v_k|^2)$.\n958: \n959: **Potential contribution**: Using Taylor expansion:\n960: \n961: $$\n962: U(x_{k+1}) - U(x_k) = \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n963: $$\n964: \n965: Since $|x_{k+1} - x_k| = O(\\Delta t (|v_k| + |v'''|)) = O(\\Delta t |v_k|) + O((\\Delta t)^{3/2})$, we have:\n966: \n967: $$\n968: \\text{Var}[U(x_{k+1}) - U(x_k) | Z_k] \\leq C_U (\\Delta t)^2 |v_k|^2 \\|\\nabla U\\|^2 + C'_U \\Delta t \\|\\nabla U\\|^2\n969: $$\n970: \n971: **Cross-term**: The expansion $(\\Delta E)^2 = (\\Delta E_v)^2 + (\\Delta E_U)^2 + 2 \\Delta E_v \\Delta E_U$ includes a cross-term. By Cauchy-Schwarz:\n972: \n973: $$\n974: 2|\\mathbb{E}[\\Delta E_v \\Delta E_U | Z_k]| \\leq 2\\sqrt{\\text{Var}[\\Delta E_v | Z_k] \\cdot \\text{Var}[\\Delta E_U | Z_k]} \\leq \\text{Var}[\\Delta E_v | Z_k] + \\text{Var}[\\Delta E_U | Z_k]\n975: $$\n976: \n977: This is absorbed into the bounds for the squared terms.\n978: \n979: **Combine**: Using $|v_k|^2 \\leq 2 E(Z_k)$ and combining all terms (velocity, potential, and cross-term):\n980: \n981: $$\n982: \\mathbb{E}[(\\Delta E)^2 | Z_k] \\leq C_{\\text{var}} \\Delta t (1 + E(Z_k))\n983: $$\n984: \n985: where $C_{\\text{var}} = 2\\max\\{C_v + C_U, C'_v + C'_U, C''_v\\}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|, \\|\\nabla^2 U\\|$.\n986: \n987: Combining:\n988: \n989: $$\n990: \\begin{align*}\n991: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) + 2 E(Z_k) (-\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t) + C_{\\text{var}} \\Delta t (1 + E(Z_k)) \\\\\n992: &= E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) + C_{\\text{var}} \\Delta t\n993: \\end{align*}\n994: $$\n995: \n996: **Handle the linear term using Young's inequality**: The term $(2 C_E + C_{\\text{var}}) \\Delta t E(Z_k)$ grows with $E(Z_k)$ and cannot be absorbed into a constant. We use Young's inequality: for any $\\epsilon > 0$,\n997: \n998: $$\n999: E(Z_k) \\leq \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon}\n1000: $$\n1001: \n1002: Therefore:\n1003: \n1004: $$\n1005: (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) \\leq (2 C_E + C_{\\text{var}}) \\Delta t \\left[ \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon} \\right]\n1006: $$\n1007: \n1008: **Choose $\\epsilon$ to absorb into dissipation**: Set\n1009: \n1010: $$\n1011: \\epsilon := \\frac{\\kappa_E}{2 C_E + C_{\\text{var}}}\n1012: $$\n1013: \n1014: Then:\n1015: \n1016: $$\n1017: (2 C_E + C_{\\text{var}}) \\Delta t \\epsilon E^2(Z_k) = \\kappa_E \\Delta t E^2(Z_k)\n1018: $$\n1019: \n1020: Substituting back:\n1021: \n1022: $$\n1023: \\begin{align*}\n1024: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + \\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t \\cdot \\frac{1}{4\\epsilon} + C_{\\text{var}} \\Delta t \\\\\n1025: &= E^2(Z_k) - \\kappa_E \\Delta t E^2(Z_k) + \\left[ \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}} \\right] \\Delta t \\\\\n1026: &= (1 - \\kappa_E \\Delta t) E^2(Z_k) + C'_4 \\Delta t\n1027: \\end{align*}\n1028: $$\n1029: \n1030: where:\n1031: \n1032: $$\n1033: C'_4 := \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\n1034: $$\n1035: \n1036: This gives the Lyapunov inequality with $\\kappa_4 := \\kappa_E$ and $C_4 := C'_4$.\n1037: \n1038: **Substep 5.6: Stationary second moment**\n1039: \n1040: At stationarity:\n1041: \n1042: $$\n1043: \\mathbb{E}_{\\nu^{\\Delta t}} [E^2(Z)] \\leq \\frac{C_4}{\\kappa_4} = \\frac{C'_4}{\\kappa_E} = \\frac{1}{\\kappa_E}\\left[\\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\\right]\n1044: $$\n1045: \n1046: **Substep 5.7: From $E^2$ to fourth moment**\n1047: \n1048: Since $E(Z) = \\frac{1}{2}|v|^2 + U(x)$, we have:\n1049: \n1050: $$\n1051: |Z|^4 = (|x|^2 + |v|^2)^2 \\leq C_{\\text{coeff}} (|v|^4 + |x|^4)\n1052: $$\n1053: \n1054: By confinement, $U(x) \\geq \\kappa_{\\text{conf}} |x|^2 - C_{\\text{conf}}$, so:\n1055: \n1056: $$\n1057: |x|^2 \\leq \\frac{1}{\\kappa_{\\text{conf}}} (U(x) + C_{\\text{conf}}) \\leq \\frac{1}{\\kappa_{\\text{conf}}} (E(Z) + C_{\\text{conf}})\n1058: $$\n1059: \n1060: Therefore:\n1061: \n1062: $$\n1063: |x|^4 \\leq \\frac{1}{\\kappa_{\\text{conf}}^2} (E(Z) + C_{\\text{conf}})^2 \\leq \\frac{2}{\\kappa_{\\text{conf}}^2} (E^2(Z) + C_{\\text{conf}}^2)\n1064: $$\n1065: \n1066: Similarly, $|v|^4 \\leq 4 E^2(Z)$ since $|v|^2 \\leq 2 E(Z)$.\n1067: \n1068: Combining:\n1069: \n1070: $$\n1071: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq C_{\\text{coeff}} \\left( 4 \\mathbb{E}[E^2(Z)] + \\frac{2}{\\kappa_{\\text{conf}}^2} (\\mathbb{E}[E^2(Z)] + C_{\\text{conf}}^2) \\right)\n1072: $$\n1073: \n1074: $$\n1075: \\leq M_4 := C_{\\text{coeff}} \\left( 4 + \\frac{2}{\\kappa_{\\text{conf}}^2} \\right) \\frac{C_4}{\\kappa_4} + \\frac{2 C_{\\text{coeff}} C_{\\text{conf}}^2}{\\kappa_{\\text{conf}}^2}\n1076: $$\n1077: \n1078: This is finite and depends only on $\\gamma, \\sigma, \\kappa_{\\text{conf}}, d$, independent of $\\Delta t$ for $\\Delta t < \\Delta t_0$ (sufficiently small)."
    },
    {
      "directive_type": "lemma",
      "label": "lem-baoab-weak-error",
      "title": "BAOAB Second-Order Weak Convergence",
      "start_line": 1089,
      "end_line": 1114,
      "header_lines": [
        1090
      ],
      "content_start": 1092,
      "content_end": 1113,
      "content": "1092: :label: lem-baoab-weak-error\n1093: \n1094: Let $Z(t)$ be the solution of the continuous-time Langevin SDE:\n1095: \n1096: $$\n1097: \\begin{cases}\n1098: dX_t = V_t dt \\\\\n1099: dV_t = -\\nabla U(X_t) dt - \\gamma V_t dt + \\sigma dW_t\n1100: \\end{cases}\n1101: $$\n1102: \n1103: and let $Z_k$ be the BAOAB approximation with step size $\\Delta t$ starting from $Z_0 = Z(0)$. For any test function $\\phi \\in C^4(\\Omega)$ with bounded derivatives up to order 4, we have:\n1104: \n1105: $$\n1106: |\\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]| \\leq C_{\\text{weak}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2 \\cdot k\\Delta t\n1107: $$\n1108: \n1109: where $C_{\\text{weak}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4$ but not on $\\Delta t$ or $k$.\n1110: \n1111: In particular, for fixed time $T = k\\Delta t$:\n1112: \n1113: $$",
      "metadata": {
        "label": "lem-baoab-weak-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1089: Now we establish the second-order weak convergence of BAOAB for finite time.\n1090: \n1091: :::{prf:lemma} BAOAB Second-Order Weak Convergence\n1092: :label: lem-baoab-weak-error\n1093: \n1094: Let $Z(t)$ be the solution of the continuous-time Langevin SDE:\n1095: \n1096: $$\n1097: \\begin{cases}\n1098: dX_t = V_t dt \\\\\n1099: dV_t = -\\nabla U(X_t) dt - \\gamma V_t dt + \\sigma dW_t\n1100: \\end{cases}\n1101: $$\n1102: \n1103: and let $Z_k$ be the BAOAB approximation with step size $\\Delta t$ starting from $Z_0 = Z(0)$. For any test function $\\phi \\in C^4(\\Omega)$ with bounded derivatives up to order 4, we have:\n1104: \n1105: $$\n1106: |\\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]| \\leq C_{\\text{weak}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2 \\cdot k\\Delta t\n1107: $$\n1108: \n1109: where $C_{\\text{weak}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4$ but not on $\\Delta t$ or $k$.\n1110: \n1111: In particular, for fixed time $T = k\\Delta t$:\n1112: \n1113: $$\n1114: |\\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(T))]| = O((\\Delta t)^2)"
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-baoab-weak-error",
      "title": null,
      "start_line": 1116,
      "end_line": 1195,
      "header_lines": [
        1117
      ],
      "content_start": 1119,
      "content_end": 1194,
      "content": "1119: :label: proof-lem-baoab-weak-error\n1120: \n1121: The proof uses backward error analysis and Taylor expansion of the BAOAB integrator.\n1122: \n1123: **Step 1: Local truncation error**\n1124: \n1125: The BAOAB integrator is a splitting scheme that can be written as:\n1126: \n1127: $$\n1128: Z_{k+1} = \\Phi_{\\text{BAOAB}}^{\\Delta t}(Z_k) = \\Phi_B^{\\Delta t/2} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_O^{\\Delta t} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_B^{\\Delta t/2}(Z_k)\n1129: $$\n1130: \n1131: where each $\\Phi$ corresponds to one of the sub-steps.\n1132: \n1133: By Strang splitting theory (second-order symmetric splitting), the local truncation error is $O((\\Delta t)^3)$ for a single step.\n1134: \n1135: **Step 2: Weak generator expansion**\n1136: \n1137: For a test function $\\phi \\in C^4(\\Omega)$, the weak error evolution satisfies:\n1138: \n1139: $$\n1140: \\frac{d}{dt} \\mathbb{E}[\\phi(Z_k)] = \\mathbb{E}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\phi(Z_k)]\n1141: $$\n1142: \n1143: where $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$ is the discrete-time generator.\n1144: \n1145: The continuous-time generator is:\n1146: \n1147: $$\n1148: \\mathcal{L} \\phi = v \\cdot \\nabla_x \\phi - \\nabla U(x) \\cdot \\nabla_v \\phi - \\gamma v \\cdot \\nabla_v \\phi + \\frac{\\sigma^2}{2} \\Delta_v \\phi\n1149: $$\n1150: \n1151: By backward error analysis (Bou-Rabee & Sanz-Serna 2017, Theorem 3.1), the BAOAB generator can be expanded as:\n1152: \n1153: $$\n1154: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1155: $$\n1156: \n1157: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients (depending on derivatives of $U$ up to order 3).\n1158: \n1159: **Note**: The remainder is $O((\\Delta t)^4)$, not $O((\\Delta t)^3)$, because BAOAB is a **time-symmetric** integrator. For symmetric schemes, the expansion contains only even powers of $\\Delta t$.\n1160: \n1161: **Step 3: Gronwall argument**\n1162: \n1163: Let $\\varepsilon_k := \\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]$ be the weak error at time $t_k = k\\Delta t$.\n1164: \n1165: From the generator expansion:\n1166: \n1167: $$\n1168: \\varepsilon_{k+1} = \\varepsilon_k + \\Delta t \\cdot \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] + O((\\Delta t)^2)\n1169: $$\n1170: \n1171: The generator difference contributes:\n1172: \n1173: $$\n1174: \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] = (\\Delta t)^2 \\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)] + O((\\Delta t)^4)\n1175: $$\n1176: \n1177: Using the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`):\n1178: \n1179: $$\n1180: |\\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)]| \\leq C_2 \\|\\phi\\|_{C^4} \\mathbb{E}[|Z_k|^4]^{1/2} \\leq C_2 \\|\\phi\\|_{C^4} M_4^{1/2}\n1181: $$\n1182: \n1183: Therefore:\n1184: \n1185: $$\n1186: |\\varepsilon_{k+1}| \\leq |\\varepsilon_k| + C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 + O((\\Delta t)^4)\n1187: $$\n1188: \n1189: With $\\varepsilon_0 = 0$, summing from $k=0$ to $k=K-1$ where $K\\Delta t = T$:\n1190: \n1191: $$\n1192: |\\varepsilon_K| \\leq K \\cdot C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 = C_{\\text{weak}} \\|\\phi\\|_{C^4} (\\Delta t)^2 \\cdot T\n1193: $$\n1194: ",
      "metadata": {
        "label": "proof-lem-baoab-weak-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1116: :::\n1117: \n1118: :::{prf:proof}\n1119: :label: proof-lem-baoab-weak-error\n1120: \n1121: The proof uses backward error analysis and Taylor expansion of the BAOAB integrator.\n1122: \n1123: **Step 1: Local truncation error**\n1124: \n1125: The BAOAB integrator is a splitting scheme that can be written as:\n1126: \n1127: $$\n1128: Z_{k+1} = \\Phi_{\\text{BAOAB}}^{\\Delta t}(Z_k) = \\Phi_B^{\\Delta t/2} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_O^{\\Delta t} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_B^{\\Delta t/2}(Z_k)\n1129: $$\n1130: \n1131: where each $\\Phi$ corresponds to one of the sub-steps.\n1132: \n1133: By Strang splitting theory (second-order symmetric splitting), the local truncation error is $O((\\Delta t)^3)$ for a single step.\n1134: \n1135: **Step 2: Weak generator expansion**\n1136: \n1137: For a test function $\\phi \\in C^4(\\Omega)$, the weak error evolution satisfies:\n1138: \n1139: $$\n1140: \\frac{d}{dt} \\mathbb{E}[\\phi(Z_k)] = \\mathbb{E}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\phi(Z_k)]\n1141: $$\n1142: \n1143: where $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$ is the discrete-time generator.\n1144: \n1145: The continuous-time generator is:\n1146: \n1147: $$\n1148: \\mathcal{L} \\phi = v \\cdot \\nabla_x \\phi - \\nabla U(x) \\cdot \\nabla_v \\phi - \\gamma v \\cdot \\nabla_v \\phi + \\frac{\\sigma^2}{2} \\Delta_v \\phi\n1149: $$\n1150: \n1151: By backward error analysis (Bou-Rabee & Sanz-Serna 2017, Theorem 3.1), the BAOAB generator can be expanded as:\n1152: \n1153: $$\n1154: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1155: $$\n1156: \n1157: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients (depending on derivatives of $U$ up to order 3).\n1158: \n1159: **Note**: The remainder is $O((\\Delta t)^4)$, not $O((\\Delta t)^3)$, because BAOAB is a **time-symmetric** integrator. For symmetric schemes, the expansion contains only even powers of $\\Delta t$.\n1160: \n1161: **Step 3: Gronwall argument**\n1162: \n1163: Let $\\varepsilon_k := \\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]$ be the weak error at time $t_k = k\\Delta t$.\n1164: \n1165: From the generator expansion:\n1166: \n1167: $$\n1168: \\varepsilon_{k+1} = \\varepsilon_k + \\Delta t \\cdot \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] + O((\\Delta t)^2)\n1169: $$\n1170: \n1171: The generator difference contributes:\n1172: \n1173: $$\n1174: \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] = (\\Delta t)^2 \\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)] + O((\\Delta t)^4)\n1175: $$\n1176: \n1177: Using the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`):\n1178: \n1179: $$\n1180: |\\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)]| \\leq C_2 \\|\\phi\\|_{C^4} \\mathbb{E}[|Z_k|^4]^{1/2} \\leq C_2 \\|\\phi\\|_{C^4} M_4^{1/2}\n1181: $$\n1182: \n1183: Therefore:\n1184: \n1185: $$\n1186: |\\varepsilon_{k+1}| \\leq |\\varepsilon_k| + C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 + O((\\Delta t)^4)\n1187: $$\n1188: \n1189: With $\\varepsilon_0 = 0$, summing from $k=0$ to $k=K-1$ where $K\\Delta t = T$:\n1190: \n1191: $$\n1192: |\\varepsilon_K| \\leq K \\cdot C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 = C_{\\text{weak}} \\|\\phi\\|_{C^4} (\\Delta t)^2 \\cdot T\n1193: $$\n1194: \n1195: where $C_{\\text{weak}} = C_2 M_4^{1/2}$."
    },
    {
      "directive_type": "lemma",
      "label": "lem-baoab-invariant-measure-error",
      "title": "BAOAB Invariant Measure Error",
      "start_line": 1206,
      "end_line": 1218,
      "header_lines": [
        1207
      ],
      "content_start": 1209,
      "content_end": 1217,
      "content": "1209: :label: lem-baoab-invariant-measure-error\n1210: \n1211: Let $\\nu^{\\text{cont}}$ be the invariant measure of the continuous-time Langevin dynamics and let $\\nu^{\\Delta t}$ be the invariant measure of the BAOAB chain with step size $\\Delta t$. For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1212: \n1213: $$\n1214: \\left| \\mathbb{E}_{\\nu^{\\Delta t}} [\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}} [\\phi] \\right| \\leq C_{\\text{inv}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2\n1215: $$\n1216: \n1217: where $C_{\\text{inv}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4, \\kappa_{\\text{mix}}$ but not on $\\Delta t$.",
      "metadata": {
        "label": "lem-baoab-invariant-measure-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1206: Now we convert the finite-time weak error to an invariant measure error.\n1207: \n1208: :::{prf:lemma} BAOAB Invariant Measure Error\n1209: :label: lem-baoab-invariant-measure-error\n1210: \n1211: Let $\\nu^{\\text{cont}}$ be the invariant measure of the continuous-time Langevin dynamics and let $\\nu^{\\Delta t}$ be the invariant measure of the BAOAB chain with step size $\\Delta t$. For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1212: \n1213: $$\n1214: \\left| \\mathbb{E}_{\\nu^{\\Delta t}} [\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}} [\\phi] \\right| \\leq C_{\\text{inv}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2\n1215: $$\n1216: \n1217: where $C_{\\text{inv}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4, \\kappa_{\\text{mix}}$ but not on $\\Delta t$.\n1218: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-baoab-invariant-measure-error",
      "title": null,
      "start_line": 1220,
      "end_line": 1382,
      "header_lines": [
        1221
      ],
      "content_start": 1223,
      "content_end": 1381,
      "content": "1223: :label: proof-lem-baoab-invariant-measure-error\n1224: \n1225: The proof uses the Poisson equation method and exploits the symmetry of the BAOAB integrator.\n1226: \n1227: **Step 1: The Poisson equation**\n1228: \n1229: For an observable $\\phi \\in C^4$, consider the centered observable:\n1230: \n1231: $$\n1232: \\tilde{\\phi}(z) := \\phi(z) - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]\n1233: $$\n1234: \n1235: The Poisson equation for the continuous-time generator $\\mathcal{L}$ is:\n1236: \n1237: $$\n1238: \\mathcal{L} \\psi = \\tilde{\\phi}\n1239: $$\n1240: \n1241: This equation has a unique solution $\\psi \\in C^{\\infty}(\\Omega)$ under the geometric ergodicity assumption, and moreover $\\mathbb{E}_{\\nu^{\\text{cont}}}[\\psi] = 0$.\n1242: \n1243: **Step 2: Regularity of the Poisson solution**\n1244: \n1245: The key regularity result (from elliptic PDE theory applied to the hypoelliptic operator $\\mathcal{L}$) is:\n1246: \n1247: $$\n1248: \\|\\psi\\|_{C^{k+2}} \\leq \\frac{C_{\\text{reg}}}{\\kappa_{\\text{mix}}^{k+1}} \\|\\tilde{\\phi}\\|_{C^k}\n1249: $$\n1250: \n1251: For $\\phi \\in C^4$, we have:\n1252: \n1253: $$\n1254: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1255: $$\n1256: \n1257: **Step 3: Error decomposition via Poisson equation**\n1258: \n1259: The error between invariant measures can be written using $\\psi$:\n1260: \n1261: $$\n1262: \\begin{align*}\n1263: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\tilde{\\phi}] \\\\\n1264: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\quad \\text{(by Poisson equation)}\n1265: \\end{align*}\n1266: $$\n1267: \n1268: **Step 4: Key identity using invariant measure property**\n1269: \n1270: Since $\\nu^{\\Delta t}$ is the invariant measure of the discrete-time generator $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$, we have:\n1271: \n1272: $$\n1273: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] = 0\n1274: $$\n1275: \n1276: This is because for any function $g$:\n1277: \n1278: $$\n1279: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} g] = \\mathbb{E}_{\\nu^{\\Delta t}}[g(Z_1) - g(Z_0)] = 0\n1280: $$\n1281: \n1282: when $Z_0 \\sim \\nu^{\\Delta t}$ (stationarity).\n1283: \n1284: **Step 5: Apply generator difference**\n1285: \n1286: Combining Steps 3 and 4:\n1287: \n1288: $$\n1289: \\begin{align*}\n1290: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\\\\n1291: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] - \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] \\\\\n1292: &= \\mathbb{E}_{\\nu^{\\Delta t}}[(\\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}) \\psi]\n1293: \\end{align*}\n1294: $$\n1295: \n1296: **Step 6: Use backward error expansion**\n1297: \n1298: From {prf:ref}`lem-baoab-weak-error`, the generator difference satisfies:\n1299: \n1300: $$\n1301: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1302: $$\n1303: \n1304: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients.\n1305: \n1306: Therefore:\n1307: \n1308: $$\n1309: \\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = -(\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1310: $$\n1311: \n1312: **Step 7: Apply generator expansion**\n1313: \n1314: For symmetric splitting schemes like BAOAB, the generator expansion has only even powers:\n1315: \n1316: $$\n1317: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1318: $$\n1319: \n1320: Substituting into Step 5:\n1321: \n1322: $$\n1323: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] = -(\\Delta t)^2 \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi] + O((\\Delta t)^4)\n1324: $$\n1325: \n1326: **Step 8: Bound the expectation uniformly**\n1327: \n1328: The key is to show that $|\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]|$ is bounded uniformly for $\\Delta t$ sufficiently small.\n1329: \n1330: The operator $\\mathcal{L}_2$ is a fourth-order differential operator whose coefficients involve derivatives of the potential $U$ up to order 3. For a solution $\\psi$ of the Poisson equation $\\mathcal{L} \\psi = \\tilde{\\phi}$ with $\\phi \\in C^4$, the regularity result from Step 2 gives:\n1331: \n1332: $$\n1333: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1334: $$\n1335: \n1336: Under the confinement axiom, $|\\mathcal{L}_2 \\psi(Z)|$ grows at most polynomially in $|Z|$:\n1337: \n1338: $$\n1339: |\\mathcal{L}_2 \\psi(Z)| \\leq C_2 \\|\\psi\\|_{C^6} (1 + |Z|^2)\n1340: $$\n1341: \n1342: for some constant $C_2$ depending on $\\|\\nabla^2 U\\|, \\|\\nabla^3 U\\|$.\n1343: \n1344: **Step 9: Use uniform moment bounds**\n1345: \n1346: From the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`), we have:\n1347: \n1348: $$\n1349: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq M_4 < \\infty\n1350: $$\n1351: \n1352: uniformly in $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1353: \n1354: Therefore:\n1355: \n1356: $$\n1357: \\begin{align*}\n1358: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]| &\\leq \\mathbb{E}_{\\nu^{\\Delta t}}[|\\mathcal{L}_2 \\psi(Z)|] \\\\\n1359: &\\leq C_2 \\|\\psi\\|_{C^6} \\mathbb{E}_{\\nu^{\\Delta t}}[1 + |Z|^2] \\\\\n1360: &\\leq C_2 \\|\\psi\\|_{C^6} (1 + M_4^{1/2}) \\\\\n1361: &\\leq C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2})\n1362: \\end{align*}\n1363: $$\n1364: \n1365: **Step 10: Conclude**\n1366: \n1367: Combining Steps 7 and 9:\n1368: \n1369: $$\n1370: \\begin{align*}\n1371: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]| &\\leq (\\Delta t)^2 \\cdot C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2}) + O((\\Delta t)^4) \\\\\n1372: &= C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2 + O((\\Delta t)^4)\n1373: \\end{align*}\n1374: $$\n1375: \n1376: where:\n1377: \n1378: $$\n1379: C_{\\text{inv}} := \\frac{C_2 \\cdot C_{\\text{reg}} (1 + M_4^{1/2})}{\\kappa_{\\text{mix}}^5}\n1380: $$\n1381: ",
      "metadata": {
        "label": "proof-lem-baoab-invariant-measure-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1220: :::\n1221: \n1222: :::{prf:proof}\n1223: :label: proof-lem-baoab-invariant-measure-error\n1224: \n1225: The proof uses the Poisson equation method and exploits the symmetry of the BAOAB integrator.\n1226: \n1227: **Step 1: The Poisson equation**\n1228: \n1229: For an observable $\\phi \\in C^4$, consider the centered observable:\n1230: \n1231: $$\n1232: \\tilde{\\phi}(z) := \\phi(z) - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]\n1233: $$\n1234: \n1235: The Poisson equation for the continuous-time generator $\\mathcal{L}$ is:\n1236: \n1237: $$\n1238: \\mathcal{L} \\psi = \\tilde{\\phi}\n1239: $$\n1240: \n1241: This equation has a unique solution $\\psi \\in C^{\\infty}(\\Omega)$ under the geometric ergodicity assumption, and moreover $\\mathbb{E}_{\\nu^{\\text{cont}}}[\\psi] = 0$.\n1242: \n1243: **Step 2: Regularity of the Poisson solution**\n1244: \n1245: The key regularity result (from elliptic PDE theory applied to the hypoelliptic operator $\\mathcal{L}$) is:\n1246: \n1247: $$\n1248: \\|\\psi\\|_{C^{k+2}} \\leq \\frac{C_{\\text{reg}}}{\\kappa_{\\text{mix}}^{k+1}} \\|\\tilde{\\phi}\\|_{C^k}\n1249: $$\n1250: \n1251: For $\\phi \\in C^4$, we have:\n1252: \n1253: $$\n1254: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1255: $$\n1256: \n1257: **Step 3: Error decomposition via Poisson equation**\n1258: \n1259: The error between invariant measures can be written using $\\psi$:\n1260: \n1261: $$\n1262: \\begin{align*}\n1263: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\tilde{\\phi}] \\\\\n1264: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\quad \\text{(by Poisson equation)}\n1265: \\end{align*}\n1266: $$\n1267: \n1268: **Step 4: Key identity using invariant measure property**\n1269: \n1270: Since $\\nu^{\\Delta t}$ is the invariant measure of the discrete-time generator $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$, we have:\n1271: \n1272: $$\n1273: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] = 0\n1274: $$\n1275: \n1276: This is because for any function $g$:\n1277: \n1278: $$\n1279: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} g] = \\mathbb{E}_{\\nu^{\\Delta t}}[g(Z_1) - g(Z_0)] = 0\n1280: $$\n1281: \n1282: when $Z_0 \\sim \\nu^{\\Delta t}$ (stationarity).\n1283: \n1284: **Step 5: Apply generator difference**\n1285: \n1286: Combining Steps 3 and 4:\n1287: \n1288: $$\n1289: \\begin{align*}\n1290: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\\\\n1291: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] - \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] \\\\\n1292: &= \\mathbb{E}_{\\nu^{\\Delta t}}[(\\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}) \\psi]\n1293: \\end{align*}\n1294: $$\n1295: \n1296: **Step 6: Use backward error expansion**\n1297: \n1298: From {prf:ref}`lem-baoab-weak-error`, the generator difference satisfies:\n1299: \n1300: $$\n1301: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1302: $$\n1303: \n1304: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients.\n1305: \n1306: Therefore:\n1307: \n1308: $$\n1309: \\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = -(\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1310: $$\n1311: \n1312: **Step 7: Apply generator expansion**\n1313: \n1314: For symmetric splitting schemes like BAOAB, the generator expansion has only even powers:\n1315: \n1316: $$\n1317: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1318: $$\n1319: \n1320: Substituting into Step 5:\n1321: \n1322: $$\n1323: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] = -(\\Delta t)^2 \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi] + O((\\Delta t)^4)\n1324: $$\n1325: \n1326: **Step 8: Bound the expectation uniformly**\n1327: \n1328: The key is to show that $|\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]|$ is bounded uniformly for $\\Delta t$ sufficiently small.\n1329: \n1330: The operator $\\mathcal{L}_2$ is a fourth-order differential operator whose coefficients involve derivatives of the potential $U$ up to order 3. For a solution $\\psi$ of the Poisson equation $\\mathcal{L} \\psi = \\tilde{\\phi}$ with $\\phi \\in C^4$, the regularity result from Step 2 gives:\n1331: \n1332: $$\n1333: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1334: $$\n1335: \n1336: Under the confinement axiom, $|\\mathcal{L}_2 \\psi(Z)|$ grows at most polynomially in $|Z|$:\n1337: \n1338: $$\n1339: |\\mathcal{L}_2 \\psi(Z)| \\leq C_2 \\|\\psi\\|_{C^6} (1 + |Z|^2)\n1340: $$\n1341: \n1342: for some constant $C_2$ depending on $\\|\\nabla^2 U\\|, \\|\\nabla^3 U\\|$.\n1343: \n1344: **Step 9: Use uniform moment bounds**\n1345: \n1346: From the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`), we have:\n1347: \n1348: $$\n1349: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq M_4 < \\infty\n1350: $$\n1351: \n1352: uniformly in $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1353: \n1354: Therefore:\n1355: \n1356: $$\n1357: \\begin{align*}\n1358: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]| &\\leq \\mathbb{E}_{\\nu^{\\Delta t}}[|\\mathcal{L}_2 \\psi(Z)|] \\\\\n1359: &\\leq C_2 \\|\\psi\\|_{C^6} \\mathbb{E}_{\\nu^{\\Delta t}}[1 + |Z|^2] \\\\\n1360: &\\leq C_2 \\|\\psi\\|_{C^6} (1 + M_4^{1/2}) \\\\\n1361: &\\leq C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2})\n1362: \\end{align*}\n1363: $$\n1364: \n1365: **Step 10: Conclude**\n1366: \n1367: Combining Steps 7 and 9:\n1368: \n1369: $$\n1370: \\begin{align*}\n1371: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]| &\\leq (\\Delta t)^2 \\cdot C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2}) + O((\\Delta t)^4) \\\\\n1372: &= C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2 + O((\\Delta t)^4)\n1373: \\end{align*}\n1374: $$\n1375: \n1376: where:\n1377: \n1378: $$\n1379: C_{\\text{inv}} := \\frac{C_2 \\cdot C_{\\text{reg}} (1 + M_4^{1/2})}{\\kappa_{\\text{mix}}^5}\n1380: $$\n1381: \n1382: **The key insight**: The uniform fourth-moment bounds ensure that the expectation $\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]$ is bounded uniformly in $\\Delta t$. Combined with the generator expansion having only even powers (due to BAOAB's symmetry), this gives the $O((\\Delta t)^2)$ convergence rate."
    },
    {
      "directive_type": "theorem",
      "label": "thm-langevin-baoab-discretization-error",
      "title": "Langevin-BAOAB Time Discretization Error",
      "start_line": 1401,
      "end_line": 1415,
      "header_lines": [
        1402
      ],
      "content_start": 1404,
      "content_end": 1414,
      "content": "1404: :label: thm-langevin-baoab-discretization-error\n1405: \n1406: Let $\\nu_N^{\\text{Langevin}}$ be the invariant measure of the continuous-time N-particle Langevin dynamics (without cloning) and let $\\nu_N^{\\text{BAOAB}}$ be the invariant measure of the discrete-time BAOAB chain with step size $\\Delta t$ for the same Langevin SDE. For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1407: \n1408: $$\n1409: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi] \\right| \\leq C_{\\text{BAOAB}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2\n1410: $$\n1411: \n1412: where $C_{\\text{BAOAB}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4, \\kappa_{\\text{mix}}$ but is independent of $N$ (N-uniform) and independent of $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1413: \n1414: **Important**: This theorem analyzes the **Langevin dynamics alone**, without the cloning mechanism. The complete Fragile Gas algorithm combines BAOAB integration with cloning. The full system error analysis (which will show an $O(\\Delta t)$ rate dominated by the cloning error) is deferred to Part III and Part IV.",
      "metadata": {
        "label": "thm-langevin-baoab-discretization-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1401: We now state the main result for Part II.\n1402: \n1403: :::{prf:theorem} Langevin-BAOAB Time Discretization Error\n1404: :label: thm-langevin-baoab-discretization-error\n1405: \n1406: Let $\\nu_N^{\\text{Langevin}}$ be the invariant measure of the continuous-time N-particle Langevin dynamics (without cloning) and let $\\nu_N^{\\text{BAOAB}}$ be the invariant measure of the discrete-time BAOAB chain with step size $\\Delta t$ for the same Langevin SDE. For any observable $\\phi \\in C^4$ with $\\|\\phi\\|_{C^4} < \\infty$:\n1407: \n1408: $$\n1409: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi] \\right| \\leq C_{\\text{BAOAB}} \\cdot \\|\\phi\\|_{C^4} \\cdot (\\Delta t)^2\n1410: $$\n1411: \n1412: where $C_{\\text{BAOAB}}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|_{\\text{Lip}}, M_4, \\kappa_{\\text{mix}}$ but is independent of $N$ (N-uniform) and independent of $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1413: \n1414: **Important**: This theorem analyzes the **Langevin dynamics alone**, without the cloning mechanism. The complete Fragile Gas algorithm combines BAOAB integration with cloning. The full system error analysis (which will show an $O(\\Delta t)$ rate dominated by the cloning error) is deferred to Part III and Part IV.\n1415: "
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-langevin-baoab-discretization-error",
      "title": null,
      "start_line": 1417,
      "end_line": 1470,
      "header_lines": [
        1418
      ],
      "content_start": 1420,
      "content_end": 1469,
      "content": "1420: :label: proof-thm-langevin-baoab-discretization-error\n1421: \n1422: This follows directly from {prf:ref}`lem-baoab-invariant-measure-error` applied to each particle in the N-particle Langevin system.\n1423: \n1424: **Step 1: Single-particle Langevin dynamics**\n1425: \n1426: Each particle $i$ evolves independently via the Langevin SDE:\n1427: \n1428: $$\n1429: \\begin{cases}\n1430: dX_t^{(i)} = V_t^{(i)} dt \\\\\n1431: dV_t^{(i)} = -\\nabla U(X_t^{(i)}) dt - \\gamma V_t^{(i)} dt + \\sigma dW_t^{(i)}\n1432: \\end{cases}\n1433: $$\n1434: \n1435: where $W_t^{(i)}$ are independent Brownian motions.\n1436: \n1437: **Step 2: N-uniformity for non-interacting Langevin dynamics**\n1438: \n1439: The key observation is that **the BAOAB time discretization acts independently on each particle**.\n1440: \n1441: More precisely:\n1442: - **External potential**: The potential $U(x_i)$ is an external (fixed) potential that depends only on the position of particle $i$, not on other particles' positions.\n1443: \n1444: **Crucial clarification**: This N-uniformity analysis applies to the **Euclidean Gas** case where the potential is external. For mean-field interacting potentials (e.g., Adaptive Gas with empirical-measure-dependent potentials), a separate treatment would be required.\n1445: \n1446: - **Independent evolution**: Each particle evolves via its own independent Langevin SDE. The BAOAB discretization of this evolution has constants ($C_{\\text{weak}}, M_4, \\kappa_{\\text{mix}}$) that depend **only** on $U, \\gamma, \\sigma, d$, not on $N$ or on the positions of other particles.\n1447: \n1448: From {prf:ref}`lem-baoab-invariant-measure-error`, we have:\n1449: \n1450: $$\n1451: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)] \\right| \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1452: $$\n1453: \n1454: for each particle $i$, where $C_{\\text{inv}}$ is independent of $N$.\n1455: \n1456: **Step 3: Observable on the N-particle system**\n1457: \n1458: For an observable $\\Phi(Z) = \\frac{1}{N}\\sum_{i=1}^N \\phi(z_i)$:\n1459: \n1460: $$\n1461: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\Phi] \\right| = \\left| \\frac{1}{N} \\sum_{i=1}^N (\\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)]) \\right|\n1462: $$\n1463: \n1464: By exchangeability:\n1465: \n1466: $$\n1467: \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1468: $$\n1469: ",
      "metadata": {
        "label": "proof-thm-langevin-baoab-discretization-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "raw_directive": "1417: :::\n1418: \n1419: :::{prf:proof}\n1420: :label: proof-thm-langevin-baoab-discretization-error\n1421: \n1422: This follows directly from {prf:ref}`lem-baoab-invariant-measure-error` applied to each particle in the N-particle Langevin system.\n1423: \n1424: **Step 1: Single-particle Langevin dynamics**\n1425: \n1426: Each particle $i$ evolves independently via the Langevin SDE:\n1427: \n1428: $$\n1429: \\begin{cases}\n1430: dX_t^{(i)} = V_t^{(i)} dt \\\\\n1431: dV_t^{(i)} = -\\nabla U(X_t^{(i)}) dt - \\gamma V_t^{(i)} dt + \\sigma dW_t^{(i)}\n1432: \\end{cases}\n1433: $$\n1434: \n1435: where $W_t^{(i)}$ are independent Brownian motions.\n1436: \n1437: **Step 2: N-uniformity for non-interacting Langevin dynamics**\n1438: \n1439: The key observation is that **the BAOAB time discretization acts independently on each particle**.\n1440: \n1441: More precisely:\n1442: - **External potential**: The potential $U(x_i)$ is an external (fixed) potential that depends only on the position of particle $i$, not on other particles' positions.\n1443: \n1444: **Crucial clarification**: This N-uniformity analysis applies to the **Euclidean Gas** case where the potential is external. For mean-field interacting potentials (e.g., Adaptive Gas with empirical-measure-dependent potentials), a separate treatment would be required.\n1445: \n1446: - **Independent evolution**: Each particle evolves via its own independent Langevin SDE. The BAOAB discretization of this evolution has constants ($C_{\\text{weak}}, M_4, \\kappa_{\\text{mix}}$) that depend **only** on $U, \\gamma, \\sigma, d$, not on $N$ or on the positions of other particles.\n1447: \n1448: From {prf:ref}`lem-baoab-invariant-measure-error`, we have:\n1449: \n1450: $$\n1451: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)] \\right| \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1452: $$\n1453: \n1454: for each particle $i$, where $C_{\\text{inv}}$ is independent of $N$.\n1455: \n1456: **Step 3: Observable on the N-particle system**\n1457: \n1458: For an observable $\\Phi(Z) = \\frac{1}{N}\\sum_{i=1}^N \\phi(z_i)$:\n1459: \n1460: $$\n1461: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\Phi] \\right| = \\left| \\frac{1}{N} \\sum_{i=1}^N (\\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)]) \\right|\n1462: $$\n1463: \n1464: By exchangeability:\n1465: \n1466: $$\n1467: \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1468: $$\n1469: \n1470: Setting $C_{\\text{BAOAB}} := C_{\\text{inv}}$ completes the proof."
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}