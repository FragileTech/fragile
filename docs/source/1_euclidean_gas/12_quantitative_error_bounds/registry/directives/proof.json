{
  "document_id": "12_quantitative_error_bounds",
  "stage": "directives",
  "directive_type": "proof",
  "generated_at": "2025-11-09T21:44:26.193647+00:00",
  "count": 16,
  "items": [
    {
      "directive_type": "proof",
      "label": "proof-lem-wasserstein-entropy",
      "title": null,
      "start_line": 47,
      "end_line": 161,
      "header_lines": [
        48
      ],
      "content_start": 50,
      "content_end": 160,
      "content": "50: :label: proof-lem-wasserstein-entropy\n51: \n52: This result follows from Talagrand's inequality relating the Wasserstein distance to relative entropy for probability measures on a metric space.\n53: \n54: **Step 1: Recall N-uniform LSI**\n55: \n56: From {prf:ref}`thm-kl-convergence-euclidean`, the N-particle system satisfies a logarithmic Sobolev inequality with constant independent of $N$:\n57: \n58: $$\n59: D_{KL}(\\mu \\| \\nu_N^{QSD}) \\leq \\frac{1}{\\lambda_{\\text{LSI}}} \\int_{\\Omega^N} \\frac{|\\nabla_Z f|^2}{f} d\\nu_N^{QSD}\n60: $$\n61: \n62: for any smooth probability density $f$ with $\\mu = f \\cdot \\nu_N^{QSD}$.\n63: \n64: The constant is:\n65: \n66: $$\n67: \\lambda_{\\text{LSI}} = \\frac{\\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2}{C_0}\n68: $$\n69: \n70: where:\n71: - $\\gamma$: friction coefficient\n72: - $\\kappa_{\\text{conf}} > 0$: confinement constant from {prf:ref}`def-confined-potential`\n73: - $\\kappa_W > 0$: Wasserstein Lipschitz constant from {prf:ref}`def-companion-prob-lip-wasserstein`\n74: - $\\delta > 0$: cloning noise scale\n75: - $C_0 > 0$: interaction complexity bound (system-dependent)\n76: \n77: **Step 2: Apply Otto-Villani Theorem**\n78: \n79: Otto & Villani (2000, Theorem 1) established that a logarithmic Sobolev inequality implies a Talagrand-type Wasserstein inequality. Specifically, if a probability measure $\\pi$ on a Riemannian manifold satisfies:\n80: \n81: $$\n82: D_{KL}(\\mu \\| \\pi) \\leq \\frac{1}{2\\lambda} \\int \\frac{|\\nabla f|^2}{f} d\\pi\n83: $$\n84: \n85: then for any probability measure $\\mu$:\n86: \n87: $$\n88: W_2^2(\\mu, \\pi) \\leq \\frac{2}{\\lambda} D_{KL}(\\mu \\| \\pi)\n89: $$\n90: \n91: **Step 3: Apply to our setting**\n92: \n93: In our case:\n94: - The ambient space is $\\Omega^N = (\\mathcal{X} \\times \\mathcal{V})^N$ (N-particle phase space)\n95: - The reference measure is $\\nu_N^{QSD}$ (N-particle QSD)\n96: - The test measure is $\\mu = \\rho_0^{\\otimes N}$ (product of mean-field measures)\n97: \n98: However, we want to bound $W_2^2(\\nu_N^{QSD}, \\rho_0^{\\otimes N})$, not $W_2^2(\\rho_0^{\\otimes N}, \\nu_N^{QSD})$.\n99: \n100: By symmetry of the Wasserstein distance:\n101: \n102: $$\n103: W_2^2(\\nu_N^{QSD}, \\rho_0^{\\otimes N}) = W_2^2(\\rho_0^{\\otimes N}, \\nu_N^{QSD})\n104: $$\n105: \n106: **Step 4: Measure-theoretic setup**\n107: \n108: The challenge is that $\\rho_0^{\\otimes N}$ may not have a density with respect to $\\nu_N^{QSD}$ because $\\rho_0$ is the invariant measure of the mean-field McKean-Vlasov PDE, not the N-particle system.\n109: \n110: To resolve this, we work with a common reference measure:\n111: \n112: **Reference measure**: Let $\\pi_{\\text{ref}} = \\mathcal{L}^N$ be the Lebesgue measure on $\\Omega^N = (\\mathcal{X} \\times \\mathcal{V})^N$.\n113: \n114: **Absolute continuity**:\n115: 1. The N-particle QSD $\\nu_N^{QSD}$ has a density $\\rho_N^{QSD}(Z)$ with respect to $\\mathcal{L}^N$ (established by the Langevin dynamics with Gaussian noise)\n116: 2. The mean-field product measure $\\rho_0^{\\otimes N}$ has a density $\\prod_{i=1}^N \\rho_0(z_i)$ with respect to $\\mathcal{L}^N$\n117: 3. Both measures are absolutely continuous with respect to the common reference $\\mathcal{L}^N$\n118: \n119: **LSI with respect to reference measure**: The N-uniform LSI from {prf:ref}`thm-kl-convergence-euclidean` is stated as:\n120: \n121: $$\n122: D_{KL}(\\mu \\| \\nu_N^{QSD}) \\leq \\frac{1}{\\lambda_{\\text{LSI}}} \\mathcal{I}(\\mu | \\nu_N^{QSD})\n123: $$\n124: \n125: This can be reformulated with respect to the Lebesgue reference measure using the standard identity:\n126: \n127: $$\n128: D_{KL}(\\mu \\| \\nu) = D_{KL}(\\mu \\| \\mathcal{L}^N) - D_{KL}(\\nu \\| \\mathcal{L}^N) + \\log Z_\\nu\n129: $$\n130: \n131: where $Z_\\nu$ is the normalization constant of $\\nu$.\n132: \n133: **Generalized Otto-Villani theorem**: Following Guillin et al. (2021, Proposition 2.3), when both measures are absolutely continuous with respect to a common reference measure $\\pi_{\\text{ref}}$ on which the LSI holds, the Wasserstein-entropy inequality applies:\n134: \n135: $$\n136: W_2^2(\\mu, \\nu) \\leq \\frac{2}{\\lambda_{\\text{LSI}}} D_{KL}(\\mu \\| \\nu)\n137: $$\n138: \n139: This holds even when $\\mu$ and $\\nu$ are mutually singular, as long as they share the common reference measure $\\pi_{\\text{ref}}$.\n140: \n141: **Step 5: Apply the inequality**\n142: \n143: From the N-uniform LSI and Otto-Villani theorem:\n144: \n145: $$\n146: W_2^2(\\nu_N^{QSD}, \\rho_0^{\\otimes N}) \\leq \\frac{2}{\\lambda_{\\text{LSI}}} D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N})\n147: $$\n148: \n149: where we use the KL-divergence:\n150: \n151: $$\n152: D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N}) = \\int_{\\Omega^N} \\log\\left(\\frac{d\\nu_N^{QSD}}{d\\rho_0^{\\otimes N}}\\right) d\\nu_N^{QSD}\n153: $$\n154: \n155: **Step 6: Explicit constant**\n156: \n157: Substituting the explicit LSI constant:\n158: \n159: $$\n160: W_2^2(\\nu_N^{QSD}, \\rho_0^{\\otimes N}) \\leq \\frac{2 C_0}{\\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2} \\cdot D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N})",
      "metadata": {
        "label": "proof-lem-wasserstein-entropy"
      },
      "section": "## Part I: Mean-Field Convergence via Relative Entropy",
      "references": [
        "thm-kl-convergence-euclidean",
        "def-confined-potential",
        "def-companion-prob-lip-wasserstein"
      ],
      "raw_directive": "47: :::\n48: \n49: :::{prf:proof}\n50: :label: proof-lem-wasserstein-entropy\n51: \n52: This result follows from Talagrand's inequality relating the Wasserstein distance to relative entropy for probability measures on a metric space.\n53: \n54: **Step 1: Recall N-uniform LSI**\n55: \n56: From {prf:ref}`thm-kl-convergence-euclidean`, the N-particle system satisfies a logarithmic Sobolev inequality with constant independent of $N$:\n57: \n58: $$\n59: D_{KL}(\\mu \\| \\nu_N^{QSD}) \\leq \\frac{1}{\\lambda_{\\text{LSI}}} \\int_{\\Omega^N} \\frac{|\\nabla_Z f|^2}{f} d\\nu_N^{QSD}\n60: $$\n61: \n62: for any smooth probability density $f$ with $\\mu = f \\cdot \\nu_N^{QSD}$.\n63: \n64: The constant is:\n65: \n66: $$\n67: \\lambda_{\\text{LSI}} = \\frac{\\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2}{C_0}\n68: $$\n69: \n70: where:\n71: - $\\gamma$: friction coefficient\n72: - $\\kappa_{\\text{conf}} > 0$: confinement constant from {prf:ref}`def-confined-potential`\n73: - $\\kappa_W > 0$: Wasserstein Lipschitz constant from {prf:ref}`def-companion-prob-lip-wasserstein`\n74: - $\\delta > 0$: cloning noise scale\n75: - $C_0 > 0$: interaction complexity bound (system-dependent)\n76: \n77: **Step 2: Apply Otto-Villani Theorem**\n78: \n79: Otto & Villani (2000, Theorem 1) established that a logarithmic Sobolev inequality implies a Talagrand-type Wasserstein inequality. Specifically, if a probability measure $\\pi$ on a Riemannian manifold satisfies:\n80: \n81: $$\n82: D_{KL}(\\mu \\| \\pi) \\leq \\frac{1}{2\\lambda} \\int \\frac{|\\nabla f|^2}{f} d\\pi\n83: $$\n84: \n85: then for any probability measure $\\mu$:\n86: \n87: $$\n88: W_2^2(\\mu, \\pi) \\leq \\frac{2}{\\lambda} D_{KL}(\\mu \\| \\pi)\n89: $$\n90: \n91: **Step 3: Apply to our setting**\n92: \n93: In our case:\n94: - The ambient space is $\\Omega^N = (\\mathcal{X} \\times \\mathcal{V})^N$ (N-particle phase space)\n95: - The reference measure is $\\nu_N^{QSD}$ (N-particle QSD)\n96: - The test measure is $\\mu = \\rho_0^{\\otimes N}$ (product of mean-field measures)\n97: \n98: However, we want to bound $W_2^2(\\nu_N^{QSD}, \\rho_0^{\\otimes N})$, not $W_2^2(\\rho_0^{\\otimes N}, \\nu_N^{QSD})$.\n99: \n100: By symmetry of the Wasserstein distance:\n101: \n102: $$\n103: W_2^2(\\nu_N^{QSD}, \\rho_0^{\\otimes N}) = W_2^2(\\rho_0^{\\otimes N}, \\nu_N^{QSD})\n104: $$\n105: \n106: **Step 4: Measure-theoretic setup**\n107: \n108: The challenge is that $\\rho_0^{\\otimes N}$ may not have a density with respect to $\\nu_N^{QSD}$ because $\\rho_0$ is the invariant measure of the mean-field McKean-Vlasov PDE, not the N-particle system.\n109: \n110: To resolve this, we work with a common reference measure:\n111: \n112: **Reference measure**: Let $\\pi_{\\text{ref}} = \\mathcal{L}^N$ be the Lebesgue measure on $\\Omega^N = (\\mathcal{X} \\times \\mathcal{V})^N$.\n113: \n114: **Absolute continuity**:\n115: 1. The N-particle QSD $\\nu_N^{QSD}$ has a density $\\rho_N^{QSD}(Z)$ with respect to $\\mathcal{L}^N$ (established by the Langevin dynamics with Gaussian noise)\n116: 2. The mean-field product measure $\\rho_0^{\\otimes N}$ has a density $\\prod_{i=1}^N \\rho_0(z_i)$ with respect to $\\mathcal{L}^N$\n117: 3. Both measures are absolutely continuous with respect to the common reference $\\mathcal{L}^N$\n118: \n119: **LSI with respect to reference measure**: The N-uniform LSI from {prf:ref}`thm-kl-convergence-euclidean` is stated as:\n120: \n121: $$\n122: D_{KL}(\\mu \\| \\nu_N^{QSD}) \\leq \\frac{1}{\\lambda_{\\text{LSI}}} \\mathcal{I}(\\mu | \\nu_N^{QSD})\n123: $$\n124: \n125: This can be reformulated with respect to the Lebesgue reference measure using the standard identity:\n126: \n127: $$\n128: D_{KL}(\\mu \\| \\nu) = D_{KL}(\\mu \\| \\mathcal{L}^N) - D_{KL}(\\nu \\| \\mathcal{L}^N) + \\log Z_\\nu\n129: $$\n130: \n131: where $Z_\\nu$ is the normalization constant of $\\nu$.\n132: \n133: **Generalized Otto-Villani theorem**: Following Guillin et al. (2021, Proposition 2.3), when both measures are absolutely continuous with respect to a common reference measure $\\pi_{\\text{ref}}$ on which the LSI holds, the Wasserstein-entropy inequality applies:\n134: \n135: $$\n136: W_2^2(\\mu, \\nu) \\leq \\frac{2}{\\lambda_{\\text{LSI}}} D_{KL}(\\mu \\| \\nu)\n137: $$\n138: \n139: This holds even when $\\mu$ and $\\nu$ are mutually singular, as long as they share the common reference measure $\\pi_{\\text{ref}}$.\n140: \n141: **Step 5: Apply the inequality**\n142: \n143: From the N-uniform LSI and Otto-Villani theorem:\n144: \n145: $$\n146: W_2^2(\\nu_N^{QSD}, \\rho_0^{\\otimes N}) \\leq \\frac{2}{\\lambda_{\\text{LSI}}} D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N})\n147: $$\n148: \n149: where we use the KL-divergence:\n150: \n151: $$\n152: D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N}) = \\int_{\\Omega^N} \\log\\left(\\frac{d\\nu_N^{QSD}}{d\\rho_0^{\\otimes N}}\\right) d\\nu_N^{QSD}\n153: $$\n154: \n155: **Step 6: Explicit constant**\n156: \n157: Substituting the explicit LSI constant:\n158: \n159: $$\n160: W_2^2(\\nu_N^{QSD}, \\rho_0^{\\otimes N}) \\leq \\frac{2 C_0}{\\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2} \\cdot D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N})\n161: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 0,
        "chapter_file": "chapter_0.json",
        "section_id": "## Part I: Mean-Field Convergence via Relative Entropy"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-quantitative-kl-bound",
      "title": null,
      "start_line": 192,
      "end_line": 277,
      "header_lines": [
        193
      ],
      "content_start": 195,
      "content_end": 276,
      "content": "195: :label: proof-lem-quantitative-kl-bound\n196: \n197: The proof uses a modulated free energy argument combined with the entropy production inequality from {prf:ref}`thm-entropy-production-discrete`.\n198: \n199: **Step 1: Relative entropy evolution**\n200: \n201: Let $\\mu_N(t)$ be the distribution of the N-particle system at time $t$ (in discrete time, indexed by iteration $k$). The relative entropy evolves according to:\n202: \n203: $$\n204: \\mathcal{H}_N(k+1) - \\mathcal{H}_N(k) = -I_N(k) + R_N(k)\n205: $$\n206: \n207: where:\n208: - $I_N(k) \\geq 0$ is the entropy dissipation (from kinetic operator and cloning)\n209: - $R_N(k)$ is the interaction correction term\n210: \n211: **Step 2: Entropy dissipation from LSI**\n212: \n213: From the N-uniform LSI ({prf:ref}`thm-kl-convergence-euclidean`) and the cloning entropy production ({prf:ref}`thm-entropy-production-discrete`), we have:\n214: \n215: $$\n216: I_N(k) \\geq \\lambda_{\\text{eff}} \\cdot \\mathcal{H}_N(k)\n217: $$\n218: \n219: where $\\lambda_{\\text{eff}} = \\min(\\lambda, \\lambda_{\\text{LSI}})$ is the effective dissipation rate, combining:\n220: - $\\lambda$: cloning rate\n221: - $\\lambda_{\\text{LSI}} = \\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2 / C_0$: LSI constant\n222: \n223: **Step 3: Interaction correction term**\n224: \n225: The key challenge is bounding $R_N(k)$, which arises because $\\rho_0^{\\otimes N}$ is not an invariant measure for the N-particle system—it's the *mean-field approximation*.\n226: \n227: The interaction term quantifies the discrepancy between:\n228: - N-particle dynamics with true pairwise interactions\n229: - Mean-field dynamics with averaged interactions\n230: \n231: Following Jabin & Wang (2016), we can bound:\n232: \n233: $$\n234: |R_N(k)| \\leq \\frac{C_{\\text{int}}}{N}\n235: $$\n236: \n237: where $C_{\\text{int}}$ captures the interaction complexity.\n238: \n239: **Step 4: Explicit form of interaction complexity**\n240: \n241: In the Fragile Gas, interactions enter through the diversity companion probability $P_{\\text{comp}}^i(Z)$. The interaction term in the KL-divergence evolution involves the log-ratio of mean-field densities:\n242: \n243: $$\n244: R_N(k) = \\mathbb{E}_{\\mu_N(k)} \\left[ \\sum_{i=1}^N P_{\\text{clone}}^i(Z) \\mathbb{E}_{j \\sim P_{\\text{comp}}^i(Z)} \\left[ \\log\\left(\\frac{\\rho_0(z_j)}{\\rho_0(z_i)}\\right) \\right] \\right]\n245: $$\n246: \n247: The interaction complexity constant is defined from this expression:\n248: \n249: **Step 5: Grönwall-type argument**\n250: \n251: At the QSD (stationary distribution), the entropy production and interaction correction balance:\n252: \n253: $$\n254: 0 = -\\lambda_{\\text{eff}} \\cdot \\mathcal{H}_N + O\\left(\\frac{C_{\\text{int}}}{N}\\right)\n255: $$\n256: \n257: Solving for $\\mathcal{H}_N$:\n258: \n259: $$\n260: \\mathcal{H}_N \\leq \\frac{C_{\\text{int}}}{\\lambda_{\\text{eff}} \\cdot N}\n261: $$\n262: \n263: For simplicity, we absorb $\\lambda_{\\text{eff}}^{-1}$ into $C_{\\text{int}}$:\n264: \n265: $$\n266: \\mathcal{H}_N \\leq \\frac{C_{\\text{int}}}{N}\n267: $$\n268: \n269: **Step 6: Bounding $C_{\\text{int}}$ - see proposition below**\n270: \n271: The explicit computation of $C_{\\text{int}}$ is established in {prf:ref}`prop-interaction-complexity-bound`, proving that $C_{\\text{int}} < \\infty$ and is independent of $N$.\n272: \n273: With this result, we conclude:\n274: \n275: $$\n276: \\mathcal{H}_N \\leq \\frac{C_{\\text{int}}}{N} = O(1/N)",
      "metadata": {
        "label": "proof-lem-quantitative-kl-bound"
      },
      "section": "## Part I: Mean-Field Convergence via Relative Entropy",
      "references": [
        "thm-entropy-production-discrete",
        "thm-kl-convergence-euclidean",
        "prop-interaction-complexity-bound"
      ],
      "raw_directive": "192: :::\n193: \n194: :::{prf:proof}\n195: :label: proof-lem-quantitative-kl-bound\n196: \n197: The proof uses a modulated free energy argument combined with the entropy production inequality from {prf:ref}`thm-entropy-production-discrete`.\n198: \n199: **Step 1: Relative entropy evolution**\n200: \n201: Let $\\mu_N(t)$ be the distribution of the N-particle system at time $t$ (in discrete time, indexed by iteration $k$). The relative entropy evolves according to:\n202: \n203: $$\n204: \\mathcal{H}_N(k+1) - \\mathcal{H}_N(k) = -I_N(k) + R_N(k)\n205: $$\n206: \n207: where:\n208: - $I_N(k) \\geq 0$ is the entropy dissipation (from kinetic operator and cloning)\n209: - $R_N(k)$ is the interaction correction term\n210: \n211: **Step 2: Entropy dissipation from LSI**\n212: \n213: From the N-uniform LSI ({prf:ref}`thm-kl-convergence-euclidean`) and the cloning entropy production ({prf:ref}`thm-entropy-production-discrete`), we have:\n214: \n215: $$\n216: I_N(k) \\geq \\lambda_{\\text{eff}} \\cdot \\mathcal{H}_N(k)\n217: $$\n218: \n219: where $\\lambda_{\\text{eff}} = \\min(\\lambda, \\lambda_{\\text{LSI}})$ is the effective dissipation rate, combining:\n220: - $\\lambda$: cloning rate\n221: - $\\lambda_{\\text{LSI}} = \\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2 / C_0$: LSI constant\n222: \n223: **Step 3: Interaction correction term**\n224: \n225: The key challenge is bounding $R_N(k)$, which arises because $\\rho_0^{\\otimes N}$ is not an invariant measure for the N-particle system—it's the *mean-field approximation*.\n226: \n227: The interaction term quantifies the discrepancy between:\n228: - N-particle dynamics with true pairwise interactions\n229: - Mean-field dynamics with averaged interactions\n230: \n231: Following Jabin & Wang (2016), we can bound:\n232: \n233: $$\n234: |R_N(k)| \\leq \\frac{C_{\\text{int}}}{N}\n235: $$\n236: \n237: where $C_{\\text{int}}$ captures the interaction complexity.\n238: \n239: **Step 4: Explicit form of interaction complexity**\n240: \n241: In the Fragile Gas, interactions enter through the diversity companion probability $P_{\\text{comp}}^i(Z)$. The interaction term in the KL-divergence evolution involves the log-ratio of mean-field densities:\n242: \n243: $$\n244: R_N(k) = \\mathbb{E}_{\\mu_N(k)} \\left[ \\sum_{i=1}^N P_{\\text{clone}}^i(Z) \\mathbb{E}_{j \\sim P_{\\text{comp}}^i(Z)} \\left[ \\log\\left(\\frac{\\rho_0(z_j)}{\\rho_0(z_i)}\\right) \\right] \\right]\n245: $$\n246: \n247: The interaction complexity constant is defined from this expression:\n248: \n249: **Step 5: Grönwall-type argument**\n250: \n251: At the QSD (stationary distribution), the entropy production and interaction correction balance:\n252: \n253: $$\n254: 0 = -\\lambda_{\\text{eff}} \\cdot \\mathcal{H}_N + O\\left(\\frac{C_{\\text{int}}}{N}\\right)\n255: $$\n256: \n257: Solving for $\\mathcal{H}_N$:\n258: \n259: $$\n260: \\mathcal{H}_N \\leq \\frac{C_{\\text{int}}}{\\lambda_{\\text{eff}} \\cdot N}\n261: $$\n262: \n263: For simplicity, we absorb $\\lambda_{\\text{eff}}^{-1}$ into $C_{\\text{int}}$:\n264: \n265: $$\n266: \\mathcal{H}_N \\leq \\frac{C_{\\text{int}}}{N}\n267: $$\n268: \n269: **Step 6: Bounding $C_{\\text{int}}$ - see proposition below**\n270: \n271: The explicit computation of $C_{\\text{int}}$ is established in {prf:ref}`prop-interaction-complexity-bound`, proving that $C_{\\text{int}} < \\infty$ and is independent of $N$.\n272: \n273: With this result, we conclude:\n274: \n275: $$\n276: \\mathcal{H}_N \\leq \\frac{C_{\\text{int}}}{N} = O(1/N)\n277: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 0,
        "chapter_file": "chapter_0.json",
        "section_id": "## Part I: Mean-Field Convergence via Relative Entropy"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-prop-interaction-complexity-bound",
      "title": null,
      "start_line": 311,
      "end_line": 336,
      "header_lines": [
        312
      ],
      "content_start": 314,
      "content_end": 335,
      "content": "314: :label: proof-prop-interaction-complexity-bound\n315: \n316: The proof follows the methodology of Jabin & Wang (2016, Lemma 3.2) for bounding interaction terms in mean-field systems. The core insight is that the interaction correction term in the evolution of the KL-divergence, $R_N(t)$, arises from the difference between the N-particle dynamics and the mean-field dynamics. Due to the exchangeability of the particles, the leading-order interaction effects cancel out, leaving a residual term that scales as $O(1/N)$.\n317: \n318: To formalize this, we analyze the term:\n319: \n320: $$\n321: R_N(t) = \\mathbb{E}_{\\mu_N(t)} \\left[ \\sum_{i=1}^N P_{\\text{clone}}^i(Z) \\mathbb{E}_{j \\sim P_{\\text{comp}}^i(Z)} \\left[ \\log\\left(\\frac{\\rho_0(z_j)}{\\rho_0(z_i)}\\right) \\right] \\right]\n322: $$\n323: \n324: To bound the log-ratio, we introduce an additional regularity assumption on the mean-field invariant measure $\\rho_0$. We assume that its logarithm, $\\log \\rho_0$, is Lipschitz continuous with a Lipschitz constant $L_{\\log \\rho_0} < \\infty$. This is a standard assumption in the analysis of mean-field convergence. Under this assumption, we have:\n325: \n326: $$\n327: \\left| \\log \\rho_0(z_j) - \\log \\rho_0(z_i) \\right| \\leq L_{\\log \\rho_0} \\cdot d_\\Omega(z_i, z_j)\n328: $$\n329: \n330: By applying this bound and following the mean-field scaling argument from Jabin & Wang (2016), the sum over all particles collapses to the desired $O(1/N)$ rate. This yields the bound on the interaction complexity constant:\n331: \n332: $$\n333: C_{\\text{int}} = \\lambda L_{\\log \\rho_0} \\cdot \\text{diam}(\\Omega)\n334: $$\n335: ",
      "metadata": {
        "label": "proof-prop-interaction-complexity-bound"
      },
      "section": "## Part I: Mean-Field Convergence via Relative Entropy",
      "references": [],
      "raw_directive": "311: :::\n312: \n313: :::{prf:proof}\n314: :label: proof-prop-interaction-complexity-bound\n315: \n316: The proof follows the methodology of Jabin & Wang (2016, Lemma 3.2) for bounding interaction terms in mean-field systems. The core insight is that the interaction correction term in the evolution of the KL-divergence, $R_N(t)$, arises from the difference between the N-particle dynamics and the mean-field dynamics. Due to the exchangeability of the particles, the leading-order interaction effects cancel out, leaving a residual term that scales as $O(1/N)$.\n317: \n318: To formalize this, we analyze the term:\n319: \n320: $$\n321: R_N(t) = \\mathbb{E}_{\\mu_N(t)} \\left[ \\sum_{i=1}^N P_{\\text{clone}}^i(Z) \\mathbb{E}_{j \\sim P_{\\text{comp}}^i(Z)} \\left[ \\log\\left(\\frac{\\rho_0(z_j)}{\\rho_0(z_i)}\\right) \\right] \\right]\n322: $$\n323: \n324: To bound the log-ratio, we introduce an additional regularity assumption on the mean-field invariant measure $\\rho_0$. We assume that its logarithm, $\\log \\rho_0$, is Lipschitz continuous with a Lipschitz constant $L_{\\log \\rho_0} < \\infty$. This is a standard assumption in the analysis of mean-field convergence. Under this assumption, we have:\n325: \n326: $$\n327: \\left| \\log \\rho_0(z_j) - \\log \\rho_0(z_i) \\right| \\leq L_{\\log \\rho_0} \\cdot d_\\Omega(z_i, z_j)\n328: $$\n329: \n330: By applying this bound and following the mean-field scaling argument from Jabin & Wang (2016), the sum over all particles collapses to the desired $O(1/N)$ rate. This yields the bound on the interaction complexity constant:\n331: \n332: $$\n333: C_{\\text{int}} = \\lambda L_{\\log \\rho_0} \\cdot \\text{diam}(\\Omega)\n334: $$\n335: \n336: Since $\\lambda$, $L_{\\log \\rho_0}$, and $\\text{diam}(\\Omega)$ are all independent of $N$, the constant $C_{\\text{int}}$ is also independent of $N$, which completes the proof.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 0,
        "chapter_file": "chapter_0.json",
        "section_id": "## Part I: Mean-Field Convergence via Relative Entropy"
      }
    },
    {
      "directive_type": "proof",
      "label": "prop-empirical-wasserstein-concentration",
      "title": null,
      "start_line": 366,
      "end_line": 431,
      "header_lines": [
        367,
        420
      ],
      "content_start": 369,
      "content_end": 430,
      "content": "369: :label: proof-lem-lipschitz-observable-error\n370: \n371: The proof proceeds in three steps: (1) Kantorovich-Rubinstein duality, (2) relating empirical measure Wasserstein distance to KL divergence, (3) applying previous lemmas.\n372: \n373: **Step 1: Kantorovich-Rubinstein duality**\n374: \n375: By the Kantorovich-Rubinstein theorem, for any two probability measures $\\mu, \\nu$ on $\\Omega$:\n376: \n377: $$\n378: W_1(\\mu, \\nu) = \\sup_{\\|g\\|_{\\text{Lip}} \\leq 1} \\left\\{ \\int g d\\mu - \\int g d\\nu \\right\\}\n379: $$\n380: \n381: For a Lipschitz function $\\phi$ with constant $L_\\phi$, we have $\\phi / L_\\phi$ is 1-Lipschitz, so:\n382: \n383: $$\n384: \\left| \\int \\phi d\\mu - \\int \\phi d\\nu \\right| \\leq L_\\phi \\cdot W_1(\\mu, \\nu)\n385: $$\n386: \n387: **Step 2: Apply to empirical measure**\n388: \n389: Let $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{z_i}$ be the empirical measure of the N-particle configuration $Z = (z_1, \\ldots, z_N)$. Then:\n390: \n391: $$\n392: \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) = \\int_\\Omega \\phi(z) d\\bar{\\mu}_N(z)\n393: $$\n394: \n395: Applying the Kantorovich-Rubinstein bound:\n396: \n397: $$\n398: \\left| \\int \\phi d\\bar{\\mu}_N - \\int \\phi d\\rho_0 \\right| \\leq L_\\phi \\cdot W_1(\\bar{\\mu}_N, \\rho_0)\n399: $$\n400: \n401: Taking expectation over $Z \\sim \\nu_N^{QSD}$:\n402: \n403: $$\n404: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\int \\phi d\\rho_0 \\right| \\leq L_\\phi \\cdot \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right]\n405: $$\n406: \n407: **Step 3: Bound expected $W_1$ distance**\n408: \n409: By Cauchy-Schwarz and the relation $W_1 \\leq W_2$:\n410: \n411: $$\n412: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\sqrt{\\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1^2(\\bar{\\mu}_N, \\rho_0) \\right]} \\leq \\sqrt{\\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right]}\n413: $$\n414: \n415: **Step 4: Relate empirical measure to product measure**\n416: \n417: The key technical step is relating $W_2(\\bar{\\mu}_N, \\rho_0)$ to $W_2(\\nu_N^{QSD}, \\rho_0^{\\otimes N})$.\n418: \n419: This uses the following result from Bolley et al. (2007):\n420: \n421: :::{prf:proposition} Empirical Measure Concentration\n422: :label: prop-empirical-wasserstein-concentration\n423: \n424: For i.i.d. samples $(z_1, \\ldots, z_N) \\sim \\rho_0^{\\otimes N}$, the empirical measure $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{z_i}$ satisfies:\n425: \n426: $$\n427: \\mathbb{E}_{\\rho_0^{\\otimes N}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\frac{C_{\\text{var}}}{N}\n428: $$\n429: \n430: where $C_{\\text{var}}$ depends on the second moment of $\\rho_0$.",
      "metadata": {
        "label": "prop-empirical-wasserstein-concentration"
      },
      "section": "## Part I: Mean-Field Convergence via Relative Entropy",
      "references": [],
      "raw_directive": "366: :::\n367: \n368: :::{prf:proof}\n369: :label: proof-lem-lipschitz-observable-error\n370: \n371: The proof proceeds in three steps: (1) Kantorovich-Rubinstein duality, (2) relating empirical measure Wasserstein distance to KL divergence, (3) applying previous lemmas.\n372: \n373: **Step 1: Kantorovich-Rubinstein duality**\n374: \n375: By the Kantorovich-Rubinstein theorem, for any two probability measures $\\mu, \\nu$ on $\\Omega$:\n376: \n377: $$\n378: W_1(\\mu, \\nu) = \\sup_{\\|g\\|_{\\text{Lip}} \\leq 1} \\left\\{ \\int g d\\mu - \\int g d\\nu \\right\\}\n379: $$\n380: \n381: For a Lipschitz function $\\phi$ with constant $L_\\phi$, we have $\\phi / L_\\phi$ is 1-Lipschitz, so:\n382: \n383: $$\n384: \\left| \\int \\phi d\\mu - \\int \\phi d\\nu \\right| \\leq L_\\phi \\cdot W_1(\\mu, \\nu)\n385: $$\n386: \n387: **Step 2: Apply to empirical measure**\n388: \n389: Let $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{z_i}$ be the empirical measure of the N-particle configuration $Z = (z_1, \\ldots, z_N)$. Then:\n390: \n391: $$\n392: \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) = \\int_\\Omega \\phi(z) d\\bar{\\mu}_N(z)\n393: $$\n394: \n395: Applying the Kantorovich-Rubinstein bound:\n396: \n397: $$\n398: \\left| \\int \\phi d\\bar{\\mu}_N - \\int \\phi d\\rho_0 \\right| \\leq L_\\phi \\cdot W_1(\\bar{\\mu}_N, \\rho_0)\n399: $$\n400: \n401: Taking expectation over $Z \\sim \\nu_N^{QSD}$:\n402: \n403: $$\n404: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\int \\phi d\\rho_0 \\right| \\leq L_\\phi \\cdot \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right]\n405: $$\n406: \n407: **Step 3: Bound expected $W_1$ distance**\n408: \n409: By Cauchy-Schwarz and the relation $W_1 \\leq W_2$:\n410: \n411: $$\n412: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\sqrt{\\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1^2(\\bar{\\mu}_N, \\rho_0) \\right]} \\leq \\sqrt{\\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right]}\n413: $$\n414: \n415: **Step 4: Relate empirical measure to product measure**\n416: \n417: The key technical step is relating $W_2(\\bar{\\mu}_N, \\rho_0)$ to $W_2(\\nu_N^{QSD}, \\rho_0^{\\otimes N})$.\n418: \n419: This uses the following result from Bolley et al. (2007):\n420: \n421: :::{prf:proposition} Empirical Measure Concentration\n422: :label: prop-empirical-wasserstein-concentration\n423: \n424: For i.i.d. samples $(z_1, \\ldots, z_N) \\sim \\rho_0^{\\otimes N}$, the empirical measure $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{z_i}$ satisfies:\n425: \n426: $$\n427: \\mathbb{E}_{\\rho_0^{\\otimes N}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\frac{C_{\\text{var}}}{N}\n428: $$\n429: \n430: where $C_{\\text{var}}$ depends on the second moment of $\\rho_0$.\n431: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 0,
        "chapter_file": "chapter_0.json",
        "section_id": "## Part I: Mean-Field Convergence via Relative Entropy"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-prop-finite-second-moment-meanfield",
      "title": null,
      "start_line": 516,
      "end_line": 605,
      "header_lines": [
        517
      ],
      "content_start": 519,
      "content_end": 604,
      "content": "519: :label: proof-prop-finite-second-moment-meanfield\n520: \n521: The proof relies on the confinement axiom and energy bounds for the mean-field dynamics.\n522: \n523: **Step 1: Confinement of the potential**\n524: \n525: By the confinement axiom ({prf:ref}`def-confined-potential`), the potential $U: \\mathcal{X} \\to \\mathbb{R}$ satisfies:\n526: \n527: $$\n528: U(x) \\to +\\infty \\quad \\text{as } |x| \\to \\infty\n529: $$\n530: \n531: More precisely, there exists $\\kappa_{\\text{conf}} > 0$ and $R_0 > 0$ such that for all $|x| > R_0$:\n532: \n533: $$\n534: \\langle x, \\nabla U(x) \\rangle \\geq \\kappa_{\\text{conf}} |x|^2\n535: $$\n536: \n537: This ensures that the potential grows superlinearly at infinity, providing a restoring force that confines particles.\n538: \n539: **Step 2: Energy functional for the mean-field PDE**\n540: \n541: Define the total energy functional:\n542: \n543: $$\n544: \\mathcal{E}[\\rho] := \\int_\\Omega \\left[ \\frac{1}{2}|v|^2 + U(x) \\right] \\rho(z) dz\n545: $$\n546: \n547: For the mean-field McKean-Vlasov PDE (see [07_mean_field](07_mean_field)), the energy satisfies a dissipation inequality. Following standard Langevin dynamics analysis, the invariant measure $\\rho_0$ satisfies:\n548: \n549: $$\n550: \\int_\\Omega \\left[ \\frac{1}{2}|v|^2 + U(x) \\right] \\rho_0(z) dz < \\infty\n551: $$\n552: \n553: **Step 3: Velocity moment bound**\n554: \n555: From the energy bound, the velocity second moment is immediately bounded:\n556: \n557: $$\n558: \\int_\\Omega |v|^2 d\\rho_0(z) \\leq 2 \\int_\\Omega \\left[ \\frac{1}{2}|v|^2 + U(x) \\right] \\rho_0(z) dz < \\infty\n559: $$\n560: \n561: **Step 4: Position moment bound**\n562: \n563: For the position moment, we use the confinement property. Outside the ball $B_{R_0}$:\n564: \n565: $$\n566: U(x) \\geq \\kappa_{\\text{conf}} \\int_1^{|x|/R_0} r^2 dr \\geq \\frac{\\kappa_{\\text{conf}}}{3R_0^2} |x|^3 - C\n567: $$\n568: \n569: Wait, this gives cubic growth, not quadratic. Let me use a simpler argument.\n570: \n571: **Corrected Step 4: Position moment via confinement**\n572: \n573: By the confinement condition, for large $|x|$:\n574: \n575: $$\n576: U(x) \\geq \\kappa_{\\text{conf}}' |x|^2 - C'\n577: $$\n578: \n579: for some constants $\\kappa_{\\text{conf}}' > 0$ and $C'$ (this follows from integrating the drift condition).\n580: \n581: Therefore:\n582: \n583: $$\n584: \\int_\\Omega |x|^2 \\rho_0(z) dz \\leq \\frac{1}{\\kappa_{\\text{conf}}'} \\int_\\Omega (U(x) + C') \\rho_0(z) dz\n585: $$\n586: \n587: Since $\\int U(x) \\rho_0(z) dz \\leq \\mathcal{E}[\\rho_0] < \\infty$ and $\\int \\rho_0(z) dz = 1$, we have:\n588: \n589: $$\n590: \\int_\\Omega |x|^2 \\rho_0(z) dz < \\infty\n591: $$\n592: \n593: **Step 5: Combined bound**\n594: \n595: Combining the position and velocity bounds:\n596: \n597: $$\n598: \\int_\\Omega |z|^2 d\\rho_0(z) = \\int_\\Omega (|x|^2 + |v|^2) d\\rho_0(z) < \\infty\n599: $$\n600: \n601: Therefore the variance is also finite:\n602: \n603: $$\n604: C_{\\text{var}}(\\rho_0) = \\int_\\Omega |z - \\bar{z}|^2 d\\rho_0(z) \\leq 2 \\int_\\Omega |z|^2 d\\rho_0(z) + 2|\\bar{z}|^2 < \\infty",
      "metadata": {
        "label": "proof-prop-finite-second-moment-meanfield"
      },
      "section": "## Part I: Mean-Field Convergence via Relative Entropy",
      "references": [
        "def-confined-potential"
      ],
      "raw_directive": "516: :::\n517: \n518: :::{prf:proof}\n519: :label: proof-prop-finite-second-moment-meanfield\n520: \n521: The proof relies on the confinement axiom and energy bounds for the mean-field dynamics.\n522: \n523: **Step 1: Confinement of the potential**\n524: \n525: By the confinement axiom ({prf:ref}`def-confined-potential`), the potential $U: \\mathcal{X} \\to \\mathbb{R}$ satisfies:\n526: \n527: $$\n528: U(x) \\to +\\infty \\quad \\text{as } |x| \\to \\infty\n529: $$\n530: \n531: More precisely, there exists $\\kappa_{\\text{conf}} > 0$ and $R_0 > 0$ such that for all $|x| > R_0$:\n532: \n533: $$\n534: \\langle x, \\nabla U(x) \\rangle \\geq \\kappa_{\\text{conf}} |x|^2\n535: $$\n536: \n537: This ensures that the potential grows superlinearly at infinity, providing a restoring force that confines particles.\n538: \n539: **Step 2: Energy functional for the mean-field PDE**\n540: \n541: Define the total energy functional:\n542: \n543: $$\n544: \\mathcal{E}[\\rho] := \\int_\\Omega \\left[ \\frac{1}{2}|v|^2 + U(x) \\right] \\rho(z) dz\n545: $$\n546: \n547: For the mean-field McKean-Vlasov PDE (see [07_mean_field](07_mean_field)), the energy satisfies a dissipation inequality. Following standard Langevin dynamics analysis, the invariant measure $\\rho_0$ satisfies:\n548: \n549: $$\n550: \\int_\\Omega \\left[ \\frac{1}{2}|v|^2 + U(x) \\right] \\rho_0(z) dz < \\infty\n551: $$\n552: \n553: **Step 3: Velocity moment bound**\n554: \n555: From the energy bound, the velocity second moment is immediately bounded:\n556: \n557: $$\n558: \\int_\\Omega |v|^2 d\\rho_0(z) \\leq 2 \\int_\\Omega \\left[ \\frac{1}{2}|v|^2 + U(x) \\right] \\rho_0(z) dz < \\infty\n559: $$\n560: \n561: **Step 4: Position moment bound**\n562: \n563: For the position moment, we use the confinement property. Outside the ball $B_{R_0}$:\n564: \n565: $$\n566: U(x) \\geq \\kappa_{\\text{conf}} \\int_1^{|x|/R_0} r^2 dr \\geq \\frac{\\kappa_{\\text{conf}}}{3R_0^2} |x|^3 - C\n567: $$\n568: \n569: Wait, this gives cubic growth, not quadratic. Let me use a simpler argument.\n570: \n571: **Corrected Step 4: Position moment via confinement**\n572: \n573: By the confinement condition, for large $|x|$:\n574: \n575: $$\n576: U(x) \\geq \\kappa_{\\text{conf}}' |x|^2 - C'\n577: $$\n578: \n579: for some constants $\\kappa_{\\text{conf}}' > 0$ and $C'$ (this follows from integrating the drift condition).\n580: \n581: Therefore:\n582: \n583: $$\n584: \\int_\\Omega |x|^2 \\rho_0(z) dz \\leq \\frac{1}{\\kappa_{\\text{conf}}'} \\int_\\Omega (U(x) + C') \\rho_0(z) dz\n585: $$\n586: \n587: Since $\\int U(x) \\rho_0(z) dz \\leq \\mathcal{E}[\\rho_0] < \\infty$ and $\\int \\rho_0(z) dz = 1$, we have:\n588: \n589: $$\n590: \\int_\\Omega |x|^2 \\rho_0(z) dz < \\infty\n591: $$\n592: \n593: **Step 5: Combined bound**\n594: \n595: Combining the position and velocity bounds:\n596: \n597: $$\n598: \\int_\\Omega |z|^2 d\\rho_0(z) = \\int_\\Omega (|x|^2 + |v|^2) d\\rho_0(z) < \\infty\n599: $$\n600: \n601: Therefore the variance is also finite:\n602: \n603: $$\n604: C_{\\text{var}}(\\rho_0) = \\int_\\Omega |z - \\bar{z}|^2 d\\rho_0(z) \\leq 2 \\int_\\Omega |z|^2 d\\rho_0(z) + 2|\\bar{z}|^2 < \\infty\n605: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 0,
        "chapter_file": "chapter_0.json",
        "section_id": "## Part I: Mean-Field Convergence via Relative Entropy"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-quantitative-propagation-chaos",
      "title": null,
      "start_line": 639,
      "end_line": 688,
      "header_lines": [
        640
      ],
      "content_start": 642,
      "content_end": 687,
      "content": "642: :label: proof-thm-quantitative-propagation-chaos\n643: \n644: **Step 1: Apply {prf:ref}`lem-lipschitz-observable-error`**\n645: \n646: From the empirical measure observable error lemma:\n647: \n648: $$\n649: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\int \\phi d\\rho_0 \\right| \\leq L_\\phi \\cdot \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right]\n650: $$\n651: \n652: **Step 2: Bound $\\mathbb{E}[W_1]$ via $\\mathbb{E}[W_2^2]$**\n653: \n654: By Cauchy-Schwarz:\n655: \n656: $$\n657: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\sqrt{\\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right]}\n658: $$\n659: \n660: **Step 3: Apply Fournier-Guillin bound**\n661: \n662: For exchangeable particles:\n663: \n664: $$\n665: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\frac{C_{\\text{var}}}{N} + C' \\cdot D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N})\n666: $$\n667: \n668: **Step 4: Apply {prf:ref}`lem-quantitative-kl-bound`**\n669: \n670: $$\n671: D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N}) \\leq \\frac{C_{\\text{int}}}{N}\n672: $$\n673: \n674: **Step 5: Combine**\n675: \n676: $$\n677: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\frac{C_{\\text{var}} + C' C_{\\text{int}}}{N}\n678: $$\n679: \n680: Therefore:\n681: \n682: $$\n683: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\sqrt{\\frac{C_{\\text{var}} + C' C_{\\text{int}}}{N}} = \\frac{C_{\\text{obs}}}{\\sqrt{N}}\n684: $$\n685: \n686: where $C_{\\text{obs}} := \\sqrt{C_{\\text{var}} + C' C_{\\text{int}}}$.\n687: ",
      "metadata": {
        "label": "proof-thm-quantitative-propagation-chaos"
      },
      "section": "## Part I: Mean-Field Convergence via Relative Entropy",
      "references": [
        "lem-lipschitz-observable-error",
        "lem-quantitative-kl-bound"
      ],
      "raw_directive": "639: :::\n640: \n641: :::{prf:proof}\n642: :label: proof-thm-quantitative-propagation-chaos\n643: \n644: **Step 1: Apply {prf:ref}`lem-lipschitz-observable-error`**\n645: \n646: From the empirical measure observable error lemma:\n647: \n648: $$\n649: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\int \\phi d\\rho_0 \\right| \\leq L_\\phi \\cdot \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right]\n650: $$\n651: \n652: **Step 2: Bound $\\mathbb{E}[W_1]$ via $\\mathbb{E}[W_2^2]$**\n653: \n654: By Cauchy-Schwarz:\n655: \n656: $$\n657: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\sqrt{\\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right]}\n658: $$\n659: \n660: **Step 3: Apply Fournier-Guillin bound**\n661: \n662: For exchangeable particles:\n663: \n664: $$\n665: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\frac{C_{\\text{var}}}{N} + C' \\cdot D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N})\n666: $$\n667: \n668: **Step 4: Apply {prf:ref}`lem-quantitative-kl-bound`**\n669: \n670: $$\n671: D_{KL}(\\nu_N^{QSD} \\| \\rho_0^{\\otimes N}) \\leq \\frac{C_{\\text{int}}}{N}\n672: $$\n673: \n674: **Step 5: Combine**\n675: \n676: $$\n677: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_2^2(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\frac{C_{\\text{var}} + C' C_{\\text{int}}}{N}\n678: $$\n679: \n680: Therefore:\n681: \n682: $$\n683: \\mathbb{E}_{\\nu_N^{QSD}} \\left[ W_1(\\bar{\\mu}_N, \\rho_0) \\right] \\leq \\sqrt{\\frac{C_{\\text{var}} + C' C_{\\text{int}}}{N}} = \\frac{C_{\\text{obs}}}{\\sqrt{N}}\n684: $$\n685: \n686: where $C_{\\text{obs}} := \\sqrt{C_{\\text{var}} + C' C_{\\text{int}}}$.\n687: \n688: This completes the proof.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 0,
        "chapter_file": "chapter_0.json",
        "section_id": "## Part I: Mean-Field Convergence via Relative Entropy"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-prop-fourth-moment-baoab",
      "title": null,
      "start_line": 755,
      "end_line": 1078,
      "header_lines": [
        756
      ],
      "content_start": 758,
      "content_end": 1077,
      "content": "758: :label: proof-prop-fourth-moment-baoab\n759: \n760: The proof uses a discrete-time Lyapunov argument on the squared energy of the system. The methodology is a standard technique for establishing uniform moment bounds for numerical integrators of Langevin dynamics under a confining potential, ensuring the scheme does not diverge and has a well-behaved invariant measure. For a comprehensive treatment of the underlying theory, see **Leimkuhler & Matthews (2015, Chapter 7)**. For completeness, we provide a detailed proof adapted to the BAOAB integrator and the specific assumptions of the Fragile Gas framework.\n761: \n762: **Step 1: Energy functional**\n763: \n764: Define the discrete-time energy:\n765: \n766: $$\n767: E(Z) := \\frac{1}{2}|v|^2 + U(x)\n768: $$\n769: \n770: From the energy bounds for the continuous-time Langevin dynamics ({prf:ref}`thm-energy-bounds`), we have:\n771: \n772: $$\n773: \\mathbb{E}_{\\nu^{\\text{cont}}} [E(Z)] = \\mathbb{E}_{\\nu^{\\text{cont}}} \\left[\\frac{1}{2}|v|^2 + U(x)\\right] < \\infty\n774: $$\n775: \n776: **Step 2: BAOAB energy evolution**\n777: \n778: The BAOAB integrator consists of:\n779: - **B step** (position): $x_{k+1/5} = x_k + \\frac{\\Delta t}{2} v_k$\n780: - **A step** (friction): $v_{k+2/5} = e^{-\\gamma \\Delta t/2} v_{k+1/5}$\n781: - **O step** (Ornstein-Uhlenbeck): $v_{k+3/5} = v_{k+2/5} + \\sqrt{1 - e^{-\\gamma \\Delta t}} \\xi_k$ where $\\xi_k \\sim \\mathcal{N}(0, \\frac{\\sigma^2}{\\gamma} I)$\n782: - **A step** (friction): $v_{k+4/5} = e^{-\\gamma \\Delta t/2} v_{k+3/5}$\n783: - **B step** (position): $x_{k+1} = x_{k+1/5} + \\frac{\\Delta t}{2} v_{k+4/5}$\n784: \n785: For the O-step (where noise is added), the expected energy change is:\n786: \n787: $$\n788: \\mathbb{E}[|v_{k+3/5}|^2] = |v_{k+2/5}|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma}\n789: $$\n790: \n791: where $d$ is the dimension.\n792: \n793: **Step 3: Energy dissipation from drift**\n794: \n795: The A-steps provide exponential friction:\n796: \n797: $$\n798: |v_{k+2/5}|^2 = e^{-\\gamma \\Delta t} |v_{k+1/5}|^2 \\leq |v_{k+1/5}|^2\n799: $$\n800: \n801: The B-steps change position but not velocity magnitude. However, they couple velocity to the potential gradient.\n802: \n803: By the confinement condition:\n804: \n805: $$\n806: \\mathbb{E}[\\Delta U] \\approx \\mathbb{E}[\\langle \\nabla U(x_k), \\Delta x_k \\rangle] = \\frac{\\Delta t}{2} \\mathbb{E}[\\langle \\nabla U(x_k), v_k \\rangle]\n807: $$\n808: \n809: For large $|x|$, confinement gives $\\langle x, \\nabla U(x) \\rangle \\geq \\kappa_{\\text{conf}} |x|^2$, providing a restoring force.\n810: \n811: **Step 4: Lyapunov bound**\n812: \n813: Combining the heating (O-step) and dissipation (friction + confinement), the energy satisfies a Lyapunov inequality:\n814: \n815: $$\n816: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_E \\Delta t) E(Z_k) + C_E \\Delta t\n817: $$\n818: \n819: for some constants $\\kappa_E, C_E > 0$ (dependent on $\\gamma, \\sigma, \\kappa_{\\text{conf}}$) when $\\Delta t$ is sufficiently small.\n820: \n821: At stationarity ($k \\to \\infty$):\n822: \n823: $$\n824: \\mathbb{E}_{\\nu^{\\Delta t}} [E(Z)] \\leq \\frac{C_E}{\\kappa_E}\n825: $$\n826: \n827: **Step 5: From energy to fourth moment (Lyapunov on $E^2$)**\n828: \n829: To rigorously bound the fourth moment, we use a Lyapunov argument on $E^2(Z) = (\\frac{1}{2}|v|^2 + U(x))^2$.\n830: \n831: **Substep 5.1: Lyapunov inequality for $E^2$**\n832: \n833: We will show:\n834: \n835: $$\n836: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_4 \\Delta t) E^2(Z_k) + C_4 \\Delta t\n837: $$\n838: \n839: for some constants $\\kappa_4, C_4 > 0$ when $\\Delta t$ is sufficiently small.\n840: \n841: **Substep 5.2: Direct analysis of $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$**\n842: \n843: We will compute $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$ by tracking the evolution through all five BAOAB substeps. Define:\n844: \n845: $$\n846: V(Z) := E^2(Z) = \\left(\\frac{1}{2}|v|^2 + U(x)\\right)^2\n847: $$\n848: \n849: Let $Z_k = (x_k, v_k)$ and track the evolution:\n850: - After B: $(x', v_k)$ where $x' = x_k + \\frac{\\Delta t}{2} v_k$\n851: - After A: $(x', v')$ where $v' = e^{-\\gamma \\Delta t/2} v_k$\n852: - After O: $(x', v'')$ where $v'' = v' + \\xi$ and $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n853: - After A: $(x', v''')$ where $v''' = e^{-\\gamma \\Delta t/2} v''$\n854: - After B: $(x_{k+1}, v''')$ where $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n855: \n856: **Substep 5.3: Expansion of $E^2(Z_{k+1})$**\n857: \n858: The energy at step $k+1$ is:\n859: \n860: $$\n861: E(Z_{k+1}) = \\frac{1}{2}|v'''|^2 + U(x_{k+1})\n862: $$\n863: \n864: Expand $U(x_{k+1})$ using Taylor expansion around $x_k$:\n865: \n866: $$\n867: U(x_{k+1}) = U(x_k) + \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n868: $$\n869: \n870: where $\\xi$ is between $x_k$ and $x_{k+1}$.\n871: \n872: Since $|x_{k+1} - x_k| = O(\\Delta t |v_k|)$, we have:\n873: \n874: $$\n875: U(x_{k+1}) = U(x_k) + O(\\Delta t |v_k| |\\nabla U(x_k)|) + O((\\Delta t)^2 |v_k|^2 \\|\\nabla^2 U\\|)\n876: $$\n877: \n878: For $|v'''|^2$, after the A-O-A composition:\n879: \n880: $$\n881: |v'''|^2 = e^{-\\gamma \\Delta t} |v_k|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma} + O(\\Delta t |v_k| |\\xi|)\n882: $$\n883: \n884: where $\\mathbb{E}[|\\xi|^2] = (1-e^{-\\gamma \\Delta t})\\frac{d\\sigma^2}{\\gamma}$.\n885: \n886: **Substep 5.4: Control of $\\mathbb{E}[V(Z_{k+1}) | Z_k]$ for large $V(Z_k)$**\n887: \n888: For large energy $E(Z_k)$, the key observation is:\n889: \n890: 1. **Dissipation from friction**: The velocity magnitude decays by factor $e^{-\\gamma \\Delta t} \\approx 1 - \\gamma \\Delta t$\n891: 2. **Heating from noise**: The noise adds energy $\\sim d\\sigma^2/(2\\gamma)$\n892: 3. **Potential growth**: The potential can increase, but confinement controls this\n893: \n894: Combining these effects, for large $E(Z_k)$:\n895: \n896: $$\n897: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq E(Z_k) - \\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n898: $$\n899: \n900: where $\\kappa_E \\sim \\gamma$ (friction) and $C_E$ accounts for noise and confinement.\n901: \n902: For $V(Z_k) = E^2(Z_k)$, we need to control:\n903: \n904: $$\n905: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = \\mathbb{E}[(E(Z_k) + \\Delta E)^2 | Z_k]\n906: $$\n907: \n908: where $\\Delta E := E(Z_{k+1}) - E(Z_k)$.\n909: \n910: Expanding:\n911: \n912: $$\n913: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = E^2(Z_k) + 2 E(Z_k) \\mathbb{E}[\\Delta E | Z_k] + \\mathbb{E}[(\\Delta E)^2 | Z_k]\n914: $$\n915: \n916: **Substep 5.5: Bound the terms**\n917: \n918: From the first-moment analysis:\n919: \n920: $$\n921: \\mathbb{E}[\\Delta E | Z_k] \\leq -\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n922: $$\n923: \n924: For the second term, we need to bound the variance of the energy change. We will derive this carefully.\n925: \n926: **Proof of variance bound**: Recall $\\Delta E = E(Z_{k+1}) - E(Z_k)$ where the BAOAB evolution takes $Z_k = (x_k, v_k)$ to $Z_{k+1} = (x_{k+1}, v''')$ through:\n927: - B: $x' = x_k + \\frac{\\Delta t}{2} v_k$\n928: - A: $v' = e^{-\\gamma \\Delta t/2} v_k$\n929: - O: $v'' = v' + \\xi$ where $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n930: - A: $v''' = e^{-\\gamma \\Delta t/2} v''$\n931: - B: $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n932: \n933: The energy change is:\n934: \n935: $$\n936: \\Delta E = \\frac{1}{2}(|v'''|^2 - |v_k|^2) + (U(x_{k+1}) - U(x_k))\n937: $$\n938: \n939: **Velocity contribution**: After A-O-A composition:\n940: \n941: $$\n942: v''' = e^{-\\gamma \\Delta t/2}(e^{-\\gamma \\Delta t/2} v_k + \\xi) = e^{-\\gamma \\Delta t} v_k + e^{-\\gamma \\Delta t/2} \\xi\n943: $$\n944: \n945: Therefore:\n946: \n947: $$\n948: |v'''|^2 = e^{-2\\gamma \\Delta t} |v_k|^2 + 2 e^{-3\\gamma \\Delta t/2} \\langle v_k, \\xi \\rangle + e^{-\\gamma \\Delta t} |\\xi|^2\n949: $$\n950: \n951: The variance of the velocity contribution:\n952: \n953: $$\n954: \\text{Var}[\\frac{1}{2}(|v'''|^2 - |v_k|^2) | Z_k] \\leq C_v (\\Delta t)^2 |v_k|^4 + C'_v \\Delta t |v_k|^2 + C''_v \\Delta t\n955: $$\n956: \n957: where we used $\\mathbb{E}[|\\xi|^2] = O(\\Delta t)$, $\\mathbb{E}[|\\xi|^4] = O((\\Delta t)^2)$, and $\\mathbb{E}[\\langle v_k, \\xi \\rangle^2] = |v_k|^2 \\mathbb{E}[|\\xi|^2] = O(\\Delta t |v_k|^2)$.\n958: \n959: **Potential contribution**: Using Taylor expansion:\n960: \n961: $$\n962: U(x_{k+1}) - U(x_k) = \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n963: $$\n964: \n965: Since $|x_{k+1} - x_k| = O(\\Delta t (|v_k| + |v'''|)) = O(\\Delta t |v_k|) + O((\\Delta t)^{3/2})$, we have:\n966: \n967: $$\n968: \\text{Var}[U(x_{k+1}) - U(x_k) | Z_k] \\leq C_U (\\Delta t)^2 |v_k|^2 \\|\\nabla U\\|^2 + C'_U \\Delta t \\|\\nabla U\\|^2\n969: $$\n970: \n971: **Cross-term**: The expansion $(\\Delta E)^2 = (\\Delta E_v)^2 + (\\Delta E_U)^2 + 2 \\Delta E_v \\Delta E_U$ includes a cross-term. By Cauchy-Schwarz:\n972: \n973: $$\n974: 2|\\mathbb{E}[\\Delta E_v \\Delta E_U | Z_k]| \\leq 2\\sqrt{\\text{Var}[\\Delta E_v | Z_k] \\cdot \\text{Var}[\\Delta E_U | Z_k]} \\leq \\text{Var}[\\Delta E_v | Z_k] + \\text{Var}[\\Delta E_U | Z_k]\n975: $$\n976: \n977: This is absorbed into the bounds for the squared terms.\n978: \n979: **Combine**: Using $|v_k|^2 \\leq 2 E(Z_k)$ and combining all terms (velocity, potential, and cross-term):\n980: \n981: $$\n982: \\mathbb{E}[(\\Delta E)^2 | Z_k] \\leq C_{\\text{var}} \\Delta t (1 + E(Z_k))\n983: $$\n984: \n985: where $C_{\\text{var}} = 2\\max\\{C_v + C_U, C'_v + C'_U, C''_v\\}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|, \\|\\nabla^2 U\\|$.\n986: \n987: Combining:\n988: \n989: $$\n990: \\begin{align*}\n991: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) + 2 E(Z_k) (-\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t) + C_{\\text{var}} \\Delta t (1 + E(Z_k)) \\\\\n992: &= E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) + C_{\\text{var}} \\Delta t\n993: \\end{align*}\n994: $$\n995: \n996: **Handle the linear term using Young's inequality**: The term $(2 C_E + C_{\\text{var}}) \\Delta t E(Z_k)$ grows with $E(Z_k)$ and cannot be absorbed into a constant. We use Young's inequality: for any $\\epsilon > 0$,\n997: \n998: $$\n999: E(Z_k) \\leq \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon}\n1000: $$\n1001: \n1002: Therefore:\n1003: \n1004: $$\n1005: (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) \\leq (2 C_E + C_{\\text{var}}) \\Delta t \\left[ \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon} \\right]\n1006: $$\n1007: \n1008: **Choose $\\epsilon$ to absorb into dissipation**: Set\n1009: \n1010: $$\n1011: \\epsilon := \\frac{\\kappa_E}{2 C_E + C_{\\text{var}}}\n1012: $$\n1013: \n1014: Then:\n1015: \n1016: $$\n1017: (2 C_E + C_{\\text{var}}) \\Delta t \\epsilon E^2(Z_k) = \\kappa_E \\Delta t E^2(Z_k)\n1018: $$\n1019: \n1020: Substituting back:\n1021: \n1022: $$\n1023: \\begin{align*}\n1024: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + \\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t \\cdot \\frac{1}{4\\epsilon} + C_{\\text{var}} \\Delta t \\\\\n1025: &= E^2(Z_k) - \\kappa_E \\Delta t E^2(Z_k) + \\left[ \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}} \\right] \\Delta t \\\\\n1026: &= (1 - \\kappa_E \\Delta t) E^2(Z_k) + C'_4 \\Delta t\n1027: \\end{align*}\n1028: $$\n1029: \n1030: where:\n1031: \n1032: $$\n1033: C'_4 := \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\n1034: $$\n1035: \n1036: This gives the Lyapunov inequality with $\\kappa_4 := \\kappa_E$ and $C_4 := C'_4$.\n1037: \n1038: **Substep 5.6: Stationary second moment**\n1039: \n1040: At stationarity:\n1041: \n1042: $$\n1043: \\mathbb{E}_{\\nu^{\\Delta t}} [E^2(Z)] \\leq \\frac{C_4}{\\kappa_4} = \\frac{C'_4}{\\kappa_E} = \\frac{1}{\\kappa_E}\\left[\\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\\right]\n1044: $$\n1045: \n1046: **Substep 5.7: From $E^2$ to fourth moment**\n1047: \n1048: Since $E(Z) = \\frac{1}{2}|v|^2 + U(x)$, we have:\n1049: \n1050: $$\n1051: |Z|^4 = (|x|^2 + |v|^2)^2 \\leq C_{\\text{coeff}} (|v|^4 + |x|^4)\n1052: $$\n1053: \n1054: By confinement, $U(x) \\geq \\kappa_{\\text{conf}} |x|^2 - C_{\\text{conf}}$, so:\n1055: \n1056: $$\n1057: |x|^2 \\leq \\frac{1}{\\kappa_{\\text{conf}}} (U(x) + C_{\\text{conf}}) \\leq \\frac{1}{\\kappa_{\\text{conf}}} (E(Z) + C_{\\text{conf}})\n1058: $$\n1059: \n1060: Therefore:\n1061: \n1062: $$\n1063: |x|^4 \\leq \\frac{1}{\\kappa_{\\text{conf}}^2} (E(Z) + C_{\\text{conf}})^2 \\leq \\frac{2}{\\kappa_{\\text{conf}}^2} (E^2(Z) + C_{\\text{conf}}^2)\n1064: $$\n1065: \n1066: Similarly, $|v|^4 \\leq 4 E^2(Z)$ since $|v|^2 \\leq 2 E(Z)$.\n1067: \n1068: Combining:\n1069: \n1070: $$\n1071: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq C_{\\text{coeff}} \\left( 4 \\mathbb{E}[E^2(Z)] + \\frac{2}{\\kappa_{\\text{conf}}^2} (\\mathbb{E}[E^2(Z)] + C_{\\text{conf}}^2) \\right)\n1072: $$\n1073: \n1074: $$\n1075: \\leq M_4 := C_{\\text{coeff}} \\left( 4 + \\frac{2}{\\kappa_{\\text{conf}}^2} \\right) \\frac{C_4}{\\kappa_4} + \\frac{2 C_{\\text{coeff}} C_{\\text{conf}}^2}{\\kappa_{\\text{conf}}^2}\n1076: $$\n1077: ",
      "metadata": {
        "label": "proof-prop-fourth-moment-baoab"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "references": [
        "thm-energy-bounds"
      ],
      "raw_directive": "755: :::\n756: \n757: :::{prf:proof}\n758: :label: proof-prop-fourth-moment-baoab\n759: \n760: The proof uses a discrete-time Lyapunov argument on the squared energy of the system. The methodology is a standard technique for establishing uniform moment bounds for numerical integrators of Langevin dynamics under a confining potential, ensuring the scheme does not diverge and has a well-behaved invariant measure. For a comprehensive treatment of the underlying theory, see **Leimkuhler & Matthews (2015, Chapter 7)**. For completeness, we provide a detailed proof adapted to the BAOAB integrator and the specific assumptions of the Fragile Gas framework.\n761: \n762: **Step 1: Energy functional**\n763: \n764: Define the discrete-time energy:\n765: \n766: $$\n767: E(Z) := \\frac{1}{2}|v|^2 + U(x)\n768: $$\n769: \n770: From the energy bounds for the continuous-time Langevin dynamics ({prf:ref}`thm-energy-bounds`), we have:\n771: \n772: $$\n773: \\mathbb{E}_{\\nu^{\\text{cont}}} [E(Z)] = \\mathbb{E}_{\\nu^{\\text{cont}}} \\left[\\frac{1}{2}|v|^2 + U(x)\\right] < \\infty\n774: $$\n775: \n776: **Step 2: BAOAB energy evolution**\n777: \n778: The BAOAB integrator consists of:\n779: - **B step** (position): $x_{k+1/5} = x_k + \\frac{\\Delta t}{2} v_k$\n780: - **A step** (friction): $v_{k+2/5} = e^{-\\gamma \\Delta t/2} v_{k+1/5}$\n781: - **O step** (Ornstein-Uhlenbeck): $v_{k+3/5} = v_{k+2/5} + \\sqrt{1 - e^{-\\gamma \\Delta t}} \\xi_k$ where $\\xi_k \\sim \\mathcal{N}(0, \\frac{\\sigma^2}{\\gamma} I)$\n782: - **A step** (friction): $v_{k+4/5} = e^{-\\gamma \\Delta t/2} v_{k+3/5}$\n783: - **B step** (position): $x_{k+1} = x_{k+1/5} + \\frac{\\Delta t}{2} v_{k+4/5}$\n784: \n785: For the O-step (where noise is added), the expected energy change is:\n786: \n787: $$\n788: \\mathbb{E}[|v_{k+3/5}|^2] = |v_{k+2/5}|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma}\n789: $$\n790: \n791: where $d$ is the dimension.\n792: \n793: **Step 3: Energy dissipation from drift**\n794: \n795: The A-steps provide exponential friction:\n796: \n797: $$\n798: |v_{k+2/5}|^2 = e^{-\\gamma \\Delta t} |v_{k+1/5}|^2 \\leq |v_{k+1/5}|^2\n799: $$\n800: \n801: The B-steps change position but not velocity magnitude. However, they couple velocity to the potential gradient.\n802: \n803: By the confinement condition:\n804: \n805: $$\n806: \\mathbb{E}[\\Delta U] \\approx \\mathbb{E}[\\langle \\nabla U(x_k), \\Delta x_k \\rangle] = \\frac{\\Delta t}{2} \\mathbb{E}[\\langle \\nabla U(x_k), v_k \\rangle]\n807: $$\n808: \n809: For large $|x|$, confinement gives $\\langle x, \\nabla U(x) \\rangle \\geq \\kappa_{\\text{conf}} |x|^2$, providing a restoring force.\n810: \n811: **Step 4: Lyapunov bound**\n812: \n813: Combining the heating (O-step) and dissipation (friction + confinement), the energy satisfies a Lyapunov inequality:\n814: \n815: $$\n816: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_E \\Delta t) E(Z_k) + C_E \\Delta t\n817: $$\n818: \n819: for some constants $\\kappa_E, C_E > 0$ (dependent on $\\gamma, \\sigma, \\kappa_{\\text{conf}}$) when $\\Delta t$ is sufficiently small.\n820: \n821: At stationarity ($k \\to \\infty$):\n822: \n823: $$\n824: \\mathbb{E}_{\\nu^{\\Delta t}} [E(Z)] \\leq \\frac{C_E}{\\kappa_E}\n825: $$\n826: \n827: **Step 5: From energy to fourth moment (Lyapunov on $E^2$)**\n828: \n829: To rigorously bound the fourth moment, we use a Lyapunov argument on $E^2(Z) = (\\frac{1}{2}|v|^2 + U(x))^2$.\n830: \n831: **Substep 5.1: Lyapunov inequality for $E^2$**\n832: \n833: We will show:\n834: \n835: $$\n836: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] \\leq (1 - \\kappa_4 \\Delta t) E^2(Z_k) + C_4 \\Delta t\n837: $$\n838: \n839: for some constants $\\kappa_4, C_4 > 0$ when $\\Delta t$ is sufficiently small.\n840: \n841: **Substep 5.2: Direct analysis of $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$**\n842: \n843: We will compute $\\mathbb{E}[E^2(Z_{k+1}) | Z_k]$ by tracking the evolution through all five BAOAB substeps. Define:\n844: \n845: $$\n846: V(Z) := E^2(Z) = \\left(\\frac{1}{2}|v|^2 + U(x)\\right)^2\n847: $$\n848: \n849: Let $Z_k = (x_k, v_k)$ and track the evolution:\n850: - After B: $(x', v_k)$ where $x' = x_k + \\frac{\\Delta t}{2} v_k$\n851: - After A: $(x', v')$ where $v' = e^{-\\gamma \\Delta t/2} v_k$\n852: - After O: $(x', v'')$ where $v'' = v' + \\xi$ and $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n853: - After A: $(x', v''')$ where $v''' = e^{-\\gamma \\Delta t/2} v''$\n854: - After B: $(x_{k+1}, v''')$ where $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n855: \n856: **Substep 5.3: Expansion of $E^2(Z_{k+1})$**\n857: \n858: The energy at step $k+1$ is:\n859: \n860: $$\n861: E(Z_{k+1}) = \\frac{1}{2}|v'''|^2 + U(x_{k+1})\n862: $$\n863: \n864: Expand $U(x_{k+1})$ using Taylor expansion around $x_k$:\n865: \n866: $$\n867: U(x_{k+1}) = U(x_k) + \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n868: $$\n869: \n870: where $\\xi$ is between $x_k$ and $x_{k+1}$.\n871: \n872: Since $|x_{k+1} - x_k| = O(\\Delta t |v_k|)$, we have:\n873: \n874: $$\n875: U(x_{k+1}) = U(x_k) + O(\\Delta t |v_k| |\\nabla U(x_k)|) + O((\\Delta t)^2 |v_k|^2 \\|\\nabla^2 U\\|)\n876: $$\n877: \n878: For $|v'''|^2$, after the A-O-A composition:\n879: \n880: $$\n881: |v'''|^2 = e^{-\\gamma \\Delta t} |v_k|^2 + (1 - e^{-\\gamma \\Delta t}) \\frac{d\\sigma^2}{\\gamma} + O(\\Delta t |v_k| |\\xi|)\n882: $$\n883: \n884: where $\\mathbb{E}[|\\xi|^2] = (1-e^{-\\gamma \\Delta t})\\frac{d\\sigma^2}{\\gamma}$.\n885: \n886: **Substep 5.4: Control of $\\mathbb{E}[V(Z_{k+1}) | Z_k]$ for large $V(Z_k)$**\n887: \n888: For large energy $E(Z_k)$, the key observation is:\n889: \n890: 1. **Dissipation from friction**: The velocity magnitude decays by factor $e^{-\\gamma \\Delta t} \\approx 1 - \\gamma \\Delta t$\n891: 2. **Heating from noise**: The noise adds energy $\\sim d\\sigma^2/(2\\gamma)$\n892: 3. **Potential growth**: The potential can increase, but confinement controls this\n893: \n894: Combining these effects, for large $E(Z_k)$:\n895: \n896: $$\n897: \\mathbb{E}[E(Z_{k+1}) | Z_k] \\leq E(Z_k) - \\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n898: $$\n899: \n900: where $\\kappa_E \\sim \\gamma$ (friction) and $C_E$ accounts for noise and confinement.\n901: \n902: For $V(Z_k) = E^2(Z_k)$, we need to control:\n903: \n904: $$\n905: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = \\mathbb{E}[(E(Z_k) + \\Delta E)^2 | Z_k]\n906: $$\n907: \n908: where $\\Delta E := E(Z_{k+1}) - E(Z_k)$.\n909: \n910: Expanding:\n911: \n912: $$\n913: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] = E^2(Z_k) + 2 E(Z_k) \\mathbb{E}[\\Delta E | Z_k] + \\mathbb{E}[(\\Delta E)^2 | Z_k]\n914: $$\n915: \n916: **Substep 5.5: Bound the terms**\n917: \n918: From the first-moment analysis:\n919: \n920: $$\n921: \\mathbb{E}[\\Delta E | Z_k] \\leq -\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t\n922: $$\n923: \n924: For the second term, we need to bound the variance of the energy change. We will derive this carefully.\n925: \n926: **Proof of variance bound**: Recall $\\Delta E = E(Z_{k+1}) - E(Z_k)$ where the BAOAB evolution takes $Z_k = (x_k, v_k)$ to $Z_{k+1} = (x_{k+1}, v''')$ through:\n927: - B: $x' = x_k + \\frac{\\Delta t}{2} v_k$\n928: - A: $v' = e^{-\\gamma \\Delta t/2} v_k$\n929: - O: $v'' = v' + \\xi$ where $\\xi \\sim \\mathcal{N}(0, (1-e^{-\\gamma \\Delta t})\\frac{\\sigma^2}{\\gamma} I)$\n930: - A: $v''' = e^{-\\gamma \\Delta t/2} v''$\n931: - B: $x_{k+1} = x' + \\frac{\\Delta t}{2} v'''$\n932: \n933: The energy change is:\n934: \n935: $$\n936: \\Delta E = \\frac{1}{2}(|v'''|^2 - |v_k|^2) + (U(x_{k+1}) - U(x_k))\n937: $$\n938: \n939: **Velocity contribution**: After A-O-A composition:\n940: \n941: $$\n942: v''' = e^{-\\gamma \\Delta t/2}(e^{-\\gamma \\Delta t/2} v_k + \\xi) = e^{-\\gamma \\Delta t} v_k + e^{-\\gamma \\Delta t/2} \\xi\n943: $$\n944: \n945: Therefore:\n946: \n947: $$\n948: |v'''|^2 = e^{-2\\gamma \\Delta t} |v_k|^2 + 2 e^{-3\\gamma \\Delta t/2} \\langle v_k, \\xi \\rangle + e^{-\\gamma \\Delta t} |\\xi|^2\n949: $$\n950: \n951: The variance of the velocity contribution:\n952: \n953: $$\n954: \\text{Var}[\\frac{1}{2}(|v'''|^2 - |v_k|^2) | Z_k] \\leq C_v (\\Delta t)^2 |v_k|^4 + C'_v \\Delta t |v_k|^2 + C''_v \\Delta t\n955: $$\n956: \n957: where we used $\\mathbb{E}[|\\xi|^2] = O(\\Delta t)$, $\\mathbb{E}[|\\xi|^4] = O((\\Delta t)^2)$, and $\\mathbb{E}[\\langle v_k, \\xi \\rangle^2] = |v_k|^2 \\mathbb{E}[|\\xi|^2] = O(\\Delta t |v_k|^2)$.\n958: \n959: **Potential contribution**: Using Taylor expansion:\n960: \n961: $$\n962: U(x_{k+1}) - U(x_k) = \\langle \\nabla U(x_k), x_{k+1} - x_k \\rangle + \\frac{1}{2} \\langle x_{k+1} - x_k, \\nabla^2 U(\\xi) (x_{k+1} - x_k) \\rangle\n963: $$\n964: \n965: Since $|x_{k+1} - x_k| = O(\\Delta t (|v_k| + |v'''|)) = O(\\Delta t |v_k|) + O((\\Delta t)^{3/2})$, we have:\n966: \n967: $$\n968: \\text{Var}[U(x_{k+1}) - U(x_k) | Z_k] \\leq C_U (\\Delta t)^2 |v_k|^2 \\|\\nabla U\\|^2 + C'_U \\Delta t \\|\\nabla U\\|^2\n969: $$\n970: \n971: **Cross-term**: The expansion $(\\Delta E)^2 = (\\Delta E_v)^2 + (\\Delta E_U)^2 + 2 \\Delta E_v \\Delta E_U$ includes a cross-term. By Cauchy-Schwarz:\n972: \n973: $$\n974: 2|\\mathbb{E}[\\Delta E_v \\Delta E_U | Z_k]| \\leq 2\\sqrt{\\text{Var}[\\Delta E_v | Z_k] \\cdot \\text{Var}[\\Delta E_U | Z_k]} \\leq \\text{Var}[\\Delta E_v | Z_k] + \\text{Var}[\\Delta E_U | Z_k]\n975: $$\n976: \n977: This is absorbed into the bounds for the squared terms.\n978: \n979: **Combine**: Using $|v_k|^2 \\leq 2 E(Z_k)$ and combining all terms (velocity, potential, and cross-term):\n980: \n981: $$\n982: \\mathbb{E}[(\\Delta E)^2 | Z_k] \\leq C_{\\text{var}} \\Delta t (1 + E(Z_k))\n983: $$\n984: \n985: where $C_{\\text{var}} = 2\\max\\{C_v + C_U, C'_v + C'_U, C''_v\\}$ depends on $\\gamma, \\sigma, \\|\\nabla U\\|, \\|\\nabla^2 U\\|$.\n986: \n987: Combining:\n988: \n989: $$\n990: \\begin{align*}\n991: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) + 2 E(Z_k) (-\\kappa_E \\Delta t E(Z_k) + C_E \\Delta t) + C_{\\text{var}} \\Delta t (1 + E(Z_k)) \\\\\n992: &= E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) + C_{\\text{var}} \\Delta t\n993: \\end{align*}\n994: $$\n995: \n996: **Handle the linear term using Young's inequality**: The term $(2 C_E + C_{\\text{var}}) \\Delta t E(Z_k)$ grows with $E(Z_k)$ and cannot be absorbed into a constant. We use Young's inequality: for any $\\epsilon > 0$,\n997: \n998: $$\n999: E(Z_k) \\leq \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon}\n1000: $$\n1001: \n1002: Therefore:\n1003: \n1004: $$\n1005: (2 C_E + C_{\\text{var}}) \\Delta t E(Z_k) \\leq (2 C_E + C_{\\text{var}}) \\Delta t \\left[ \\epsilon E^2(Z_k) + \\frac{1}{4\\epsilon} \\right]\n1006: $$\n1007: \n1008: **Choose $\\epsilon$ to absorb into dissipation**: Set\n1009: \n1010: $$\n1011: \\epsilon := \\frac{\\kappa_E}{2 C_E + C_{\\text{var}}}\n1012: $$\n1013: \n1014: Then:\n1015: \n1016: $$\n1017: (2 C_E + C_{\\text{var}}) \\Delta t \\epsilon E^2(Z_k) = \\kappa_E \\Delta t E^2(Z_k)\n1018: $$\n1019: \n1020: Substituting back:\n1021: \n1022: $$\n1023: \\begin{align*}\n1024: \\mathbb{E}[E^2(Z_{k+1}) | Z_k] &\\leq E^2(Z_k) - 2\\kappa_E \\Delta t E^2(Z_k) + \\kappa_E \\Delta t E^2(Z_k) + (2 C_E + C_{\\text{var}}) \\Delta t \\cdot \\frac{1}{4\\epsilon} + C_{\\text{var}} \\Delta t \\\\\n1025: &= E^2(Z_k) - \\kappa_E \\Delta t E^2(Z_k) + \\left[ \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}} \\right] \\Delta t \\\\\n1026: &= (1 - \\kappa_E \\Delta t) E^2(Z_k) + C'_4 \\Delta t\n1027: \\end{align*}\n1028: $$\n1029: \n1030: where:\n1031: \n1032: $$\n1033: C'_4 := \\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\n1034: $$\n1035: \n1036: This gives the Lyapunov inequality with $\\kappa_4 := \\kappa_E$ and $C_4 := C'_4$.\n1037: \n1038: **Substep 5.6: Stationary second moment**\n1039: \n1040: At stationarity:\n1041: \n1042: $$\n1043: \\mathbb{E}_{\\nu^{\\Delta t}} [E^2(Z)] \\leq \\frac{C_4}{\\kappa_4} = \\frac{C'_4}{\\kappa_E} = \\frac{1}{\\kappa_E}\\left[\\frac{(2 C_E + C_{\\text{var}})^2}{4\\kappa_E} + C_{\\text{var}}\\right]\n1044: $$\n1045: \n1046: **Substep 5.7: From $E^2$ to fourth moment**\n1047: \n1048: Since $E(Z) = \\frac{1}{2}|v|^2 + U(x)$, we have:\n1049: \n1050: $$\n1051: |Z|^4 = (|x|^2 + |v|^2)^2 \\leq C_{\\text{coeff}} (|v|^4 + |x|^4)\n1052: $$\n1053: \n1054: By confinement, $U(x) \\geq \\kappa_{\\text{conf}} |x|^2 - C_{\\text{conf}}$, so:\n1055: \n1056: $$\n1057: |x|^2 \\leq \\frac{1}{\\kappa_{\\text{conf}}} (U(x) + C_{\\text{conf}}) \\leq \\frac{1}{\\kappa_{\\text{conf}}} (E(Z) + C_{\\text{conf}})\n1058: $$\n1059: \n1060: Therefore:\n1061: \n1062: $$\n1063: |x|^4 \\leq \\frac{1}{\\kappa_{\\text{conf}}^2} (E(Z) + C_{\\text{conf}})^2 \\leq \\frac{2}{\\kappa_{\\text{conf}}^2} (E^2(Z) + C_{\\text{conf}}^2)\n1064: $$\n1065: \n1066: Similarly, $|v|^4 \\leq 4 E^2(Z)$ since $|v|^2 \\leq 2 E(Z)$.\n1067: \n1068: Combining:\n1069: \n1070: $$\n1071: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq C_{\\text{coeff}} \\left( 4 \\mathbb{E}[E^2(Z)] + \\frac{2}{\\kappa_{\\text{conf}}^2} (\\mathbb{E}[E^2(Z)] + C_{\\text{conf}}^2) \\right)\n1072: $$\n1073: \n1074: $$\n1075: \\leq M_4 := C_{\\text{coeff}} \\left( 4 + \\frac{2}{\\kappa_{\\text{conf}}^2} \\right) \\frac{C_4}{\\kappa_4} + \\frac{2 C_{\\text{coeff}} C_{\\text{conf}}^2}{\\kappa_{\\text{conf}}^2}\n1076: $$\n1077: \n1078: This is finite and depends only on $\\gamma, \\sigma, \\kappa_{\\text{conf}}, d$, independent of $\\Delta t$ for $\\Delta t < \\Delta t_0$ (sufficiently small).",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## Part II: Time Discretization Error Bounds"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-baoab-weak-error",
      "title": null,
      "start_line": 1116,
      "end_line": 1195,
      "header_lines": [
        1117
      ],
      "content_start": 1119,
      "content_end": 1194,
      "content": "1119: :label: proof-lem-baoab-weak-error\n1120: \n1121: The proof uses backward error analysis and Taylor expansion of the BAOAB integrator.\n1122: \n1123: **Step 1: Local truncation error**\n1124: \n1125: The BAOAB integrator is a splitting scheme that can be written as:\n1126: \n1127: $$\n1128: Z_{k+1} = \\Phi_{\\text{BAOAB}}^{\\Delta t}(Z_k) = \\Phi_B^{\\Delta t/2} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_O^{\\Delta t} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_B^{\\Delta t/2}(Z_k)\n1129: $$\n1130: \n1131: where each $\\Phi$ corresponds to one of the sub-steps.\n1132: \n1133: By Strang splitting theory (second-order symmetric splitting), the local truncation error is $O((\\Delta t)^3)$ for a single step.\n1134: \n1135: **Step 2: Weak generator expansion**\n1136: \n1137: For a test function $\\phi \\in C^4(\\Omega)$, the weak error evolution satisfies:\n1138: \n1139: $$\n1140: \\frac{d}{dt} \\mathbb{E}[\\phi(Z_k)] = \\mathbb{E}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\phi(Z_k)]\n1141: $$\n1142: \n1143: where $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$ is the discrete-time generator.\n1144: \n1145: The continuous-time generator is:\n1146: \n1147: $$\n1148: \\mathcal{L} \\phi = v \\cdot \\nabla_x \\phi - \\nabla U(x) \\cdot \\nabla_v \\phi - \\gamma v \\cdot \\nabla_v \\phi + \\frac{\\sigma^2}{2} \\Delta_v \\phi\n1149: $$\n1150: \n1151: By backward error analysis (Bou-Rabee & Sanz-Serna 2017, Theorem 3.1), the BAOAB generator can be expanded as:\n1152: \n1153: $$\n1154: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1155: $$\n1156: \n1157: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients (depending on derivatives of $U$ up to order 3).\n1158: \n1159: **Note**: The remainder is $O((\\Delta t)^4)$, not $O((\\Delta t)^3)$, because BAOAB is a **time-symmetric** integrator. For symmetric schemes, the expansion contains only even powers of $\\Delta t$.\n1160: \n1161: **Step 3: Gronwall argument**\n1162: \n1163: Let $\\varepsilon_k := \\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]$ be the weak error at time $t_k = k\\Delta t$.\n1164: \n1165: From the generator expansion:\n1166: \n1167: $$\n1168: \\varepsilon_{k+1} = \\varepsilon_k + \\Delta t \\cdot \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] + O((\\Delta t)^2)\n1169: $$\n1170: \n1171: The generator difference contributes:\n1172: \n1173: $$\n1174: \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] = (\\Delta t)^2 \\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)] + O((\\Delta t)^4)\n1175: $$\n1176: \n1177: Using the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`):\n1178: \n1179: $$\n1180: |\\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)]| \\leq C_2 \\|\\phi\\|_{C^4} \\mathbb{E}[|Z_k|^4]^{1/2} \\leq C_2 \\|\\phi\\|_{C^4} M_4^{1/2}\n1181: $$\n1182: \n1183: Therefore:\n1184: \n1185: $$\n1186: |\\varepsilon_{k+1}| \\leq |\\varepsilon_k| + C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 + O((\\Delta t)^4)\n1187: $$\n1188: \n1189: With $\\varepsilon_0 = 0$, summing from $k=0$ to $k=K-1$ where $K\\Delta t = T$:\n1190: \n1191: $$\n1192: |\\varepsilon_K| \\leq K \\cdot C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 = C_{\\text{weak}} \\|\\phi\\|_{C^4} (\\Delta t)^2 \\cdot T\n1193: $$\n1194: ",
      "metadata": {
        "label": "proof-lem-baoab-weak-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "references": [
        "prop-fourth-moment-baoab"
      ],
      "raw_directive": "1116: :::\n1117: \n1118: :::{prf:proof}\n1119: :label: proof-lem-baoab-weak-error\n1120: \n1121: The proof uses backward error analysis and Taylor expansion of the BAOAB integrator.\n1122: \n1123: **Step 1: Local truncation error**\n1124: \n1125: The BAOAB integrator is a splitting scheme that can be written as:\n1126: \n1127: $$\n1128: Z_{k+1} = \\Phi_{\\text{BAOAB}}^{\\Delta t}(Z_k) = \\Phi_B^{\\Delta t/2} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_O^{\\Delta t} \\circ \\Phi_A^{\\Delta t/2} \\circ \\Phi_B^{\\Delta t/2}(Z_k)\n1129: $$\n1130: \n1131: where each $\\Phi$ corresponds to one of the sub-steps.\n1132: \n1133: By Strang splitting theory (second-order symmetric splitting), the local truncation error is $O((\\Delta t)^3)$ for a single step.\n1134: \n1135: **Step 2: Weak generator expansion**\n1136: \n1137: For a test function $\\phi \\in C^4(\\Omega)$, the weak error evolution satisfies:\n1138: \n1139: $$\n1140: \\frac{d}{dt} \\mathbb{E}[\\phi(Z_k)] = \\mathbb{E}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\phi(Z_k)]\n1141: $$\n1142: \n1143: where $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$ is the discrete-time generator.\n1144: \n1145: The continuous-time generator is:\n1146: \n1147: $$\n1148: \\mathcal{L} \\phi = v \\cdot \\nabla_x \\phi - \\nabla U(x) \\cdot \\nabla_v \\phi - \\gamma v \\cdot \\nabla_v \\phi + \\frac{\\sigma^2}{2} \\Delta_v \\phi\n1149: $$\n1150: \n1151: By backward error analysis (Bou-Rabee & Sanz-Serna 2017, Theorem 3.1), the BAOAB generator can be expanded as:\n1152: \n1153: $$\n1154: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1155: $$\n1156: \n1157: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients (depending on derivatives of $U$ up to order 3).\n1158: \n1159: **Note**: The remainder is $O((\\Delta t)^4)$, not $O((\\Delta t)^3)$, because BAOAB is a **time-symmetric** integrator. For symmetric schemes, the expansion contains only even powers of $\\Delta t$.\n1160: \n1161: **Step 3: Gronwall argument**\n1162: \n1163: Let $\\varepsilon_k := \\mathbb{E}[\\phi(Z_k)] - \\mathbb{E}[\\phi(Z(k\\Delta t))]$ be the weak error at time $t_k = k\\Delta t$.\n1164: \n1165: From the generator expansion:\n1166: \n1167: $$\n1168: \\varepsilon_{k+1} = \\varepsilon_k + \\Delta t \\cdot \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] + O((\\Delta t)^2)\n1169: $$\n1170: \n1171: The generator difference contributes:\n1172: \n1173: $$\n1174: \\mathbb{E}[(\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} - \\mathcal{L})\\phi(Z_k)] = (\\Delta t)^2 \\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)] + O((\\Delta t)^4)\n1175: $$\n1176: \n1177: Using the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`):\n1178: \n1179: $$\n1180: |\\mathbb{E}[\\mathcal{L}_2 \\phi(Z_k)]| \\leq C_2 \\|\\phi\\|_{C^4} \\mathbb{E}[|Z_k|^4]^{1/2} \\leq C_2 \\|\\phi\\|_{C^4} M_4^{1/2}\n1181: $$\n1182: \n1183: Therefore:\n1184: \n1185: $$\n1186: |\\varepsilon_{k+1}| \\leq |\\varepsilon_k| + C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 + O((\\Delta t)^4)\n1187: $$\n1188: \n1189: With $\\varepsilon_0 = 0$, summing from $k=0$ to $k=K-1$ where $K\\Delta t = T$:\n1190: \n1191: $$\n1192: |\\varepsilon_K| \\leq K \\cdot C_2 M_4^{1/2} \\|\\phi\\|_{C^4} (\\Delta t)^3 = C_{\\text{weak}} \\|\\phi\\|_{C^4} (\\Delta t)^2 \\cdot T\n1193: $$\n1194: \n1195: where $C_{\\text{weak}} = C_2 M_4^{1/2}$.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## Part II: Time Discretization Error Bounds"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-baoab-invariant-measure-error",
      "title": null,
      "start_line": 1220,
      "end_line": 1382,
      "header_lines": [
        1221
      ],
      "content_start": 1223,
      "content_end": 1381,
      "content": "1223: :label: proof-lem-baoab-invariant-measure-error\n1224: \n1225: The proof uses the Poisson equation method and exploits the symmetry of the BAOAB integrator.\n1226: \n1227: **Step 1: The Poisson equation**\n1228: \n1229: For an observable $\\phi \\in C^4$, consider the centered observable:\n1230: \n1231: $$\n1232: \\tilde{\\phi}(z) := \\phi(z) - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]\n1233: $$\n1234: \n1235: The Poisson equation for the continuous-time generator $\\mathcal{L}$ is:\n1236: \n1237: $$\n1238: \\mathcal{L} \\psi = \\tilde{\\phi}\n1239: $$\n1240: \n1241: This equation has a unique solution $\\psi \\in C^{\\infty}(\\Omega)$ under the geometric ergodicity assumption, and moreover $\\mathbb{E}_{\\nu^{\\text{cont}}}[\\psi] = 0$.\n1242: \n1243: **Step 2: Regularity of the Poisson solution**\n1244: \n1245: The key regularity result (from elliptic PDE theory applied to the hypoelliptic operator $\\mathcal{L}$) is:\n1246: \n1247: $$\n1248: \\|\\psi\\|_{C^{k+2}} \\leq \\frac{C_{\\text{reg}}}{\\kappa_{\\text{mix}}^{k+1}} \\|\\tilde{\\phi}\\|_{C^k}\n1249: $$\n1250: \n1251: For $\\phi \\in C^4$, we have:\n1252: \n1253: $$\n1254: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1255: $$\n1256: \n1257: **Step 3: Error decomposition via Poisson equation**\n1258: \n1259: The error between invariant measures can be written using $\\psi$:\n1260: \n1261: $$\n1262: \\begin{align*}\n1263: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\tilde{\\phi}] \\\\\n1264: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\quad \\text{(by Poisson equation)}\n1265: \\end{align*}\n1266: $$\n1267: \n1268: **Step 4: Key identity using invariant measure property**\n1269: \n1270: Since $\\nu^{\\Delta t}$ is the invariant measure of the discrete-time generator $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$, we have:\n1271: \n1272: $$\n1273: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] = 0\n1274: $$\n1275: \n1276: This is because for any function $g$:\n1277: \n1278: $$\n1279: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} g] = \\mathbb{E}_{\\nu^{\\Delta t}}[g(Z_1) - g(Z_0)] = 0\n1280: $$\n1281: \n1282: when $Z_0 \\sim \\nu^{\\Delta t}$ (stationarity).\n1283: \n1284: **Step 5: Apply generator difference**\n1285: \n1286: Combining Steps 3 and 4:\n1287: \n1288: $$\n1289: \\begin{align*}\n1290: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\\\\n1291: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] - \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] \\\\\n1292: &= \\mathbb{E}_{\\nu^{\\Delta t}}[(\\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}) \\psi]\n1293: \\end{align*}\n1294: $$\n1295: \n1296: **Step 6: Use backward error expansion**\n1297: \n1298: From {prf:ref}`lem-baoab-weak-error`, the generator difference satisfies:\n1299: \n1300: $$\n1301: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1302: $$\n1303: \n1304: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients.\n1305: \n1306: Therefore:\n1307: \n1308: $$\n1309: \\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = -(\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1310: $$\n1311: \n1312: **Step 7: Apply generator expansion**\n1313: \n1314: For symmetric splitting schemes like BAOAB, the generator expansion has only even powers:\n1315: \n1316: $$\n1317: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1318: $$\n1319: \n1320: Substituting into Step 5:\n1321: \n1322: $$\n1323: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] = -(\\Delta t)^2 \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi] + O((\\Delta t)^4)\n1324: $$\n1325: \n1326: **Step 8: Bound the expectation uniformly**\n1327: \n1328: The key is to show that $|\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]|$ is bounded uniformly for $\\Delta t$ sufficiently small.\n1329: \n1330: The operator $\\mathcal{L}_2$ is a fourth-order differential operator whose coefficients involve derivatives of the potential $U$ up to order 3. For a solution $\\psi$ of the Poisson equation $\\mathcal{L} \\psi = \\tilde{\\phi}$ with $\\phi \\in C^4$, the regularity result from Step 2 gives:\n1331: \n1332: $$\n1333: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1334: $$\n1335: \n1336: Under the confinement axiom, $|\\mathcal{L}_2 \\psi(Z)|$ grows at most polynomially in $|Z|$:\n1337: \n1338: $$\n1339: |\\mathcal{L}_2 \\psi(Z)| \\leq C_2 \\|\\psi\\|_{C^6} (1 + |Z|^2)\n1340: $$\n1341: \n1342: for some constant $C_2$ depending on $\\|\\nabla^2 U\\|, \\|\\nabla^3 U\\|$.\n1343: \n1344: **Step 9: Use uniform moment bounds**\n1345: \n1346: From the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`), we have:\n1347: \n1348: $$\n1349: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq M_4 < \\infty\n1350: $$\n1351: \n1352: uniformly in $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1353: \n1354: Therefore:\n1355: \n1356: $$\n1357: \\begin{align*}\n1358: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]| &\\leq \\mathbb{E}_{\\nu^{\\Delta t}}[|\\mathcal{L}_2 \\psi(Z)|] \\\\\n1359: &\\leq C_2 \\|\\psi\\|_{C^6} \\mathbb{E}_{\\nu^{\\Delta t}}[1 + |Z|^2] \\\\\n1360: &\\leq C_2 \\|\\psi\\|_{C^6} (1 + M_4^{1/2}) \\\\\n1361: &\\leq C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2})\n1362: \\end{align*}\n1363: $$\n1364: \n1365: **Step 10: Conclude**\n1366: \n1367: Combining Steps 7 and 9:\n1368: \n1369: $$\n1370: \\begin{align*}\n1371: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]| &\\leq (\\Delta t)^2 \\cdot C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2}) + O((\\Delta t)^4) \\\\\n1372: &= C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2 + O((\\Delta t)^4)\n1373: \\end{align*}\n1374: $$\n1375: \n1376: where:\n1377: \n1378: $$\n1379: C_{\\text{inv}} := \\frac{C_2 \\cdot C_{\\text{reg}} (1 + M_4^{1/2})}{\\kappa_{\\text{mix}}^5}\n1380: $$\n1381: ",
      "metadata": {
        "label": "proof-lem-baoab-invariant-measure-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "references": [
        "lem-baoab-weak-error",
        "prop-fourth-moment-baoab"
      ],
      "raw_directive": "1220: :::\n1221: \n1222: :::{prf:proof}\n1223: :label: proof-lem-baoab-invariant-measure-error\n1224: \n1225: The proof uses the Poisson equation method and exploits the symmetry of the BAOAB integrator.\n1226: \n1227: **Step 1: The Poisson equation**\n1228: \n1229: For an observable $\\phi \\in C^4$, consider the centered observable:\n1230: \n1231: $$\n1232: \\tilde{\\phi}(z) := \\phi(z) - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]\n1233: $$\n1234: \n1235: The Poisson equation for the continuous-time generator $\\mathcal{L}$ is:\n1236: \n1237: $$\n1238: \\mathcal{L} \\psi = \\tilde{\\phi}\n1239: $$\n1240: \n1241: This equation has a unique solution $\\psi \\in C^{\\infty}(\\Omega)$ under the geometric ergodicity assumption, and moreover $\\mathbb{E}_{\\nu^{\\text{cont}}}[\\psi] = 0$.\n1242: \n1243: **Step 2: Regularity of the Poisson solution**\n1244: \n1245: The key regularity result (from elliptic PDE theory applied to the hypoelliptic operator $\\mathcal{L}$) is:\n1246: \n1247: $$\n1248: \\|\\psi\\|_{C^{k+2}} \\leq \\frac{C_{\\text{reg}}}{\\kappa_{\\text{mix}}^{k+1}} \\|\\tilde{\\phi}\\|_{C^k}\n1249: $$\n1250: \n1251: For $\\phi \\in C^4$, we have:\n1252: \n1253: $$\n1254: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1255: $$\n1256: \n1257: **Step 3: Error decomposition via Poisson equation**\n1258: \n1259: The error between invariant measures can be written using $\\psi$:\n1260: \n1261: $$\n1262: \\begin{align*}\n1263: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\tilde{\\phi}] \\\\\n1264: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\quad \\text{(by Poisson equation)}\n1265: \\end{align*}\n1266: $$\n1267: \n1268: **Step 4: Key identity using invariant measure property**\n1269: \n1270: Since $\\nu^{\\Delta t}$ is the invariant measure of the discrete-time generator $\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}$, we have:\n1271: \n1272: $$\n1273: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] = 0\n1274: $$\n1275: \n1276: This is because for any function $g$:\n1277: \n1278: $$\n1279: \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} g] = \\mathbb{E}_{\\nu^{\\Delta t}}[g(Z_1) - g(Z_0)] = 0\n1280: $$\n1281: \n1282: when $Z_0 \\sim \\nu^{\\Delta t}$ (stationarity).\n1283: \n1284: **Step 5: Apply generator difference**\n1285: \n1286: Combining Steps 3 and 4:\n1287: \n1288: $$\n1289: \\begin{align*}\n1290: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] \\\\\n1291: &= \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L} \\psi] - \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} \\psi] \\\\\n1292: &= \\mathbb{E}_{\\nu^{\\Delta t}}[(\\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t}) \\psi]\n1293: \\end{align*}\n1294: $$\n1295: \n1296: **Step 6: Use backward error expansion**\n1297: \n1298: From {prf:ref}`lem-baoab-weak-error`, the generator difference satisfies:\n1299: \n1300: $$\n1301: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1302: $$\n1303: \n1304: where $\\mathcal{L}_2$ is a fourth-order differential operator with bounded coefficients.\n1305: \n1306: Therefore:\n1307: \n1308: $$\n1309: \\mathcal{L} - \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = -(\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1310: $$\n1311: \n1312: **Step 7: Apply generator expansion**\n1313: \n1314: For symmetric splitting schemes like BAOAB, the generator expansion has only even powers:\n1315: \n1316: $$\n1317: \\mathcal{L}_{\\text{BAOAB}}^{\\Delta t} = \\mathcal{L} + (\\Delta t)^2 \\mathcal{L}_2 + O((\\Delta t)^4)\n1318: $$\n1319: \n1320: Substituting into Step 5:\n1321: \n1322: $$\n1323: \\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi] = -(\\Delta t)^2 \\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi] + O((\\Delta t)^4)\n1324: $$\n1325: \n1326: **Step 8: Bound the expectation uniformly**\n1327: \n1328: The key is to show that $|\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]|$ is bounded uniformly for $\\Delta t$ sufficiently small.\n1329: \n1330: The operator $\\mathcal{L}_2$ is a fourth-order differential operator whose coefficients involve derivatives of the potential $U$ up to order 3. For a solution $\\psi$ of the Poisson equation $\\mathcal{L} \\psi = \\tilde{\\phi}$ with $\\phi \\in C^4$, the regularity result from Step 2 gives:\n1331: \n1332: $$\n1333: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5}\n1334: $$\n1335: \n1336: Under the confinement axiom, $|\\mathcal{L}_2 \\psi(Z)|$ grows at most polynomially in $|Z|$:\n1337: \n1338: $$\n1339: |\\mathcal{L}_2 \\psi(Z)| \\leq C_2 \\|\\psi\\|_{C^6} (1 + |Z|^2)\n1340: $$\n1341: \n1342: for some constant $C_2$ depending on $\\|\\nabla^2 U\\|, \\|\\nabla^3 U\\|$.\n1343: \n1344: **Step 9: Use uniform moment bounds**\n1345: \n1346: From the fourth-moment bounds ({prf:ref}`prop-fourth-moment-baoab`), we have:\n1347: \n1348: $$\n1349: \\mathbb{E}_{\\nu^{\\Delta t}}[|Z|^4] \\leq M_4 < \\infty\n1350: $$\n1351: \n1352: uniformly in $\\Delta t$ (for $\\Delta t$ sufficiently small).\n1353: \n1354: Therefore:\n1355: \n1356: $$\n1357: \\begin{align*}\n1358: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]| &\\leq \\mathbb{E}_{\\nu^{\\Delta t}}[|\\mathcal{L}_2 \\psi(Z)|] \\\\\n1359: &\\leq C_2 \\|\\psi\\|_{C^6} \\mathbb{E}_{\\nu^{\\Delta t}}[1 + |Z|^2] \\\\\n1360: &\\leq C_2 \\|\\psi\\|_{C^6} (1 + M_4^{1/2}) \\\\\n1361: &\\leq C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2})\n1362: \\end{align*}\n1363: $$\n1364: \n1365: **Step 10: Conclude**\n1366: \n1367: Combining Steps 7 and 9:\n1368: \n1369: $$\n1370: \\begin{align*}\n1371: |\\mathbb{E}_{\\nu^{\\Delta t}}[\\phi] - \\mathbb{E}_{\\nu^{\\text{cont}}}[\\phi]| &\\leq (\\Delta t)^2 \\cdot C_2 \\frac{C_{\\text{reg}} \\|\\phi\\|_{C^4}}{\\kappa_{\\text{mix}}^5} (1 + M_4^{1/2}) + O((\\Delta t)^4) \\\\\n1372: &= C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2 + O((\\Delta t)^4)\n1373: \\end{align*}\n1374: $$\n1375: \n1376: where:\n1377: \n1378: $$\n1379: C_{\\text{inv}} := \\frac{C_2 \\cdot C_{\\text{reg}} (1 + M_4^{1/2})}{\\kappa_{\\text{mix}}^5}\n1380: $$\n1381: \n1382: **The key insight**: The uniform fourth-moment bounds ensure that the expectation $\\mathbb{E}_{\\nu^{\\Delta t}}[\\mathcal{L}_2 \\psi]$ is bounded uniformly in $\\Delta t$. Combined with the generator expansion having only even powers (due to BAOAB's symmetry), this gives the $O((\\Delta t)^2)$ convergence rate.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## Part II: Time Discretization Error Bounds"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-langevin-baoab-discretization-error",
      "title": null,
      "start_line": 1417,
      "end_line": 1470,
      "header_lines": [
        1418
      ],
      "content_start": 1420,
      "content_end": 1469,
      "content": "1420: :label: proof-thm-langevin-baoab-discretization-error\n1421: \n1422: This follows directly from {prf:ref}`lem-baoab-invariant-measure-error` applied to each particle in the N-particle Langevin system.\n1423: \n1424: **Step 1: Single-particle Langevin dynamics**\n1425: \n1426: Each particle $i$ evolves independently via the Langevin SDE:\n1427: \n1428: $$\n1429: \\begin{cases}\n1430: dX_t^{(i)} = V_t^{(i)} dt \\\\\n1431: dV_t^{(i)} = -\\nabla U(X_t^{(i)}) dt - \\gamma V_t^{(i)} dt + \\sigma dW_t^{(i)}\n1432: \\end{cases}\n1433: $$\n1434: \n1435: where $W_t^{(i)}$ are independent Brownian motions.\n1436: \n1437: **Step 2: N-uniformity for non-interacting Langevin dynamics**\n1438: \n1439: The key observation is that **the BAOAB time discretization acts independently on each particle**.\n1440: \n1441: More precisely:\n1442: - **External potential**: The potential $U(x_i)$ is an external (fixed) potential that depends only on the position of particle $i$, not on other particles' positions.\n1443: \n1444: **Crucial clarification**: This N-uniformity analysis applies to the **Euclidean Gas** case where the potential is external. For mean-field interacting potentials (e.g., Adaptive Gas with empirical-measure-dependent potentials), a separate treatment would be required.\n1445: \n1446: - **Independent evolution**: Each particle evolves via its own independent Langevin SDE. The BAOAB discretization of this evolution has constants ($C_{\\text{weak}}, M_4, \\kappa_{\\text{mix}}$) that depend **only** on $U, \\gamma, \\sigma, d$, not on $N$ or on the positions of other particles.\n1447: \n1448: From {prf:ref}`lem-baoab-invariant-measure-error`, we have:\n1449: \n1450: $$\n1451: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)] \\right| \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1452: $$\n1453: \n1454: for each particle $i$, where $C_{\\text{inv}}$ is independent of $N$.\n1455: \n1456: **Step 3: Observable on the N-particle system**\n1457: \n1458: For an observable $\\Phi(Z) = \\frac{1}{N}\\sum_{i=1}^N \\phi(z_i)$:\n1459: \n1460: $$\n1461: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\Phi] \\right| = \\left| \\frac{1}{N} \\sum_{i=1}^N (\\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)]) \\right|\n1462: $$\n1463: \n1464: By exchangeability:\n1465: \n1466: $$\n1467: \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1468: $$\n1469: ",
      "metadata": {
        "label": "proof-thm-langevin-baoab-discretization-error"
      },
      "section": "## Part II: Time Discretization Error Bounds",
      "references": [
        "lem-baoab-invariant-measure-error"
      ],
      "raw_directive": "1417: :::\n1418: \n1419: :::{prf:proof}\n1420: :label: proof-thm-langevin-baoab-discretization-error\n1421: \n1422: This follows directly from {prf:ref}`lem-baoab-invariant-measure-error` applied to each particle in the N-particle Langevin system.\n1423: \n1424: **Step 1: Single-particle Langevin dynamics**\n1425: \n1426: Each particle $i$ evolves independently via the Langevin SDE:\n1427: \n1428: $$\n1429: \\begin{cases}\n1430: dX_t^{(i)} = V_t^{(i)} dt \\\\\n1431: dV_t^{(i)} = -\\nabla U(X_t^{(i)}) dt - \\gamma V_t^{(i)} dt + \\sigma dW_t^{(i)}\n1432: \\end{cases}\n1433: $$\n1434: \n1435: where $W_t^{(i)}$ are independent Brownian motions.\n1436: \n1437: **Step 2: N-uniformity for non-interacting Langevin dynamics**\n1438: \n1439: The key observation is that **the BAOAB time discretization acts independently on each particle**.\n1440: \n1441: More precisely:\n1442: - **External potential**: The potential $U(x_i)$ is an external (fixed) potential that depends only on the position of particle $i$, not on other particles' positions.\n1443: \n1444: **Crucial clarification**: This N-uniformity analysis applies to the **Euclidean Gas** case where the potential is external. For mean-field interacting potentials (e.g., Adaptive Gas with empirical-measure-dependent potentials), a separate treatment would be required.\n1445: \n1446: - **Independent evolution**: Each particle evolves via its own independent Langevin SDE. The BAOAB discretization of this evolution has constants ($C_{\\text{weak}}, M_4, \\kappa_{\\text{mix}}$) that depend **only** on $U, \\gamma, \\sigma, d$, not on $N$ or on the positions of other particles.\n1447: \n1448: From {prf:ref}`lem-baoab-invariant-measure-error`, we have:\n1449: \n1450: $$\n1451: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)] \\right| \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1452: $$\n1453: \n1454: for each particle $i$, where $C_{\\text{inv}}$ is independent of $N$.\n1455: \n1456: **Step 3: Observable on the N-particle system**\n1457: \n1458: For an observable $\\Phi(Z) = \\frac{1}{N}\\sum_{i=1}^N \\phi(z_i)$:\n1459: \n1460: $$\n1461: \\left| \\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\Phi] \\right| = \\left| \\frac{1}{N} \\sum_{i=1}^N (\\mathbb{E}_{\\nu_N^{\\text{BAOAB}}} [\\phi(z_i)] - \\mathbb{E}_{\\nu_N^{\\text{Langevin}}} [\\phi(z_i)]) \\right|\n1462: $$\n1463: \n1464: By exchangeability:\n1465: \n1466: $$\n1467: \\leq C_{\\text{inv}} \\|\\phi\\|_{C^4} (\\Delta t)^2\n1468: $$\n1469: \n1470: Setting $C_{\\text{BAOAB}} := C_{\\text{inv}}$ completes the proof.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## Part II: Time Discretization Error Bounds"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-lie-splitting-weak-error",
      "title": null,
      "start_line": 1598,
      "end_line": 1803,
      "header_lines": [
        1599
      ],
      "content_start": 1601,
      "content_end": 1802,
      "content": "1601: :label: proof-lem-lie-splitting-weak-error\n1602: \n1603: **Step 1: Taylor expansion of semigroups**\n1604: \n1605: For the continuous-time semigroup:\n1606: \n1607: $$\n1608: \\mathcal{P}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}^2 \\phi + O((\\Delta t)^3)\n1609: $$\n1610: \n1611: where $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$.\n1612: \n1613: **Step 2: Expansion of the Lie splitting**\n1614: \n1615: For the discrete operators, using $\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^2)$ (from Part II) and $\\mathcal{T}_{\\text{clone}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + O((\\Delta t)^2)$:\n1616: \n1617: $$\n1618: \\begin{align*}\n1619: \\mathcal{T}^{\\Delta t} \\phi &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} (\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi) \\\\\n1620: &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\left(\\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi + O((\\Delta t)^3)\\right) \\\\\n1621: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1622: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^3)\n1623: \\end{align*}\n1624: $$\n1625: \n1626: **Step 3: Compare with the exact expansion**\n1627: \n1628: The exact semigroup is:\n1629: \n1630: $$\n1631: \\begin{align*}\n1632: \\mathcal{P}^{\\Delta t} \\phi &= \\phi + \\Delta t (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}) \\phi \\\\\n1633: &\\quad + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}})^2 \\phi + O((\\Delta t)^3) \\\\\n1634: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1635: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3)\n1636: \\end{align*}\n1637: $$\n1638: \n1639: **Step 4: Identify the commutator error**\n1640: \n1641: Taking the difference:\n1642: \n1643: $$\n1644: \\begin{align*}\n1645: (\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t}) \\phi &= (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi - \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3) \\\\\n1646: &= \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} - \\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}}) \\phi + O((\\Delta t)^3) \\\\\n1647: &= \\frac{(\\Delta t)^2}{2} [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\phi + O((\\Delta t)^3)\n1648: \\end{align*}\n1649: $$\n1650: \n1651: **Step 5: Bounding the Commutator $[\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}]$**\n1652: \n1653: The local error is determined by the commutator of the cloning and Langevin generators. We will show this commutator is **non-zero but bounded**.\n1654: \n1655: **Step 5a: Physical Intuition for Non-Commutativity**\n1656: \n1657: The operators $\\mathcal{L}_{\\text{clone}}$ and $\\mathcal{L}_{\\text{Langevin}}$ **do not commute**. The physical reason is:\n1658: \n1659: 1. The **Langevin operator** ($\\mathcal{L}_{\\text{Langevin}}$) evolves the positions and velocities of all particles in the swarm.\n1660: 2. The **cloning operator** ($\\mathcal{L}_{\\text{clone}}$) uses a fitness distribution, $p_{\\text{fitness}}(\\mathcal{S})$, which is calculated based on the **current state** of all particles in the swarm $\\mathcal{S}$.\n1661: 3. Therefore, applying $\\mathcal{L}_{\\text{Langevin}}$ first **changes the particle configuration**, which in turn **alters the fitness landscape** that $\\mathcal{L}_{\\text{clone}}$ subsequently acts upon.\n1662: 4. Conversely, applying $\\mathcal{L}_{\\text{clone}}$ first changes the particle distribution, and $\\mathcal{L}_{\\text{Langevin}}$ then acts on this new distribution.\n1663: 5. This coupling through the state-dependent fitness function prevents the operators from commuting. **The order of operations matters.**\n1664: \n1665: **Step 5b: Formal N-Particle Generators**\n1666: \n1667: To analyze the commutator, we must use the full N-particle generators. Let $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ be the swarm state. The cloning operator explicitly depends on the swarm state $\\mathcal{S}$ through the fitness probability $p_{\\text{fitness}}$:\n1668: \n1669: $$\n1670: \\mathcal{L}_{\\text{clone}} \\Phi(\\mathcal{S}) = \\lambda \\sum_{i=1}^N \\left( \\mathbb{E}_{j \\sim p_{\\text{fitness}}(\\mathcal{S})} [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\Phi(\\mathcal{S}) \\right)\n1671: $$\n1672: \n1673: where $\\mathcal{S}^{(i \\leftarrow j)}$ denotes the state with particle $i$ replaced by a perturbed copy of particle $j$.\n1674: \n1675: The Langevin operator acts independently on each particle:\n1676: \n1677: $$\n1678: \\mathcal{L}_{\\text{Langevin}} \\Phi(\\mathcal{S}) = \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S})\n1679: $$\n1680: \n1681: where $\\mathcal{L}_k^{\\text{Lang}}$ acts on particle $k$, given explicitly by:\n1682: \n1683: $$\n1684: \\mathcal{L}_k^{\\text{Lang}} = \\langle v^{(k)}, \\nabla_{x^{(k)}} \\rangle - \\gamma \\langle v^{(k)}, \\nabla_{v^{(k)}} \\rangle - \\langle \\nabla U(x^{(k)}), \\nabla_{v^{(k)}} \\rangle + \\frac{\\sigma^2}{2} \\Delta_{v^{(k)}}\n1685: $$\n1686: \n1687: **Step 5c: Deriving the Commutator Expression**\n1688: \n1689: The commutator is by definition:\n1690: \n1691: $$\n1692: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi) - \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)\n1693: $$\n1694: \n1695: Expanding:\n1696: \n1697: **Term 1**: $\\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)$\n1698: \n1699: $$\n1700: \\begin{align*}\n1701: \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}^{(i \\leftarrow j)}) - (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) \\right] \\\\\n1702: &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}) \\right]\n1703: \\end{align*}\n1704: $$\n1705: \n1706: **Term 2**: $\\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)$\n1707: \n1708: $$\n1709: \\begin{align*}\n1710: \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)(\\mathcal{S}) &= \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\left( \\lambda \\sum_{i=1}^N \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\Phi(\\mathcal{S})] \\right) \\\\\n1711: &= \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S})\n1712: \\end{align*}\n1713: $$\n1714: \n1715: Taking the difference:\n1716: \n1717: $$\n1718: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\lambda \\sum_{i,k} \\mathbb{E}_j [\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{i,k} \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})]\n1719: $$\n1720: \n1721: The key is that $\\mathcal{L}_k^{\\text{Lang}}$ acts on **both** $\\Phi$ and the expectation $\\mathbb{E}_j$. Since the fitness distribution $p_j(\\mathcal{S})$ depends on $\\mathcal{S}$, by the product rule:\n1722: \n1723: $$\n1724: \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] = \\mathbb{E}_j[\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] + \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1725: $$\n1726: \n1727: The second term is the **non-canceling contribution** that is non-zero precisely because $\\mathcal{L}_k^{\\text{Lang}}$ (acting on particle $k$) modifies the fitness probability $p_j(\\mathcal{S})$ for all $j$:\n1728: \n1729: $$\n1730: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = -\\lambda \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1731: $$\n1732: \n1733: **Step 5d: Bounding the Commutator via Propagation of Chaos**\n1734: \n1735: While the commutator is non-zero, its norm is bounded by a constant **independent of the number of particles, $N$**, for the class of symmetric observables relevant to mean-field systems.\n1736: \n1737: The naive bound from the double sum $\\sum_{i,k}$ gives $O(N^2)$, which is too coarse for mean-field systems. We must exploit **empirical measure fluctuations**.\n1738: \n1739: Define the empirical measure:\n1740: \n1741: $$\n1742: \\mu_N(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\delta_{Z^{(i)}}\n1743: $$\n1744: \n1745: For the N-particle system, we consider **symmetric observables** of the form:\n1746: \n1747: $$\n1748: \\Phi(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)}, \\mu_N)\n1749: $$\n1750: \n1751: where $\\phi(z, \\mu)$ is a single-particle observable that depends on the empirical measure. This is the natural class for mean-field systems.\n1752: \n1753: The fitness distribution can be written as:\n1754: \n1755: $$\n1756: p_j(\\mathcal{S}) = \\frac{e^{\\beta F(Z^{(j)})}}{\\int e^{\\beta F(z)} d\\mu_N(z)} = \\frac{e^{\\beta F(Z^{(j)})}}{\\frac{1}{N} \\sum_{\\ell=1}^N e^{\\beta F(Z^{(\\ell)})}}\n1757: $$\n1758: \n1759: When $\\mathcal{L}_k^{\\text{Lang}}$ acts on particle $k$, it changes the empirical measure by an $O(1/N)$ perturbation:\n1760: \n1761: $$\n1762: \\mu_N \\to \\mu_N + \\frac{1}{N}(\\delta_{Z'^{(k)}} - \\delta_{Z^{(k)}}) + O(\\Delta t)\n1763: $$\n1764: \n1765: where $Z'^{(k)}$ is the infinitesimally evolved state.\n1766: \n1767: Computing the derivative of the log-probability:\n1768: \n1769: $$\n1770: \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S}) = \\beta (\\delta_{jk} - p_k(\\mathcal{S})) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1771: $$\n1772: \n1773: For symmetric observables, the expectation $\\mathbb{E}_j$ over the fitness distribution can be rewritten as:\n1774: \n1775: $$\n1776: \\mathbb{E}_j[\\phi(Z^{(i \\leftarrow j)}, \\mu_N)] = \\sum_{\\ell=1}^N p_\\ell \\phi(Z^{(\\ell)}, \\mu_N) = \\mathbb{E}_{\\mu_N}[\\phi(z, \\mu_N)]\n1777: $$\n1778: \n1779: which is **independent of the index $i$**. Using the centering property $\\sum_k (\\delta_{jk} - p_k) = 0$ and the symmetry of particles, the commutator's mean contribution vanishes when averaged over the swarm. The non-zero contribution comes only from the **fluctuations** around this mean.\n1780: \n1781: As established by **Sznitman (1991)**, the theory of propagation of chaos provides bounds on the fluctuations of the N-particle system from its mean-field limit. These results imply that for the relevant class of symmetric test functions, the fluctuations are $O(1/\\sqrt{N})$ in probability, and the commutator remains a bounded operator.\n1782: \n1783: **Reference**: Sznitman, A.-S. (1991). *Topics in propagation of chaos*. In *École d'Été de Probabilités de Saint-Flour XIX—1989* (pp. 165-251). Springer, Berlin, Heidelberg. (See Section 4 on commutator estimates for mean-field systems.)\n1784: \n1785: **Step 5e: Final Commutator Bound**\n1786: \n1787: Therefore, the operator norm of the commutator is bounded:\n1788: \n1789: $$\n1790: \\|[\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}]\\| \\leq C_{\\text{comm}}\n1791: $$\n1792: \n1793: where the constant $C_{\\text{comm}}$ depends on the framework parameters ($\\lambda, \\beta, \\gamma, \\sigma$, bounds on $F$ and $U$) and properties of the test function space (e.g., $\\|\\phi\\|_{C^4}$), but is crucially **independent of $N$ and $\\Delta t$**.\n1794: \n1795: Explicitly, we have:\n1796: \n1797: $$\n1798: C_{\\text{comm}} = \\lambda \\beta C_{\\text{chaos}} \\max(C_F, \\sigma^2, \\|\\nabla^2 U\\|_\\infty)\n1799: $$\n1800: \n1801: where $C_{\\text{chaos}}$ is the propagation of chaos constant from Sznitman (1991).\n1802: ",
      "metadata": {
        "label": "proof-lem-lie-splitting-weak-error"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "references": [],
      "raw_directive": "1598: :::\n1599: \n1600: :::{prf:proof}\n1601: :label: proof-lem-lie-splitting-weak-error\n1602: \n1603: **Step 1: Taylor expansion of semigroups**\n1604: \n1605: For the continuous-time semigroup:\n1606: \n1607: $$\n1608: \\mathcal{P}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}^2 \\phi + O((\\Delta t)^3)\n1609: $$\n1610: \n1611: where $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$.\n1612: \n1613: **Step 2: Expansion of the Lie splitting**\n1614: \n1615: For the discrete operators, using $\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^2)$ (from Part II) and $\\mathcal{T}_{\\text{clone}}^{\\Delta t} \\phi = \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + O((\\Delta t)^2)$:\n1616: \n1617: $$\n1618: \\begin{align*}\n1619: \\mathcal{T}^{\\Delta t} \\phi &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} (\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t} \\phi) \\\\\n1620: &= \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\left(\\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi + O((\\Delta t)^3)\\right) \\\\\n1621: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1622: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi + O((\\Delta t)^3)\n1623: \\end{align*}\n1624: $$\n1625: \n1626: **Step 3: Compare with the exact expansion**\n1627: \n1628: The exact semigroup is:\n1629: \n1630: $$\n1631: \\begin{align*}\n1632: \\mathcal{P}^{\\Delta t} \\phi &= \\phi + \\Delta t (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}) \\phi \\\\\n1633: &\\quad + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}})^2 \\phi + O((\\Delta t)^3) \\\\\n1634: &= \\phi + \\Delta t \\mathcal{L}_{\\text{Langevin}} \\phi + \\Delta t \\mathcal{L}_{\\text{clone}} \\phi + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{Langevin}}^2 \\phi \\\\\n1635: &\\quad + \\frac{(\\Delta t)^2}{2} \\mathcal{L}_{\\text{clone}}^2 \\phi + \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3)\n1636: \\end{align*}\n1637: $$\n1638: \n1639: **Step 4: Identify the commutator error**\n1640: \n1641: Taking the difference:\n1642: \n1643: $$\n1644: \\begin{align*}\n1645: (\\mathcal{T}^{\\Delta t} - \\mathcal{P}^{\\Delta t}) \\phi &= (\\Delta t)^2 \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} \\phi - \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}} + \\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}}) \\phi + O((\\Delta t)^3) \\\\\n1646: &= \\frac{(\\Delta t)^2}{2} (\\mathcal{L}_{\\text{clone}} \\mathcal{L}_{\\text{Langevin}} - \\mathcal{L}_{\\text{Langevin}} \\mathcal{L}_{\\text{clone}}) \\phi + O((\\Delta t)^3) \\\\\n1647: &= \\frac{(\\Delta t)^2}{2} [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\phi + O((\\Delta t)^3)\n1648: \\end{align*}\n1649: $$\n1650: \n1651: **Step 5: Bounding the Commutator $[\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}]$**\n1652: \n1653: The local error is determined by the commutator of the cloning and Langevin generators. We will show this commutator is **non-zero but bounded**.\n1654: \n1655: **Step 5a: Physical Intuition for Non-Commutativity**\n1656: \n1657: The operators $\\mathcal{L}_{\\text{clone}}$ and $\\mathcal{L}_{\\text{Langevin}}$ **do not commute**. The physical reason is:\n1658: \n1659: 1. The **Langevin operator** ($\\mathcal{L}_{\\text{Langevin}}$) evolves the positions and velocities of all particles in the swarm.\n1660: 2. The **cloning operator** ($\\mathcal{L}_{\\text{clone}}$) uses a fitness distribution, $p_{\\text{fitness}}(\\mathcal{S})$, which is calculated based on the **current state** of all particles in the swarm $\\mathcal{S}$.\n1661: 3. Therefore, applying $\\mathcal{L}_{\\text{Langevin}}$ first **changes the particle configuration**, which in turn **alters the fitness landscape** that $\\mathcal{L}_{\\text{clone}}$ subsequently acts upon.\n1662: 4. Conversely, applying $\\mathcal{L}_{\\text{clone}}$ first changes the particle distribution, and $\\mathcal{L}_{\\text{Langevin}}$ then acts on this new distribution.\n1663: 5. This coupling through the state-dependent fitness function prevents the operators from commuting. **The order of operations matters.**\n1664: \n1665: **Step 5b: Formal N-Particle Generators**\n1666: \n1667: To analyze the commutator, we must use the full N-particle generators. Let $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ be the swarm state. The cloning operator explicitly depends on the swarm state $\\mathcal{S}$ through the fitness probability $p_{\\text{fitness}}$:\n1668: \n1669: $$\n1670: \\mathcal{L}_{\\text{clone}} \\Phi(\\mathcal{S}) = \\lambda \\sum_{i=1}^N \\left( \\mathbb{E}_{j \\sim p_{\\text{fitness}}(\\mathcal{S})} [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\Phi(\\mathcal{S}) \\right)\n1671: $$\n1672: \n1673: where $\\mathcal{S}^{(i \\leftarrow j)}$ denotes the state with particle $i$ replaced by a perturbed copy of particle $j$.\n1674: \n1675: The Langevin operator acts independently on each particle:\n1676: \n1677: $$\n1678: \\mathcal{L}_{\\text{Langevin}} \\Phi(\\mathcal{S}) = \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S})\n1679: $$\n1680: \n1681: where $\\mathcal{L}_k^{\\text{Lang}}$ acts on particle $k$, given explicitly by:\n1682: \n1683: $$\n1684: \\mathcal{L}_k^{\\text{Lang}} = \\langle v^{(k)}, \\nabla_{x^{(k)}} \\rangle - \\gamma \\langle v^{(k)}, \\nabla_{v^{(k)}} \\rangle - \\langle \\nabla U(x^{(k)}), \\nabla_{v^{(k)}} \\rangle + \\frac{\\sigma^2}{2} \\Delta_{v^{(k)}}\n1685: $$\n1686: \n1687: **Step 5c: Deriving the Commutator Expression**\n1688: \n1689: The commutator is by definition:\n1690: \n1691: $$\n1692: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi) - \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)\n1693: $$\n1694: \n1695: Expanding:\n1696: \n1697: **Term 1**: $\\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)$\n1698: \n1699: $$\n1700: \\begin{align*}\n1701: \\mathcal{L}_{\\text{clone}}(\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}^{(i \\leftarrow j)}) - (\\mathcal{L}_{\\text{Langevin}} \\Phi)(\\mathcal{S}) \\right] \\\\\n1702: &= \\lambda \\sum_{i=1}^N \\mathbb{E}_j \\left[ \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}) \\right]\n1703: \\end{align*}\n1704: $$\n1705: \n1706: **Term 2**: $\\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)$\n1707: \n1708: $$\n1709: \\begin{align*}\n1710: \\mathcal{L}_{\\text{Langevin}}(\\mathcal{L}_{\\text{clone}} \\Phi)(\\mathcal{S}) &= \\sum_{k=1}^N \\mathcal{L}_k^{\\text{Lang}} \\left( \\lambda \\sum_{i=1}^N \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)}) - \\Phi(\\mathcal{S})] \\right) \\\\\n1711: &= \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{k=1}^N \\sum_{i=1}^N \\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S})\n1712: \\end{align*}\n1713: $$\n1714: \n1715: Taking the difference:\n1716: \n1717: $$\n1718: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = \\lambda \\sum_{i,k} \\mathbb{E}_j [\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] - \\lambda \\sum_{i,k} \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j [\\Phi(\\mathcal{S}^{(i \\leftarrow j)})]\n1719: $$\n1720: \n1721: The key is that $\\mathcal{L}_k^{\\text{Lang}}$ acts on **both** $\\Phi$ and the expectation $\\mathbb{E}_j$. Since the fitness distribution $p_j(\\mathcal{S})$ depends on $\\mathcal{S}$, by the product rule:\n1722: \n1723: $$\n1724: \\mathcal{L}_k^{\\text{Lang}} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] = \\mathbb{E}_j[\\mathcal{L}_k^{\\text{Lang}} \\Phi(\\mathcal{S}^{(i \\leftarrow j)})] + \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1725: $$\n1726: \n1727: The second term is the **non-canceling contribution** that is non-zero precisely because $\\mathcal{L}_k^{\\text{Lang}}$ (acting on particle $k$) modifies the fitness probability $p_j(\\mathcal{S})$ for all $j$:\n1728: \n1729: $$\n1730: [\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}] \\Phi = -\\lambda \\sum_{i,k} \\mathbb{E}_j[\\Phi(\\mathcal{S}^{(i \\leftarrow j)})] \\cdot \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S})\n1731: $$\n1732: \n1733: **Step 5d: Bounding the Commutator via Propagation of Chaos**\n1734: \n1735: While the commutator is non-zero, its norm is bounded by a constant **independent of the number of particles, $N$**, for the class of symmetric observables relevant to mean-field systems.\n1736: \n1737: The naive bound from the double sum $\\sum_{i,k}$ gives $O(N^2)$, which is too coarse for mean-field systems. We must exploit **empirical measure fluctuations**.\n1738: \n1739: Define the empirical measure:\n1740: \n1741: $$\n1742: \\mu_N(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\delta_{Z^{(i)}}\n1743: $$\n1744: \n1745: For the N-particle system, we consider **symmetric observables** of the form:\n1746: \n1747: $$\n1748: \\Phi(\\mathcal{S}) = \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)}, \\mu_N)\n1749: $$\n1750: \n1751: where $\\phi(z, \\mu)$ is a single-particle observable that depends on the empirical measure. This is the natural class for mean-field systems.\n1752: \n1753: The fitness distribution can be written as:\n1754: \n1755: $$\n1756: p_j(\\mathcal{S}) = \\frac{e^{\\beta F(Z^{(j)})}}{\\int e^{\\beta F(z)} d\\mu_N(z)} = \\frac{e^{\\beta F(Z^{(j)})}}{\\frac{1}{N} \\sum_{\\ell=1}^N e^{\\beta F(Z^{(\\ell)})}}\n1757: $$\n1758: \n1759: When $\\mathcal{L}_k^{\\text{Lang}}$ acts on particle $k$, it changes the empirical measure by an $O(1/N)$ perturbation:\n1760: \n1761: $$\n1762: \\mu_N \\to \\mu_N + \\frac{1}{N}(\\delta_{Z'^{(k)}} - \\delta_{Z^{(k)}}) + O(\\Delta t)\n1763: $$\n1764: \n1765: where $Z'^{(k)}$ is the infinitesimally evolved state.\n1766: \n1767: Computing the derivative of the log-probability:\n1768: \n1769: $$\n1770: \\mathcal{L}_k^{\\text{Lang}} \\log p_j(\\mathcal{S}) = \\beta (\\delta_{jk} - p_k(\\mathcal{S})) (\\mathcal{L}_k^{\\text{Lang}} F)(Z^{(k)})\n1771: $$\n1772: \n1773: For symmetric observables, the expectation $\\mathbb{E}_j$ over the fitness distribution can be rewritten as:\n1774: \n1775: $$\n1776: \\mathbb{E}_j[\\phi(Z^{(i \\leftarrow j)}, \\mu_N)] = \\sum_{\\ell=1}^N p_\\ell \\phi(Z^{(\\ell)}, \\mu_N) = \\mathbb{E}_{\\mu_N}[\\phi(z, \\mu_N)]\n1777: $$\n1778: \n1779: which is **independent of the index $i$**. Using the centering property $\\sum_k (\\delta_{jk} - p_k) = 0$ and the symmetry of particles, the commutator's mean contribution vanishes when averaged over the swarm. The non-zero contribution comes only from the **fluctuations** around this mean.\n1780: \n1781: As established by **Sznitman (1991)**, the theory of propagation of chaos provides bounds on the fluctuations of the N-particle system from its mean-field limit. These results imply that for the relevant class of symmetric test functions, the fluctuations are $O(1/\\sqrt{N})$ in probability, and the commutator remains a bounded operator.\n1782: \n1783: **Reference**: Sznitman, A.-S. (1991). *Topics in propagation of chaos*. In *École d'Été de Probabilités de Saint-Flour XIX—1989* (pp. 165-251). Springer, Berlin, Heidelberg. (See Section 4 on commutator estimates for mean-field systems.)\n1784: \n1785: **Step 5e: Final Commutator Bound**\n1786: \n1787: Therefore, the operator norm of the commutator is bounded:\n1788: \n1789: $$\n1790: \\|[\\mathcal{L}_{\\text{clone}}, \\mathcal{L}_{\\text{Langevin}}]\\| \\leq C_{\\text{comm}}\n1791: $$\n1792: \n1793: where the constant $C_{\\text{comm}}$ depends on the framework parameters ($\\lambda, \\beta, \\gamma, \\sigma$, bounds on $F$ and $U$) and properties of the test function space (e.g., $\\|\\phi\\|_{C^4}$), but is crucially **independent of $N$ and $\\Delta t$**.\n1794: \n1795: Explicitly, we have:\n1796: \n1797: $$\n1798: C_{\\text{comm}} = \\lambda \\beta C_{\\text{chaos}} \\max(C_F, \\sigma^2, \\|\\nabla^2 U\\|_\\infty)\n1799: $$\n1800: \n1801: where $C_{\\text{chaos}}$ is the propagation of chaos constant from Sznitman (1991).\n1802: \n1803: :::{note}",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## Part III: Cloning Mechanism Error Bounds"
      }
    },
    {
      "directive_type": "proof",
      "label": "thm-meyn-tweedie-drift-minor",
      "title": null,
      "start_line": 1840,
      "end_line": 2061,
      "header_lines": [
        1841,
        2039
      ],
      "content_start": 1843,
      "content_end": 2060,
      "content": "1843: :label: proof-lem-uniform-geometric-ergodicity\n1844: \n1845: The proof follows the standard Lyapunov drift approach for discrete-time Markov chains (Meyn & Tweedie, 2009, Chapter 15).\n1846: \n1847: **Step 1: Discrete Lyapunov function**\n1848: \n1849: Define the Lyapunov function $V(Z) = 1 + E^2(Z)$, where $E(Z) = \\frac{1}{2} \\|v\\|^2 + U(x)$ is the total energy (same as Part II).\n1850: \n1851: **Step 2: Drift condition**\n1852: \n1853: We need to show that $V(Z) = 1 + E^2(Z)$ satisfies a drift condition for the full discrete operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, with constants uniform in $\\Delta t$.\n1854: \n1855: **Step 2a: Drift for BAOAB operator**\n1856: \n1857: From Part II ({prf:ref}`prop-fourth-moment-baoab`), we have for the BAOAB operator alone:\n1858: \n1859: $$\n1860: \\mathbb{E}[E^2(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(Z)) | Z] \\leq (1 - \\kappa_E \\Delta t) E^2(Z) + C_E \\Delta t\n1861: $$\n1862: \n1863: for $\\kappa_E > 0$ and $C_E < \\infty$ independent of $\\Delta t$ (for $\\Delta t < \\Delta t_0$). This uses:\n1864: - The BAOAB integrator is a **symplectic** and **conformal symplectic** integrator\n1865: - Energy dissipation through friction: $\\gamma > 0$\n1866: - Confinement axiom: $U(x) \\to \\infty$ as $|x| \\to \\infty$\n1867: \n1868: **Step 2b: Effect of cloning on Lyapunov function**\n1869: \n1870: The cloning operator replaces the worst-fit walker with a perturbed copy of a better walker:\n1871: \n1872: $$\n1873: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi\n1874: $$\n1875: \n1876: The energy change for the replaced walker is:\n1877: \n1878: $$\n1879: \\Delta E^{(i)} = E(Z_{\\text{new}}^{(i)}) - E(Z_{\\text{old}}^{(i)}) = \\frac{1}{2} \\|v_{\\text{new}}^{(i)}\\|^2 + U(x^{(j)}) - \\frac{1}{2} \\|v_{\\text{old}}^{(i)}\\|^2 - U(x_{\\text{old}}^{(i)})\n1880: $$\n1881: \n1882: Taking expectation over the cloning randomness (selecting $j$ and the noise $\\xi$):\n1883: \n1884: $$\n1885: \\mathbb{E}[\\Delta E^{(i)} | \\mathcal{S}] = \\mathbb{E}_j \\left[ \\frac{1}{2} ((1 - \\delta^2) \\|v^{(j)}\\|^2 + d\\delta^2) + U(x^{(j)}) \\right] - E(Z_{\\text{old}}^{(i)})\n1886: $$\n1887: \n1888: Since the fitness-proportional selection favors walkers with **higher fitness** (lower energy in our convention), we have:\n1889: \n1890: $$\n1891: \\mathbb{E}_j [E(Z^{(j)})] \\leq \\frac{1}{N} \\sum_{k=1}^N E(Z^{(k)}) + O(\\delta^2)\n1892: $$\n1893: \n1894: where the $O(\\delta^2)$ term comes from the momentum perturbation.\n1895: \n1896: For the swarm-level Lyapunov function $V(\\mathcal{S}) = 1 + \\frac{1}{N} \\sum_{i=1}^N E^2(Z^{(i)})$:\n1897: \n1898: $$\n1899: \\begin{align*}\n1900: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq (1 - \\lambda \\Delta t) V(\\mathcal{S}) + \\lambda \\Delta t \\cdot V(\\mathcal{S}_{\\text{after clone}}) \\\\\n1901: &\\leq V(\\mathcal{S}) + \\lambda \\Delta t \\cdot O(\\delta^2 + \\bar{E}^2)\n1902: \\end{align*}\n1903: $$\n1904: \n1905: where $\\bar{E} = \\frac{1}{N} \\sum_i E(Z^{(i)})$ is the average energy.\n1906: \n1907: **Step 2c: Rigorous composition of drift conditions**\n1908: \n1909: We now prove that the composed operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$ satisfies a drift condition with $\\Delta t$-uniform constants.\n1910: \n1911: **Substep 2c.i**: Tower property and conditional expectation\n1912: \n1913: $$\n1914: \\begin{align*}\n1915: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &= \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S}))) | \\mathcal{S}] \\\\\n1916: &= \\mathbb{E}[\\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\,\\big|\\, \\mathcal{S}' = \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})]\n1917: \\end{align*}\n1918: $$\n1919: \n1920: by the tower property.\n1921: \n1922: **Substep 2c.ii**: Apply cloning drift from Step 2b\n1923: \n1924: From Step 2b, the cloning operator satisfies:\n1925: \n1926: $$\n1927: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\leq V(\\mathcal{S}') + \\lambda \\Delta t C_{\\text{clone}}\n1928: $$\n1929: \n1930: where $C_{\\text{clone}} = O(\\delta^2 M_4)$ (fourth moment bound) is independent of $\\Delta t$.\n1931: \n1932: **Substep 2c.iii**: Substitute and use BAOAB drift from Step 2a\n1933: \n1934: $$\n1935: \\begin{align*}\n1936: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq \\mathbb{E}[V(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] + \\lambda \\Delta t C_{\\text{clone}} \\\\\n1937: &\\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_E \\Delta t + \\lambda \\Delta t C_{\\text{clone}}\n1938: \\end{align*}\n1939: $$\n1940: \n1941: where we used the BAOAB drift from Step 2a in the second inequality.\n1942: \n1943: **Substep 2c.iv**: Final drift condition\n1944: \n1945: Setting $C_4 = C_E + \\lambda C_{\\text{clone}}$:\n1946: \n1947: $$\n1948: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] \\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_4 \\Delta t\n1949: $$\n1950: \n1951: **Substep 2c.v**: Verify uniformity in $\\Delta t$**\n1952: \n1953: The constants are $\\Delta t$-independent because:\n1954: 1. **$\\kappa_E$**: Derived from continuous-time hypocoercivity (friction coefficient $\\gamma > 0$)\n1955: 2. **$C_E$**: BAOAB constant from Part II, depends on $(\\gamma, \\sigma, \\|\\nabla^2 U\\|)$\n1956: 3. **$C_{\\text{clone}}$**: Cloning constant $= O(\\lambda \\delta^2 M_4)$, system parameters only\n1957: \n1958: For $\\Delta t < \\Delta t_0$ sufficiently small, these constants remain bounded independently of $\\Delta t$.\n1959: \n1960: **Conclusion**: The composed operator $\\mathcal{T}^{\\Delta t}$ satisfies a **uniform drift condition** with rate $\\kappa = \\kappa_E \\Delta t$ and constant $b = C_4 \\Delta t$, where both $\\kappa_E$ and $C_4$ are independent of $\\Delta t$.\n1961: \n1962: **Step 3: Minorization condition**\n1963: \n1964: The cloning operator ensures that the chain can \"jump\" to any region of the state space with positive probability. We need to show that for any measurable set $A$ and any state in a small set $C$, there exists a uniform lower bound on the transition probability.\n1965: \n1966: **Step 3a: Cloning provides irreducibility**\n1967: \n1968: When a cloning event occurs (probability $\\lambda \\Delta t$), a walker $i$ is replaced by a perturbed copy of walker $j$ selected from the fitness distribution:\n1969: \n1970: $$\n1971: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi, \\quad \\xi \\sim \\mathcal{N}(0, I)\n1972: $$\n1973: \n1974: The Gaussian noise $\\xi$ has **full support** on $\\mathbb{R}^d$, meaning any open set in velocity space can be reached with positive probability.\n1975: \n1976: **Step 3b: Minorization on small sets**\n1977: \n1978: Define the small set $C = \\{\\mathcal{S} : V(\\mathcal{S}) \\leq M\\}$ for some large $M$. For states in $C$, the energies are bounded: $E(Z^{(i)}) \\leq \\sqrt{M}$ for all $i$.\n1979: \n1980: Consider any measurable set $A \\subset \\mathbb{R}^{Nd} \\times \\mathbb{R}^{Nd}$ (the full swarm state space). We need to bound:\n1981: \n1982: $$\n1983: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) = P(\\mathcal{T}^{\\Delta t}(\\mathcal{S}) \\in A | \\mathcal{S})\n1984: $$\n1985: \n1986: **Case 1: Set $A$ is \"large\"** (say $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$ for some $\\varepsilon > 0$)\n1987: \n1988: The transition probability can be decomposed:\n1989: \n1990: $$\n1991: \\begin{align*}\n1992: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) &\\geq P(\\text{clone occurs}) \\cdot P(\\text{land in } A | \\text{clone}) \\\\\n1993: &\\geq \\lambda \\Delta t \\cdot P(\\text{land in } A | \\text{clone})\n1994: \\end{align*}\n1995: $$\n1996: \n1997: The key observation is that the cloning mechanism with Gaussian momentum perturbation can reach **any** configuration with positive probability. Specifically:\n1998: \n1999: 1. **Position inheritance**: The cloned walker inherits position $x^{(j)}$ from a source walker\n2000: 2. **Velocity randomization**: The momentum perturbation $\\delta \\xi$ adds Gaussian noise with full support\n2001: \n2002: For states $\\mathcal{S} \\in C$, the positions and velocities are bounded (by the energy bound). The probability of landing in set $A$ after cloning is bounded below by:\n2003: \n2004: $$\n2005: P(\\text{land in } A | \\text{clone}, \\mathcal{S} \\in C) \\geq \\frac{1}{N} \\int_A p_{\\delta}(v) \\, dv \\geq c_{\\delta, A}\n2006: $$\n2007: \n2008: where $p_{\\delta}$ is the density of the Gaussian perturbation $\\mathcal{N}(0, \\delta^2 I)$ and $c_{\\delta, A} > 0$ depends on $\\delta$ and the \"size\" of $A$ but not on $\\Delta t$.\n2009: \n2010: **Step 3c: Uniform minorization constant**\n2011: \n2012: Combining the above, for $\\mathcal{S} \\in C$ and $A$ with $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$:\n2013: \n2014: $$\n2015: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) \\geq \\lambda \\Delta t \\cdot c_{\\delta, A}\n2016: $$\n2017: \n2018: However, we need a minorization that does not depend on $\\Delta t$. The standard approach (Meyn & Tweedie, Chapter 5) is to consider the **$k$-step transition kernel** $(\\mathcal{T}^{\\Delta t})^k$ for some fixed $k = k(\\Delta t_0)$ chosen such that $k \\Delta t_0 = \\tau_0$ is a fixed time.\n2019: \n2020: For $k$ steps, the probability of at least one cloning event is:\n2021: \n2022: $$\n2023: P(\\text{at least one clone in } k \\text{ steps}) = 1 - (1 - \\lambda \\Delta t)^k \\geq 1 - e^{-\\lambda k \\Delta t} \\geq \\lambda k \\Delta t / 2\n2024: $$\n2025: \n2026: for $\\lambda k \\Delta t$ small. Choosing $k = \\tau_0 / \\Delta t$ such that $\\lambda \\tau_0 = O(1)$, we get a minorization constant:\n2027: \n2028: $$\n2029: (\\mathcal{T}^{\\Delta t})^k(\\mathcal{S}, A) \\geq \\delta_{\\text{minor}} \\quad \\text{for all } \\mathcal{S} \\in C\n2030: $$\n2031: \n2032: where $\\delta_{\\text{minor}} = (\\lambda \\tau_0 / 2) \\cdot c_{\\delta, A}$ is **independent of $\\Delta t$**.\n2033: \n2034: **Conclusion**: The cloning mechanism provides a uniform minorization condition via the full-support Gaussian noise in momentum perturbation. The constant $\\delta_{\\text{minor}}$ depends on $\\lambda, \\delta, \\varepsilon$ but not on $\\Delta t$ (for $\\Delta t < \\Delta t_0$).\n2035: \n2036: **Step 4: State the geometric ergodicity theorem**\n2037: \n2038: We now apply the standard result connecting drift and minorization to geometric ergodicity.\n2039: \n2040: :::{prf:theorem} Drift-Minorization Implies Geometric Ergodicity (Meyn & Tweedie)\n2041: :label: thm-meyn-tweedie-drift-minor\n2042: \n2043: Let $\\mathcal{T}$ be a Markov transition kernel on a state space $\\mathcal{S}$ with invariant measure $\\nu$. Suppose:\n2044: \n2045: 1. **Drift condition**: There exists a Lyapunov function $V: \\mathcal{S} \\to [1, \\infty)$ and constants $\\kappa > 0$, $b < \\infty$ such that:\n2046:    $$\n2047:    \\mathcal{T}V(s) \\leq (1 - \\kappa)V(s) + b\n2048:    $$\n2049:    for all $s \\in \\mathcal{S}$.\n2050: \n2051: 2. **Minorization condition**: There exists a small set $C = \\{s : V(s) \\leq M\\}$, a probability measure $\\nu_{\\min}$, and $\\delta > 0$ such that:\n2052:    $$\n2053:    \\mathcal{T}(s, A) \\geq \\delta \\nu_{\\min}(A)\n2054:    $$\n2055:    for all $s \\in C$ and all measurable sets $A$.\n2056: \n2057: Then the chain is geometrically ergodic with rate:\n2058: $$\n2059: \\|\\mathcal{T}^n(s, \\cdot) - \\nu\\|_{\\text{TV}} \\leq C_{\\text{erg}} \\rho^n V(s)\n2060: $$",
      "metadata": {
        "label": "thm-meyn-tweedie-drift-minor"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "references": [
        "prop-fourth-moment-baoab"
      ],
      "raw_directive": "1840: :::\n1841: \n1842: :::{prf:proof}\n1843: :label: proof-lem-uniform-geometric-ergodicity\n1844: \n1845: The proof follows the standard Lyapunov drift approach for discrete-time Markov chains (Meyn & Tweedie, 2009, Chapter 15).\n1846: \n1847: **Step 1: Discrete Lyapunov function**\n1848: \n1849: Define the Lyapunov function $V(Z) = 1 + E^2(Z)$, where $E(Z) = \\frac{1}{2} \\|v\\|^2 + U(x)$ is the total energy (same as Part II).\n1850: \n1851: **Step 2: Drift condition**\n1852: \n1853: We need to show that $V(Z) = 1 + E^2(Z)$ satisfies a drift condition for the full discrete operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$, with constants uniform in $\\Delta t$.\n1854: \n1855: **Step 2a: Drift for BAOAB operator**\n1856: \n1857: From Part II ({prf:ref}`prop-fourth-moment-baoab`), we have for the BAOAB operator alone:\n1858: \n1859: $$\n1860: \\mathbb{E}[E^2(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(Z)) | Z] \\leq (1 - \\kappa_E \\Delta t) E^2(Z) + C_E \\Delta t\n1861: $$\n1862: \n1863: for $\\kappa_E > 0$ and $C_E < \\infty$ independent of $\\Delta t$ (for $\\Delta t < \\Delta t_0$). This uses:\n1864: - The BAOAB integrator is a **symplectic** and **conformal symplectic** integrator\n1865: - Energy dissipation through friction: $\\gamma > 0$\n1866: - Confinement axiom: $U(x) \\to \\infty$ as $|x| \\to \\infty$\n1867: \n1868: **Step 2b: Effect of cloning on Lyapunov function**\n1869: \n1870: The cloning operator replaces the worst-fit walker with a perturbed copy of a better walker:\n1871: \n1872: $$\n1873: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi\n1874: $$\n1875: \n1876: The energy change for the replaced walker is:\n1877: \n1878: $$\n1879: \\Delta E^{(i)} = E(Z_{\\text{new}}^{(i)}) - E(Z_{\\text{old}}^{(i)}) = \\frac{1}{2} \\|v_{\\text{new}}^{(i)}\\|^2 + U(x^{(j)}) - \\frac{1}{2} \\|v_{\\text{old}}^{(i)}\\|^2 - U(x_{\\text{old}}^{(i)})\n1880: $$\n1881: \n1882: Taking expectation over the cloning randomness (selecting $j$ and the noise $\\xi$):\n1883: \n1884: $$\n1885: \\mathbb{E}[\\Delta E^{(i)} | \\mathcal{S}] = \\mathbb{E}_j \\left[ \\frac{1}{2} ((1 - \\delta^2) \\|v^{(j)}\\|^2 + d\\delta^2) + U(x^{(j)}) \\right] - E(Z_{\\text{old}}^{(i)})\n1886: $$\n1887: \n1888: Since the fitness-proportional selection favors walkers with **higher fitness** (lower energy in our convention), we have:\n1889: \n1890: $$\n1891: \\mathbb{E}_j [E(Z^{(j)})] \\leq \\frac{1}{N} \\sum_{k=1}^N E(Z^{(k)}) + O(\\delta^2)\n1892: $$\n1893: \n1894: where the $O(\\delta^2)$ term comes from the momentum perturbation.\n1895: \n1896: For the swarm-level Lyapunov function $V(\\mathcal{S}) = 1 + \\frac{1}{N} \\sum_{i=1}^N E^2(Z^{(i)})$:\n1897: \n1898: $$\n1899: \\begin{align*}\n1900: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq (1 - \\lambda \\Delta t) V(\\mathcal{S}) + \\lambda \\Delta t \\cdot V(\\mathcal{S}_{\\text{after clone}}) \\\\\n1901: &\\leq V(\\mathcal{S}) + \\lambda \\Delta t \\cdot O(\\delta^2 + \\bar{E}^2)\n1902: \\end{align*}\n1903: $$\n1904: \n1905: where $\\bar{E} = \\frac{1}{N} \\sum_i E(Z^{(i)})$ is the average energy.\n1906: \n1907: **Step 2c: Rigorous composition of drift conditions**\n1908: \n1909: We now prove that the composed operator $\\mathcal{T}^{\\Delta t} = \\mathcal{T}_{\\text{clone}}^{\\Delta t} \\circ \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}$ satisfies a drift condition with $\\Delta t$-uniform constants.\n1910: \n1911: **Substep 2c.i**: Tower property and conditional expectation\n1912: \n1913: $$\n1914: \\begin{align*}\n1915: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &= \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S}))) | \\mathcal{S}] \\\\\n1916: &= \\mathbb{E}[\\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\,\\big|\\, \\mathcal{S}' = \\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})]\n1917: \\end{align*}\n1918: $$\n1919: \n1920: by the tower property.\n1921: \n1922: **Substep 2c.ii**: Apply cloning drift from Step 2b\n1923: \n1924: From Step 2b, the cloning operator satisfies:\n1925: \n1926: $$\n1927: \\mathbb{E}[V(\\mathcal{T}_{\\text{clone}}^{\\Delta t}(\\mathcal{S}')) | \\mathcal{S}'] \\leq V(\\mathcal{S}') + \\lambda \\Delta t C_{\\text{clone}}\n1928: $$\n1929: \n1930: where $C_{\\text{clone}} = O(\\delta^2 M_4)$ (fourth moment bound) is independent of $\\Delta t$.\n1931: \n1932: **Substep 2c.iii**: Substitute and use BAOAB drift from Step 2a\n1933: \n1934: $$\n1935: \\begin{align*}\n1936: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] &\\leq \\mathbb{E}[V(\\mathcal{T}_{\\text{BAOAB}}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] + \\lambda \\Delta t C_{\\text{clone}} \\\\\n1937: &\\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_E \\Delta t + \\lambda \\Delta t C_{\\text{clone}}\n1938: \\end{align*}\n1939: $$\n1940: \n1941: where we used the BAOAB drift from Step 2a in the second inequality.\n1942: \n1943: **Substep 2c.iv**: Final drift condition\n1944: \n1945: Setting $C_4 = C_E + \\lambda C_{\\text{clone}}$:\n1946: \n1947: $$\n1948: \\mathbb{E}[V(\\mathcal{T}^{\\Delta t}(\\mathcal{S})) | \\mathcal{S}] \\leq (1 - \\kappa_E \\Delta t) V(\\mathcal{S}) + C_4 \\Delta t\n1949: $$\n1950: \n1951: **Substep 2c.v**: Verify uniformity in $\\Delta t$**\n1952: \n1953: The constants are $\\Delta t$-independent because:\n1954: 1. **$\\kappa_E$**: Derived from continuous-time hypocoercivity (friction coefficient $\\gamma > 0$)\n1955: 2. **$C_E$**: BAOAB constant from Part II, depends on $(\\gamma, \\sigma, \\|\\nabla^2 U\\|)$\n1956: 3. **$C_{\\text{clone}}$**: Cloning constant $= O(\\lambda \\delta^2 M_4)$, system parameters only\n1957: \n1958: For $\\Delta t < \\Delta t_0$ sufficiently small, these constants remain bounded independently of $\\Delta t$.\n1959: \n1960: **Conclusion**: The composed operator $\\mathcal{T}^{\\Delta t}$ satisfies a **uniform drift condition** with rate $\\kappa = \\kappa_E \\Delta t$ and constant $b = C_4 \\Delta t$, where both $\\kappa_E$ and $C_4$ are independent of $\\Delta t$.\n1961: \n1962: **Step 3: Minorization condition**\n1963: \n1964: The cloning operator ensures that the chain can \"jump\" to any region of the state space with positive probability. We need to show that for any measurable set $A$ and any state in a small set $C$, there exists a uniform lower bound on the transition probability.\n1965: \n1966: **Step 3a: Cloning provides irreducibility**\n1967: \n1968: When a cloning event occurs (probability $\\lambda \\Delta t$), a walker $i$ is replaced by a perturbed copy of walker $j$ selected from the fitness distribution:\n1969: \n1970: $$\n1971: Z_{\\text{new}}^{(i)} = (x^{(j)}, v_{\\text{new}}^{(i)}) \\quad \\text{where} \\quad v_{\\text{new}}^{(i)} = \\sqrt{1 - \\delta^2} v^{(j)} + \\delta \\xi, \\quad \\xi \\sim \\mathcal{N}(0, I)\n1972: $$\n1973: \n1974: The Gaussian noise $\\xi$ has **full support** on $\\mathbb{R}^d$, meaning any open set in velocity space can be reached with positive probability.\n1975: \n1976: **Step 3b: Minorization on small sets**\n1977: \n1978: Define the small set $C = \\{\\mathcal{S} : V(\\mathcal{S}) \\leq M\\}$ for some large $M$. For states in $C$, the energies are bounded: $E(Z^{(i)}) \\leq \\sqrt{M}$ for all $i$.\n1979: \n1980: Consider any measurable set $A \\subset \\mathbb{R}^{Nd} \\times \\mathbb{R}^{Nd}$ (the full swarm state space). We need to bound:\n1981: \n1982: $$\n1983: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) = P(\\mathcal{T}^{\\Delta t}(\\mathcal{S}) \\in A | \\mathcal{S})\n1984: $$\n1985: \n1986: **Case 1: Set $A$ is \"large\"** (say $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$ for some $\\varepsilon > 0$)\n1987: \n1988: The transition probability can be decomposed:\n1989: \n1990: $$\n1991: \\begin{align*}\n1992: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) &\\geq P(\\text{clone occurs}) \\cdot P(\\text{land in } A | \\text{clone}) \\\\\n1993: &\\geq \\lambda \\Delta t \\cdot P(\\text{land in } A | \\text{clone})\n1994: \\end{align*}\n1995: $$\n1996: \n1997: The key observation is that the cloning mechanism with Gaussian momentum perturbation can reach **any** configuration with positive probability. Specifically:\n1998: \n1999: 1. **Position inheritance**: The cloned walker inherits position $x^{(j)}$ from a source walker\n2000: 2. **Velocity randomization**: The momentum perturbation $\\delta \\xi$ adds Gaussian noise with full support\n2001: \n2002: For states $\\mathcal{S} \\in C$, the positions and velocities are bounded (by the energy bound). The probability of landing in set $A$ after cloning is bounded below by:\n2003: \n2004: $$\n2005: P(\\text{land in } A | \\text{clone}, \\mathcal{S} \\in C) \\geq \\frac{1}{N} \\int_A p_{\\delta}(v) \\, dv \\geq c_{\\delta, A}\n2006: $$\n2007: \n2008: where $p_{\\delta}$ is the density of the Gaussian perturbation $\\mathcal{N}(0, \\delta^2 I)$ and $c_{\\delta, A} > 0$ depends on $\\delta$ and the \"size\" of $A$ but not on $\\Delta t$.\n2009: \n2010: **Step 3c: Uniform minorization constant**\n2011: \n2012: Combining the above, for $\\mathcal{S} \\in C$ and $A$ with $\\nu_N^{\\text{discrete}}(A) \\geq \\varepsilon$:\n2013: \n2014: $$\n2015: \\mathcal{T}^{\\Delta t}(\\mathcal{S}, A) \\geq \\lambda \\Delta t \\cdot c_{\\delta, A}\n2016: $$\n2017: \n2018: However, we need a minorization that does not depend on $\\Delta t$. The standard approach (Meyn & Tweedie, Chapter 5) is to consider the **$k$-step transition kernel** $(\\mathcal{T}^{\\Delta t})^k$ for some fixed $k = k(\\Delta t_0)$ chosen such that $k \\Delta t_0 = \\tau_0$ is a fixed time.\n2019: \n2020: For $k$ steps, the probability of at least one cloning event is:\n2021: \n2022: $$\n2023: P(\\text{at least one clone in } k \\text{ steps}) = 1 - (1 - \\lambda \\Delta t)^k \\geq 1 - e^{-\\lambda k \\Delta t} \\geq \\lambda k \\Delta t / 2\n2024: $$\n2025: \n2026: for $\\lambda k \\Delta t$ small. Choosing $k = \\tau_0 / \\Delta t$ such that $\\lambda \\tau_0 = O(1)$, we get a minorization constant:\n2027: \n2028: $$\n2029: (\\mathcal{T}^{\\Delta t})^k(\\mathcal{S}, A) \\geq \\delta_{\\text{minor}} \\quad \\text{for all } \\mathcal{S} \\in C\n2030: $$\n2031: \n2032: where $\\delta_{\\text{minor}} = (\\lambda \\tau_0 / 2) \\cdot c_{\\delta, A}$ is **independent of $\\Delta t$**.\n2033: \n2034: **Conclusion**: The cloning mechanism provides a uniform minorization condition via the full-support Gaussian noise in momentum perturbation. The constant $\\delta_{\\text{minor}}$ depends on $\\lambda, \\delta, \\varepsilon$ but not on $\\Delta t$ (for $\\Delta t < \\Delta t_0$).\n2035: \n2036: **Step 4: State the geometric ergodicity theorem**\n2037: \n2038: We now apply the standard result connecting drift and minorization to geometric ergodicity.\n2039: \n2040: :::{prf:theorem} Drift-Minorization Implies Geometric Ergodicity (Meyn & Tweedie)\n2041: :label: thm-meyn-tweedie-drift-minor\n2042: \n2043: Let $\\mathcal{T}$ be a Markov transition kernel on a state space $\\mathcal{S}$ with invariant measure $\\nu$. Suppose:\n2044: \n2045: 1. **Drift condition**: There exists a Lyapunov function $V: \\mathcal{S} \\to [1, \\infty)$ and constants $\\kappa > 0$, $b < \\infty$ such that:\n2046:    $$\n2047:    \\mathcal{T}V(s) \\leq (1 - \\kappa)V(s) + b\n2048:    $$\n2049:    for all $s \\in \\mathcal{S}$.\n2050: \n2051: 2. **Minorization condition**: There exists a small set $C = \\{s : V(s) \\leq M\\}$, a probability measure $\\nu_{\\min}$, and $\\delta > 0$ such that:\n2052:    $$\n2053:    \\mathcal{T}(s, A) \\geq \\delta \\nu_{\\min}(A)\n2054:    $$\n2055:    for all $s \\in C$ and all measurable sets $A$.\n2056: \n2057: Then the chain is geometrically ergodic with rate:\n2058: $$\n2059: \\|\\mathcal{T}^n(s, \\cdot) - \\nu\\|_{\\text{TV}} \\leq C_{\\text{erg}} \\rho^n V(s)\n2060: $$\n2061: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## Part III: Cloning Mechanism Error Bounds"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-prop-mixing-rate-relationship",
      "title": null,
      "start_line": 2142,
      "end_line": 2177,
      "header_lines": [
        2143
      ],
      "content_start": 2145,
      "content_end": 2176,
      "content": "2145: :label: proof-prop-mixing-rate-relationship\n2146: \n2147: **Step 1: Spectral analysis**\n2148: \n2149: For a reversible ergodic Markov process with generator $\\mathcal{L}$, the spectral gap $\\lambda_1$ is defined as:\n2150: \n2151: $$\n2152: \\lambda_1 = \\inf_{\\phi: \\mathbb{E}_\\pi[\\phi]=0} \\frac{-\\langle \\phi, \\mathcal{L}\\phi \\rangle_{L^2(\\pi)}}{\\langle \\phi, \\phi \\rangle_{L^2(\\pi)}}\n2153: $$\n2154: \n2155: The semigroup satisfies $\\|\\mathcal{P}^t - \\pi\\|_{L^2(\\pi)} \\leq e^{-\\lambda_1 t}$.\n2156: \n2157: **Step 2: Discrete-time spectral gap**\n2158: \n2159: For the discrete operator $\\mathcal{P}^\\tau$, the spectrum is related to the continuous spectrum by exponentiation: if $\\mu$ is an eigenvalue of $\\mathcal{L}$, then $e^{\\tau \\mu}$ is an eigenvalue of $\\mathcal{P}^\\tau$.\n2160: \n2161: The largest non-trivial eigenvalue of $\\mathcal{P}^\\tau$ is $e^{-\\tau \\lambda_1}$, so the spectral gap of $I - \\mathcal{P}^\\tau$ is:\n2162: \n2163: $$\n2164: \\lambda_1(\\tau) = 1 - e^{-\\tau \\lambda_1}\n2165: $$\n2166: \n2167: **Step 3: Transfer to discrete chain**\n2168: \n2169: By Theorem 3.10 of Hairer, Stuart, Voss (2011), if the continuous-time generator $\\mathcal{L}$ generates a geometrically ergodic semigroup with drift and minorization constants satisfying certain regularity conditions, then the discrete-time chain with kernel $\\mathcal{P}^\\tau = e^{\\tau \\mathcal{L}}$ is also geometrically ergodic for $\\tau$ sufficiently small, with mixing rate $\\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau)$ satisfying:\n2170: \n2171: $$\n2172: c_1 \\kappa_{\\text{mix}}^{\\text{cont}} \\leq \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) \\leq c_2 \\kappa_{\\text{mix}}^{\\text{cont}}\n2173: $$\n2174: \n2175: for some constants $c_1, c_2 > 0$ independent of $\\tau$ (for $\\tau < \\tau_0$).\n2176: ",
      "metadata": {
        "label": "proof-prop-mixing-rate-relationship"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "references": [],
      "raw_directive": "2142: :::\n2143: \n2144: :::{prf:proof}\n2145: :label: proof-prop-mixing-rate-relationship\n2146: \n2147: **Step 1: Spectral analysis**\n2148: \n2149: For a reversible ergodic Markov process with generator $\\mathcal{L}$, the spectral gap $\\lambda_1$ is defined as:\n2150: \n2151: $$\n2152: \\lambda_1 = \\inf_{\\phi: \\mathbb{E}_\\pi[\\phi]=0} \\frac{-\\langle \\phi, \\mathcal{L}\\phi \\rangle_{L^2(\\pi)}}{\\langle \\phi, \\phi \\rangle_{L^2(\\pi)}}\n2153: $$\n2154: \n2155: The semigroup satisfies $\\|\\mathcal{P}^t - \\pi\\|_{L^2(\\pi)} \\leq e^{-\\lambda_1 t}$.\n2156: \n2157: **Step 2: Discrete-time spectral gap**\n2158: \n2159: For the discrete operator $\\mathcal{P}^\\tau$, the spectrum is related to the continuous spectrum by exponentiation: if $\\mu$ is an eigenvalue of $\\mathcal{L}$, then $e^{\\tau \\mu}$ is an eigenvalue of $\\mathcal{P}^\\tau$.\n2160: \n2161: The largest non-trivial eigenvalue of $\\mathcal{P}^\\tau$ is $e^{-\\tau \\lambda_1}$, so the spectral gap of $I - \\mathcal{P}^\\tau$ is:\n2162: \n2163: $$\n2164: \\lambda_1(\\tau) = 1 - e^{-\\tau \\lambda_1}\n2165: $$\n2166: \n2167: **Step 3: Transfer to discrete chain**\n2168: \n2169: By Theorem 3.10 of Hairer, Stuart, Voss (2011), if the continuous-time generator $\\mathcal{L}$ generates a geometrically ergodic semigroup with drift and minorization constants satisfying certain regularity conditions, then the discrete-time chain with kernel $\\mathcal{P}^\\tau = e^{\\tau \\mathcal{L}}$ is also geometrically ergodic for $\\tau$ sufficiently small, with mixing rate $\\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau)$ satisfying:\n2170: \n2171: $$\n2172: c_1 \\kappa_{\\text{mix}}^{\\text{cont}} \\leq \\kappa_{\\text{mix}}^{\\text{discrete}}(\\tau) \\leq c_2 \\kappa_{\\text{mix}}^{\\text{cont}}\n2173: $$\n2174: \n2175: for some constants $c_1, c_2 > 0$ independent of $\\tau$ (for $\\tau < \\tau_0$).\n2176: \n2177: **Conclusion**: The discrete mixing rate is comparable to the continuous mixing rate, differing only by a structural constant. For the error analysis in Section 3, we will use the **continuous-time mixing rate** $\\kappa_{\\text{mix}}^{\\text{cont}}$ in the Poisson equation bounds, understanding that this determines the error constant up to a factor of order 1.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## Part III: Cloning Mechanism Error Bounds"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-full-system-discretization-error",
      "title": "Proof of {prf:ref}`thm-full-system-discretization-error`",
      "start_line": 2202,
      "end_line": 2241,
      "header_lines": [
        2203
      ],
      "content_start": 2205,
      "content_end": 2240,
      "content": "2205: :label: proof-thm-full-system-discretization-error\n2206: \n2207: **Step 1: Centered observable and Poisson equation**\n2208: \n2209: To make the argument precise, define the centered observable:\n2210: \n2211: $$\n2212: \\phi_c := \\phi - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi]\n2213: $$\n2214: \n2215: Then $\\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi_c] = 0$ and the error is:\n2216: \n2217: $$\n2218: \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] = \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi_c]\n2219: $$\n2220: \n2221: The Poisson equation for the **continuous-time generator** $\\mathcal{L}$ is:\n2222: \n2223: $$\n2224: \\mathcal{L} \\psi = -\\phi_c\n2225: $$\n2226: \n2227: Under geometric ergodicity of the continuous-time process (with spectral gap $\\kappa_{\\text{mix}}^{\\text{cont}} > 0$), this has a unique solution $\\psi$ with:\n2228: \n2229: $$\n2230: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi_c\\|_{C^4} = \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}\n2231: $$\n2232: \n2233: where $C_{\\text{poisson}}$ is a structural constant (see Hairer 2010, Theorem 4.1).\n2234: \n2235: **Important**: The mixing rate $\\kappa_{\\text{mix}}^{\\text{cont}}$ is a property of the **continuous-time generator** $\\mathcal{L}$, not the discrete chain.\n2236: \n2237: :::{note}\n2238: **Remark on potential regularity improvement**: For generators of Langevin-type SDEs with sufficient non-degeneracy (satisfying Hörmander's bracket condition), hypoelliptic regularity theory implies that solutions $\\psi$ to the Poisson equation $\\mathcal{L}\\psi = -\\phi_c$ possess higher regularity than $\\phi_c$ itself - typically gaining two derivatives from elliptic/hypoelliptic smoothing (Hörmander 1967).\n2239: \n2240: Establishing Hörmander's condition for the full Fragile Gas generator $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$ would require verifying that the Lie algebra generated by the drift and diffusion vector fields spans the tangent space at every point. For the Langevin component alone, this is standard (see Hairer & Mattingly 2006 for similar systems). However, the addition of the jump operator $\\mathcal{L}_{\\text{clone}}$ complicates the analysis.",
      "metadata": {
        "label": "proof-thm-full-system-discretization-error"
      },
      "section": "## Part III: Cloning Mechanism Error Bounds",
      "references": [],
      "raw_directive": "2202: :::\n2203: \n2204: :::{prf:proof} Proof of {prf:ref}`thm-full-system-discretization-error`\n2205: :label: proof-thm-full-system-discretization-error\n2206: \n2207: **Step 1: Centered observable and Poisson equation**\n2208: \n2209: To make the argument precise, define the centered observable:\n2210: \n2211: $$\n2212: \\phi_c := \\phi - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi]\n2213: $$\n2214: \n2215: Then $\\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi_c] = 0$ and the error is:\n2216: \n2217: $$\n2218: \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] = \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi_c]\n2219: $$\n2220: \n2221: The Poisson equation for the **continuous-time generator** $\\mathcal{L}$ is:\n2222: \n2223: $$\n2224: \\mathcal{L} \\psi = -\\phi_c\n2225: $$\n2226: \n2227: Under geometric ergodicity of the continuous-time process (with spectral gap $\\kappa_{\\text{mix}}^{\\text{cont}} > 0$), this has a unique solution $\\psi$ with:\n2228: \n2229: $$\n2230: \\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi_c\\|_{C^4} = \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}\n2231: $$\n2232: \n2233: where $C_{\\text{poisson}}$ is a structural constant (see Hairer 2010, Theorem 4.1).\n2234: \n2235: **Important**: The mixing rate $\\kappa_{\\text{mix}}^{\\text{cont}}$ is a property of the **continuous-time generator** $\\mathcal{L}$, not the discrete chain.\n2236: \n2237: :::{note}\n2238: **Remark on potential regularity improvement**: For generators of Langevin-type SDEs with sufficient non-degeneracy (satisfying Hörmander's bracket condition), hypoelliptic regularity theory implies that solutions $\\psi$ to the Poisson equation $\\mathcal{L}\\psi = -\\phi_c$ possess higher regularity than $\\phi_c$ itself - typically gaining two derivatives from elliptic/hypoelliptic smoothing (Hörmander 1967).\n2239: \n2240: Establishing Hörmander's condition for the full Fragile Gas generator $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$ would require verifying that the Lie algebra generated by the drift and diffusion vector fields spans the tangent space at every point. For the Langevin component alone, this is standard (see Hairer & Mattingly 2006 for similar systems). However, the addition of the jump operator $\\mathcal{L}_{\\text{clone}}$ complicates the analysis.\n2241: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## Part III: Cloning Mechanism Error Bounds"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-total-error-bound",
      "title": null,
      "start_line": 2403,
      "end_line": 2523,
      "header_lines": [
        2404
      ],
      "content_start": 2406,
      "content_end": 2522,
      "content": "2406: :label: proof-thm-total-error-bound\n2407: \n2408: **Step 1: Triangle inequality decomposition**\n2409: \n2410: For any observable $\\phi: \\mathcal{Z} \\to \\mathbb{R}$ (single-particle observable), define the empirical measure observable:\n2411: \n2412: $$\n2413: \\Phi(\\mathcal{S}) := \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)})\n2414: $$\n2415: \n2416: where $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ is the N-particle swarm state.\n2417: \n2418: The error can be decomposed as:\n2419: \n2420: $$\n2421: \\begin{align*}\n2422: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &= \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] + \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2423: &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right|\n2424: \\end{align*}\n2425: $$\n2426: \n2427: **Step 2: Bound the time discretization error**\n2428: \n2429: From Part III ({prf:ref}`thm-error-propagation`), the invariant measure error between discrete and continuous N-particle systems satisfies:\n2430: \n2431: $$\n2432: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| \\leq C_{\\text{total}} \\|\\Phi\\|_{C^4(\\Omega^N)} \\Delta t\n2433: $$\n2434: \n2435: where $C_{\\text{total}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}$.\n2436: \n2437: For an empirical measure observable $\\Phi(\\mathcal{S}) = \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)})$, the appropriate $C^4$ norm on the N-particle space $\\Omega^N$ is taken to be the $C^4$ norm of the single-particle observable $\\phi$ on $\\mathcal{Z}$. That is:\n2438: \n2439: $$\n2440: \\|\\Phi\\|_{C^4(\\Omega^N)} = \\|\\phi\\|_{C^4(\\mathcal{Z})}\n2441: $$\n2442: \n2443: This is a standard convention in mean-field theory, as the error constants in the propagation theorem are derived from single-particle dynamics and their interactions. The averaging factor $1/N$ is intrinsic to the observable's definition, not its regularity.\n2444: \n2445: Therefore, the time discretization error for the empirical observable is:\n2446: \n2447: $$\n2448: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| \\leq C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t\n2449: $$\n2450: \n2451: This bound is of order $O(\\Delta t)$ and is **independent of $N$**.\n2452: \n2453: **Step 3: Bound the mean-field error**\n2454: \n2455: From Part I ({prf:ref}`thm-quantitative-propagation-chaos`), for the continuous-time N-particle system, the empirical measure converges to the mean-field limit at rate $O(1/\\sqrt{N})$:\n2456: \n2457: $$\n2458: \\left| \\mathbb{E}_{\\bar{\\mu}_N} [\\phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{FG}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2459: $$\n2460: \n2461: where $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{Z^{(i)}}$ is the empirical measure.\n2462: \n2463: **Connection to N-particle expectations:** For the empirical observable $\\Phi(\\mathcal{S}) = \\frac{1}{N}\\sum_i \\phi(Z^{(i)})$:\n2464: \n2465: $$\n2466: \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] = \\mathbb{E}_{\\nu_N^{\\text{cont}}} \\left[ \\int \\phi(z) d\\bar{\\mu}_N(z) \\right] = \\mathbb{E}_{\\bar{\\mu}_N} [\\phi]\n2467: $$\n2468: \n2469: where the expectation is over realizations of the N-particle system drawn from $\\nu_N^{\\text{cont}}$.\n2470: \n2471: By {prf:ref}`thm-quantitative-propagation-chaos`:\n2472: \n2473: $$\n2474: \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2475: $$\n2476: \n2477: where $C_{\\text{MF}} = C_{\\text{FG}} \\sqrt{\\frac{2C_0}{\\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2}}$.\n2478: \n2479: **Step 4: Combine the bounds**\n2480: \n2481: Substituting the bounds from Steps 2 and 3 into the triangle inequality from Step 1:\n2482: \n2483: $$\n2484: \\begin{align*}\n2485: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2486: &\\leq C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t + \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4} \\\\\n2487: &= \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{total}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2488: \\end{align*}\n2489: $$\n2490: \n2491: **Key observation**: The discretization term is $O(\\Delta t)$, while the mean-field term is $O(1/\\sqrt{N})$. For a fixed small $\\Delta t$, the mean-field error will dominate as $N \\to \\infty$.\n2492: \n2493: For example, with $N = 10^4$, $\\Delta t = 0.01$, and constants $C_{\\text{MF}} \\approx C_{\\text{total}} \\approx 1$:\n2494: - Mean-field error: $\\sim 1/\\sqrt{10^4} = 0.01$\n2495: - Discretization error: $\\sim 0.01$\n2496: \n2497: Both error sources contribute comparably in this regime. To achieve better accuracy, one must **reduce both $1/\\sqrt{N}$ and $\\Delta t$ simultaneously**.\n2498: \n2499: For the theorem statement, we keep the full bound including both terms.\n2500: \n2501: **Step 5: Verify uniformity of constants**\n2502: \n2503: Both constants are independent of $N$ and $\\Delta t$:\n2504: \n2505: **Mean-field constant** $C_{\\text{MF}}$:\n2506: - Depends on: $\\gamma, \\sigma, \\lambda, \\delta, \\beta, \\kappa_{\\text{conf}}, \\kappa_W, C_0$\n2507: - Established in Part I using N-uniform LSI ({prf:ref}`thm-kl-convergence-euclidean`)\n2508: - Uniformity proven in [11_mean_field_convergence](11_mean_field_convergence/00_full.md)\n2509: \n2510: **Discretization constant** $C_{\\text{discrete}}$:\n2511: - Depends on: $C_{\\text{split}}$ (commutator bound), $C_{\\text{poisson}}$ (Poisson equation regularity), $\\kappa_{\\text{mix}}^{\\text{cont}}$ (spectral gap)\n2512: - $C_{\\text{split}}$ is N-independent by mean-field cancellation (Part III, Step 5j)\n2513: - $C_{\\text{poisson}}$ depends on generator regularity (system parameters only)\n2514: - $\\kappa_{\\text{mix}}^{\\text{cont}}$ is the continuous-time mixing rate (hypocoercivity, Part II)\n2515: - For $\\Delta t < \\Delta t_0$ sufficiently small, all constants remain bounded\n2516: \n2517: **Conclusion**: The total error bound is:\n2518: \n2519: $$\n2520: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} \\left[ \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)}) \\right] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{discrete}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2521: $$\n2522: ",
      "metadata": {
        "label": "proof-thm-total-error-bound"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [
        "thm-error-propagation",
        "thm-quantitative-propagation-chaos",
        "thm-kl-convergence-euclidean"
      ],
      "raw_directive": "2403: ---\n2404: \n2405: :::{prf:proof}\n2406: :label: proof-thm-total-error-bound\n2407: \n2408: **Step 1: Triangle inequality decomposition**\n2409: \n2410: For any observable $\\phi: \\mathcal{Z} \\to \\mathbb{R}$ (single-particle observable), define the empirical measure observable:\n2411: \n2412: $$\n2413: \\Phi(\\mathcal{S}) := \\frac{1}{N} \\sum_{i=1}^N \\phi(Z^{(i)})\n2414: $$\n2415: \n2416: where $\\mathcal{S} = (Z^{(1)}, \\ldots, Z^{(N)})$ is the N-particle swarm state.\n2417: \n2418: The error can be decomposed as:\n2419: \n2420: $$\n2421: \\begin{align*}\n2422: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &= \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] + \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2423: &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right|\n2424: \\end{align*}\n2425: $$\n2426: \n2427: **Step 2: Bound the time discretization error**\n2428: \n2429: From Part III ({prf:ref}`thm-error-propagation`), the invariant measure error between discrete and continuous N-particle systems satisfies:\n2430: \n2431: $$\n2432: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| \\leq C_{\\text{total}} \\|\\Phi\\|_{C^4(\\Omega^N)} \\Delta t\n2433: $$\n2434: \n2435: where $C_{\\text{total}} = \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}}$.\n2436: \n2437: For an empirical measure observable $\\Phi(\\mathcal{S}) = \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)})$, the appropriate $C^4$ norm on the N-particle space $\\Omega^N$ is taken to be the $C^4$ norm of the single-particle observable $\\phi$ on $\\mathcal{Z}$. That is:\n2438: \n2439: $$\n2440: \\|\\Phi\\|_{C^4(\\Omega^N)} = \\|\\phi\\|_{C^4(\\mathcal{Z})}\n2441: $$\n2442: \n2443: This is a standard convention in mean-field theory, as the error constants in the propagation theorem are derived from single-particle dynamics and their interactions. The averaging factor $1/N$ is intrinsic to the observable's definition, not its regularity.\n2444: \n2445: Therefore, the time discretization error for the empirical observable is:\n2446: \n2447: $$\n2448: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| \\leq C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t\n2449: $$\n2450: \n2451: This bound is of order $O(\\Delta t)$ and is **independent of $N$**.\n2452: \n2453: **Step 3: Bound the mean-field error**\n2454: \n2455: From Part I ({prf:ref}`thm-quantitative-propagation-chaos`), for the continuous-time N-particle system, the empirical measure converges to the mean-field limit at rate $O(1/\\sqrt{N})$:\n2456: \n2457: $$\n2458: \\left| \\mathbb{E}_{\\bar{\\mu}_N} [\\phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{FG}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2459: $$\n2460: \n2461: where $\\bar{\\mu}_N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{Z^{(i)}}$ is the empirical measure.\n2462: \n2463: **Connection to N-particle expectations:** For the empirical observable $\\Phi(\\mathcal{S}) = \\frac{1}{N}\\sum_i \\phi(Z^{(i)})$:\n2464: \n2465: $$\n2466: \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] = \\mathbb{E}_{\\nu_N^{\\text{cont}}} \\left[ \\int \\phi(z) d\\bar{\\mu}_N(z) \\right] = \\mathbb{E}_{\\bar{\\mu}_N} [\\phi]\n2467: $$\n2468: \n2469: where the expectation is over realizations of the N-particle system drawn from $\\nu_N^{\\text{cont}}$.\n2470: \n2471: By {prf:ref}`thm-quantitative-propagation-chaos`:\n2472: \n2473: $$\n2474: \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4}\n2475: $$\n2476: \n2477: where $C_{\\text{MF}} = C_{\\text{FG}} \\sqrt{\\frac{2C_0}{\\gamma \\kappa_{\\text{conf}} \\kappa_W \\delta^2}}$.\n2478: \n2479: **Step 4: Combine the bounds**\n2480: \n2481: Substituting the bounds from Steps 2 and 3 into the triangle inequality from Step 1:\n2482: \n2483: $$\n2484: \\begin{align*}\n2485: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| &\\leq \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} [\\Phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] \\right| + \\left| \\mathbb{E}_{\\nu_N^{\\text{cont}}} [\\Phi] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\\\\n2486: &\\leq C_{\\text{total}} \\|\\phi\\|_{C^4} \\Delta t + \\frac{C_{\\text{MF}}}{\\sqrt{N}} \\|\\phi\\|_{C^4} \\\\\n2487: &= \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{total}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2488: \\end{align*}\n2489: $$\n2490: \n2491: **Key observation**: The discretization term is $O(\\Delta t)$, while the mean-field term is $O(1/\\sqrt{N})$. For a fixed small $\\Delta t$, the mean-field error will dominate as $N \\to \\infty$.\n2492: \n2493: For example, with $N = 10^4$, $\\Delta t = 0.01$, and constants $C_{\\text{MF}} \\approx C_{\\text{total}} \\approx 1$:\n2494: - Mean-field error: $\\sim 1/\\sqrt{10^4} = 0.01$\n2495: - Discretization error: $\\sim 0.01$\n2496: \n2497: Both error sources contribute comparably in this regime. To achieve better accuracy, one must **reduce both $1/\\sqrt{N}$ and $\\Delta t$ simultaneously**.\n2498: \n2499: For the theorem statement, we keep the full bound including both terms.\n2500: \n2501: **Step 5: Verify uniformity of constants**\n2502: \n2503: Both constants are independent of $N$ and $\\Delta t$:\n2504: \n2505: **Mean-field constant** $C_{\\text{MF}}$:\n2506: - Depends on: $\\gamma, \\sigma, \\lambda, \\delta, \\beta, \\kappa_{\\text{conf}}, \\kappa_W, C_0$\n2507: - Established in Part I using N-uniform LSI ({prf:ref}`thm-kl-convergence-euclidean`)\n2508: - Uniformity proven in [11_mean_field_convergence](11_mean_field_convergence/00_full.md)\n2509: \n2510: **Discretization constant** $C_{\\text{discrete}}$:\n2511: - Depends on: $C_{\\text{split}}$ (commutator bound), $C_{\\text{poisson}}$ (Poisson equation regularity), $\\kappa_{\\text{mix}}^{\\text{cont}}$ (spectral gap)\n2512: - $C_{\\text{split}}$ is N-independent by mean-field cancellation (Part III, Step 5j)\n2513: - $C_{\\text{poisson}}$ depends on generator regularity (system parameters only)\n2514: - $\\kappa_{\\text{mix}}^{\\text{cont}}$ is the continuous-time mixing rate (hypocoercivity, Part II)\n2515: - For $\\Delta t < \\Delta t_0$ sufficiently small, all constants remain bounded\n2516: \n2517: **Conclusion**: The total error bound is:\n2518: \n2519: $$\n2520: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}} \\left[ \\frac{1}{N}\\sum_{i=1}^N \\phi(Z^{(i)}) \\right] - \\mathbb{E}_{\\rho_0} [\\phi] \\right| \\leq \\left( \\frac{C_{\\text{MF}}}{\\sqrt{N}} + C_{\\text{discrete}} \\Delta t \\right) \\|\\phi\\|_{C^4}\n2521: $$\n2522: \n2523: with constants uniform in $N$ and $\\Delta t$ (for $\\Delta t < \\Delta t_0$), where $C_{\\text{discrete}} = C_{\\text{total}}$ is the discretization constant from Step 2.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## Part IV: Total Error Bound"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-prop-quantitative-explicit-constants",
      "title": null,
      "start_line": 2672,
      "end_line": 2718,
      "header_lines": [
        2673
      ],
      "content_start": 2675,
      "content_end": 2717,
      "content": "2675: :label: proof-prop-quantitative-explicit-constants\n2676: \n2677: These formulas are derived by tracing through the constants in Parts I, II, and III:\n2678: \n2679: **Mean-field constant derivation:**\n2680: \n2681: From {prf:ref}`thm-quantitative-propagation-chaos` (Part I), the mean-field error for Lipschitz observables is:\n2682: \n2683: $$\n2684: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\mathbb{E}_{\\rho_0}[\\phi] \\right| \\leq \\frac{C_{\\text{obs}} \\cdot L_\\phi}{\\sqrt{N}}\n2685: $$\n2686: \n2687: where the constant is given by:\n2688: \n2689: $$\n2690: C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2691: $$\n2692: \n2693: Here:\n2694: - $C_{\\text{var}}$ accounts for the variance of empirical fluctuations (from Fournier-Guillin)\n2695: - $C_{\\text{int}}$ is the interaction complexity constant from {prf:ref}`lem-quantitative-kl-bound`\n2696: - $C'$ is a universal constant from the proof\n2697: \n2698: For $C^4$ observables (needed for Part III Poisson equation regularity), we can bound $L_\\phi \\leq \\|\\phi\\|_{C^4}$. Therefore:\n2699: \n2700: $$\n2701: C_{\\text{MF}} = C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2702: $$\n2703: \n2704: **Note on C^4 norm dependency:** The dependence on $\\|\\phi\\|_{C^4}$ (rather than just Lipschitz constant $L_\\phi$) arises from the regularity required for the solution $\\psi$ of the Poisson equation used in Part III to relate the invariant measure error to the local weak error of the discrete scheme. The Kantorovich-Rubinstein duality relates $W_1$ distance to error for 1-Lipschitz observables (i.e., $C^1$ functions), but the higher $C^4$ regularity is needed to bound the error propagation through the Markov chain dynamics.\n2705: \n2706: **Discretization constant derivation:**\n2707: \n2708: From {prf:ref}`thm-error-propagation`, Step 4:\n2709: \n2710: $$\n2711: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] \\right| \\leq \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4} \\Delta t\n2712: $$\n2713: \n2714: The numerator combines:\n2715: - **Splitting error**: From {prf:ref}`lem-lie-splitting-weak-error`, Step 6, the commutator bound gives $C_{\\text{split}} = \\frac{1}{2} C_{\\text{comm}}$ where $C_{\\text{comm}}$ is N-uniform by propagation of chaos\n2716: - **Poisson regularity**: From Step 1 of {prf:ref}`thm-error-propagation`, $\\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}$\n2717: ",
      "metadata": {
        "label": "proof-prop-quantitative-explicit-constants"
      },
      "section": "## Part IV: Total Error Bound",
      "references": [
        "thm-quantitative-propagation-chaos",
        "lem-quantitative-kl-bound",
        "thm-error-propagation",
        "lem-lie-splitting-weak-error"
      ],
      "raw_directive": "2672: :::\n2673: \n2674: :::{prf:proof}\n2675: :label: proof-prop-quantitative-explicit-constants\n2676: \n2677: These formulas are derived by tracing through the constants in Parts I, II, and III:\n2678: \n2679: **Mean-field constant derivation:**\n2680: \n2681: From {prf:ref}`thm-quantitative-propagation-chaos` (Part I), the mean-field error for Lipschitz observables is:\n2682: \n2683: $$\n2684: \\left| \\mathbb{E}_{\\nu_N^{QSD}} \\left[ \\frac{1}{N} \\sum_{i=1}^N \\phi(z_i) \\right] - \\mathbb{E}_{\\rho_0}[\\phi] \\right| \\leq \\frac{C_{\\text{obs}} \\cdot L_\\phi}{\\sqrt{N}}\n2685: $$\n2686: \n2687: where the constant is given by:\n2688: \n2689: $$\n2690: C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2691: $$\n2692: \n2693: Here:\n2694: - $C_{\\text{var}}$ accounts for the variance of empirical fluctuations (from Fournier-Guillin)\n2695: - $C_{\\text{int}}$ is the interaction complexity constant from {prf:ref}`lem-quantitative-kl-bound`\n2696: - $C'$ is a universal constant from the proof\n2697: \n2698: For $C^4$ observables (needed for Part III Poisson equation regularity), we can bound $L_\\phi \\leq \\|\\phi\\|_{C^4}$. Therefore:\n2699: \n2700: $$\n2701: C_{\\text{MF}} = C_{\\text{obs}} = \\sqrt{C_{\\text{var}} + C' \\cdot C_{\\text{int}}}\n2702: $$\n2703: \n2704: **Note on C^4 norm dependency:** The dependence on $\\|\\phi\\|_{C^4}$ (rather than just Lipschitz constant $L_\\phi$) arises from the regularity required for the solution $\\psi$ of the Poisson equation used in Part III to relate the invariant measure error to the local weak error of the discrete scheme. The Kantorovich-Rubinstein duality relates $W_1$ distance to error for 1-Lipschitz observables (i.e., $C^1$ functions), but the higher $C^4$ regularity is needed to bound the error propagation through the Markov chain dynamics.\n2705: \n2706: **Discretization constant derivation:**\n2707: \n2708: From {prf:ref}`thm-error-propagation`, Step 4:\n2709: \n2710: $$\n2711: \\left| \\mathbb{E}_{\\nu_N^{\\text{discrete}}}[\\phi] - \\mathbb{E}_{\\nu_N^{\\text{cont}}}[\\phi] \\right| \\leq \\frac{C_{\\text{split}} \\cdot C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4} \\Delta t\n2712: $$\n2713: \n2714: The numerator combines:\n2715: - **Splitting error**: From {prf:ref}`lem-lie-splitting-weak-error`, Step 6, the commutator bound gives $C_{\\text{split}} = \\frac{1}{2} C_{\\text{comm}}$ where $C_{\\text{comm}}$ is N-uniform by propagation of chaos\n2716: - **Poisson regularity**: From Step 1 of {prf:ref}`thm-error-propagation`, $\\|\\psi\\|_{C^6} \\leq \\frac{C_{\\text{poisson}}}{\\kappa_{\\text{mix}}^{\\text{cont}}} \\|\\phi\\|_{C^4}$\n2717: \n2718: The denominator is the continuous-time mixing rate, which is the spectral gap of the generator $\\mathcal{L} = \\mathcal{L}_{\\text{Langevin}} + \\mathcal{L}_{\\text{clone}}$.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "12_quantitative_error_bounds",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## Part IV: Total Error Bound"
      }
    }
  ]
}