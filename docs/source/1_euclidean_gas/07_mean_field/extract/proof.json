[
  {
    "label": "proof-lem-mass-conservation-transport",
    "proves": "lem-mass-conservation-transport",
    "proof_type": "direct",
    "proof_status": "complete",
    "strategy_summary": "The proof uses the divergence theorem to transform the volume integral of the Liouville equation operator ($L^\\dagger f$) into a surface integral over the phase space boundary $\\Omega$. The boundary integral is shown to vanish due to specified reflecting boundary conditions on both the position ($\\partial X_{\\text{valid}}$) and velocity ($\\partial V_{\\text{alg}}$) components of the boundary.",
    "conclusion": {
      "text": "The boundary integral vanishes, proving the result.",
      "latex": null
    },
    "assumptions": [],
    "steps": [],
    "key_equations": [
      {
        "label": null,
        "latex": "\\int_{\\Omega} L^\\dagger f\\, \\mathrm{d}z = - \\int_{\\partial\\Omega} J[f] \\cdot n\\, \\mathrm{d}S",
        "role": "main equation"
      },
      {
        "label": null,
        "latex": "J_v \\cdot n_v = 0",
        "role": "boundary condition V"
      },
      {
        "label": null,
        "latex": "J_x \\cdot n_x = 0",
        "role": "boundary condition X"
      }
    ],
    "references": [],
    "cases": [
      {
        "name": "Boundary Condition Analysis",
        "condition": "\\partial\\Omega = (\\partial X_{\\text{valid}} \\times V_{\\text{alg}}) \\cup (X_{\\text{valid}} \\times \\partial V_{\\text{alg}})",
        "summary": "The flux integral vanishes because the normal component of the flux $J[f] \\cdot n$ is zero on $\\partial V_{\\text{alg}}$ (velocity reflection) and on $\\partial X_{\\text{valid}}$ (position reflection)."
      },
      {
        "name": "Velocity Boundary",
        "condition": "On $\\partial V_{\\text{alg}}$",
        "summary": "$J_v \\cdot n_v = 0$"
      },
      {
        "name": "Position Boundary",
        "condition": "On $\\partial X_{\\text{valid}}$",
        "summary": "$J_x \\cdot n_x = 0$"
      }
    ],
    "remarks": [],
    "gaps": [],
    "tags": [
      "conservation law",
      "divergence theorem",
      "boundary conditions",
      "phase space"
    ]
  },
  {
    "label": "proof-thm-mass-conservation",
    "proves": "thm-mass-conservation",
    "proof_type": "direct",
    "proof_status": "complete",
    "strategy_summary": "The proof computes the time derivatives of the alive mass ($m_a$) and the dead mass ($m_d$) by integrating the governing equations over the domain $\\Omega$. It then shows that the sum of these derivatives is zero by cancelling the non-conservative terms (killing and revival).",
    "conclusion": {
      "text": "The total mass $m_a(t) + m_d(t)$ is conserved for all time.",
      "latex": "\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left[m_a(t) + m_d(t)\\right] = 0"
    },
    "assumptions": [],
    "steps": [
      {
        "order": 1,
        "kind": "computation",
        "text": "Compute the time derivative of the alive mass $m_a(t)$ by integrating $\\partial_t f$ over $\\Omega$, resulting in a sum of four terms: transport ($L^\\dagger f$), killing ($c(z)f$), revival ($B[f, m_d]$), and internal cloning ($S[f]$).",
        "latex": "$$\\frac{\\mathrm{d}}{\\mathrm{d}t}m_a(t) = \\int_\\Omega L^\\dagger f\\,\\mathrm{d}z - \\int_\\Omega c(z)f\\,\\mathrm{d}z + \\int_\\Omega B[f, m_d]\\,\\mathrm{d}z + \\int_\\Omega S[f]\\,\\mathrm{d}z$$",
        "references": []
      },
      {
        "order": 2,
        "kind": "application_of_theorem",
        "text": "Use Lemma 3.1 to show the transport term integral is zero (due to reflecting boundaries).",
        "latex": "$$\\int_\\Omega L^\\dagger f\\,\\mathrm{d}z = 0$$",
        "references": [
          "Lem 3.1"
        ]
      },
      {
        "order": 3,
        "kind": "application_of_definition",
        "text": "Identify the killing term integral as $k_{\\text{killed}}[f]$ per definition.",
        "latex": "$$\\int_\\Omega c(z)f\\,\\mathrm{d}z = k_{\\text{killed}}[f]$$",
        "references": [
          "Def 2.3.2"
        ]
      },
      {
        "order": 4,
        "kind": "application_of_definition",
        "text": "Identify the revival term integral as $\\lambda_{\\text{revive}} m_d(t)$ per Definition 2.3.2.",
        "latex": "$$\\int_\\Omega B[f, m_d]\\,\\mathrm{d}z = \\lambda_{\\text{revive}} m_d(t)$$",
        "references": [
          "Def 2.3.2"
        ]
      },
      {
        "order": 5,
        "kind": "application_of_definition",
        "text": "Show the internal cloning term integral is zero per Definition 2.3.3.",
        "latex": "$$\\int_\\Omega S[f]\\,\\mathrm{d}z = 0$$",
        "references": [
          "Def 2.3.3"
        ]
      },
      {
        "order": 6,
        "kind": "simplification",
        "text": "Combine the results to find the total time derivative for the alive mass.",
        "latex": "$$\\frac{\\mathrm{d}}{\\mathrm{d}t}m_a(t) = -k_{\\text{killed}}[f] + \\lambda_{\\text{rev}} m_d(t)$$",
        "references": []
      },
      {
        "order": 7,
        "kind": "statement_from_premise",
        "text": "State the known time derivative for the dead mass $m_d(t)$.",
        "latex": "$$\\frac{\\mathrm{d}}{\\mathrm{d}t}m_d(t) = k_{\\text{killed}}[f] - \\lambda_{\\text{rev}} m_d(t)$$",
        "references": []
      },
      {
        "order": 8,
        "kind": "addition",
        "text": "Add the two time derivatives to show the total mass derivative is zero.",
        "latex": "$$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left[m_a(t) + m_d(t)\\right] = 0$$",
        "references": []
      }
    ],
    "key_equations": [
      {
        "label": null,
        "latex": "\\frac{\\mathrm{d}}{\\mathrm{d}t}m_a(t) = \\int_\\Omega L^\\dagger f\\,\\mathrm{d}z - \\int_\\Omega c(z)f\\,\\mathrm{d}z + \\int_\\Omega B[f, m_d]\\,\\mathrm{d}z + \\int_\\Omega S[f]\\,\\mathrm{d}z",
        "role": "derivative setup"
      },
      {
        "label": null,
        "latex": "\\frac{\\mathrm{d}}{\\mathrm{d}t}m_a(t) = -k_{\\text{killed}}[f] + \\lambda_{\\text{rev}} m_d(t)",
        "role": "alive mass rate"
      },
      {
        "label": null,
        "latex": "\\frac{\\mathrm{d}}{\\mathrm{d}t}m_d(t) = k_{\\text{killed}}[f] - \\lambda_{\\text{rev}} m_d(t)",
        "role": "dead mass rate"
      },
      {
        "label": null,
        "latex": "\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left[m_a(t) + m_d(t)\\right] = 0",
        "role": "conclusion"
      }
    ],
    "references": [],
    "cases": [],
    "remarks": [],
    "gaps": [],
    "tags": [
      "mass conservation",
      "time derivative",
      "integration",
      "flux",
      "loss-gain terms"
    ]
  },
  {
    "label": "proof-thm-killing-rate-consistency-part-i",
    "proves": "thm-killing-rate-consistency-part-i",
    "proof_type": "direct",
    "proof_status": "complete",
    "strategy_summary": "The proof analyzes the exit probability $p_{\\text{exit}}(x,v,\\tau)$ after one BAOAB timestep $\\tau$ by characterizing $x^+$ as a Gaussian random variable. It then evaluates $\\lim_{\\tau \\to 0} \\frac{1}{\\tau} p_{\\text{exit}}$ separately for interior points and boundary points, showing that only points approaching the boundary with outward velocity ($v_n>0$) yield a non-zero killing rate $c(x,v) = v_n/d(x)$, demonstrating the ballistic limit.",
    "conclusion": {},
    "assumptions": [],
    "steps": [
      {
        "order": 1,
        "kind": "characterization",
        "text": "Characterize $x^+$ as a Gaussian Random Variable $x^+ = \\mu_x(\\tau) + \\sigma_x(\\tau)\\,\\xi$, showing the noise scales as $O(\\tau^{3/2})$.",
        "latex": "$x^+ = \\mu_x(\\tau) + \\sigma_x(\\tau)\\,\\xi$",
        "references": [],
        "derived_statement": "$x^+ \\sim \\mathcal{N}(\\mu_x, \\Sigma_x)$ where $\\Sigma_x = O(\\tau^3)$"
      },
      {
        "order": 2,
        "kind": "formulation",
        "text": "Formulate the exit probability $p_{\\text{exit}}$ as a 1D Gaussian tail integral $P(Z_n \\ge d(x))$ based on the normal displacement $Z_n$, determining its mean $\\mu_n = v_n\\tau + O(\\tau^2)$ and variance $\\sigma_n^2 = C_\\sigma\\tau^3 + O(\\tau^4)$.",
        "latex": "$p_{\\text{exit}}(x,v,\\tau) = \\frac{1}{2}\\text{erfc}\\left(\\frac{d(x) - \\mu_n}{\\sqrt{2}\\sigma_n}\\right)$",
        "references": [],
        "derived_statement": "Exit probability formula"
      },
      {
        "order": 3,
        "kind": "case analysis",
        "text": "Case 1: Interior Points ($d(x) \\ge \\delta$). Show that the argument of erfc goes to $+\\infty$ as $\\tau \\to 0$, leading to super-exponential decay of $p_{\\text{exit}}$, thus $\\lim_{\\tau \\to 0}\\frac{1}{\\tau}p_{\\text{exit}} = 0$.",
        "latex": "$z \\sim \\delta/\\tau^{3/2} \\to \\infty$",
        "references": [],
        "derived_statement": "$c(x,v) = 0$ for interior points"
      },
      {
        "order": 4,
        "kind": "case analysis",
        "text": "Case 2a: Boundary Layer with Inward Velocity ($d(x) < \\delta$, $v_n \\le 0$). Show that the argument of erfc still goes to $+\\infty$ due to the drift being zero or negative, leading to $c(x,v)=0$.",
        "latex": "$z \\to \\infty$",
        "references": [],
        "derived_statement": "$c(x,v) = 0$ for inward velocity"
      },
      {
        "order": 5,
        "kind": "case analysis",
        "text": "Case 2b: Boundary Layer with Outward Velocity ($d(x) < \\delta$, $v_n > 0$). Analyze the drift-dominated regime where $\\mu_n / \\sigma_n \\sim \\tau^{-1/2} \\to \\infty$. Show that $p_{\\text{exit}}(\\tau)$ approximates a step function centered at the ballistic crossing time $\\tau_* = d(x)/v_n$.",
        "latex": "Drift-dominated: $\\sigma_n \\ll \\mu_n$",
        "references": [],
        "derived_statement": "$p_{\\text{exit}}(\\tau) \\approx H(\\tau - \\tau_*)$"
      },
      {
        "order": 6,
        "kind": "limit calculation",
        "text": "Conclude the instantaneous rate $c(x,v)$ by evaluating the limiting distribution of $(1/\\tau) p_{\\text{exit}}(\\tau)$, which corresponds to the probability flux $v_n/d(x)$ at the transition time.",
        "latex": "$\\lim_{\\tau \\to 0}\\frac{1}{\\tau}p_{\\text{exit}}(x,v,\\tau) = \\frac{v_n}{d(x)}$",
        "references": [],
        "derived_statement": "$c(x,v) = v_n/d(x)$ for ballistic crossing"
      }
    ],
    "key_equations": [
      {
        "label": "eq:x-plus-expansion",
        "latex": "x^+ = x + v\\tau + \\frac{\\tau^2}{2m}F(x) + \\frac{\\tau}{2}u_{n+1/2} + \\frac{\\tau^{3/2}}{2}\\sigma_v\\sqrt{2\\gamma}\\,\\xi + O(\\tau^3)",
        "role": "Expansion of x+"
      },
      {
        "label": "eq:exit-prob",
        "latex": "p_{\\text{exit}}(x,v,\\tau) = \\frac{1}{2}\\text{erfc}\\left(\\frac{d(x) - \\mu_n}{\\sqrt{2}\\sigma_n}\\right)",
        "role": "Exit probability formula"
      },
      {
        "label": "eq:c-final",
        "latex": "c(x,v) = \\frac{v_n}{d(x)}",
        "role": "Killing rate in ballistic limit"
      }
    ],
    "references": [],
    "cases": [
      {
        "name": "Case 1",
        "condition": "$d(x) \\ge \\delta$",
        "summary": "Interior point: exit probability decays super-exponentially, $c(x,v)=0$."
      },
      {
        "name": "Case 2a",
        "condition": "$d(x) < \\delta$ and $v_n \\le 0$",
        "summary": "Boundary layer with inward drift: exit probability decays super-exponentially, $c(x,v)=0$."
      },
      {
        "name": "Case 2b",
        "condition": "$d(x) < \\delta$ and $v_n > 0$",
        "summary": "Boundary layer with outward drift: exit probability transitions sharply at $\\tau_* = d(x)/v_n$, leading to the ballistic killing rate $c(x,v) = v_n/d(x)$."
      }
    ],
    "remarks": [],
    "gaps": [
      {
        "description": "The proof relies on the physical intuition that $\\lim_{\\tau \\to 0}(1/\\tau)H(\\tau - \\tau_*) = (1/\\tau_*) \\delta(\\tau - \\tau_*)$ which formally translates to the Dirac delta for the killing rate kernel. A rigorous proof of $\\lim_{\\tau \\to 0} \\frac{1}{\\tau}\\text{erfc}(\\zeta)$ being exactly $\\frac{v_n}{d(x)}$ when $\\tau \\approx \\tau_*$ (Case 2b) using Laplace's method or large deviation theory was summarized by physical reasoning rather than fully executed.",
        "severity": "medium",
        "location_hint": "Step 3, Case 2b asymptotic analysis"
      }
    ],
    "tags": [
      "convergence",
      "pointwise",
      "BAOAB integrator",
      "stochastic process",
      "exit probability",
      "fokker-planck",
      "asymptotics"
    ]
  },
  {
    "label": "proof-thm-killing-rate-consistency-part-ii",
    "proves": "thm-killing-rate-consistency-part-ii",
    "proof_type": "direct",
    "proof_status": "complete",
    "strategy_summary": "The proof bounds the error $E(\\tau)$ by decomposing it into density error $E_2(\\tau)$ (bounded using HÃ¶lder's inequality) and pointwise convergence error $E_1(\\tau)$. $E_1(\\tau)$ is further split into interior and boundary layer contributions, where the boundary layer error is rigorously derived to be $O(\\sqrt{\\tau})$ based on the Gaussian diffusion transition width relative to the ballistic approximation time scale.",
    "conclusion": {
      "text": "The error $E(\\tau)$ is bounded by $C\\left(\\sqrt{\\tau} + \\|f^\\tau - f\\|_{L^1}\\right)$, showing convergence consistent with the $O(\\tau^{1/2})$ error arising from the Gaussian noise width in the boundary layer transition.",
      "latex": "$|E(\\tau)| \\le C\\left(\\sqrt{\\tau} + \\|f^\\tau - f\\|_{L^1}\\right)$"
    },
    "assumptions": [
      {
        "text": "The context implies the existence of $K_{\text{discrete}}(\\tau)$, $K_{\text{continuous}}$, $f^\\tau$, $f$, $c(x,v)$, $p_{\\text{exit}}(x,v,\\tau)$, and parameters $\\delta$, $M_v$, $C_\\sigma$.",
        "latex": null
      },
      {
        "text": "The boundary layer contribution $E_{1,\\text{int}}$ is $o(\\tau^m)$ for any $m>0$ due to exponential decay of $p_{\\text{exit}}$ and vanishing $c(x,v)$ in the interior for small $\\tau$.",
        "latex": null
      },
      {
        "text": "The maximum velocity magnitude is $M_v = \\|v\\|_{\\max}$ and $c(x,v) \\le M_v/\\delta$ in the boundary layer region $\\mathcal{T}_\\delta$.",
        "latex": null
      },
      {
        "text": "The transition width $\\Delta\\tau$ scales as $O(\\tau^{1/2})$.",
        "latex": "$\\Delta\\tau \\sim O(\\tau^{1/2})$"
      }
    ],
    "steps": [],
    "key_equations": [],
    "references": [],
    "cases": [
      {
        "name": "Interior Region",
        "condition": "$d(x) \\ge \\delta$",
        "summary": "Error $E_{1,\\text{int}}$ is $o(\\tau^m)$ because $p_{\\text{exit}}$ is super-exponentially small and $c(x,v)=0$ for small $\\tau$."
      },
      {
        "name": "Boundary Layer Region",
        "condition": "$d(x) < \\delta$",
        "summary": "Error $|\\frac{1}{\\tau}p_{\\text{exit}} - c(x,v)|$ is $O(\\sqrt{\\tau})$ due to the finite width $\\Delta\\tau \\sim O(\\tau^{1/2})$ of the Gaussian transition relative to the ballistic approximation time $\\tau_*$."
      }
    ],
    "remarks": [
      {
        "type": "note",
        "text": "The $\\sqrt{\\tau}$ error arises from the Gaussian tail approximation in the drift-dominated regime, limiting the convergence rate even though the pointwise limit might suggest faster convergence based on the ballistic limit."
      },
      {
        "type": "justification",
        "text": "The result confirms the expected convergence rate for BAOAB schemes affected by $O(\\tau^{3/2})$ position noise."
      }
    ],
    "gaps": [],
    "tags": [
      "uniform convergence",
      "error analysis",
      "discrete time approximation",
      "boundary layer",
      "stochastic differential equations"
    ]
  }
]