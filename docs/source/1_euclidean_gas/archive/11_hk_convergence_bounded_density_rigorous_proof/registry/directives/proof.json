{
  "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
  "stage": "directives",
  "directive_type": "proof",
  "generated_at": "2025-11-08T17:16:20.212403+00:00",
  "count": 1,
  "items": [
    {
      "directive_type": "proof",
      "label": "lem-linearization-qsd",
      "title": null,
      "start_line": 964,
      "end_line": 1134,
      "header_lines": [
        965,
        1049
      ],
      "content_start": 966,
      "content_end": 1133,
      "content": "966: :::{prf:proof}\n967: :label: proof-thm-bounded-density-ratio-main\n968: **Proof of Theorem {prf:ref}`thm-bounded-density-ratio-main`**\n969: \n970: We split the proof into two time regimes.\n971: \n972: **Regime 1: Early Time** ($t \\in [0, T_0]$)\n973: \n974: Fix an equilibration time $T_0 = C / \\kappa_{\\text{QSD}}$ with $C$ large enough for the QSD to be well-established.\n975: \n976: **Step 1A: Upper Bound on Numerator**\n977: \n978: From Lemma {prf:ref}`lem-linfty-full-operator` (Section 2.4):\n979: \n980: $$\n981: \\sup_{t \\in [0, T_0]} \\|\\rho_t\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T_0, \\gamma, \\sigma_v, \\sigma_x, U, R)\n982: \n983: $$\n984: \n985: **Step 1B: Lower Bound on Denominator**\n986: \n987: From Lemma {prf:ref}`lem-qsd-strict-positivity` (Section 3.3):\n988: \n989: $$\n990: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\pi_{\\text{QSD}}(x) \\geq c_\\pi = c_{\\sigma_x, R} \\cdot m_{\\text{eq}}\n991: \n992: $$\n993: \n994: **Step 1C: Mass Conservation**\n995: \n996: From Lemma {prf:ref}`lem-mass-lower-bound-high-prob` (Section 4.3), for $t \\geq t_{\\text{eq}} \\leq T_0$:\n997: \n998: $$\n999: \\mathbb{P}\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - e^{-\\delta N}\n1000: \n1001: $$\n1002: \n1003: On this high-probability event, the density ratio satisfies:\n1004: \n1005: $$\n1006: \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} = \\frac{\\rho_t(x) / \\|\\rho_t\\|_{L^1}}{\\pi_{\\text{QSD}}(x) / \\|\\pi_{\\text{QSD}}\\|_{L^1}} = \\frac{\\rho_t(x)}{\\pi_{\\text{QSD}}(x)} \\cdot \\frac{m_{\\text{eq}}}{\\|\\rho_t\\|_{L^1}}\n1007: \n1008: $$\n1009: \n1010: Taking supremum over $x$:\n1011: \n1012: $$\n1013: \\sup_x \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} \\leq \\frac{\\|\\rho_t\\|_\\infty}{\\inf_x \\pi_{\\text{QSD}}(x)} \\cdot \\frac{m_{\\text{eq}}}{\\|\\rho_t\\|_{L^1}}\n1014: \n1015: $$\n1016: \n1017: Substituting the bounds from Steps 1A-1B:\n1018: \n1019: $$\n1020: \\sup_x \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} \\leq \\frac{C_{\\text{hypo}}}{c_{\\sigma_x, R} \\cdot m_{\\text{eq}}} \\cdot \\frac{m_{\\text{eq}}}{c_{\\text{mass}}} = \\frac{C_{\\text{hypo}}}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}\n1021: \n1022: $$\n1023: \n1024: Define:\n1025: \n1026: $$\n1027: M_1 := \\frac{C_{\\text{hypo}}(M_0, T_0, \\gamma, \\sigma_v, \\sigma_x, U, R)}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}\n1028: \n1029: $$\n1030: \n1031: Then:\n1032: \n1033: $$\n1034: \\sup_{t \\in [0, T_0]} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M_1 < \\infty\n1035: \n1036: $$\n1037: \n1038: **Regime 2: Late Time** ($t > T_0$)\n1039: \n1040: For late times, we use the exponential convergence to QSD combined with local stability analysis to obtain a uniform bound that does not depend on time.\n1041: \n1042: **Strategy Overview**: The key insight is that once the system is close to the QSD in total variation distance (exponentially fast by `06_convergence.md`), we can use *local regularity theory* to upgrade this weak convergence to $L^\\infty$ estimates. The argument proceeds in three steps:\n1043: \n1044: 1. **Linearization**: Show that near the QSD, the nonlinear McKean-Vlasov-Fokker-Planck equation can be analyzed via its linearization\n1045: 2. **L¹-to-L∞ Parabolic Estimate**: Use hypoelliptic regularity to bound the $L^\\infty$ norm of perturbations in terms of their $L^1$ norm\n1046: 3. **Assembly**: Combine with exponential TV convergence to obtain a time-independent bound\n1047: \n1048: **Step 2A: Linearized Operator Around the QSD**\n1049: \n1050: :::{prf:lemma} Linearization Around QSD Fixed Point\n1051: :label: lem-linearization-qsd\n1052: \n1053: Let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution satisfying:\n1054: \n1055: $$\n1056: \\mathcal{L}_{\\text{full}}^* \\pi_{\\text{QSD}} = 0\n1057: \n1058: $$\n1059: \n1060: where $\\mathcal{L}_{\\text{full}}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathcal{L}_{\\text{clone}}^* - c(z) + r_{\\text{revival}}$ is the full generator.\n1061: \n1062: For $\\rho_t = \\pi_{\\text{QSD}} + \\eta_t$ with $\\|\\eta_t\\|_{L^1} \\ll 1$ small, the perturbation $\\eta_t$ evolves according to:\n1063: \n1064: $$\n1065: \\frac{\\partial \\eta_t}{\\partial t} = \\mathbb{L}^* \\eta_t + \\mathcal{N}[\\eta_t]\n1066: \n1067: $$\n1068: \n1069: where:\n1070: - $\\mathbb{L}^*$ is the **linearized operator** (linear in $\\eta$)\n1071: - $\\mathcal{N}[\\eta]$ is the **nonlinear remainder** with $\\|\\mathcal{N}[\\eta]\\|_{L^1} = O(\\|\\eta\\|_{L^1}^2)$\n1072: \n1073: **Proof**:\n1074: \n1075: The linearization is standard in McKean-Vlasov theory. We expand each term:\n1076: \n1077: **Kinetic Operator**: $\\mathcal{L}_{\\text{kin}}^*$ is linear, so:\n1078: \n1079: $$\n1080: \\mathcal{L}_{\\text{kin}}^*(\\pi_{\\text{QSD}} + \\eta) = \\underbrace{\\mathcal{L}_{\\text{kin}}^* \\pi_{\\text{QSD}}}_{\\text{part of QSD eqn}} + \\mathcal{L}_{\\text{kin}}^* \\eta\n1081: \n1082: $$\n1083: \n1084: **Cloning Operator**: The cloning operator has the form (from `03_cloning.md`):\n1085: \n1086: $$\n1087: \\mathcal{L}_{\\text{clone}}^* f = \\int K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n1088: \n1089: $$\n1090: \n1091: where $V[f]$ depends nonlinearly on the density. Expanding around $\\pi_{\\text{QSD}}$:\n1092: \n1093: $$\n1094: V[\\pi + \\eta] = V[\\pi] + V'[\\pi] \\cdot \\eta + O(\\eta^2)\n1095: \n1096: $$\n1097: \n1098: The linear part is:\n1099: \n1100: $$\n1101: \\mathbb{L}_{\\text{clone}}^* \\eta := \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n1102: \n1103: $$\n1104: \n1105: The quadratic remainder is:\n1106: \n1107: $$\n1108: \\mathcal{N}_{\\text{clone}}[\\eta] = \\int K_{\\text{clone}}(z, z') [V'[\\pi] \\eta \\cdot \\eta + O(\\eta^2)] dz'\n1109: \n1110: $$\n1111: \n1112: **Killing and Revival**: The killing term $-c(z) f$ is linear. The revival term is:\n1113: \n1114: $$\n1115: r_{\\text{revival}} = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}\n1116: \n1117: $$\n1118: \n1119: where $m_a(t) = \\int f(t, z) dz$ is the alive mass. For $f = \\pi + \\eta$:\n1120: \n1121: $$\n1122: \\frac{1}{m_a} = \\frac{1}{m_{\\text{eq}} + \\|\\eta\\|_{L^1}} = \\frac{1}{m_{\\text{eq}}} \\left(1 - \\frac{\\|\\eta\\|_{L^1}}{m_{\\text{eq}}} + O(\\|\\eta\\|_{L^1}^2) \\right)\n1123: \n1124: $$\n1125: \n1126: This contributes a linear term and a quadratic remainder.\n1127: \n1128: **Assembly**: Combining all terms, the linearized operator is:\n1129: \n1130: $$\n1131: \\mathbb{L}^* := \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*\n1132: \n1133: $$",
      "metadata": {
        "label": "lem-linearization-qsd"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "964: :::\n965: \n966: :::{prf:proof}\n967: :label: proof-thm-bounded-density-ratio-main\n968: **Proof of Theorem {prf:ref}`thm-bounded-density-ratio-main`**\n969: \n970: We split the proof into two time regimes.\n971: \n972: **Regime 1: Early Time** ($t \\in [0, T_0]$)\n973: \n974: Fix an equilibration time $T_0 = C / \\kappa_{\\text{QSD}}$ with $C$ large enough for the QSD to be well-established.\n975: \n976: **Step 1A: Upper Bound on Numerator**\n977: \n978: From Lemma {prf:ref}`lem-linfty-full-operator` (Section 2.4):\n979: \n980: $$\n981: \\sup_{t \\in [0, T_0]} \\|\\rho_t\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T_0, \\gamma, \\sigma_v, \\sigma_x, U, R)\n982: \n983: $$\n984: \n985: **Step 1B: Lower Bound on Denominator**\n986: \n987: From Lemma {prf:ref}`lem-qsd-strict-positivity` (Section 3.3):\n988: \n989: $$\n990: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\pi_{\\text{QSD}}(x) \\geq c_\\pi = c_{\\sigma_x, R} \\cdot m_{\\text{eq}}\n991: \n992: $$\n993: \n994: **Step 1C: Mass Conservation**\n995: \n996: From Lemma {prf:ref}`lem-mass-lower-bound-high-prob` (Section 4.3), for $t \\geq t_{\\text{eq}} \\leq T_0$:\n997: \n998: $$\n999: \\mathbb{P}\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - e^{-\\delta N}\n1000: \n1001: $$\n1002: \n1003: On this high-probability event, the density ratio satisfies:\n1004: \n1005: $$\n1006: \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} = \\frac{\\rho_t(x) / \\|\\rho_t\\|_{L^1}}{\\pi_{\\text{QSD}}(x) / \\|\\pi_{\\text{QSD}}\\|_{L^1}} = \\frac{\\rho_t(x)}{\\pi_{\\text{QSD}}(x)} \\cdot \\frac{m_{\\text{eq}}}{\\|\\rho_t\\|_{L^1}}\n1007: \n1008: $$\n1009: \n1010: Taking supremum over $x$:\n1011: \n1012: $$\n1013: \\sup_x \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} \\leq \\frac{\\|\\rho_t\\|_\\infty}{\\inf_x \\pi_{\\text{QSD}}(x)} \\cdot \\frac{m_{\\text{eq}}}{\\|\\rho_t\\|_{L^1}}\n1014: \n1015: $$\n1016: \n1017: Substituting the bounds from Steps 1A-1B:\n1018: \n1019: $$\n1020: \\sup_x \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} \\leq \\frac{C_{\\text{hypo}}}{c_{\\sigma_x, R} \\cdot m_{\\text{eq}}} \\cdot \\frac{m_{\\text{eq}}}{c_{\\text{mass}}} = \\frac{C_{\\text{hypo}}}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}\n1021: \n1022: $$\n1023: \n1024: Define:\n1025: \n1026: $$\n1027: M_1 := \\frac{C_{\\text{hypo}}(M_0, T_0, \\gamma, \\sigma_v, \\sigma_x, U, R)}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}\n1028: \n1029: $$\n1030: \n1031: Then:\n1032: \n1033: $$\n1034: \\sup_{t \\in [0, T_0]} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M_1 < \\infty\n1035: \n1036: $$\n1037: \n1038: **Regime 2: Late Time** ($t > T_0$)\n1039: \n1040: For late times, we use the exponential convergence to QSD combined with local stability analysis to obtain a uniform bound that does not depend on time.\n1041: \n1042: **Strategy Overview**: The key insight is that once the system is close to the QSD in total variation distance (exponentially fast by `06_convergence.md`), we can use *local regularity theory* to upgrade this weak convergence to $L^\\infty$ estimates. The argument proceeds in three steps:\n1043: \n1044: 1. **Linearization**: Show that near the QSD, the nonlinear McKean-Vlasov-Fokker-Planck equation can be analyzed via its linearization\n1045: 2. **L¹-to-L∞ Parabolic Estimate**: Use hypoelliptic regularity to bound the $L^\\infty$ norm of perturbations in terms of their $L^1$ norm\n1046: 3. **Assembly**: Combine with exponential TV convergence to obtain a time-independent bound\n1047: \n1048: **Step 2A: Linearized Operator Around the QSD**\n1049: \n1050: :::{prf:lemma} Linearization Around QSD Fixed Point\n1051: :label: lem-linearization-qsd\n1052: \n1053: Let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution satisfying:\n1054: \n1055: $$\n1056: \\mathcal{L}_{\\text{full}}^* \\pi_{\\text{QSD}} = 0\n1057: \n1058: $$\n1059: \n1060: where $\\mathcal{L}_{\\text{full}}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathcal{L}_{\\text{clone}}^* - c(z) + r_{\\text{revival}}$ is the full generator.\n1061: \n1062: For $\\rho_t = \\pi_{\\text{QSD}} + \\eta_t$ with $\\|\\eta_t\\|_{L^1} \\ll 1$ small, the perturbation $\\eta_t$ evolves according to:\n1063: \n1064: $$\n1065: \\frac{\\partial \\eta_t}{\\partial t} = \\mathbb{L}^* \\eta_t + \\mathcal{N}[\\eta_t]\n1066: \n1067: $$\n1068: \n1069: where:\n1070: - $\\mathbb{L}^*$ is the **linearized operator** (linear in $\\eta$)\n1071: - $\\mathcal{N}[\\eta]$ is the **nonlinear remainder** with $\\|\\mathcal{N}[\\eta]\\|_{L^1} = O(\\|\\eta\\|_{L^1}^2)$\n1072: \n1073: **Proof**:\n1074: \n1075: The linearization is standard in McKean-Vlasov theory. We expand each term:\n1076: \n1077: **Kinetic Operator**: $\\mathcal{L}_{\\text{kin}}^*$ is linear, so:\n1078: \n1079: $$\n1080: \\mathcal{L}_{\\text{kin}}^*(\\pi_{\\text{QSD}} + \\eta) = \\underbrace{\\mathcal{L}_{\\text{kin}}^* \\pi_{\\text{QSD}}}_{\\text{part of QSD eqn}} + \\mathcal{L}_{\\text{kin}}^* \\eta\n1081: \n1082: $$\n1083: \n1084: **Cloning Operator**: The cloning operator has the form (from `03_cloning.md`):\n1085: \n1086: $$\n1087: \\mathcal{L}_{\\text{clone}}^* f = \\int K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n1088: \n1089: $$\n1090: \n1091: where $V[f]$ depends nonlinearly on the density. Expanding around $\\pi_{\\text{QSD}}$:\n1092: \n1093: $$\n1094: V[\\pi + \\eta] = V[\\pi] + V'[\\pi] \\cdot \\eta + O(\\eta^2)\n1095: \n1096: $$\n1097: \n1098: The linear part is:\n1099: \n1100: $$\n1101: \\mathbb{L}_{\\text{clone}}^* \\eta := \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n1102: \n1103: $$\n1104: \n1105: The quadratic remainder is:\n1106: \n1107: $$\n1108: \\mathcal{N}_{\\text{clone}}[\\eta] = \\int K_{\\text{clone}}(z, z') [V'[\\pi] \\eta \\cdot \\eta + O(\\eta^2)] dz'\n1109: \n1110: $$\n1111: \n1112: **Killing and Revival**: The killing term $-c(z) f$ is linear. The revival term is:\n1113: \n1114: $$\n1115: r_{\\text{revival}} = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}\n1116: \n1117: $$\n1118: \n1119: where $m_a(t) = \\int f(t, z) dz$ is the alive mass. For $f = \\pi + \\eta$:\n1120: \n1121: $$\n1122: \\frac{1}{m_a} = \\frac{1}{m_{\\text{eq}} + \\|\\eta\\|_{L^1}} = \\frac{1}{m_{\\text{eq}}} \\left(1 - \\frac{\\|\\eta\\|_{L^1}}{m_{\\text{eq}}} + O(\\|\\eta\\|_{L^1}^2) \\right)\n1123: \n1124: $$\n1125: \n1126: This contributes a linear term and a quadratic remainder.\n1127: \n1128: **Assembly**: Combining all terms, the linearized operator is:\n1129: \n1130: $$\n1131: \\mathbb{L}^* := \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*\n1132: \n1133: $$\n1134: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Main Theorem: Bounded Density Ratio"
      }
    }
  ]
}