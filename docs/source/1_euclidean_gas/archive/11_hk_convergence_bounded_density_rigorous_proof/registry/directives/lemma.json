{
  "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
  "stage": "directives",
  "directive_type": "lemma",
  "generated_at": "2025-11-08T17:07:43.232071+00:00",
  "count": 10,
  "items": [
    {
      "directive_type": "lemma",
      "label": "lem-hormander-bracket",
      "title": "Hörmander's Bracket Condition",
      "start_line": 96,
      "end_line": 124,
      "header_lines": [
        97
      ],
      "content_start": 99,
      "content_end": 123,
      "content": "99: :label: lem-hormander-bracket\n100: \n101: **Reference**: `06_convergence.md` Section 4.4.1, lines 892-950\n102: \n103: The kinetic generator $\\mathcal{L}_{\\text{kin}}$ has the form:\n104: \n105: $$\n106: \\mathcal{L}_{\\text{kin}} = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v + \\frac{\\sigma_v^2}{2} \\Delta_v\n107: \n108: $$\n109: \n110: where $A(x, v) = \\frac{1}{m}F(x) - \\gamma(v - u(x))$ is the velocity drift.\n111: \n112: The vector fields:\n113: - $X_0 = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v$ (drift)\n114: - $X_j = \\sigma_v \\partial_{v_j}$ (diffusion, $j = 1, \\ldots, d$)\n115: \n116: satisfy Hörmander's bracket condition:\n117: \n118: $$\n119: \\text{Lie}\\{X_0, X_1, \\ldots, X_d, [X_0, X_1], \\ldots, [X_0, X_d]\\} = T_{(x,v)}\\Omega\n120: \n121: $$\n122: \n123: at every point $(x, v) \\in \\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$.",
      "metadata": {
        "label": "lem-hormander-bracket"
      },
      "section": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities",
      "raw_directive": "96: ### 2.2. Hypoelliptic Structure of the Kinetic Operator\n97: \n98: :::{prf:lemma} Hörmander's Bracket Condition\n99: :label: lem-hormander-bracket\n100: \n101: **Reference**: `06_convergence.md` Section 4.4.1, lines 892-950\n102: \n103: The kinetic generator $\\mathcal{L}_{\\text{kin}}$ has the form:\n104: \n105: $$\n106: \\mathcal{L}_{\\text{kin}} = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v + \\frac{\\sigma_v^2}{2} \\Delta_v\n107: \n108: $$\n109: \n110: where $A(x, v) = \\frac{1}{m}F(x) - \\gamma(v - u(x))$ is the velocity drift.\n111: \n112: The vector fields:\n113: - $X_0 = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v$ (drift)\n114: - $X_j = \\sigma_v \\partial_{v_j}$ (diffusion, $j = 1, \\ldots, d$)\n115: \n116: satisfy Hörmander's bracket condition:\n117: \n118: $$\n119: \\text{Lie}\\{X_0, X_1, \\ldots, X_d, [X_0, X_1], \\ldots, [X_0, X_d]\\} = T_{(x,v)}\\Omega\n120: \n121: $$\n122: \n123: at every point $(x, v) \\in \\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$.\n124: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-linfty-full-operator",
      "title": "$L^\\infty$ Bound for the Full Operator",
      "start_line": 175,
      "end_line": 387,
      "header_lines": [
        176
      ],
      "content_start": 178,
      "content_end": 386,
      "content": "178: :label: lem-linfty-full-operator\n179: \n180: Consider the full McKean-Vlasov-Fokker-Planck equation from §2.1:\n181: \n182: $$\n183: \\frac{\\partial f}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* f + \\mathcal{L}_{\\text{clone}}^* f - c(z) f + B[f, m_d]\n184: \n185: $$\n186: \n187: with initial condition $\\|f_0\\|_\\infty \\leq M_0 < \\infty$. Assume a uniform-in-time lower bound on the alive mass, $m_a(t) = \\|f(t, \\cdot)\\|_{L^1} \\geq c_{\\text{mass}} > 0$ for all $t \\geq 0$ (to be proven in Section 4).\n188: \n189: Then for any finite time $T > 0$:\n190: \n191: $$\n192: \\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R) < \\infty\n193: \n194: $$\n195: \n196: **Proof**:\n197: \n198: We decompose the evolution into four components and bound each separately using the parabolic Harnack inequality.\n199: \n200: **Step 1: Kinetic Evolution Alone**\n201: \n202: Consider first the pure kinetic evolution $\\partial_t f = \\mathcal{L}_{\\text{kin}}^* f$ with reflecting boundary conditions. By the parabolic Harnack inequality (Theorem {prf:ref}`thm-parabolic-harnack`), for any cylinder $Q_R$:\n203: \n204: $$\n205: \\sup_{Q_{R/2}^-} f \\leq C_H \\inf_{Q_{R/2}^+} f\n206: \n207: $$\n208: \n209: For the initial value problem with $\\|f_0\\|_\\infty \\leq M_0$, we apply this iteratively over time slices to obtain:\n210: \n211: $$\n212: \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(t, \\gamma, \\sigma_v, R, d) M_0\n213: \n214: $$\n215: \n216: where $C_{\\text{kin}}(t, \\cdot)$ is the hypoelliptic smoothing constant. For $t \\geq t_{\\text{mix}}$ (mixing time), this becomes a constant independent of $t$.\n217: \n218: **Key Quantitative Bound**: Using the explicit Gaussian heat kernel estimates from Hérau & Nier (2004, Lemma 2.1), for $t \\geq \\tau$ (one timestep):\n219: \n220: $$\n221: C_{\\text{kin}}(t, \\cdot) \\leq C_0 \\left( \\frac{R^2}{\\sigma_v^2 \\gamma t} \\right)^{d/2} + C_1\n222: \n223: $$\n224: \n225: where $C_0, C_1$ depend only on the bracket depth and dimension.\n226: \n227: **Step 2: Cloning Operator **\n228: \n229: The cloning operator with Gaussian position jitter has the form (from `03_cloning.md` line 6022):\n230: \n231: $$\n232: \\mathcal{L}_{\\text{clone}}^* f = \\int_\\Omega K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n233: \n234: $$\n235: \n236: where:\n237: - $K_{\\text{clone}}(z, z') = \\frac{1}{(2\\pi\\sigma_x^2)^{d/2}} \\exp(-\\|x - x'\\|^2 / (2\\sigma_x^2)) \\times \\delta(v - v')$ is the Gaussian kernel\n238: - $V[f](z, z')$ is the **fitness weighting functional** (depends nonlinearly on $f$ via virtual reward)\n239: \n240: **Critical Observation**: The cloning operator is **NOT** a simple convolution due to the fitness weighting $V[f]$. The operator has a nonlinear source-sink structure:\n241: \n242: $$\n243: \\mathcal{L}_{\\text{clone}}^* f(z) = \\underbrace{\\int K_{\\text{clone}}(z, z') V[f](z, z') f(z') dz'}_{\\text{source}} - \\underbrace{f(z) \\int K_{\\text{clone}}(z, z') V[f](z, z') dz'}_{\\text{sink}}\n244: \n245: $$\n246: \n247: **Revised $L^\\infty$ Bound**: The fitness functional satisfies (from `03_cloning.md`):\n248: \n249: $$\n250: 0 \\leq V[f](z, z') \\leq V_{\\max} := \\max\\left(1, \\frac{1}{\\eta}\\right)\n251: \n252: $$\n253: \n254: where $\\eta \\in (0, 1)$ is the rescaling parameter. Therefore:\n255: \n256: $$\n257: |\\mathcal{L}_{\\text{clone}}^* f(z)| \\leq V_{\\max} \\left[\\int K_{\\text{clone}}(z, z') f(z') dz' + f(z) \\int K_{\\text{clone}}(z, z') dz'\\right]\n258: \n259: $$\n260: \n261: Since $\\int K_{\\text{clone}}(z, z') dz' = 1$ (normalized kernel) and the convolution $\\int K f' dx' \\leq \\|f\\|_\\infty$:\n262: \n263: $$\n264: \\|\\mathcal{L}_{\\text{clone}}^* f\\|_\\infty \\leq 2 V_{\\max} \\|f\\|_\\infty\n265: \n266: $$\n267: \n268: Over a timestep $\\tau$, using forward Euler for the source term:\n269: \n270: $$\n271: \\|f_{\\text{post-clone}}\\|_\\infty \\leq (1 + 2 V_{\\max} \\tau) \\|f_{\\text{pre-clone}}\\|_\\infty\n272: \n273: $$\n274: \n275: **Impact**: This increases the hypoelliptic constant $C_{\\text{hypo}}$ by a factor $(1 + 2V_{\\max}\\tau)^{T/\\tau}$, but remains finite for finite time $T$.\n276: \n277: **Step 3: Killing Term**\n278: \n279: The killing term $-c(z) f$ with $c(z) \\geq 0$ only removes mass:\n280: \n281: $$\n282: \\|f_{\\text{post-kill}}\\|_\\infty \\leq \\|f_{\\text{pre-kill}}\\|_\\infty\n283: \n284: $$\n285: \n286: **Step 4: Revival Term (Mass-Dependent Source)**\n287: \n288: The revival operator re-injects mass into the safe region. From `07_mean_field.md`, the revival source has the form\n289: \n290: $$\n291: r_{\\text{revival}}(z) = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}(z),\n292: $$\n293: \n294: where $m_a(t) = \\int f(t, z) dz$ is the alive mass and $m_d(t)$ is the dead-mass flux. The kernel $f_{\\text{safe}}$ is deterministic, compactly supported, and normalized ($\\int f_{\\text{safe}} = 1$). On the event that Section 4 proves $m_a(t) \\geq c_{\\text{mass}}$, we have\n295: \n296: $$\n297: \\frac{m_d(t)}{m_a(t)} = \\frac{\\int c(z) f(t,z) dz}{m_a(t)} \\leq \\|c\\|_\\infty.\n298: $$\n299: \n300: Therefore\n301: \n302: $$\n303: \\|r_{\\text{revival}}\\|_\\infty \\leq \\lambda_{\\text{rev}} \\|c\\|_\\infty \\|f_{\\text{safe}}\\|_\\infty =: C_{\\text{safe}},\n304: $$\n305: \n306: which is a state-independent constant (no additional factor of $\\|f\\|_\\infty$ appears).\n307: \n308: **Step 5: Volterra Inequality for the Supremum Norm**\n309: \n310: Using the Duhamel formula for the full equation over time interval $[0, T]$:\n311: \n312: $$\n313: f(T, z) = \\int_\\Omega p_T^{\\text{kin}}(z, z') f_0(z') dz' + \\int_0^T \\int_\\Omega p_{T-s}^{\\text{kin}}(z, z') S[f](s, z') dz' ds\n314: \n315: $$\n316: \n317: where $S[f] = \\mathcal{L}_{\\text{clone}}^* f - c f + B[f, m_d]$ is the source term and $p_t^{\\text{kin}}$ is the kinetic heat kernel.\n318: \n319: Taking supremum:\n320: \n321: $$\n322: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\|S[f](s, \\cdot)\\|_\\infty ds\n323: \n324: $$\n325: \n326: Since cloning and killing preserve $L^\\infty$ bounds (Steps 2-3), and revival adds at most $C_{\\text{revival}}$ per unit time (Step 4):\n327: \n328: $$\n329: \\|S[f](s, \\cdot)\\|_\\infty \\leq \\|f(s, \\cdot)\\|_\\infty + C_{\\text{revival}}\n330: \n331: $$\n332: \n333: This gives the integral inequality:\n334: \n335: $$\n336: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\Big[(2V_{\\max} + \\|c\\|_\\infty) \\|f(s, \\cdot)\\|_\\infty + C_{\\text{safe}}\\Big] ds.\n337: $$\n338: \n339: Define $u(t) = \\|f(t, \\cdot)\\|_\\infty$, $B_* := 2V_{\\max} + \\|c\\|_\\infty$, and $\\kappa_{\\text{kin}}(T) := \\int_0^T C_{\\text{kin}}(s) ds < \\infty$ (the kinetic estimate from Step 1 implies integrability). Then\n340: \n341: $$\n342: u(T) \\leq C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) + B_* \\int_0^T C_{\\text{kin}}(T - s) u(s) ds.\n343: $$\n344: \n345: **Step 6: Resolvent Grönwall Argument**\n346: \n347: Let $C_{\\text{kin}}^{\\max}(T) = \\sup_{0 \\leq s \\leq T} C_{\\text{kin}}(s)$ and $\\Psi(T) = \\int_0^T u(s) ds$. The convolution term satisfies\n348: \n349: $$\n350: \\int_0^T C_{\\text{kin}}(T - s) u(s) ds \\leq C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n351: $$\n352: \n353: Hence\n354: \n355: $$\n356: u(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T),\n357: \\qquad\n358: A_T := C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T).\n359: $$\n360: \n361: Differentiating $\\Psi$ yields the Volterra inequality\n362: \n363: $$\n364: \\Psi'(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n365: $$\n366: \n367: Gronwall’s lemma for first-order linear ODEs gives\n368: \n369: $$\n370: \\Psi(T) \\leq \\int_0^T A_s \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) (T-s)\\right) ds.\n371: $$\n372: \n373: Since $A_s \\leq C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) =: A_*$ for $s \\in [0, T]$, we obtain\n374: \n375: $$\n376: u(T) \\leq A_* \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n377: $$\n378: \n379: Therefore the hypoelliptic $L^\\infty$ bound holds with the explicit constant\n380: \n381: $$\n382: C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R)\n383: := \\Big[C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T)\\Big]\n384: \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n385: $$\n386: ",
      "metadata": {
        "label": "lem-linfty-full-operator"
      },
      "section": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities",
      "raw_directive": "175: The full equation includes non-local cloning terms, killing, and revival. We handle these perturbatively:\n176: \n177: :::{prf:lemma} $L^\\infty$ Bound for the Full Operator\n178: :label: lem-linfty-full-operator\n179: \n180: Consider the full McKean-Vlasov-Fokker-Planck equation from §2.1:\n181: \n182: $$\n183: \\frac{\\partial f}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* f + \\mathcal{L}_{\\text{clone}}^* f - c(z) f + B[f, m_d]\n184: \n185: $$\n186: \n187: with initial condition $\\|f_0\\|_\\infty \\leq M_0 < \\infty$. Assume a uniform-in-time lower bound on the alive mass, $m_a(t) = \\|f(t, \\cdot)\\|_{L^1} \\geq c_{\\text{mass}} > 0$ for all $t \\geq 0$ (to be proven in Section 4).\n188: \n189: Then for any finite time $T > 0$:\n190: \n191: $$\n192: \\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R) < \\infty\n193: \n194: $$\n195: \n196: **Proof**:\n197: \n198: We decompose the evolution into four components and bound each separately using the parabolic Harnack inequality.\n199: \n200: **Step 1: Kinetic Evolution Alone**\n201: \n202: Consider first the pure kinetic evolution $\\partial_t f = \\mathcal{L}_{\\text{kin}}^* f$ with reflecting boundary conditions. By the parabolic Harnack inequality (Theorem {prf:ref}`thm-parabolic-harnack`), for any cylinder $Q_R$:\n203: \n204: $$\n205: \\sup_{Q_{R/2}^-} f \\leq C_H \\inf_{Q_{R/2}^+} f\n206: \n207: $$\n208: \n209: For the initial value problem with $\\|f_0\\|_\\infty \\leq M_0$, we apply this iteratively over time slices to obtain:\n210: \n211: $$\n212: \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(t, \\gamma, \\sigma_v, R, d) M_0\n213: \n214: $$\n215: \n216: where $C_{\\text{kin}}(t, \\cdot)$ is the hypoelliptic smoothing constant. For $t \\geq t_{\\text{mix}}$ (mixing time), this becomes a constant independent of $t$.\n217: \n218: **Key Quantitative Bound**: Using the explicit Gaussian heat kernel estimates from Hérau & Nier (2004, Lemma 2.1), for $t \\geq \\tau$ (one timestep):\n219: \n220: $$\n221: C_{\\text{kin}}(t, \\cdot) \\leq C_0 \\left( \\frac{R^2}{\\sigma_v^2 \\gamma t} \\right)^{d/2} + C_1\n222: \n223: $$\n224: \n225: where $C_0, C_1$ depend only on the bracket depth and dimension.\n226: \n227: **Step 2: Cloning Operator **\n228: \n229: The cloning operator with Gaussian position jitter has the form (from `03_cloning.md` line 6022):\n230: \n231: $$\n232: \\mathcal{L}_{\\text{clone}}^* f = \\int_\\Omega K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n233: \n234: $$\n235: \n236: where:\n237: - $K_{\\text{clone}}(z, z') = \\frac{1}{(2\\pi\\sigma_x^2)^{d/2}} \\exp(-\\|x - x'\\|^2 / (2\\sigma_x^2)) \\times \\delta(v - v')$ is the Gaussian kernel\n238: - $V[f](z, z')$ is the **fitness weighting functional** (depends nonlinearly on $f$ via virtual reward)\n239: \n240: **Critical Observation**: The cloning operator is **NOT** a simple convolution due to the fitness weighting $V[f]$. The operator has a nonlinear source-sink structure:\n241: \n242: $$\n243: \\mathcal{L}_{\\text{clone}}^* f(z) = \\underbrace{\\int K_{\\text{clone}}(z, z') V[f](z, z') f(z') dz'}_{\\text{source}} - \\underbrace{f(z) \\int K_{\\text{clone}}(z, z') V[f](z, z') dz'}_{\\text{sink}}\n244: \n245: $$\n246: \n247: **Revised $L^\\infty$ Bound**: The fitness functional satisfies (from `03_cloning.md`):\n248: \n249: $$\n250: 0 \\leq V[f](z, z') \\leq V_{\\max} := \\max\\left(1, \\frac{1}{\\eta}\\right)\n251: \n252: $$\n253: \n254: where $\\eta \\in (0, 1)$ is the rescaling parameter. Therefore:\n255: \n256: $$\n257: |\\mathcal{L}_{\\text{clone}}^* f(z)| \\leq V_{\\max} \\left[\\int K_{\\text{clone}}(z, z') f(z') dz' + f(z) \\int K_{\\text{clone}}(z, z') dz'\\right]\n258: \n259: $$\n260: \n261: Since $\\int K_{\\text{clone}}(z, z') dz' = 1$ (normalized kernel) and the convolution $\\int K f' dx' \\leq \\|f\\|_\\infty$:\n262: \n263: $$\n264: \\|\\mathcal{L}_{\\text{clone}}^* f\\|_\\infty \\leq 2 V_{\\max} \\|f\\|_\\infty\n265: \n266: $$\n267: \n268: Over a timestep $\\tau$, using forward Euler for the source term:\n269: \n270: $$\n271: \\|f_{\\text{post-clone}}\\|_\\infty \\leq (1 + 2 V_{\\max} \\tau) \\|f_{\\text{pre-clone}}\\|_\\infty\n272: \n273: $$\n274: \n275: **Impact**: This increases the hypoelliptic constant $C_{\\text{hypo}}$ by a factor $(1 + 2V_{\\max}\\tau)^{T/\\tau}$, but remains finite for finite time $T$.\n276: \n277: **Step 3: Killing Term**\n278: \n279: The killing term $-c(z) f$ with $c(z) \\geq 0$ only removes mass:\n280: \n281: $$\n282: \\|f_{\\text{post-kill}}\\|_\\infty \\leq \\|f_{\\text{pre-kill}}\\|_\\infty\n283: \n284: $$\n285: \n286: **Step 4: Revival Term (Mass-Dependent Source)**\n287: \n288: The revival operator re-injects mass into the safe region. From `07_mean_field.md`, the revival source has the form\n289: \n290: $$\n291: r_{\\text{revival}}(z) = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}(z),\n292: $$\n293: \n294: where $m_a(t) = \\int f(t, z) dz$ is the alive mass and $m_d(t)$ is the dead-mass flux. The kernel $f_{\\text{safe}}$ is deterministic, compactly supported, and normalized ($\\int f_{\\text{safe}} = 1$). On the event that Section 4 proves $m_a(t) \\geq c_{\\text{mass}}$, we have\n295: \n296: $$\n297: \\frac{m_d(t)}{m_a(t)} = \\frac{\\int c(z) f(t,z) dz}{m_a(t)} \\leq \\|c\\|_\\infty.\n298: $$\n299: \n300: Therefore\n301: \n302: $$\n303: \\|r_{\\text{revival}}\\|_\\infty \\leq \\lambda_{\\text{rev}} \\|c\\|_\\infty \\|f_{\\text{safe}}\\|_\\infty =: C_{\\text{safe}},\n304: $$\n305: \n306: which is a state-independent constant (no additional factor of $\\|f\\|_\\infty$ appears).\n307: \n308: **Step 5: Volterra Inequality for the Supremum Norm**\n309: \n310: Using the Duhamel formula for the full equation over time interval $[0, T]$:\n311: \n312: $$\n313: f(T, z) = \\int_\\Omega p_T^{\\text{kin}}(z, z') f_0(z') dz' + \\int_0^T \\int_\\Omega p_{T-s}^{\\text{kin}}(z, z') S[f](s, z') dz' ds\n314: \n315: $$\n316: \n317: where $S[f] = \\mathcal{L}_{\\text{clone}}^* f - c f + B[f, m_d]$ is the source term and $p_t^{\\text{kin}}$ is the kinetic heat kernel.\n318: \n319: Taking supremum:\n320: \n321: $$\n322: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\|S[f](s, \\cdot)\\|_\\infty ds\n323: \n324: $$\n325: \n326: Since cloning and killing preserve $L^\\infty$ bounds (Steps 2-3), and revival adds at most $C_{\\text{revival}}$ per unit time (Step 4):\n327: \n328: $$\n329: \\|S[f](s, \\cdot)\\|_\\infty \\leq \\|f(s, \\cdot)\\|_\\infty + C_{\\text{revival}}\n330: \n331: $$\n332: \n333: This gives the integral inequality:\n334: \n335: $$\n336: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\Big[(2V_{\\max} + \\|c\\|_\\infty) \\|f(s, \\cdot)\\|_\\infty + C_{\\text{safe}}\\Big] ds.\n337: $$\n338: \n339: Define $u(t) = \\|f(t, \\cdot)\\|_\\infty$, $B_* := 2V_{\\max} + \\|c\\|_\\infty$, and $\\kappa_{\\text{kin}}(T) := \\int_0^T C_{\\text{kin}}(s) ds < \\infty$ (the kinetic estimate from Step 1 implies integrability). Then\n340: \n341: $$\n342: u(T) \\leq C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) + B_* \\int_0^T C_{\\text{kin}}(T - s) u(s) ds.\n343: $$\n344: \n345: **Step 6: Resolvent Grönwall Argument**\n346: \n347: Let $C_{\\text{kin}}^{\\max}(T) = \\sup_{0 \\leq s \\leq T} C_{\\text{kin}}(s)$ and $\\Psi(T) = \\int_0^T u(s) ds$. The convolution term satisfies\n348: \n349: $$\n350: \\int_0^T C_{\\text{kin}}(T - s) u(s) ds \\leq C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n351: $$\n352: \n353: Hence\n354: \n355: $$\n356: u(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T),\n357: \\qquad\n358: A_T := C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T).\n359: $$\n360: \n361: Differentiating $\\Psi$ yields the Volterra inequality\n362: \n363: $$\n364: \\Psi'(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n365: $$\n366: \n367: Gronwall’s lemma for first-order linear ODEs gives\n368: \n369: $$\n370: \\Psi(T) \\leq \\int_0^T A_s \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) (T-s)\\right) ds.\n371: $$\n372: \n373: Since $A_s \\leq C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) =: A_*$ for $s \\in [0, T]$, we obtain\n374: \n375: $$\n376: u(T) \\leq A_* \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n377: $$\n378: \n379: Therefore the hypoelliptic $L^\\infty$ bound holds with the explicit constant\n380: \n381: $$\n382: C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R)\n383: := \\Big[C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T)\\Big]\n384: \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n385: $$\n386: \n387: This constant is finite for every finite $T$, depends on all physical parameters, and controls $\\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty$. $\\square$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-gaussian-kernel-lower-bound",
      "title": "Gaussian Kernel Lower Bound",
      "start_line": 399,
      "end_line": 449,
      "header_lines": [
        400
      ],
      "content_start": 402,
      "content_end": 448,
      "content": "402: :label: lem-gaussian-kernel-lower-bound\n403: \n404: Let $G_{\\sigma_x}(y) = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-\\|y\\|^2 / (2\\sigma_x^2))$ be the Gaussian kernel with variance $\\sigma_x^2 > 0$.\n405: \n406: For any $x_1, x_2 \\in B_R(0) \\subset \\mathbb{R}^d$:\n407: \n408: $$\n409: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} \\leq \\exp\\left( \\frac{(2R)^2}{2\\sigma_x^2} \\right)\n410: \n411: $$\n412: \n413: Moreover, for any integrable density $\\rho$ with $\\|\\rho\\|_{L^1} = m > 0$:\n414: \n415: $$\n416: \\inf_{x \\in B_R} \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq m \\cdot c_{\\sigma_x, R}\n417: \n418: $$\n419: \n420: where:\n421: \n422: $$\n423: c_{\\sigma_x, R} := (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) > 0\n424: \n425: $$\n426: \n427: **Proof**:\n428: \n429: For the ratio bound, note that for $x_1, x_2 \\in B_R$:\n430: \n431: $$\n432: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} = \\exp\\left( \\frac{\\|x_2\\|^2 - \\|x_1\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{\\|x_2\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{R^2}{2\\sigma_x^2} \\right)\n433: \n434: $$\n435: \n436: For the lower bound, fix $x \\in B_R$. For any $y \\in B_R$, $\\|x - y\\| \\leq 2R$, so:\n437: \n438: $$\n439: G_{\\sigma_x}(x - y) \\geq (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) = c_{\\sigma_x, R}\n440: \n441: $$\n442: \n443: Therefore:\n444: \n445: $$\n446: \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq c_{\\sigma_x, R} \\int_{B_R} \\rho(y) dy = c_{\\sigma_x, R} \\cdot m\n447: \n448: $$",
      "metadata": {
        "label": "lem-gaussian-kernel-lower-bound"
      },
      "section": "## 3. Gaussian Mollification and Uniform Lower Bounds",
      "raw_directive": "399: ### 3.1. Quantitative Gaussian Mollification Bounds\n400: \n401: :::{prf:lemma} Gaussian Kernel Lower Bound\n402: :label: lem-gaussian-kernel-lower-bound\n403: \n404: Let $G_{\\sigma_x}(y) = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-\\|y\\|^2 / (2\\sigma_x^2))$ be the Gaussian kernel with variance $\\sigma_x^2 > 0$.\n405: \n406: For any $x_1, x_2 \\in B_R(0) \\subset \\mathbb{R}^d$:\n407: \n408: $$\n409: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} \\leq \\exp\\left( \\frac{(2R)^2}{2\\sigma_x^2} \\right)\n410: \n411: $$\n412: \n413: Moreover, for any integrable density $\\rho$ with $\\|\\rho\\|_{L^1} = m > 0$:\n414: \n415: $$\n416: \\inf_{x \\in B_R} \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq m \\cdot c_{\\sigma_x, R}\n417: \n418: $$\n419: \n420: where:\n421: \n422: $$\n423: c_{\\sigma_x, R} := (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) > 0\n424: \n425: $$\n426: \n427: **Proof**:\n428: \n429: For the ratio bound, note that for $x_1, x_2 \\in B_R$:\n430: \n431: $$\n432: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} = \\exp\\left( \\frac{\\|x_2\\|^2 - \\|x_1\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{\\|x_2\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{R^2}{2\\sigma_x^2} \\right)\n433: \n434: $$\n435: \n436: For the lower bound, fix $x \\in B_R$. For any $y \\in B_R$, $\\|x - y\\| \\leq 2R$, so:\n437: \n438: $$\n439: G_{\\sigma_x}(x - y) \\geq (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) = c_{\\sigma_x, R}\n440: \n441: $$\n442: \n443: Therefore:\n444: \n445: $$\n446: \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq c_{\\sigma_x, R} \\int_{B_R} \\rho(y) dy = c_{\\sigma_x, R} \\cdot m\n447: \n448: $$\n449: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Gaussian Mollification and Uniform Lower Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-strict-positivity-cloning",
      "title": "Strict Positivity After Cloning",
      "start_line": 453,
      "end_line": 494,
      "header_lines": [
        454
      ],
      "content_start": 456,
      "content_end": 493,
      "content": "456: :label: lem-strict-positivity-cloning\n457: \n458: After applying the cloning operator with Gaussian position jitter $\\sigma_x > 0$, the density satisfies:\n459: \n460: $$\n461: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n462: \n463: $$\n464: \n465: where $c_{\\sigma_x, R}$ is defined in Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`.\n466: \n467: **Proof**: From `03_cloning.md` (line 6022), the position update is:\n468: \n469: $$\n470: x_i' = x_j + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n471: \n472: $$\n473: \n474: In the mean-field limit, this corresponds to convolution with the Gaussian kernel:\n475: \n476: $$\n477: \\rho_{\\text{post-clone}}(x) = \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) w(y) \\rho_{\\text{pre-clone}}(y) dy\n478: \n479: $$\n480: \n481: where $w(y)$ is the fitness weighting (always positive). Since $w(y) \\geq \\eta > 0$ (floor from rescale transformation, `01_fragile_gas_framework.md`), we have:\n482: \n483: $$\n484: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) \\rho_{\\text{pre-clone}}(y) dy\n485: \n486: $$\n487: \n488: Applying Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`:\n489: \n490: $$\n491: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\cdot c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n492: \n493: $$",
      "metadata": {
        "label": "lem-strict-positivity-cloning"
      },
      "section": "## 3. Gaussian Mollification and Uniform Lower Bounds",
      "raw_directive": "453: ### 3.2. Lower Bound on Post-Cloning Density\n454: \n455: :::{prf:lemma} Strict Positivity After Cloning\n456: :label: lem-strict-positivity-cloning\n457: \n458: After applying the cloning operator with Gaussian position jitter $\\sigma_x > 0$, the density satisfies:\n459: \n460: $$\n461: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n462: \n463: $$\n464: \n465: where $c_{\\sigma_x, R}$ is defined in Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`.\n466: \n467: **Proof**: From `03_cloning.md` (line 6022), the position update is:\n468: \n469: $$\n470: x_i' = x_j + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n471: \n472: $$\n473: \n474: In the mean-field limit, this corresponds to convolution with the Gaussian kernel:\n475: \n476: $$\n477: \\rho_{\\text{post-clone}}(x) = \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) w(y) \\rho_{\\text{pre-clone}}(y) dy\n478: \n479: $$\n480: \n481: where $w(y)$ is the fitness weighting (always positive). Since $w(y) \\geq \\eta > 0$ (floor from rescale transformation, `01_fragile_gas_framework.md`), we have:\n482: \n483: $$\n484: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) \\rho_{\\text{pre-clone}}(y) dy\n485: \n486: $$\n487: \n488: Applying Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`:\n489: \n490: $$\n491: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\cdot c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n492: \n493: $$\n494: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Gaussian Mollification and Uniform Lower Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-qsd-strict-positivity",
      "title": "QSD Strict Positivity",
      "start_line": 498,
      "end_line": 588,
      "header_lines": [
        499
      ],
      "content_start": 501,
      "content_end": 587,
      "content": "501: :label: lem-qsd-strict-positivity\n502: \n503: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ has a smooth density with respect to Lebesgue measure that satisfies\n504: \n505: $$\n506: \\inf_{(x,v) \\in \\Omega} \\pi_{\\text{QSD}}(x, v) \\geq c_\\pi > 0,\n507: $$\n508: \n509: where $\\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$ and\n510: \n511: $$\n512: c_\\pi = \\big(\\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R}\\big) \\, m_{\\text{eq}},\n513: \\qquad\n514: c_{\\text{vel}} := (2\\pi\\sigma_v^2 \\beta_\\star)^{-d/2} \\exp\\!\\left(-\\frac{4 V_{\\max}^2}{2 \\sigma_v^2 \\beta_\\star}\\right).\n515: $$\n516: \n517: Here $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ and $\\beta_\\star = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$ for a fixed velocity-refresh time $\\tau_v > 0$.\n518: \n519: **Proof**:\n520: \n521: **Step 1 (Velocity Refresh via Ornstein-Uhlenbeck Block)**  \n522: During a kinetic window of length $\\tau_v$, the BAOAB operator evolves the velocity according to\n523: \n524: $$\n525: p_v^{\\text{OU}}(\\tau_v; v_0, v)\n526: = (2\\pi\\sigma_v^2 \\beta(\\tau_v))^{-d/2}\n527: \\exp\\!\\left(-\\frac{|v - e^{-\\gamma \\tau_v} v_0|^2}{2 \\sigma_v^2 \\beta(\\tau_v)}\\right),\n528: $$\n529: \n530: with $\\beta(\\tau_v) = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$. Because $V_{\\text{alg}}$ is compact ($|v| \\leq V_{\\max}$), choosing $\\tau_v$ so that $\\beta(\\tau_v) \\geq \\beta_\\star>0$ gives\n531: \n532: $$\n533: p_v^{\\text{OU}}(\\tau_v; v_0, v) \\geq c_{\\text{vel}}\n534: \\quad \\text{for all } v_0, v \\in V_{\\text{alg}}.\n535: $$\n536: \n537: Hence a single kinetic block already spreads mass over **all** velocity directions with a state-independent density floor. This removes the previous restriction to velocity balls around $v_0$.\n538: \n539: **Step 2 (Spatial Mollification Without Velocity Restriction)**  \n540: Conditioned on any $(x_1, v_1)$ produced by Step 1, the cloning kernel\n541: \n542: $$\n543: K_{\\text{clone}}\\big((x_1, v_1), (x, v)\\big)\n544: = \\eta \\, G_{\\sigma_x}(x - x_1) \\, \\delta(v - v_1)\n545: $$\n546: \n547: acts on the position coordinate. Lemma {prf:ref}`lem-gaussian-kernel-lower-bound` implies\n548: \n549: $$\n550: G_{\\sigma_x}(x - x_1) \\geq c_{\\sigma_x, R}\n551: \\qquad \\forall x, x_1 \\in \\mathcal{X}_{\\text{valid}},\n552: $$\n553: \n554: so positions are minorized by Lebesgue measure independently of the pre-cloning state.\n555: \n556: **Step 3 (Two-Step Doeblin Minorization)**  \n557: Let $P^{(2)}$ denote “kinetic over $\\tau_v$” composed with “cloning.” For any measurable $A \\subseteq \\Omega$,\n558: \n559: $$\n560: P^{(2)}((x_0, v_0), A)\n561: = \\int_\\Omega p_v^{\\text{OU}}(\\tau_v; v_0, v_1) K_{\\text{clone}}\\big((x_1, v_1), A\\big) \\, dx_1 \\, dv_1\n562: \\geq \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R} \\, |A|,\n563: $$\n564: \n565: where $|A|$ is the Lebesgue measure of $A$ in $\\Omega$. Thus $P^{(2)}$ satisfies a genuine Doeblin condition\n566: \n567: $$\n568: P^{(2)}(z, A) \\geq \\delta_2 \\, \\nu(A),\n569: \\qquad\n570: \\delta_2 := \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R},\n571: $$\n572: \n573: with state-independent minorization measure $\\nu(A) = |A|/|\\Omega|$.\n574: \n575: **Step 4 (Transfer to the QSD)**  \n576: For the invariant quasi-stationary distribution,\n577: \n578: $$\n579: \\pi_{\\text{QSD}}(A)\n580: = \\int_\\Omega P^{(2)}(z, A) \\, \\pi_{\\text{QSD}}(dz)\n581: \\geq \\delta_2 \\, m_{\\text{eq}} \\, \\nu(A),\n582: $$\n583: \n584: so $\\pi_{\\text{QSD}}$ possesses a density bounded below by $c_\\pi = \\delta_2 m_{\\text{eq}} / |\\Omega|$ at every point of $\\Omega$.\n585: \n586: **Step 5 (Smoothness)**  \n587: Lemma {prf:ref}`lem-linfty-full-operator` provides hypoelliptic smoothing, giving $\\pi_{\\text{QSD}} \\in C^\\infty(\\Omega)$ and promoting the almost-everywhere lower bound to a pointwise one.",
      "metadata": {
        "label": "lem-qsd-strict-positivity"
      },
      "section": "## 3. Gaussian Mollification and Uniform Lower Bounds",
      "raw_directive": "498: ### 3.3. QSD Density Lower Bound via Multi-Step Minorization\n499: \n500: :::{prf:lemma} QSD Strict Positivity\n501: :label: lem-qsd-strict-positivity\n502: \n503: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ has a smooth density with respect to Lebesgue measure that satisfies\n504: \n505: $$\n506: \\inf_{(x,v) \\in \\Omega} \\pi_{\\text{QSD}}(x, v) \\geq c_\\pi > 0,\n507: $$\n508: \n509: where $\\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$ and\n510: \n511: $$\n512: c_\\pi = \\big(\\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R}\\big) \\, m_{\\text{eq}},\n513: \\qquad\n514: c_{\\text{vel}} := (2\\pi\\sigma_v^2 \\beta_\\star)^{-d/2} \\exp\\!\\left(-\\frac{4 V_{\\max}^2}{2 \\sigma_v^2 \\beta_\\star}\\right).\n515: $$\n516: \n517: Here $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ and $\\beta_\\star = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$ for a fixed velocity-refresh time $\\tau_v > 0$.\n518: \n519: **Proof**:\n520: \n521: **Step 1 (Velocity Refresh via Ornstein-Uhlenbeck Block)**  \n522: During a kinetic window of length $\\tau_v$, the BAOAB operator evolves the velocity according to\n523: \n524: $$\n525: p_v^{\\text{OU}}(\\tau_v; v_0, v)\n526: = (2\\pi\\sigma_v^2 \\beta(\\tau_v))^{-d/2}\n527: \\exp\\!\\left(-\\frac{|v - e^{-\\gamma \\tau_v} v_0|^2}{2 \\sigma_v^2 \\beta(\\tau_v)}\\right),\n528: $$\n529: \n530: with $\\beta(\\tau_v) = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$. Because $V_{\\text{alg}}$ is compact ($|v| \\leq V_{\\max}$), choosing $\\tau_v$ so that $\\beta(\\tau_v) \\geq \\beta_\\star>0$ gives\n531: \n532: $$\n533: p_v^{\\text{OU}}(\\tau_v; v_0, v) \\geq c_{\\text{vel}}\n534: \\quad \\text{for all } v_0, v \\in V_{\\text{alg}}.\n535: $$\n536: \n537: Hence a single kinetic block already spreads mass over **all** velocity directions with a state-independent density floor. This removes the previous restriction to velocity balls around $v_0$.\n538: \n539: **Step 2 (Spatial Mollification Without Velocity Restriction)**  \n540: Conditioned on any $(x_1, v_1)$ produced by Step 1, the cloning kernel\n541: \n542: $$\n543: K_{\\text{clone}}\\big((x_1, v_1), (x, v)\\big)\n544: = \\eta \\, G_{\\sigma_x}(x - x_1) \\, \\delta(v - v_1)\n545: $$\n546: \n547: acts on the position coordinate. Lemma {prf:ref}`lem-gaussian-kernel-lower-bound` implies\n548: \n549: $$\n550: G_{\\sigma_x}(x - x_1) \\geq c_{\\sigma_x, R}\n551: \\qquad \\forall x, x_1 \\in \\mathcal{X}_{\\text{valid}},\n552: $$\n553: \n554: so positions are minorized by Lebesgue measure independently of the pre-cloning state.\n555: \n556: **Step 3 (Two-Step Doeblin Minorization)**  \n557: Let $P^{(2)}$ denote “kinetic over $\\tau_v$” composed with “cloning.” For any measurable $A \\subseteq \\Omega$,\n558: \n559: $$\n560: P^{(2)}((x_0, v_0), A)\n561: = \\int_\\Omega p_v^{\\text{OU}}(\\tau_v; v_0, v_1) K_{\\text{clone}}\\big((x_1, v_1), A\\big) \\, dx_1 \\, dv_1\n562: \\geq \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R} \\, |A|,\n563: $$\n564: \n565: where $|A|$ is the Lebesgue measure of $A$ in $\\Omega$. Thus $P^{(2)}$ satisfies a genuine Doeblin condition\n566: \n567: $$\n568: P^{(2)}(z, A) \\geq \\delta_2 \\, \\nu(A),\n569: \\qquad\n570: \\delta_2 := \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R},\n571: $$\n572: \n573: with state-independent minorization measure $\\nu(A) = |A|/|\\Omega|$.\n574: \n575: **Step 4 (Transfer to the QSD)**  \n576: For the invariant quasi-stationary distribution,\n577: \n578: $$\n579: \\pi_{\\text{QSD}}(A)\n580: = \\int_\\Omega P^{(2)}(z, A) \\, \\pi_{\\text{QSD}}(dz)\n581: \\geq \\delta_2 \\, m_{\\text{eq}} \\, \\nu(A),\n582: $$\n583: \n584: so $\\pi_{\\text{QSD}}$ possesses a density bounded below by $c_\\pi = \\delta_2 m_{\\text{eq}} / |\\Omega|$ at every point of $\\Omega$.\n585: \n586: **Step 5 (Smoothness)**  \n587: Lemma {prf:ref}`lem-linfty-full-operator` provides hypoelliptic smoothing, giving $\\pi_{\\text{QSD}} \\in C^\\infty(\\Omega)$ and promoting the almost-everywhere lower bound to a pointwise one.\n588: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Gaussian Mollification and Uniform Lower Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mass-lower-bound-high-prob",
      "title": "High-Probability Alive Mass Lower Bound",
      "start_line": 673,
      "end_line": 792,
      "header_lines": [
        674
      ],
      "content_start": 676,
      "content_end": 791,
      "content": "676: :label: lem-mass-lower-bound-high-prob\n677: \n678: For the Euclidean Gas with $N$ walkers there exist constants $c_{\\text{mass}}, C, \\delta > 0$, depending only on $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ and the initial mass $m_0$, such that for every $t \\geq 0$\n679: \n680: $$\n681: \\mathbb{P}\\!\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - C (1+t) e^{-\\delta N}.\n682: $$\n683: \n684: **Proof (full-process spectral gap + logistic ODE)**:\n685: \n686: We split the argument into an **early-time deterministic floor** and a **late-time concentration regime**. Throughout we denote $k_t = k_t(\\omega)$ the number of alive walkers and $m_a(t) = \\|\\rho_t\\|_{L^1}$ the PDE mass.\n687: \n688: **Step 0: Deterministic floor on $[0, t_{\\text{eq}}]$ via logistic ODE**  \n689: The mass equation derived in `07_mean_field.md` reads\n690: \n691: $$\n692: \\frac{d}{dt} m_a(t) = -\\int_\\Omega c(z) \\rho_t(z) dz + \\lambda_{\\text{rev}} \\big( 1 - m_a(t) \\big).\n693: $$\n694: \n695: Using $\\int c(z) \\rho_t(z) dz \\leq c_{\\max} m_a(t)$, we obtain the comparison inequality\n696: \n697: $$\n698: \\frac{d}{dt} m_a(t) \\geq - (c_{\\max} + \\lambda_{\\text{rev}}) m_a(t) + \\lambda_{\\text{rev}}.\n699: $$\n700: \n701: Solving gives the explicit lower envelope\n702: \n703: $$\n704: m_{\\text{floor}}(t)\n705: = m_\\infty - \\big(m_\\infty - m_0\\big) e^{-(c_{\\max} + \\lambda_{\\text{rev}}) t},\n706: \\qquad\n707: m_\\infty = \\frac{\\lambda_{\\text{rev}}}{c_{\\max} + \\lambda_{\\text{rev}}} > 0.\n708: $$\n709: \n710: Hence $m_a(t) \\geq m_{\\text{floor}}(t)$ for all $t \\geq 0$. Choosing the equilibration time $t_{\\text{eq}} = O(\\kappa_{\\text{QSD}}^{-1} \\log N)$, we set\n711: \n712: $$\n713: c_{\\text{early}} := \\frac{1}{2} \\min_{0 \\leq s \\leq t_{\\text{eq}}} m_{\\text{floor}}(s) > 0.\n714: $$\n715: \n716: The propagation-of-chaos estimate proved in Section 4.5 (Proposition {prf:ref}`prop-poc-mass`) states that, for any $\\epsilon > 0$,\n717: \n718: $$\n719: \\mathbb{P}\\left( \\sup_{0 \\leq s \\leq t_{\\text{eq}}} \\left| \\frac{k_s}{N} - m_a(s) \\right| > \\epsilon \\right) \\leq C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N \\epsilon^2}.\n720: $$\n721: \n722: Taking $\\epsilon = c_{\\text{early}}$ yields the early-time event\n723: \n724: $$\n725: \\mathbb{P}\\left( \\inf_{0 \\leq s \\leq t_{\\text{eq}}} \\frac{k_s}{N} \\geq c_{\\text{early}} \\right) \\geq 1 - C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N c_{\\text{early}}^2}.\n726: $$\n727: \n728: This establishes the desired floor on $[0, t_{\\text{eq}}]$.\n729: \n730: **Step 1: Spectral gap for configuration observables (removing the Markov assumption on $k_t$)**  \n731: The $N$-particle process $Z_t = (z_t^{(1)}, \\ldots, z_t^{(N)})$ is geometrically ergodic with spectral gap $\\kappa_{\\text{full}} > 0$ in $L^2(\\Pi_{\\text{QSD}}^{(N)})$ (Theorem 4.5 of `06_convergence.md`). For any observable $F : \\Omega^N \\to \\mathbb{R}$,\n732: \n733: $$\n734: \\text{Var}_{\\Pi_{\\text{QSD}}^{(N)}}(F) \\leq \\frac{1}{\\kappa_{\\text{full}}} \\langle -\\mathcal{L}^{(N)} F, F \\rangle.\n735: $$\n736: \n737: We apply this to $F(Z) = k(Z)/N = N^{-1} \\sum_{i=1}^N \\mathbf{1}_{\\{\\text{walker } i \\text{ alive}\\}}$. Changing a single coordinate alters $F$ by at most $1/N$, so $F$ is $1/N$-Lipschitz with respect to the Hamming metric. By the Herbst argument for Markov semigroups with spectral gap (see, e.g., Joulin & Ollivier 2010, Theorem 5.1), $F$ satisfies\n738: \n739: $$\n740: \\Pi_{\\text{QSD}}^{(N)}\\!\\left( \\left| \\frac{k}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n741: \\leq 2 \\exp\\!\\left( - \\frac{\\kappa_{\\text{full}} N^2 r^2}{2} \\right)\n742: \\leq 2 \\exp\\!\\left( - \\beta_{\\text{gap}} N r^2 \\right),\n743: $$\n744: \n745: where we set $\\beta_{\\text{gap}} := \\kappa_{\\text{full}} / 2$ (the second inequality uses $N^2 \\geq N$ so the exponent now scales linearly in $N$).\n746: \n747: This argument works directly on the full configuration process $Z_t$; no Markov property for the projected count $k_t$ is required, thereby correcting the earlier (invalid) reduction to a standalone birth-death chain.\n748: \n749: **Step 2: Finite-time concentration after equilibration**  \n750: Let $\\mathcal{L}_t$ be the law of $Z_t$ starting from any initial configuration with alive mass at least $c_{\\text{early}}$. By Theorem 4.5 of `06_convergence.md`,\n751: \n752: $$\n753: \\|\\mathcal{L}_t - \\Pi_{\\text{QSD}}^{(N)}\\|_{\\text{TV}}\n754: \\leq C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})} \\quad \\text{for } t \\geq t_{\\text{eq}}.\n755: $$\n756: \n757: Therefore, for $t \\geq t_{\\text{eq}}$ and any $r > 0$,\n758: \n759: $$\n760: \\mathbb{P}\\left( \\left| \\frac{k_t}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n761: \\leq 2 e^{-\\beta_{\\text{gap}} N r^2} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n762: $$\n763: \n764: Selecting $r = m_{\\text{eq}}/2$ yields\n765: \n766: $$\n767: \\mathbb{P}\\left( \\frac{k_t}{N} \\leq \\frac{m_{\\text{eq}}}{2} \\right)\n768: \\leq 2 e^{-\\beta_{\\text{gap}} N m_{\\text{eq}}^2 / 4} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n769: $$\n770: \n771: **Step 3: Survival conditioning**  \n772: The survival estimate of Theorem {prf:ref}`thm-exponential-survival` gives\n773: \n774: $$\n775: \\mathbb{P}(\\tau_\\dagger \\leq t) \\leq t e^{-C_{\\text{surv}} N}.\n776: $$\n777: \n778: Intersecting the complementary survival event with the concentration events from Steps 0-2 shows that, for all $t \\geq 0$,\n779: \n780: $$\n781: \\mathbb{P}\\left( \\frac{k_t}{N} \\geq \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right) \\right)\n782: \\geq 1 - C (1+t) e^{-\\delta N},\n783: $$\n784: \n785: with $\\delta = \\min(\\beta_{\\text{pc}} c_{\\text{early}}^2, \\beta_{\\text{gap}} m_{\\text{eq}}^2/4, C_{\\text{surv}})$.\n786: \n787: Setting\n788: \n789: $$\n790: c_{\\text{mass}} := \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right)\n791: $$",
      "metadata": {
        "label": "lem-mass-lower-bound-high-prob"
      },
      "section": "## 4. Stochastic Mass Conservation and High-Probability Bounds",
      "raw_directive": "673: ### 4.3. High-Probability Mass Lower Bound\n674: \n675: :::{prf:lemma} High-Probability Alive Mass Lower Bound\n676: :label: lem-mass-lower-bound-high-prob\n677: \n678: For the Euclidean Gas with $N$ walkers there exist constants $c_{\\text{mass}}, C, \\delta > 0$, depending only on $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ and the initial mass $m_0$, such that for every $t \\geq 0$\n679: \n680: $$\n681: \\mathbb{P}\\!\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - C (1+t) e^{-\\delta N}.\n682: $$\n683: \n684: **Proof (full-process spectral gap + logistic ODE)**:\n685: \n686: We split the argument into an **early-time deterministic floor** and a **late-time concentration regime**. Throughout we denote $k_t = k_t(\\omega)$ the number of alive walkers and $m_a(t) = \\|\\rho_t\\|_{L^1}$ the PDE mass.\n687: \n688: **Step 0: Deterministic floor on $[0, t_{\\text{eq}}]$ via logistic ODE**  \n689: The mass equation derived in `07_mean_field.md` reads\n690: \n691: $$\n692: \\frac{d}{dt} m_a(t) = -\\int_\\Omega c(z) \\rho_t(z) dz + \\lambda_{\\text{rev}} \\big( 1 - m_a(t) \\big).\n693: $$\n694: \n695: Using $\\int c(z) \\rho_t(z) dz \\leq c_{\\max} m_a(t)$, we obtain the comparison inequality\n696: \n697: $$\n698: \\frac{d}{dt} m_a(t) \\geq - (c_{\\max} + \\lambda_{\\text{rev}}) m_a(t) + \\lambda_{\\text{rev}}.\n699: $$\n700: \n701: Solving gives the explicit lower envelope\n702: \n703: $$\n704: m_{\\text{floor}}(t)\n705: = m_\\infty - \\big(m_\\infty - m_0\\big) e^{-(c_{\\max} + \\lambda_{\\text{rev}}) t},\n706: \\qquad\n707: m_\\infty = \\frac{\\lambda_{\\text{rev}}}{c_{\\max} + \\lambda_{\\text{rev}}} > 0.\n708: $$\n709: \n710: Hence $m_a(t) \\geq m_{\\text{floor}}(t)$ for all $t \\geq 0$. Choosing the equilibration time $t_{\\text{eq}} = O(\\kappa_{\\text{QSD}}^{-1} \\log N)$, we set\n711: \n712: $$\n713: c_{\\text{early}} := \\frac{1}{2} \\min_{0 \\leq s \\leq t_{\\text{eq}}} m_{\\text{floor}}(s) > 0.\n714: $$\n715: \n716: The propagation-of-chaos estimate proved in Section 4.5 (Proposition {prf:ref}`prop-poc-mass`) states that, for any $\\epsilon > 0$,\n717: \n718: $$\n719: \\mathbb{P}\\left( \\sup_{0 \\leq s \\leq t_{\\text{eq}}} \\left| \\frac{k_s}{N} - m_a(s) \\right| > \\epsilon \\right) \\leq C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N \\epsilon^2}.\n720: $$\n721: \n722: Taking $\\epsilon = c_{\\text{early}}$ yields the early-time event\n723: \n724: $$\n725: \\mathbb{P}\\left( \\inf_{0 \\leq s \\leq t_{\\text{eq}}} \\frac{k_s}{N} \\geq c_{\\text{early}} \\right) \\geq 1 - C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N c_{\\text{early}}^2}.\n726: $$\n727: \n728: This establishes the desired floor on $[0, t_{\\text{eq}}]$.\n729: \n730: **Step 1: Spectral gap for configuration observables (removing the Markov assumption on $k_t$)**  \n731: The $N$-particle process $Z_t = (z_t^{(1)}, \\ldots, z_t^{(N)})$ is geometrically ergodic with spectral gap $\\kappa_{\\text{full}} > 0$ in $L^2(\\Pi_{\\text{QSD}}^{(N)})$ (Theorem 4.5 of `06_convergence.md`). For any observable $F : \\Omega^N \\to \\mathbb{R}$,\n732: \n733: $$\n734: \\text{Var}_{\\Pi_{\\text{QSD}}^{(N)}}(F) \\leq \\frac{1}{\\kappa_{\\text{full}}} \\langle -\\mathcal{L}^{(N)} F, F \\rangle.\n735: $$\n736: \n737: We apply this to $F(Z) = k(Z)/N = N^{-1} \\sum_{i=1}^N \\mathbf{1}_{\\{\\text{walker } i \\text{ alive}\\}}$. Changing a single coordinate alters $F$ by at most $1/N$, so $F$ is $1/N$-Lipschitz with respect to the Hamming metric. By the Herbst argument for Markov semigroups with spectral gap (see, e.g., Joulin & Ollivier 2010, Theorem 5.1), $F$ satisfies\n738: \n739: $$\n740: \\Pi_{\\text{QSD}}^{(N)}\\!\\left( \\left| \\frac{k}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n741: \\leq 2 \\exp\\!\\left( - \\frac{\\kappa_{\\text{full}} N^2 r^2}{2} \\right)\n742: \\leq 2 \\exp\\!\\left( - \\beta_{\\text{gap}} N r^2 \\right),\n743: $$\n744: \n745: where we set $\\beta_{\\text{gap}} := \\kappa_{\\text{full}} / 2$ (the second inequality uses $N^2 \\geq N$ so the exponent now scales linearly in $N$).\n746: \n747: This argument works directly on the full configuration process $Z_t$; no Markov property for the projected count $k_t$ is required, thereby correcting the earlier (invalid) reduction to a standalone birth-death chain.\n748: \n749: **Step 2: Finite-time concentration after equilibration**  \n750: Let $\\mathcal{L}_t$ be the law of $Z_t$ starting from any initial configuration with alive mass at least $c_{\\text{early}}$. By Theorem 4.5 of `06_convergence.md`,\n751: \n752: $$\n753: \\|\\mathcal{L}_t - \\Pi_{\\text{QSD}}^{(N)}\\|_{\\text{TV}}\n754: \\leq C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})} \\quad \\text{for } t \\geq t_{\\text{eq}}.\n755: $$\n756: \n757: Therefore, for $t \\geq t_{\\text{eq}}$ and any $r > 0$,\n758: \n759: $$\n760: \\mathbb{P}\\left( \\left| \\frac{k_t}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n761: \\leq 2 e^{-\\beta_{\\text{gap}} N r^2} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n762: $$\n763: \n764: Selecting $r = m_{\\text{eq}}/2$ yields\n765: \n766: $$\n767: \\mathbb{P}\\left( \\frac{k_t}{N} \\leq \\frac{m_{\\text{eq}}}{2} \\right)\n768: \\leq 2 e^{-\\beta_{\\text{gap}} N m_{\\text{eq}}^2 / 4} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n769: $$\n770: \n771: **Step 3: Survival conditioning**  \n772: The survival estimate of Theorem {prf:ref}`thm-exponential-survival` gives\n773: \n774: $$\n775: \\mathbb{P}(\\tau_\\dagger \\leq t) \\leq t e^{-C_{\\text{surv}} N}.\n776: $$\n777: \n778: Intersecting the complementary survival event with the concentration events from Steps 0-2 shows that, for all $t \\geq 0$,\n779: \n780: $$\n781: \\mathbb{P}\\left( \\frac{k_t}{N} \\geq \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right) \\right)\n782: \\geq 1 - C (1+t) e^{-\\delta N},\n783: $$\n784: \n785: with $\\delta = \\min(\\beta_{\\text{pc}} c_{\\text{early}}^2, \\beta_{\\text{gap}} m_{\\text{eq}}^2/4, C_{\\text{surv}})$.\n786: \n787: Setting\n788: \n789: $$\n790: c_{\\text{mass}} := \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right)\n791: $$\n792: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Stochastic Mass Conservation and High-Probability Bounds"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-linearized-spectral-gap",
      "title": "Exponential Decay in L¹ for Linearized Dynamics",
      "start_line": 1138,
      "end_line": 1173,
      "header_lines": [
        1139
      ],
      "content_start": 1141,
      "content_end": 1172,
      "content": "1141: :label: lem-linearized-spectral-gap\n1142: \n1143: The linearized operator $\\mathbb{L}^*$ around $\\pi_{\\text{QSD}}$ has a **spectral gap** in $L^2(\\pi_{\\text{QSD}})$:\n1144: \n1145: $$\n1146: \\mathbb{L}^* = -\\kappa_{\\text{lin}} + \\text{compact}\n1147: \n1148: $$\n1149: \n1150: where $\\kappa_{\\text{lin}} > 0$ is the gap. For any perturbation $\\eta_0$ with $\\|\\eta_0\\|_{L^1} \\leq \\delta$ sufficiently small, the linearized evolution satisfies:\n1151: \n1152: $$\n1153: \\|\\eta_t\\|_{L^1} \\leq \\|\\eta_0\\|_{L^1} e^{-\\kappa_{\\text{lin}} t / 2}\n1154: \n1155: $$\n1156: \n1157: for all $t \\geq 0$, provided $\\delta < \\delta_0$ for some threshold $\\delta_0$ determined by the nonlinearity $C_{\\text{nonlin}}$.\n1158: \n1159: **Proof Sketch**:\n1160: \n1161: This follows from standard perturbation theory for nonlinear parabolic equations:\n1162: \n1163: 1. **Spectral Gap**: The operator $\\mathbb{L}^*$ is the linearization of a hypoelliptic kinetic operator with compact perturbations (cloning, killing, revival). By the results in `06_convergence.md` (geometric ergodicity with rate $\\kappa_{\\text{QSD}}$), the linearized operator has a spectral gap $\\kappa_{\\text{lin}} \\approx \\kappa_{\\text{QSD}}$.\n1164: \n1165: 2. **Nonlinear Stability**: For the nonlinear equation $\\partial_t \\eta = \\mathbb{L}^* \\eta + \\mathcal{N}[\\eta]$, we use a Grönwall-type argument. The $L^1$ norm evolves as:\n1166: \n1167: $$\n1168: \\frac{d}{dt} \\|\\eta_t\\|_{L^1} \\leq -\\kappa_{\\text{lin}} \\|\\eta_t\\|_{L^1} + C_{\\text{nonlin}} \\|\\eta_t\\|_{L^1}^2\n1169: \n1170: $$\n1171: \n1172: For $\\|\\eta_0\\|_{L^1} \\leq \\delta_0 := \\kappa_{\\text{lin}} / (2 C_{\\text{nonlin}})$, the linear term dominates and we obtain exponential decay with rate $\\kappa_{\\text{lin}} / 2$.",
      "metadata": {
        "label": "lem-linearized-spectral-gap"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1138: **Step 2B: Spectral Gap of the Linearized Operator**\n1139: \n1140: :::{prf:lemma} Exponential Decay in L¹ for Linearized Dynamics\n1141: :label: lem-linearized-spectral-gap\n1142: \n1143: The linearized operator $\\mathbb{L}^*$ around $\\pi_{\\text{QSD}}$ has a **spectral gap** in $L^2(\\pi_{\\text{QSD}})$:\n1144: \n1145: $$\n1146: \\mathbb{L}^* = -\\kappa_{\\text{lin}} + \\text{compact}\n1147: \n1148: $$\n1149: \n1150: where $\\kappa_{\\text{lin}} > 0$ is the gap. For any perturbation $\\eta_0$ with $\\|\\eta_0\\|_{L^1} \\leq \\delta$ sufficiently small, the linearized evolution satisfies:\n1151: \n1152: $$\n1153: \\|\\eta_t\\|_{L^1} \\leq \\|\\eta_0\\|_{L^1} e^{-\\kappa_{\\text{lin}} t / 2}\n1154: \n1155: $$\n1156: \n1157: for all $t \\geq 0$, provided $\\delta < \\delta_0$ for some threshold $\\delta_0$ determined by the nonlinearity $C_{\\text{nonlin}}$.\n1158: \n1159: **Proof Sketch**:\n1160: \n1161: This follows from standard perturbation theory for nonlinear parabolic equations:\n1162: \n1163: 1. **Spectral Gap**: The operator $\\mathbb{L}^*$ is the linearization of a hypoelliptic kinetic operator with compact perturbations (cloning, killing, revival). By the results in `06_convergence.md` (geometric ergodicity with rate $\\kappa_{\\text{QSD}}$), the linearized operator has a spectral gap $\\kappa_{\\text{lin}} \\approx \\kappa_{\\text{QSD}}$.\n1164: \n1165: 2. **Nonlinear Stability**: For the nonlinear equation $\\partial_t \\eta = \\mathbb{L}^* \\eta + \\mathcal{N}[\\eta]$, we use a Grönwall-type argument. The $L^1$ norm evolves as:\n1166: \n1167: $$\n1168: \\frac{d}{dt} \\|\\eta_t\\|_{L^1} \\leq -\\kappa_{\\text{lin}} \\|\\eta_t\\|_{L^1} + C_{\\text{nonlin}} \\|\\eta_t\\|_{L^1}^2\n1169: \n1170: $$\n1171: \n1172: For $\\|\\eta_0\\|_{L^1} \\leq \\delta_0 := \\kappa_{\\text{lin}} / (2 C_{\\text{nonlin}})$, the linear term dominates and we obtain exponential decay with rate $\\kappa_{\\text{lin}} / 2$.\n1173: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Main Theorem: Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hypoellipticity-full-linearized",
      "title": "Hypoellipticity Preservation via Bootstrap Argument",
      "start_line": 1179,
      "end_line": 1263,
      "header_lines": [
        1180
      ],
      "content_start": 1182,
      "content_end": 1262,
      "content": "1182: :label: lem-hypoellipticity-full-linearized\n1183: \n1184: The linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` is **hypoelliptic** in the sense that:\n1185: \n1186: If $\\partial_t \\eta = \\mathbb{L}^* \\eta$ with initial condition $\\eta_0 \\in L^1(\\Omega)$, then for any $t > 0$, the solution $\\eta_t \\in C^\\infty(\\Omega)$.\n1187: \n1188: **Proof**:\n1189: \n1190: The proof uses a **bootstrap argument** that separates the \"regularizing engine\" (kinetic operator) from the \"source terms\" (nonlocal operators).\n1191: \n1192: **Step 1: Isolate the Hypoelliptic Engine**\n1193: \n1194: Rearrange the evolution equation:\n1195: \n1196: $$\n1197: \\frac{\\partial \\eta}{\\partial t} - \\mathcal{L}_{\\text{kin}}^* \\eta = f[\\eta]\n1198: \n1199: $$\n1200: \n1201: where the \"source term\" is:\n1202: \n1203: $$\n1204: f[\\eta] := \\mathbb{L}_{\\text{clone}}^* \\eta - c(z) \\eta + \\mathbb{L}_{\\text{revival}}^* \\eta\n1205: \n1206: $$\n1207: \n1208: Define the hypoelliptic operator $\\mathbb{L}_{\\text{hypo}} := \\partial_t - \\mathcal{L}_{\\text{kin}}^*$. By Lemma {prf:ref}`lem-hormander-bracket` (Section 2.2), this operator satisfies Hörmander's bracket condition, making it hypoelliptic.\n1209: \n1210: **Step 2: Hörmander's Theorem**\n1211: \n1212: By Hörmander's theorem (Hörmander 1967, *Acta Math.* 119:147-171), if $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ and the source term $f \\in C^k(\\Omega)$ for some $k \\geq 0$, then the solution $\\eta$ is automatically smoother: $\\eta \\in C^{k+\\alpha}(\\Omega)$ for some $\\alpha > 0$ (and in fact, $\\eta \\in C^\\infty$ if $f \\in C^\\infty$).\n1213: \n1214: **Step 3: Regularity of the Source Term**\n1215: \n1216: The key observation is that **if $\\eta \\in C^k$, then $f[\\eta] \\in C^k$**. We verify each component:\n1217: \n1218: **Cloning operator**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator is:\n1219: \n1220: $$\n1221: \\mathbb{L}_{\\text{clone}}^* \\eta = \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n1222: \n1223: $$\n1224: \n1225: This is a convolution with the Gaussian kernel $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x - x') \\delta(v - v')$ plus multiplication by the fitness functional $V[\\pi]$ and its derivative $V'[\\pi]$.\n1226: \n1227: - The Gaussian kernel $G_{\\sigma_x}$ is $C^\\infty$ (analytic).\n1228: - The fitness functional $V[\\pi]$ depends on the potential $U$ and the virtual reward mechanism. From the Fragile framework (`02_euclidean_gas.md`, Axiom of Smooth Potential), the potential $U \\in C^\\infty(\\mathcal{X})$. The virtual reward is a functional of integrals of $\\pi$, which are smooth.\n1229: - **Conclusion**: Convolution with a $C^\\infty$ kernel preserves regularity. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{clone}}^* \\eta \\in C^k$.\n1230: \n1231: **Killing term**: $-c(z) \\eta$ where $c(z) \\geq 0$ is the killing rate. From the framework, $c(z)$ is smooth (defined by the domain boundaries with smooth indicator functions). If $\\eta \\in C^k$, then $c(z) \\eta \\in C^k$.\n1232: \n1233: **Revival term**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized revival operator is:\n1234: \n1235: $$\n1236: \\mathbb{L}_{\\text{revival}}^* \\eta = \\lambda_{\\text{rev}} \\frac{m_d}{m_{\\text{eq}}} \\left( f_{\\text{safe}} \\eta - \\frac{f_{\\text{safe}}}{m_{\\text{eq}}} \\int \\eta \\, dz \\right)\n1237: \n1238: $$\n1239: \n1240: where $f_{\\text{safe}}$ is the revival distribution (smooth by framework assumptions). The integral $\\int \\eta \\, dz$ is a scalar. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{revival}}^* \\eta \\in C^k$.\n1241: \n1242: **Overall**: All components of $f[\\eta]$ preserve regularity, so $\\eta \\in C^k \\Rightarrow f[\\eta] \\in C^k$.\n1243: \n1244: **Step 4: Bootstrap Loop**\n1245: \n1246: 1. **Initial regularity**: From basic parabolic theory, for short time $t > 0$, the solution $\\eta_t$ is at least continuous: $\\eta_t \\in C^0(\\Omega)$.\n1247: \n1248: 2. **Bootstrap iteration**: Assume $\\eta \\in C^k$ for some $k \\geq 0$. Then:\n1249:    - By Step 3, $f[\\eta] \\in C^k$\n1250:    - By Hörmander's theorem (Step 2), $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ implies $\\eta \\in C^{k+\\alpha}$\n1251:    - Therefore, $\\eta$ is strictly smoother than we assumed\n1252: \n1253: 3. **Infinite iteration**: Repeating this argument indefinitely, we conclude $\\eta \\in C^\\infty(\\Omega)$ for all $t > 0$.\n1254: \n1255: **Step 5: Nash-Aronson Applicability**\n1256: \n1257: Since the operator $\\mathbb{L}^*$ is hypoelliptic (produces $C^\\infty$ solutions), the standard theory of hypoelliptic parabolic equations applies. In particular:\n1258: \n1259: - The Nash inequality holds for $\\mathbb{L}^*$ (Hérau & Nier 2004, Theorem 2.1, extended to operators with smooth source terms)\n1260: - The ultracontractivity estimate (Nash-Aronson) follows from the Nash inequality via standard bootstrapping arguments (Aronson 1968; Carlen & Loss 1993)\n1261: \n1262: **Conclusion**: The full linearized operator $\\mathbb{L}^*$ is hypoelliptic, and the Nash-Aronson $L^1 \\to L^\\infty$ estimate applies to its semigroup.",
      "metadata": {
        "label": "lem-hypoellipticity-full-linearized"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1179: Before we can apply parabolic regularity estimates (Nash-Aronson), we must establish that the full linearized operator $\\mathbb{L}^*$ (including nonlocal cloning and revival terms) preserves the hypoelliptic structure of the kinetic operator.\n1180: \n1181: :::{prf:lemma} Hypoellipticity Preservation via Bootstrap Argument\n1182: :label: lem-hypoellipticity-full-linearized\n1183: \n1184: The linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` is **hypoelliptic** in the sense that:\n1185: \n1186: If $\\partial_t \\eta = \\mathbb{L}^* \\eta$ with initial condition $\\eta_0 \\in L^1(\\Omega)$, then for any $t > 0$, the solution $\\eta_t \\in C^\\infty(\\Omega)$.\n1187: \n1188: **Proof**:\n1189: \n1190: The proof uses a **bootstrap argument** that separates the \"regularizing engine\" (kinetic operator) from the \"source terms\" (nonlocal operators).\n1191: \n1192: **Step 1: Isolate the Hypoelliptic Engine**\n1193: \n1194: Rearrange the evolution equation:\n1195: \n1196: $$\n1197: \\frac{\\partial \\eta}{\\partial t} - \\mathcal{L}_{\\text{kin}}^* \\eta = f[\\eta]\n1198: \n1199: $$\n1200: \n1201: where the \"source term\" is:\n1202: \n1203: $$\n1204: f[\\eta] := \\mathbb{L}_{\\text{clone}}^* \\eta - c(z) \\eta + \\mathbb{L}_{\\text{revival}}^* \\eta\n1205: \n1206: $$\n1207: \n1208: Define the hypoelliptic operator $\\mathbb{L}_{\\text{hypo}} := \\partial_t - \\mathcal{L}_{\\text{kin}}^*$. By Lemma {prf:ref}`lem-hormander-bracket` (Section 2.2), this operator satisfies Hörmander's bracket condition, making it hypoelliptic.\n1209: \n1210: **Step 2: Hörmander's Theorem**\n1211: \n1212: By Hörmander's theorem (Hörmander 1967, *Acta Math.* 119:147-171), if $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ and the source term $f \\in C^k(\\Omega)$ for some $k \\geq 0$, then the solution $\\eta$ is automatically smoother: $\\eta \\in C^{k+\\alpha}(\\Omega)$ for some $\\alpha > 0$ (and in fact, $\\eta \\in C^\\infty$ if $f \\in C^\\infty$).\n1213: \n1214: **Step 3: Regularity of the Source Term**\n1215: \n1216: The key observation is that **if $\\eta \\in C^k$, then $f[\\eta] \\in C^k$**. We verify each component:\n1217: \n1218: **Cloning operator**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator is:\n1219: \n1220: $$\n1221: \\mathbb{L}_{\\text{clone}}^* \\eta = \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n1222: \n1223: $$\n1224: \n1225: This is a convolution with the Gaussian kernel $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x - x') \\delta(v - v')$ plus multiplication by the fitness functional $V[\\pi]$ and its derivative $V'[\\pi]$.\n1226: \n1227: - The Gaussian kernel $G_{\\sigma_x}$ is $C^\\infty$ (analytic).\n1228: - The fitness functional $V[\\pi]$ depends on the potential $U$ and the virtual reward mechanism. From the Fragile framework (`02_euclidean_gas.md`, Axiom of Smooth Potential), the potential $U \\in C^\\infty(\\mathcal{X})$. The virtual reward is a functional of integrals of $\\pi$, which are smooth.\n1229: - **Conclusion**: Convolution with a $C^\\infty$ kernel preserves regularity. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{clone}}^* \\eta \\in C^k$.\n1230: \n1231: **Killing term**: $-c(z) \\eta$ where $c(z) \\geq 0$ is the killing rate. From the framework, $c(z)$ is smooth (defined by the domain boundaries with smooth indicator functions). If $\\eta \\in C^k$, then $c(z) \\eta \\in C^k$.\n1232: \n1233: **Revival term**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized revival operator is:\n1234: \n1235: $$\n1236: \\mathbb{L}_{\\text{revival}}^* \\eta = \\lambda_{\\text{rev}} \\frac{m_d}{m_{\\text{eq}}} \\left( f_{\\text{safe}} \\eta - \\frac{f_{\\text{safe}}}{m_{\\text{eq}}} \\int \\eta \\, dz \\right)\n1237: \n1238: $$\n1239: \n1240: where $f_{\\text{safe}}$ is the revival distribution (smooth by framework assumptions). The integral $\\int \\eta \\, dz$ is a scalar. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{revival}}^* \\eta \\in C^k$.\n1241: \n1242: **Overall**: All components of $f[\\eta]$ preserve regularity, so $\\eta \\in C^k \\Rightarrow f[\\eta] \\in C^k$.\n1243: \n1244: **Step 4: Bootstrap Loop**\n1245: \n1246: 1. **Initial regularity**: From basic parabolic theory, for short time $t > 0$, the solution $\\eta_t$ is at least continuous: $\\eta_t \\in C^0(\\Omega)$.\n1247: \n1248: 2. **Bootstrap iteration**: Assume $\\eta \\in C^k$ for some $k \\geq 0$. Then:\n1249:    - By Step 3, $f[\\eta] \\in C^k$\n1250:    - By Hörmander's theorem (Step 2), $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ implies $\\eta \\in C^{k+\\alpha}$\n1251:    - Therefore, $\\eta$ is strictly smoother than we assumed\n1252: \n1253: 3. **Infinite iteration**: Repeating this argument indefinitely, we conclude $\\eta \\in C^\\infty(\\Omega)$ for all $t > 0$.\n1254: \n1255: **Step 5: Nash-Aronson Applicability**\n1256: \n1257: Since the operator $\\mathbb{L}^*$ is hypoelliptic (produces $C^\\infty$ solutions), the standard theory of hypoelliptic parabolic equations applies. In particular:\n1258: \n1259: - The Nash inequality holds for $\\mathbb{L}^*$ (Hérau & Nier 2004, Theorem 2.1, extended to operators with smooth source terms)\n1260: - The ultracontractivity estimate (Nash-Aronson) follows from the Nash inequality via standard bootstrapping arguments (Aronson 1968; Carlen & Loss 1993)\n1261: \n1262: **Conclusion**: The full linearized operator $\\mathbb{L}^*$ is hypoelliptic, and the Nash-Aronson $L^1 \\to L^\\infty$ estimate applies to its semigroup.\n1263: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Main Theorem: Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-relative-boundedness-nonlocal",
      "title": "Relative Boundedness of Nonlocal Operators",
      "start_line": 1274,
      "end_line": 1379,
      "header_lines": [
        1275
      ],
      "content_start": 1277,
      "content_end": 1378,
      "content": "1277: :label: lem-relative-boundedness-nonlocal\n1278: \n1279: The linearized nonlocal operators $\\mathbb{L}_{\\text{clone}}^*$ and $\\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` are **relatively bounded** with respect to the kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ in $L^2(\\pi_{\\text{QSD}}^{-1})$:\n1280: \n1281: $$\n1282: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2} \\leq C_1 \\|g\\|_{L^2}\n1283: $$\n1284: \n1285: $$\n1286: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq C_2 \\|g\\|_{L^2}\n1287: $$\n1288: \n1289: with constants $C_1, C_2 < \\kappa_{\\text{kin}} / 2$ where $\\kappa_{\\text{kin}} > 0$ is the kinetic spectral gap.\n1290: \n1291: **Consequence**: The full linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ retains a spectral gap:\n1292: \n1293: $$\n1294: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1295: $$\n1296: \n1297: and the associated Dirichlet form $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle_{\\pi_{\\text{QSD}}^{-1}}$ is coercive:\n1298: \n1299: $$\n1300: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2\n1301: \n1302: $$\n1303: \n1304: **Proof**:\n1305: \n1306: **Part 1: Cloning Operator Bound**\n1307: \n1308: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator has the form:\n1309: \n1310: $$\n1311: \\mathbb{L}_{\\text{clone}}^* g(z) = \\int_\\Omega K_{\\text{clone}}(z, z') W(z, z') [g(z') - g(z)] dz'\n1312: $$\n1313: \n1314: where $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x-x') \\delta(v-v')$ is the Gaussian position kernel and $W(z, z')$ is a bounded fitness-dependent weight with $\\|W\\|_\\infty \\leq V_{\\max}$.\n1315: \n1316: By the **Schur test** for integral operators:\n1317: \n1318: $$\n1319: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2}^2 = \\int_\\Omega \\left| \\int_\\Omega K(z,z') W(z,z') [g(z') - g(z)] dz' \\right|^2 dz\n1320: $$\n1321: \n1322: Using Cauchy-Schwarz and the fact that $K$ is a probability kernel ($\\int K(z, z') dz' = 1$):\n1323: \n1324: $$\n1325: \\leq 2 V_{\\max}^2 \\left[ \\int_\\Omega |g(z')|^2 dz' + \\int_\\Omega |g(z)|^2 dz \\right] = 4 V_{\\max}^2 \\|g\\|_{L^2}^2\n1326: $$\n1327: \n1328: Therefore, $C_1 = 2 V_{\\max}$.\n1329: \n1330: **Part 2: Revival Operator Bound**\n1331: \n1332: The linearized revival operator (from Lemma {prf:ref}`lem-linearization-qsd`) has the form:\n1333: \n1334: $$\n1335: \\mathbb{L}_{\\text{revival}}^* g = \\lambda_{\\text{rev}} \\left[ \\frac{m_d}{m_{\\text{eq}}} - \\frac{\\langle g, 1 \\rangle}{m_{\\text{eq}}} \\right] f_{\\text{safe}}\n1336: $$\n1337: \n1338: where $f_{\\text{safe}}$ is the safe-region density with $\\|f_{\\text{safe}}\\|_{L^\\infty} \\leq C_{\\text{safe}}$ and $m_d, m_{\\text{eq}}$ are the dead and equilibrium masses.\n1339: \n1340: The $L^2$ norm is:\n1341: \n1342: $$\n1343: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq \\lambda_{\\text{rev}} \\left( \\frac{\\|c\\|_\\infty m_{\\text{eq}}}{m_{\\text{eq}}} + \\frac{|\\langle g, 1 \\rangle|}{m_{\\text{eq}}} \\right) \\|f_{\\text{safe}}\\|_{L^2}\n1344: $$\n1345: \n1346: Using Cauchy-Schwarz for the inner product: $|\\langle g, 1 \\rangle| \\leq \\|g\\|_{L^2} \\cdot \\|1\\|_{L^2}$:\n1347: \n1348: $$\n1349: \\leq \\lambda_{\\text{rev}} C_{\\text{safe}} \\left( \\|c\\|_\\infty + \\frac{1}{m_{\\text{eq}}} \\|1\\|_{L^2} \\right) \\|g\\|_{L^2}\n1350: $$\n1351: \n1352: Therefore, $C_2 = \\lambda_{\\text{rev}} C_{\\text{safe}} (\\|c\\|_\\infty + \\|1\\|_{L^2} / m_{\\text{eq}})$.\n1353: \n1354: **Part 3: Kato-Rellich Perturbation Theory**\n1355: \n1356: From `06_convergence.md`, the pure kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ has spectral gap $\\kappa_{\\text{kin}} > 0$. By **Kato-Rellich perturbation theory** for sectorial operators (Kato 1995, *Perturbation Theory for Linear Operators*, Springer, Theorem IV.3.17):\n1357: \n1358: If the perturbation operators $\\mathbb{L}_{\\text{clone}}^*$, $\\mathbb{L}_{\\text{revival}}^*$, and $-c(z)$ satisfy $\\|B g\\|_{L^2} \\leq \\beta \\|g\\|_{L^2}$ with $\\beta < \\kappa_{\\text{kin}}$, then the perturbed operator retains a spectral gap:\n1359: \n1360: $$\n1361: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1362: $$\n1363: \n1364: **Part 4: Dirichlet Form Coercivity**\n1365: \n1366: The Dirichlet form is:\n1367: \n1368: $$\n1369: \\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle = \\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle + \\text{perturbation terms}\n1370: $$\n1371: \n1372: The kinetic part satisfies $\\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle \\geq \\kappa_{\\text{kin}} \\|g\\|_{L^2}^2$ (by spectral gap). The perturbation terms contribute at most $(C_1 + C_2 + \\|c\\|_\\infty) \\|g\\|_{L^2}^2$ in magnitude.\n1373: \n1374: Therefore:\n1375: \n1376: $$\n1377: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2 > 0\n1378: $$",
      "metadata": {
        "label": "lem-relative-boundedness-nonlocal"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1274: Before applying Nash-Aronson theory, we must verify that the nonlocal cloning and revival operators do not destroy the coercive Dirichlet form structure of the kinetic operator.\n1275: \n1276: :::{prf:lemma} Relative Boundedness of Nonlocal Operators\n1277: :label: lem-relative-boundedness-nonlocal\n1278: \n1279: The linearized nonlocal operators $\\mathbb{L}_{\\text{clone}}^*$ and $\\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` are **relatively bounded** with respect to the kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ in $L^2(\\pi_{\\text{QSD}}^{-1})$:\n1280: \n1281: $$\n1282: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2} \\leq C_1 \\|g\\|_{L^2}\n1283: $$\n1284: \n1285: $$\n1286: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq C_2 \\|g\\|_{L^2}\n1287: $$\n1288: \n1289: with constants $C_1, C_2 < \\kappa_{\\text{kin}} / 2$ where $\\kappa_{\\text{kin}} > 0$ is the kinetic spectral gap.\n1290: \n1291: **Consequence**: The full linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ retains a spectral gap:\n1292: \n1293: $$\n1294: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1295: $$\n1296: \n1297: and the associated Dirichlet form $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle_{\\pi_{\\text{QSD}}^{-1}}$ is coercive:\n1298: \n1299: $$\n1300: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2\n1301: \n1302: $$\n1303: \n1304: **Proof**:\n1305: \n1306: **Part 1: Cloning Operator Bound**\n1307: \n1308: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator has the form:\n1309: \n1310: $$\n1311: \\mathbb{L}_{\\text{clone}}^* g(z) = \\int_\\Omega K_{\\text{clone}}(z, z') W(z, z') [g(z') - g(z)] dz'\n1312: $$\n1313: \n1314: where $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x-x') \\delta(v-v')$ is the Gaussian position kernel and $W(z, z')$ is a bounded fitness-dependent weight with $\\|W\\|_\\infty \\leq V_{\\max}$.\n1315: \n1316: By the **Schur test** for integral operators:\n1317: \n1318: $$\n1319: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2}^2 = \\int_\\Omega \\left| \\int_\\Omega K(z,z') W(z,z') [g(z') - g(z)] dz' \\right|^2 dz\n1320: $$\n1321: \n1322: Using Cauchy-Schwarz and the fact that $K$ is a probability kernel ($\\int K(z, z') dz' = 1$):\n1323: \n1324: $$\n1325: \\leq 2 V_{\\max}^2 \\left[ \\int_\\Omega |g(z')|^2 dz' + \\int_\\Omega |g(z)|^2 dz \\right] = 4 V_{\\max}^2 \\|g\\|_{L^2}^2\n1326: $$\n1327: \n1328: Therefore, $C_1 = 2 V_{\\max}$.\n1329: \n1330: **Part 2: Revival Operator Bound**\n1331: \n1332: The linearized revival operator (from Lemma {prf:ref}`lem-linearization-qsd`) has the form:\n1333: \n1334: $$\n1335: \\mathbb{L}_{\\text{revival}}^* g = \\lambda_{\\text{rev}} \\left[ \\frac{m_d}{m_{\\text{eq}}} - \\frac{\\langle g, 1 \\rangle}{m_{\\text{eq}}} \\right] f_{\\text{safe}}\n1336: $$\n1337: \n1338: where $f_{\\text{safe}}$ is the safe-region density with $\\|f_{\\text{safe}}\\|_{L^\\infty} \\leq C_{\\text{safe}}$ and $m_d, m_{\\text{eq}}$ are the dead and equilibrium masses.\n1339: \n1340: The $L^2$ norm is:\n1341: \n1342: $$\n1343: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq \\lambda_{\\text{rev}} \\left( \\frac{\\|c\\|_\\infty m_{\\text{eq}}}{m_{\\text{eq}}} + \\frac{|\\langle g, 1 \\rangle|}{m_{\\text{eq}}} \\right) \\|f_{\\text{safe}}\\|_{L^2}\n1344: $$\n1345: \n1346: Using Cauchy-Schwarz for the inner product: $|\\langle g, 1 \\rangle| \\leq \\|g\\|_{L^2} \\cdot \\|1\\|_{L^2}$:\n1347: \n1348: $$\n1349: \\leq \\lambda_{\\text{rev}} C_{\\text{safe}} \\left( \\|c\\|_\\infty + \\frac{1}{m_{\\text{eq}}} \\|1\\|_{L^2} \\right) \\|g\\|_{L^2}\n1350: $$\n1351: \n1352: Therefore, $C_2 = \\lambda_{\\text{rev}} C_{\\text{safe}} (\\|c\\|_\\infty + \\|1\\|_{L^2} / m_{\\text{eq}})$.\n1353: \n1354: **Part 3: Kato-Rellich Perturbation Theory**\n1355: \n1356: From `06_convergence.md`, the pure kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ has spectral gap $\\kappa_{\\text{kin}} > 0$. By **Kato-Rellich perturbation theory** for sectorial operators (Kato 1995, *Perturbation Theory for Linear Operators*, Springer, Theorem IV.3.17):\n1357: \n1358: If the perturbation operators $\\mathbb{L}_{\\text{clone}}^*$, $\\mathbb{L}_{\\text{revival}}^*$, and $-c(z)$ satisfy $\\|B g\\|_{L^2} \\leq \\beta \\|g\\|_{L^2}$ with $\\beta < \\kappa_{\\text{kin}}$, then the perturbed operator retains a spectral gap:\n1359: \n1360: $$\n1361: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1362: $$\n1363: \n1364: **Part 4: Dirichlet Form Coercivity**\n1365: \n1366: The Dirichlet form is:\n1367: \n1368: $$\n1369: \\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle = \\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle + \\text{perturbation terms}\n1370: $$\n1371: \n1372: The kinetic part satisfies $\\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle \\geq \\kappa_{\\text{kin}} \\|g\\|_{L^2}^2$ (by spectral gap). The perturbation terms contribute at most $(C_1 + C_2 + \\|c\\|_\\infty) \\|g\\|_{L^2}^2$ in magnitude.\n1373: \n1374: Therefore:\n1375: \n1376: $$\n1377: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2 > 0\n1378: $$\n1379: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Main Theorem: Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-l1-to-linfty-near-qsd",
      "title": "Nash-Aronson Type L¹-to-L∞ Bound for Linearized Operator",
      "start_line": 1387,
      "end_line": 1451,
      "header_lines": [
        1388
      ],
      "content_start": 1390,
      "content_end": 1450,
      "content": "1390: :label: lem-l1-to-linfty-near-qsd\n1391: \n1392: For the linearized evolution $\\partial_t \\eta = \\mathbb{L}^* \\eta$ starting from $\\eta_0$ with $\\|\\eta_0\\|_{L^1} = m$ and $\\|\\eta_0\\|_{L^\\infty} \\leq M$, there exist constants $C_{\\text{Nash}}, \\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\sigma_x, R, d$) such that for any $t \\geq \\tau$ (one timestep):\n1393: \n1394: $$\n1395: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1396: \n1397: $$\n1398: \n1399: **Interpretation**: The $L^\\infty$ norm of perturbations decays to a level controlled by the $L^1$ norm, with a heat-kernel-like rate $t^{-d/2}$.\n1400: \n1401: **Proof**:\n1402: \n1403: This is a classical result in parabolic regularity theory, adapted to the hypoelliptic kinetic setting.\n1404: \n1405: **Step 1: Nash Inequality for Kinetic Operators**\n1406: \n1407: From Hérau & Nier (2004, *Arch. Ration. Mech. Anal.* 171:151-218, Theorem 2.1), hypoelliptic kinetic operators satisfy a Nash-type inequality: for any smooth function $g$ with $\\|g\\|_{L^1} = m$:\n1408: \n1409: $$\n1410: \\|g\\|_{L^2}^{2 + 4/d} \\leq C_N \\left( \\mathcal{E}(g) \\|g\\|_{L^1}^{4/d} + \\|g\\|_{L^1}^{2 + 4/d} \\right)\n1411: \n1412: $$\n1413: \n1414: where $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle$ is the Dirichlet form (entropy production).\n1415: \n1416: **Step 2: L²-to-L∞ Bootstrapping**\n1417: \n1418: For parabolic equations, the Nash inequality implies ultracontractivity of the semigroup $e^{t \\mathbb{L}^*}$: there exists $C_U$ such that:\n1419: \n1420: $$\n1421: \\|e^{t \\mathbb{L}^*}\\|_{L^1 \\to L^\\infty} \\leq \\frac{C_U}{t^{d/2}}\n1422: \n1423: $$\n1424: \n1425: for $t \\geq \\tau$. This is the **Nash-Aronson estimate** (Aronson 1968, *Bull. Amer. Math. Soc.* 74:47-49).\n1426: \n1427: **Step 3: Semigroup Decomposition**\n1428: \n1429: For $\\eta_0$ with mixed $L^1$ and $L^\\infty$ bounds, we use the semigroup property:\n1430: \n1431: $$\n1432: \\eta_t = e^{t \\mathbb{L}^*} \\eta_0\n1433: \n1434: $$\n1435: \n1436: Decompose $\\eta_0 = \\eta_0^{\\text{small}} + \\eta_0^{\\text{large}}$ where $\\|\\eta_0^{\\text{small}}\\|_{L^\\infty}$ is small but $\\|\\eta_0^{\\text{small}}\\|_{L^1} = m$, and $\\|\\eta_0^{\\text{large}}\\|_{L^1}$ is small. Then:\n1437: \n1438: $$\n1439: \\|\\eta_t\\|_{L^\\infty} \\leq \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{small}}\\|_{L^\\infty} + \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{large}}\\|_{L^\\infty}\n1440: \n1441: $$\n1442: \n1443: The first term is bounded by the ultracontractivity estimate: $C_U m / t^{d/2}$. The second term decays exponentially by the spectral gap: $M e^{-\\alpha t}$.\n1444: \n1445: Combining these:\n1446: \n1447: $$\n1448: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1449: \n1450: $$",
      "metadata": {
        "label": "lem-l1-to-linfty-near-qsd"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1387: This is the key technical lemma that upgrades weak ($L^1$) convergence to strong ($L^\\infty$) bounds.\n1388: \n1389: :::{prf:lemma} Nash-Aronson Type L¹-to-L∞ Bound for Linearized Operator\n1390: :label: lem-l1-to-linfty-near-qsd\n1391: \n1392: For the linearized evolution $\\partial_t \\eta = \\mathbb{L}^* \\eta$ starting from $\\eta_0$ with $\\|\\eta_0\\|_{L^1} = m$ and $\\|\\eta_0\\|_{L^\\infty} \\leq M$, there exist constants $C_{\\text{Nash}}, \\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\sigma_x, R, d$) such that for any $t \\geq \\tau$ (one timestep):\n1393: \n1394: $$\n1395: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1396: \n1397: $$\n1398: \n1399: **Interpretation**: The $L^\\infty$ norm of perturbations decays to a level controlled by the $L^1$ norm, with a heat-kernel-like rate $t^{-d/2}$.\n1400: \n1401: **Proof**:\n1402: \n1403: This is a classical result in parabolic regularity theory, adapted to the hypoelliptic kinetic setting.\n1404: \n1405: **Step 1: Nash Inequality for Kinetic Operators**\n1406: \n1407: From Hérau & Nier (2004, *Arch. Ration. Mech. Anal.* 171:151-218, Theorem 2.1), hypoelliptic kinetic operators satisfy a Nash-type inequality: for any smooth function $g$ with $\\|g\\|_{L^1} = m$:\n1408: \n1409: $$\n1410: \\|g\\|_{L^2}^{2 + 4/d} \\leq C_N \\left( \\mathcal{E}(g) \\|g\\|_{L^1}^{4/d} + \\|g\\|_{L^1}^{2 + 4/d} \\right)\n1411: \n1412: $$\n1413: \n1414: where $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle$ is the Dirichlet form (entropy production).\n1415: \n1416: **Step 2: L²-to-L∞ Bootstrapping**\n1417: \n1418: For parabolic equations, the Nash inequality implies ultracontractivity of the semigroup $e^{t \\mathbb{L}^*}$: there exists $C_U$ such that:\n1419: \n1420: $$\n1421: \\|e^{t \\mathbb{L}^*}\\|_{L^1 \\to L^\\infty} \\leq \\frac{C_U}{t^{d/2}}\n1422: \n1423: $$\n1424: \n1425: for $t \\geq \\tau$. This is the **Nash-Aronson estimate** (Aronson 1968, *Bull. Amer. Math. Soc.* 74:47-49).\n1426: \n1427: **Step 3: Semigroup Decomposition**\n1428: \n1429: For $\\eta_0$ with mixed $L^1$ and $L^\\infty$ bounds, we use the semigroup property:\n1430: \n1431: $$\n1432: \\eta_t = e^{t \\mathbb{L}^*} \\eta_0\n1433: \n1434: $$\n1435: \n1436: Decompose $\\eta_0 = \\eta_0^{\\text{small}} + \\eta_0^{\\text{large}}$ where $\\|\\eta_0^{\\text{small}}\\|_{L^\\infty}$ is small but $\\|\\eta_0^{\\text{small}}\\|_{L^1} = m$, and $\\|\\eta_0^{\\text{large}}\\|_{L^1}$ is small. Then:\n1437: \n1438: $$\n1439: \\|\\eta_t\\|_{L^\\infty} \\leq \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{small}}\\|_{L^\\infty} + \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{large}}\\|_{L^\\infty}\n1440: \n1441: $$\n1442: \n1443: The first term is bounded by the ultracontractivity estimate: $C_U m / t^{d/2}$. The second term decays exponentially by the spectral gap: $M e^{-\\alpha t}$.\n1444: \n1445: Combining these:\n1446: \n1447: $$\n1448: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1449: \n1450: $$\n1451: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence_bounded_density_rigorous_proof",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Main Theorem: Bounded Density Ratio"
      }
    }
  ]
}