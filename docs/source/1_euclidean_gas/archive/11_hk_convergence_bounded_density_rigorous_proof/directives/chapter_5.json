{
  "chapter_index": 5,
  "section_id": "## 5. Main Theorem: Bounded Density Ratio",
  "directive_count": 6,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-bounded-density-ratio-main",
      "title": "Bounded Density Ratio for the Euclidean Gas (RIGOROUS)",
      "start_line": 917,
      "end_line": 962,
      "header_lines": [
        918
      ],
      "content_start": 920,
      "content_end": 961,
      "content": "920: :label: thm-bounded-density-ratio-main\n921: \n922: **Status**: Complete rigorous proof\n923: \n924: **Assumptions**:\n925: - Euclidean Gas dynamics with parameters $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ from `02_euclidean_gas.md`\n926: - Cloning position jitter $\\sigma_x > 0$ (`03_cloning.md` line 6022)\n927: - Initial density $\\|f_0\\|_\\infty \\leq M_0 < \\infty$\n928: - Number of walkers $N \\geq N_0$ sufficiently large\n929: \n930: Then there exists a finite constant $M = M(\\gamma, \\sigma_v, \\sigma_x, U, R, M_0, N) < \\infty$ such that:\n931: \n932: $$\n933: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M\n934: \n935: $$\n936: \n937: where $\\tilde{\\mu}_t = \\mu_t / \\|\\mu_t\\|$ is the normalized empirical measure and $\\tilde{\\pi}_{\\text{QSD}}$ is the normalized quasi-stationary distribution.\n938: \n939: **Explicit Formula**:\n940: \n941: $$\n942: M = \\max(M_1, M_2) < \\infty\n943: \n944: $$\n945: \n946: where:\n947: - $M_1 = \\dfrac{C_{\\text{hypo}}(M_0, T_0, \\gamma, \\sigma_v, \\sigma_x, U, R)}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}$ is the **early-time bound** (Regime 1)\n948: - $M_2 = \\dfrac{C_{\\text{late}}^{\\text{total}}}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}$ is the **late-time bound** (Regime 2)\n949: \n950: **Component constants**:\n951: - $C_{\\text{hypo}}$ is the hypoelliptic smoothing constant (Lemma {prf:ref}`lem-linfty-full-operator`)\n952: - $C_{\\text{late}}^{\\text{total}} = C_\\pi + C_{\\text{late}}$ where $C_{\\text{late}}$ is from the Nash-Aronson estimate (Lemmas {prf:ref}`lem-linearization-qsd`, {prf:ref}`lem-l1-to-linfty-near-qsd`)\n953: - $c_{\\sigma_x, R} = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-(2R)^2 / (2\\sigma_x^2))$ (Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`)\n954: - $c_{\\text{mass}} = \\min\\!\\left(c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2}\\right)$ (Lemma {prf:ref}`lem-mass-lower-bound-high-prob`)\n955: - $T_0 = O(\\kappa_{\\text{QSD}}^{-1})$ is the equilibration time\n956: \n957: **Key Property**: Both $M_1$ and $M_2$ are finite and time-independent, yielding a uniform bound for all $t \\geq 0$.\n958: \n959: **Probability Statement**:\n960: - **Finite horizon**: For any fixed $T < \\infty$, the bound holds with probability $\\geq 1 - CT e^{-\\delta N}$ for all $t \\in [0, T]$.\n961: - **Infinite horizon (asymptotic)**: The bound holds **deterministically for all $t \\geq 0$** on the survival event $\\{\\tau_\\dagger = \\infty\\}$ (see Section 4.4).",
      "metadata": {
        "label": "thm-bounded-density-ratio-main"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "917: We now assemble the results from Sections 2-4 into the main theorem.\n918: \n919: :::{prf:theorem} Bounded Density Ratio for the Euclidean Gas (RIGOROUS)\n920: :label: thm-bounded-density-ratio-main\n921: \n922: **Status**: Complete rigorous proof\n923: \n924: **Assumptions**:\n925: - Euclidean Gas dynamics with parameters $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ from `02_euclidean_gas.md`\n926: - Cloning position jitter $\\sigma_x > 0$ (`03_cloning.md` line 6022)\n927: - Initial density $\\|f_0\\|_\\infty \\leq M_0 < \\infty$\n928: - Number of walkers $N \\geq N_0$ sufficiently large\n929: \n930: Then there exists a finite constant $M = M(\\gamma, \\sigma_v, \\sigma_x, U, R, M_0, N) < \\infty$ such that:\n931: \n932: $$\n933: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M\n934: \n935: $$\n936: \n937: where $\\tilde{\\mu}_t = \\mu_t / \\|\\mu_t\\|$ is the normalized empirical measure and $\\tilde{\\pi}_{\\text{QSD}}$ is the normalized quasi-stationary distribution.\n938: \n939: **Explicit Formula**:\n940: \n941: $$\n942: M = \\max(M_1, M_2) < \\infty\n943: \n944: $$\n945: \n946: where:\n947: - $M_1 = \\dfrac{C_{\\text{hypo}}(M_0, T_0, \\gamma, \\sigma_v, \\sigma_x, U, R)}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}$ is the **early-time bound** (Regime 1)\n948: - $M_2 = \\dfrac{C_{\\text{late}}^{\\text{total}}}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}$ is the **late-time bound** (Regime 2)\n949: \n950: **Component constants**:\n951: - $C_{\\text{hypo}}$ is the hypoelliptic smoothing constant (Lemma {prf:ref}`lem-linfty-full-operator`)\n952: - $C_{\\text{late}}^{\\text{total}} = C_\\pi + C_{\\text{late}}$ where $C_{\\text{late}}$ is from the Nash-Aronson estimate (Lemmas {prf:ref}`lem-linearization-qsd`, {prf:ref}`lem-l1-to-linfty-near-qsd`)\n953: - $c_{\\sigma_x, R} = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-(2R)^2 / (2\\sigma_x^2))$ (Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`)\n954: - $c_{\\text{mass}} = \\min\\!\\left(c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2}\\right)$ (Lemma {prf:ref}`lem-mass-lower-bound-high-prob`)\n955: - $T_0 = O(\\kappa_{\\text{QSD}}^{-1})$ is the equilibration time\n956: \n957: **Key Property**: Both $M_1$ and $M_2$ are finite and time-independent, yielding a uniform bound for all $t \\geq 0$.\n958: \n959: **Probability Statement**:\n960: - **Finite horizon**: For any fixed $T < \\infty$, the bound holds with probability $\\geq 1 - CT e^{-\\delta N}$ for all $t \\in [0, T]$.\n961: - **Infinite horizon (asymptotic)**: The bound holds **deterministically for all $t \\geq 0$** on the survival event $\\{\\tau_\\dagger = \\infty\\}$ (see Section 4.4).\n962: "
    },
    {
      "directive_type": "proof",
      "label": "lem-linearization-qsd",
      "title": null,
      "start_line": 964,
      "end_line": 1134,
      "header_lines": [
        965,
        1049
      ],
      "content_start": 966,
      "content_end": 1133,
      "content": "966: :::{prf:proof}\n967: :label: proof-thm-bounded-density-ratio-main\n968: **Proof of Theorem {prf:ref}`thm-bounded-density-ratio-main`**\n969: \n970: We split the proof into two time regimes.\n971: \n972: **Regime 1: Early Time** ($t \\in [0, T_0]$)\n973: \n974: Fix an equilibration time $T_0 = C / \\kappa_{\\text{QSD}}$ with $C$ large enough for the QSD to be well-established.\n975: \n976: **Step 1A: Upper Bound on Numerator**\n977: \n978: From Lemma {prf:ref}`lem-linfty-full-operator` (Section 2.4):\n979: \n980: $$\n981: \\sup_{t \\in [0, T_0]} \\|\\rho_t\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T_0, \\gamma, \\sigma_v, \\sigma_x, U, R)\n982: \n983: $$\n984: \n985: **Step 1B: Lower Bound on Denominator**\n986: \n987: From Lemma {prf:ref}`lem-qsd-strict-positivity` (Section 3.3):\n988: \n989: $$\n990: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\pi_{\\text{QSD}}(x) \\geq c_\\pi = c_{\\sigma_x, R} \\cdot m_{\\text{eq}}\n991: \n992: $$\n993: \n994: **Step 1C: Mass Conservation**\n995: \n996: From Lemma {prf:ref}`lem-mass-lower-bound-high-prob` (Section 4.3), for $t \\geq t_{\\text{eq}} \\leq T_0$:\n997: \n998: $$\n999: \\mathbb{P}\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - e^{-\\delta N}\n1000: \n1001: $$\n1002: \n1003: On this high-probability event, the density ratio satisfies:\n1004: \n1005: $$\n1006: \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} = \\frac{\\rho_t(x) / \\|\\rho_t\\|_{L^1}}{\\pi_{\\text{QSD}}(x) / \\|\\pi_{\\text{QSD}}\\|_{L^1}} = \\frac{\\rho_t(x)}{\\pi_{\\text{QSD}}(x)} \\cdot \\frac{m_{\\text{eq}}}{\\|\\rho_t\\|_{L^1}}\n1007: \n1008: $$\n1009: \n1010: Taking supremum over $x$:\n1011: \n1012: $$\n1013: \\sup_x \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} \\leq \\frac{\\|\\rho_t\\|_\\infty}{\\inf_x \\pi_{\\text{QSD}}(x)} \\cdot \\frac{m_{\\text{eq}}}{\\|\\rho_t\\|_{L^1}}\n1014: \n1015: $$\n1016: \n1017: Substituting the bounds from Steps 1A-1B:\n1018: \n1019: $$\n1020: \\sup_x \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} \\leq \\frac{C_{\\text{hypo}}}{c_{\\sigma_x, R} \\cdot m_{\\text{eq}}} \\cdot \\frac{m_{\\text{eq}}}{c_{\\text{mass}}} = \\frac{C_{\\text{hypo}}}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}\n1021: \n1022: $$\n1023: \n1024: Define:\n1025: \n1026: $$\n1027: M_1 := \\frac{C_{\\text{hypo}}(M_0, T_0, \\gamma, \\sigma_v, \\sigma_x, U, R)}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}\n1028: \n1029: $$\n1030: \n1031: Then:\n1032: \n1033: $$\n1034: \\sup_{t \\in [0, T_0]} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M_1 < \\infty\n1035: \n1036: $$\n1037: \n1038: **Regime 2: Late Time** ($t > T_0$)\n1039: \n1040: For late times, we use the exponential convergence to QSD combined with local stability analysis to obtain a uniform bound that does not depend on time.\n1041: \n1042: **Strategy Overview**: The key insight is that once the system is close to the QSD in total variation distance (exponentially fast by `06_convergence.md`), we can use *local regularity theory* to upgrade this weak convergence to $L^\\infty$ estimates. The argument proceeds in three steps:\n1043: \n1044: 1. **Linearization**: Show that near the QSD, the nonlinear McKean-Vlasov-Fokker-Planck equation can be analyzed via its linearization\n1045: 2. **L\u00b9-to-L\u221e Parabolic Estimate**: Use hypoelliptic regularity to bound the $L^\\infty$ norm of perturbations in terms of their $L^1$ norm\n1046: 3. **Assembly**: Combine with exponential TV convergence to obtain a time-independent bound\n1047: \n1048: **Step 2A: Linearized Operator Around the QSD**\n1049: \n1050: :::{prf:lemma} Linearization Around QSD Fixed Point\n1051: :label: lem-linearization-qsd\n1052: \n1053: Let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution satisfying:\n1054: \n1055: $$\n1056: \\mathcal{L}_{\\text{full}}^* \\pi_{\\text{QSD}} = 0\n1057: \n1058: $$\n1059: \n1060: where $\\mathcal{L}_{\\text{full}}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathcal{L}_{\\text{clone}}^* - c(z) + r_{\\text{revival}}$ is the full generator.\n1061: \n1062: For $\\rho_t = \\pi_{\\text{QSD}} + \\eta_t$ with $\\|\\eta_t\\|_{L^1} \\ll 1$ small, the perturbation $\\eta_t$ evolves according to:\n1063: \n1064: $$\n1065: \\frac{\\partial \\eta_t}{\\partial t} = \\mathbb{L}^* \\eta_t + \\mathcal{N}[\\eta_t]\n1066: \n1067: $$\n1068: \n1069: where:\n1070: - $\\mathbb{L}^*$ is the **linearized operator** (linear in $\\eta$)\n1071: - $\\mathcal{N}[\\eta]$ is the **nonlinear remainder** with $\\|\\mathcal{N}[\\eta]\\|_{L^1} = O(\\|\\eta\\|_{L^1}^2)$\n1072: \n1073: **Proof**:\n1074: \n1075: The linearization is standard in McKean-Vlasov theory. We expand each term:\n1076: \n1077: **Kinetic Operator**: $\\mathcal{L}_{\\text{kin}}^*$ is linear, so:\n1078: \n1079: $$\n1080: \\mathcal{L}_{\\text{kin}}^*(\\pi_{\\text{QSD}} + \\eta) = \\underbrace{\\mathcal{L}_{\\text{kin}}^* \\pi_{\\text{QSD}}}_{\\text{part of QSD eqn}} + \\mathcal{L}_{\\text{kin}}^* \\eta\n1081: \n1082: $$\n1083: \n1084: **Cloning Operator**: The cloning operator has the form (from `03_cloning.md`):\n1085: \n1086: $$\n1087: \\mathcal{L}_{\\text{clone}}^* f = \\int K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n1088: \n1089: $$\n1090: \n1091: where $V[f]$ depends nonlinearly on the density. Expanding around $\\pi_{\\text{QSD}}$:\n1092: \n1093: $$\n1094: V[\\pi + \\eta] = V[\\pi] + V'[\\pi] \\cdot \\eta + O(\\eta^2)\n1095: \n1096: $$\n1097: \n1098: The linear part is:\n1099: \n1100: $$\n1101: \\mathbb{L}_{\\text{clone}}^* \\eta := \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n1102: \n1103: $$\n1104: \n1105: The quadratic remainder is:\n1106: \n1107: $$\n1108: \\mathcal{N}_{\\text{clone}}[\\eta] = \\int K_{\\text{clone}}(z, z') [V'[\\pi] \\eta \\cdot \\eta + O(\\eta^2)] dz'\n1109: \n1110: $$\n1111: \n1112: **Killing and Revival**: The killing term $-c(z) f$ is linear. The revival term is:\n1113: \n1114: $$\n1115: r_{\\text{revival}} = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}\n1116: \n1117: $$\n1118: \n1119: where $m_a(t) = \\int f(t, z) dz$ is the alive mass. For $f = \\pi + \\eta$:\n1120: \n1121: $$\n1122: \\frac{1}{m_a} = \\frac{1}{m_{\\text{eq}} + \\|\\eta\\|_{L^1}} = \\frac{1}{m_{\\text{eq}}} \\left(1 - \\frac{\\|\\eta\\|_{L^1}}{m_{\\text{eq}}} + O(\\|\\eta\\|_{L^1}^2) \\right)\n1123: \n1124: $$\n1125: \n1126: This contributes a linear term and a quadratic remainder.\n1127: \n1128: **Assembly**: Combining all terms, the linearized operator is:\n1129: \n1130: $$\n1131: \\mathbb{L}^* := \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*\n1132: \n1133: $$",
      "metadata": {
        "label": "lem-linearization-qsd"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "964: :::\n965: \n966: :::{prf:proof}\n967: :label: proof-thm-bounded-density-ratio-main\n968: **Proof of Theorem {prf:ref}`thm-bounded-density-ratio-main`**\n969: \n970: We split the proof into two time regimes.\n971: \n972: **Regime 1: Early Time** ($t \\in [0, T_0]$)\n973: \n974: Fix an equilibration time $T_0 = C / \\kappa_{\\text{QSD}}$ with $C$ large enough for the QSD to be well-established.\n975: \n976: **Step 1A: Upper Bound on Numerator**\n977: \n978: From Lemma {prf:ref}`lem-linfty-full-operator` (Section 2.4):\n979: \n980: $$\n981: \\sup_{t \\in [0, T_0]} \\|\\rho_t\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T_0, \\gamma, \\sigma_v, \\sigma_x, U, R)\n982: \n983: $$\n984: \n985: **Step 1B: Lower Bound on Denominator**\n986: \n987: From Lemma {prf:ref}`lem-qsd-strict-positivity` (Section 3.3):\n988: \n989: $$\n990: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\pi_{\\text{QSD}}(x) \\geq c_\\pi = c_{\\sigma_x, R} \\cdot m_{\\text{eq}}\n991: \n992: $$\n993: \n994: **Step 1C: Mass Conservation**\n995: \n996: From Lemma {prf:ref}`lem-mass-lower-bound-high-prob` (Section 4.3), for $t \\geq t_{\\text{eq}} \\leq T_0$:\n997: \n998: $$\n999: \\mathbb{P}\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - e^{-\\delta N}\n1000: \n1001: $$\n1002: \n1003: On this high-probability event, the density ratio satisfies:\n1004: \n1005: $$\n1006: \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} = \\frac{\\rho_t(x) / \\|\\rho_t\\|_{L^1}}{\\pi_{\\text{QSD}}(x) / \\|\\pi_{\\text{QSD}}\\|_{L^1}} = \\frac{\\rho_t(x)}{\\pi_{\\text{QSD}}(x)} \\cdot \\frac{m_{\\text{eq}}}{\\|\\rho_t\\|_{L^1}}\n1007: \n1008: $$\n1009: \n1010: Taking supremum over $x$:\n1011: \n1012: $$\n1013: \\sup_x \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} \\leq \\frac{\\|\\rho_t\\|_\\infty}{\\inf_x \\pi_{\\text{QSD}}(x)} \\cdot \\frac{m_{\\text{eq}}}{\\|\\rho_t\\|_{L^1}}\n1014: \n1015: $$\n1016: \n1017: Substituting the bounds from Steps 1A-1B:\n1018: \n1019: $$\n1020: \\sup_x \\frac{\\tilde{\\rho}_t(x)}{\\tilde{\\pi}_{\\text{QSD}}(x)} \\leq \\frac{C_{\\text{hypo}}}{c_{\\sigma_x, R} \\cdot m_{\\text{eq}}} \\cdot \\frac{m_{\\text{eq}}}{c_{\\text{mass}}} = \\frac{C_{\\text{hypo}}}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}\n1021: \n1022: $$\n1023: \n1024: Define:\n1025: \n1026: $$\n1027: M_1 := \\frac{C_{\\text{hypo}}(M_0, T_0, \\gamma, \\sigma_v, \\sigma_x, U, R)}{c_{\\sigma_x, R} \\cdot c_{\\text{mass}}}\n1028: \n1029: $$\n1030: \n1031: Then:\n1032: \n1033: $$\n1034: \\sup_{t \\in [0, T_0]} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M_1 < \\infty\n1035: \n1036: $$\n1037: \n1038: **Regime 2: Late Time** ($t > T_0$)\n1039: \n1040: For late times, we use the exponential convergence to QSD combined with local stability analysis to obtain a uniform bound that does not depend on time.\n1041: \n1042: **Strategy Overview**: The key insight is that once the system is close to the QSD in total variation distance (exponentially fast by `06_convergence.md`), we can use *local regularity theory* to upgrade this weak convergence to $L^\\infty$ estimates. The argument proceeds in three steps:\n1043: \n1044: 1. **Linearization**: Show that near the QSD, the nonlinear McKean-Vlasov-Fokker-Planck equation can be analyzed via its linearization\n1045: 2. **L\u00b9-to-L\u221e Parabolic Estimate**: Use hypoelliptic regularity to bound the $L^\\infty$ norm of perturbations in terms of their $L^1$ norm\n1046: 3. **Assembly**: Combine with exponential TV convergence to obtain a time-independent bound\n1047: \n1048: **Step 2A: Linearized Operator Around the QSD**\n1049: \n1050: :::{prf:lemma} Linearization Around QSD Fixed Point\n1051: :label: lem-linearization-qsd\n1052: \n1053: Let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution satisfying:\n1054: \n1055: $$\n1056: \\mathcal{L}_{\\text{full}}^* \\pi_{\\text{QSD}} = 0\n1057: \n1058: $$\n1059: \n1060: where $\\mathcal{L}_{\\text{full}}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathcal{L}_{\\text{clone}}^* - c(z) + r_{\\text{revival}}$ is the full generator.\n1061: \n1062: For $\\rho_t = \\pi_{\\text{QSD}} + \\eta_t$ with $\\|\\eta_t\\|_{L^1} \\ll 1$ small, the perturbation $\\eta_t$ evolves according to:\n1063: \n1064: $$\n1065: \\frac{\\partial \\eta_t}{\\partial t} = \\mathbb{L}^* \\eta_t + \\mathcal{N}[\\eta_t]\n1066: \n1067: $$\n1068: \n1069: where:\n1070: - $\\mathbb{L}^*$ is the **linearized operator** (linear in $\\eta$)\n1071: - $\\mathcal{N}[\\eta]$ is the **nonlinear remainder** with $\\|\\mathcal{N}[\\eta]\\|_{L^1} = O(\\|\\eta\\|_{L^1}^2)$\n1072: \n1073: **Proof**:\n1074: \n1075: The linearization is standard in McKean-Vlasov theory. We expand each term:\n1076: \n1077: **Kinetic Operator**: $\\mathcal{L}_{\\text{kin}}^*$ is linear, so:\n1078: \n1079: $$\n1080: \\mathcal{L}_{\\text{kin}}^*(\\pi_{\\text{QSD}} + \\eta) = \\underbrace{\\mathcal{L}_{\\text{kin}}^* \\pi_{\\text{QSD}}}_{\\text{part of QSD eqn}} + \\mathcal{L}_{\\text{kin}}^* \\eta\n1081: \n1082: $$\n1083: \n1084: **Cloning Operator**: The cloning operator has the form (from `03_cloning.md`):\n1085: \n1086: $$\n1087: \\mathcal{L}_{\\text{clone}}^* f = \\int K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n1088: \n1089: $$\n1090: \n1091: where $V[f]$ depends nonlinearly on the density. Expanding around $\\pi_{\\text{QSD}}$:\n1092: \n1093: $$\n1094: V[\\pi + \\eta] = V[\\pi] + V'[\\pi] \\cdot \\eta + O(\\eta^2)\n1095: \n1096: $$\n1097: \n1098: The linear part is:\n1099: \n1100: $$\n1101: \\mathbb{L}_{\\text{clone}}^* \\eta := \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n1102: \n1103: $$\n1104: \n1105: The quadratic remainder is:\n1106: \n1107: $$\n1108: \\mathcal{N}_{\\text{clone}}[\\eta] = \\int K_{\\text{clone}}(z, z') [V'[\\pi] \\eta \\cdot \\eta + O(\\eta^2)] dz'\n1109: \n1110: $$\n1111: \n1112: **Killing and Revival**: The killing term $-c(z) f$ is linear. The revival term is:\n1113: \n1114: $$\n1115: r_{\\text{revival}} = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}\n1116: \n1117: $$\n1118: \n1119: where $m_a(t) = \\int f(t, z) dz$ is the alive mass. For $f = \\pi + \\eta$:\n1120: \n1121: $$\n1122: \\frac{1}{m_a} = \\frac{1}{m_{\\text{eq}} + \\|\\eta\\|_{L^1}} = \\frac{1}{m_{\\text{eq}}} \\left(1 - \\frac{\\|\\eta\\|_{L^1}}{m_{\\text{eq}}} + O(\\|\\eta\\|_{L^1}^2) \\right)\n1123: \n1124: $$\n1125: \n1126: This contributes a linear term and a quadratic remainder.\n1127: \n1128: **Assembly**: Combining all terms, the linearized operator is:\n1129: \n1130: $$\n1131: \\mathbb{L}^* := \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*\n1132: \n1133: $$\n1134: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-linearized-spectral-gap",
      "title": "Exponential Decay in L\u00b9 for Linearized Dynamics",
      "start_line": 1138,
      "end_line": 1173,
      "header_lines": [
        1139
      ],
      "content_start": 1141,
      "content_end": 1172,
      "content": "1141: :label: lem-linearized-spectral-gap\n1142: \n1143: The linearized operator $\\mathbb{L}^*$ around $\\pi_{\\text{QSD}}$ has a **spectral gap** in $L^2(\\pi_{\\text{QSD}})$:\n1144: \n1145: $$\n1146: \\mathbb{L}^* = -\\kappa_{\\text{lin}} + \\text{compact}\n1147: \n1148: $$\n1149: \n1150: where $\\kappa_{\\text{lin}} > 0$ is the gap. For any perturbation $\\eta_0$ with $\\|\\eta_0\\|_{L^1} \\leq \\delta$ sufficiently small, the linearized evolution satisfies:\n1151: \n1152: $$\n1153: \\|\\eta_t\\|_{L^1} \\leq \\|\\eta_0\\|_{L^1} e^{-\\kappa_{\\text{lin}} t / 2}\n1154: \n1155: $$\n1156: \n1157: for all $t \\geq 0$, provided $\\delta < \\delta_0$ for some threshold $\\delta_0$ determined by the nonlinearity $C_{\\text{nonlin}}$.\n1158: \n1159: **Proof Sketch**:\n1160: \n1161: This follows from standard perturbation theory for nonlinear parabolic equations:\n1162: \n1163: 1. **Spectral Gap**: The operator $\\mathbb{L}^*$ is the linearization of a hypoelliptic kinetic operator with compact perturbations (cloning, killing, revival). By the results in `06_convergence.md` (geometric ergodicity with rate $\\kappa_{\\text{QSD}}$), the linearized operator has a spectral gap $\\kappa_{\\text{lin}} \\approx \\kappa_{\\text{QSD}}$.\n1164: \n1165: 2. **Nonlinear Stability**: For the nonlinear equation $\\partial_t \\eta = \\mathbb{L}^* \\eta + \\mathcal{N}[\\eta]$, we use a Gr\u00f6nwall-type argument. The $L^1$ norm evolves as:\n1166: \n1167: $$\n1168: \\frac{d}{dt} \\|\\eta_t\\|_{L^1} \\leq -\\kappa_{\\text{lin}} \\|\\eta_t\\|_{L^1} + C_{\\text{nonlin}} \\|\\eta_t\\|_{L^1}^2\n1169: \n1170: $$\n1171: \n1172: For $\\|\\eta_0\\|_{L^1} \\leq \\delta_0 := \\kappa_{\\text{lin}} / (2 C_{\\text{nonlin}})$, the linear term dominates and we obtain exponential decay with rate $\\kappa_{\\text{lin}} / 2$.",
      "metadata": {
        "label": "lem-linearized-spectral-gap"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1138: **Step 2B: Spectral Gap of the Linearized Operator**\n1139: \n1140: :::{prf:lemma} Exponential Decay in L\u00b9 for Linearized Dynamics\n1141: :label: lem-linearized-spectral-gap\n1142: \n1143: The linearized operator $\\mathbb{L}^*$ around $\\pi_{\\text{QSD}}$ has a **spectral gap** in $L^2(\\pi_{\\text{QSD}})$:\n1144: \n1145: $$\n1146: \\mathbb{L}^* = -\\kappa_{\\text{lin}} + \\text{compact}\n1147: \n1148: $$\n1149: \n1150: where $\\kappa_{\\text{lin}} > 0$ is the gap. For any perturbation $\\eta_0$ with $\\|\\eta_0\\|_{L^1} \\leq \\delta$ sufficiently small, the linearized evolution satisfies:\n1151: \n1152: $$\n1153: \\|\\eta_t\\|_{L^1} \\leq \\|\\eta_0\\|_{L^1} e^{-\\kappa_{\\text{lin}} t / 2}\n1154: \n1155: $$\n1156: \n1157: for all $t \\geq 0$, provided $\\delta < \\delta_0$ for some threshold $\\delta_0$ determined by the nonlinearity $C_{\\text{nonlin}}$.\n1158: \n1159: **Proof Sketch**:\n1160: \n1161: This follows from standard perturbation theory for nonlinear parabolic equations:\n1162: \n1163: 1. **Spectral Gap**: The operator $\\mathbb{L}^*$ is the linearization of a hypoelliptic kinetic operator with compact perturbations (cloning, killing, revival). By the results in `06_convergence.md` (geometric ergodicity with rate $\\kappa_{\\text{QSD}}$), the linearized operator has a spectral gap $\\kappa_{\\text{lin}} \\approx \\kappa_{\\text{QSD}}$.\n1164: \n1165: 2. **Nonlinear Stability**: For the nonlinear equation $\\partial_t \\eta = \\mathbb{L}^* \\eta + \\mathcal{N}[\\eta]$, we use a Gr\u00f6nwall-type argument. The $L^1$ norm evolves as:\n1166: \n1167: $$\n1168: \\frac{d}{dt} \\|\\eta_t\\|_{L^1} \\leq -\\kappa_{\\text{lin}} \\|\\eta_t\\|_{L^1} + C_{\\text{nonlin}} \\|\\eta_t\\|_{L^1}^2\n1169: \n1170: $$\n1171: \n1172: For $\\|\\eta_0\\|_{L^1} \\leq \\delta_0 := \\kappa_{\\text{lin}} / (2 C_{\\text{nonlin}})$, the linear term dominates and we obtain exponential decay with rate $\\kappa_{\\text{lin}} / 2$.\n1173: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-hypoellipticity-full-linearized",
      "title": "Hypoellipticity Preservation via Bootstrap Argument",
      "start_line": 1179,
      "end_line": 1263,
      "header_lines": [
        1180
      ],
      "content_start": 1182,
      "content_end": 1262,
      "content": "1182: :label: lem-hypoellipticity-full-linearized\n1183: \n1184: The linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` is **hypoelliptic** in the sense that:\n1185: \n1186: If $\\partial_t \\eta = \\mathbb{L}^* \\eta$ with initial condition $\\eta_0 \\in L^1(\\Omega)$, then for any $t > 0$, the solution $\\eta_t \\in C^\\infty(\\Omega)$.\n1187: \n1188: **Proof**:\n1189: \n1190: The proof uses a **bootstrap argument** that separates the \"regularizing engine\" (kinetic operator) from the \"source terms\" (nonlocal operators).\n1191: \n1192: **Step 1: Isolate the Hypoelliptic Engine**\n1193: \n1194: Rearrange the evolution equation:\n1195: \n1196: $$\n1197: \\frac{\\partial \\eta}{\\partial t} - \\mathcal{L}_{\\text{kin}}^* \\eta = f[\\eta]\n1198: \n1199: $$\n1200: \n1201: where the \"source term\" is:\n1202: \n1203: $$\n1204: f[\\eta] := \\mathbb{L}_{\\text{clone}}^* \\eta - c(z) \\eta + \\mathbb{L}_{\\text{revival}}^* \\eta\n1205: \n1206: $$\n1207: \n1208: Define the hypoelliptic operator $\\mathbb{L}_{\\text{hypo}} := \\partial_t - \\mathcal{L}_{\\text{kin}}^*$. By Lemma {prf:ref}`lem-hormander-bracket` (Section 2.2), this operator satisfies H\u00f6rmander's bracket condition, making it hypoelliptic.\n1209: \n1210: **Step 2: H\u00f6rmander's Theorem**\n1211: \n1212: By H\u00f6rmander's theorem (H\u00f6rmander 1967, *Acta Math.* 119:147-171), if $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ and the source term $f \\in C^k(\\Omega)$ for some $k \\geq 0$, then the solution $\\eta$ is automatically smoother: $\\eta \\in C^{k+\\alpha}(\\Omega)$ for some $\\alpha > 0$ (and in fact, $\\eta \\in C^\\infty$ if $f \\in C^\\infty$).\n1213: \n1214: **Step 3: Regularity of the Source Term**\n1215: \n1216: The key observation is that **if $\\eta \\in C^k$, then $f[\\eta] \\in C^k$**. We verify each component:\n1217: \n1218: **Cloning operator**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator is:\n1219: \n1220: $$\n1221: \\mathbb{L}_{\\text{clone}}^* \\eta = \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n1222: \n1223: $$\n1224: \n1225: This is a convolution with the Gaussian kernel $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x - x') \\delta(v - v')$ plus multiplication by the fitness functional $V[\\pi]$ and its derivative $V'[\\pi]$.\n1226: \n1227: - The Gaussian kernel $G_{\\sigma_x}$ is $C^\\infty$ (analytic).\n1228: - The fitness functional $V[\\pi]$ depends on the potential $U$ and the virtual reward mechanism. From the Fragile framework (`02_euclidean_gas.md`, Axiom of Smooth Potential), the potential $U \\in C^\\infty(\\mathcal{X})$. The virtual reward is a functional of integrals of $\\pi$, which are smooth.\n1229: - **Conclusion**: Convolution with a $C^\\infty$ kernel preserves regularity. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{clone}}^* \\eta \\in C^k$.\n1230: \n1231: **Killing term**: $-c(z) \\eta$ where $c(z) \\geq 0$ is the killing rate. From the framework, $c(z)$ is smooth (defined by the domain boundaries with smooth indicator functions). If $\\eta \\in C^k$, then $c(z) \\eta \\in C^k$.\n1232: \n1233: **Revival term**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized revival operator is:\n1234: \n1235: $$\n1236: \\mathbb{L}_{\\text{revival}}^* \\eta = \\lambda_{\\text{rev}} \\frac{m_d}{m_{\\text{eq}}} \\left( f_{\\text{safe}} \\eta - \\frac{f_{\\text{safe}}}{m_{\\text{eq}}} \\int \\eta \\, dz \\right)\n1237: \n1238: $$\n1239: \n1240: where $f_{\\text{safe}}$ is the revival distribution (smooth by framework assumptions). The integral $\\int \\eta \\, dz$ is a scalar. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{revival}}^* \\eta \\in C^k$.\n1241: \n1242: **Overall**: All components of $f[\\eta]$ preserve regularity, so $\\eta \\in C^k \\Rightarrow f[\\eta] \\in C^k$.\n1243: \n1244: **Step 4: Bootstrap Loop**\n1245: \n1246: 1. **Initial regularity**: From basic parabolic theory, for short time $t > 0$, the solution $\\eta_t$ is at least continuous: $\\eta_t \\in C^0(\\Omega)$.\n1247: \n1248: 2. **Bootstrap iteration**: Assume $\\eta \\in C^k$ for some $k \\geq 0$. Then:\n1249:    - By Step 3, $f[\\eta] \\in C^k$\n1250:    - By H\u00f6rmander's theorem (Step 2), $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ implies $\\eta \\in C^{k+\\alpha}$\n1251:    - Therefore, $\\eta$ is strictly smoother than we assumed\n1252: \n1253: 3. **Infinite iteration**: Repeating this argument indefinitely, we conclude $\\eta \\in C^\\infty(\\Omega)$ for all $t > 0$.\n1254: \n1255: **Step 5: Nash-Aronson Applicability**\n1256: \n1257: Since the operator $\\mathbb{L}^*$ is hypoelliptic (produces $C^\\infty$ solutions), the standard theory of hypoelliptic parabolic equations applies. In particular:\n1258: \n1259: - The Nash inequality holds for $\\mathbb{L}^*$ (H\u00e9rau & Nier 2004, Theorem 2.1, extended to operators with smooth source terms)\n1260: - The ultracontractivity estimate (Nash-Aronson) follows from the Nash inequality via standard bootstrapping arguments (Aronson 1968; Carlen & Loss 1993)\n1261: \n1262: **Conclusion**: The full linearized operator $\\mathbb{L}^*$ is hypoelliptic, and the Nash-Aronson $L^1 \\to L^\\infty$ estimate applies to its semigroup.",
      "metadata": {
        "label": "lem-hypoellipticity-full-linearized"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1179: Before we can apply parabolic regularity estimates (Nash-Aronson), we must establish that the full linearized operator $\\mathbb{L}^*$ (including nonlocal cloning and revival terms) preserves the hypoelliptic structure of the kinetic operator.\n1180: \n1181: :::{prf:lemma} Hypoellipticity Preservation via Bootstrap Argument\n1182: :label: lem-hypoellipticity-full-linearized\n1183: \n1184: The linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` is **hypoelliptic** in the sense that:\n1185: \n1186: If $\\partial_t \\eta = \\mathbb{L}^* \\eta$ with initial condition $\\eta_0 \\in L^1(\\Omega)$, then for any $t > 0$, the solution $\\eta_t \\in C^\\infty(\\Omega)$.\n1187: \n1188: **Proof**:\n1189: \n1190: The proof uses a **bootstrap argument** that separates the \"regularizing engine\" (kinetic operator) from the \"source terms\" (nonlocal operators).\n1191: \n1192: **Step 1: Isolate the Hypoelliptic Engine**\n1193: \n1194: Rearrange the evolution equation:\n1195: \n1196: $$\n1197: \\frac{\\partial \\eta}{\\partial t} - \\mathcal{L}_{\\text{kin}}^* \\eta = f[\\eta]\n1198: \n1199: $$\n1200: \n1201: where the \"source term\" is:\n1202: \n1203: $$\n1204: f[\\eta] := \\mathbb{L}_{\\text{clone}}^* \\eta - c(z) \\eta + \\mathbb{L}_{\\text{revival}}^* \\eta\n1205: \n1206: $$\n1207: \n1208: Define the hypoelliptic operator $\\mathbb{L}_{\\text{hypo}} := \\partial_t - \\mathcal{L}_{\\text{kin}}^*$. By Lemma {prf:ref}`lem-hormander-bracket` (Section 2.2), this operator satisfies H\u00f6rmander's bracket condition, making it hypoelliptic.\n1209: \n1210: **Step 2: H\u00f6rmander's Theorem**\n1211: \n1212: By H\u00f6rmander's theorem (H\u00f6rmander 1967, *Acta Math.* 119:147-171), if $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ and the source term $f \\in C^k(\\Omega)$ for some $k \\geq 0$, then the solution $\\eta$ is automatically smoother: $\\eta \\in C^{k+\\alpha}(\\Omega)$ for some $\\alpha > 0$ (and in fact, $\\eta \\in C^\\infty$ if $f \\in C^\\infty$).\n1213: \n1214: **Step 3: Regularity of the Source Term**\n1215: \n1216: The key observation is that **if $\\eta \\in C^k$, then $f[\\eta] \\in C^k$**. We verify each component:\n1217: \n1218: **Cloning operator**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator is:\n1219: \n1220: $$\n1221: \\mathbb{L}_{\\text{clone}}^* \\eta = \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n1222: \n1223: $$\n1224: \n1225: This is a convolution with the Gaussian kernel $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x - x') \\delta(v - v')$ plus multiplication by the fitness functional $V[\\pi]$ and its derivative $V'[\\pi]$.\n1226: \n1227: - The Gaussian kernel $G_{\\sigma_x}$ is $C^\\infty$ (analytic).\n1228: - The fitness functional $V[\\pi]$ depends on the potential $U$ and the virtual reward mechanism. From the Fragile framework (`02_euclidean_gas.md`, Axiom of Smooth Potential), the potential $U \\in C^\\infty(\\mathcal{X})$. The virtual reward is a functional of integrals of $\\pi$, which are smooth.\n1229: - **Conclusion**: Convolution with a $C^\\infty$ kernel preserves regularity. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{clone}}^* \\eta \\in C^k$.\n1230: \n1231: **Killing term**: $-c(z) \\eta$ where $c(z) \\geq 0$ is the killing rate. From the framework, $c(z)$ is smooth (defined by the domain boundaries with smooth indicator functions). If $\\eta \\in C^k$, then $c(z) \\eta \\in C^k$.\n1232: \n1233: **Revival term**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized revival operator is:\n1234: \n1235: $$\n1236: \\mathbb{L}_{\\text{revival}}^* \\eta = \\lambda_{\\text{rev}} \\frac{m_d}{m_{\\text{eq}}} \\left( f_{\\text{safe}} \\eta - \\frac{f_{\\text{safe}}}{m_{\\text{eq}}} \\int \\eta \\, dz \\right)\n1237: \n1238: $$\n1239: \n1240: where $f_{\\text{safe}}$ is the revival distribution (smooth by framework assumptions). The integral $\\int \\eta \\, dz$ is a scalar. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{revival}}^* \\eta \\in C^k$.\n1241: \n1242: **Overall**: All components of $f[\\eta]$ preserve regularity, so $\\eta \\in C^k \\Rightarrow f[\\eta] \\in C^k$.\n1243: \n1244: **Step 4: Bootstrap Loop**\n1245: \n1246: 1. **Initial regularity**: From basic parabolic theory, for short time $t > 0$, the solution $\\eta_t$ is at least continuous: $\\eta_t \\in C^0(\\Omega)$.\n1247: \n1248: 2. **Bootstrap iteration**: Assume $\\eta \\in C^k$ for some $k \\geq 0$. Then:\n1249:    - By Step 3, $f[\\eta] \\in C^k$\n1250:    - By H\u00f6rmander's theorem (Step 2), $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ implies $\\eta \\in C^{k+\\alpha}$\n1251:    - Therefore, $\\eta$ is strictly smoother than we assumed\n1252: \n1253: 3. **Infinite iteration**: Repeating this argument indefinitely, we conclude $\\eta \\in C^\\infty(\\Omega)$ for all $t > 0$.\n1254: \n1255: **Step 5: Nash-Aronson Applicability**\n1256: \n1257: Since the operator $\\mathbb{L}^*$ is hypoelliptic (produces $C^\\infty$ solutions), the standard theory of hypoelliptic parabolic equations applies. In particular:\n1258: \n1259: - The Nash inequality holds for $\\mathbb{L}^*$ (H\u00e9rau & Nier 2004, Theorem 2.1, extended to operators with smooth source terms)\n1260: - The ultracontractivity estimate (Nash-Aronson) follows from the Nash inequality via standard bootstrapping arguments (Aronson 1968; Carlen & Loss 1993)\n1261: \n1262: **Conclusion**: The full linearized operator $\\mathbb{L}^*$ is hypoelliptic, and the Nash-Aronson $L^1 \\to L^\\infty$ estimate applies to its semigroup.\n1263: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-relative-boundedness-nonlocal",
      "title": "Relative Boundedness of Nonlocal Operators",
      "start_line": 1274,
      "end_line": 1379,
      "header_lines": [
        1275
      ],
      "content_start": 1277,
      "content_end": 1378,
      "content": "1277: :label: lem-relative-boundedness-nonlocal\n1278: \n1279: The linearized nonlocal operators $\\mathbb{L}_{\\text{clone}}^*$ and $\\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` are **relatively bounded** with respect to the kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ in $L^2(\\pi_{\\text{QSD}}^{-1})$:\n1280: \n1281: $$\n1282: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2} \\leq C_1 \\|g\\|_{L^2}\n1283: $$\n1284: \n1285: $$\n1286: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq C_2 \\|g\\|_{L^2}\n1287: $$\n1288: \n1289: with constants $C_1, C_2 < \\kappa_{\\text{kin}} / 2$ where $\\kappa_{\\text{kin}} > 0$ is the kinetic spectral gap.\n1290: \n1291: **Consequence**: The full linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ retains a spectral gap:\n1292: \n1293: $$\n1294: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1295: $$\n1296: \n1297: and the associated Dirichlet form $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle_{\\pi_{\\text{QSD}}^{-1}}$ is coercive:\n1298: \n1299: $$\n1300: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2\n1301: \n1302: $$\n1303: \n1304: **Proof**:\n1305: \n1306: **Part 1: Cloning Operator Bound**\n1307: \n1308: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator has the form:\n1309: \n1310: $$\n1311: \\mathbb{L}_{\\text{clone}}^* g(z) = \\int_\\Omega K_{\\text{clone}}(z, z') W(z, z') [g(z') - g(z)] dz'\n1312: $$\n1313: \n1314: where $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x-x') \\delta(v-v')$ is the Gaussian position kernel and $W(z, z')$ is a bounded fitness-dependent weight with $\\|W\\|_\\infty \\leq V_{\\max}$.\n1315: \n1316: By the **Schur test** for integral operators:\n1317: \n1318: $$\n1319: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2}^2 = \\int_\\Omega \\left| \\int_\\Omega K(z,z') W(z,z') [g(z') - g(z)] dz' \\right|^2 dz\n1320: $$\n1321: \n1322: Using Cauchy-Schwarz and the fact that $K$ is a probability kernel ($\\int K(z, z') dz' = 1$):\n1323: \n1324: $$\n1325: \\leq 2 V_{\\max}^2 \\left[ \\int_\\Omega |g(z')|^2 dz' + \\int_\\Omega |g(z)|^2 dz \\right] = 4 V_{\\max}^2 \\|g\\|_{L^2}^2\n1326: $$\n1327: \n1328: Therefore, $C_1 = 2 V_{\\max}$.\n1329: \n1330: **Part 2: Revival Operator Bound**\n1331: \n1332: The linearized revival operator (from Lemma {prf:ref}`lem-linearization-qsd`) has the form:\n1333: \n1334: $$\n1335: \\mathbb{L}_{\\text{revival}}^* g = \\lambda_{\\text{rev}} \\left[ \\frac{m_d}{m_{\\text{eq}}} - \\frac{\\langle g, 1 \\rangle}{m_{\\text{eq}}} \\right] f_{\\text{safe}}\n1336: $$\n1337: \n1338: where $f_{\\text{safe}}$ is the safe-region density with $\\|f_{\\text{safe}}\\|_{L^\\infty} \\leq C_{\\text{safe}}$ and $m_d, m_{\\text{eq}}$ are the dead and equilibrium masses.\n1339: \n1340: The $L^2$ norm is:\n1341: \n1342: $$\n1343: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq \\lambda_{\\text{rev}} \\left( \\frac{\\|c\\|_\\infty m_{\\text{eq}}}{m_{\\text{eq}}} + \\frac{|\\langle g, 1 \\rangle|}{m_{\\text{eq}}} \\right) \\|f_{\\text{safe}}\\|_{L^2}\n1344: $$\n1345: \n1346: Using Cauchy-Schwarz for the inner product: $|\\langle g, 1 \\rangle| \\leq \\|g\\|_{L^2} \\cdot \\|1\\|_{L^2}$:\n1347: \n1348: $$\n1349: \\leq \\lambda_{\\text{rev}} C_{\\text{safe}} \\left( \\|c\\|_\\infty + \\frac{1}{m_{\\text{eq}}} \\|1\\|_{L^2} \\right) \\|g\\|_{L^2}\n1350: $$\n1351: \n1352: Therefore, $C_2 = \\lambda_{\\text{rev}} C_{\\text{safe}} (\\|c\\|_\\infty + \\|1\\|_{L^2} / m_{\\text{eq}})$.\n1353: \n1354: **Part 3: Kato-Rellich Perturbation Theory**\n1355: \n1356: From `06_convergence.md`, the pure kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ has spectral gap $\\kappa_{\\text{kin}} > 0$. By **Kato-Rellich perturbation theory** for sectorial operators (Kato 1995, *Perturbation Theory for Linear Operators*, Springer, Theorem IV.3.17):\n1357: \n1358: If the perturbation operators $\\mathbb{L}_{\\text{clone}}^*$, $\\mathbb{L}_{\\text{revival}}^*$, and $-c(z)$ satisfy $\\|B g\\|_{L^2} \\leq \\beta \\|g\\|_{L^2}$ with $\\beta < \\kappa_{\\text{kin}}$, then the perturbed operator retains a spectral gap:\n1359: \n1360: $$\n1361: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1362: $$\n1363: \n1364: **Part 4: Dirichlet Form Coercivity**\n1365: \n1366: The Dirichlet form is:\n1367: \n1368: $$\n1369: \\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle = \\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle + \\text{perturbation terms}\n1370: $$\n1371: \n1372: The kinetic part satisfies $\\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle \\geq \\kappa_{\\text{kin}} \\|g\\|_{L^2}^2$ (by spectral gap). The perturbation terms contribute at most $(C_1 + C_2 + \\|c\\|_\\infty) \\|g\\|_{L^2}^2$ in magnitude.\n1373: \n1374: Therefore:\n1375: \n1376: $$\n1377: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2 > 0\n1378: $$",
      "metadata": {
        "label": "lem-relative-boundedness-nonlocal"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1274: Before applying Nash-Aronson theory, we must verify that the nonlocal cloning and revival operators do not destroy the coercive Dirichlet form structure of the kinetic operator.\n1275: \n1276: :::{prf:lemma} Relative Boundedness of Nonlocal Operators\n1277: :label: lem-relative-boundedness-nonlocal\n1278: \n1279: The linearized nonlocal operators $\\mathbb{L}_{\\text{clone}}^*$ and $\\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` are **relatively bounded** with respect to the kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ in $L^2(\\pi_{\\text{QSD}}^{-1})$:\n1280: \n1281: $$\n1282: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2} \\leq C_1 \\|g\\|_{L^2}\n1283: $$\n1284: \n1285: $$\n1286: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq C_2 \\|g\\|_{L^2}\n1287: $$\n1288: \n1289: with constants $C_1, C_2 < \\kappa_{\\text{kin}} / 2$ where $\\kappa_{\\text{kin}} > 0$ is the kinetic spectral gap.\n1290: \n1291: **Consequence**: The full linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ retains a spectral gap:\n1292: \n1293: $$\n1294: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1295: $$\n1296: \n1297: and the associated Dirichlet form $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle_{\\pi_{\\text{QSD}}^{-1}}$ is coercive:\n1298: \n1299: $$\n1300: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2\n1301: \n1302: $$\n1303: \n1304: **Proof**:\n1305: \n1306: **Part 1: Cloning Operator Bound**\n1307: \n1308: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator has the form:\n1309: \n1310: $$\n1311: \\mathbb{L}_{\\text{clone}}^* g(z) = \\int_\\Omega K_{\\text{clone}}(z, z') W(z, z') [g(z') - g(z)] dz'\n1312: $$\n1313: \n1314: where $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x-x') \\delta(v-v')$ is the Gaussian position kernel and $W(z, z')$ is a bounded fitness-dependent weight with $\\|W\\|_\\infty \\leq V_{\\max}$.\n1315: \n1316: By the **Schur test** for integral operators:\n1317: \n1318: $$\n1319: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2}^2 = \\int_\\Omega \\left| \\int_\\Omega K(z,z') W(z,z') [g(z') - g(z)] dz' \\right|^2 dz\n1320: $$\n1321: \n1322: Using Cauchy-Schwarz and the fact that $K$ is a probability kernel ($\\int K(z, z') dz' = 1$):\n1323: \n1324: $$\n1325: \\leq 2 V_{\\max}^2 \\left[ \\int_\\Omega |g(z')|^2 dz' + \\int_\\Omega |g(z)|^2 dz \\right] = 4 V_{\\max}^2 \\|g\\|_{L^2}^2\n1326: $$\n1327: \n1328: Therefore, $C_1 = 2 V_{\\max}$.\n1329: \n1330: **Part 2: Revival Operator Bound**\n1331: \n1332: The linearized revival operator (from Lemma {prf:ref}`lem-linearization-qsd`) has the form:\n1333: \n1334: $$\n1335: \\mathbb{L}_{\\text{revival}}^* g = \\lambda_{\\text{rev}} \\left[ \\frac{m_d}{m_{\\text{eq}}} - \\frac{\\langle g, 1 \\rangle}{m_{\\text{eq}}} \\right] f_{\\text{safe}}\n1336: $$\n1337: \n1338: where $f_{\\text{safe}}$ is the safe-region density with $\\|f_{\\text{safe}}\\|_{L^\\infty} \\leq C_{\\text{safe}}$ and $m_d, m_{\\text{eq}}$ are the dead and equilibrium masses.\n1339: \n1340: The $L^2$ norm is:\n1341: \n1342: $$\n1343: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq \\lambda_{\\text{rev}} \\left( \\frac{\\|c\\|_\\infty m_{\\text{eq}}}{m_{\\text{eq}}} + \\frac{|\\langle g, 1 \\rangle|}{m_{\\text{eq}}} \\right) \\|f_{\\text{safe}}\\|_{L^2}\n1344: $$\n1345: \n1346: Using Cauchy-Schwarz for the inner product: $|\\langle g, 1 \\rangle| \\leq \\|g\\|_{L^2} \\cdot \\|1\\|_{L^2}$:\n1347: \n1348: $$\n1349: \\leq \\lambda_{\\text{rev}} C_{\\text{safe}} \\left( \\|c\\|_\\infty + \\frac{1}{m_{\\text{eq}}} \\|1\\|_{L^2} \\right) \\|g\\|_{L^2}\n1350: $$\n1351: \n1352: Therefore, $C_2 = \\lambda_{\\text{rev}} C_{\\text{safe}} (\\|c\\|_\\infty + \\|1\\|_{L^2} / m_{\\text{eq}})$.\n1353: \n1354: **Part 3: Kato-Rellich Perturbation Theory**\n1355: \n1356: From `06_convergence.md`, the pure kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ has spectral gap $\\kappa_{\\text{kin}} > 0$. By **Kato-Rellich perturbation theory** for sectorial operators (Kato 1995, *Perturbation Theory for Linear Operators*, Springer, Theorem IV.3.17):\n1357: \n1358: If the perturbation operators $\\mathbb{L}_{\\text{clone}}^*$, $\\mathbb{L}_{\\text{revival}}^*$, and $-c(z)$ satisfy $\\|B g\\|_{L^2} \\leq \\beta \\|g\\|_{L^2}$ with $\\beta < \\kappa_{\\text{kin}}$, then the perturbed operator retains a spectral gap:\n1359: \n1360: $$\n1361: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n1362: $$\n1363: \n1364: **Part 4: Dirichlet Form Coercivity**\n1365: \n1366: The Dirichlet form is:\n1367: \n1368: $$\n1369: \\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle = \\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle + \\text{perturbation terms}\n1370: $$\n1371: \n1372: The kinetic part satisfies $\\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle \\geq \\kappa_{\\text{kin}} \\|g\\|_{L^2}^2$ (by spectral gap). The perturbation terms contribute at most $(C_1 + C_2 + \\|c\\|_\\infty) \\|g\\|_{L^2}^2$ in magnitude.\n1373: \n1374: Therefore:\n1375: \n1376: $$\n1377: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2 > 0\n1378: $$\n1379: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-l1-to-linfty-near-qsd",
      "title": "Nash-Aronson Type L\u00b9-to-L\u221e Bound for Linearized Operator",
      "start_line": 1387,
      "end_line": 1451,
      "header_lines": [
        1388
      ],
      "content_start": 1390,
      "content_end": 1450,
      "content": "1390: :label: lem-l1-to-linfty-near-qsd\n1391: \n1392: For the linearized evolution $\\partial_t \\eta = \\mathbb{L}^* \\eta$ starting from $\\eta_0$ with $\\|\\eta_0\\|_{L^1} = m$ and $\\|\\eta_0\\|_{L^\\infty} \\leq M$, there exist constants $C_{\\text{Nash}}, \\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\sigma_x, R, d$) such that for any $t \\geq \\tau$ (one timestep):\n1393: \n1394: $$\n1395: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1396: \n1397: $$\n1398: \n1399: **Interpretation**: The $L^\\infty$ norm of perturbations decays to a level controlled by the $L^1$ norm, with a heat-kernel-like rate $t^{-d/2}$.\n1400: \n1401: **Proof**:\n1402: \n1403: This is a classical result in parabolic regularity theory, adapted to the hypoelliptic kinetic setting.\n1404: \n1405: **Step 1: Nash Inequality for Kinetic Operators**\n1406: \n1407: From H\u00e9rau & Nier (2004, *Arch. Ration. Mech. Anal.* 171:151-218, Theorem 2.1), hypoelliptic kinetic operators satisfy a Nash-type inequality: for any smooth function $g$ with $\\|g\\|_{L^1} = m$:\n1408: \n1409: $$\n1410: \\|g\\|_{L^2}^{2 + 4/d} \\leq C_N \\left( \\mathcal{E}(g) \\|g\\|_{L^1}^{4/d} + \\|g\\|_{L^1}^{2 + 4/d} \\right)\n1411: \n1412: $$\n1413: \n1414: where $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle$ is the Dirichlet form (entropy production).\n1415: \n1416: **Step 2: L\u00b2-to-L\u221e Bootstrapping**\n1417: \n1418: For parabolic equations, the Nash inequality implies ultracontractivity of the semigroup $e^{t \\mathbb{L}^*}$: there exists $C_U$ such that:\n1419: \n1420: $$\n1421: \\|e^{t \\mathbb{L}^*}\\|_{L^1 \\to L^\\infty} \\leq \\frac{C_U}{t^{d/2}}\n1422: \n1423: $$\n1424: \n1425: for $t \\geq \\tau$. This is the **Nash-Aronson estimate** (Aronson 1968, *Bull. Amer. Math. Soc.* 74:47-49).\n1426: \n1427: **Step 3: Semigroup Decomposition**\n1428: \n1429: For $\\eta_0$ with mixed $L^1$ and $L^\\infty$ bounds, we use the semigroup property:\n1430: \n1431: $$\n1432: \\eta_t = e^{t \\mathbb{L}^*} \\eta_0\n1433: \n1434: $$\n1435: \n1436: Decompose $\\eta_0 = \\eta_0^{\\text{small}} + \\eta_0^{\\text{large}}$ where $\\|\\eta_0^{\\text{small}}\\|_{L^\\infty}$ is small but $\\|\\eta_0^{\\text{small}}\\|_{L^1} = m$, and $\\|\\eta_0^{\\text{large}}\\|_{L^1}$ is small. Then:\n1437: \n1438: $$\n1439: \\|\\eta_t\\|_{L^\\infty} \\leq \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{small}}\\|_{L^\\infty} + \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{large}}\\|_{L^\\infty}\n1440: \n1441: $$\n1442: \n1443: The first term is bounded by the ultracontractivity estimate: $C_U m / t^{d/2}$. The second term decays exponentially by the spectral gap: $M e^{-\\alpha t}$.\n1444: \n1445: Combining these:\n1446: \n1447: $$\n1448: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1449: \n1450: $$",
      "metadata": {
        "label": "lem-l1-to-linfty-near-qsd"
      },
      "section": "## 5. Main Theorem: Bounded Density Ratio",
      "raw_directive": "1387: This is the key technical lemma that upgrades weak ($L^1$) convergence to strong ($L^\\infty$) bounds.\n1388: \n1389: :::{prf:lemma} Nash-Aronson Type L\u00b9-to-L\u221e Bound for Linearized Operator\n1390: :label: lem-l1-to-linfty-near-qsd\n1391: \n1392: For the linearized evolution $\\partial_t \\eta = \\mathbb{L}^* \\eta$ starting from $\\eta_0$ with $\\|\\eta_0\\|_{L^1} = m$ and $\\|\\eta_0\\|_{L^\\infty} \\leq M$, there exist constants $C_{\\text{Nash}}, \\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\sigma_x, R, d$) such that for any $t \\geq \\tau$ (one timestep):\n1393: \n1394: $$\n1395: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1396: \n1397: $$\n1398: \n1399: **Interpretation**: The $L^\\infty$ norm of perturbations decays to a level controlled by the $L^1$ norm, with a heat-kernel-like rate $t^{-d/2}$.\n1400: \n1401: **Proof**:\n1402: \n1403: This is a classical result in parabolic regularity theory, adapted to the hypoelliptic kinetic setting.\n1404: \n1405: **Step 1: Nash Inequality for Kinetic Operators**\n1406: \n1407: From H\u00e9rau & Nier (2004, *Arch. Ration. Mech. Anal.* 171:151-218, Theorem 2.1), hypoelliptic kinetic operators satisfy a Nash-type inequality: for any smooth function $g$ with $\\|g\\|_{L^1} = m$:\n1408: \n1409: $$\n1410: \\|g\\|_{L^2}^{2 + 4/d} \\leq C_N \\left( \\mathcal{E}(g) \\|g\\|_{L^1}^{4/d} + \\|g\\|_{L^1}^{2 + 4/d} \\right)\n1411: \n1412: $$\n1413: \n1414: where $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle$ is the Dirichlet form (entropy production).\n1415: \n1416: **Step 2: L\u00b2-to-L\u221e Bootstrapping**\n1417: \n1418: For parabolic equations, the Nash inequality implies ultracontractivity of the semigroup $e^{t \\mathbb{L}^*}$: there exists $C_U$ such that:\n1419: \n1420: $$\n1421: \\|e^{t \\mathbb{L}^*}\\|_{L^1 \\to L^\\infty} \\leq \\frac{C_U}{t^{d/2}}\n1422: \n1423: $$\n1424: \n1425: for $t \\geq \\tau$. This is the **Nash-Aronson estimate** (Aronson 1968, *Bull. Amer. Math. Soc.* 74:47-49).\n1426: \n1427: **Step 3: Semigroup Decomposition**\n1428: \n1429: For $\\eta_0$ with mixed $L^1$ and $L^\\infty$ bounds, we use the semigroup property:\n1430: \n1431: $$\n1432: \\eta_t = e^{t \\mathbb{L}^*} \\eta_0\n1433: \n1434: $$\n1435: \n1436: Decompose $\\eta_0 = \\eta_0^{\\text{small}} + \\eta_0^{\\text{large}}$ where $\\|\\eta_0^{\\text{small}}\\|_{L^\\infty}$ is small but $\\|\\eta_0^{\\text{small}}\\|_{L^1} = m$, and $\\|\\eta_0^{\\text{large}}\\|_{L^1}$ is small. Then:\n1437: \n1438: $$\n1439: \\|\\eta_t\\|_{L^\\infty} \\leq \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{small}}\\|_{L^\\infty} + \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{large}}\\|_{L^\\infty}\n1440: \n1441: $$\n1442: \n1443: The first term is bounded by the ultracontractivity estimate: $C_U m / t^{d/2}$. The second term decays exponentially by the spectral gap: $M e^{-\\alpha t}$.\n1444: \n1445: Combining these:\n1446: \n1447: $$\n1448: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n1449: \n1450: $$\n1451: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}