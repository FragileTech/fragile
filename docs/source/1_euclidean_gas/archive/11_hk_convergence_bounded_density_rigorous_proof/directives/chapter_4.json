{
  "chapter_index": 4,
  "section_id": "## 4. Stochastic Mass Conservation and High-Probability Bounds",
  "directive_count": 3,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-exponential-survival",
      "title": "Exponential Survival Time (QSD Theory)",
      "start_line": 622,
      "end_line": 669,
      "header_lines": [
        623
      ],
      "content_start": 625,
      "content_end": 668,
      "content": "625: :label: thm-exponential-survival\n626: \n627: **References**:\n628: - Champagnat & Villemonais (2016, *Ann. Appl. Probab.* 26:3547-3569)\n629: - `06_convergence.md` Theorem 4.5 (lines 906-947)\n630: \n631: For the Euclidean Gas initialized from the quasi-stationary distribution $\\pi_{\\text{QSD}}$, the absorption time $\\tau_\\dagger$ (first time when all walkers are dead) satisfies:\n632: \n633: $$\n634: \\mathbb{E}_{\\pi_{\\text{QSD}}}[\\tau_\\dagger] = e^{\\Theta(N)}\n635: \n636: $$\n637: \n638: Moreover, for any finite time horizon $T > 0$ independent of $N$:\n639: \n640: $$\n641: \\mathbb{P}_{\\pi_{\\text{QSD}}}(\\tau_\\dagger > T) \\geq 1 - T e^{-\\Theta(N)}\n642: \n643: $$\n644: \n645: **Interpretation**: The probability of survival up to time $T$ approaches 1 exponentially fast in $N$. Total extinction is exponentially rare for large swarms.\n646: \n647: **Proof Sketch**: The key mechanism is the **revival operator**. From `07_mean_field.md`, dead walkers are revived by cloning from the alive population. The revival rate is proportional to the alive mass:\n648: \n649: $$\n650: \\frac{dm_a}{dt} \\geq -C_{\\text{death}} m_a + C_{\\text{revival}} m_d = -C_{\\text{death}} m_a + C_{\\text{revival}}(1 - m_a)\n651: \n652: $$\n653: \n654: where $C_{\\text{death}}, C_{\\text{revival}} > 0$ are the death and revival rates.\n655: \n656: At equilibrium ($dm_a/dt = 0$):\n657: \n658: $$\n659: m_a^* = \\frac{C_{\\text{revival}}}{C_{\\text{death}} + C_{\\text{revival}}} > 0\n660: \n661: $$\n662: \n663: The variance $\\text{Var}(k_t)$ scales as $O(N)$ (standard fluctuation scaling), so:\n664: \n665: $$\n666: \\mathbb{P}(k_t = 0) \\approx \\mathbb{P}\\left( |k_t - k_*| > k_* \\right) \\leq \\frac{\\text{Var}(k_t)}{k_*^2} = O(N / N^2) = O(1/N)\n667: \n668: $$",
      "metadata": {
        "label": "thm-exponential-survival"
      },
      "section": "## 4. Stochastic Mass Conservation and High-Probability Bounds",
      "raw_directive": "622: We leverage the theory of quasi-stationary distributions for absorbed Markov processes:\n623: \n624: :::{prf:theorem} Exponential Survival Time (QSD Theory)\n625: :label: thm-exponential-survival\n626: \n627: **References**:\n628: - Champagnat & Villemonais (2016, *Ann. Appl. Probab.* 26:3547-3569)\n629: - `06_convergence.md` Theorem 4.5 (lines 906-947)\n630: \n631: For the Euclidean Gas initialized from the quasi-stationary distribution $\\pi_{\\text{QSD}}$, the absorption time $\\tau_\\dagger$ (first time when all walkers are dead) satisfies:\n632: \n633: $$\n634: \\mathbb{E}_{\\pi_{\\text{QSD}}}[\\tau_\\dagger] = e^{\\Theta(N)}\n635: \n636: $$\n637: \n638: Moreover, for any finite time horizon $T > 0$ independent of $N$:\n639: \n640: $$\n641: \\mathbb{P}_{\\pi_{\\text{QSD}}}(\\tau_\\dagger > T) \\geq 1 - T e^{-\\Theta(N)}\n642: \n643: $$\n644: \n645: **Interpretation**: The probability of survival up to time $T$ approaches 1 exponentially fast in $N$. Total extinction is exponentially rare for large swarms.\n646: \n647: **Proof Sketch**: The key mechanism is the **revival operator**. From `07_mean_field.md`, dead walkers are revived by cloning from the alive population. The revival rate is proportional to the alive mass:\n648: \n649: $$\n650: \\frac{dm_a}{dt} \\geq -C_{\\text{death}} m_a + C_{\\text{revival}} m_d = -C_{\\text{death}} m_a + C_{\\text{revival}}(1 - m_a)\n651: \n652: $$\n653: \n654: where $C_{\\text{death}}, C_{\\text{revival}} > 0$ are the death and revival rates.\n655: \n656: At equilibrium ($dm_a/dt = 0$):\n657: \n658: $$\n659: m_a^* = \\frac{C_{\\text{revival}}}{C_{\\text{death}} + C_{\\text{revival}}} > 0\n660: \n661: $$\n662: \n663: The variance $\\text{Var}(k_t)$ scales as $O(N)$ (standard fluctuation scaling), so:\n664: \n665: $$\n666: \\mathbb{P}(k_t = 0) \\approx \\mathbb{P}\\left( |k_t - k_*| > k_* \\right) \\leq \\frac{\\text{Var}(k_t)}{k_*^2} = O(N / N^2) = O(1/N)\n667: \n668: $$\n669: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-mass-lower-bound-high-prob",
      "title": "High-Probability Alive Mass Lower Bound",
      "start_line": 673,
      "end_line": 792,
      "header_lines": [
        674
      ],
      "content_start": 676,
      "content_end": 791,
      "content": "676: :label: lem-mass-lower-bound-high-prob\n677: \n678: For the Euclidean Gas with $N$ walkers there exist constants $c_{\\text{mass}}, C, \\delta > 0$, depending only on $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ and the initial mass $m_0$, such that for every $t \\geq 0$\n679: \n680: $$\n681: \\mathbb{P}\\!\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - C (1+t) e^{-\\delta N}.\n682: $$\n683: \n684: **Proof (full-process spectral gap + logistic ODE)**:\n685: \n686: We split the argument into an **early-time deterministic floor** and a **late-time concentration regime**. Throughout we denote $k_t = k_t(\\omega)$ the number of alive walkers and $m_a(t) = \\|\\rho_t\\|_{L^1}$ the PDE mass.\n687: \n688: **Step 0: Deterministic floor on $[0, t_{\\text{eq}}]$ via logistic ODE**  \n689: The mass equation derived in `07_mean_field.md` reads\n690: \n691: $$\n692: \\frac{d}{dt} m_a(t) = -\\int_\\Omega c(z) \\rho_t(z) dz + \\lambda_{\\text{rev}} \\big( 1 - m_a(t) \\big).\n693: $$\n694: \n695: Using $\\int c(z) \\rho_t(z) dz \\leq c_{\\max} m_a(t)$, we obtain the comparison inequality\n696: \n697: $$\n698: \\frac{d}{dt} m_a(t) \\geq - (c_{\\max} + \\lambda_{\\text{rev}}) m_a(t) + \\lambda_{\\text{rev}}.\n699: $$\n700: \n701: Solving gives the explicit lower envelope\n702: \n703: $$\n704: m_{\\text{floor}}(t)\n705: = m_\\infty - \\big(m_\\infty - m_0\\big) e^{-(c_{\\max} + \\lambda_{\\text{rev}}) t},\n706: \\qquad\n707: m_\\infty = \\frac{\\lambda_{\\text{rev}}}{c_{\\max} + \\lambda_{\\text{rev}}} > 0.\n708: $$\n709: \n710: Hence $m_a(t) \\geq m_{\\text{floor}}(t)$ for all $t \\geq 0$. Choosing the equilibration time $t_{\\text{eq}} = O(\\kappa_{\\text{QSD}}^{-1} \\log N)$, we set\n711: \n712: $$\n713: c_{\\text{early}} := \\frac{1}{2} \\min_{0 \\leq s \\leq t_{\\text{eq}}} m_{\\text{floor}}(s) > 0.\n714: $$\n715: \n716: The propagation-of-chaos estimate proved in Section 4.5 (Proposition {prf:ref}`prop-poc-mass`) states that, for any $\\epsilon > 0$,\n717: \n718: $$\n719: \\mathbb{P}\\left( \\sup_{0 \\leq s \\leq t_{\\text{eq}}} \\left| \\frac{k_s}{N} - m_a(s) \\right| > \\epsilon \\right) \\leq C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N \\epsilon^2}.\n720: $$\n721: \n722: Taking $\\epsilon = c_{\\text{early}}$ yields the early-time event\n723: \n724: $$\n725: \\mathbb{P}\\left( \\inf_{0 \\leq s \\leq t_{\\text{eq}}} \\frac{k_s}{N} \\geq c_{\\text{early}} \\right) \\geq 1 - C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N c_{\\text{early}}^2}.\n726: $$\n727: \n728: This establishes the desired floor on $[0, t_{\\text{eq}}]$.\n729: \n730: **Step 1: Spectral gap for configuration observables (removing the Markov assumption on $k_t$)**  \n731: The $N$-particle process $Z_t = (z_t^{(1)}, \\ldots, z_t^{(N)})$ is geometrically ergodic with spectral gap $\\kappa_{\\text{full}} > 0$ in $L^2(\\Pi_{\\text{QSD}}^{(N)})$ (Theorem 4.5 of `06_convergence.md`). For any observable $F : \\Omega^N \\to \\mathbb{R}$,\n732: \n733: $$\n734: \\text{Var}_{\\Pi_{\\text{QSD}}^{(N)}}(F) \\leq \\frac{1}{\\kappa_{\\text{full}}} \\langle -\\mathcal{L}^{(N)} F, F \\rangle.\n735: $$\n736: \n737: We apply this to $F(Z) = k(Z)/N = N^{-1} \\sum_{i=1}^N \\mathbf{1}_{\\{\\text{walker } i \\text{ alive}\\}}$. Changing a single coordinate alters $F$ by at most $1/N$, so $F$ is $1/N$-Lipschitz with respect to the Hamming metric. By the Herbst argument for Markov semigroups with spectral gap (see, e.g., Joulin & Ollivier 2010, Theorem 5.1), $F$ satisfies\n738: \n739: $$\n740: \\Pi_{\\text{QSD}}^{(N)}\\!\\left( \\left| \\frac{k}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n741: \\leq 2 \\exp\\!\\left( - \\frac{\\kappa_{\\text{full}} N^2 r^2}{2} \\right)\n742: \\leq 2 \\exp\\!\\left( - \\beta_{\\text{gap}} N r^2 \\right),\n743: $$\n744: \n745: where we set $\\beta_{\\text{gap}} := \\kappa_{\\text{full}} / 2$ (the second inequality uses $N^2 \\geq N$ so the exponent now scales linearly in $N$).\n746: \n747: This argument works directly on the full configuration process $Z_t$; no Markov property for the projected count $k_t$ is required, thereby correcting the earlier (invalid) reduction to a standalone birth-death chain.\n748: \n749: **Step 2: Finite-time concentration after equilibration**  \n750: Let $\\mathcal{L}_t$ be the law of $Z_t$ starting from any initial configuration with alive mass at least $c_{\\text{early}}$. By Theorem 4.5 of `06_convergence.md`,\n751: \n752: $$\n753: \\|\\mathcal{L}_t - \\Pi_{\\text{QSD}}^{(N)}\\|_{\\text{TV}}\n754: \\leq C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})} \\quad \\text{for } t \\geq t_{\\text{eq}}.\n755: $$\n756: \n757: Therefore, for $t \\geq t_{\\text{eq}}$ and any $r > 0$,\n758: \n759: $$\n760: \\mathbb{P}\\left( \\left| \\frac{k_t}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n761: \\leq 2 e^{-\\beta_{\\text{gap}} N r^2} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n762: $$\n763: \n764: Selecting $r = m_{\\text{eq}}/2$ yields\n765: \n766: $$\n767: \\mathbb{P}\\left( \\frac{k_t}{N} \\leq \\frac{m_{\\text{eq}}}{2} \\right)\n768: \\leq 2 e^{-\\beta_{\\text{gap}} N m_{\\text{eq}}^2 / 4} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n769: $$\n770: \n771: **Step 3: Survival conditioning**  \n772: The survival estimate of Theorem {prf:ref}`thm-exponential-survival` gives\n773: \n774: $$\n775: \\mathbb{P}(\\tau_\\dagger \\leq t) \\leq t e^{-C_{\\text{surv}} N}.\n776: $$\n777: \n778: Intersecting the complementary survival event with the concentration events from Steps 0-2 shows that, for all $t \\geq 0$,\n779: \n780: $$\n781: \\mathbb{P}\\left( \\frac{k_t}{N} \\geq \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right) \\right)\n782: \\geq 1 - C (1+t) e^{-\\delta N},\n783: $$\n784: \n785: with $\\delta = \\min(\\beta_{\\text{pc}} c_{\\text{early}}^2, \\beta_{\\text{gap}} m_{\\text{eq}}^2/4, C_{\\text{surv}})$.\n786: \n787: Setting\n788: \n789: $$\n790: c_{\\text{mass}} := \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right)\n791: $$",
      "metadata": {
        "label": "lem-mass-lower-bound-high-prob"
      },
      "section": "## 4. Stochastic Mass Conservation and High-Probability Bounds",
      "raw_directive": "673: ### 4.3. High-Probability Mass Lower Bound\n674: \n675: :::{prf:lemma} High-Probability Alive Mass Lower Bound\n676: :label: lem-mass-lower-bound-high-prob\n677: \n678: For the Euclidean Gas with $N$ walkers there exist constants $c_{\\text{mass}}, C, \\delta > 0$, depending only on $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ and the initial mass $m_0$, such that for every $t \\geq 0$\n679: \n680: $$\n681: \\mathbb{P}\\!\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - C (1+t) e^{-\\delta N}.\n682: $$\n683: \n684: **Proof (full-process spectral gap + logistic ODE)**:\n685: \n686: We split the argument into an **early-time deterministic floor** and a **late-time concentration regime**. Throughout we denote $k_t = k_t(\\omega)$ the number of alive walkers and $m_a(t) = \\|\\rho_t\\|_{L^1}$ the PDE mass.\n687: \n688: **Step 0: Deterministic floor on $[0, t_{\\text{eq}}]$ via logistic ODE**  \n689: The mass equation derived in `07_mean_field.md` reads\n690: \n691: $$\n692: \\frac{d}{dt} m_a(t) = -\\int_\\Omega c(z) \\rho_t(z) dz + \\lambda_{\\text{rev}} \\big( 1 - m_a(t) \\big).\n693: $$\n694: \n695: Using $\\int c(z) \\rho_t(z) dz \\leq c_{\\max} m_a(t)$, we obtain the comparison inequality\n696: \n697: $$\n698: \\frac{d}{dt} m_a(t) \\geq - (c_{\\max} + \\lambda_{\\text{rev}}) m_a(t) + \\lambda_{\\text{rev}}.\n699: $$\n700: \n701: Solving gives the explicit lower envelope\n702: \n703: $$\n704: m_{\\text{floor}}(t)\n705: = m_\\infty - \\big(m_\\infty - m_0\\big) e^{-(c_{\\max} + \\lambda_{\\text{rev}}) t},\n706: \\qquad\n707: m_\\infty = \\frac{\\lambda_{\\text{rev}}}{c_{\\max} + \\lambda_{\\text{rev}}} > 0.\n708: $$\n709: \n710: Hence $m_a(t) \\geq m_{\\text{floor}}(t)$ for all $t \\geq 0$. Choosing the equilibration time $t_{\\text{eq}} = O(\\kappa_{\\text{QSD}}^{-1} \\log N)$, we set\n711: \n712: $$\n713: c_{\\text{early}} := \\frac{1}{2} \\min_{0 \\leq s \\leq t_{\\text{eq}}} m_{\\text{floor}}(s) > 0.\n714: $$\n715: \n716: The propagation-of-chaos estimate proved in Section 4.5 (Proposition {prf:ref}`prop-poc-mass`) states that, for any $\\epsilon > 0$,\n717: \n718: $$\n719: \\mathbb{P}\\left( \\sup_{0 \\leq s \\leq t_{\\text{eq}}} \\left| \\frac{k_s}{N} - m_a(s) \\right| > \\epsilon \\right) \\leq C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N \\epsilon^2}.\n720: $$\n721: \n722: Taking $\\epsilon = c_{\\text{early}}$ yields the early-time event\n723: \n724: $$\n725: \\mathbb{P}\\left( \\inf_{0 \\leq s \\leq t_{\\text{eq}}} \\frac{k_s}{N} \\geq c_{\\text{early}} \\right) \\geq 1 - C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N c_{\\text{early}}^2}.\n726: $$\n727: \n728: This establishes the desired floor on $[0, t_{\\text{eq}}]$.\n729: \n730: **Step 1: Spectral gap for configuration observables (removing the Markov assumption on $k_t$)**  \n731: The $N$-particle process $Z_t = (z_t^{(1)}, \\ldots, z_t^{(N)})$ is geometrically ergodic with spectral gap $\\kappa_{\\text{full}} > 0$ in $L^2(\\Pi_{\\text{QSD}}^{(N)})$ (Theorem 4.5 of `06_convergence.md`). For any observable $F : \\Omega^N \\to \\mathbb{R}$,\n732: \n733: $$\n734: \\text{Var}_{\\Pi_{\\text{QSD}}^{(N)}}(F) \\leq \\frac{1}{\\kappa_{\\text{full}}} \\langle -\\mathcal{L}^{(N)} F, F \\rangle.\n735: $$\n736: \n737: We apply this to $F(Z) = k(Z)/N = N^{-1} \\sum_{i=1}^N \\mathbf{1}_{\\{\\text{walker } i \\text{ alive}\\}}$. Changing a single coordinate alters $F$ by at most $1/N$, so $F$ is $1/N$-Lipschitz with respect to the Hamming metric. By the Herbst argument for Markov semigroups with spectral gap (see, e.g., Joulin & Ollivier 2010, Theorem 5.1), $F$ satisfies\n738: \n739: $$\n740: \\Pi_{\\text{QSD}}^{(N)}\\!\\left( \\left| \\frac{k}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n741: \\leq 2 \\exp\\!\\left( - \\frac{\\kappa_{\\text{full}} N^2 r^2}{2} \\right)\n742: \\leq 2 \\exp\\!\\left( - \\beta_{\\text{gap}} N r^2 \\right),\n743: $$\n744: \n745: where we set $\\beta_{\\text{gap}} := \\kappa_{\\text{full}} / 2$ (the second inequality uses $N^2 \\geq N$ so the exponent now scales linearly in $N$).\n746: \n747: This argument works directly on the full configuration process $Z_t$; no Markov property for the projected count $k_t$ is required, thereby correcting the earlier (invalid) reduction to a standalone birth-death chain.\n748: \n749: **Step 2: Finite-time concentration after equilibration**  \n750: Let $\\mathcal{L}_t$ be the law of $Z_t$ starting from any initial configuration with alive mass at least $c_{\\text{early}}$. By Theorem 4.5 of `06_convergence.md`,\n751: \n752: $$\n753: \\|\\mathcal{L}_t - \\Pi_{\\text{QSD}}^{(N)}\\|_{\\text{TV}}\n754: \\leq C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})} \\quad \\text{for } t \\geq t_{\\text{eq}}.\n755: $$\n756: \n757: Therefore, for $t \\geq t_{\\text{eq}}$ and any $r > 0$,\n758: \n759: $$\n760: \\mathbb{P}\\left( \\left| \\frac{k_t}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n761: \\leq 2 e^{-\\beta_{\\text{gap}} N r^2} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n762: $$\n763: \n764: Selecting $r = m_{\\text{eq}}/2$ yields\n765: \n766: $$\n767: \\mathbb{P}\\left( \\frac{k_t}{N} \\leq \\frac{m_{\\text{eq}}}{2} \\right)\n768: \\leq 2 e^{-\\beta_{\\text{gap}} N m_{\\text{eq}}^2 / 4} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n769: $$\n770: \n771: **Step 3: Survival conditioning**  \n772: The survival estimate of Theorem {prf:ref}`thm-exponential-survival` gives\n773: \n774: $$\n775: \\mathbb{P}(\\tau_\\dagger \\leq t) \\leq t e^{-C_{\\text{surv}} N}.\n776: $$\n777: \n778: Intersecting the complementary survival event with the concentration events from Steps 0-2 shows that, for all $t \\geq 0$,\n779: \n780: $$\n781: \\mathbb{P}\\left( \\frac{k_t}{N} \\geq \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right) \\right)\n782: \\geq 1 - C (1+t) e^{-\\delta N},\n783: $$\n784: \n785: with $\\delta = \\min(\\beta_{\\text{pc}} c_{\\text{early}}^2, \\beta_{\\text{gap}} m_{\\text{eq}}^2/4, C_{\\text{surv}})$.\n786: \n787: Setting\n788: \n789: $$\n790: c_{\\text{mass}} := \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right)\n791: $$\n792: "
    },
    {
      "directive_type": "corollary",
      "label": "cor-conditional-mass-lower-bound",
      "title": "Conditional Mass Lower Bound (Uniform in Time)",
      "start_line": 815,
      "end_line": 826,
      "header_lines": [
        816
      ],
      "content_start": 818,
      "content_end": 825,
      "content": "818: :label: cor-conditional-mass-lower-bound\n819: \n820: On the survival event $\\{\\tau_\\dagger = \\infty\\}$, for all $t \\geq t_{\\text{eq}}$:\n821: \n822: $$\n823: \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} > 0\n824: \n825: $$",
      "metadata": {
        "label": "cor-conditional-mass-lower-bound"
      },
      "section": "## 4. Stochastic Mass Conservation and High-Probability Bounds",
      "raw_directive": "815: On the survival event $\\{\\tau_\\dagger = \\infty\\}$ (the system never dies), the mass lower bound holds **deterministically** for all time:\n816: \n817: :::{prf:corollary} Conditional Mass Lower Bound (Uniform in Time)\n818: :label: cor-conditional-mass-lower-bound\n819: \n820: On the survival event $\\{\\tau_\\dagger = \\infty\\}$, for all $t \\geq t_{\\text{eq}}$:\n821: \n822: $$\n823: \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} > 0\n824: \n825: $$\n826: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}