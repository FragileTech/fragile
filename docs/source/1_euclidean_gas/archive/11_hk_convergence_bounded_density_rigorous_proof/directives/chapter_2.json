{
  "chapter_index": 2,
  "section_id": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities",
  "directive_count": 3,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-hormander-bracket",
      "title": "H\u00f6rmander's Bracket Condition",
      "start_line": 96,
      "end_line": 124,
      "header_lines": [
        97
      ],
      "content_start": 99,
      "content_end": 123,
      "content": "99: :label: lem-hormander-bracket\n100: \n101: **Reference**: `06_convergence.md` Section 4.4.1, lines 892-950\n102: \n103: The kinetic generator $\\mathcal{L}_{\\text{kin}}$ has the form:\n104: \n105: $$\n106: \\mathcal{L}_{\\text{kin}} = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v + \\frac{\\sigma_v^2}{2} \\Delta_v\n107: \n108: $$\n109: \n110: where $A(x, v) = \\frac{1}{m}F(x) - \\gamma(v - u(x))$ is the velocity drift.\n111: \n112: The vector fields:\n113: - $X_0 = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v$ (drift)\n114: - $X_j = \\sigma_v \\partial_{v_j}$ (diffusion, $j = 1, \\ldots, d$)\n115: \n116: satisfy H\u00f6rmander's bracket condition:\n117: \n118: $$\n119: \\text{Lie}\\{X_0, X_1, \\ldots, X_d, [X_0, X_1], \\ldots, [X_0, X_d]\\} = T_{(x,v)}\\Omega\n120: \n121: $$\n122: \n123: at every point $(x, v) \\in \\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$.",
      "metadata": {
        "label": "lem-hormander-bracket"
      },
      "section": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities",
      "raw_directive": "96: ### 2.2. Hypoelliptic Structure of the Kinetic Operator\n97: \n98: :::{prf:lemma} H\u00f6rmander's Bracket Condition\n99: :label: lem-hormander-bracket\n100: \n101: **Reference**: `06_convergence.md` Section 4.4.1, lines 892-950\n102: \n103: The kinetic generator $\\mathcal{L}_{\\text{kin}}$ has the form:\n104: \n105: $$\n106: \\mathcal{L}_{\\text{kin}} = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v + \\frac{\\sigma_v^2}{2} \\Delta_v\n107: \n108: $$\n109: \n110: where $A(x, v) = \\frac{1}{m}F(x) - \\gamma(v - u(x))$ is the velocity drift.\n111: \n112: The vector fields:\n113: - $X_0 = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v$ (drift)\n114: - $X_j = \\sigma_v \\partial_{v_j}$ (diffusion, $j = 1, \\ldots, d$)\n115: \n116: satisfy H\u00f6rmander's bracket condition:\n117: \n118: $$\n119: \\text{Lie}\\{X_0, X_1, \\ldots, X_d, [X_0, X_1], \\ldots, [X_0, X_d]\\} = T_{(x,v)}\\Omega\n120: \n121: $$\n122: \n123: at every point $(x, v) \\in \\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$.\n124: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-parabolic-harnack",
      "title": "Parabolic Harnack Inequality for Kinetic Operators",
      "start_line": 132,
      "end_line": 169,
      "header_lines": [
        133
      ],
      "content_start": 135,
      "content_end": 168,
      "content": "135: :label: thm-parabolic-harnack\n136: \n137: **References**:\n138: - Kusuoka & Stroock (1985, *J. Fac. Sci. Univ. Tokyo Sect. IA Math.* 32:1-76)\n139: - H\u00e9rau & Nier (2004, *Comm. Math. Phys.* 253:741-754)\n140: \n141: Let $u(t, z)$ be a non-negative solution to the kinetic Fokker-Planck equation:\n142: \n143: $$\n144: \\frac{\\partial u}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* u + h(t, z)\n145: \n146: $$\n147: \n148: on a cylinder $Q_R = [t_0, t_0 + R^2] \\times B_R(z_0) \\subset [0, \\infty) \\times \\Omega$, where $h$ is a bounded source term with $\\|h\\|_\\infty \\leq C_h$.\n149: \n150: Then there exist constants $C_H$ and $\\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\|F\\|_{\\text{Lip}}, d$) such that:\n151: \n152: $$\n153: \\sup_{Q_{R/2}^-} u \\leq C_H \\left( \\inf_{Q_{R/2}^+} u + R^2 C_h \\right)\n154: \n155: $$\n156: \n157: where:\n158: - $Q_{R/2}^- = [t_0, t_0 + R^2/4] \\times B_{R/2}(z_0)$ (early time, smaller ball)\n159: - $Q_{R/2}^+ = [t_0 + 3R^2/4, t_0 + R^2] \\times B_{R/2}(z_0)$ (late time, smaller ball)\n160: \n161: **Interpretation**: The supremum over early times is controlled by the infimum over late times, shifted by a time lag. This is the hypoelliptic \"smoothing\" property.\n162: \n163: **Proof Sketch**: The proof uses sub-Riemannian geometry and the Carnot-Carath\u00e9odory distance $d_{\\text{cc}}$ induced by the H\u00f6rmander vector fields. The key steps are:\n164: \n165: 1. Construct a Lyapunov function adapted to the hypoelliptic structure\n166: 2. Apply maximum principle arguments in time-space cylinders\n167: 3. Use the bracket condition to propagate information from velocity to position variables\n168: 4. Iterate the estimates to obtain the final bound",
      "metadata": {
        "label": "thm-parabolic-harnack"
      },
      "section": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities",
      "raw_directive": "132: The key technical tool for establishing $L^\\infty$ bounds is the **parabolic Harnack inequality** for hypoelliptic operators. This inequality provides quantitative control of the supremum of a solution in terms of its infimum over a shifted time-space cylinder.\n133: \n134: :::{prf:theorem} Parabolic Harnack Inequality for Kinetic Operators\n135: :label: thm-parabolic-harnack\n136: \n137: **References**:\n138: - Kusuoka & Stroock (1985, *J. Fac. Sci. Univ. Tokyo Sect. IA Math.* 32:1-76)\n139: - H\u00e9rau & Nier (2004, *Comm. Math. Phys.* 253:741-754)\n140: \n141: Let $u(t, z)$ be a non-negative solution to the kinetic Fokker-Planck equation:\n142: \n143: $$\n144: \\frac{\\partial u}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* u + h(t, z)\n145: \n146: $$\n147: \n148: on a cylinder $Q_R = [t_0, t_0 + R^2] \\times B_R(z_0) \\subset [0, \\infty) \\times \\Omega$, where $h$ is a bounded source term with $\\|h\\|_\\infty \\leq C_h$.\n149: \n150: Then there exist constants $C_H$ and $\\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\|F\\|_{\\text{Lip}}, d$) such that:\n151: \n152: $$\n153: \\sup_{Q_{R/2}^-} u \\leq C_H \\left( \\inf_{Q_{R/2}^+} u + R^2 C_h \\right)\n154: \n155: $$\n156: \n157: where:\n158: - $Q_{R/2}^- = [t_0, t_0 + R^2/4] \\times B_{R/2}(z_0)$ (early time, smaller ball)\n159: - $Q_{R/2}^+ = [t_0 + 3R^2/4, t_0 + R^2] \\times B_{R/2}(z_0)$ (late time, smaller ball)\n160: \n161: **Interpretation**: The supremum over early times is controlled by the infimum over late times, shifted by a time lag. This is the hypoelliptic \"smoothing\" property.\n162: \n163: **Proof Sketch**: The proof uses sub-Riemannian geometry and the Carnot-Carath\u00e9odory distance $d_{\\text{cc}}$ induced by the H\u00f6rmander vector fields. The key steps are:\n164: \n165: 1. Construct a Lyapunov function adapted to the hypoelliptic structure\n166: 2. Apply maximum principle arguments in time-space cylinders\n167: 3. Use the bracket condition to propagate information from velocity to position variables\n168: 4. Iterate the estimates to obtain the final bound\n169: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-linfty-full-operator",
      "title": "$L^\\infty$ Bound for the Full Operator",
      "start_line": 175,
      "end_line": 387,
      "header_lines": [
        176
      ],
      "content_start": 178,
      "content_end": 386,
      "content": "178: :label: lem-linfty-full-operator\n179: \n180: Consider the full McKean-Vlasov-Fokker-Planck equation from \u00a72.1:\n181: \n182: $$\n183: \\frac{\\partial f}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* f + \\mathcal{L}_{\\text{clone}}^* f - c(z) f + B[f, m_d]\n184: \n185: $$\n186: \n187: with initial condition $\\|f_0\\|_\\infty \\leq M_0 < \\infty$. Assume a uniform-in-time lower bound on the alive mass, $m_a(t) = \\|f(t, \\cdot)\\|_{L^1} \\geq c_{\\text{mass}} > 0$ for all $t \\geq 0$ (to be proven in Section 4).\n188: \n189: Then for any finite time $T > 0$:\n190: \n191: $$\n192: \\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R) < \\infty\n193: \n194: $$\n195: \n196: **Proof**:\n197: \n198: We decompose the evolution into four components and bound each separately using the parabolic Harnack inequality.\n199: \n200: **Step 1: Kinetic Evolution Alone**\n201: \n202: Consider first the pure kinetic evolution $\\partial_t f = \\mathcal{L}_{\\text{kin}}^* f$ with reflecting boundary conditions. By the parabolic Harnack inequality (Theorem {prf:ref}`thm-parabolic-harnack`), for any cylinder $Q_R$:\n203: \n204: $$\n205: \\sup_{Q_{R/2}^-} f \\leq C_H \\inf_{Q_{R/2}^+} f\n206: \n207: $$\n208: \n209: For the initial value problem with $\\|f_0\\|_\\infty \\leq M_0$, we apply this iteratively over time slices to obtain:\n210: \n211: $$\n212: \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(t, \\gamma, \\sigma_v, R, d) M_0\n213: \n214: $$\n215: \n216: where $C_{\\text{kin}}(t, \\cdot)$ is the hypoelliptic smoothing constant. For $t \\geq t_{\\text{mix}}$ (mixing time), this becomes a constant independent of $t$.\n217: \n218: **Key Quantitative Bound**: Using the explicit Gaussian heat kernel estimates from H\u00e9rau & Nier (2004, Lemma 2.1), for $t \\geq \\tau$ (one timestep):\n219: \n220: $$\n221: C_{\\text{kin}}(t, \\cdot) \\leq C_0 \\left( \\frac{R^2}{\\sigma_v^2 \\gamma t} \\right)^{d/2} + C_1\n222: \n223: $$\n224: \n225: where $C_0, C_1$ depend only on the bracket depth and dimension.\n226: \n227: **Step 2: Cloning Operator **\n228: \n229: The cloning operator with Gaussian position jitter has the form (from `03_cloning.md` line 6022):\n230: \n231: $$\n232: \\mathcal{L}_{\\text{clone}}^* f = \\int_\\Omega K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n233: \n234: $$\n235: \n236: where:\n237: - $K_{\\text{clone}}(z, z') = \\frac{1}{(2\\pi\\sigma_x^2)^{d/2}} \\exp(-\\|x - x'\\|^2 / (2\\sigma_x^2)) \\times \\delta(v - v')$ is the Gaussian kernel\n238: - $V[f](z, z')$ is the **fitness weighting functional** (depends nonlinearly on $f$ via virtual reward)\n239: \n240: **Critical Observation**: The cloning operator is **NOT** a simple convolution due to the fitness weighting $V[f]$. The operator has a nonlinear source-sink structure:\n241: \n242: $$\n243: \\mathcal{L}_{\\text{clone}}^* f(z) = \\underbrace{\\int K_{\\text{clone}}(z, z') V[f](z, z') f(z') dz'}_{\\text{source}} - \\underbrace{f(z) \\int K_{\\text{clone}}(z, z') V[f](z, z') dz'}_{\\text{sink}}\n244: \n245: $$\n246: \n247: **Revised $L^\\infty$ Bound**: The fitness functional satisfies (from `03_cloning.md`):\n248: \n249: $$\n250: 0 \\leq V[f](z, z') \\leq V_{\\max} := \\max\\left(1, \\frac{1}{\\eta}\\right)\n251: \n252: $$\n253: \n254: where $\\eta \\in (0, 1)$ is the rescaling parameter. Therefore:\n255: \n256: $$\n257: |\\mathcal{L}_{\\text{clone}}^* f(z)| \\leq V_{\\max} \\left[\\int K_{\\text{clone}}(z, z') f(z') dz' + f(z) \\int K_{\\text{clone}}(z, z') dz'\\right]\n258: \n259: $$\n260: \n261: Since $\\int K_{\\text{clone}}(z, z') dz' = 1$ (normalized kernel) and the convolution $\\int K f' dx' \\leq \\|f\\|_\\infty$:\n262: \n263: $$\n264: \\|\\mathcal{L}_{\\text{clone}}^* f\\|_\\infty \\leq 2 V_{\\max} \\|f\\|_\\infty\n265: \n266: $$\n267: \n268: Over a timestep $\\tau$, using forward Euler for the source term:\n269: \n270: $$\n271: \\|f_{\\text{post-clone}}\\|_\\infty \\leq (1 + 2 V_{\\max} \\tau) \\|f_{\\text{pre-clone}}\\|_\\infty\n272: \n273: $$\n274: \n275: **Impact**: This increases the hypoelliptic constant $C_{\\text{hypo}}$ by a factor $(1 + 2V_{\\max}\\tau)^{T/\\tau}$, but remains finite for finite time $T$.\n276: \n277: **Step 3: Killing Term**\n278: \n279: The killing term $-c(z) f$ with $c(z) \\geq 0$ only removes mass:\n280: \n281: $$\n282: \\|f_{\\text{post-kill}}\\|_\\infty \\leq \\|f_{\\text{pre-kill}}\\|_\\infty\n283: \n284: $$\n285: \n286: **Step 4: Revival Term (Mass-Dependent Source)**\n287: \n288: The revival operator re-injects mass into the safe region. From `07_mean_field.md`, the revival source has the form\n289: \n290: $$\n291: r_{\\text{revival}}(z) = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}(z),\n292: $$\n293: \n294: where $m_a(t) = \\int f(t, z) dz$ is the alive mass and $m_d(t)$ is the dead-mass flux. The kernel $f_{\\text{safe}}$ is deterministic, compactly supported, and normalized ($\\int f_{\\text{safe}} = 1$). On the event that Section 4 proves $m_a(t) \\geq c_{\\text{mass}}$, we have\n295: \n296: $$\n297: \\frac{m_d(t)}{m_a(t)} = \\frac{\\int c(z) f(t,z) dz}{m_a(t)} \\leq \\|c\\|_\\infty.\n298: $$\n299: \n300: Therefore\n301: \n302: $$\n303: \\|r_{\\text{revival}}\\|_\\infty \\leq \\lambda_{\\text{rev}} \\|c\\|_\\infty \\|f_{\\text{safe}}\\|_\\infty =: C_{\\text{safe}},\n304: $$\n305: \n306: which is a state-independent constant (no additional factor of $\\|f\\|_\\infty$ appears).\n307: \n308: **Step 5: Volterra Inequality for the Supremum Norm**\n309: \n310: Using the Duhamel formula for the full equation over time interval $[0, T]$:\n311: \n312: $$\n313: f(T, z) = \\int_\\Omega p_T^{\\text{kin}}(z, z') f_0(z') dz' + \\int_0^T \\int_\\Omega p_{T-s}^{\\text{kin}}(z, z') S[f](s, z') dz' ds\n314: \n315: $$\n316: \n317: where $S[f] = \\mathcal{L}_{\\text{clone}}^* f - c f + B[f, m_d]$ is the source term and $p_t^{\\text{kin}}$ is the kinetic heat kernel.\n318: \n319: Taking supremum:\n320: \n321: $$\n322: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\|S[f](s, \\cdot)\\|_\\infty ds\n323: \n324: $$\n325: \n326: Since cloning and killing preserve $L^\\infty$ bounds (Steps 2-3), and revival adds at most $C_{\\text{revival}}$ per unit time (Step 4):\n327: \n328: $$\n329: \\|S[f](s, \\cdot)\\|_\\infty \\leq \\|f(s, \\cdot)\\|_\\infty + C_{\\text{revival}}\n330: \n331: $$\n332: \n333: This gives the integral inequality:\n334: \n335: $$\n336: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\Big[(2V_{\\max} + \\|c\\|_\\infty) \\|f(s, \\cdot)\\|_\\infty + C_{\\text{safe}}\\Big] ds.\n337: $$\n338: \n339: Define $u(t) = \\|f(t, \\cdot)\\|_\\infty$, $B_* := 2V_{\\max} + \\|c\\|_\\infty$, and $\\kappa_{\\text{kin}}(T) := \\int_0^T C_{\\text{kin}}(s) ds < \\infty$ (the kinetic estimate from Step 1 implies integrability). Then\n340: \n341: $$\n342: u(T) \\leq C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) + B_* \\int_0^T C_{\\text{kin}}(T - s) u(s) ds.\n343: $$\n344: \n345: **Step 6: Resolvent Gr\u00f6nwall Argument**\n346: \n347: Let $C_{\\text{kin}}^{\\max}(T) = \\sup_{0 \\leq s \\leq T} C_{\\text{kin}}(s)$ and $\\Psi(T) = \\int_0^T u(s) ds$. The convolution term satisfies\n348: \n349: $$\n350: \\int_0^T C_{\\text{kin}}(T - s) u(s) ds \\leq C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n351: $$\n352: \n353: Hence\n354: \n355: $$\n356: u(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T),\n357: \\qquad\n358: A_T := C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T).\n359: $$\n360: \n361: Differentiating $\\Psi$ yields the Volterra inequality\n362: \n363: $$\n364: \\Psi'(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n365: $$\n366: \n367: Gronwall\u2019s lemma for first-order linear ODEs gives\n368: \n369: $$\n370: \\Psi(T) \\leq \\int_0^T A_s \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) (T-s)\\right) ds.\n371: $$\n372: \n373: Since $A_s \\leq C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) =: A_*$ for $s \\in [0, T]$, we obtain\n374: \n375: $$\n376: u(T) \\leq A_* \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n377: $$\n378: \n379: Therefore the hypoelliptic $L^\\infty$ bound holds with the explicit constant\n380: \n381: $$\n382: C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R)\n383: := \\Big[C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T)\\Big]\n384: \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n385: $$\n386: ",
      "metadata": {
        "label": "lem-linfty-full-operator"
      },
      "section": "## 2. Hypoelliptic Regularity and Parabolic Harnack Inequalities",
      "raw_directive": "175: The full equation includes non-local cloning terms, killing, and revival. We handle these perturbatively:\n176: \n177: :::{prf:lemma} $L^\\infty$ Bound for the Full Operator\n178: :label: lem-linfty-full-operator\n179: \n180: Consider the full McKean-Vlasov-Fokker-Planck equation from \u00a72.1:\n181: \n182: $$\n183: \\frac{\\partial f}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* f + \\mathcal{L}_{\\text{clone}}^* f - c(z) f + B[f, m_d]\n184: \n185: $$\n186: \n187: with initial condition $\\|f_0\\|_\\infty \\leq M_0 < \\infty$. Assume a uniform-in-time lower bound on the alive mass, $m_a(t) = \\|f(t, \\cdot)\\|_{L^1} \\geq c_{\\text{mass}} > 0$ for all $t \\geq 0$ (to be proven in Section 4).\n188: \n189: Then for any finite time $T > 0$:\n190: \n191: $$\n192: \\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R) < \\infty\n193: \n194: $$\n195: \n196: **Proof**:\n197: \n198: We decompose the evolution into four components and bound each separately using the parabolic Harnack inequality.\n199: \n200: **Step 1: Kinetic Evolution Alone**\n201: \n202: Consider first the pure kinetic evolution $\\partial_t f = \\mathcal{L}_{\\text{kin}}^* f$ with reflecting boundary conditions. By the parabolic Harnack inequality (Theorem {prf:ref}`thm-parabolic-harnack`), for any cylinder $Q_R$:\n203: \n204: $$\n205: \\sup_{Q_{R/2}^-} f \\leq C_H \\inf_{Q_{R/2}^+} f\n206: \n207: $$\n208: \n209: For the initial value problem with $\\|f_0\\|_\\infty \\leq M_0$, we apply this iteratively over time slices to obtain:\n210: \n211: $$\n212: \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(t, \\gamma, \\sigma_v, R, d) M_0\n213: \n214: $$\n215: \n216: where $C_{\\text{kin}}(t, \\cdot)$ is the hypoelliptic smoothing constant. For $t \\geq t_{\\text{mix}}$ (mixing time), this becomes a constant independent of $t$.\n217: \n218: **Key Quantitative Bound**: Using the explicit Gaussian heat kernel estimates from H\u00e9rau & Nier (2004, Lemma 2.1), for $t \\geq \\tau$ (one timestep):\n219: \n220: $$\n221: C_{\\text{kin}}(t, \\cdot) \\leq C_0 \\left( \\frac{R^2}{\\sigma_v^2 \\gamma t} \\right)^{d/2} + C_1\n222: \n223: $$\n224: \n225: where $C_0, C_1$ depend only on the bracket depth and dimension.\n226: \n227: **Step 2: Cloning Operator **\n228: \n229: The cloning operator with Gaussian position jitter has the form (from `03_cloning.md` line 6022):\n230: \n231: $$\n232: \\mathcal{L}_{\\text{clone}}^* f = \\int_\\Omega K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n233: \n234: $$\n235: \n236: where:\n237: - $K_{\\text{clone}}(z, z') = \\frac{1}{(2\\pi\\sigma_x^2)^{d/2}} \\exp(-\\|x - x'\\|^2 / (2\\sigma_x^2)) \\times \\delta(v - v')$ is the Gaussian kernel\n238: - $V[f](z, z')$ is the **fitness weighting functional** (depends nonlinearly on $f$ via virtual reward)\n239: \n240: **Critical Observation**: The cloning operator is **NOT** a simple convolution due to the fitness weighting $V[f]$. The operator has a nonlinear source-sink structure:\n241: \n242: $$\n243: \\mathcal{L}_{\\text{clone}}^* f(z) = \\underbrace{\\int K_{\\text{clone}}(z, z') V[f](z, z') f(z') dz'}_{\\text{source}} - \\underbrace{f(z) \\int K_{\\text{clone}}(z, z') V[f](z, z') dz'}_{\\text{sink}}\n244: \n245: $$\n246: \n247: **Revised $L^\\infty$ Bound**: The fitness functional satisfies (from `03_cloning.md`):\n248: \n249: $$\n250: 0 \\leq V[f](z, z') \\leq V_{\\max} := \\max\\left(1, \\frac{1}{\\eta}\\right)\n251: \n252: $$\n253: \n254: where $\\eta \\in (0, 1)$ is the rescaling parameter. Therefore:\n255: \n256: $$\n257: |\\mathcal{L}_{\\text{clone}}^* f(z)| \\leq V_{\\max} \\left[\\int K_{\\text{clone}}(z, z') f(z') dz' + f(z) \\int K_{\\text{clone}}(z, z') dz'\\right]\n258: \n259: $$\n260: \n261: Since $\\int K_{\\text{clone}}(z, z') dz' = 1$ (normalized kernel) and the convolution $\\int K f' dx' \\leq \\|f\\|_\\infty$:\n262: \n263: $$\n264: \\|\\mathcal{L}_{\\text{clone}}^* f\\|_\\infty \\leq 2 V_{\\max} \\|f\\|_\\infty\n265: \n266: $$\n267: \n268: Over a timestep $\\tau$, using forward Euler for the source term:\n269: \n270: $$\n271: \\|f_{\\text{post-clone}}\\|_\\infty \\leq (1 + 2 V_{\\max} \\tau) \\|f_{\\text{pre-clone}}\\|_\\infty\n272: \n273: $$\n274: \n275: **Impact**: This increases the hypoelliptic constant $C_{\\text{hypo}}$ by a factor $(1 + 2V_{\\max}\\tau)^{T/\\tau}$, but remains finite for finite time $T$.\n276: \n277: **Step 3: Killing Term**\n278: \n279: The killing term $-c(z) f$ with $c(z) \\geq 0$ only removes mass:\n280: \n281: $$\n282: \\|f_{\\text{post-kill}}\\|_\\infty \\leq \\|f_{\\text{pre-kill}}\\|_\\infty\n283: \n284: $$\n285: \n286: **Step 4: Revival Term (Mass-Dependent Source)**\n287: \n288: The revival operator re-injects mass into the safe region. From `07_mean_field.md`, the revival source has the form\n289: \n290: $$\n291: r_{\\text{revival}}(z) = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}(z),\n292: $$\n293: \n294: where $m_a(t) = \\int f(t, z) dz$ is the alive mass and $m_d(t)$ is the dead-mass flux. The kernel $f_{\\text{safe}}$ is deterministic, compactly supported, and normalized ($\\int f_{\\text{safe}} = 1$). On the event that Section 4 proves $m_a(t) \\geq c_{\\text{mass}}$, we have\n295: \n296: $$\n297: \\frac{m_d(t)}{m_a(t)} = \\frac{\\int c(z) f(t,z) dz}{m_a(t)} \\leq \\|c\\|_\\infty.\n298: $$\n299: \n300: Therefore\n301: \n302: $$\n303: \\|r_{\\text{revival}}\\|_\\infty \\leq \\lambda_{\\text{rev}} \\|c\\|_\\infty \\|f_{\\text{safe}}\\|_\\infty =: C_{\\text{safe}},\n304: $$\n305: \n306: which is a state-independent constant (no additional factor of $\\|f\\|_\\infty$ appears).\n307: \n308: **Step 5: Volterra Inequality for the Supremum Norm**\n309: \n310: Using the Duhamel formula for the full equation over time interval $[0, T]$:\n311: \n312: $$\n313: f(T, z) = \\int_\\Omega p_T^{\\text{kin}}(z, z') f_0(z') dz' + \\int_0^T \\int_\\Omega p_{T-s}^{\\text{kin}}(z, z') S[f](s, z') dz' ds\n314: \n315: $$\n316: \n317: where $S[f] = \\mathcal{L}_{\\text{clone}}^* f - c f + B[f, m_d]$ is the source term and $p_t^{\\text{kin}}$ is the kinetic heat kernel.\n318: \n319: Taking supremum:\n320: \n321: $$\n322: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\|S[f](s, \\cdot)\\|_\\infty ds\n323: \n324: $$\n325: \n326: Since cloning and killing preserve $L^\\infty$ bounds (Steps 2-3), and revival adds at most $C_{\\text{revival}}$ per unit time (Step 4):\n327: \n328: $$\n329: \\|S[f](s, \\cdot)\\|_\\infty \\leq \\|f(s, \\cdot)\\|_\\infty + C_{\\text{revival}}\n330: \n331: $$\n332: \n333: This gives the integral inequality:\n334: \n335: $$\n336: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\Big[(2V_{\\max} + \\|c\\|_\\infty) \\|f(s, \\cdot)\\|_\\infty + C_{\\text{safe}}\\Big] ds.\n337: $$\n338: \n339: Define $u(t) = \\|f(t, \\cdot)\\|_\\infty$, $B_* := 2V_{\\max} + \\|c\\|_\\infty$, and $\\kappa_{\\text{kin}}(T) := \\int_0^T C_{\\text{kin}}(s) ds < \\infty$ (the kinetic estimate from Step 1 implies integrability). Then\n340: \n341: $$\n342: u(T) \\leq C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) + B_* \\int_0^T C_{\\text{kin}}(T - s) u(s) ds.\n343: $$\n344: \n345: **Step 6: Resolvent Gr\u00f6nwall Argument**\n346: \n347: Let $C_{\\text{kin}}^{\\max}(T) = \\sup_{0 \\leq s \\leq T} C_{\\text{kin}}(s)$ and $\\Psi(T) = \\int_0^T u(s) ds$. The convolution term satisfies\n348: \n349: $$\n350: \\int_0^T C_{\\text{kin}}(T - s) u(s) ds \\leq C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n351: $$\n352: \n353: Hence\n354: \n355: $$\n356: u(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T),\n357: \\qquad\n358: A_T := C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T).\n359: $$\n360: \n361: Differentiating $\\Psi$ yields the Volterra inequality\n362: \n363: $$\n364: \\Psi'(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n365: $$\n366: \n367: Gronwall\u2019s lemma for first-order linear ODEs gives\n368: \n369: $$\n370: \\Psi(T) \\leq \\int_0^T A_s \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) (T-s)\\right) ds.\n371: $$\n372: \n373: Since $A_s \\leq C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) =: A_*$ for $s \\in [0, T]$, we obtain\n374: \n375: $$\n376: u(T) \\leq A_* \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n377: $$\n378: \n379: Therefore the hypoelliptic $L^\\infty$ bound holds with the explicit constant\n380: \n381: $$\n382: C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R)\n383: := \\Big[C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T)\\Big]\n384: \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n385: $$\n386: \n387: This constant is finite for every finite $T$, depends on all physical parameters, and controls $\\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty$. $\\square$"
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}