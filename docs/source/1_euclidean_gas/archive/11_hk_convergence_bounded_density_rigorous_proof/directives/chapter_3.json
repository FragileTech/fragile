{
  "chapter_index": 3,
  "section_id": "## 3. Gaussian Mollification and Uniform Lower Bounds",
  "directive_count": 3,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-gaussian-kernel-lower-bound",
      "title": "Gaussian Kernel Lower Bound",
      "start_line": 399,
      "end_line": 449,
      "header_lines": [
        400
      ],
      "content_start": 402,
      "content_end": 448,
      "content": "402: :label: lem-gaussian-kernel-lower-bound\n403: \n404: Let $G_{\\sigma_x}(y) = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-\\|y\\|^2 / (2\\sigma_x^2))$ be the Gaussian kernel with variance $\\sigma_x^2 > 0$.\n405: \n406: For any $x_1, x_2 \\in B_R(0) \\subset \\mathbb{R}^d$:\n407: \n408: $$\n409: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} \\leq \\exp\\left( \\frac{(2R)^2}{2\\sigma_x^2} \\right)\n410: \n411: $$\n412: \n413: Moreover, for any integrable density $\\rho$ with $\\|\\rho\\|_{L^1} = m > 0$:\n414: \n415: $$\n416: \\inf_{x \\in B_R} \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq m \\cdot c_{\\sigma_x, R}\n417: \n418: $$\n419: \n420: where:\n421: \n422: $$\n423: c_{\\sigma_x, R} := (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) > 0\n424: \n425: $$\n426: \n427: **Proof**:\n428: \n429: For the ratio bound, note that for $x_1, x_2 \\in B_R$:\n430: \n431: $$\n432: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} = \\exp\\left( \\frac{\\|x_2\\|^2 - \\|x_1\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{\\|x_2\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{R^2}{2\\sigma_x^2} \\right)\n433: \n434: $$\n435: \n436: For the lower bound, fix $x \\in B_R$. For any $y \\in B_R$, $\\|x - y\\| \\leq 2R$, so:\n437: \n438: $$\n439: G_{\\sigma_x}(x - y) \\geq (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) = c_{\\sigma_x, R}\n440: \n441: $$\n442: \n443: Therefore:\n444: \n445: $$\n446: \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq c_{\\sigma_x, R} \\int_{B_R} \\rho(y) dy = c_{\\sigma_x, R} \\cdot m\n447: \n448: $$",
      "metadata": {
        "label": "lem-gaussian-kernel-lower-bound"
      },
      "section": "## 3. Gaussian Mollification and Uniform Lower Bounds",
      "raw_directive": "399: ### 3.1. Quantitative Gaussian Mollification Bounds\n400: \n401: :::{prf:lemma} Gaussian Kernel Lower Bound\n402: :label: lem-gaussian-kernel-lower-bound\n403: \n404: Let $G_{\\sigma_x}(y) = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-\\|y\\|^2 / (2\\sigma_x^2))$ be the Gaussian kernel with variance $\\sigma_x^2 > 0$.\n405: \n406: For any $x_1, x_2 \\in B_R(0) \\subset \\mathbb{R}^d$:\n407: \n408: $$\n409: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} \\leq \\exp\\left( \\frac{(2R)^2}{2\\sigma_x^2} \\right)\n410: \n411: $$\n412: \n413: Moreover, for any integrable density $\\rho$ with $\\|\\rho\\|_{L^1} = m > 0$:\n414: \n415: $$\n416: \\inf_{x \\in B_R} \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq m \\cdot c_{\\sigma_x, R}\n417: \n418: $$\n419: \n420: where:\n421: \n422: $$\n423: c_{\\sigma_x, R} := (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) > 0\n424: \n425: $$\n426: \n427: **Proof**:\n428: \n429: For the ratio bound, note that for $x_1, x_2 \\in B_R$:\n430: \n431: $$\n432: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} = \\exp\\left( \\frac{\\|x_2\\|^2 - \\|x_1\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{\\|x_2\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{R^2}{2\\sigma_x^2} \\right)\n433: \n434: $$\n435: \n436: For the lower bound, fix $x \\in B_R$. For any $y \\in B_R$, $\\|x - y\\| \\leq 2R$, so:\n437: \n438: $$\n439: G_{\\sigma_x}(x - y) \\geq (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) = c_{\\sigma_x, R}\n440: \n441: $$\n442: \n443: Therefore:\n444: \n445: $$\n446: \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq c_{\\sigma_x, R} \\int_{B_R} \\rho(y) dy = c_{\\sigma_x, R} \\cdot m\n447: \n448: $$\n449: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-strict-positivity-cloning",
      "title": "Strict Positivity After Cloning",
      "start_line": 453,
      "end_line": 494,
      "header_lines": [
        454
      ],
      "content_start": 456,
      "content_end": 493,
      "content": "456: :label: lem-strict-positivity-cloning\n457: \n458: After applying the cloning operator with Gaussian position jitter $\\sigma_x > 0$, the density satisfies:\n459: \n460: $$\n461: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n462: \n463: $$\n464: \n465: where $c_{\\sigma_x, R}$ is defined in Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`.\n466: \n467: **Proof**: From `03_cloning.md` (line 6022), the position update is:\n468: \n469: $$\n470: x_i' = x_j + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n471: \n472: $$\n473: \n474: In the mean-field limit, this corresponds to convolution with the Gaussian kernel:\n475: \n476: $$\n477: \\rho_{\\text{post-clone}}(x) = \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) w(y) \\rho_{\\text{pre-clone}}(y) dy\n478: \n479: $$\n480: \n481: where $w(y)$ is the fitness weighting (always positive). Since $w(y) \\geq \\eta > 0$ (floor from rescale transformation, `01_fragile_gas_framework.md`), we have:\n482: \n483: $$\n484: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) \\rho_{\\text{pre-clone}}(y) dy\n485: \n486: $$\n487: \n488: Applying Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`:\n489: \n490: $$\n491: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\cdot c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n492: \n493: $$",
      "metadata": {
        "label": "lem-strict-positivity-cloning"
      },
      "section": "## 3. Gaussian Mollification and Uniform Lower Bounds",
      "raw_directive": "453: ### 3.2. Lower Bound on Post-Cloning Density\n454: \n455: :::{prf:lemma} Strict Positivity After Cloning\n456: :label: lem-strict-positivity-cloning\n457: \n458: After applying the cloning operator with Gaussian position jitter $\\sigma_x > 0$, the density satisfies:\n459: \n460: $$\n461: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n462: \n463: $$\n464: \n465: where $c_{\\sigma_x, R}$ is defined in Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`.\n466: \n467: **Proof**: From `03_cloning.md` (line 6022), the position update is:\n468: \n469: $$\n470: x_i' = x_j + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n471: \n472: $$\n473: \n474: In the mean-field limit, this corresponds to convolution with the Gaussian kernel:\n475: \n476: $$\n477: \\rho_{\\text{post-clone}}(x) = \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) w(y) \\rho_{\\text{pre-clone}}(y) dy\n478: \n479: $$\n480: \n481: where $w(y)$ is the fitness weighting (always positive). Since $w(y) \\geq \\eta > 0$ (floor from rescale transformation, `01_fragile_gas_framework.md`), we have:\n482: \n483: $$\n484: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) \\rho_{\\text{pre-clone}}(y) dy\n485: \n486: $$\n487: \n488: Applying Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`:\n489: \n490: $$\n491: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\cdot c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n492: \n493: $$\n494: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-qsd-strict-positivity",
      "title": "QSD Strict Positivity",
      "start_line": 498,
      "end_line": 588,
      "header_lines": [
        499
      ],
      "content_start": 501,
      "content_end": 587,
      "content": "501: :label: lem-qsd-strict-positivity\n502: \n503: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ has a smooth density with respect to Lebesgue measure that satisfies\n504: \n505: $$\n506: \\inf_{(x,v) \\in \\Omega} \\pi_{\\text{QSD}}(x, v) \\geq c_\\pi > 0,\n507: $$\n508: \n509: where $\\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$ and\n510: \n511: $$\n512: c_\\pi = \\big(\\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R}\\big) \\, m_{\\text{eq}},\n513: \\qquad\n514: c_{\\text{vel}} := (2\\pi\\sigma_v^2 \\beta_\\star)^{-d/2} \\exp\\!\\left(-\\frac{4 V_{\\max}^2}{2 \\sigma_v^2 \\beta_\\star}\\right).\n515: $$\n516: \n517: Here $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ and $\\beta_\\star = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$ for a fixed velocity-refresh time $\\tau_v > 0$.\n518: \n519: **Proof**:\n520: \n521: **Step 1 (Velocity Refresh via Ornstein-Uhlenbeck Block)**  \n522: During a kinetic window of length $\\tau_v$, the BAOAB operator evolves the velocity according to\n523: \n524: $$\n525: p_v^{\\text{OU}}(\\tau_v; v_0, v)\n526: = (2\\pi\\sigma_v^2 \\beta(\\tau_v))^{-d/2}\n527: \\exp\\!\\left(-\\frac{|v - e^{-\\gamma \\tau_v} v_0|^2}{2 \\sigma_v^2 \\beta(\\tau_v)}\\right),\n528: $$\n529: \n530: with $\\beta(\\tau_v) = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$. Because $V_{\\text{alg}}$ is compact ($|v| \\leq V_{\\max}$), choosing $\\tau_v$ so that $\\beta(\\tau_v) \\geq \\beta_\\star>0$ gives\n531: \n532: $$\n533: p_v^{\\text{OU}}(\\tau_v; v_0, v) \\geq c_{\\text{vel}}\n534: \\quad \\text{for all } v_0, v \\in V_{\\text{alg}}.\n535: $$\n536: \n537: Hence a single kinetic block already spreads mass over **all** velocity directions with a state-independent density floor. This removes the previous restriction to velocity balls around $v_0$.\n538: \n539: **Step 2 (Spatial Mollification Without Velocity Restriction)**  \n540: Conditioned on any $(x_1, v_1)$ produced by Step 1, the cloning kernel\n541: \n542: $$\n543: K_{\\text{clone}}\\big((x_1, v_1), (x, v)\\big)\n544: = \\eta \\, G_{\\sigma_x}(x - x_1) \\, \\delta(v - v_1)\n545: $$\n546: \n547: acts on the position coordinate. Lemma {prf:ref}`lem-gaussian-kernel-lower-bound` implies\n548: \n549: $$\n550: G_{\\sigma_x}(x - x_1) \\geq c_{\\sigma_x, R}\n551: \\qquad \\forall x, x_1 \\in \\mathcal{X}_{\\text{valid}},\n552: $$\n553: \n554: so positions are minorized by Lebesgue measure independently of the pre-cloning state.\n555: \n556: **Step 3 (Two-Step Doeblin Minorization)**  \n557: Let $P^{(2)}$ denote \u201ckinetic over $\\tau_v$\u201d composed with \u201ccloning.\u201d For any measurable $A \\subseteq \\Omega$,\n558: \n559: $$\n560: P^{(2)}((x_0, v_0), A)\n561: = \\int_\\Omega p_v^{\\text{OU}}(\\tau_v; v_0, v_1) K_{\\text{clone}}\\big((x_1, v_1), A\\big) \\, dx_1 \\, dv_1\n562: \\geq \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R} \\, |A|,\n563: $$\n564: \n565: where $|A|$ is the Lebesgue measure of $A$ in $\\Omega$. Thus $P^{(2)}$ satisfies a genuine Doeblin condition\n566: \n567: $$\n568: P^{(2)}(z, A) \\geq \\delta_2 \\, \\nu(A),\n569: \\qquad\n570: \\delta_2 := \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R},\n571: $$\n572: \n573: with state-independent minorization measure $\\nu(A) = |A|/|\\Omega|$.\n574: \n575: **Step 4 (Transfer to the QSD)**  \n576: For the invariant quasi-stationary distribution,\n577: \n578: $$\n579: \\pi_{\\text{QSD}}(A)\n580: = \\int_\\Omega P^{(2)}(z, A) \\, \\pi_{\\text{QSD}}(dz)\n581: \\geq \\delta_2 \\, m_{\\text{eq}} \\, \\nu(A),\n582: $$\n583: \n584: so $\\pi_{\\text{QSD}}$ possesses a density bounded below by $c_\\pi = \\delta_2 m_{\\text{eq}} / |\\Omega|$ at every point of $\\Omega$.\n585: \n586: **Step 5 (Smoothness)**  \n587: Lemma {prf:ref}`lem-linfty-full-operator` provides hypoelliptic smoothing, giving $\\pi_{\\text{QSD}} \\in C^\\infty(\\Omega)$ and promoting the almost-everywhere lower bound to a pointwise one.",
      "metadata": {
        "label": "lem-qsd-strict-positivity"
      },
      "section": "## 3. Gaussian Mollification and Uniform Lower Bounds",
      "raw_directive": "498: ### 3.3. QSD Density Lower Bound via Multi-Step Minorization\n499: \n500: :::{prf:lemma} QSD Strict Positivity\n501: :label: lem-qsd-strict-positivity\n502: \n503: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ has a smooth density with respect to Lebesgue measure that satisfies\n504: \n505: $$\n506: \\inf_{(x,v) \\in \\Omega} \\pi_{\\text{QSD}}(x, v) \\geq c_\\pi > 0,\n507: $$\n508: \n509: where $\\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$ and\n510: \n511: $$\n512: c_\\pi = \\big(\\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R}\\big) \\, m_{\\text{eq}},\n513: \\qquad\n514: c_{\\text{vel}} := (2\\pi\\sigma_v^2 \\beta_\\star)^{-d/2} \\exp\\!\\left(-\\frac{4 V_{\\max}^2}{2 \\sigma_v^2 \\beta_\\star}\\right).\n515: $$\n516: \n517: Here $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ and $\\beta_\\star = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$ for a fixed velocity-refresh time $\\tau_v > 0$.\n518: \n519: **Proof**:\n520: \n521: **Step 1 (Velocity Refresh via Ornstein-Uhlenbeck Block)**  \n522: During a kinetic window of length $\\tau_v$, the BAOAB operator evolves the velocity according to\n523: \n524: $$\n525: p_v^{\\text{OU}}(\\tau_v; v_0, v)\n526: = (2\\pi\\sigma_v^2 \\beta(\\tau_v))^{-d/2}\n527: \\exp\\!\\left(-\\frac{|v - e^{-\\gamma \\tau_v} v_0|^2}{2 \\sigma_v^2 \\beta(\\tau_v)}\\right),\n528: $$\n529: \n530: with $\\beta(\\tau_v) = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$. Because $V_{\\text{alg}}$ is compact ($|v| \\leq V_{\\max}$), choosing $\\tau_v$ so that $\\beta(\\tau_v) \\geq \\beta_\\star>0$ gives\n531: \n532: $$\n533: p_v^{\\text{OU}}(\\tau_v; v_0, v) \\geq c_{\\text{vel}}\n534: \\quad \\text{for all } v_0, v \\in V_{\\text{alg}}.\n535: $$\n536: \n537: Hence a single kinetic block already spreads mass over **all** velocity directions with a state-independent density floor. This removes the previous restriction to velocity balls around $v_0$.\n538: \n539: **Step 2 (Spatial Mollification Without Velocity Restriction)**  \n540: Conditioned on any $(x_1, v_1)$ produced by Step 1, the cloning kernel\n541: \n542: $$\n543: K_{\\text{clone}}\\big((x_1, v_1), (x, v)\\big)\n544: = \\eta \\, G_{\\sigma_x}(x - x_1) \\, \\delta(v - v_1)\n545: $$\n546: \n547: acts on the position coordinate. Lemma {prf:ref}`lem-gaussian-kernel-lower-bound` implies\n548: \n549: $$\n550: G_{\\sigma_x}(x - x_1) \\geq c_{\\sigma_x, R}\n551: \\qquad \\forall x, x_1 \\in \\mathcal{X}_{\\text{valid}},\n552: $$\n553: \n554: so positions are minorized by Lebesgue measure independently of the pre-cloning state.\n555: \n556: **Step 3 (Two-Step Doeblin Minorization)**  \n557: Let $P^{(2)}$ denote \u201ckinetic over $\\tau_v$\u201d composed with \u201ccloning.\u201d For any measurable $A \\subseteq \\Omega$,\n558: \n559: $$\n560: P^{(2)}((x_0, v_0), A)\n561: = \\int_\\Omega p_v^{\\text{OU}}(\\tau_v; v_0, v_1) K_{\\text{clone}}\\big((x_1, v_1), A\\big) \\, dx_1 \\, dv_1\n562: \\geq \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R} \\, |A|,\n563: $$\n564: \n565: where $|A|$ is the Lebesgue measure of $A$ in $\\Omega$. Thus $P^{(2)}$ satisfies a genuine Doeblin condition\n566: \n567: $$\n568: P^{(2)}(z, A) \\geq \\delta_2 \\, \\nu(A),\n569: \\qquad\n570: \\delta_2 := \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R},\n571: $$\n572: \n573: with state-independent minorization measure $\\nu(A) = |A|/|\\Omega|$.\n574: \n575: **Step 4 (Transfer to the QSD)**  \n576: For the invariant quasi-stationary distribution,\n577: \n578: $$\n579: \\pi_{\\text{QSD}}(A)\n580: = \\int_\\Omega P^{(2)}(z, A) \\, \\pi_{\\text{QSD}}(dz)\n581: \\geq \\delta_2 \\, m_{\\text{eq}} \\, \\nu(A),\n582: $$\n583: \n584: so $\\pi_{\\text{QSD}}$ possesses a density bounded below by $c_\\pi = \\delta_2 m_{\\text{eq}} / |\\Omega|$ at every point of $\\Omega$.\n585: \n586: **Step 5 (Smoothness)**  \n587: Lemma {prf:ref}`lem-linfty-full-operator` provides hypoelliptic smoothing, giving $\\pi_{\\text{QSD}} \\in C^\\infty(\\Omega)$ and promoting the almost-everywhere lower bound to a pointwise one.\n588: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}