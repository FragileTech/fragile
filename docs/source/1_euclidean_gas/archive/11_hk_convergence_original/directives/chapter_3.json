{
  "chapter_index": 3,
  "section_id": "## 3. Lemma B: Exponential Contraction of Structural Variance",
  "directive_count": 2,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-structural-variance-contraction",
      "title": "Exponential Contraction of Structural Variance",
      "start_line": 1009,
      "end_line": 1029,
      "header_lines": [
        1010
      ],
      "content_start": 1012,
      "content_end": 1028,
      "content": "1012: :label: lem-structural-variance-contraction\n1013: \n1014: Let $\\mu_t$ denote the empirical measure of a single realization of the Fragile Gas at time $t$, and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1015: \n1016: Then the structural variance contracts exponentially in expectation:\n1017: \n1018: $$\n1019: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} t} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}}(1 - e^{-\\lambda_{\\text{struct}} t})\n1020: \n1021: $$\n1022: \n1023: where:\n1024: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the exponential convergence rate\n1025: - $\\kappa_W > 0$ is the cloning operator Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n1026: - $\\kappa_{\\text{kin}} > 0$ is the kinetic operator contraction rate from {prf:ref}`thm-foster-lyapunov-main`\n1027: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ combines noise constants from both operators\n1028: - $\\tau$ is the time step size",
      "metadata": {
        "label": "lem-structural-variance-contraction"
      },
      "section": "## 3. Lemma B: Exponential Contraction of Structural Variance",
      "raw_directive": "1009: **Mathematical Foundation:** This lemma uses the Wasserstein contraction results established in the framework. The cloning operator ({prf:ref}`thm-main-contraction-full` from [04_wasserstein_contraction](04_wasserstein_contraction)) and the kinetic operator ({prf:ref}`thm-foster-lyapunov-main` from [06_convergence](06_convergence)) each provide contraction of the Wasserstein distance **in expectation** after one step of the dynamics.\n1010: \n1011: :::{prf:lemma} Exponential Contraction of Structural Variance\n1012: :label: lem-structural-variance-contraction\n1013: \n1014: Let $\\mu_t$ denote the empirical measure of a single realization of the Fragile Gas at time $t$, and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1015: \n1016: Then the structural variance contracts exponentially in expectation:\n1017: \n1018: $$\n1019: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} t} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}}(1 - e^{-\\lambda_{\\text{struct}} t})\n1020: \n1021: $$\n1022: \n1023: where:\n1024: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the exponential convergence rate\n1025: - $\\kappa_W > 0$ is the cloning operator Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n1026: - $\\kappa_{\\text{kin}} > 0$ is the kinetic operator contraction rate from {prf:ref}`thm-foster-lyapunov-main`\n1027: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ combines noise constants from both operators\n1028: - $\\tau$ is the time step size\n1029: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-structural-variance-contraction",
      "title": null,
      "start_line": 1033,
      "end_line": 1161,
      "header_lines": [
        1034
      ],
      "content_start": 1036,
      "content_end": 1160,
      "content": "1036: :label: proof-lem-structural-variance-contraction\n1037: \n1038: The proof uses direct application of the Wasserstein contraction results from the framework, establishing convergence in expectation.\n1039: \n1040: **Step 1: Expected Wasserstein Contraction from Cloning Operator**\n1041: \n1042: From Theorem {prf:ref}`thm-main-contraction-full` in [04_wasserstein_contraction](04_wasserstein_contraction), the cloning operator $\\Psi_{\\text{clone}}$ satisfies:\n1043: \n1044: $$\n1045: \\mathbb{E}[W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2))] \\leq (1 - \\kappa_W) W_2^2(\\mu_1, \\mu_2) + C_W\n1046: \n1047: $$\n1048: \n1049: where:\n1050: - $\\kappa_W > 0$ is the N-uniform contraction constant from the cluster-level analysis\n1051: - $C_W = 4d\\delta^2$ is the noise constant from Gaussian cloning perturbations\n1052: - The expectation is taken over the randomness in the cloning operator (Gaussian perturbations and random pairing decisions)\n1053: \n1054: **Note on convergence type:** This establishes convergence of the **expected** Wasserstein distance, which is the appropriate notion for stochastic processes. The inequality bounds how the second moment $\\mathbb{E}[W_2^2]$ evolves, not the distance between individual random realizations.\n1055: \n1056: **Step 2: Wasserstein Contraction from Kinetic Operator**\n1057: \n1058: From Theorem {prf:ref}`thm-foster-lyapunov-main` in [06_convergence](06_convergence), the composed operator's Foster-Lyapunov function includes a Wasserstein component $V_W = W_2^2(\\mu, \\pi_{\\text{QSD}})$ that satisfies:\n1059: \n1060: $$\n1061: \\mathbb{E}[V_W(\\Psi_{\\text{kin}}(\\mu))] \\leq (1 - \\kappa_{\\text{kin}}\\tau) V_W(\\mu) + C_{\\text{kin}}\\tau^2\n1062: \n1063: $$\n1064: \n1065: where:\n1066: - $\\kappa_{\\text{kin}} > 0$ is the hypocoercive contraction rate from the kinetic operator\n1067: - $C_{\\text{kin}}$ is the noise constant from BAOAB discretization\n1068: - $\\tau$ is the time step size\n1069: \n1070: **Note:** The Foster-Lyapunov inequality bounds the **expected** Wasserstein distance after one application of the kinetic operator, averaged over the Langevin noise realizations.\n1071: \n1072: **Step 3: Composition of Both Operators**\n1073: \n1074: Applying both operators sequentially to a realization $\\mu_t$, with the QSD $\\pi_{\\text{QSD}}$ as the comparison measure (noting that $\\Psi_{\\text{total}}(\\pi_{\\text{QSD}}) = \\pi_{\\text{QSD}}$ by stationarity):\n1075: \n1076: $$\n1077: \\mathbb{E}[W_2^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] = \\mathbb{E}[W_2^2(\\Psi_{\\text{kin}}(\\Psi_{\\text{clone}}(\\mu_t)), \\pi_{\\text{QSD}})]\n1078: \n1079: $$\n1080: \n1081: First apply cloning:\n1082: \n1083: $$\n1084: \\mathbb{E}[W_2^2(\\Psi_{\\text{clone}}(\\mu_t), \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_W) W_2^2(\\mu_t, \\pi_{\\text{QSD}}) + C_W\n1085: \n1086: $$\n1087: \n1088: Then apply kinetic:\n1089: \n1090: $$\n1091: \\mathbb{E}[W_2^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{\\text{kin}}\\tau) \\mathbb{E}[W_2^2(\\Psi_{\\text{clone}}(\\mu_t), \\pi_{\\text{QSD}})] + C_{\\text{kin}}\\tau^2\n1092: \n1093: $$\n1094: \n1095: Combining:\n1096: \n1097: $$\n1098: \\mathbb{E}[W_2^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1-\\kappa_W)(1-\\kappa_{\\text{kin}}\\tau) W_2^2(\\mu_t, \\pi_{\\text{QSD}}) + (1-\\kappa_{\\text{kin}}\\tau)C_W + C_{\\text{kin}}\\tau^2\n1099: \n1100: $$\n1101: \n1102: For small $\\tau$, the product satisfies:\n1103: \n1104: $$\n1105: (1-\\kappa_W)(1-\\kappa_{\\text{kin}}\\tau) = 1 - \\kappa_W - \\kappa_{\\text{kin}}\\tau + O(\\kappa_W \\kappa_{\\text{kin}} \\tau) \\leq 1 - \\lambda_{\\text{struct}}\\tau\n1106: \n1107: $$\n1108: \n1109: where $\\lambda_{\\text{struct}} := \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ gives the dominant contraction rate.\n1110: \n1111: Define the noise constant: $C_{\\text{struct}} := C_W + C_{\\text{kin}}\\tau^2$.\n1112: \n1113: **Step 4: From Wasserstein to Structural Variance**\n1114: \n1115: The **variance decomposition** (Villani 2009, Theorem 7.17) states:\n1116: \n1117: $$\n1118: W_2^2(\\mu, \\pi) = W_2^2(\\tilde{\\mu}, \\tilde{\\pi}) + \\|m_\\mu - m_\\pi\\|^2\n1119: \n1120: $$\n1121: \n1122: where $\\tilde{\\mu}, \\tilde{\\pi}$ are centered versions and $m_\\mu, m_\\pi$ are the means.\n1123: \n1124: Therefore, the structural variance (centered Wasserstein) satisfies:\n1125: \n1126: $$\n1127: V_{\\text{struct}}(\\mu, \\pi) := W_2^2(\\tilde{\\mu}, \\tilde{\\pi}) = W_2^2(\\mu, \\pi) - \\|m_\\mu - m_\\pi\\|^2 \\leq W_2^2(\\mu, \\pi)\n1128: \n1129: $$\n1130: \n1131: Applying this to our contraction result:\n1132: \n1133: $$\n1134: \\mathbb{E}[V_{\\text{struct}}(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq \\mathbb{E}[W_2^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\lambda_{\\text{struct}}\\tau) W_2^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{struct}}\n1135: \n1136: $$\n1137: \n1138: Since $W_2^2(\\mu_t, \\pi_{\\text{QSD}}) = V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}}) + \\|m_{\\mu_t} - m_{\\pi}\\|^2$ and the mean distance contracts as well (Lemma A for mass, standard Langevin contraction for position), we have:\n1139: \n1140: $$\n1141: \\mathbb{E}[V_{\\text{struct}}(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\lambda_{\\text{struct}}\\tau) V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{struct}}\n1142: \n1143: $$\n1144: \n1145: **Step 5: Exponential Convergence**\n1146: \n1147: This is the standard Foster-Lyapunov drift inequality. Iterating and taking expectations:\n1148: \n1149: $$\n1150: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq (1-\\lambda_{\\text{struct}}\\tau)^{t/\\tau} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}\\tau}(1-(1-\\lambda_{\\text{struct}}\\tau)^{t/\\tau})\n1151: \n1152: $$\n1153: \n1154: Using $(1-\\lambda_{\\text{struct}}\\tau)^{t/\\tau} \\approx e^{-\\lambda_{\\text{struct}} t}$ for small $\\tau$:\n1155: \n1156: $$\n1157: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} t} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}}(1 - e^{-\\lambda_{\\text{struct}} t})\n1158: \n1159: $$\n1160: ",
      "metadata": {
        "label": "proof-lem-structural-variance-contraction"
      },
      "section": "## 3. Lemma B: Exponential Contraction of Structural Variance",
      "raw_directive": "1033: ### Proof of Lemma B\n1034: \n1035: :::{prf:proof}\n1036: :label: proof-lem-structural-variance-contraction\n1037: \n1038: The proof uses direct application of the Wasserstein contraction results from the framework, establishing convergence in expectation.\n1039: \n1040: **Step 1: Expected Wasserstein Contraction from Cloning Operator**\n1041: \n1042: From Theorem {prf:ref}`thm-main-contraction-full` in [04_wasserstein_contraction](04_wasserstein_contraction), the cloning operator $\\Psi_{\\text{clone}}$ satisfies:\n1043: \n1044: $$\n1045: \\mathbb{E}[W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2))] \\leq (1 - \\kappa_W) W_2^2(\\mu_1, \\mu_2) + C_W\n1046: \n1047: $$\n1048: \n1049: where:\n1050: - $\\kappa_W > 0$ is the N-uniform contraction constant from the cluster-level analysis\n1051: - $C_W = 4d\\delta^2$ is the noise constant from Gaussian cloning perturbations\n1052: - The expectation is taken over the randomness in the cloning operator (Gaussian perturbations and random pairing decisions)\n1053: \n1054: **Note on convergence type:** This establishes convergence of the **expected** Wasserstein distance, which is the appropriate notion for stochastic processes. The inequality bounds how the second moment $\\mathbb{E}[W_2^2]$ evolves, not the distance between individual random realizations.\n1055: \n1056: **Step 2: Wasserstein Contraction from Kinetic Operator**\n1057: \n1058: From Theorem {prf:ref}`thm-foster-lyapunov-main` in [06_convergence](06_convergence), the composed operator's Foster-Lyapunov function includes a Wasserstein component $V_W = W_2^2(\\mu, \\pi_{\\text{QSD}})$ that satisfies:\n1059: \n1060: $$\n1061: \\mathbb{E}[V_W(\\Psi_{\\text{kin}}(\\mu))] \\leq (1 - \\kappa_{\\text{kin}}\\tau) V_W(\\mu) + C_{\\text{kin}}\\tau^2\n1062: \n1063: $$\n1064: \n1065: where:\n1066: - $\\kappa_{\\text{kin}} > 0$ is the hypocoercive contraction rate from the kinetic operator\n1067: - $C_{\\text{kin}}$ is the noise constant from BAOAB discretization\n1068: - $\\tau$ is the time step size\n1069: \n1070: **Note:** The Foster-Lyapunov inequality bounds the **expected** Wasserstein distance after one application of the kinetic operator, averaged over the Langevin noise realizations.\n1071: \n1072: **Step 3: Composition of Both Operators**\n1073: \n1074: Applying both operators sequentially to a realization $\\mu_t$, with the QSD $\\pi_{\\text{QSD}}$ as the comparison measure (noting that $\\Psi_{\\text{total}}(\\pi_{\\text{QSD}}) = \\pi_{\\text{QSD}}$ by stationarity):\n1075: \n1076: $$\n1077: \\mathbb{E}[W_2^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] = \\mathbb{E}[W_2^2(\\Psi_{\\text{kin}}(\\Psi_{\\text{clone}}(\\mu_t)), \\pi_{\\text{QSD}})]\n1078: \n1079: $$\n1080: \n1081: First apply cloning:\n1082: \n1083: $$\n1084: \\mathbb{E}[W_2^2(\\Psi_{\\text{clone}}(\\mu_t), \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_W) W_2^2(\\mu_t, \\pi_{\\text{QSD}}) + C_W\n1085: \n1086: $$\n1087: \n1088: Then apply kinetic:\n1089: \n1090: $$\n1091: \\mathbb{E}[W_2^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{\\text{kin}}\\tau) \\mathbb{E}[W_2^2(\\Psi_{\\text{clone}}(\\mu_t), \\pi_{\\text{QSD}})] + C_{\\text{kin}}\\tau^2\n1092: \n1093: $$\n1094: \n1095: Combining:\n1096: \n1097: $$\n1098: \\mathbb{E}[W_2^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1-\\kappa_W)(1-\\kappa_{\\text{kin}}\\tau) W_2^2(\\mu_t, \\pi_{\\text{QSD}}) + (1-\\kappa_{\\text{kin}}\\tau)C_W + C_{\\text{kin}}\\tau^2\n1099: \n1100: $$\n1101: \n1102: For small $\\tau$, the product satisfies:\n1103: \n1104: $$\n1105: (1-\\kappa_W)(1-\\kappa_{\\text{kin}}\\tau) = 1 - \\kappa_W - \\kappa_{\\text{kin}}\\tau + O(\\kappa_W \\kappa_{\\text{kin}} \\tau) \\leq 1 - \\lambda_{\\text{struct}}\\tau\n1106: \n1107: $$\n1108: \n1109: where $\\lambda_{\\text{struct}} := \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ gives the dominant contraction rate.\n1110: \n1111: Define the noise constant: $C_{\\text{struct}} := C_W + C_{\\text{kin}}\\tau^2$.\n1112: \n1113: **Step 4: From Wasserstein to Structural Variance**\n1114: \n1115: The **variance decomposition** (Villani 2009, Theorem 7.17) states:\n1116: \n1117: $$\n1118: W_2^2(\\mu, \\pi) = W_2^2(\\tilde{\\mu}, \\tilde{\\pi}) + \\|m_\\mu - m_\\pi\\|^2\n1119: \n1120: $$\n1121: \n1122: where $\\tilde{\\mu}, \\tilde{\\pi}$ are centered versions and $m_\\mu, m_\\pi$ are the means.\n1123: \n1124: Therefore, the structural variance (centered Wasserstein) satisfies:\n1125: \n1126: $$\n1127: V_{\\text{struct}}(\\mu, \\pi) := W_2^2(\\tilde{\\mu}, \\tilde{\\pi}) = W_2^2(\\mu, \\pi) - \\|m_\\mu - m_\\pi\\|^2 \\leq W_2^2(\\mu, \\pi)\n1128: \n1129: $$\n1130: \n1131: Applying this to our contraction result:\n1132: \n1133: $$\n1134: \\mathbb{E}[V_{\\text{struct}}(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq \\mathbb{E}[W_2^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\lambda_{\\text{struct}}\\tau) W_2^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{struct}}\n1135: \n1136: $$\n1137: \n1138: Since $W_2^2(\\mu_t, \\pi_{\\text{QSD}}) = V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}}) + \\|m_{\\mu_t} - m_{\\pi}\\|^2$ and the mean distance contracts as well (Lemma A for mass, standard Langevin contraction for position), we have:\n1139: \n1140: $$\n1141: \\mathbb{E}[V_{\\text{struct}}(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\lambda_{\\text{struct}}\\tau) V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{struct}}\n1142: \n1143: $$\n1144: \n1145: **Step 5: Exponential Convergence**\n1146: \n1147: This is the standard Foster-Lyapunov drift inequality. Iterating and taking expectations:\n1148: \n1149: $$\n1150: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq (1-\\lambda_{\\text{struct}}\\tau)^{t/\\tau} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}\\tau}(1-(1-\\lambda_{\\text{struct}}\\tau)^{t/\\tau})\n1151: \n1152: $$\n1153: \n1154: Using $(1-\\lambda_{\\text{struct}}\\tau)^{t/\\tau} \\approx e^{-\\lambda_{\\text{struct}} t}$ for small $\\tau$:\n1155: \n1156: $$\n1157: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} t} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}}(1 - e^{-\\lambda_{\\text{struct}} t})\n1158: \n1159: $$\n1160: \n1161: This establishes exponential contraction of the structural variance at the realization level."
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}