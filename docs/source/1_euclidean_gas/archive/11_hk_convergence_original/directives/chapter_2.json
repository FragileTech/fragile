{
  "chapter_index": 2,
  "section_id": "## 2. Lemma A: Mass Contraction from Revival and Death",
  "directive_count": 2,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-mass-contraction-revival-death",
      "title": "Mass Contraction via Revival and Death",
      "start_line": 186,
      "end_line": 226,
      "header_lines": [
        187
      ],
      "content_start": 189,
      "content_end": 225,
      "content": "189: :label: lem-mass-contraction-revival-death\n190: \n191: Let $k_t = \\|\\mu_t\\|$ denote the number of alive walkers at time $t$ (the total mass of the empirical measure). Let $k_* = \\|\\pi_{\\text{QSD}}\\|$ denote the equilibrium alive count under the QSD.\n192: \n193: Assume:\n194: 1. **Birth Mechanism**: The Fragile Gas creates new walkers via two processes:\n195:    - Guaranteed revival of all dead walkers (from {prf:ref}`def-axiom-guaranteed-revival`)\n196:    - Cloning of alive walkers with rate $\\lambda_{\\text{clone}}(k_t)$ per walker\n197: \n198:    Total births: $B_t = (N - k_t) + C_t$ where $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$\n199: \n200: 2. **Death Mechanism**: Boundary exit causes death with rate $\\bar{p}_{\\text{kill}}(k_t)$, giving $\\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(k_t) k_t$\n201: \n202: 3. **QSD Equilibrium**: The equilibrium mass $k_*$ satisfies $(N - k_*) + \\lambda_{\\text{clone}}^* k_* = \\bar{p}_{\\text{kill}}^* k_*$\n203: \n204: 4. **Lipschitz Continuity**: Both $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k)$ are Lipschitz continuous:\n205:    - $|\\lambda_{\\text{clone}}(k_t) - \\lambda_{\\text{clone}}^*| \\leq L_\\lambda |k_t - k_*|$\n206:    - $|\\bar{p}_{\\text{kill}}(k_t) - \\bar{p}_{\\text{kill}}^*| \\leq L_p |k_t - k_*|$\n207: \n208: Then there exist constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$ such that:\n209: \n210: $$\n211: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n212: \n213: $$\n214: \n215: where:\n216: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n217: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n218: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n219: - $L_\\lambda$ is the Lipschitz constant of the cloning rate\n220: - $L_p$ is the Lipschitz constant of the killing rate\n221: - $N$ is the total number of walkers (alive + dead)\n222: \n223: **Assumptions:**\n224: 1. $\\epsilon^2 + \\epsilon < 1$, which requires $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (achieved when $L_p L_\\lambda = O(1/N^2)$ for large $N$)\n225: 2. $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with $L_g^{(2)} = O(N^{-1})$ (natural for density-dependent rates)",
      "metadata": {
        "label": "lem-mass-contraction-revival-death"
      },
      "section": "## 2. Lemma A: Mass Contraction from Revival and Death",
      "raw_directive": "186: This lemma establishes that the combined effect of the revival mechanism (Axiom of Guaranteed Revival) and boundary death causes the total alive mass to contract toward the QSD equilibrium mass. The proof analyzes the full distribution of the mass change, accounting for both revival (mass increase) and boundary death (mass decrease).\n187: \n188: :::{prf:lemma} Mass Contraction via Revival and Death\n189: :label: lem-mass-contraction-revival-death\n190: \n191: Let $k_t = \\|\\mu_t\\|$ denote the number of alive walkers at time $t$ (the total mass of the empirical measure). Let $k_* = \\|\\pi_{\\text{QSD}}\\|$ denote the equilibrium alive count under the QSD.\n192: \n193: Assume:\n194: 1. **Birth Mechanism**: The Fragile Gas creates new walkers via two processes:\n195:    - Guaranteed revival of all dead walkers (from {prf:ref}`def-axiom-guaranteed-revival`)\n196:    - Cloning of alive walkers with rate $\\lambda_{\\text{clone}}(k_t)$ per walker\n197: \n198:    Total births: $B_t = (N - k_t) + C_t$ where $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$\n199: \n200: 2. **Death Mechanism**: Boundary exit causes death with rate $\\bar{p}_{\\text{kill}}(k_t)$, giving $\\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(k_t) k_t$\n201: \n202: 3. **QSD Equilibrium**: The equilibrium mass $k_*$ satisfies $(N - k_*) + \\lambda_{\\text{clone}}^* k_* = \\bar{p}_{\\text{kill}}^* k_*$\n203: \n204: 4. **Lipschitz Continuity**: Both $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k)$ are Lipschitz continuous:\n205:    - $|\\lambda_{\\text{clone}}(k_t) - \\lambda_{\\text{clone}}^*| \\leq L_\\lambda |k_t - k_*|$\n206:    - $|\\bar{p}_{\\text{kill}}(k_t) - \\bar{p}_{\\text{kill}}^*| \\leq L_p |k_t - k_*|$\n207: \n208: Then there exist constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$ such that:\n209: \n210: $$\n211: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n212: \n213: $$\n214: \n215: where:\n216: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n217: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n218: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n219: - $L_\\lambda$ is the Lipschitz constant of the cloning rate\n220: - $L_p$ is the Lipschitz constant of the killing rate\n221: - $N$ is the total number of walkers (alive + dead)\n222: \n223: **Assumptions:**\n224: 1. $\\epsilon^2 + \\epsilon < 1$, which requires $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (achieved when $L_p L_\\lambda = O(1/N^2)$ for large $N$)\n225: 2. $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with $L_g^{(2)} = O(N^{-1})$ (natural for density-dependent rates)\n226: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-mass-contraction-revival-death",
      "title": null,
      "start_line": 230,
      "end_line": 991,
      "header_lines": [
        231
      ],
      "content_start": 233,
      "content_end": 990,
      "content": "233: :label: proof-lem-mass-contraction-revival-death\n234: \n235: **Constants and Assumptions**\n236: \n237: The proof uses the following constants and assumptions:\n238: \n239: - **$\\lambda_{\\max}$**: Upper bound on the cloning rate: $\\lambda_{\\text{clone}}(k) \\leq \\lambda_{\\max}$ for all $k$\n240: - **$\\bar{p}_{\\max}$**: Upper bound on the killing probability: $\\bar{p}_{\\text{kill}}(k') \\leq \\bar{p}_{\\max}$ for all $k'$\n241: - **$L_\\lambda$**: Lipschitz constant of the cloning rate: $|\\lambda_{\\text{clone}}(k_1) - \\lambda_{\\text{clone}}(k_2)| \\leq L_\\lambda |k_1 - k_2|$\n242: - **$L_p$**: Lipschitz constant of the killing probability: $|\\bar{p}_{\\text{kill}}(k'_1) - \\bar{p}_{\\text{kill}}(k'_2)| \\leq L_p |k'_1 - k'_2|$\n243: - **$L_g^{(1)}$**: Bound on the first derivative of $g(c) = \\bar{p}_{\\text{kill}}(N+c)(N+c)$: $|g'(c)| \\leq L_g^{(1)}$\n244: - **$L_g^{(2)}$**: Bound on the second derivative of $g(c)$: $|g''(c)| \\leq L_g^{(2)}$\n245: \n246: **Assumption on density-dependent scaling:** For rates that depend on densities $\\rho = k/N$, we have $L_g^{(2)} = O(N^{-1})$.\n247: \n248: ---\n249: \n250: **Explicit Model Definition: Two-Stage Process**\n251: \n252: The Fragile Gas update from time $t$ to $t+1$ consists of two sequential stages:\n253: \n254: 1. **Stage 1 - Births (Cloning + Revival)**: Starting with $k_t$ alive walkers, apply the cloning operator $\\Psi_{\\text{clone}}$ which includes:\n255:    - Guaranteed revival of all $(N - k_t)$ dead walkers (Axiom of Guaranteed Revival)\n256:    - Stochastic cloning of alive walkers, creating $C_t$ new walkers\n257: \n258:    After Stage 1, the intermediate population size is:\n259: \n260:    $$\n261:    k'_t := N + C_t\n262:    $$\n263: \n264: 2. **Stage 2 - Deaths (Kinetic + Boundary)**: Apply the kinetic operator $\\Psi_{\\text{kin}}$ to the intermediate population of size $k'_t$:\n265:    - Langevin diffusion moves walkers\n266:    - Boundary killing removes $D_t$ walkers that exit $\\mathcal{X}_{\\text{valid}}$\n267: \n268:    After Stage 2, the final population size is:\n269: \n270:    $$\n271:    k_{t+1} = k'_t - D_t = N + C_t - D_t\n272:    $$\n273: \n274: **Key Insight:** Deaths $D_t$ are drawn from the intermediate population $k'_t = N + C_t$, NOT from the initial population $k_t$. This temporal ordering is critical for the correct drift calculation.\n275: \n276: **Setup: Mass Balance Equation**\n277: \n278: The mass evolution is:\n279: \n280: $$\n281: k_{t+1} = N + C_t - D_t\n282: \n283: $$\n284: \n285: where:\n286: - $C_t \\geq 0$ is the number of cloning events from Stage 1 (random variable)\n287: - $D_t \\geq 0$ is the number of deaths from Stage 2 (random variable, dependent on $C_t$)\n288: \n289: **Step 1: Expected Deaths (Two-Stage Expectation)**\n290: \n291: Deaths occur when walkers from the intermediate population $k'_t = N + C_t$ exit the valid domain during the kinetic stage.\n292: \n293: Let $\\bar{p}_{\\text{kill}}(k')$ denote the average per-walker killing probability when the population size is $k'$. Then, conditioned on $C_t$:\n294: \n295: $$\n296: \\mathbb{E}[D_t | C_t, k_t] = \\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t)\n297: \n298: $$\n299: \n300: Taking the expectation over $C_t$:\n301: \n302: $$\n303: \\mathbb{E}[D_t | k_t] = \\mathbb{E}_{C_t}[\\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t) | k_t]\n304: \n305: $$\n306: \n307: **Step 2: Expected Cloning Events**\n308: \n309: Cloning events occur in Stage 1. Let $\\lambda_{\\text{clone}}(k_t)$ denote the expected per-walker cloning rate when there are $k_t$ alive walkers:\n310: \n311: $$\n312: \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) \\cdot k_t\n313: \n314: $$\n315: \n316: **Assumption (Lipschitz Continuity of Cloning Rate):** The cloning rate is Lipschitz continuous:\n317: \n318: $$\n319: |\\lambda_{\\text{clone}}(k_1) - \\lambda_{\\text{clone}}(k_2)| \\leq L_\\lambda |k_1 - k_2|\n320: \n321: $$\n322: \n323: **Step 3: Define the Equilibrium**\n324: \n325: At equilibrium, the expected mass change is zero: $\\mathbb{E}[k_{t+1} - k_* | k_t = k_*] = 0$.\n326: \n327: From the mass balance $k_{t+1} = N + C_t - D_t$:\n328: \n329: $$\n330: \\mathbb{E}[N + C_t - D_t | k_* ] = k_*\n331: \n332: $$\n333: \n334: Using the two-stage expectation for deaths:\n335: \n336: $$\n337: N + \\mathbb{E}[C_t | k_*] - \\mathbb{E}_{C_t}[\\mathbb{E}[D_t | C_t, k_*]] = k_*\n338: \n339: $$\n340: \n341: Let $\\lambda_{\\text{clone}}^* := \\lambda_{\\text{clone}}(k_*)$ and $C_* := \\mathbb{E}[C_t | k_*] = \\lambda_{\\text{clone}}^* k_*$.\n342: \n343: At equilibrium, the intermediate population is $k'^* = N + C_*$, and:\n344: \n345: $$\n346: \\bar{p}_{\\text{kill}}^* := \\bar{p}_{\\text{kill}}(k'^*) = \\bar{p}_{\\text{kill}}(N + \\lambda_{\\text{clone}}^* k_*)\n347: \n348: $$\n349: \n350: The equilibrium condition becomes:\n351: \n352: $$\n353: N + \\lambda_{\\text{clone}}^* k_* - \\bar{p}_{\\text{kill}}^* \\cdot (N + \\lambda_{\\text{clone}}^* k_*) = k_*\n354: \n355: $$\n356: \n357: Simplifying:\n358: \n359: $$\n360: (N + \\lambda_{\\text{clone}}^* k_*)(1 - \\bar{p}_{\\text{kill}}^*) = k_*\n361: \n362: $$\n363: \n364: $$\n365: N + \\lambda_{\\text{clone}}^* k_* = \\frac{k_*}{1 - \\bar{p}_{\\text{kill}}^*}\n366: \n367: $$\n368: \n369: **Clarification on the Equilibrium Condition:**\n370: \n371: This equilibrium condition may appear circular since both $k_*$ and $\\bar{p}_{\\text{kill}}^*$ depend on the equilibrium state. However, it is **not circular**\u2014it is a **self-consistency equation** that uniquely determines $k_*$.\n372: \n373: To see this, note that $\\bar{p}_{\\text{kill}}^*$ is evaluated at the **intermediate population** $k'^* = N + \\lambda_{\\text{clone}}^* k_*$, which itself depends on $k_*$. The equilibrium condition can be rewritten as:\n374: \n375: $$\n376: f(k_*) := (N + \\lambda_{\\text{clone}}(k_*) k_*)(1 - \\bar{p}_{\\text{kill}}(N + \\lambda_{\\text{clone}}(k_*) k_*)) - k_* = 0\n377: \n378: $$\n379: \n380: For physically reasonable rate functions $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k')$, this equation has a unique positive solution $k_* \\in (0, N)$, which defines the QSD equilibrium mass. The proof of Lemma A then shows that this equilibrium is **stable**: the mass $k_t$ converges to $k_*$ exponentially fast.\n381: \n382: **Step 4: Expected Mass Change (Two-Stage Calculation with Taylor Expansion)**\n383: \n384: The deviation from equilibrium is:\n385: \n386: $$\n387: k_{t+1} - k_* = N + C_t - D_t - k_*\n388: \n389: $$\n390: \n391: Taking expectations:\n392: \n393: $$\n394: \\mathbb{E}[k_{t+1} - k_* | k_t] = N + \\mathbb{E}[C_t | k_t] - \\mathbb{E}[D_t | k_t] - k_*\n395: \n396: $$\n397: \n398: From Step 2: $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$.\n399: \n400: From Step 1, using the law of total expectation:\n401: \n402: $$\n403: \\mathbb{E}[D_t | k_t] = \\mathbb{E}_{C_t}[\\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t) | k_t]\n404: \n405: $$\n406: \n407: **Rigorous expectation calculation via Taylor expansion:**\n408: \n409: Define the death function:\n410: \n411: $$\n412: g(c) := \\bar{p}_{\\text{kill}}(N + c) \\cdot (N + c)\n413: \n414: $$\n415: \n416: **Assumption:** $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with bounded derivatives:\n417: - $|g'(c)| \\leq L_g^{(1)} < \\infty$\n418: - $|g''(c)| \\leq L_g^{(2)} < \\infty$\n419: \n420: Let $\\bar{C}_t := \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$. By Taylor's theorem:\n421: \n422: $$\n423: g(C_t) = g(\\bar{C}_t) + g'(\\bar{C}_t)(C_t - \\bar{C}_t) + \\frac{1}{2}g''(\\xi_t)(C_t - \\bar{C}_t)^2\n424: \n425: $$\n426: \n427: where $\\xi_t$ is between $C_t$ and $\\bar{C}_t$.\n428: \n429: Taking expectations:\n430: \n431: $$\n432: \\mathbb{E}[D_t | k_t] = \\mathbb{E}[g(C_t) | k_t] = g(\\bar{C}_t) + \\frac{1}{2}\\mathbb{E}[g''(\\xi_t)(C_t - \\bar{C}_t)^2 | k_t]\n433: \n434: $$\n435: \n436: The second-order term is bounded:\n437: \n438: $$\n439: \\left|\\frac{1}{2}\\mathbb{E}[g''(\\xi_t)(C_t - \\bar{C}_t)^2 | k_t]\\right| \\leq \\frac{L_g^{(2)}}{2} \\text{Var}(C_t | k_t)\n440: \n441: $$\n442: \n443: **Model for cloning variance:** Assume cloning events are independent Bernoulli trials, giving:\n444: \n445: $$\n446: \\text{Var}(C_t | k_t) \\leq \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t \\leq \\lambda_{\\max} N\n447: \n448: $$\n449: \n450: where $\\lambda_{\\max} := \\sup_{k} \\lambda_{\\text{clone}}(k)$.\n451: \n452: Thus:\n453: \n454: $$\n455: \\mathbb{E}[D_t | k_t] = g(\\bar{C}_t) + \\mathcal{E}_{\\text{drift}}\n456: \n457: $$\n458: \n459: where the drift error satisfies:\n460: \n461: $$\n462: |\\mathcal{E}_{\\text{drift}}| \\leq \\frac{L_g^{(2)} \\lambda_{\\max} N}{2}\n463: \n464: $$\n465: \n466: Define the intermediate population mean:\n467: \n468: $$\n469: \\bar{k}'_t := N + \\bar{C}_t = N + \\lambda_{\\text{clone}}(k_t) k_t\n470: \n471: $$\n472: \n473: Then:\n474: \n475: $$\n476: \\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(\\bar{k}'_t) \\cdot \\bar{k}'_t + \\mathcal{E}_{\\text{drift}}\n477: \n478: $$\n479: \n480: **Step 5: Drift Analysis Using Equilibrium (with Error Term)**\n481: \n482: Substituting into the expected mass change:\n483: \n484: $$\n485: \\mathbb{E}[k_{t+1} - k_* | k_t] = N + \\lambda_{\\text{clone}}(k_t) k_t - \\bar{p}_{\\text{kill}}(\\bar{k}'_t) \\cdot \\bar{k}'_t - \\mathcal{E}_{\\text{drift}} - k_*\n486: \n487: $$\n488: \n489: $$\n490: = \\bar{k}'_t (1 - \\bar{p}_{\\text{kill}}(\\bar{k}'_t)) - k_* - \\mathcal{E}_{\\text{drift}}\n491: \n492: $$\n493: \n494: From Step 3, at equilibrium $k'^* (1 - \\bar{p}_{\\text{kill}}^*) = k_*$. Thus:\n495: \n496: $$\n497: \\mathbb{E}[k_{t+1} - k_* | k_t] = f(\\bar{k}'_t) - f(k'^*) - \\mathcal{E}_{\\text{drift}}\n498: \n499: $$\n500: \n501: where $f(k') := k'(1 - \\bar{p}_{\\text{kill}}(k'))$.\n502: \n503: **Lipschitz continuity of $f$:** By the same calculation as before, $f$ has Lipschitz constant:\n504: \n505: $$\n506: L_f = 1 + 2L_p N + \\bar{p}_{\\text{kill}}^*\n507: \n508: $$\n509: \n510: From Step 2: $|\\bar{k}'_t - k'^*| \\leq (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*|$.\n511: \n512: Therefore:\n513: \n514: $$\n515: |f(\\bar{k}'_t) - f(k'^*)| \\leq L_f \\cdot (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*|\n516: \n517: $$\n518: \n519: Combining with the drift error from Step 4:\n520: \n521: $$\n522: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq L_f \\cdot (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*| + \\frac{L_g^{(2)} \\lambda_{\\max} N}{2}\n523: \n524: $$\n525: \n526: Define:\n527: - $\\epsilon := L_f (L_\\lambda N + \\lambda_{\\text{clone}}^*) = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n528: - $\\mathcal{E}_{\\max} := L_g^{(2)} \\lambda_{\\max} N / 2$\n529: \n530: **Step 6: Lyapunov Function - Squared Error Contraction**\n531: \n532: To properly handle the stochastic fluctuations, we use a **Lyapunov function** approach. Define:\n533: \n534: $$\n535: V(k_t) := (k_t - k_*)^2\n536: \n537: $$\n538: \n539: We will prove a drift inequality:\n540: \n541: $$\n542: \\mathbb{E}[V(k_{t+1}) | k_t] \\leq (1 - \\kappa_{\\text{mass}}) V(k_t) + C_{\\text{mass}}\n543: \n544: $$\n545: \n546: for some constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$.\n547: \n548: **Step 6a: Expansion of Expected Squared Error**\n549: \n550: The mass deviation at time $t+1$ is:\n551: \n552: $$\n553: k_{t+1} - k_* = N + C_t - D_t - k_*\n554: \n555: $$\n556: \n557: From Step 4, using the equilibrium condition:\n558: \n559: $$\n560: k_{t+1} - k_* = (\\bar{p}_{\\text{kill}}^* - \\lambda_{\\text{clone}}^*) k_* - (k_t - k_*) + C_t - D_t\n561: \n562: $$\n563: \n564: Define:\n565: - $\\Delta C_t := C_t - \\mathbb{E}[C_t | k_t]$ (cloning fluctuation)\n566: - $\\Delta D_t := D_t - \\mathbb{E}[D_t | k_t]$ (death fluctuation)\n567: \n568: Then:\n569: \n570: $$\n571: k_{t+1} - k_* = \\mathbb{E}[k_{t+1} - k_* | k_t] + \\Delta C_t - \\Delta D_t\n572: \n573: $$\n574: \n575: Squaring:\n576: \n577: $$\n578: (k_{t+1} - k_*)^2 = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + 2\\mathbb{E}[k_{t+1} - k_* | k_t](\\Delta C_t - \\Delta D_t) + (\\Delta C_t - \\Delta D_t)^2\n579: \n580: $$\n581: \n582: Taking expectations (and using $\\mathbb{E}[\\Delta C_t | k_t] = \\mathbb{E}[\\Delta D_t | k_t] = 0$):\n583: \n584: $$\n585: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + \\text{Var}(C_t - D_t | k_t)\n586: \n587: $$\n588: \n589: **Step 6b: Rigorous Variance Bound Using Law of Total Variance**\n590: \n591: Since $D_t$ depends on $C_t$ (deaths are drawn from the intermediate population), we use the law of total variance:\n592: \n593: $$\n594: \\text{Var}(C_t - D_t | k_t) = \\mathbb{E}[\\text{Var}(C_t - D_t | C_t, k_t)] + \\text{Var}(\\mathbb{E}[C_t - D_t | C_t, k_t])\n595: \n596: $$\n597: \n598: **Term 1: Conditional variance**\n599: \n600: From the two-stage model, conditioned on $C_t$:\n601: \n602: $$\n603: \\text{Var}(C_t - D_t | C_t, k_t) = \\text{Var}(D_t | C_t, k_t)\n604: \n605: $$\n606: \n607: For binomial-like death processes:\n608: \n609: $$\n610: \\text{Var}(D_t | C_t, k_t) \\leq \\mathbb{E}[D_t | C_t, k_t] = \\bar{p}_{\\text{kill}}(N + C_t)(N + C_t)\n611: \n612: $$\n613: \n614: Taking expectations over $C_t$:\n615: \n616: $$\n617: \\mathbb{E}[\\text{Var}(D_t | C_t, k_t)] \\leq \\mathbb{E}[\\bar{p}_{\\text{kill}}(N + C_t)(N + C_t)] \\leq \\bar{p}_{\\max} \\mathbb{E}[N + C_t] = \\bar{p}_{\\max}(N + \\lambda_{\\text{clone}}(k_t) k_t)\n618: \n619: $$\n620: \n621: where $\\bar{p}_{\\max} := \\sup_{k'} \\bar{p}_{\\text{kill}}(k')$. Thus:\n622: \n623: $$\n624: \\mathbb{E}[\\text{Var}(C_t - D_t | C_t, k_t)] \\leq \\bar{p}_{\\max} N (1 + \\lambda_{\\max})\n625: \n626: $$\n627: \n628: **Term 2: Variance of conditional expectation**\n629: \n630: Define $h(c) := c - g(c) = c - \\bar{p}_{\\text{kill}}(N + c)(N + c)$ where $g$ is the death function from Step 4.\n631: \n632: Then:\n633: \n634: $$\n635: \\text{Var}(\\mathbb{E}[C_t - D_t | C_t, k_t]) = \\text{Var}(h(C_t) | k_t)\n636: \n637: $$\n638: \n639: **Rigorous bound via Taylor expansion:**\n640: \n641: Let $\\mu_c := \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$. Expand $h(C_t)$ around $\\mu_c$ using Taylor's theorem:\n642: \n643: $$\n644: h(C_t) = h(\\mu_c) + h'(\\mu_c)(C_t - \\mu_c) + \\frac{1}{2}h''(\\xi_t)(C_t - \\mu_c)^2\n645: \n646: $$\n647: \n648: where $\\xi_t$ is between $C_t$ and $\\mu_c$.\n649: \n650: Taking the variance (noting that $\\mathbb{E}[C_t - \\mu_c | k_t] = 0$):\n651: \n652: $$\n653: \\text{Var}(h(C_t) | k_t) = \\mathbb{E}\\left[\\left(h'(\\mu_c)(C_t - \\mu_c) + \\frac{1}{2}h''(\\xi_t)(C_t - \\mu_c)^2\\right)^2 \\bigg| k_t\\right]\n654: \n655: $$\n656: \n657: Expanding the square and using $(a+b)^2 \\leq 2a^2 + 2b^2$:\n658: \n659: $$\n660: \\text{Var}(h(C_t) | k_t) \\leq 2[h'(\\mu_c)]^2 \\text{Var}(C_t | k_t) + 2\\mathbb{E}\\left[\\frac{1}{4}[h''(\\xi_t)]^2(C_t - \\mu_c)^4 \\bigg| k_t\\right]\n661: \n662: $$\n663: \n664: **Bounding the derivatives:**\n665: \n666: The function $h$ has derivatives:\n667: - $h'(c) = 1 - g'(c)$, with $|h'(c)| \\leq 1 + L_g^{(1)}$ (from Lipschitz property of $g$)\n668: - $h''(c) = -g''(c)$, with $|h''(c)| \\leq L_g^{(2)}$\n669: \n670: **Bounding the fourth moment:**\n671: \n672: For Bernoulli cloning, $C_t$ is distributed as a sum of $k_t$ independent Bernoulli trials with individual success probability $p_t = \\lambda_{\\text{clone}}(k_t)$. Thus $C_t \\sim \\text{Binomial}(k_t, p_t)$ with mean $\\mu_c = k_t p_t$ and variance $\\sigma_c^2 = k_t p_t(1-p_t) \\leq \\mu_c$.\n673: \n674: The fourth central moment of a binomial distribution is:\n675: \n676: $$\n677: \\mu_4 = \\mathbb{E}[(C_t - \\mu_c)^4 | k_t] = 3\\sigma_c^4 + \\sigma_c^2(1 - 6p_t(1-p_t))\n678: \n679: $$\n680: \n681: Since $0 \\leq p_t \\leq 1$, we have $6p_t(1-p_t) \\leq 3/2$, so $1 - 6p_t(1-p_t) \\geq -1/2$. Therefore:\n682: \n683: $$\n684: \\mu_4 \\leq 3\\sigma_c^4 + \\sigma_c^2 \\leq 3\\mu_c^2 + \\mu_c\n685: \n686: $$\n687: \n688: Since $\\mu_c = \\lambda_{\\text{clone}}(k_t) k_t \\leq \\lambda_{\\max} N$, this gives:\n689: \n690: $$\n691: \\mu_4 \\leq 3(\\lambda_{\\max} N)^2 + \\lambda_{\\max} N\n692: \n693: $$\n694: \n695: where we used $\\sigma_c^2 \\leq \\mu_c$.\n696: \n697: Therefore:\n698: \n699: $$\n700: \\text{Var}(h(C_t) | k_t) \\leq 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{1}{2}(L_g^{(2)})^2 (3(\\lambda_{\\max} N)^2 + \\lambda_{\\max} N)\n701: \n702: $$\n703: \n704: $$\n705: = 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{3}{2}(L_g^{(2)})^2 (\\lambda_{\\max} N)^2 + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} N\n706: \n707: $$\n708: \n709: **Combined variance bound:**\n710: \n711: Combining the two terms from the law of total variance:\n712: \n713: $$\n714: \\text{Var}(C_t - D_t | k_t) \\leq \\bar{p}_{\\max} N (1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{3}{2}(L_g^{(2)})^2 (\\lambda_{\\max} N)^2 + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} N\n715: \n716: $$\n717: \n718: Collecting the $O(N)$ terms:\n719: \n720: $$\n721: = N\\left[\\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}\\right] + \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2\n722: \n723: $$\n724: \n725: Define the variance constant and the $O(1)$ remainder:\n726: \n727: $$\n728: C_{\\text{var}} := \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} = O(1)\n729: \n730: $$\n731: \n732: $$\n733: C_2 := \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2 = O(1) \\quad \\text{(for density-dependent rates with } L_g^{(2)} = O(N^{-1}))\n734: \n735: $$\n736: \n737: Then:\n738: \n739: $$\n740: \\text{Var}(C_t - D_t | k_t) \\leq C_{\\text{var}} N + C_2\n741: \n742: $$\n743: \n744: **Step 6c: Bound the Drift Term**\n745: \n746: From Step 5, we have:\n747: \n748: $$\n749: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq \\epsilon |k_t - k_*|\n750: \n751: $$\n752: \n753: where $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$.\n754: \n755: **Key requirement:** For contraction, we need $\\epsilon < 1$. Expanding:\n756: \n757: $$\n758: \\epsilon = L_\\lambda N + \\lambda_{\\text{clone}}^* + 2L_p L_\\lambda N^2 + O(N)\n759: \n760: $$\n761: \n762: The dominant term is $2L_p L_\\lambda N^2$. Thus, $\\epsilon < 1$ requires:\n763: \n764: $$\n765: L_p L_\\lambda \\ll \\frac{1}{N^2}\n766: \n767: $$\n768: \n769: **Physical interpretation:** This condition states that the product of Lipschitz constants must scale as $O(1/N^2)$. This is natural if rates depend on densities $k/N$ rather than absolute counts, giving $L_p, L_\\lambda \\sim O(1/N)$.\n770: \n771: **Step 6d: Final Lyapunov Inequality (with Error Term)**\n772: \n773: From Step 6a:\n774: \n775: $$\n776: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + \\text{Var}(C_t - D_t | k_t)\n777: \n778: $$\n779: \n780: From Step 5, we have:\n781: \n782: $$\n783: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq \\epsilon |k_t - k_*| + \\mathcal{E}_{\\max}\n784: \n785: $$\n786: \n787: Thus:\n788: \n789: $$\n790: (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 \\leq (\\epsilon |k_t - k_*| + \\mathcal{E}_{\\max})^2 = \\epsilon^2 (k_t - k_*)^2 + 2\\epsilon \\mathcal{E}_{\\max} |k_t - k_*| + \\mathcal{E}_{\\max}^2\n791: \n792: $$\n793: \n794: From Step 6b:\n795: \n796: $$\n797: \\text{Var}(C_t - D_t | k_t) \\leq C_{\\text{var}} N + C_2\n798: \n799: $$\n800: \n801: Combining:\n802: \n803: $$\n804: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq \\epsilon^2 (k_t - k_*)^2 + 2\\epsilon \\mathcal{E}_{\\max} |k_t - k_*| + \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N + C_2\n805: \n806: $$\n807: \n808: **Bounding the cross-term using Young's inequality:**\n809: \n810: We use the general Young's inequality for products: $2ab \\leq \\delta a^2 + (1/\\delta)b^2$ for any $\\delta > 0$.\n811: \n812: The squared drift term is $(A + B)^2$ where $A = \\epsilon |k_t - k_*|$ and $B = \\mathcal{E}_{\\max}$:\n813: \n814: $$\n815: (A + B)^2 = A^2 + 2AB + B^2 \\leq A^2 + \\delta A^2 + \\frac{1}{\\delta}B^2 + B^2 = (1 + \\delta)A^2 + \\left(1 + \\frac{1}{\\delta}\\right)B^2\n816: \n817: $$\n818: \n819: Choosing $\\delta = 1/\\epsilon$ (valid since $\\epsilon > 0$):\n820: \n821: $$\n822: (A + B)^2 \\leq \\left(1 + \\frac{1}{\\epsilon}\\right)\\epsilon^2 (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 = (\\epsilon^2 + \\epsilon)(k_t - k_*)^2 + (1 + \\epsilon)\\mathcal{E}_{\\max}^2\n823: \n824: $$\n825: \n826: Combining all terms:\n827: \n828: $$\n829: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (\\epsilon^2 + \\epsilon) (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N + C_2\n830: \n831: $$\n832: \n833: **Contraction condition:** For contraction, we require:\n834: \n835: $$\n836: \\epsilon^2 + \\epsilon < 1\n837: \n838: $$\n839: \n840: Solving: $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (golden ratio minus 1).\n841: \n842: **Derivation of the contraction rate $\\kappa_{\\text{mass}}$:**\n843: \n844: From the inequality above, we have shown:\n845: \n846: $$\n847: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (\\epsilon^2 + \\epsilon) (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N\n848: \n849: $$\n850: \n851: To express this in the standard form of a Lyapunov drift inequality:\n852: \n853: $$\n854: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (1 - 2\\kappa_{\\text{mass}}) (k_t - k_*)^2 + C_{\\text{mass}}\n855: \n856: $$\n857: \n858: we require the contraction coefficient to satisfy:\n859: \n860: $$\n861: 1 - 2\\kappa_{\\text{mass}} = \\epsilon^2 + \\epsilon\n862: \n863: $$\n864: \n865: Solving for $\\kappa_{\\text{mass}}$:\n866: \n867: $$\n868: 2\\kappa_{\\text{mass}} = 1 - (\\epsilon^2 + \\epsilon) = 1 - \\epsilon(1 + \\epsilon)\n869: \n870: $$\n871: \n872: Thus:\n873: \n874: $$\n875: \\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}\n876: \n877: $$\n878: \n879: For positivity of $\\kappa_{\\text{mass}}$, we need $\\epsilon^2 + \\epsilon < 1$, which is satisfied when $\\epsilon < \\frac{\\sqrt{5}-1}{2}$.\n880: \n881: The final Lyapunov inequality is:\n882: \n883: $$\n884: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (1 - 2\\kappa_{\\text{mass}}) (k_t - k_*)^2 + C_{\\text{mass}}\n885: \n886: $$\n887: \n888: where:\n889: \n890: $$\n891: C_{\\text{mass}} := C_{\\text{var}} N + C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2\n892: \n893: $$\n894: \n895: **Scaling of $C_{\\text{mass}}$:** For density-dependent death rates $\\bar{p}_{\\text{kill}}(k') = p(k'/N)$, the second derivative satisfies $L_g^{(2)} = O(N^{-1})$ (as established in the Constants and Assumptions section at the beginning of this proof). Therefore:\n896: \n897: $$\n898: \\mathcal{E}_{\\max} = \\frac{L_g^{(2)} \\lambda_{\\max} N}{2} = O(1), \\quad \\mathcal{E}_{\\max}^2 = O(1)\n899: \n900: $$\n901: \n902: From Step 6b, $C_2 = \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2 = O(1)$ as well.\n903: \n904: The constant term is:\n905: \n906: $$\n907: C_{\\text{mass}} = C_{\\text{var}} N + C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 = O(N)\n908: \n909: $$\n910: \n911: The $O(N)$ scaling is dominated by the variance term $C_{\\text{var}} N$ from Step 6b, with both $C_2 = O(1)$ and $(1 + \\epsilon) \\mathcal{E}_{\\max}^2 = O(1)$ contributing to the overall constant but not affecting the leading-order scaling.\n912: \n913: We write $C_{\\text{mass}} = C_N \\cdot N$ where:\n914: \n915: $$\n916: C_N := C_{\\text{var}} + \\frac{C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2}{N} = O(1)\n917: \n918: $$\n919: \n920: **Step 7: Final Result and Physical Interpretation**\n921: \n922: Taking total expectation:\n923: \n924: $$\n925: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n926: \n927: $$\n928: \n929: where:\n930: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n931: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n932: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n933: - $L_\\lambda$ is the Lipschitz constant of the cloning rate $\\lambda_{\\text{clone}}(k)$\n934: - $L_p$ is the Lipschitz constant of the killing rate $\\bar{p}_{\\text{kill}}(k')$\n935: - $L_g^{(2)}$ is the bound on the second derivative of $g(c) = \\bar{p}_{\\text{kill}}(N + c)(N + c)$\n936: - $N$ is the total number of walkers (alive + dead)\n937: \n938: **Assumption for positivity of $\\kappa_{\\text{mass}}$:** We require $\\epsilon^2 + \\epsilon < 1$, which gives $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$. From Step 6c, this requires:\n939: \n940: $$\n941: L_p L_\\lambda = O(N^{-2})\n942: \n943: $$\n944: \n945: **Physical plausibility of the assumption:** This condition is natural when birth/death rates depend on **densities** rather than absolute counts. If:\n946: \n947: $$\n948: \\lambda_{\\text{clone}}(k) = \\lambda(\\rho) \\quad \\text{where } \\rho = k/N\n949: \n950: $$\n951: \n952: $$\n953: \\bar{p}_{\\text{kill}}(k') = p(\\rho') \\quad \\text{where } \\rho' = k'/N\n954: \n955: $$\n956: \n957: Then the Lipschitz constants with respect to $k$ are:\n958: \n959: $$\n960: L_\\lambda = \\frac{1}{N} \\sup_\\rho |\\lambda'(\\rho)|, \\quad L_p = \\frac{1}{N} \\sup_{\\rho'} |p'(\\rho')|\n961: \n962: $$\n963: \n964: Thus $L_p L_\\lambda = O(N^{-2})$, and the condition is automatically satisfied for any smooth density-dependent rates.\n965: \n966: **Complete parameter regime:** The full expression for $\\epsilon$ from line 390 is:\n967: \n968: $$\n969: \\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)\n970: \n971: $$\n972: \n973: Expanding this with the density-dependent scaling $L_p = O(1/N)$, $L_\\lambda = O(1/N)$:\n974: \n975: $$\n976: \\epsilon = (1 + O(1) + \\bar{p}^*)(O(1) + \\lambda^*) = (1+\\bar{p}^*)\\lambda^* + O(N^{-1})\n977: \n978: $$\n979: \n980: For $\\epsilon < 0.618$, we require:\n981: \n982: $$\n983: (1 + \\bar{p}_{\\text{kill}}^*) \\lambda_{\\text{clone}}^* < 0.6\n984: \n985: $$\n986: \n987: **Physical interpretation:** This condition requires that the product of equilibrium cloning rate and killing probability is not too large. For typical QSD parameters where $\\bar{p}^* \\sim 0.1$ (10% death probability per step) and $\\lambda^* \\sim 0.5$ (50% cloning rate), we have $(1.1)(0.5) = 0.55 < 0.618$ \u2713. The condition is satisfied for reasonable algorithm parameters and becomes easier to satisfy as $N \\to \\infty$ due to the $O(1/N)$ corrections.\n988: \n989: **Convergence:** This is the standard drift inequality for squared error, which implies exponential convergence of $\\mathbb{E}[(k_t - k_*)^2]$ to the stationary distribution with $\\mathbb{E}[(k_\\infty - k_*)^2] = O(C_{\\text{mass}}/\\kappa_{\\text{mass}}) = O(N/\\kappa_{\\text{mass}})$.\n990: ",
      "metadata": {
        "label": "proof-lem-mass-contraction-revival-death"
      },
      "section": "## 2. Lemma A: Mass Contraction from Revival and Death",
      "raw_directive": "230: ### Proof of Lemma A\n231: \n232: :::{prf:proof}\n233: :label: proof-lem-mass-contraction-revival-death\n234: \n235: **Constants and Assumptions**\n236: \n237: The proof uses the following constants and assumptions:\n238: \n239: - **$\\lambda_{\\max}$**: Upper bound on the cloning rate: $\\lambda_{\\text{clone}}(k) \\leq \\lambda_{\\max}$ for all $k$\n240: - **$\\bar{p}_{\\max}$**: Upper bound on the killing probability: $\\bar{p}_{\\text{kill}}(k') \\leq \\bar{p}_{\\max}$ for all $k'$\n241: - **$L_\\lambda$**: Lipschitz constant of the cloning rate: $|\\lambda_{\\text{clone}}(k_1) - \\lambda_{\\text{clone}}(k_2)| \\leq L_\\lambda |k_1 - k_2|$\n242: - **$L_p$**: Lipschitz constant of the killing probability: $|\\bar{p}_{\\text{kill}}(k'_1) - \\bar{p}_{\\text{kill}}(k'_2)| \\leq L_p |k'_1 - k'_2|$\n243: - **$L_g^{(1)}$**: Bound on the first derivative of $g(c) = \\bar{p}_{\\text{kill}}(N+c)(N+c)$: $|g'(c)| \\leq L_g^{(1)}$\n244: - **$L_g^{(2)}$**: Bound on the second derivative of $g(c)$: $|g''(c)| \\leq L_g^{(2)}$\n245: \n246: **Assumption on density-dependent scaling:** For rates that depend on densities $\\rho = k/N$, we have $L_g^{(2)} = O(N^{-1})$.\n247: \n248: ---\n249: \n250: **Explicit Model Definition: Two-Stage Process**\n251: \n252: The Fragile Gas update from time $t$ to $t+1$ consists of two sequential stages:\n253: \n254: 1. **Stage 1 - Births (Cloning + Revival)**: Starting with $k_t$ alive walkers, apply the cloning operator $\\Psi_{\\text{clone}}$ which includes:\n255:    - Guaranteed revival of all $(N - k_t)$ dead walkers (Axiom of Guaranteed Revival)\n256:    - Stochastic cloning of alive walkers, creating $C_t$ new walkers\n257: \n258:    After Stage 1, the intermediate population size is:\n259: \n260:    $$\n261:    k'_t := N + C_t\n262:    $$\n263: \n264: 2. **Stage 2 - Deaths (Kinetic + Boundary)**: Apply the kinetic operator $\\Psi_{\\text{kin}}$ to the intermediate population of size $k'_t$:\n265:    - Langevin diffusion moves walkers\n266:    - Boundary killing removes $D_t$ walkers that exit $\\mathcal{X}_{\\text{valid}}$\n267: \n268:    After Stage 2, the final population size is:\n269: \n270:    $$\n271:    k_{t+1} = k'_t - D_t = N + C_t - D_t\n272:    $$\n273: \n274: **Key Insight:** Deaths $D_t$ are drawn from the intermediate population $k'_t = N + C_t$, NOT from the initial population $k_t$. This temporal ordering is critical for the correct drift calculation.\n275: \n276: **Setup: Mass Balance Equation**\n277: \n278: The mass evolution is:\n279: \n280: $$\n281: k_{t+1} = N + C_t - D_t\n282: \n283: $$\n284: \n285: where:\n286: - $C_t \\geq 0$ is the number of cloning events from Stage 1 (random variable)\n287: - $D_t \\geq 0$ is the number of deaths from Stage 2 (random variable, dependent on $C_t$)\n288: \n289: **Step 1: Expected Deaths (Two-Stage Expectation)**\n290: \n291: Deaths occur when walkers from the intermediate population $k'_t = N + C_t$ exit the valid domain during the kinetic stage.\n292: \n293: Let $\\bar{p}_{\\text{kill}}(k')$ denote the average per-walker killing probability when the population size is $k'$. Then, conditioned on $C_t$:\n294: \n295: $$\n296: \\mathbb{E}[D_t | C_t, k_t] = \\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t)\n297: \n298: $$\n299: \n300: Taking the expectation over $C_t$:\n301: \n302: $$\n303: \\mathbb{E}[D_t | k_t] = \\mathbb{E}_{C_t}[\\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t) | k_t]\n304: \n305: $$\n306: \n307: **Step 2: Expected Cloning Events**\n308: \n309: Cloning events occur in Stage 1. Let $\\lambda_{\\text{clone}}(k_t)$ denote the expected per-walker cloning rate when there are $k_t$ alive walkers:\n310: \n311: $$\n312: \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) \\cdot k_t\n313: \n314: $$\n315: \n316: **Assumption (Lipschitz Continuity of Cloning Rate):** The cloning rate is Lipschitz continuous:\n317: \n318: $$\n319: |\\lambda_{\\text{clone}}(k_1) - \\lambda_{\\text{clone}}(k_2)| \\leq L_\\lambda |k_1 - k_2|\n320: \n321: $$\n322: \n323: **Step 3: Define the Equilibrium**\n324: \n325: At equilibrium, the expected mass change is zero: $\\mathbb{E}[k_{t+1} - k_* | k_t = k_*] = 0$.\n326: \n327: From the mass balance $k_{t+1} = N + C_t - D_t$:\n328: \n329: $$\n330: \\mathbb{E}[N + C_t - D_t | k_* ] = k_*\n331: \n332: $$\n333: \n334: Using the two-stage expectation for deaths:\n335: \n336: $$\n337: N + \\mathbb{E}[C_t | k_*] - \\mathbb{E}_{C_t}[\\mathbb{E}[D_t | C_t, k_*]] = k_*\n338: \n339: $$\n340: \n341: Let $\\lambda_{\\text{clone}}^* := \\lambda_{\\text{clone}}(k_*)$ and $C_* := \\mathbb{E}[C_t | k_*] = \\lambda_{\\text{clone}}^* k_*$.\n342: \n343: At equilibrium, the intermediate population is $k'^* = N + C_*$, and:\n344: \n345: $$\n346: \\bar{p}_{\\text{kill}}^* := \\bar{p}_{\\text{kill}}(k'^*) = \\bar{p}_{\\text{kill}}(N + \\lambda_{\\text{clone}}^* k_*)\n347: \n348: $$\n349: \n350: The equilibrium condition becomes:\n351: \n352: $$\n353: N + \\lambda_{\\text{clone}}^* k_* - \\bar{p}_{\\text{kill}}^* \\cdot (N + \\lambda_{\\text{clone}}^* k_*) = k_*\n354: \n355: $$\n356: \n357: Simplifying:\n358: \n359: $$\n360: (N + \\lambda_{\\text{clone}}^* k_*)(1 - \\bar{p}_{\\text{kill}}^*) = k_*\n361: \n362: $$\n363: \n364: $$\n365: N + \\lambda_{\\text{clone}}^* k_* = \\frac{k_*}{1 - \\bar{p}_{\\text{kill}}^*}\n366: \n367: $$\n368: \n369: **Clarification on the Equilibrium Condition:**\n370: \n371: This equilibrium condition may appear circular since both $k_*$ and $\\bar{p}_{\\text{kill}}^*$ depend on the equilibrium state. However, it is **not circular**\u2014it is a **self-consistency equation** that uniquely determines $k_*$.\n372: \n373: To see this, note that $\\bar{p}_{\\text{kill}}^*$ is evaluated at the **intermediate population** $k'^* = N + \\lambda_{\\text{clone}}^* k_*$, which itself depends on $k_*$. The equilibrium condition can be rewritten as:\n374: \n375: $$\n376: f(k_*) := (N + \\lambda_{\\text{clone}}(k_*) k_*)(1 - \\bar{p}_{\\text{kill}}(N + \\lambda_{\\text{clone}}(k_*) k_*)) - k_* = 0\n377: \n378: $$\n379: \n380: For physically reasonable rate functions $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k')$, this equation has a unique positive solution $k_* \\in (0, N)$, which defines the QSD equilibrium mass. The proof of Lemma A then shows that this equilibrium is **stable**: the mass $k_t$ converges to $k_*$ exponentially fast.\n381: \n382: **Step 4: Expected Mass Change (Two-Stage Calculation with Taylor Expansion)**\n383: \n384: The deviation from equilibrium is:\n385: \n386: $$\n387: k_{t+1} - k_* = N + C_t - D_t - k_*\n388: \n389: $$\n390: \n391: Taking expectations:\n392: \n393: $$\n394: \\mathbb{E}[k_{t+1} - k_* | k_t] = N + \\mathbb{E}[C_t | k_t] - \\mathbb{E}[D_t | k_t] - k_*\n395: \n396: $$\n397: \n398: From Step 2: $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$.\n399: \n400: From Step 1, using the law of total expectation:\n401: \n402: $$\n403: \\mathbb{E}[D_t | k_t] = \\mathbb{E}_{C_t}[\\bar{p}_{\\text{kill}}(N + C_t) \\cdot (N + C_t) | k_t]\n404: \n405: $$\n406: \n407: **Rigorous expectation calculation via Taylor expansion:**\n408: \n409: Define the death function:\n410: \n411: $$\n412: g(c) := \\bar{p}_{\\text{kill}}(N + c) \\cdot (N + c)\n413: \n414: $$\n415: \n416: **Assumption:** $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with bounded derivatives:\n417: - $|g'(c)| \\leq L_g^{(1)} < \\infty$\n418: - $|g''(c)| \\leq L_g^{(2)} < \\infty$\n419: \n420: Let $\\bar{C}_t := \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$. By Taylor's theorem:\n421: \n422: $$\n423: g(C_t) = g(\\bar{C}_t) + g'(\\bar{C}_t)(C_t - \\bar{C}_t) + \\frac{1}{2}g''(\\xi_t)(C_t - \\bar{C}_t)^2\n424: \n425: $$\n426: \n427: where $\\xi_t$ is between $C_t$ and $\\bar{C}_t$.\n428: \n429: Taking expectations:\n430: \n431: $$\n432: \\mathbb{E}[D_t | k_t] = \\mathbb{E}[g(C_t) | k_t] = g(\\bar{C}_t) + \\frac{1}{2}\\mathbb{E}[g''(\\xi_t)(C_t - \\bar{C}_t)^2 | k_t]\n433: \n434: $$\n435: \n436: The second-order term is bounded:\n437: \n438: $$\n439: \\left|\\frac{1}{2}\\mathbb{E}[g''(\\xi_t)(C_t - \\bar{C}_t)^2 | k_t]\\right| \\leq \\frac{L_g^{(2)}}{2} \\text{Var}(C_t | k_t)\n440: \n441: $$\n442: \n443: **Model for cloning variance:** Assume cloning events are independent Bernoulli trials, giving:\n444: \n445: $$\n446: \\text{Var}(C_t | k_t) \\leq \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t \\leq \\lambda_{\\max} N\n447: \n448: $$\n449: \n450: where $\\lambda_{\\max} := \\sup_{k} \\lambda_{\\text{clone}}(k)$.\n451: \n452: Thus:\n453: \n454: $$\n455: \\mathbb{E}[D_t | k_t] = g(\\bar{C}_t) + \\mathcal{E}_{\\text{drift}}\n456: \n457: $$\n458: \n459: where the drift error satisfies:\n460: \n461: $$\n462: |\\mathcal{E}_{\\text{drift}}| \\leq \\frac{L_g^{(2)} \\lambda_{\\max} N}{2}\n463: \n464: $$\n465: \n466: Define the intermediate population mean:\n467: \n468: $$\n469: \\bar{k}'_t := N + \\bar{C}_t = N + \\lambda_{\\text{clone}}(k_t) k_t\n470: \n471: $$\n472: \n473: Then:\n474: \n475: $$\n476: \\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(\\bar{k}'_t) \\cdot \\bar{k}'_t + \\mathcal{E}_{\\text{drift}}\n477: \n478: $$\n479: \n480: **Step 5: Drift Analysis Using Equilibrium (with Error Term)**\n481: \n482: Substituting into the expected mass change:\n483: \n484: $$\n485: \\mathbb{E}[k_{t+1} - k_* | k_t] = N + \\lambda_{\\text{clone}}(k_t) k_t - \\bar{p}_{\\text{kill}}(\\bar{k}'_t) \\cdot \\bar{k}'_t - \\mathcal{E}_{\\text{drift}} - k_*\n486: \n487: $$\n488: \n489: $$\n490: = \\bar{k}'_t (1 - \\bar{p}_{\\text{kill}}(\\bar{k}'_t)) - k_* - \\mathcal{E}_{\\text{drift}}\n491: \n492: $$\n493: \n494: From Step 3, at equilibrium $k'^* (1 - \\bar{p}_{\\text{kill}}^*) = k_*$. Thus:\n495: \n496: $$\n497: \\mathbb{E}[k_{t+1} - k_* | k_t] = f(\\bar{k}'_t) - f(k'^*) - \\mathcal{E}_{\\text{drift}}\n498: \n499: $$\n500: \n501: where $f(k') := k'(1 - \\bar{p}_{\\text{kill}}(k'))$.\n502: \n503: **Lipschitz continuity of $f$:** By the same calculation as before, $f$ has Lipschitz constant:\n504: \n505: $$\n506: L_f = 1 + 2L_p N + \\bar{p}_{\\text{kill}}^*\n507: \n508: $$\n509: \n510: From Step 2: $|\\bar{k}'_t - k'^*| \\leq (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*|$.\n511: \n512: Therefore:\n513: \n514: $$\n515: |f(\\bar{k}'_t) - f(k'^*)| \\leq L_f \\cdot (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*|\n516: \n517: $$\n518: \n519: Combining with the drift error from Step 4:\n520: \n521: $$\n522: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq L_f \\cdot (L_\\lambda N + \\lambda_{\\text{clone}}^*) |k_t - k_*| + \\frac{L_g^{(2)} \\lambda_{\\max} N}{2}\n523: \n524: $$\n525: \n526: Define:\n527: - $\\epsilon := L_f (L_\\lambda N + \\lambda_{\\text{clone}}^*) = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n528: - $\\mathcal{E}_{\\max} := L_g^{(2)} \\lambda_{\\max} N / 2$\n529: \n530: **Step 6: Lyapunov Function - Squared Error Contraction**\n531: \n532: To properly handle the stochastic fluctuations, we use a **Lyapunov function** approach. Define:\n533: \n534: $$\n535: V(k_t) := (k_t - k_*)^2\n536: \n537: $$\n538: \n539: We will prove a drift inequality:\n540: \n541: $$\n542: \\mathbb{E}[V(k_{t+1}) | k_t] \\leq (1 - \\kappa_{\\text{mass}}) V(k_t) + C_{\\text{mass}}\n543: \n544: $$\n545: \n546: for some constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$.\n547: \n548: **Step 6a: Expansion of Expected Squared Error**\n549: \n550: The mass deviation at time $t+1$ is:\n551: \n552: $$\n553: k_{t+1} - k_* = N + C_t - D_t - k_*\n554: \n555: $$\n556: \n557: From Step 4, using the equilibrium condition:\n558: \n559: $$\n560: k_{t+1} - k_* = (\\bar{p}_{\\text{kill}}^* - \\lambda_{\\text{clone}}^*) k_* - (k_t - k_*) + C_t - D_t\n561: \n562: $$\n563: \n564: Define:\n565: - $\\Delta C_t := C_t - \\mathbb{E}[C_t | k_t]$ (cloning fluctuation)\n566: - $\\Delta D_t := D_t - \\mathbb{E}[D_t | k_t]$ (death fluctuation)\n567: \n568: Then:\n569: \n570: $$\n571: k_{t+1} - k_* = \\mathbb{E}[k_{t+1} - k_* | k_t] + \\Delta C_t - \\Delta D_t\n572: \n573: $$\n574: \n575: Squaring:\n576: \n577: $$\n578: (k_{t+1} - k_*)^2 = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + 2\\mathbb{E}[k_{t+1} - k_* | k_t](\\Delta C_t - \\Delta D_t) + (\\Delta C_t - \\Delta D_t)^2\n579: \n580: $$\n581: \n582: Taking expectations (and using $\\mathbb{E}[\\Delta C_t | k_t] = \\mathbb{E}[\\Delta D_t | k_t] = 0$):\n583: \n584: $$\n585: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + \\text{Var}(C_t - D_t | k_t)\n586: \n587: $$\n588: \n589: **Step 6b: Rigorous Variance Bound Using Law of Total Variance**\n590: \n591: Since $D_t$ depends on $C_t$ (deaths are drawn from the intermediate population), we use the law of total variance:\n592: \n593: $$\n594: \\text{Var}(C_t - D_t | k_t) = \\mathbb{E}[\\text{Var}(C_t - D_t | C_t, k_t)] + \\text{Var}(\\mathbb{E}[C_t - D_t | C_t, k_t])\n595: \n596: $$\n597: \n598: **Term 1: Conditional variance**\n599: \n600: From the two-stage model, conditioned on $C_t$:\n601: \n602: $$\n603: \\text{Var}(C_t - D_t | C_t, k_t) = \\text{Var}(D_t | C_t, k_t)\n604: \n605: $$\n606: \n607: For binomial-like death processes:\n608: \n609: $$\n610: \\text{Var}(D_t | C_t, k_t) \\leq \\mathbb{E}[D_t | C_t, k_t] = \\bar{p}_{\\text{kill}}(N + C_t)(N + C_t)\n611: \n612: $$\n613: \n614: Taking expectations over $C_t$:\n615: \n616: $$\n617: \\mathbb{E}[\\text{Var}(D_t | C_t, k_t)] \\leq \\mathbb{E}[\\bar{p}_{\\text{kill}}(N + C_t)(N + C_t)] \\leq \\bar{p}_{\\max} \\mathbb{E}[N + C_t] = \\bar{p}_{\\max}(N + \\lambda_{\\text{clone}}(k_t) k_t)\n618: \n619: $$\n620: \n621: where $\\bar{p}_{\\max} := \\sup_{k'} \\bar{p}_{\\text{kill}}(k')$. Thus:\n622: \n623: $$\n624: \\mathbb{E}[\\text{Var}(C_t - D_t | C_t, k_t)] \\leq \\bar{p}_{\\max} N (1 + \\lambda_{\\max})\n625: \n626: $$\n627: \n628: **Term 2: Variance of conditional expectation**\n629: \n630: Define $h(c) := c - g(c) = c - \\bar{p}_{\\text{kill}}(N + c)(N + c)$ where $g$ is the death function from Step 4.\n631: \n632: Then:\n633: \n634: $$\n635: \\text{Var}(\\mathbb{E}[C_t - D_t | C_t, k_t]) = \\text{Var}(h(C_t) | k_t)\n636: \n637: $$\n638: \n639: **Rigorous bound via Taylor expansion:**\n640: \n641: Let $\\mu_c := \\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$. Expand $h(C_t)$ around $\\mu_c$ using Taylor's theorem:\n642: \n643: $$\n644: h(C_t) = h(\\mu_c) + h'(\\mu_c)(C_t - \\mu_c) + \\frac{1}{2}h''(\\xi_t)(C_t - \\mu_c)^2\n645: \n646: $$\n647: \n648: where $\\xi_t$ is between $C_t$ and $\\mu_c$.\n649: \n650: Taking the variance (noting that $\\mathbb{E}[C_t - \\mu_c | k_t] = 0$):\n651: \n652: $$\n653: \\text{Var}(h(C_t) | k_t) = \\mathbb{E}\\left[\\left(h'(\\mu_c)(C_t - \\mu_c) + \\frac{1}{2}h''(\\xi_t)(C_t - \\mu_c)^2\\right)^2 \\bigg| k_t\\right]\n654: \n655: $$\n656: \n657: Expanding the square and using $(a+b)^2 \\leq 2a^2 + 2b^2$:\n658: \n659: $$\n660: \\text{Var}(h(C_t) | k_t) \\leq 2[h'(\\mu_c)]^2 \\text{Var}(C_t | k_t) + 2\\mathbb{E}\\left[\\frac{1}{4}[h''(\\xi_t)]^2(C_t - \\mu_c)^4 \\bigg| k_t\\right]\n661: \n662: $$\n663: \n664: **Bounding the derivatives:**\n665: \n666: The function $h$ has derivatives:\n667: - $h'(c) = 1 - g'(c)$, with $|h'(c)| \\leq 1 + L_g^{(1)}$ (from Lipschitz property of $g$)\n668: - $h''(c) = -g''(c)$, with $|h''(c)| \\leq L_g^{(2)}$\n669: \n670: **Bounding the fourth moment:**\n671: \n672: For Bernoulli cloning, $C_t$ is distributed as a sum of $k_t$ independent Bernoulli trials with individual success probability $p_t = \\lambda_{\\text{clone}}(k_t)$. Thus $C_t \\sim \\text{Binomial}(k_t, p_t)$ with mean $\\mu_c = k_t p_t$ and variance $\\sigma_c^2 = k_t p_t(1-p_t) \\leq \\mu_c$.\n673: \n674: The fourth central moment of a binomial distribution is:\n675: \n676: $$\n677: \\mu_4 = \\mathbb{E}[(C_t - \\mu_c)^4 | k_t] = 3\\sigma_c^4 + \\sigma_c^2(1 - 6p_t(1-p_t))\n678: \n679: $$\n680: \n681: Since $0 \\leq p_t \\leq 1$, we have $6p_t(1-p_t) \\leq 3/2$, so $1 - 6p_t(1-p_t) \\geq -1/2$. Therefore:\n682: \n683: $$\n684: \\mu_4 \\leq 3\\sigma_c^4 + \\sigma_c^2 \\leq 3\\mu_c^2 + \\mu_c\n685: \n686: $$\n687: \n688: Since $\\mu_c = \\lambda_{\\text{clone}}(k_t) k_t \\leq \\lambda_{\\max} N$, this gives:\n689: \n690: $$\n691: \\mu_4 \\leq 3(\\lambda_{\\max} N)^2 + \\lambda_{\\max} N\n692: \n693: $$\n694: \n695: where we used $\\sigma_c^2 \\leq \\mu_c$.\n696: \n697: Therefore:\n698: \n699: $$\n700: \\text{Var}(h(C_t) | k_t) \\leq 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{1}{2}(L_g^{(2)})^2 (3(\\lambda_{\\max} N)^2 + \\lambda_{\\max} N)\n701: \n702: $$\n703: \n704: $$\n705: = 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{3}{2}(L_g^{(2)})^2 (\\lambda_{\\max} N)^2 + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} N\n706: \n707: $$\n708: \n709: **Combined variance bound:**\n710: \n711: Combining the two terms from the law of total variance:\n712: \n713: $$\n714: \\text{Var}(C_t - D_t | k_t) \\leq \\bar{p}_{\\max} N (1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} N + \\frac{3}{2}(L_g^{(2)})^2 (\\lambda_{\\max} N)^2 + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} N\n715: \n716: $$\n717: \n718: Collecting the $O(N)$ terms:\n719: \n720: $$\n721: = N\\left[\\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}\\right] + \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2\n722: \n723: $$\n724: \n725: Define the variance constant and the $O(1)$ remainder:\n726: \n727: $$\n728: C_{\\text{var}} := \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max} = O(1)\n729: \n730: $$\n731: \n732: $$\n733: C_2 := \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2 = O(1) \\quad \\text{(for density-dependent rates with } L_g^{(2)} = O(N^{-1}))\n734: \n735: $$\n736: \n737: Then:\n738: \n739: $$\n740: \\text{Var}(C_t - D_t | k_t) \\leq C_{\\text{var}} N + C_2\n741: \n742: $$\n743: \n744: **Step 6c: Bound the Drift Term**\n745: \n746: From Step 5, we have:\n747: \n748: $$\n749: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq \\epsilon |k_t - k_*|\n750: \n751: $$\n752: \n753: where $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$.\n754: \n755: **Key requirement:** For contraction, we need $\\epsilon < 1$. Expanding:\n756: \n757: $$\n758: \\epsilon = L_\\lambda N + \\lambda_{\\text{clone}}^* + 2L_p L_\\lambda N^2 + O(N)\n759: \n760: $$\n761: \n762: The dominant term is $2L_p L_\\lambda N^2$. Thus, $\\epsilon < 1$ requires:\n763: \n764: $$\n765: L_p L_\\lambda \\ll \\frac{1}{N^2}\n766: \n767: $$\n768: \n769: **Physical interpretation:** This condition states that the product of Lipschitz constants must scale as $O(1/N^2)$. This is natural if rates depend on densities $k/N$ rather than absolute counts, giving $L_p, L_\\lambda \\sim O(1/N)$.\n770: \n771: **Step 6d: Final Lyapunov Inequality (with Error Term)**\n772: \n773: From Step 6a:\n774: \n775: $$\n776: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] = (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 + \\text{Var}(C_t - D_t | k_t)\n777: \n778: $$\n779: \n780: From Step 5, we have:\n781: \n782: $$\n783: |\\mathbb{E}[k_{t+1} - k_* | k_t]| \\leq \\epsilon |k_t - k_*| + \\mathcal{E}_{\\max}\n784: \n785: $$\n786: \n787: Thus:\n788: \n789: $$\n790: (\\mathbb{E}[k_{t+1} - k_* | k_t])^2 \\leq (\\epsilon |k_t - k_*| + \\mathcal{E}_{\\max})^2 = \\epsilon^2 (k_t - k_*)^2 + 2\\epsilon \\mathcal{E}_{\\max} |k_t - k_*| + \\mathcal{E}_{\\max}^2\n791: \n792: $$\n793: \n794: From Step 6b:\n795: \n796: $$\n797: \\text{Var}(C_t - D_t | k_t) \\leq C_{\\text{var}} N + C_2\n798: \n799: $$\n800: \n801: Combining:\n802: \n803: $$\n804: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq \\epsilon^2 (k_t - k_*)^2 + 2\\epsilon \\mathcal{E}_{\\max} |k_t - k_*| + \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N + C_2\n805: \n806: $$\n807: \n808: **Bounding the cross-term using Young's inequality:**\n809: \n810: We use the general Young's inequality for products: $2ab \\leq \\delta a^2 + (1/\\delta)b^2$ for any $\\delta > 0$.\n811: \n812: The squared drift term is $(A + B)^2$ where $A = \\epsilon |k_t - k_*|$ and $B = \\mathcal{E}_{\\max}$:\n813: \n814: $$\n815: (A + B)^2 = A^2 + 2AB + B^2 \\leq A^2 + \\delta A^2 + \\frac{1}{\\delta}B^2 + B^2 = (1 + \\delta)A^2 + \\left(1 + \\frac{1}{\\delta}\\right)B^2\n816: \n817: $$\n818: \n819: Choosing $\\delta = 1/\\epsilon$ (valid since $\\epsilon > 0$):\n820: \n821: $$\n822: (A + B)^2 \\leq \\left(1 + \\frac{1}{\\epsilon}\\right)\\epsilon^2 (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 = (\\epsilon^2 + \\epsilon)(k_t - k_*)^2 + (1 + \\epsilon)\\mathcal{E}_{\\max}^2\n823: \n824: $$\n825: \n826: Combining all terms:\n827: \n828: $$\n829: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (\\epsilon^2 + \\epsilon) (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N + C_2\n830: \n831: $$\n832: \n833: **Contraction condition:** For contraction, we require:\n834: \n835: $$\n836: \\epsilon^2 + \\epsilon < 1\n837: \n838: $$\n839: \n840: Solving: $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (golden ratio minus 1).\n841: \n842: **Derivation of the contraction rate $\\kappa_{\\text{mass}}$:**\n843: \n844: From the inequality above, we have shown:\n845: \n846: $$\n847: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (\\epsilon^2 + \\epsilon) (k_t - k_*)^2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 + C_{\\text{var}} N\n848: \n849: $$\n850: \n851: To express this in the standard form of a Lyapunov drift inequality:\n852: \n853: $$\n854: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (1 - 2\\kappa_{\\text{mass}}) (k_t - k_*)^2 + C_{\\text{mass}}\n855: \n856: $$\n857: \n858: we require the contraction coefficient to satisfy:\n859: \n860: $$\n861: 1 - 2\\kappa_{\\text{mass}} = \\epsilon^2 + \\epsilon\n862: \n863: $$\n864: \n865: Solving for $\\kappa_{\\text{mass}}$:\n866: \n867: $$\n868: 2\\kappa_{\\text{mass}} = 1 - (\\epsilon^2 + \\epsilon) = 1 - \\epsilon(1 + \\epsilon)\n869: \n870: $$\n871: \n872: Thus:\n873: \n874: $$\n875: \\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}\n876: \n877: $$\n878: \n879: For positivity of $\\kappa_{\\text{mass}}$, we need $\\epsilon^2 + \\epsilon < 1$, which is satisfied when $\\epsilon < \\frac{\\sqrt{5}-1}{2}$.\n880: \n881: The final Lyapunov inequality is:\n882: \n883: $$\n884: \\mathbb{E}[(k_{t+1} - k_*)^2 | k_t] \\leq (1 - 2\\kappa_{\\text{mass}}) (k_t - k_*)^2 + C_{\\text{mass}}\n885: \n886: $$\n887: \n888: where:\n889: \n890: $$\n891: C_{\\text{mass}} := C_{\\text{var}} N + C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2\n892: \n893: $$\n894: \n895: **Scaling of $C_{\\text{mass}}$:** For density-dependent death rates $\\bar{p}_{\\text{kill}}(k') = p(k'/N)$, the second derivative satisfies $L_g^{(2)} = O(N^{-1})$ (as established in the Constants and Assumptions section at the beginning of this proof). Therefore:\n896: \n897: $$\n898: \\mathcal{E}_{\\max} = \\frac{L_g^{(2)} \\lambda_{\\max} N}{2} = O(1), \\quad \\mathcal{E}_{\\max}^2 = O(1)\n899: \n900: $$\n901: \n902: From Step 6b, $C_2 = \\frac{3}{2}(L_g^{(2)} \\lambda_{\\max} N)^2 = O(1)$ as well.\n903: \n904: The constant term is:\n905: \n906: $$\n907: C_{\\text{mass}} = C_{\\text{var}} N + C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2 = O(N)\n908: \n909: $$\n910: \n911: The $O(N)$ scaling is dominated by the variance term $C_{\\text{var}} N$ from Step 6b, with both $C_2 = O(1)$ and $(1 + \\epsilon) \\mathcal{E}_{\\max}^2 = O(1)$ contributing to the overall constant but not affecting the leading-order scaling.\n912: \n913: We write $C_{\\text{mass}} = C_N \\cdot N$ where:\n914: \n915: $$\n916: C_N := C_{\\text{var}} + \\frac{C_2 + (1 + \\epsilon) \\mathcal{E}_{\\max}^2}{N} = O(1)\n917: \n918: $$\n919: \n920: **Step 7: Final Result and Physical Interpretation**\n921: \n922: Taking total expectation:\n923: \n924: $$\n925: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n926: \n927: $$\n928: \n929: where:\n930: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n931: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n932: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n933: - $L_\\lambda$ is the Lipschitz constant of the cloning rate $\\lambda_{\\text{clone}}(k)$\n934: - $L_p$ is the Lipschitz constant of the killing rate $\\bar{p}_{\\text{kill}}(k')$\n935: - $L_g^{(2)}$ is the bound on the second derivative of $g(c) = \\bar{p}_{\\text{kill}}(N + c)(N + c)$\n936: - $N$ is the total number of walkers (alive + dead)\n937: \n938: **Assumption for positivity of $\\kappa_{\\text{mass}}$:** We require $\\epsilon^2 + \\epsilon < 1$, which gives $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$. From Step 6c, this requires:\n939: \n940: $$\n941: L_p L_\\lambda = O(N^{-2})\n942: \n943: $$\n944: \n945: **Physical plausibility of the assumption:** This condition is natural when birth/death rates depend on **densities** rather than absolute counts. If:\n946: \n947: $$\n948: \\lambda_{\\text{clone}}(k) = \\lambda(\\rho) \\quad \\text{where } \\rho = k/N\n949: \n950: $$\n951: \n952: $$\n953: \\bar{p}_{\\text{kill}}(k') = p(\\rho') \\quad \\text{where } \\rho' = k'/N\n954: \n955: $$\n956: \n957: Then the Lipschitz constants with respect to $k$ are:\n958: \n959: $$\n960: L_\\lambda = \\frac{1}{N} \\sup_\\rho |\\lambda'(\\rho)|, \\quad L_p = \\frac{1}{N} \\sup_{\\rho'} |p'(\\rho')|\n961: \n962: $$\n963: \n964: Thus $L_p L_\\lambda = O(N^{-2})$, and the condition is automatically satisfied for any smooth density-dependent rates.\n965: \n966: **Complete parameter regime:** The full expression for $\\epsilon$ from line 390 is:\n967: \n968: $$\n969: \\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)\n970: \n971: $$\n972: \n973: Expanding this with the density-dependent scaling $L_p = O(1/N)$, $L_\\lambda = O(1/N)$:\n974: \n975: $$\n976: \\epsilon = (1 + O(1) + \\bar{p}^*)(O(1) + \\lambda^*) = (1+\\bar{p}^*)\\lambda^* + O(N^{-1})\n977: \n978: $$\n979: \n980: For $\\epsilon < 0.618$, we require:\n981: \n982: $$\n983: (1 + \\bar{p}_{\\text{kill}}^*) \\lambda_{\\text{clone}}^* < 0.6\n984: \n985: $$\n986: \n987: **Physical interpretation:** This condition requires that the product of equilibrium cloning rate and killing probability is not too large. For typical QSD parameters where $\\bar{p}^* \\sim 0.1$ (10% death probability per step) and $\\lambda^* \\sim 0.5$ (50% cloning rate), we have $(1.1)(0.5) = 0.55 < 0.618$ \u2713. The condition is satisfied for reasonable algorithm parameters and becomes easier to satisfy as $N \\to \\infty$ due to the $O(1/N)$ corrections.\n988: \n989: **Convergence:** This is the standard drift inequality for squared error, which implies exponential convergence of $\\mathbb{E}[(k_t - k_*)^2]$ to the stationary distribution with $\\mathbb{E}[(k_\\infty - k_*)^2] = O(C_{\\text{mass}}/\\kappa_{\\text{mass}}) = O(N/\\kappa_{\\text{mass}})$.\n990: \n991: This completes the proof of Lemma A."
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}