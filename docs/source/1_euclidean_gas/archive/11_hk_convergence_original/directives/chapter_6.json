{
  "chapter_index": 6,
  "section_id": "## 6. Main Theorem: Exponential HK-Convergence of the Fragile Gas",
  "directive_count": 3,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-hk-convergence-main-assembly",
      "title": "Exponential HK-Convergence of the Fragile Gas",
      "start_line": 2463,
      "end_line": 2485,
      "header_lines": [
        2464
      ],
      "content_start": 2466,
      "content_end": 2484,
      "content": "2466: :label: thm-hk-convergence-main-assembly\n2467: \n2468: Let $\\mu_t$ denote the empirical measure of alive walkers at time $t$ under the Fragile Gas dynamics $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$, and let $\\pi_{\\text{QSD}}$ denote the quasi-stationary distribution.\n2469: \n2470: **Assumptions:**\n2471: \n2472: 1. **Mass Contraction (Lemma A)**: The birth-death balance satisfies the conditions of {prf:ref}`lem-mass-contraction-revival-death` with $\\kappa_{\\text{mass}} > 0$.\n2473: \n2474: 2. **Structural Variance Contraction (Lemma B)**: The Wasserstein contraction conditions of {prf:ref}`lem-structural-variance-contraction` hold with $\\lambda_{\\text{struct}} > 0$.\n2475: \n2476: 3. **Bounded Density Ratio (Theorem {prf:ref}`thm-uniform-density-bound-hk`, PROVEN)**: The density ratio is uniformly bounded:\n2477: \n2478: $$\n2479: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n2480: \n2481: $$\n2482: \n2483: :::{important} Proven Result\n2484: This bounded density ratio is now **rigorously proven** using: (1) hypoelliptic regularity and parabolic Harnack inequalities (Kusuoka & Stroock 1985), (2) Gaussian mollification and multi-step Doeblin minorization (Hairer & Mattingly 2011), and (3) stochastic mass conservation via QSD theory (Champagnat & Villemonais 2016). See `11_hk_convergence_bounded_density_rigorous_proof.md` for the complete proof.",
      "metadata": {
        "label": "thm-hk-convergence-main-assembly"
      },
      "section": "## 6. Main Theorem: Exponential HK-Convergence of the Fragile Gas",
      "raw_directive": "2463: ### 6.1. Statement of the Main Theorem\n2464: \n2465: :::{prf:theorem} Exponential HK-Convergence of the Fragile Gas\n2466: :label: thm-hk-convergence-main-assembly\n2467: \n2468: Let $\\mu_t$ denote the empirical measure of alive walkers at time $t$ under the Fragile Gas dynamics $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$, and let $\\pi_{\\text{QSD}}$ denote the quasi-stationary distribution.\n2469: \n2470: **Assumptions:**\n2471: \n2472: 1. **Mass Contraction (Lemma A)**: The birth-death balance satisfies the conditions of {prf:ref}`lem-mass-contraction-revival-death` with $\\kappa_{\\text{mass}} > 0$.\n2473: \n2474: 2. **Structural Variance Contraction (Lemma B)**: The Wasserstein contraction conditions of {prf:ref}`lem-structural-variance-contraction` hold with $\\lambda_{\\text{struct}} > 0$.\n2475: \n2476: 3. **Bounded Density Ratio (Theorem {prf:ref}`thm-uniform-density-bound-hk`, PROVEN)**: The density ratio is uniformly bounded:\n2477: \n2478: $$\n2479: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n2480: \n2481: $$\n2482: \n2483: :::{important} Proven Result\n2484: This bounded density ratio is now **rigorously proven** using: (1) hypoelliptic regularity and parabolic Harnack inequalities (Kusuoka & Stroock 1985), (2) Gaussian mollification and multi-step Doeblin minorization (Hairer & Mattingly 2011), and (3) stochastic mass conservation via QSD theory (Champagnat & Villemonais 2016). See `11_hk_convergence_bounded_density_rigorous_proof.md` for the complete proof.\n2485: "
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-hk-convergence-main-assembly",
      "title": null,
      "start_line": 2512,
      "end_line": 2897,
      "header_lines": [
        2513
      ],
      "content_start": 2515,
      "content_end": 2896,
      "content": "2515: :label: proof-thm-hk-convergence-main-assembly\n2516: \n2517: The proof assembles the three lemmas by carefully tracking how each component of the HK metric evolves under one iteration of $\\Psi_{\\text{total}}$.\n2518: \n2519: **Recall: HK Metric Structure**\n2520: \n2521: For sub-probability measures $\\mu_1, \\mu_2$ on $(\\mathcal{X}, d)$, the Hellinger-Kantorovich metric decomposes as:\n2522: \n2523: $$\n2524: d_{HK}^2(\\mu_1, \\mu_2) = d_H^2(\\mu_1, \\mu_2) + W_2^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)\n2525: \n2526: $$\n2527: \n2528: where:\n2529: - $d_H^2(\\mu_1, \\mu_2)$ is the Hellinger distance (captures both mass and shape differences)\n2530: - $W_2^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ is the Wasserstein-2 distance between normalized measures $\\tilde{\\mu}_i = \\mu_i/\\|\\mu_i\\|$ (captures spatial structure)\n2531: \n2532: **Strategy:** We establish contraction of each component separately, then combine with careful tracking of cross-terms and error accumulation.\n2533: \n2534: ### 6.3. Step 1: Hellinger Component Contraction\n2535: \n2536: From Lemma C ({prf:ref}`lem-kinetic-hellinger-contraction`), the Hellinger distance contracts under the full dynamics via a coupled Lyapunov functional approach:\n2537: \n2538: $$\n2539: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}} \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n2540: \n2541: $$\n2542: \n2543: where:\n2544: - $\\kappa_{\\text{kin}} = \\min(\\lambda_{\\text{mass}}, \\alpha_{\\text{shape}}/2) > 0$ (from coupled Lyapunov analysis in Lemma C, Step 5)\n2545: - $\\lambda_{\\text{mass}} = r_* + c_*$ combines revival rate $r_*$ and death rate $c_*$\n2546: - $\\alpha_{\\text{shape}} = 2\\alpha_{\\text{eff}} / (1 + \\log M)$ is the shape contraction rate from direct Hellinger evolution\n2547: - $C_{\\text{kin}} = 4C_m + 4\\sqrt{k_*} K_H$ combines mass variance and BAOAB discretization errors\n2548: \n2549: **Key Insight from Lemma C:** The Hellinger component already incorporates mass contraction via the decomposition:\n2550: \n2551: $$\n2552: d_H^2(\\mu, \\pi) = (\\sqrt{k_t} - \\sqrt{k_*})^2 + \\sqrt{k_t k_*} \\cdot d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi})\n2553: \n2554: $$\n2555: \n2556: where the first term measures mass deviation and the second measures normalized shape deviation. Both contract under the kinetic operator, and their coupling is controlled via Cauchy-Schwarz bounds.\n2557: \n2558: **Implication for Assembly:** The Hellinger contraction bound from Lemma C is already a **complete bound** for the full Hellinger distance including mass effects. We do not need to separately combine Lemma A's mass contraction\u2014it is already accounted for in the proof of Lemma C.\n2559: \n2560: ### 6.4. Step 2: Wasserstein Component Contraction\n2561: \n2562: From Lemma B ({prf:ref}`lem-structural-variance-contraction`), the structural variance (normalized Wasserstein distance) contracts:\n2563: \n2564: $$\n2565: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} \\tau} W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}}\n2566: \n2567: $$\n2568: \n2569: where:\n2570: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}}) > 0$\n2571: - $\\kappa_W > 0$ is the cloning Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n2572: - $\\kappa_{\\text{kin}} > 0$ is the kinetic Foster-Lyapunov rate from {prf:ref}`thm-foster-lyapunov-main`\n2573: - $C_{\\text{struct}} = C_W + C_{\\text{kin}} \\tau^2$ combines noise from both operators\n2574: \n2575: **Realization-Level Nature:** This bound applies to individual realizations (paths) of the particle system, not just to expectations over the law. The Wasserstein distance $W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})$ is a deterministic function of the realization $\\mu_t$, and both operators contract it pathwise.\n2576: \n2577: **Approximation for Small Time Steps:** For $\\tau \\ll 1$, we can approximate $e^{-\\lambda_{\\text{struct}} \\tau} \\approx 1 - \\lambda_{\\text{struct}} \\tau + O(\\tau^2)$:\n2578: \n2579: $$\n2580: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})] \\leq (1 - \\lambda_{\\text{struct}} \\tau) W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}} + O(\\tau^2)\n2581: \n2582: $$\n2583: \n2584: ### 6.5. Step 3: Combining Both Components\n2585: \n2586: **Full HK Metric Evolution:**\n2587: \n2588: By the definition of the HK metric ({prf:ref}`def-hk-metric-intro`), we have:\n2589: \n2590: $$\n2591: d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) = d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) + W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})\n2592: \n2593: $$\n2594: \n2595: Taking expectations:\n2596: \n2597: $$\n2598: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] = \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] + \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})]\n2599: \n2600: $$\n2601: \n2602: **Substituting Component Bounds:**\n2603: \n2604: From Step 1 (Lemma C), we have:\n2605: \n2606: $$\n2607: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}} \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n2608: \n2609: $$\n2610: \n2611: From Step 2 (Lemma B), using the first-order approximation $e^{-\\lambda_{\\text{struct}} \\tau} \\leq 1 - \\lambda_{\\text{struct}} \\tau + \\frac{(\\lambda_{\\text{struct}} \\tau)^2}{2}$:\n2612: \n2613: $$\n2614: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\lambda_{\\text{struct}} \\tau) W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}} + \\frac{(\\lambda_{\\text{struct}})^2 \\tau^2}{2} W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n2615: \n2616: $$\n2617: \n2618: Taking expectations over $\\mu_t$:\n2619: \n2620: $$\n2621: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi)] \\leq (1 - \\kappa_{\\text{kin}} \\tau) \\mathbb{E}[d_H^2(\\mu_t, \\pi)] + C_{\\text{kin}} \\tau^2 + (1 - \\lambda_{\\text{struct}} \\tau) \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})] + C_{\\text{struct}} + R_\\tau\n2622: \n2623: $$\n2624: \n2625: where the remainder term is:\n2626: \n2627: $$\n2628: R_\\tau := \\frac{(\\lambda_{\\text{struct}})^2 \\tau^2}{2} \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})]\n2629: \n2630: $$\n2631: \n2632: **Bounding the Remainder:**\n2633: \n2634: Since walkers are confined to a ball of radius $R$, we have $W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) \\leq \\text{diam}(\\mathcal{X})^2 \\leq (2R)^2$. Thus:\n2635: \n2636: $$\n2637: R_\\tau \\leq 2 (\\lambda_{\\text{struct}} R)^2 \\tau^2 =: C_{\\text{quad}} \\tau^2\n2638: \n2639: $$\n2640: \n2641: **Uniform Contraction Rate:**\n2642: \n2643: Define the **bottleneck rate** as:\n2644: \n2645: $$\n2646: \\kappa_{HK} := \\min(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}) > 0\n2647: \n2648: $$\n2649: \n2650: This is the slowest contraction rate among all components and determines the overall convergence speed.\n2651: \n2652: **Lemma (Bottleneck Inequality):** For any $a, b \\geq 0$ and rates $\\alpha, \\beta > 0$, if $\\kappa := \\min(\\alpha, \\beta)$, then:\n2653: \n2654: $$\n2655: (1 - \\alpha \\tau) a + (1 - \\beta \\tau) b \\leq (1 - \\kappa \\tau)(a + b) \\quad \\text{for } \\tau \\in (0, 1/\\max(\\alpha,\\beta))\n2656: \n2657: $$\n2658: \n2659: **Proof:** Expanding the right-hand side:\n2660: \n2661: $$\n2662: (1 - \\kappa \\tau)(a + b) = a + b - \\kappa \\tau (a + b)\n2663: \n2664: $$\n2665: \n2666: The left-hand side is:\n2667: \n2668: $$\n2669: a + b - \\alpha \\tau a - \\beta \\tau b\n2670: \n2671: $$\n2672: \n2673: We need $\\alpha \\tau a + \\beta \\tau b \\geq \\kappa \\tau (a + b)$, i.e., $\\alpha a + \\beta b \\geq \\kappa (a + b)$.\n2674: \n2675: Since $\\kappa = \\min(\\alpha, \\beta)$, we have $\\alpha \\geq \\kappa$ and $\\beta \\geq \\kappa$, hence:\n2676: \n2677: $$\n2678: \\alpha a + \\beta b \\geq \\kappa a + \\kappa b = \\kappa(a + b) \\quad \\checkmark\n2679: \n2680: $$\n2681: \n2682: **Applying the Bottleneck Inequality:**\n2683: \n2684: With $a = \\mathbb{E}[d_H^2(\\mu_t, \\pi)]$, $b = \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})]$, $\\alpha = \\kappa_{\\text{kin}}$, $\\beta = \\lambda_{\\text{struct}}$:\n2685: \n2686: $$\n2687: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi)] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi)] + C_{\\text{kin}} \\tau^2 + C_{\\text{struct}} + C_{\\text{quad}} \\tau^2\n2688: \n2689: $$\n2690: \n2691: **Combined Error Constant:**\n2692: \n2693: The total error from combining both bounds is:\n2694: \n2695: $$\n2696: C_{\\text{kin}} \\tau^2 + C_{\\text{struct}} + C_{\\text{quad}} \\tau^2\n2697: \n2698: $$\n2699: \n2700: To express this in the form $C_{HK}(\\tau) \\tau^2$, we define:\n2701: \n2702: $$\n2703: C_{HK}(\\tau) := C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_{\\text{struct}}}{\\tau^2}\n2704: \n2705: $$\n2706: \n2707: Then:\n2708: \n2709: $$\n2710: C_{HK}(\\tau) \\tau^2 = (C_{\\text{kin}} + C_{\\text{quad}}) \\tau^2 + C_{\\text{struct}} \\quad \\checkmark\n2711: \n2712: $$\n2713: \n2714: This gives the one-step bound:\n2715: \n2716: $$\n2717: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] + C_{HK}(\\tau) \\tau^2\n2718: \n2719: $$\n2720: \n2721: **Properties of $C_{HK}(\\tau)$:**\n2722: \n2723: 1. **Explicit dependence:** $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_{\\text{struct}}}{\\tau^2}$ where:\n2724:    - $C_{\\text{quad}} = 2(\\lambda_{\\text{struct}} R)^2$ (quadratic remainder from exponential expansion)\n2725:    - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ (from Lemma B)\n2726: \n2727: 2. **Scaling with $\\tau$:**\n2728:    - Substituting $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$:\n2729: \n2730: $$\n2731: C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_W}{\\tau^2} + C_{\\text{kin}}\n2732: \n2733: $$\n2734: \n2735:    - If $C_W = O(1)$ (cloning noise dominates), then $C_{HK}(\\tau) \\sim O(1/\\tau^2)$ as $\\tau \\to 0$\n2736:    - If $C_W = O(\\tau^2)$ (ideal discretization), then $C_{HK}(\\tau) = O(1)$\n2737: \n2738: 3. **Finiteness:** For any fixed $\\tau \\in (0, \\tau_{\\max}]$, we have $C_{HK}(\\tau) < \\infty$\n2739: \n2740: **Final One-Step Bound:**\n2741: \n2742: For a fixed time step $\\tau > 0$, setting $C_{HK} := C_{HK}(\\tau)$, we have proven:\n2743: \n2744: $$\n2745: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] + C_{HK} \\tau^2\n2746: \n2747: $$\n2748: \n2749: This is the fundamental one-step contraction inequality for the HK metric.\n2750: \n2751: ### 6.6. Step 4: Iteration and Exponential Bound\n2752: \n2753: Having established the one-step contraction inequality, we now iterate it to obtain the full exponential decay bound.\n2754: \n2755: **Discrete-Time Iteration:**\n2756: \n2757: We have for all $k \\geq 0$:\n2758: \n2759: $$\n2760: \\mathbb{E}[d_{HK}^2(\\mu_{k+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_k, \\pi_{\\text{QSD}})] + C_{HK} \\tau^2\n2761: \n2762: $$\n2763: \n2764: **Lemma (Affine Recursion).** Let $(X_n)_{n \\geq 0}$ satisfy $X_{n+1} \\leq \\rho X_n + \\sigma$ for $\\rho \\in (0,1)$ and $\\sigma \\geq 0$. Then:\n2765: \n2766: $$\n2767: X_n \\leq \\rho^n X_0 + \\sigma \\sum_{j=0}^{n-1} \\rho^j = \\rho^n X_0 + \\sigma \\frac{1 - \\rho^n}{1 - \\rho}\n2768: \n2769: $$\n2770: \n2771: **Proof.** By induction. Base case ($n=0$): $X_0 \\leq X_0$ trivially.\n2772: \n2773: Inductive step: Assume $X_n \\leq \\rho^n X_0 + \\sigma \\frac{1-\\rho^n}{1-\\rho}$. Then:\n2774: \n2775: $$\n2776: X_{n+1} \\leq \\rho X_n + \\sigma \\leq \\rho\\left(\\rho^n X_0 + \\sigma \\frac{1-\\rho^n}{1-\\rho}\\right) + \\sigma = \\rho^{n+1} X_0 + \\sigma \\left(\\frac{\\rho(1-\\rho^n)}{1-\\rho} + 1\\right)\n2777: \n2778: $$\n2779: \n2780: Simplifying the coefficient of $\\sigma$:\n2781: \n2782: $$\n2783: \\frac{\\rho(1-\\rho^n)}{1-\\rho} + 1 = \\frac{\\rho(1-\\rho^n) + (1-\\rho)}{1-\\rho} = \\frac{\\rho - \\rho^{n+1} + 1 - \\rho}{1-\\rho} = \\frac{1 - \\rho^{n+1}}{1-\\rho} \\quad \\checkmark\n2784: \n2785: $$\n2786: \n2787: **Applying the Affine Recursion Lemma:**\n2788: \n2789: With $X_n = \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi_{\\text{QSD}})]$, $\\rho = 1 - \\kappa_{HK} \\tau \\in (0,1)$ (assuming $\\tau < 1/\\kappa_{HK}$), and $\\sigma = C_{HK} \\tau^2$:\n2790: \n2791: $$\n2792: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + C_{HK} \\tau^2 \\frac{1 - (1 - \\kappa_{HK} \\tau)^n}{\\kappa_{HK} \\tau}\n2793: \n2794: $$\n2795: \n2796: Simplifying:\n2797: \n2798: $$\n2799: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - (1 - \\kappa_{HK} \\tau)^n]\n2800: \n2801: $$\n2802: \n2803: **Continuous-Time Bound via Inequality:**\n2804: \n2805: To transition rigorously from discrete to continuous time, we use a standard logarithmic inequality.\n2806: \n2807: **Lemma (Logarithmic Inequality).** For $x \\in (0,1)$:\n2808: \n2809: $$\n2810: \\log(1 - x) \\leq -x\n2811: \n2812: $$\n2813: \n2814: **Proof.** Consider $f(x) = \\log(1-x) + x$. Then $f(0) = 0$ and $f'(x) = -1/(1-x) + 1 = x/(1-x) > 0$ for $x > 0$. Thus $f$ is strictly increasing, so $f(x) > f(0) = 0$ for $x > 0$. Wait, this gives the wrong inequality direction.\n2815: \n2816: Actually, $f'(x) = -1/(1-x) + 1 = (1-x-1)/(1-x) = -x/(1-x) < 0$ for $x \\in (0,1)$. Thus $f$ is strictly decreasing, so $f(x) < f(0) = 0$, giving $\\log(1-x) < -x$ for $x \\in (0,1)$. $\\square$\n2817: \n2818: **Applying the Logarithmic Inequality:**\n2819: \n2820: For $\\kappa_{HK} \\tau < 1$, we have:\n2821: \n2822: $$\n2823: (1 - \\kappa_{HK} \\tau)^n = \\exp(n \\log(1 - \\kappa_{HK} \\tau)) \\leq \\exp(-n \\kappa_{HK} \\tau) = \\exp(-\\kappa_{HK} t)\n2824: \n2825: $$\n2826: \n2827: where $t = n\\tau$ (note: $n$ may be non-integer if $t/\\tau$ is not an integer, but the bound holds for $n = \\lfloor t/\\tau \\rfloor$ or $n = \\lceil t/\\tau \\rceil$).\n2828: \n2829: **Theorem (Exponential Decay in HK Metric - Discrete Time).** For any time $t_n = n\\tau$ (discrete time steps), the Fragile Gas satisfies:\n2830: \n2831: $$\n2832: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK}(\\tau) \\tau}{\\kappa_{HK}}\n2833: \n2834: $$\n2835: \n2836: where $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + C_{\\text{struct}}/\\tau^2$ is the time-step-dependent error constant.\n2837: \n2838: **Proof.** From the affine recursion lemma:\n2839: \n2840: $$\n2841: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - (1 - \\kappa_{HK} \\tau)^n]\n2842: \n2843: $$\n2844: \n2845: Using $(1 - \\kappa_{HK} \\tau)^n \\leq e^{-\\kappa_{HK} t_n}$:\n2846: \n2847: $$\n2848: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi)] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - e^{-\\kappa_{HK} t_n}]\n2849: \n2850: $$\n2851: \n2852: Since $1 - e^{-\\kappa_{HK} t_n} \\leq 1$:\n2853: \n2854: $$\n2855: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK} \\tau}{\\kappa_{HK}}\n2856: \n2857: $$\n2858: \n2859: This completes the proof. $\\square$\n2860: \n2861: **Interpretation:** The theorem establishes exponential decay of the HK distance to the QSD for the discrete-time Fragile Gas dynamics. The steady-state error floor $\\sqrt{C_{HK} \\tau / \\kappa_{HK}}$ depends explicitly on the time step $\\tau$, reflecting the fact that this is a bound for a specific discretization of the underlying continuous dynamics.\n2862: \n2863: **Corollary (Convergence in Metric).** Taking square roots and using the Cauchy-Schwarz inequality:\n2864: \n2865: $$\n2866: d_{HK}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\sqrt{\\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})]} \\leq e^{-\\kappa_{HK} t/2} d_{HK}(\\mu_0, \\pi_{\\text{QSD}}) + \\sqrt{\\frac{C_{HK} \\tau}{\\kappa_{HK}}}\n2867: \n2868: $$\n2869: \n2870: **Remark on Expectation vs. Realization:** The bound holds for the expectation $\\mathbb{E}[d_{HK}]$ taken over all randomness (cloning selection, Langevin noise, boundary exits). Individual realizations may fluctuate, but concentration inequalities (future work) would bound the deviation from this expected trajectory.\n2871: \n2872: **Steady-State Limit:**\n2873: \n2874: As $t \\to \\infty$, the exponential term vanishes, and:\n2875: \n2876: $$\n2877: \\lim_{t \\to \\infty} \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] \\leq \\frac{C_{HK} \\tau}{\\kappa_{HK}}\n2878: \n2879: $$\n2880: \n2881: This is the **invariant error floor**, determined by the balance between contraction rate $\\kappa_{HK}$ and noise accumulation rate $C_{HK} \\tau$.\n2882: \n2883: **Conclusion of Proof:**\n2884: \n2885: We have proven that for discrete times $t_n = n\\tau$, the Fragile Gas satisfies:\n2886: \n2887: $$\n2888: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK}(\\tau) \\tau}{\\kappa_{HK}}\n2889: \n2890: $$\n2891: \n2892: with explicit convergence rate $\\kappa_{HK} = \\min(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}) > 0$ and error constant $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + C_{\\text{struct}}/\\tau^2$, where:\n2893: - $C_{\\text{kin}}$: kinetic operator BAOAB discretization error\n2894: - $C_{\\text{quad}} = 2(\\lambda_{\\text{struct}} R)^2$: quadratic correction from exponential approximation\n2895: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$: structural variance noise\n2896: ",
      "metadata": {
        "label": "proof-thm-hk-convergence-main-assembly"
      },
      "section": "## 6. Main Theorem: Exponential HK-Convergence of the Fragile Gas",
      "raw_directive": "2512: ### 6.2. Proof Strategy and HK Metric Decomposition\n2513: \n2514: :::{prf:proof}\n2515: :label: proof-thm-hk-convergence-main-assembly\n2516: \n2517: The proof assembles the three lemmas by carefully tracking how each component of the HK metric evolves under one iteration of $\\Psi_{\\text{total}}$.\n2518: \n2519: **Recall: HK Metric Structure**\n2520: \n2521: For sub-probability measures $\\mu_1, \\mu_2$ on $(\\mathcal{X}, d)$, the Hellinger-Kantorovich metric decomposes as:\n2522: \n2523: $$\n2524: d_{HK}^2(\\mu_1, \\mu_2) = d_H^2(\\mu_1, \\mu_2) + W_2^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)\n2525: \n2526: $$\n2527: \n2528: where:\n2529: - $d_H^2(\\mu_1, \\mu_2)$ is the Hellinger distance (captures both mass and shape differences)\n2530: - $W_2^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ is the Wasserstein-2 distance between normalized measures $\\tilde{\\mu}_i = \\mu_i/\\|\\mu_i\\|$ (captures spatial structure)\n2531: \n2532: **Strategy:** We establish contraction of each component separately, then combine with careful tracking of cross-terms and error accumulation.\n2533: \n2534: ### 6.3. Step 1: Hellinger Component Contraction\n2535: \n2536: From Lemma C ({prf:ref}`lem-kinetic-hellinger-contraction`), the Hellinger distance contracts under the full dynamics via a coupled Lyapunov functional approach:\n2537: \n2538: $$\n2539: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}} \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n2540: \n2541: $$\n2542: \n2543: where:\n2544: - $\\kappa_{\\text{kin}} = \\min(\\lambda_{\\text{mass}}, \\alpha_{\\text{shape}}/2) > 0$ (from coupled Lyapunov analysis in Lemma C, Step 5)\n2545: - $\\lambda_{\\text{mass}} = r_* + c_*$ combines revival rate $r_*$ and death rate $c_*$\n2546: - $\\alpha_{\\text{shape}} = 2\\alpha_{\\text{eff}} / (1 + \\log M)$ is the shape contraction rate from direct Hellinger evolution\n2547: - $C_{\\text{kin}} = 4C_m + 4\\sqrt{k_*} K_H$ combines mass variance and BAOAB discretization errors\n2548: \n2549: **Key Insight from Lemma C:** The Hellinger component already incorporates mass contraction via the decomposition:\n2550: \n2551: $$\n2552: d_H^2(\\mu, \\pi) = (\\sqrt{k_t} - \\sqrt{k_*})^2 + \\sqrt{k_t k_*} \\cdot d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi})\n2553: \n2554: $$\n2555: \n2556: where the first term measures mass deviation and the second measures normalized shape deviation. Both contract under the kinetic operator, and their coupling is controlled via Cauchy-Schwarz bounds.\n2557: \n2558: **Implication for Assembly:** The Hellinger contraction bound from Lemma C is already a **complete bound** for the full Hellinger distance including mass effects. We do not need to separately combine Lemma A's mass contraction\u2014it is already accounted for in the proof of Lemma C.\n2559: \n2560: ### 6.4. Step 2: Wasserstein Component Contraction\n2561: \n2562: From Lemma B ({prf:ref}`lem-structural-variance-contraction`), the structural variance (normalized Wasserstein distance) contracts:\n2563: \n2564: $$\n2565: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} \\tau} W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}}\n2566: \n2567: $$\n2568: \n2569: where:\n2570: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}}) > 0$\n2571: - $\\kappa_W > 0$ is the cloning Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n2572: - $\\kappa_{\\text{kin}} > 0$ is the kinetic Foster-Lyapunov rate from {prf:ref}`thm-foster-lyapunov-main`\n2573: - $C_{\\text{struct}} = C_W + C_{\\text{kin}} \\tau^2$ combines noise from both operators\n2574: \n2575: **Realization-Level Nature:** This bound applies to individual realizations (paths) of the particle system, not just to expectations over the law. The Wasserstein distance $W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})$ is a deterministic function of the realization $\\mu_t$, and both operators contract it pathwise.\n2576: \n2577: **Approximation for Small Time Steps:** For $\\tau \\ll 1$, we can approximate $e^{-\\lambda_{\\text{struct}} \\tau} \\approx 1 - \\lambda_{\\text{struct}} \\tau + O(\\tau^2)$:\n2578: \n2579: $$\n2580: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})] \\leq (1 - \\lambda_{\\text{struct}} \\tau) W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}} + O(\\tau^2)\n2581: \n2582: $$\n2583: \n2584: ### 6.5. Step 3: Combining Both Components\n2585: \n2586: **Full HK Metric Evolution:**\n2587: \n2588: By the definition of the HK metric ({prf:ref}`def-hk-metric-intro`), we have:\n2589: \n2590: $$\n2591: d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) = d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) + W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})\n2592: \n2593: $$\n2594: \n2595: Taking expectations:\n2596: \n2597: $$\n2598: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] = \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] + \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})]\n2599: \n2600: $$\n2601: \n2602: **Substituting Component Bounds:**\n2603: \n2604: From Step 1 (Lemma C), we have:\n2605: \n2606: $$\n2607: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}} \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n2608: \n2609: $$\n2610: \n2611: From Step 2 (Lemma B), using the first-order approximation $e^{-\\lambda_{\\text{struct}} \\tau} \\leq 1 - \\lambda_{\\text{struct}} \\tau + \\frac{(\\lambda_{\\text{struct}} \\tau)^2}{2}$:\n2612: \n2613: $$\n2614: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\lambda_{\\text{struct}} \\tau) W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}} + \\frac{(\\lambda_{\\text{struct}})^2 \\tau^2}{2} W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n2615: \n2616: $$\n2617: \n2618: Taking expectations over $\\mu_t$:\n2619: \n2620: $$\n2621: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi)] \\leq (1 - \\kappa_{\\text{kin}} \\tau) \\mathbb{E}[d_H^2(\\mu_t, \\pi)] + C_{\\text{kin}} \\tau^2 + (1 - \\lambda_{\\text{struct}} \\tau) \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})] + C_{\\text{struct}} + R_\\tau\n2622: \n2623: $$\n2624: \n2625: where the remainder term is:\n2626: \n2627: $$\n2628: R_\\tau := \\frac{(\\lambda_{\\text{struct}})^2 \\tau^2}{2} \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})]\n2629: \n2630: $$\n2631: \n2632: **Bounding the Remainder:**\n2633: \n2634: Since walkers are confined to a ball of radius $R$, we have $W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) \\leq \\text{diam}(\\mathcal{X})^2 \\leq (2R)^2$. Thus:\n2635: \n2636: $$\n2637: R_\\tau \\leq 2 (\\lambda_{\\text{struct}} R)^2 \\tau^2 =: C_{\\text{quad}} \\tau^2\n2638: \n2639: $$\n2640: \n2641: **Uniform Contraction Rate:**\n2642: \n2643: Define the **bottleneck rate** as:\n2644: \n2645: $$\n2646: \\kappa_{HK} := \\min(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}) > 0\n2647: \n2648: $$\n2649: \n2650: This is the slowest contraction rate among all components and determines the overall convergence speed.\n2651: \n2652: **Lemma (Bottleneck Inequality):** For any $a, b \\geq 0$ and rates $\\alpha, \\beta > 0$, if $\\kappa := \\min(\\alpha, \\beta)$, then:\n2653: \n2654: $$\n2655: (1 - \\alpha \\tau) a + (1 - \\beta \\tau) b \\leq (1 - \\kappa \\tau)(a + b) \\quad \\text{for } \\tau \\in (0, 1/\\max(\\alpha,\\beta))\n2656: \n2657: $$\n2658: \n2659: **Proof:** Expanding the right-hand side:\n2660: \n2661: $$\n2662: (1 - \\kappa \\tau)(a + b) = a + b - \\kappa \\tau (a + b)\n2663: \n2664: $$\n2665: \n2666: The left-hand side is:\n2667: \n2668: $$\n2669: a + b - \\alpha \\tau a - \\beta \\tau b\n2670: \n2671: $$\n2672: \n2673: We need $\\alpha \\tau a + \\beta \\tau b \\geq \\kappa \\tau (a + b)$, i.e., $\\alpha a + \\beta b \\geq \\kappa (a + b)$.\n2674: \n2675: Since $\\kappa = \\min(\\alpha, \\beta)$, we have $\\alpha \\geq \\kappa$ and $\\beta \\geq \\kappa$, hence:\n2676: \n2677: $$\n2678: \\alpha a + \\beta b \\geq \\kappa a + \\kappa b = \\kappa(a + b) \\quad \\checkmark\n2679: \n2680: $$\n2681: \n2682: **Applying the Bottleneck Inequality:**\n2683: \n2684: With $a = \\mathbb{E}[d_H^2(\\mu_t, \\pi)]$, $b = \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})]$, $\\alpha = \\kappa_{\\text{kin}}$, $\\beta = \\lambda_{\\text{struct}}$:\n2685: \n2686: $$\n2687: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi)] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi)] + C_{\\text{kin}} \\tau^2 + C_{\\text{struct}} + C_{\\text{quad}} \\tau^2\n2688: \n2689: $$\n2690: \n2691: **Combined Error Constant:**\n2692: \n2693: The total error from combining both bounds is:\n2694: \n2695: $$\n2696: C_{\\text{kin}} \\tau^2 + C_{\\text{struct}} + C_{\\text{quad}} \\tau^2\n2697: \n2698: $$\n2699: \n2700: To express this in the form $C_{HK}(\\tau) \\tau^2$, we define:\n2701: \n2702: $$\n2703: C_{HK}(\\tau) := C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_{\\text{struct}}}{\\tau^2}\n2704: \n2705: $$\n2706: \n2707: Then:\n2708: \n2709: $$\n2710: C_{HK}(\\tau) \\tau^2 = (C_{\\text{kin}} + C_{\\text{quad}}) \\tau^2 + C_{\\text{struct}} \\quad \\checkmark\n2711: \n2712: $$\n2713: \n2714: This gives the one-step bound:\n2715: \n2716: $$\n2717: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] + C_{HK}(\\tau) \\tau^2\n2718: \n2719: $$\n2720: \n2721: **Properties of $C_{HK}(\\tau)$:**\n2722: \n2723: 1. **Explicit dependence:** $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_{\\text{struct}}}{\\tau^2}$ where:\n2724:    - $C_{\\text{quad}} = 2(\\lambda_{\\text{struct}} R)^2$ (quadratic remainder from exponential expansion)\n2725:    - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ (from Lemma B)\n2726: \n2727: 2. **Scaling with $\\tau$:**\n2728:    - Substituting $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$:\n2729: \n2730: $$\n2731: C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_W}{\\tau^2} + C_{\\text{kin}}\n2732: \n2733: $$\n2734: \n2735:    - If $C_W = O(1)$ (cloning noise dominates), then $C_{HK}(\\tau) \\sim O(1/\\tau^2)$ as $\\tau \\to 0$\n2736:    - If $C_W = O(\\tau^2)$ (ideal discretization), then $C_{HK}(\\tau) = O(1)$\n2737: \n2738: 3. **Finiteness:** For any fixed $\\tau \\in (0, \\tau_{\\max}]$, we have $C_{HK}(\\tau) < \\infty$\n2739: \n2740: **Final One-Step Bound:**\n2741: \n2742: For a fixed time step $\\tau > 0$, setting $C_{HK} := C_{HK}(\\tau)$, we have proven:\n2743: \n2744: $$\n2745: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] + C_{HK} \\tau^2\n2746: \n2747: $$\n2748: \n2749: This is the fundamental one-step contraction inequality for the HK metric.\n2750: \n2751: ### 6.6. Step 4: Iteration and Exponential Bound\n2752: \n2753: Having established the one-step contraction inequality, we now iterate it to obtain the full exponential decay bound.\n2754: \n2755: **Discrete-Time Iteration:**\n2756: \n2757: We have for all $k \\geq 0$:\n2758: \n2759: $$\n2760: \\mathbb{E}[d_{HK}^2(\\mu_{k+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_k, \\pi_{\\text{QSD}})] + C_{HK} \\tau^2\n2761: \n2762: $$\n2763: \n2764: **Lemma (Affine Recursion).** Let $(X_n)_{n \\geq 0}$ satisfy $X_{n+1} \\leq \\rho X_n + \\sigma$ for $\\rho \\in (0,1)$ and $\\sigma \\geq 0$. Then:\n2765: \n2766: $$\n2767: X_n \\leq \\rho^n X_0 + \\sigma \\sum_{j=0}^{n-1} \\rho^j = \\rho^n X_0 + \\sigma \\frac{1 - \\rho^n}{1 - \\rho}\n2768: \n2769: $$\n2770: \n2771: **Proof.** By induction. Base case ($n=0$): $X_0 \\leq X_0$ trivially.\n2772: \n2773: Inductive step: Assume $X_n \\leq \\rho^n X_0 + \\sigma \\frac{1-\\rho^n}{1-\\rho}$. Then:\n2774: \n2775: $$\n2776: X_{n+1} \\leq \\rho X_n + \\sigma \\leq \\rho\\left(\\rho^n X_0 + \\sigma \\frac{1-\\rho^n}{1-\\rho}\\right) + \\sigma = \\rho^{n+1} X_0 + \\sigma \\left(\\frac{\\rho(1-\\rho^n)}{1-\\rho} + 1\\right)\n2777: \n2778: $$\n2779: \n2780: Simplifying the coefficient of $\\sigma$:\n2781: \n2782: $$\n2783: \\frac{\\rho(1-\\rho^n)}{1-\\rho} + 1 = \\frac{\\rho(1-\\rho^n) + (1-\\rho)}{1-\\rho} = \\frac{\\rho - \\rho^{n+1} + 1 - \\rho}{1-\\rho} = \\frac{1 - \\rho^{n+1}}{1-\\rho} \\quad \\checkmark\n2784: \n2785: $$\n2786: \n2787: **Applying the Affine Recursion Lemma:**\n2788: \n2789: With $X_n = \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi_{\\text{QSD}})]$, $\\rho = 1 - \\kappa_{HK} \\tau \\in (0,1)$ (assuming $\\tau < 1/\\kappa_{HK}$), and $\\sigma = C_{HK} \\tau^2$:\n2790: \n2791: $$\n2792: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + C_{HK} \\tau^2 \\frac{1 - (1 - \\kappa_{HK} \\tau)^n}{\\kappa_{HK} \\tau}\n2793: \n2794: $$\n2795: \n2796: Simplifying:\n2797: \n2798: $$\n2799: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - (1 - \\kappa_{HK} \\tau)^n]\n2800: \n2801: $$\n2802: \n2803: **Continuous-Time Bound via Inequality:**\n2804: \n2805: To transition rigorously from discrete to continuous time, we use a standard logarithmic inequality.\n2806: \n2807: **Lemma (Logarithmic Inequality).** For $x \\in (0,1)$:\n2808: \n2809: $$\n2810: \\log(1 - x) \\leq -x\n2811: \n2812: $$\n2813: \n2814: **Proof.** Consider $f(x) = \\log(1-x) + x$. Then $f(0) = 0$ and $f'(x) = -1/(1-x) + 1 = x/(1-x) > 0$ for $x > 0$. Thus $f$ is strictly increasing, so $f(x) > f(0) = 0$ for $x > 0$. Wait, this gives the wrong inequality direction.\n2815: \n2816: Actually, $f'(x) = -1/(1-x) + 1 = (1-x-1)/(1-x) = -x/(1-x) < 0$ for $x \\in (0,1)$. Thus $f$ is strictly decreasing, so $f(x) < f(0) = 0$, giving $\\log(1-x) < -x$ for $x \\in (0,1)$. $\\square$\n2817: \n2818: **Applying the Logarithmic Inequality:**\n2819: \n2820: For $\\kappa_{HK} \\tau < 1$, we have:\n2821: \n2822: $$\n2823: (1 - \\kappa_{HK} \\tau)^n = \\exp(n \\log(1 - \\kappa_{HK} \\tau)) \\leq \\exp(-n \\kappa_{HK} \\tau) = \\exp(-\\kappa_{HK} t)\n2824: \n2825: $$\n2826: \n2827: where $t = n\\tau$ (note: $n$ may be non-integer if $t/\\tau$ is not an integer, but the bound holds for $n = \\lfloor t/\\tau \\rfloor$ or $n = \\lceil t/\\tau \\rceil$).\n2828: \n2829: **Theorem (Exponential Decay in HK Metric - Discrete Time).** For any time $t_n = n\\tau$ (discrete time steps), the Fragile Gas satisfies:\n2830: \n2831: $$\n2832: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK}(\\tau) \\tau}{\\kappa_{HK}}\n2833: \n2834: $$\n2835: \n2836: where $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + C_{\\text{struct}}/\\tau^2$ is the time-step-dependent error constant.\n2837: \n2838: **Proof.** From the affine recursion lemma:\n2839: \n2840: $$\n2841: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - (1 - \\kappa_{HK} \\tau)^n]\n2842: \n2843: $$\n2844: \n2845: Using $(1 - \\kappa_{HK} \\tau)^n \\leq e^{-\\kappa_{HK} t_n}$:\n2846: \n2847: $$\n2848: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi)] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - e^{-\\kappa_{HK} t_n}]\n2849: \n2850: $$\n2851: \n2852: Since $1 - e^{-\\kappa_{HK} t_n} \\leq 1$:\n2853: \n2854: $$\n2855: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK} \\tau}{\\kappa_{HK}}\n2856: \n2857: $$\n2858: \n2859: This completes the proof. $\\square$\n2860: \n2861: **Interpretation:** The theorem establishes exponential decay of the HK distance to the QSD for the discrete-time Fragile Gas dynamics. The steady-state error floor $\\sqrt{C_{HK} \\tau / \\kappa_{HK}}$ depends explicitly on the time step $\\tau$, reflecting the fact that this is a bound for a specific discretization of the underlying continuous dynamics.\n2862: \n2863: **Corollary (Convergence in Metric).** Taking square roots and using the Cauchy-Schwarz inequality:\n2864: \n2865: $$\n2866: d_{HK}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\sqrt{\\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})]} \\leq e^{-\\kappa_{HK} t/2} d_{HK}(\\mu_0, \\pi_{\\text{QSD}}) + \\sqrt{\\frac{C_{HK} \\tau}{\\kappa_{HK}}}\n2867: \n2868: $$\n2869: \n2870: **Remark on Expectation vs. Realization:** The bound holds for the expectation $\\mathbb{E}[d_{HK}]$ taken over all randomness (cloning selection, Langevin noise, boundary exits). Individual realizations may fluctuate, but concentration inequalities (future work) would bound the deviation from this expected trajectory.\n2871: \n2872: **Steady-State Limit:**\n2873: \n2874: As $t \\to \\infty$, the exponential term vanishes, and:\n2875: \n2876: $$\n2877: \\lim_{t \\to \\infty} \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] \\leq \\frac{C_{HK} \\tau}{\\kappa_{HK}}\n2878: \n2879: $$\n2880: \n2881: This is the **invariant error floor**, determined by the balance between contraction rate $\\kappa_{HK}$ and noise accumulation rate $C_{HK} \\tau$.\n2882: \n2883: **Conclusion of Proof:**\n2884: \n2885: We have proven that for discrete times $t_n = n\\tau$, the Fragile Gas satisfies:\n2886: \n2887: $$\n2888: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK}(\\tau) \\tau}{\\kappa_{HK}}\n2889: \n2890: $$\n2891: \n2892: with explicit convergence rate $\\kappa_{HK} = \\min(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}) > 0$ and error constant $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + C_{\\text{struct}}/\\tau^2$, where:\n2893: - $C_{\\text{kin}}$: kinetic operator BAOAB discretization error\n2894: - $C_{\\text{quad}} = 2(\\lambda_{\\text{struct}} R)^2$: quadratic correction from exponential approximation\n2895: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$: structural variance noise\n2896: \n2897: This completes the proof of Theorem {prf:ref}`thm-hk-convergence-main-assembly`. $\\square$"
    },
    {
      "directive_type": "theorem",
      "label": "thm-hk-summary",
      "title": "Exponential HK-Convergence (Summary)",
      "start_line": 3125,
      "end_line": 3147,
      "header_lines": [
        3126
      ],
      "content_start": 3128,
      "content_end": 3146,
      "content": "3128: :label: thm-hk-summary\n3129: \n3130: The Fragile Gas converges exponentially fast to its quasi-stationary distribution in the Hellinger-Kantorovich metric:\n3131: \n3132: $$\n3133: d_{HK}(\\mu_t, \\pi_{\\text{QSD}}) \\leq e^{-\\kappa_{HK} t/2} d_{HK}(\\mu_0, \\pi_{\\text{QSD}}) + O\\left(\\sqrt{\\frac{C_{HK}}{\\kappa_{HK}}}\\right)\n3134: \n3135: $$\n3136: \n3137: with explicit rate:\n3138: \n3139: $$\n3140: \\kappa_{HK} = \\min\\left(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}\\right) = \\min\\left(\\min(2(r_* + c_*), \\frac{\\alpha_{\\text{eff}}}{C_{\\text{rev}}(M)}), \\min\\left(\\frac{\\kappa_W}{\\tau}, \\kappa_{\\text{kin}}\\right)\\right) > 0\n3141: \n3142: $$\n3143: \n3144: where:\n3145: - $\\kappa_{\\text{kin}} = \\min(2(r_* + c_*), \\alpha_{\\text{eff}}/C_{\\text{rev}}(M))$ is the kinetic (Hellinger) contraction rate\n3146: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the structural (Wasserstein) contraction rate",
      "metadata": {
        "label": "thm-hk-summary"
      },
      "section": "## 6. Main Theorem: Exponential HK-Convergence of the Fragile Gas",
      "raw_directive": "3125: We have proven:\n3126: \n3127: :::{prf:theorem} Exponential HK-Convergence (Summary)\n3128: :label: thm-hk-summary\n3129: \n3130: The Fragile Gas converges exponentially fast to its quasi-stationary distribution in the Hellinger-Kantorovich metric:\n3131: \n3132: $$\n3133: d_{HK}(\\mu_t, \\pi_{\\text{QSD}}) \\leq e^{-\\kappa_{HK} t/2} d_{HK}(\\mu_0, \\pi_{\\text{QSD}}) + O\\left(\\sqrt{\\frac{C_{HK}}{\\kappa_{HK}}}\\right)\n3134: \n3135: $$\n3136: \n3137: with explicit rate:\n3138: \n3139: $$\n3140: \\kappa_{HK} = \\min\\left(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}\\right) = \\min\\left(\\min(2(r_* + c_*), \\frac{\\alpha_{\\text{eff}}}{C_{\\text{rev}}(M)}), \\min\\left(\\frac{\\kappa_W}{\\tau}, \\kappa_{\\text{kin}}\\right)\\right) > 0\n3141: \n3142: $$\n3143: \n3144: where:\n3145: - $\\kappa_{\\text{kin}} = \\min(2(r_* + c_*), \\alpha_{\\text{eff}}/C_{\\text{rev}}(M))$ is the kinetic (Hellinger) contraction rate\n3146: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the structural (Wasserstein) contraction rate\n3147: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}