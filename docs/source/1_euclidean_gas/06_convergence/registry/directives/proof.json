{
  "document_id": "06_convergence",
  "stage": "directives",
  "directive_type": "proof",
  "generated_at": "2025-11-12T22:37:33.916629+00:00",
  "count": 5,
  "items": [
    {
      "directive_type": "proof",
      "label": "proof-thm-foster-lyapunov-main",
      "title": null,
      "start_line": 292,
      "end_line": 518,
      "header_lines": [
        293
      ],
      "content_start": 295,
      "content_end": 517,
      "content": "295: :label: proof-thm-foster-lyapunov-main\n296: \n297: **Proof (Rigorous Verification of Coupling Constants).**\n298: \n299: This proof verifies that there exist finite coupling constants $c_V^*, c_B^* > 0$ such that the Foster-Lyapunov condition holds with explicit $\\kappa_{\\text{total}}$ and $C_{\\text{total}}$.\n300: \n301: **PART I: Decomposition of the Composed Operator**\n302: \n303: The total Lyapunov function is:\n304: \n305: $$\n306: V_{\\text{total}} = V_W + c_V V_{\\text{Var}} + c_B W_b\n307: $$\n308: \n309: where $V_{\\text{Var}} = V_{\\text{Var},x} + V_{\\text{Var},v}$.\n310: \n311: The composed operator $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ acts as:\n312: \n313: $$\n314: S \\xrightarrow{\\Psi_{\\text{clone}}} S^{\\text{clone}} \\xrightarrow{\\Psi_{\\text{kin}}} S'\n315: $$\n316: \n317: **By the tower property of expectation:**\n318: \n319: $$\n320: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{total}}] + \\mathbb{E}_{\\text{clone}}[\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{total}} \\mid S^{\\text{clone}}]]\n321: $$\n322: \n323: **PART II: Collect All Drift Inequalities**\n324: \n325: From previous chapters, we have the following drift bounds:\n326: \n327: **From Cloning (03_cloning.md):**\n328: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_W] \\leq C_W$ (bounded expansion)\n329: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] \\leq -\\kappa_x V_{\\text{Var},x} + C_x$ (contraction)\n330: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] \\leq C_v$ (bounded expansion)\n331: - $\\mathbb{E}_{\\text{clone}}[\\Delta W_b] \\leq -\\kappa_b W_b + C_b$ (contraction)\n332: \n333: **From Kinetics (this document):**\n334: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_W] \\leq -\\kappa_W V_W \\tau + C_W'\\tau$ (Theorem 2.3.1)\n335: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},x}] \\leq C_{\\text{kin},x}\\tau$ (Theorem 4.3.1, bounded expansion)\n336: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v}\\tau + d\\sigma_{\\max}^2\\tau$ (Theorem 3.3.1)\n337: - $\\mathbb{E}_{\\text{kin}}[\\Delta W_b] \\leq -\\kappa_{\\text{pot}} W_b \\tau + C_{\\text{pot}}\\tau$ (Theorem 5.3.1)\n338: \n339: **PART III: Aggregate Drifts for Each Component**\n340: \n341: **Component 1: Inter-swarm error $V_W$**\n342: \n343: $$\n344: \\mathbb{E}_{\\text{total}}[\\Delta V_W] = \\mathbb{E}_{\\text{clone}}[\\Delta V_W] + \\mathbb{E}_{\\text{kin}}[\\Delta V_W]\n345: $$\n346: \n347: $$\n348: \\leq C_W + (-\\kappa_W V_W \\tau + C_W'\\tau) = -\\kappa_W V_W \\tau + (C_W + C_W'\\tau)\n349: $$\n350: \n351: **Component 2: Positional variance $V_{\\text{Var},x}$**\n352: \n353: $$\n354: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},x}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] + \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},x}]\n355: $$\n356: \n357: $$\n358: \\leq (-\\kappa_x V_{\\text{Var},x} + C_x) + C_{\\text{kin},x}\\tau = -\\kappa_x V_{\\text{Var},x} + (C_x + C_{\\text{kin},x}\\tau)\n359: $$\n360: \n361: **Component 3: Velocity variance $V_{\\text{Var},v}$**\n362: \n363: $$\n364: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},v}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] + \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}]\n365: $$\n366: \n367: $$\n368: \\leq C_v + (-2\\gamma V_{\\text{Var},v}\\tau + d\\sigma_{\\max}^2\\tau) = -2\\gamma V_{\\text{Var},v}\\tau + (C_v + d\\sigma_{\\max}^2\\tau)\n369: $$\n370: \n371: **Component 4: Boundary potential $W_b$**\n372: \n373: $$\n374: \\mathbb{E}_{\\text{total}}[\\Delta W_b] = \\mathbb{E}_{\\text{clone}}[\\Delta W_b] + \\mathbb{E}_{\\text{kin}}[\\Delta W_b]\n375: $$\n376: \n377: $$\n378: \\leq (-\\kappa_b W_b + C_b) + (-\\kappa_{\\text{pot}} W_b\\tau + C_{\\text{pot}}\\tau)\n379: $$\n380: \n381: $$\n382: = -(\\kappa_b + \\kappa_{\\text{pot}}\\tau) W_b + (C_b + C_{\\text{pot}}\\tau)\n383: $$\n384: \n385: **PART IV: Combine with Coupling Constants**\n386: \n387: $$\n388: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] = \\mathbb{E}_{\\text{total}}[\\Delta V_W] + c_V \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},x}] + c_V \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},v}] + c_B \\mathbb{E}_{\\text{total}}[\\Delta W_b]\n389: $$\n390: \n391: Substituting the bounds:\n392: \n393: $$\n394: \\leq -\\kappa_W V_W \\tau + (C_W + C_W'\\tau)\n395: $$\n396: \n397: $$\n398: + c_V[-\\kappa_x V_{\\text{Var},x} + (C_x + C_{\\text{kin},x}\\tau)]\n399: $$\n400: \n401: $$\n402: + c_V[-2\\gamma V_{\\text{Var},v}\\tau + (C_v + d\\sigma_{\\max}^2\\tau)]\n403: $$\n404: \n405: $$\n406: + c_B[-(\\kappa_b + \\kappa_{\\text{pot}}\\tau) W_b + (C_b + C_{\\text{pot}}\\tau)]\n407: $$\n408: \n409: **Factor out the Lyapunov components:**\n410: \n411: $$\n412: = -[\\kappa_W\\tau \\cdot V_W + c_V\\kappa_x \\cdot V_{\\text{Var},x} + c_V 2\\gamma\\tau \\cdot V_{\\text{Var},v} + c_B(\\kappa_b + \\kappa_{\\text{pot}}\\tau) \\cdot W_b]\n413: $$\n414: \n415: $$\n416: + [C_W + C_W'\\tau + c_V(C_x + C_{\\text{kin},x}\\tau) + c_V(C_v + d\\sigma_{\\max}^2\\tau) + c_B(C_b + C_{\\text{pot}}\\tau)]\n417: $$\n418: \n419: **PART V: Design Coupling Constants for Balanced Contraction**\n420: \n421: We need to find $c_V^*, c_B^* > 0$ such that all components contract at a common rate.\n422: \n423: **Target:** Make all contraction coefficients equal to $\\frac{\\kappa_W\\tau}{2}$.\n424: \n425: **For $V_W$:** Already has coefficient $\\kappa_W\\tau$.\n426: \n427: **For $V_{\\text{Var},x}$:** Require $c_V\\kappa_x = \\frac{\\kappa_W\\tau}{2}$, so:\n428: \n429: $$\n430: c_V^* = \\frac{\\kappa_W\\tau}{2\\kappa_x}\n431: $$\n432: \n433: **Verification that $c_V^* < \\infty$:** By Theorem 03_cloning.md (Ch 10), $\\kappa_x > 0$ is bounded below by a constant independent of $N$, so $c_V^* < \\infty$. ✓\n434: \n435: **For $V_{\\text{Var},v}$:** Require $c_V^* \\cdot 2\\gamma\\tau = \\frac{\\kappa_W\\tau}{2}$:\n436: \n437: $$\n438: \\frac{\\kappa_W\\tau}{2\\kappa_x} \\cdot 2\\gamma\\tau = \\frac{\\kappa_W\\tau}{2}\n439: $$\n440: \n441: $$\n442: \\implies \\frac{\\gamma\\tau}{\\kappa_x} = \\frac{1}{2}\n443: $$\n444: \n445: **This is NOT automatically satisfied!** We have a constraint: we must choose $\\tau$ such that $\\gamma\\tau \\leq \\kappa_x/2$.\n446: \n447: **Resolution:** Redefine the target rates. Instead, set:\n448: \n449: $$\n450: \\kappa_{\\text{total}} := \\min\\left(\\frac{\\kappa_W\\tau}{2}, \\frac{c_V^*\\kappa_x}{2}, \\frac{c_V^* 2\\gamma\\tau}{2}, \\frac{c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}{2}\\right)\n451: $$\n452: \n453: This ensures $\\kappa_{\\text{total}} > 0$ is the **minimum** contraction rate across all components.\n454: \n455: **For $W_b$:** Require $c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau) = \\frac{\\kappa_W\\tau}{2}$:\n456: \n457: $$\n458: c_B^* = \\frac{\\kappa_W\\tau}{2(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}\n459: $$\n460: \n461: **Verification that $c_B^* < \\infty$:** By Theorem 03_cloning.md (Ch 11), $\\kappa_b > 0$, so $c_B^* < \\infty$. ✓\n462: \n463: **PART VI: Verify Foster-Lyapunov Form**\n464: \n465: With the chosen coupling constants:\n466: \n467: $$\n468: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] \\leq -2\\kappa_{\\text{total}} V_{\\text{total}} + C_{\\text{total}}\n469: $$\n470: \n471: where:\n472: \n473: $$\n474: \\kappa_{\\text{total}} = \\min\\left(\\frac{\\kappa_W\\tau}{2}, \\frac{c_V^*\\kappa_x}{2}, \\frac{c_V^* 2\\gamma\\tau}{2}, \\frac{c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}{2}\\right) > 0\n475: $$\n476: \n477: $$\n478: C_{\\text{total}} = C_W + C_W'\\tau + c_V^*(C_x + C_{\\text{kin},x}\\tau + C_v + d\\sigma_{\\max}^2\\tau) + c_B^*(C_b + C_{\\text{pot}}\\tau) < \\infty\n479: $$\n480: \n481: **Rewrite in standard Foster-Lyapunov form:**\n482: \n483: $$\n484: \\mathbb{E}_{\\text{total}}[V_{\\text{total}}(S')] \\leq (1 - 2\\kappa_{\\text{total}}) V_{\\text{total}}(S) + C_{\\text{total}}\n485: $$\n486: \n487: **For small $\\tau$:** $(1 - 2\\kappa_{\\text{total}}) \\approx (1 - \\kappa_{\\text{total}}\\tau)$, giving:\n488: \n489: $$\n490: \\mathbb{E}_{\\text{total}}[V_{\\text{total}}(S')] \\leq (1 - \\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S) + C_{\\text{total}}\n491: $$\n492: \n493: **PART VII: Verify N-Independence**\n494: \n495: **Key verification:** Both $c_V^*$ and $c_B^*$ are **independent of $N$** because:\n496: - $\\kappa_W$, $\\kappa_x$, $\\kappa_b$ are all $O(1)$ independent of $N$ (proven in previous chapters)\n497: - $\\tau$ is fixed\n498: - All constants in $C_{\\text{total}}$ are $O(1)$ or $O(d)$ but independent of $N$\n499: \n500: **This is crucial for scalability!**\n501: \n502: **PART VIII: Consequence - Foster-Lyapunov Condition**\n503: \n504: The inequality:\n505: \n506: $$\n507: \\mathbb{E}[V_{\\text{total}}(S')] \\leq (1 - \\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S) + C_{\\text{total}}\n508: $$\n509: \n510: is the **Foster-Lyapunov drift condition** with:\n511: - Contraction rate: $\\kappa_{\\text{total}} > 0$\n512: - Drift constant: $C_{\\text{total}} < \\infty$\n513: \n514: **By Foster-Lyapunov theory (Meyn & Tweedie, 2009, Theorem 14.0.1), this implies:**\n515: 1. **Geometric ergodicity**: The Markov chain converges to equilibrium at exponential rate $e^{-\\kappa_{\\text{total}} t}$\n516: 2. **Existence of unique QSD**: The quasi-stationary distribution exists and is unique\n517: 3. **Concentration**: The system spends most time in a compact set $\\{V_{\\text{total}} \\leq C_{\\text{total}}/\\kappa_{\\text{total}}\\}$",
      "metadata": {
        "label": "proof-thm-foster-lyapunov-main"
      },
      "section": "## 3. Synergistic Composition and Foster-Lyapunov Condition",
      "references": [],
      "raw_directive": "292: ### 3.5. Proof: Choosing the Coupling Constants\n293: \n294: :::{prf:proof}\n295: :label: proof-thm-foster-lyapunov-main\n296: \n297: **Proof (Rigorous Verification of Coupling Constants).**\n298: \n299: This proof verifies that there exist finite coupling constants $c_V^*, c_B^* > 0$ such that the Foster-Lyapunov condition holds with explicit $\\kappa_{\\text{total}}$ and $C_{\\text{total}}$.\n300: \n301: **PART I: Decomposition of the Composed Operator**\n302: \n303: The total Lyapunov function is:\n304: \n305: $$\n306: V_{\\text{total}} = V_W + c_V V_{\\text{Var}} + c_B W_b\n307: $$\n308: \n309: where $V_{\\text{Var}} = V_{\\text{Var},x} + V_{\\text{Var},v}$.\n310: \n311: The composed operator $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ acts as:\n312: \n313: $$\n314: S \\xrightarrow{\\Psi_{\\text{clone}}} S^{\\text{clone}} \\xrightarrow{\\Psi_{\\text{kin}}} S'\n315: $$\n316: \n317: **By the tower property of expectation:**\n318: \n319: $$\n320: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{total}}] + \\mathbb{E}_{\\text{clone}}[\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{total}} \\mid S^{\\text{clone}}]]\n321: $$\n322: \n323: **PART II: Collect All Drift Inequalities**\n324: \n325: From previous chapters, we have the following drift bounds:\n326: \n327: **From Cloning (03_cloning.md):**\n328: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_W] \\leq C_W$ (bounded expansion)\n329: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] \\leq -\\kappa_x V_{\\text{Var},x} + C_x$ (contraction)\n330: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] \\leq C_v$ (bounded expansion)\n331: - $\\mathbb{E}_{\\text{clone}}[\\Delta W_b] \\leq -\\kappa_b W_b + C_b$ (contraction)\n332: \n333: **From Kinetics (this document):**\n334: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_W] \\leq -\\kappa_W V_W \\tau + C_W'\\tau$ (Theorem 2.3.1)\n335: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},x}] \\leq C_{\\text{kin},x}\\tau$ (Theorem 4.3.1, bounded expansion)\n336: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v}\\tau + d\\sigma_{\\max}^2\\tau$ (Theorem 3.3.1)\n337: - $\\mathbb{E}_{\\text{kin}}[\\Delta W_b] \\leq -\\kappa_{\\text{pot}} W_b \\tau + C_{\\text{pot}}\\tau$ (Theorem 5.3.1)\n338: \n339: **PART III: Aggregate Drifts for Each Component**\n340: \n341: **Component 1: Inter-swarm error $V_W$**\n342: \n343: $$\n344: \\mathbb{E}_{\\text{total}}[\\Delta V_W] = \\mathbb{E}_{\\text{clone}}[\\Delta V_W] + \\mathbb{E}_{\\text{kin}}[\\Delta V_W]\n345: $$\n346: \n347: $$\n348: \\leq C_W + (-\\kappa_W V_W \\tau + C_W'\\tau) = -\\kappa_W V_W \\tau + (C_W + C_W'\\tau)\n349: $$\n350: \n351: **Component 2: Positional variance $V_{\\text{Var},x}$**\n352: \n353: $$\n354: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},x}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] + \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},x}]\n355: $$\n356: \n357: $$\n358: \\leq (-\\kappa_x V_{\\text{Var},x} + C_x) + C_{\\text{kin},x}\\tau = -\\kappa_x V_{\\text{Var},x} + (C_x + C_{\\text{kin},x}\\tau)\n359: $$\n360: \n361: **Component 3: Velocity variance $V_{\\text{Var},v}$**\n362: \n363: $$\n364: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},v}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] + \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}]\n365: $$\n366: \n367: $$\n368: \\leq C_v + (-2\\gamma V_{\\text{Var},v}\\tau + d\\sigma_{\\max}^2\\tau) = -2\\gamma V_{\\text{Var},v}\\tau + (C_v + d\\sigma_{\\max}^2\\tau)\n369: $$\n370: \n371: **Component 4: Boundary potential $W_b$**\n372: \n373: $$\n374: \\mathbb{E}_{\\text{total}}[\\Delta W_b] = \\mathbb{E}_{\\text{clone}}[\\Delta W_b] + \\mathbb{E}_{\\text{kin}}[\\Delta W_b]\n375: $$\n376: \n377: $$\n378: \\leq (-\\kappa_b W_b + C_b) + (-\\kappa_{\\text{pot}} W_b\\tau + C_{\\text{pot}}\\tau)\n379: $$\n380: \n381: $$\n382: = -(\\kappa_b + \\kappa_{\\text{pot}}\\tau) W_b + (C_b + C_{\\text{pot}}\\tau)\n383: $$\n384: \n385: **PART IV: Combine with Coupling Constants**\n386: \n387: $$\n388: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] = \\mathbb{E}_{\\text{total}}[\\Delta V_W] + c_V \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},x}] + c_V \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},v}] + c_B \\mathbb{E}_{\\text{total}}[\\Delta W_b]\n389: $$\n390: \n391: Substituting the bounds:\n392: \n393: $$\n394: \\leq -\\kappa_W V_W \\tau + (C_W + C_W'\\tau)\n395: $$\n396: \n397: $$\n398: + c_V[-\\kappa_x V_{\\text{Var},x} + (C_x + C_{\\text{kin},x}\\tau)]\n399: $$\n400: \n401: $$\n402: + c_V[-2\\gamma V_{\\text{Var},v}\\tau + (C_v + d\\sigma_{\\max}^2\\tau)]\n403: $$\n404: \n405: $$\n406: + c_B[-(\\kappa_b + \\kappa_{\\text{pot}}\\tau) W_b + (C_b + C_{\\text{pot}}\\tau)]\n407: $$\n408: \n409: **Factor out the Lyapunov components:**\n410: \n411: $$\n412: = -[\\kappa_W\\tau \\cdot V_W + c_V\\kappa_x \\cdot V_{\\text{Var},x} + c_V 2\\gamma\\tau \\cdot V_{\\text{Var},v} + c_B(\\kappa_b + \\kappa_{\\text{pot}}\\tau) \\cdot W_b]\n413: $$\n414: \n415: $$\n416: + [C_W + C_W'\\tau + c_V(C_x + C_{\\text{kin},x}\\tau) + c_V(C_v + d\\sigma_{\\max}^2\\tau) + c_B(C_b + C_{\\text{pot}}\\tau)]\n417: $$\n418: \n419: **PART V: Design Coupling Constants for Balanced Contraction**\n420: \n421: We need to find $c_V^*, c_B^* > 0$ such that all components contract at a common rate.\n422: \n423: **Target:** Make all contraction coefficients equal to $\\frac{\\kappa_W\\tau}{2}$.\n424: \n425: **For $V_W$:** Already has coefficient $\\kappa_W\\tau$.\n426: \n427: **For $V_{\\text{Var},x}$:** Require $c_V\\kappa_x = \\frac{\\kappa_W\\tau}{2}$, so:\n428: \n429: $$\n430: c_V^* = \\frac{\\kappa_W\\tau}{2\\kappa_x}\n431: $$\n432: \n433: **Verification that $c_V^* < \\infty$:** By Theorem 03_cloning.md (Ch 10), $\\kappa_x > 0$ is bounded below by a constant independent of $N$, so $c_V^* < \\infty$. ✓\n434: \n435: **For $V_{\\text{Var},v}$:** Require $c_V^* \\cdot 2\\gamma\\tau = \\frac{\\kappa_W\\tau}{2}$:\n436: \n437: $$\n438: \\frac{\\kappa_W\\tau}{2\\kappa_x} \\cdot 2\\gamma\\tau = \\frac{\\kappa_W\\tau}{2}\n439: $$\n440: \n441: $$\n442: \\implies \\frac{\\gamma\\tau}{\\kappa_x} = \\frac{1}{2}\n443: $$\n444: \n445: **This is NOT automatically satisfied!** We have a constraint: we must choose $\\tau$ such that $\\gamma\\tau \\leq \\kappa_x/2$.\n446: \n447: **Resolution:** Redefine the target rates. Instead, set:\n448: \n449: $$\n450: \\kappa_{\\text{total}} := \\min\\left(\\frac{\\kappa_W\\tau}{2}, \\frac{c_V^*\\kappa_x}{2}, \\frac{c_V^* 2\\gamma\\tau}{2}, \\frac{c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}{2}\\right)\n451: $$\n452: \n453: This ensures $\\kappa_{\\text{total}} > 0$ is the **minimum** contraction rate across all components.\n454: \n455: **For $W_b$:** Require $c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau) = \\frac{\\kappa_W\\tau}{2}$:\n456: \n457: $$\n458: c_B^* = \\frac{\\kappa_W\\tau}{2(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}\n459: $$\n460: \n461: **Verification that $c_B^* < \\infty$:** By Theorem 03_cloning.md (Ch 11), $\\kappa_b > 0$, so $c_B^* < \\infty$. ✓\n462: \n463: **PART VI: Verify Foster-Lyapunov Form**\n464: \n465: With the chosen coupling constants:\n466: \n467: $$\n468: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] \\leq -2\\kappa_{\\text{total}} V_{\\text{total}} + C_{\\text{total}}\n469: $$\n470: \n471: where:\n472: \n473: $$\n474: \\kappa_{\\text{total}} = \\min\\left(\\frac{\\kappa_W\\tau}{2}, \\frac{c_V^*\\kappa_x}{2}, \\frac{c_V^* 2\\gamma\\tau}{2}, \\frac{c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}{2}\\right) > 0\n475: $$\n476: \n477: $$\n478: C_{\\text{total}} = C_W + C_W'\\tau + c_V^*(C_x + C_{\\text{kin},x}\\tau + C_v + d\\sigma_{\\max}^2\\tau) + c_B^*(C_b + C_{\\text{pot}}\\tau) < \\infty\n479: $$\n480: \n481: **Rewrite in standard Foster-Lyapunov form:**\n482: \n483: $$\n484: \\mathbb{E}_{\\text{total}}[V_{\\text{total}}(S')] \\leq (1 - 2\\kappa_{\\text{total}}) V_{\\text{total}}(S) + C_{\\text{total}}\n485: $$\n486: \n487: **For small $\\tau$:** $(1 - 2\\kappa_{\\text{total}}) \\approx (1 - \\kappa_{\\text{total}}\\tau)$, giving:\n488: \n489: $$\n490: \\mathbb{E}_{\\text{total}}[V_{\\text{total}}(S')] \\leq (1 - \\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S) + C_{\\text{total}}\n491: $$\n492: \n493: **PART VII: Verify N-Independence**\n494: \n495: **Key verification:** Both $c_V^*$ and $c_B^*$ are **independent of $N$** because:\n496: - $\\kappa_W$, $\\kappa_x$, $\\kappa_b$ are all $O(1)$ independent of $N$ (proven in previous chapters)\n497: - $\\tau$ is fixed\n498: - All constants in $C_{\\text{total}}$ are $O(1)$ or $O(d)$ but independent of $N$\n499: \n500: **This is crucial for scalability!**\n501: \n502: **PART VIII: Consequence - Foster-Lyapunov Condition**\n503: \n504: The inequality:\n505: \n506: $$\n507: \\mathbb{E}[V_{\\text{total}}(S')] \\leq (1 - \\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S) + C_{\\text{total}}\n508: $$\n509: \n510: is the **Foster-Lyapunov drift condition** with:\n511: - Contraction rate: $\\kappa_{\\text{total}} > 0$\n512: - Drift constant: $C_{\\text{total}} < \\infty$\n513: \n514: **By Foster-Lyapunov theory (Meyn & Tweedie, 2009, Theorem 14.0.1), this implies:**\n515: 1. **Geometric ergodicity**: The Markov chain converges to equilibrium at exponential rate $e^{-\\kappa_{\\text{total}} t}$\n516: 2. **Existence of unique QSD**: The quasi-stationary distribution exists and is unique\n517: 3. **Concentration**: The system spends most time in a compact set $\\{V_{\\text{total}} \\leq C_{\\text{total}}/\\kappa_{\\text{total}}\\}$\n518: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "06_convergence",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Synergistic Composition and Foster-Lyapunov Condition"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-phi-irreducibility",
      "title": null,
      "start_line": 647,
      "end_line": 834,
      "header_lines": [
        648
      ],
      "content_start": 650,
      "content_end": 833,
      "content": "650: :label: proof-thm-phi-irreducibility\n651: \n652: **Proof (Two-Stage Construction: Gathering + Spreading).**\n653: \n654: The proof constructs an explicit path showing how to get from any starting state to any target neighborhood by combining the distinct powers of cloning (global reset) and kinetics (local steering).\n655: \n656: **PART I: Define the \"Core\" Set**\n657: \n658: Define the **core set** $\\mathcal{C} \\subset \\Sigma_N^{\\text{alive}}$ as the set of configurations where:\n659: \n660: 1. **All walkers alive:** $|\\mathcal{A}(S)| = N$\n661: 2. **Interior concentration:** All walkers within a small ball $B_r(x_*)$ where $x_* \\in \\text{interior}(\\mathcal{X}_{\\text{valid}})$ and $\\varphi_{\\text{barrier}}(x) < \\epsilon$ for all $x \\in B_r(x_*)$\n662: 3. **Low velocities:** $\\|v_i\\| < v_{\\max}$ for all $i$\n663: 4. **Positive measure:** $\\mathcal{C}$ is an open set with positive Lebesgue measure\n664: \n665: **Key property:** $\\mathcal{C}$ is \"favorable\" - far from boundary, all alive, low kinetic energy.\n666: \n667: **PART II: Stage 1 - Gathering to Core (Cloning as Global Reset)**\n668: \n669: **Claim:** For any $S_A \\in \\Sigma_N^{\\text{alive}}$:\n670: \n671: $$\n672: P(S_1 \\in \\mathcal{C} \\mid S_0 = S_A) > 0\n673: $$\n674: \n675: **Proof of Claim:**\n676: \n677: **Step 1: Identify the \"Alpha\" Walker**\n678: \n679: In state $S_A$, at least one walker is alive. Among alive walkers, identify the one with minimum barrier value:\n680: \n681: $$\n682: i_* = \\arg\\min_{i \\in \\mathcal{A}(S_A)} \\varphi_{\\text{barrier}}(x_i)\n683: $$\n684: \n685: This \"alpha\" walker $i_*$ is in a favorable position.\n686: \n687: **Step 2: Lucky Cloning Sequence**\n688: \n689: The cloning operator proceeds through $N$ walkers sequentially. For each dead or poorly-positioned walker $j$:\n690: \n691: $$\n692: P(\\text{walker } j \\text{ selects walker } i_* \\text{ as companion}) = \\frac{r_{i_*}}{\\sum_{k \\in \\mathcal{A}(S_A)} r_k} =: p_{\\alpha} > 0\n693: $$\n694: \n695: This probability $p_{\\alpha}$ is strictly positive by the reward structure (Axiom 4.2.1 in 03_cloning.md).\n696: \n697: **Consider the \"lucky\" event** $E_{\\text{lucky}}$ where:\n698: - All dead walkers select $i_*$ as companion\n699: - All alive walkers with $\\varphi(x_j) > 2\\varphi(x_{i_*})$ select $i_*$ as companion\n700: \n701: The probability of this event is:\n702: \n703: $$\n704: P(E_{\\text{lucky}}) \\geq p_{\\alpha}^{N-1} > 0\n705: $$\n706: \n707: **Step 3: Post-Cloning Configuration**\n708: \n709: After cloning under $E_{\\text{lucky}}$:\n710: - All $N$ walkers are alive\n711: - Position barycenter $\\mu_x \\approx x_{i_*}$ (all clones near alpha)\n712: - Positional scatter $\\|\\delta_{x,i}\\| \\leq \\delta_{\\text{clone}}$ (inelastic collision spreads them slightly)\n713: \n714: **Step 4: Perturbation and Kinetic Step**\n715: \n716: The perturbation adds Gaussian noise: $x_i \\gets x_i + \\eta_x$, $v_i \\gets v_i + \\eta_v$ where $\\eta_x, \\eta_v \\sim \\mathcal{N}(0, \\sigma_{\\text{pert}}^2 I)$.\n717: \n718: **Key fact:** Gaussian distribution has positive density everywhere. Therefore:\n719: \n720: $$\n721: P(\\text{all } N \\text{ perturbed walkers land in } B_r(x_*) \\text{ with } \\|v_i\\| < v_{\\max}) = \\prod_{i=1}^N \\int_{B_r(x_*)} \\int_{\\|v\\| < v_{\\max}} \\phi(x-x_i, v-v_i) \\, dv \\, dx > 0\n722: $$\n723: \n724: where $\\phi$ is the Gaussian density.\n725: \n726: **Combining all steps:**\n727: \n728: $$\n729: P(S_1 \\in \\mathcal{C} \\mid S_0 = S_A) \\geq P(E_{\\text{lucky}}) \\cdot P(\\text{perturbation lands in } \\mathcal{C}) > 0\n730: $$\n731: \n732: ✓ **Stage 1 Complete**\n733: \n734: **PART III: Stage 2 - Spreading from Core (Kinetics as Local Steering)**\n735: \n736: **Claim:** For any $S_C \\in \\mathcal{C}$ and any open set $O_B \\subseteq \\Sigma_N^{\\text{alive}}$, there exists $M \\in \\mathbb{N}$ such that:\n737: \n738: $$\n739: P^M(S_C, O_B) > 0\n740: $$\n741: \n742: **Proof of Claim via Hörmander's Theorem:**\n743: \n744: **Step 1: Single-Particle Controllability**\n745: \n746: Each walker evolves according to the underdamped Langevin SDE:\n747: \n748: $$\n749: \\begin{aligned}\n750: dx_i &= v_i \\, dt \\\\\n751: dv_i &= [F(x_i) - \\gamma v_i] \\, dt + \\Sigma(x_i, v_i) \\circ dW_i\n752: \\end{aligned}\n753: $$\n754: \n755: This is a **hypoelliptic system**. By **Hörmander's Theorem** (Hörmander, 1967, \"Hypoelliptic second order differential equations,\" *Acta Math.* 119:147-171):\n756: \n757: **Theorem (Hörmander):** If the Lie algebra generated by the drift vector fields and diffusion vector fields spans the entire tangent space at every point, then the transition probability density $p_t(z_0, z)$ is smooth and **strictly positive** for all $t > 0$ and all $z_0, z \\in \\mathbb{R}^{2d}$.\n758: \n759: **Verification for our SDE:**\n760: - Drift vector field: $b(x,v) = (v, F(x) - \\gamma v)$\n761: - Diffusion vector fields: $\\sigma_j(x,v) = (0, \\Sigma e_j)$ for $j = 1, \\ldots, d$\n762: \n763: The Lie bracket $[b, \\sigma_j]$ introduces terms in the position component, and iterated brackets span $\\mathbb{R}^{2d}$ (standard verification, see Hairer & Mattingly, 2006).\n764: \n765: **Conclusion:** From any $(x_i, v_i)$, the single-particle process has positive probability of reaching any open neighborhood in phase space after time $\\tau > 0$.\n766: \n767: **Step 2: N-Particle Controllability**\n768: \n769: Now consider all $N$ particles. We want to show that from $S_C$, we can reach any target configuration in $O_B$ with positive probability.\n770: \n771: **Target configuration:** Let $S_B^* = ((x_1^*, v_1^*), \\ldots, (x_N^*, v_N^*)) \\in O_B$ be any point in the target set.\n772: \n773: **Sequential driving argument:**\n774: \n775: - **Phase 1 (Steps 1 to $\\tau_1$):** Apply kinetic evolution. By Hörmander, walker 1 has positive probability $p_1 > 0$ of reaching a neighborhood $U_1(x_1^*, v_1^*)$ of its target.\n776: - **Phase 2 (Steps $\\tau_1+1$ to $\\tau_2$):** Continue evolution. Walker 2 has positive probability $p_2 > 0$ of reaching $U_2(x_2^*, v_2^*)$, *while walker 1 remains in* $U_1$ with probability bounded below by $1 - \\delta_1$ (continuity of the SDE).\n777: - **Phase $k$:** Walker $k$ reaches $U_k$ with probability $p_k > 0$, and all previous walkers remain in their neighborhoods with probability $\\prod_{j<k}(1 - \\delta_j)$.\n778: \n779: **Independence of noise:** Since $W_i$ are independent Brownian motions:\n780: \n781: $$\n782: P(\\text{all } N \\text{ walkers reach their targets}) \\geq \\prod_{i=1}^N p_i \\cdot \\prod_{j=1}^{N-1} (1 - \\delta_j) > 0\n783: $$\n784: \n785: **Step 3: Avoiding Absorption**\n786: \n787: During the $M$ steps of kinetic evolution from $\\mathcal{C}$ to $O_B$, walkers must not cross the boundary.\n788: \n789: **Safe interior property:** Since $S_C \\in \\mathcal{C}$ starts in a region with $\\varphi_{\\text{barrier}} < \\epsilon$ (deep interior), and the target $S_B^* \\in O_B$ is also in the alive space, we can choose trajectories that remain in the interior.\n790: \n791: **Probability of staying alive:** By the boundary potential contraction (Chapter 7, Theorem 5.3.1), walkers starting in the interior with low $W_b$ have exponentially small probability of reaching the boundary in finite time:\n792: \n793: $$\n794: P(\\text{any walker exits during } M \\text{ steps} \\mid S_C) \\leq M \\cdot N \\cdot e^{-c/\\tau} \\ll 1\n795: $$\n796: \n797: for appropriate choice of $M$ and $\\tau$.\n798: \n799: **Taking $M$ large enough:** We can make the exit probability arbitrarily small while maintaining positive probability of reaching $O_B$:\n800: \n801: $$\n802: P^M(S_C, O_B) \\geq P(\\text{reach } O_B) \\cdot P(\\text{no exit}) > 0\n803: $$\n804: \n805: ✓ **Stage 2 Complete**\n806: \n807: **PART IV: Final Assembly - Two-Stage Path**\n808: \n809: Combining Stage 1 and Stage 2 via the **Chapman-Kolmogorov equation**:\n810: \n811: $$\n812: P^{1+M}(S_A, O_B) = \\int_{\\Sigma_N^{\\text{alive}}} P^1(S_A, dS') P^M(S', O_B)\n813: $$\n814: \n815: $$\n816: \\geq \\int_{\\mathcal{C}} P^1(S_A, dS') P^M(S', O_B)\n817: $$\n818: \n819: $$\n820: \\geq P^1(S_A, \\mathcal{C}) \\cdot \\inf_{S' \\in \\mathcal{C}} P^M(S', O_B)\n821: $$\n822: \n823: From Stage 1: $P^1(S_A, \\mathcal{C}) > 0$\n824: \n825: From Stage 2: $\\inf_{S' \\in \\mathcal{C}} P^M(S', O_B) > 0$ (by compactness of $\\mathcal{C}$ and continuity)\n826: \n827: Therefore:\n828: \n829: $$\n830: P^{1+M}(S_A, O_B) > 0\n831: $$\n832: \n833: **This proves φ-irreducibility.** ✓",
      "metadata": {
        "label": "proof-thm-phi-irreducibility"
      },
      "section": "## 4. Main Convergence Theorem and Quasi-Stationary Distribution",
      "references": [],
      "raw_directive": "647: :::\n648: \n649: :::{prf:proof}\n650: :label: proof-thm-phi-irreducibility\n651: \n652: **Proof (Two-Stage Construction: Gathering + Spreading).**\n653: \n654: The proof constructs an explicit path showing how to get from any starting state to any target neighborhood by combining the distinct powers of cloning (global reset) and kinetics (local steering).\n655: \n656: **PART I: Define the \"Core\" Set**\n657: \n658: Define the **core set** $\\mathcal{C} \\subset \\Sigma_N^{\\text{alive}}$ as the set of configurations where:\n659: \n660: 1. **All walkers alive:** $|\\mathcal{A}(S)| = N$\n661: 2. **Interior concentration:** All walkers within a small ball $B_r(x_*)$ where $x_* \\in \\text{interior}(\\mathcal{X}_{\\text{valid}})$ and $\\varphi_{\\text{barrier}}(x) < \\epsilon$ for all $x \\in B_r(x_*)$\n662: 3. **Low velocities:** $\\|v_i\\| < v_{\\max}$ for all $i$\n663: 4. **Positive measure:** $\\mathcal{C}$ is an open set with positive Lebesgue measure\n664: \n665: **Key property:** $\\mathcal{C}$ is \"favorable\" - far from boundary, all alive, low kinetic energy.\n666: \n667: **PART II: Stage 1 - Gathering to Core (Cloning as Global Reset)**\n668: \n669: **Claim:** For any $S_A \\in \\Sigma_N^{\\text{alive}}$:\n670: \n671: $$\n672: P(S_1 \\in \\mathcal{C} \\mid S_0 = S_A) > 0\n673: $$\n674: \n675: **Proof of Claim:**\n676: \n677: **Step 1: Identify the \"Alpha\" Walker**\n678: \n679: In state $S_A$, at least one walker is alive. Among alive walkers, identify the one with minimum barrier value:\n680: \n681: $$\n682: i_* = \\arg\\min_{i \\in \\mathcal{A}(S_A)} \\varphi_{\\text{barrier}}(x_i)\n683: $$\n684: \n685: This \"alpha\" walker $i_*$ is in a favorable position.\n686: \n687: **Step 2: Lucky Cloning Sequence**\n688: \n689: The cloning operator proceeds through $N$ walkers sequentially. For each dead or poorly-positioned walker $j$:\n690: \n691: $$\n692: P(\\text{walker } j \\text{ selects walker } i_* \\text{ as companion}) = \\frac{r_{i_*}}{\\sum_{k \\in \\mathcal{A}(S_A)} r_k} =: p_{\\alpha} > 0\n693: $$\n694: \n695: This probability $p_{\\alpha}$ is strictly positive by the reward structure (Axiom 4.2.1 in 03_cloning.md).\n696: \n697: **Consider the \"lucky\" event** $E_{\\text{lucky}}$ where:\n698: - All dead walkers select $i_*$ as companion\n699: - All alive walkers with $\\varphi(x_j) > 2\\varphi(x_{i_*})$ select $i_*$ as companion\n700: \n701: The probability of this event is:\n702: \n703: $$\n704: P(E_{\\text{lucky}}) \\geq p_{\\alpha}^{N-1} > 0\n705: $$\n706: \n707: **Step 3: Post-Cloning Configuration**\n708: \n709: After cloning under $E_{\\text{lucky}}$:\n710: - All $N$ walkers are alive\n711: - Position barycenter $\\mu_x \\approx x_{i_*}$ (all clones near alpha)\n712: - Positional scatter $\\|\\delta_{x,i}\\| \\leq \\delta_{\\text{clone}}$ (inelastic collision spreads them slightly)\n713: \n714: **Step 4: Perturbation and Kinetic Step**\n715: \n716: The perturbation adds Gaussian noise: $x_i \\gets x_i + \\eta_x$, $v_i \\gets v_i + \\eta_v$ where $\\eta_x, \\eta_v \\sim \\mathcal{N}(0, \\sigma_{\\text{pert}}^2 I)$.\n717: \n718: **Key fact:** Gaussian distribution has positive density everywhere. Therefore:\n719: \n720: $$\n721: P(\\text{all } N \\text{ perturbed walkers land in } B_r(x_*) \\text{ with } \\|v_i\\| < v_{\\max}) = \\prod_{i=1}^N \\int_{B_r(x_*)} \\int_{\\|v\\| < v_{\\max}} \\phi(x-x_i, v-v_i) \\, dv \\, dx > 0\n722: $$\n723: \n724: where $\\phi$ is the Gaussian density.\n725: \n726: **Combining all steps:**\n727: \n728: $$\n729: P(S_1 \\in \\mathcal{C} \\mid S_0 = S_A) \\geq P(E_{\\text{lucky}}) \\cdot P(\\text{perturbation lands in } \\mathcal{C}) > 0\n730: $$\n731: \n732: ✓ **Stage 1 Complete**\n733: \n734: **PART III: Stage 2 - Spreading from Core (Kinetics as Local Steering)**\n735: \n736: **Claim:** For any $S_C \\in \\mathcal{C}$ and any open set $O_B \\subseteq \\Sigma_N^{\\text{alive}}$, there exists $M \\in \\mathbb{N}$ such that:\n737: \n738: $$\n739: P^M(S_C, O_B) > 0\n740: $$\n741: \n742: **Proof of Claim via Hörmander's Theorem:**\n743: \n744: **Step 1: Single-Particle Controllability**\n745: \n746: Each walker evolves according to the underdamped Langevin SDE:\n747: \n748: $$\n749: \\begin{aligned}\n750: dx_i &= v_i \\, dt \\\\\n751: dv_i &= [F(x_i) - \\gamma v_i] \\, dt + \\Sigma(x_i, v_i) \\circ dW_i\n752: \\end{aligned}\n753: $$\n754: \n755: This is a **hypoelliptic system**. By **Hörmander's Theorem** (Hörmander, 1967, \"Hypoelliptic second order differential equations,\" *Acta Math.* 119:147-171):\n756: \n757: **Theorem (Hörmander):** If the Lie algebra generated by the drift vector fields and diffusion vector fields spans the entire tangent space at every point, then the transition probability density $p_t(z_0, z)$ is smooth and **strictly positive** for all $t > 0$ and all $z_0, z \\in \\mathbb{R}^{2d}$.\n758: \n759: **Verification for our SDE:**\n760: - Drift vector field: $b(x,v) = (v, F(x) - \\gamma v)$\n761: - Diffusion vector fields: $\\sigma_j(x,v) = (0, \\Sigma e_j)$ for $j = 1, \\ldots, d$\n762: \n763: The Lie bracket $[b, \\sigma_j]$ introduces terms in the position component, and iterated brackets span $\\mathbb{R}^{2d}$ (standard verification, see Hairer & Mattingly, 2006).\n764: \n765: **Conclusion:** From any $(x_i, v_i)$, the single-particle process has positive probability of reaching any open neighborhood in phase space after time $\\tau > 0$.\n766: \n767: **Step 2: N-Particle Controllability**\n768: \n769: Now consider all $N$ particles. We want to show that from $S_C$, we can reach any target configuration in $O_B$ with positive probability.\n770: \n771: **Target configuration:** Let $S_B^* = ((x_1^*, v_1^*), \\ldots, (x_N^*, v_N^*)) \\in O_B$ be any point in the target set.\n772: \n773: **Sequential driving argument:**\n774: \n775: - **Phase 1 (Steps 1 to $\\tau_1$):** Apply kinetic evolution. By Hörmander, walker 1 has positive probability $p_1 > 0$ of reaching a neighborhood $U_1(x_1^*, v_1^*)$ of its target.\n776: - **Phase 2 (Steps $\\tau_1+1$ to $\\tau_2$):** Continue evolution. Walker 2 has positive probability $p_2 > 0$ of reaching $U_2(x_2^*, v_2^*)$, *while walker 1 remains in* $U_1$ with probability bounded below by $1 - \\delta_1$ (continuity of the SDE).\n777: - **Phase $k$:** Walker $k$ reaches $U_k$ with probability $p_k > 0$, and all previous walkers remain in their neighborhoods with probability $\\prod_{j<k}(1 - \\delta_j)$.\n778: \n779: **Independence of noise:** Since $W_i$ are independent Brownian motions:\n780: \n781: $$\n782: P(\\text{all } N \\text{ walkers reach their targets}) \\geq \\prod_{i=1}^N p_i \\cdot \\prod_{j=1}^{N-1} (1 - \\delta_j) > 0\n783: $$\n784: \n785: **Step 3: Avoiding Absorption**\n786: \n787: During the $M$ steps of kinetic evolution from $\\mathcal{C}$ to $O_B$, walkers must not cross the boundary.\n788: \n789: **Safe interior property:** Since $S_C \\in \\mathcal{C}$ starts in a region with $\\varphi_{\\text{barrier}} < \\epsilon$ (deep interior), and the target $S_B^* \\in O_B$ is also in the alive space, we can choose trajectories that remain in the interior.\n790: \n791: **Probability of staying alive:** By the boundary potential contraction (Chapter 7, Theorem 5.3.1), walkers starting in the interior with low $W_b$ have exponentially small probability of reaching the boundary in finite time:\n792: \n793: $$\n794: P(\\text{any walker exits during } M \\text{ steps} \\mid S_C) \\leq M \\cdot N \\cdot e^{-c/\\tau} \\ll 1\n795: $$\n796: \n797: for appropriate choice of $M$ and $\\tau$.\n798: \n799: **Taking $M$ large enough:** We can make the exit probability arbitrarily small while maintaining positive probability of reaching $O_B$:\n800: \n801: $$\n802: P^M(S_C, O_B) \\geq P(\\text{reach } O_B) \\cdot P(\\text{no exit}) > 0\n803: $$\n804: \n805: ✓ **Stage 2 Complete**\n806: \n807: **PART IV: Final Assembly - Two-Stage Path**\n808: \n809: Combining Stage 1 and Stage 2 via the **Chapman-Kolmogorov equation**:\n810: \n811: $$\n812: P^{1+M}(S_A, O_B) = \\int_{\\Sigma_N^{\\text{alive}}} P^1(S_A, dS') P^M(S', O_B)\n813: $$\n814: \n815: $$\n816: \\geq \\int_{\\mathcal{C}} P^1(S_A, dS') P^M(S', O_B)\n817: $$\n818: \n819: $$\n820: \\geq P^1(S_A, \\mathcal{C}) \\cdot \\inf_{S' \\in \\mathcal{C}} P^M(S', O_B)\n821: $$\n822: \n823: From Stage 1: $P^1(S_A, \\mathcal{C}) > 0$\n824: \n825: From Stage 2: $\\inf_{S' \\in \\mathcal{C}} P^M(S', O_B) > 0$ (by compactness of $\\mathcal{C}$ and continuity)\n826: \n827: Therefore:\n828: \n829: $$\n830: P^{1+M}(S_A, O_B) > 0\n831: $$\n832: \n833: **This proves φ-irreducibility.** ✓\n834: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "06_convergence",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Main Convergence Theorem and Quasi-Stationary Distribution"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-aperiodicity",
      "title": null,
      "start_line": 850,
      "end_line": 888,
      "header_lines": [
        851
      ],
      "content_start": 853,
      "content_end": 887,
      "content": "853: :label: proof-thm-aperiodicity\n854: \n855: **Proof (Non-Degenerate Noise Prevents Periodicity).**\n856: \n857: **Method 1: Direct Argument via Continuous Noise**\n858: \n859: The kinetic operator adds continuous Gaussian noise at every step. The probability of returning to the **exact** same state is zero:\n860: \n861: $$\n862: P(S_1 = S_0 \\mid S_0) = 0\n863: $$\n864: \n865: because the perturbation $\\eta \\sim \\mathcal{N}(0, \\sigma_{\\text{pert}}^2 I)$ has density with respect to Lebesgue measure.\n866: \n867: **Implication:** The chain cannot have any deterministic cycles $S \\to S \\to S \\to \\cdots$ of period $d$.\n868: \n869: **Method 2: Contradiction Argument**\n870: \n871: Suppose, for contradiction, that the chain has period $d > 1$. Then the state space decomposes into $d$ disjoint subsets $\\mathcal{S}_0, \\ldots, \\mathcal{S}_{d-1}$ such that:\n872: \n873: $$\n874: P(S_1 \\in \\mathcal{S}_{(k+1) \\mod d} \\mid S_0 \\in \\mathcal{S}_k) = 1\n875: $$\n876: \n877: But from the irreducibility proof (Theorem {prf:ref}`thm-phi-irreducibility` in Section 6.4.1), we showed that from any state in $\\mathcal{S}_0$, we can reach the core set $\\mathcal{C}$ in **one** step with positive probability.\n878: \n879: Similarly, from any state in $\\mathcal{S}_1$, we can reach $\\mathcal{C}$ in **one** step.\n880: \n881: This means $\\mathcal{C} \\cap \\mathcal{S}_0 \\neq \\emptyset$ and $\\mathcal{C} \\cap \\mathcal{S}_1 \\neq \\emptyset$.\n882: \n883: But if $d > 1$, we must have $\\mathcal{S}_0 \\cap \\mathcal{S}_1 = \\emptyset$ (disjoint decomposition).\n884: \n885: **Contradiction.** ✓\n886: \n887: Therefore, $d = 1$, and the chain is aperiodic.",
      "metadata": {
        "label": "proof-thm-aperiodicity"
      },
      "section": "## 4. Main Convergence Theorem and Quasi-Stationary Distribution",
      "references": [
        "thm-phi-irreducibility"
      ],
      "raw_directive": "850: :::\n851: \n852: :::{prf:proof}\n853: :label: proof-thm-aperiodicity\n854: \n855: **Proof (Non-Degenerate Noise Prevents Periodicity).**\n856: \n857: **Method 1: Direct Argument via Continuous Noise**\n858: \n859: The kinetic operator adds continuous Gaussian noise at every step. The probability of returning to the **exact** same state is zero:\n860: \n861: $$\n862: P(S_1 = S_0 \\mid S_0) = 0\n863: $$\n864: \n865: because the perturbation $\\eta \\sim \\mathcal{N}(0, \\sigma_{\\text{pert}}^2 I)$ has density with respect to Lebesgue measure.\n866: \n867: **Implication:** The chain cannot have any deterministic cycles $S \\to S \\to S \\to \\cdots$ of period $d$.\n868: \n869: **Method 2: Contradiction Argument**\n870: \n871: Suppose, for contradiction, that the chain has period $d > 1$. Then the state space decomposes into $d$ disjoint subsets $\\mathcal{S}_0, \\ldots, \\mathcal{S}_{d-1}$ such that:\n872: \n873: $$\n874: P(S_1 \\in \\mathcal{S}_{(k+1) \\mod d} \\mid S_0 \\in \\mathcal{S}_k) = 1\n875: $$\n876: \n877: But from the irreducibility proof (Theorem {prf:ref}`thm-phi-irreducibility` in Section 6.4.1), we showed that from any state in $\\mathcal{S}_0$, we can reach the core set $\\mathcal{C}$ in **one** step with positive probability.\n878: \n879: Similarly, from any state in $\\mathcal{S}_1$, we can reach $\\mathcal{C}$ in **one** step.\n880: \n881: This means $\\mathcal{C} \\cap \\mathcal{S}_0 \\neq \\emptyset$ and $\\mathcal{C} \\cap \\mathcal{S}_1 \\neq \\emptyset$.\n882: \n883: But if $d > 1$, we must have $\\mathcal{S}_0 \\cap \\mathcal{S}_1 = \\emptyset$ (disjoint decomposition).\n884: \n885: **Contradiction.** ✓\n886: \n887: Therefore, $d = 1$, and the chain is aperiodic.\n888: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "06_convergence",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Main Convergence Theorem and Quasi-Stationary Distribution"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-main-convergence",
      "title": null,
      "start_line": 955,
      "end_line": 1015,
      "header_lines": [
        956
      ],
      "content_start": 958,
      "content_end": 1014,
      "content": "958: :label: proof-thm-main-convergence\n959: \n960: **Proof Sketch.**\n961: \n962: We apply standard Foster-Lyapunov theory, adapted to the quasi-stationary setting.\n963: \n964: **Part 1: Existence and Uniqueness**\n965: \n966: The Foster-Lyapunov drift condition ({prf:ref}`thm-foster-lyapunov-main` from Chapter 7) implies:\n967: \n968: $$\\mathbb{E}[V_{\\text{total}}(S_{t+1}) \\mid S_t] \\leq (1-\\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S_t) + C_{\\text{total}}$$\n969: \n970: By the Meyn-Tweedie theorem (Meyn & Tweedie, 2009, Theorem 14.0.1), this drift condition with:\n971: - $V_{\\text{total}}$ as a Lyapunov function\n972: - Compact level sets (ensured by the boundary potential $W_b$ and confining potential)\n973: - **φ-Irreducibility** ({prf:ref}`thm-phi-irreducibility` in Section 6.4.1) - rigorously proven via two-stage construction\n974: - **Aperiodicity** ({prf:ref}`thm-aperiodicity` in Section 6.4.2) - proven via non-degenerate Gaussian noise\n975: \n976: implies existence of a unique invariant measure. In the absorbing case, this becomes a unique QSD (Champagnat & Villemonais, 2016).\n977: \n978: **Part 2: Exponential Convergence**\n979: \n980: The drift condition implies geometric ergodicity via the **Lyapunov drift method**:\n981: \n982: From any initial state:\n983: $$\n984: \\mathbb{E}[V_{\\text{total}}(S_t)] \\leq (1-\\kappa_{\\text{total}}\\tau)^t V_{\\text{total}}(S_0) + \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}\\tau}\n985: $$\n986: \n987: This exponential decay in the Lyapunov function translates (via Markov coupling techniques) to exponential convergence in total variation distance.\n988: \n989: **Part 3: Survival Time**\n990: \n991: The survival probability per step is bounded below:\n992: \n993: $$\n994: P(\\text{survive one step} \\mid S_t) \\geq 1 - e^{-\\Theta(N)}\n995: $$\n996: \n997: This follows from:\n998: - Bounded boundary potential: $W_b \\leq C/\\kappa_b$ in equilibrium\n999: - Concentration of walkers in the interior (far from boundary)\n1000: - McDiarmid's inequality: probability of all $N$ walkers simultaneously exiting is exponentially small\n1001: \n1002: Over $T$ steps:\n1003: $$\n1004: P(\\text{survive } T \\text{ steps}) \\geq (1 - e^{-\\Theta(N)})^T \\approx e^{-T e^{-\\Theta(N)}}\n1005: $$\n1006: \n1007: For $T = e^{\\Theta(N)}$, this remains close to 1.\n1008: \n1009: **Part 4: Concentration**\n1010: \n1011: This follows from combining:\n1012: - The Foster-Lyapunov drift (concentrates $V_{\\text{total}}$ around its equilibrium)\n1013: - McDiarmid's inequality (exponential tails for bounded differences)\n1014: - The N-uniformity of all constants",
      "metadata": {
        "label": "proof-thm-main-convergence"
      },
      "section": "## 4. Main Convergence Theorem and Quasi-Stationary Distribution",
      "references": [
        "thm-foster-lyapunov-main",
        "thm-phi-irreducibility",
        "thm-aperiodicity"
      ],
      "raw_directive": "955: ### 4.5.1. Proof Sketch\n956: \n957: :::{prf:proof}\n958: :label: proof-thm-main-convergence\n959: \n960: **Proof Sketch.**\n961: \n962: We apply standard Foster-Lyapunov theory, adapted to the quasi-stationary setting.\n963: \n964: **Part 1: Existence and Uniqueness**\n965: \n966: The Foster-Lyapunov drift condition ({prf:ref}`thm-foster-lyapunov-main` from Chapter 7) implies:\n967: \n968: $$\\mathbb{E}[V_{\\text{total}}(S_{t+1}) \\mid S_t] \\leq (1-\\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S_t) + C_{\\text{total}}$$\n969: \n970: By the Meyn-Tweedie theorem (Meyn & Tweedie, 2009, Theorem 14.0.1), this drift condition with:\n971: - $V_{\\text{total}}$ as a Lyapunov function\n972: - Compact level sets (ensured by the boundary potential $W_b$ and confining potential)\n973: - **φ-Irreducibility** ({prf:ref}`thm-phi-irreducibility` in Section 6.4.1) - rigorously proven via two-stage construction\n974: - **Aperiodicity** ({prf:ref}`thm-aperiodicity` in Section 6.4.2) - proven via non-degenerate Gaussian noise\n975: \n976: implies existence of a unique invariant measure. In the absorbing case, this becomes a unique QSD (Champagnat & Villemonais, 2016).\n977: \n978: **Part 2: Exponential Convergence**\n979: \n980: The drift condition implies geometric ergodicity via the **Lyapunov drift method**:\n981: \n982: From any initial state:\n983: $$\n984: \\mathbb{E}[V_{\\text{total}}(S_t)] \\leq (1-\\kappa_{\\text{total}}\\tau)^t V_{\\text{total}}(S_0) + \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}\\tau}\n985: $$\n986: \n987: This exponential decay in the Lyapunov function translates (via Markov coupling techniques) to exponential convergence in total variation distance.\n988: \n989: **Part 3: Survival Time**\n990: \n991: The survival probability per step is bounded below:\n992: \n993: $$\n994: P(\\text{survive one step} \\mid S_t) \\geq 1 - e^{-\\Theta(N)}\n995: $$\n996: \n997: This follows from:\n998: - Bounded boundary potential: $W_b \\leq C/\\kappa_b$ in equilibrium\n999: - Concentration of walkers in the interior (far from boundary)\n1000: - McDiarmid's inequality: probability of all $N$ walkers simultaneously exiting is exponentially small\n1001: \n1002: Over $T$ steps:\n1003: $$\n1004: P(\\text{survive } T \\text{ steps}) \\geq (1 - e^{-\\Theta(N)})^T \\approx e^{-T e^{-\\Theta(N)}}\n1005: $$\n1006: \n1007: For $T = e^{\\Theta(N)}$, this remains close to 1.\n1008: \n1009: **Part 4: Concentration**\n1010: \n1011: This follows from combining:\n1012: - The Foster-Lyapunov drift (concentrates $V_{\\text{total}}$ around its equilibrium)\n1013: - McDiarmid's inequality (exponential tails for bounded differences)\n1014: - The N-uniformity of all constants\n1015: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "06_convergence",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Main Convergence Theorem and Quasi-Stationary Distribution"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-equilibrium-variance-bounds",
      "title": null,
      "start_line": 1118,
      "end_line": 1184,
      "header_lines": [
        1119
      ],
      "content_start": 1121,
      "content_end": 1183,
      "content": "1121: :label: proof-thm-equilibrium-variance-bounds\n1122: \n1123: **Proof.**\n1124: \n1125: The equilibrium variance bounds follow immediately from the drift inequalities by setting the expected change to zero.\n1126: \n1127: **Positional Variance:**\n1128: \n1129: From the positional variance drift inequality (Theorem 10.3.1 in 03_cloning.md):\n1130: \n1131: $$\n1132: \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] \\leq -\\kappa_x V_{\\text{Var},x} + C_x\n1133: $$\n1134: \n1135: At equilibrium, $\\mathbb{E}[\\Delta V_{\\text{Var},x}] = 0$, thus:\n1136: \n1137: $$\n1138: 0 = -\\kappa_x V_{\\text{Var},x}^{\\text{QSD}} + C_x\n1139: $$\n1140: \n1141: Solving for $V_{\\text{Var},x}^{\\text{QSD}}$:\n1142: \n1143: $$\n1144: V_{\\text{Var},x}^{\\text{QSD}} = \\frac{C_x}{\\kappa_x}\n1145: $$\n1146: \n1147: **Velocity Variance:**\n1148: \n1149: The velocity variance experiences:\n1150: - Expansion from cloning: $\\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] \\leq C_v$ (Theorem 10.4.1)\n1151: - Dissipation from friction: $\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + \\sigma_{\\max}^2 d \\tau$ (Theorem 3.3.1)\n1152: \n1153: Combined per-step drift:\n1154: \n1155: $$\n1156: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + (C_v + \\sigma_{\\max}^2 d \\tau)\n1157: $$\n1158: \n1159: At equilibrium, $\\mathbb{E}[\\Delta V_{\\text{Var},v}] = 0$:\n1160: \n1161: $$\n1162: 0 = -2\\gamma V_{\\text{Var},v}^{\\text{QSD}} \\tau + (C_v + \\sigma_{\\max}^2 d \\tau)\n1163: $$\n1164: \n1165: Solving:\n1166: \n1167: $$\n1168: V_{\\text{Var},v}^{\\text{QSD}} = \\frac{C_v + \\sigma_{\\max}^2 d \\tau}{2\\gamma\\tau}\n1169: $$\n1170: \n1171: **Boundary Potential:**\n1172: \n1173: From Theorem 11.3.1 in 03_cloning.md:\n1174: \n1175: $$\n1176: \\mathbb{E}_{\\text{clone}}[\\Delta W_b] \\leq -\\kappa_b W_b + C_b\n1177: $$\n1178: \n1179: Setting $\\mathbb{E}[\\Delta W_b] = 0$ at equilibrium:\n1180: \n1181: $$\n1182: W_b^{\\text{QSD}} = \\frac{C_b}{\\kappa_b}\n1183: $$",
      "metadata": {
        "label": "proof-thm-equilibrium-variance-bounds"
      },
      "section": "## 4. Main Convergence Theorem and Quasi-Stationary Distribution",
      "references": [],
      "raw_directive": "1118: :::\n1119: \n1120: :::{prf:proof}\n1121: :label: proof-thm-equilibrium-variance-bounds\n1122: \n1123: **Proof.**\n1124: \n1125: The equilibrium variance bounds follow immediately from the drift inequalities by setting the expected change to zero.\n1126: \n1127: **Positional Variance:**\n1128: \n1129: From the positional variance drift inequality (Theorem 10.3.1 in 03_cloning.md):\n1130: \n1131: $$\n1132: \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] \\leq -\\kappa_x V_{\\text{Var},x} + C_x\n1133: $$\n1134: \n1135: At equilibrium, $\\mathbb{E}[\\Delta V_{\\text{Var},x}] = 0$, thus:\n1136: \n1137: $$\n1138: 0 = -\\kappa_x V_{\\text{Var},x}^{\\text{QSD}} + C_x\n1139: $$\n1140: \n1141: Solving for $V_{\\text{Var},x}^{\\text{QSD}}$:\n1142: \n1143: $$\n1144: V_{\\text{Var},x}^{\\text{QSD}} = \\frac{C_x}{\\kappa_x}\n1145: $$\n1146: \n1147: **Velocity Variance:**\n1148: \n1149: The velocity variance experiences:\n1150: - Expansion from cloning: $\\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] \\leq C_v$ (Theorem 10.4.1)\n1151: - Dissipation from friction: $\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + \\sigma_{\\max}^2 d \\tau$ (Theorem 3.3.1)\n1152: \n1153: Combined per-step drift:\n1154: \n1155: $$\n1156: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + (C_v + \\sigma_{\\max}^2 d \\tau)\n1157: $$\n1158: \n1159: At equilibrium, $\\mathbb{E}[\\Delta V_{\\text{Var},v}] = 0$:\n1160: \n1161: $$\n1162: 0 = -2\\gamma V_{\\text{Var},v}^{\\text{QSD}} \\tau + (C_v + \\sigma_{\\max}^2 d \\tau)\n1163: $$\n1164: \n1165: Solving:\n1166: \n1167: $$\n1168: V_{\\text{Var},v}^{\\text{QSD}} = \\frac{C_v + \\sigma_{\\max}^2 d \\tau}{2\\gamma\\tau}\n1169: $$\n1170: \n1171: **Boundary Potential:**\n1172: \n1173: From Theorem 11.3.1 in 03_cloning.md:\n1174: \n1175: $$\n1176: \\mathbb{E}_{\\text{clone}}[\\Delta W_b] \\leq -\\kappa_b W_b + C_b\n1177: $$\n1178: \n1179: Setting $\\mathbb{E}[\\Delta W_b] = 0$ at equilibrium:\n1180: \n1181: $$\n1182: W_b^{\\text{QSD}} = \\frac{C_b}{\\kappa_b}\n1183: $$\n1184: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "06_convergence",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Main Convergence Theorem and Quasi-Stationary Distribution"
      }
    }
  ]
}