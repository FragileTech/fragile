{
  "chapter_index": 5,
  "section_id": "## 5. Explicit Parameter Dependence and Convergence Rates",
  "directive_count": 8,
  "hints": [
    {
      "directive_type": "proposition",
      "label": "prop-velocity-rate-explicit",
      "title": "Velocity Dissipation Rate (Parameter-Explicit)",
      "start_line": 1241,
      "end_line": 1307,
      "header_lines": [
        1242
      ],
      "content_start": 1244,
      "content_end": 1306,
      "content": "1244: :label: prop-velocity-rate-explicit\n1245: \n1246: The velocity variance dissipation rate and equilibrium constant are:\n1247: \n1248: $$\n1249: \\kappa_v = 2\\gamma - O(\\tau)\n1250: $$\n1251: \n1252: $$\n1253: C_v' = \\frac{d \\sigma_v^2}{\\gamma} + O(\\tau \\sigma_v^2)\n1254: $$\n1255: \n1256: **Proof:**\n1257: \n1258: From the BAOAB scheme (Eq. 1.15), the O-step gives:\n1259: \n1260: $$\n1261: v_{n+1/2} = e^{-\\gamma \\tau} v_n + \\sqrt{\\frac{\\sigma_v^2}{\\gamma}(1 - e^{-2\\gamma\\tau})} \\xi_n\n1262: $$\n1263: \n1264: The expected variance after this step is:\n1265: \n1266: $$\n1267: \\mathbb{E}[\\|v_{n+1/2}\\|^2] = e^{-2\\gamma\\tau} \\mathbb{E}[\\|v_n\\|^2] + d \\frac{\\sigma_v^2}{\\gamma}(1 - e^{-2\\gamma\\tau})\n1268: $$\n1269: \n1270: Expanding $e^{-2\\gamma\\tau} = 1 - 2\\gamma\\tau + 2\\gamma^2\\tau^2 + O(\\tau^3)$:\n1271: \n1272: $$\n1273: \\mathbb{E}[\\|v_{n+1/2}\\|^2] = (1 - 2\\gamma\\tau + 2\\gamma^2\\tau^2) \\mathbb{E}[\\|v_n\\|^2] + d \\sigma_v^2 (2\\tau - 2\\gamma\\tau^2 + O(\\tau^3))\n1274: $$\n1275: \n1276: $$\n1277: = \\mathbb{E}[\\|v_n\\|^2] - 2\\gamma\\tau \\mathbb{E}[\\|v_n\\|^2] + 2d\\sigma_v^2 \\tau + O(\\tau^2)\n1278: $$\n1279: \n1280: The swarm-averaged variance is:\n1281: \n1282: $$\n1283: V_{\\text{Var},v} = \\frac{1}{N}\\sum_{i=1}^N \\|v_i - \\bar{v}\\|^2 = \\frac{1}{N}\\sum_{i=1}^N \\|v_i\\|^2 - \\|\\bar{v}\\|^2\n1284: $$\n1285: \n1286: The expected drift is:\n1287: \n1288: $$\n1289: \\mathbb{E}[\\Delta V_{\\text{Var},v}] = -2\\gamma\\tau V_{\\text{Var},v} + 2d\\sigma_v^2 \\tau + O(\\tau^2 V_{\\text{Var},v} + \\tau^2 \\sigma_v^2)\n1290: $$\n1291: \n1292: Dividing by $\\tau$ and taking the continuous limit:\n1293: \n1294: $$\n1295: \\frac{d}{dt}\\mathbb{E}[V_{\\text{Var},v}] = -2\\gamma V_{\\text{Var},v} + 2d\\sigma_v^2 + O(\\tau)\n1296: $$\n1297: \n1298: Thus:\n1299: - **Rate**: $\\kappa_v = 2\\gamma - O(\\tau)$\n1300: - **Constant**: $C_v' = 2d\\sigma_v^2 + O(\\tau \\sigma_v^2) = \\frac{d\\sigma_v^2}{\\gamma} \\cdot 2\\gamma + O(\\tau\\sigma_v^2)$\n1301: \n1302: **Equilibrium**: Setting the drift to zero gives:\n1303: \n1304: $$\n1305: V_{\\text{Var},v}^{\\text{eq}} = \\frac{C_v'}{\\kappa_v} = \\frac{d\\sigma_v^2}{\\gamma}(1 + O(\\tau))\n1306: $$",
      "metadata": {
        "label": "prop-velocity-rate-explicit"
      },
      "section": "## 5. Explicit Parameter Dependence and Convergence Rates",
      "references": [],
      "raw_directive": "1241: **Explicit expansion:**\n1242: \n1243: :::{prf:proposition} Velocity Dissipation Rate (Parameter-Explicit)\n1244: :label: prop-velocity-rate-explicit\n1245: \n1246: The velocity variance dissipation rate and equilibrium constant are:\n1247: \n1248: $$\n1249: \\kappa_v = 2\\gamma - O(\\tau)\n1250: $$\n1251: \n1252: $$\n1253: C_v' = \\frac{d \\sigma_v^2}{\\gamma} + O(\\tau \\sigma_v^2)\n1254: $$\n1255: \n1256: **Proof:**\n1257: \n1258: From the BAOAB scheme (Eq. 1.15), the O-step gives:\n1259: \n1260: $$\n1261: v_{n+1/2} = e^{-\\gamma \\tau} v_n + \\sqrt{\\frac{\\sigma_v^2}{\\gamma}(1 - e^{-2\\gamma\\tau})} \\xi_n\n1262: $$\n1263: \n1264: The expected variance after this step is:\n1265: \n1266: $$\n1267: \\mathbb{E}[\\|v_{n+1/2}\\|^2] = e^{-2\\gamma\\tau} \\mathbb{E}[\\|v_n\\|^2] + d \\frac{\\sigma_v^2}{\\gamma}(1 - e^{-2\\gamma\\tau})\n1268: $$\n1269: \n1270: Expanding $e^{-2\\gamma\\tau} = 1 - 2\\gamma\\tau + 2\\gamma^2\\tau^2 + O(\\tau^3)$:\n1271: \n1272: $$\n1273: \\mathbb{E}[\\|v_{n+1/2}\\|^2] = (1 - 2\\gamma\\tau + 2\\gamma^2\\tau^2) \\mathbb{E}[\\|v_n\\|^2] + d \\sigma_v^2 (2\\tau - 2\\gamma\\tau^2 + O(\\tau^3))\n1274: $$\n1275: \n1276: $$\n1277: = \\mathbb{E}[\\|v_n\\|^2] - 2\\gamma\\tau \\mathbb{E}[\\|v_n\\|^2] + 2d\\sigma_v^2 \\tau + O(\\tau^2)\n1278: $$\n1279: \n1280: The swarm-averaged variance is:\n1281: \n1282: $$\n1283: V_{\\text{Var},v} = \\frac{1}{N}\\sum_{i=1}^N \\|v_i - \\bar{v}\\|^2 = \\frac{1}{N}\\sum_{i=1}^N \\|v_i\\|^2 - \\|\\bar{v}\\|^2\n1284: $$\n1285: \n1286: The expected drift is:\n1287: \n1288: $$\n1289: \\mathbb{E}[\\Delta V_{\\text{Var},v}] = -2\\gamma\\tau V_{\\text{Var},v} + 2d\\sigma_v^2 \\tau + O(\\tau^2 V_{\\text{Var},v} + \\tau^2 \\sigma_v^2)\n1290: $$\n1291: \n1292: Dividing by $\\tau$ and taking the continuous limit:\n1293: \n1294: $$\n1295: \\frac{d}{dt}\\mathbb{E}[V_{\\text{Var},v}] = -2\\gamma V_{\\text{Var},v} + 2d\\sigma_v^2 + O(\\tau)\n1296: $$\n1297: \n1298: Thus:\n1299: - **Rate**: $\\kappa_v = 2\\gamma - O(\\tau)$\n1300: - **Constant**: $C_v' = 2d\\sigma_v^2 + O(\\tau \\sigma_v^2) = \\frac{d\\sigma_v^2}{\\gamma} \\cdot 2\\gamma + O(\\tau\\sigma_v^2)$\n1301: \n1302: **Equilibrium**: Setting the drift to zero gives:\n1303: \n1304: $$\n1305: V_{\\text{Var},v}^{\\text{eq}} = \\frac{C_v'}{\\kappa_v} = \\frac{d\\sigma_v^2}{\\gamma}(1 + O(\\tau))\n1306: $$\n1307: "
    },
    {
      "directive_type": "proposition",
      "label": "prop-position-rate-explicit",
      "title": "Positional Contraction Rate (Parameter-Explicit)",
      "start_line": 1329,
      "end_line": 1403,
      "header_lines": [
        1330
      ],
      "content_start": 1332,
      "content_end": 1402,
      "content": "1332: :label: prop-position-rate-explicit\n1333: \n1334: The positional variance contraction rate depends on the cloning rate $\\lambda$ and the fitness-variance correlation:\n1335: \n1336: $$\n1337: \\kappa_x = \\lambda \\cdot \\mathbb{E}\\left[\\frac{\\text{Cov}(f_i, \\|x_i - \\bar{x}\\|^2)}{\\mathbb{E}[\\|x_i - \\bar{x}\\|^2]}\\right] + O(\\tau)\n1338: $$\n1339: \n1340: The equilibrium constant is:\n1341: \n1342: $$\n1343: C_x = O\\left(\\frac{\\sigma_v^2 \\tau^3}{\\gamma}\\right) + O(\\tau \\sigma_x^2)\n1344: $$\n1345: \n1346: where $\\sigma_x^2 \\sim \\sigma_v^2 \\tau^2$ is the effective positional diffusion.\n1347: \n1348: **Proof:**\n1349: \n1350: From the Keystone Principle (03_cloning.md, Theorem 5.1), the cloning operator contracts positional variance via the fitness-variance anti-correlation:\n1351: \n1352: $$\n1353: \\mathbb{E}[\\Delta V_{\\text{Var},x}^{\\text{clone}}] = -\\lambda \\cdot \\frac{\\sum_{i=1}^N f_i \\|x_i - \\bar{x}\\|^2}{\\sum_{j=1}^N f_j} + \\lambda \\cdot \\frac{(\\sum_{i=1}^N f_i \\|x_i - \\bar{x}\\|)^2}{(\\sum_{j=1}^N f_j)^2}\n1354: $$\n1355: \n1356: For large $N$ and centered distribution:\n1357: \n1358: $$\n1359: \\mathbb{E}[\\Delta V_{\\text{Var},x}^{\\text{clone}}] \\approx -\\lambda \\cdot \\text{Cov}(f_i, \\|x_i - \\bar{x}\\|^2) + O(1/N)\n1360: $$\n1361: \n1362: Normalizing by $V_{\\text{Var},x} = \\mathbb{E}[\\|x_i - \\bar{x}\\|^2]$:\n1363: \n1364: $$\n1365: \\kappa_x = \\lambda \\cdot \\frac{\\text{Cov}(f_i, \\|x_i - \\bar{x}\\|^2)}{V_{\\text{Var},x}}\n1366: $$\n1367: \n1368: The kinetic operator expands positional variance via:\n1369: \n1370: $$\n1371: \\mathbb{E}[\\Delta V_{\\text{Var},x}^{\\text{kin}}] = \\mathbb{E}\\left[\\frac{1}{N}\\sum_{i=1}^N (v_i - \\bar{v}) \\cdot (x_i - \\bar{x})\\right] \\tau + O(\\tau^2)\n1372: $$\n1373: \n1374: For thermalized velocities ($\\mathbb{E}[v \\mid x]$ weakly correlated):\n1375: \n1376: $$\n1377: \\mathbb{E}[\\Delta V_{\\text{Var},x}^{\\text{kin}}] \\lesssim \\sqrt{V_{\\text{Var},x} V_{\\text{Var},v}} \\tau\n1378: $$\n1379: \n1380: Using $V_{\\text{Var},v} \\sim \\sigma_v^2/\\gamma$:\n1381: \n1382: $$\n1383: C_x \\sim \\sqrt{V_{\\text{Var},x}} \\cdot \\frac{\\sigma_v}{\\sqrt{\\gamma}} \\tau + O(\\tau^2)\n1384: $$\n1385: \n1386: For equilibrium $V_{\\text{Var},x}^{\\text{eq}} = C_x/\\kappa_x$, we get:\n1387: \n1388: $$\n1389: C_x \\sim \\frac{\\sigma_v^2 \\tau^2}{\\gamma \\kappa_x} + O(\\tau^2)\n1390: $$\n1391: \n1392: Assuming $\\kappa_x \\sim \\lambda$:\n1393: \n1394: $$\n1395: C_x \\sim \\frac{\\sigma_v^2 \\tau^2}{\\gamma \\lambda}\n1396: $$\n1397: \n1398: **Higher-order correction:** The $O(\\tau)$ in $\\kappa_x$ comes from positional diffusion during BAB steps:\n1399: \n1400: $$\n1401: \\Delta x = v \\tau + O(\\tau^2), \\quad \\Delta V_{\\text{Var},x} \\sim 2\\langle v, x - \\bar{x}\\rangle \\tau + O(\\tau^2)\n1402: $$",
      "metadata": {
        "label": "prop-position-rate-explicit"
      },
      "section": "## 5. Explicit Parameter Dependence and Convergence Rates",
      "references": [],
      "raw_directive": "1329: **Explicit expansion:**\n1330: \n1331: :::{prf:proposition} Positional Contraction Rate (Parameter-Explicit)\n1332: :label: prop-position-rate-explicit\n1333: \n1334: The positional variance contraction rate depends on the cloning rate $\\lambda$ and the fitness-variance correlation:\n1335: \n1336: $$\n1337: \\kappa_x = \\lambda \\cdot \\mathbb{E}\\left[\\frac{\\text{Cov}(f_i, \\|x_i - \\bar{x}\\|^2)}{\\mathbb{E}[\\|x_i - \\bar{x}\\|^2]}\\right] + O(\\tau)\n1338: $$\n1339: \n1340: The equilibrium constant is:\n1341: \n1342: $$\n1343: C_x = O\\left(\\frac{\\sigma_v^2 \\tau^3}{\\gamma}\\right) + O(\\tau \\sigma_x^2)\n1344: $$\n1345: \n1346: where $\\sigma_x^2 \\sim \\sigma_v^2 \\tau^2$ is the effective positional diffusion.\n1347: \n1348: **Proof:**\n1349: \n1350: From the Keystone Principle (03_cloning.md, Theorem 5.1), the cloning operator contracts positional variance via the fitness-variance anti-correlation:\n1351: \n1352: $$\n1353: \\mathbb{E}[\\Delta V_{\\text{Var},x}^{\\text{clone}}] = -\\lambda \\cdot \\frac{\\sum_{i=1}^N f_i \\|x_i - \\bar{x}\\|^2}{\\sum_{j=1}^N f_j} + \\lambda \\cdot \\frac{(\\sum_{i=1}^N f_i \\|x_i - \\bar{x}\\|)^2}{(\\sum_{j=1}^N f_j)^2}\n1354: $$\n1355: \n1356: For large $N$ and centered distribution:\n1357: \n1358: $$\n1359: \\mathbb{E}[\\Delta V_{\\text{Var},x}^{\\text{clone}}] \\approx -\\lambda \\cdot \\text{Cov}(f_i, \\|x_i - \\bar{x}\\|^2) + O(1/N)\n1360: $$\n1361: \n1362: Normalizing by $V_{\\text{Var},x} = \\mathbb{E}[\\|x_i - \\bar{x}\\|^2]$:\n1363: \n1364: $$\n1365: \\kappa_x = \\lambda \\cdot \\frac{\\text{Cov}(f_i, \\|x_i - \\bar{x}\\|^2)}{V_{\\text{Var},x}}\n1366: $$\n1367: \n1368: The kinetic operator expands positional variance via:\n1369: \n1370: $$\n1371: \\mathbb{E}[\\Delta V_{\\text{Var},x}^{\\text{kin}}] = \\mathbb{E}\\left[\\frac{1}{N}\\sum_{i=1}^N (v_i - \\bar{v}) \\cdot (x_i - \\bar{x})\\right] \\tau + O(\\tau^2)\n1372: $$\n1373: \n1374: For thermalized velocities ($\\mathbb{E}[v \\mid x]$ weakly correlated):\n1375: \n1376: $$\n1377: \\mathbb{E}[\\Delta V_{\\text{Var},x}^{\\text{kin}}] \\lesssim \\sqrt{V_{\\text{Var},x} V_{\\text{Var},v}} \\tau\n1378: $$\n1379: \n1380: Using $V_{\\text{Var},v} \\sim \\sigma_v^2/\\gamma$:\n1381: \n1382: $$\n1383: C_x \\sim \\sqrt{V_{\\text{Var},x}} \\cdot \\frac{\\sigma_v}{\\sqrt{\\gamma}} \\tau + O(\\tau^2)\n1384: $$\n1385: \n1386: For equilibrium $V_{\\text{Var},x}^{\\text{eq}} = C_x/\\kappa_x$, we get:\n1387: \n1388: $$\n1389: C_x \\sim \\frac{\\sigma_v^2 \\tau^2}{\\gamma \\kappa_x} + O(\\tau^2)\n1390: $$\n1391: \n1392: Assuming $\\kappa_x \\sim \\lambda$:\n1393: \n1394: $$\n1395: C_x \\sim \\frac{\\sigma_v^2 \\tau^2}{\\gamma \\lambda}\n1396: $$\n1397: \n1398: **Higher-order correction:** The $O(\\tau)$ in $\\kappa_x$ comes from positional diffusion during BAB steps:\n1399: \n1400: $$\n1401: \\Delta x = v \\tau + O(\\tau^2), \\quad \\Delta V_{\\text{Var},x} \\sim 2\\langle v, x - \\bar{x}\\rangle \\tau + O(\\tau^2)\n1402: $$\n1403: "
    },
    {
      "directive_type": "proposition",
      "label": "prop-wasserstein-rate-explicit",
      "title": "Wasserstein Contraction Rate (Parameter-Explicit)",
      "start_line": 1427,
      "end_line": 1500,
      "header_lines": [
        1428
      ],
      "content_start": 1430,
      "content_end": 1499,
      "content": "1430: :label: prop-wasserstein-rate-explicit\n1431: \n1432: The Wasserstein contraction rate depends on friction and the spectral gap of the potential:\n1433: \n1434: $$\n1435: \\kappa_W = \\frac{c_{\\text{hypo}}^2 \\gamma}{1 + \\gamma^2/\\lambda_{\\min}^2}\n1436: $$\n1437: \n1438: where:\n1439: - $c_{\\text{hypo}} \\sim 0.1 - 1$ is the hypocoercivity constant (from proof in Section 2)\n1440: - $\\lambda_{\\min}$ is the smallest eigenvalue of the Hessian $\\nabla^2 U(x)$ in the relevant region\n1441: \n1442: The equilibrium constant is:\n1443: \n1444: $$\n1445: C_W' = O\\left(\\frac{\\sigma_v^2 \\tau}{\\gamma N^{1/d}}\\right) + O(\\tau^2)\n1446: $$\n1447: \n1448: **Proof:**\n1449: \n1450: From Theorem 2.1 (Hypocoercive Wasserstein Contraction), the continuous-time generator satisfies:\n1451: \n1452: $$\n1453: \\frac{d}{dt}\\mathbb{E}[V_W] \\leq -\\kappa_W V_W + \\text{Source terms}\n1454: $$\n1455: \n1456: The hypocoercive rate comes from the interplay of:\n1457: 1. **Velocity equilibration** (rate $\\sim \\gamma$)\n1458: 2. **Positional mixing** (rate $\\sim \\lambda_{\\min}$)\n1459: \n1460: The optimal rate is achieved when these are balanced:\n1461: \n1462: $$\n1463: \\kappa_W \\sim \\frac{\\gamma \\lambda_{\\min}}{\\gamma + \\lambda_{\\min}}\n1464: $$\n1465: \n1466: For underdamped dynamics ($\\gamma \\ll \\lambda_{\\min}$):\n1467: \n1468: $$\n1469: \\kappa_W \\sim \\gamma\n1470: $$\n1471: \n1472: For overdamped dynamics ($\\gamma \\gg \\lambda_{\\min}$):\n1473: \n1474: $$\n1475: \\kappa_W \\sim \\lambda_{\\min}\n1476: $$\n1477: \n1478: The explicit formula with hypocoercivity constant $c_{\\text{hypo}}$ from the proof:\n1479: \n1480: $$\n1481: \\kappa_W = c_{\\text{hypo}}^2 \\cdot \\frac{\\gamma \\lambda_{\\min}}{\\gamma + \\lambda_{\\min}} = \\frac{c_{\\text{hypo}}^2 \\gamma}{1 + \\gamma/\\lambda_{\\min}}\n1482: $$\n1483: \n1484: The source term $C_W'$ comes from:\n1485: 1. **Stochastic noise**: Each particle receives independent kicks of size $\\sim \\sigma_v \\sqrt{\\tau}$, contributing:\n1486: \n1487: $$\n1488: \\Delta W_2 \\sim \\frac{1}{\\sqrt{N}} \\sigma_v \\sqrt{\\tau}\n1489: $$\n1490: \n1491: (Law of large numbers for empirical measures)\n1492: \n1493: 2. **Discretization error**: The BAOAB scheme introduces $O(\\tau^2)$ weak error per step.\n1494: \n1495: Combining:\n1496: \n1497: $$\n1498: C_W' \\sim \\frac{\\sigma_v^2 \\tau}{N^{1/d}} + O(\\tau^2)\n1499: $$",
      "metadata": {
        "label": "prop-wasserstein-rate-explicit"
      },
      "section": "## 5. Explicit Parameter Dependence and Convergence Rates",
      "references": [],
      "raw_directive": "1427: **Explicit expansion:**\n1428: \n1429: :::{prf:proposition} Wasserstein Contraction Rate (Parameter-Explicit)\n1430: :label: prop-wasserstein-rate-explicit\n1431: \n1432: The Wasserstein contraction rate depends on friction and the spectral gap of the potential:\n1433: \n1434: $$\n1435: \\kappa_W = \\frac{c_{\\text{hypo}}^2 \\gamma}{1 + \\gamma^2/\\lambda_{\\min}^2}\n1436: $$\n1437: \n1438: where:\n1439: - $c_{\\text{hypo}} \\sim 0.1 - 1$ is the hypocoercivity constant (from proof in Section 2)\n1440: - $\\lambda_{\\min}$ is the smallest eigenvalue of the Hessian $\\nabla^2 U(x)$ in the relevant region\n1441: \n1442: The equilibrium constant is:\n1443: \n1444: $$\n1445: C_W' = O\\left(\\frac{\\sigma_v^2 \\tau}{\\gamma N^{1/d}}\\right) + O(\\tau^2)\n1446: $$\n1447: \n1448: **Proof:**\n1449: \n1450: From Theorem 2.1 (Hypocoercive Wasserstein Contraction), the continuous-time generator satisfies:\n1451: \n1452: $$\n1453: \\frac{d}{dt}\\mathbb{E}[V_W] \\leq -\\kappa_W V_W + \\text{Source terms}\n1454: $$\n1455: \n1456: The hypocoercive rate comes from the interplay of:\n1457: 1. **Velocity equilibration** (rate $\\sim \\gamma$)\n1458: 2. **Positional mixing** (rate $\\sim \\lambda_{\\min}$)\n1459: \n1460: The optimal rate is achieved when these are balanced:\n1461: \n1462: $$\n1463: \\kappa_W \\sim \\frac{\\gamma \\lambda_{\\min}}{\\gamma + \\lambda_{\\min}}\n1464: $$\n1465: \n1466: For underdamped dynamics ($\\gamma \\ll \\lambda_{\\min}$):\n1467: \n1468: $$\n1469: \\kappa_W \\sim \\gamma\n1470: $$\n1471: \n1472: For overdamped dynamics ($\\gamma \\gg \\lambda_{\\min}$):\n1473: \n1474: $$\n1475: \\kappa_W \\sim \\lambda_{\\min}\n1476: $$\n1477: \n1478: The explicit formula with hypocoercivity constant $c_{\\text{hypo}}$ from the proof:\n1479: \n1480: $$\n1481: \\kappa_W = c_{\\text{hypo}}^2 \\cdot \\frac{\\gamma \\lambda_{\\min}}{\\gamma + \\lambda_{\\min}} = \\frac{c_{\\text{hypo}}^2 \\gamma}{1 + \\gamma/\\lambda_{\\min}}\n1482: $$\n1483: \n1484: The source term $C_W'$ comes from:\n1485: 1. **Stochastic noise**: Each particle receives independent kicks of size $\\sim \\sigma_v \\sqrt{\\tau}$, contributing:\n1486: \n1487: $$\n1488: \\Delta W_2 \\sim \\frac{1}{\\sqrt{N}} \\sigma_v \\sqrt{\\tau}\n1489: $$\n1490: \n1491: (Law of large numbers for empirical measures)\n1492: \n1493: 2. **Discretization error**: The BAOAB scheme introduces $O(\\tau^2)$ weak error per step.\n1494: \n1495: Combining:\n1496: \n1497: $$\n1498: C_W' \\sim \\frac{\\sigma_v^2 \\tau}{N^{1/d}} + O(\\tau^2)\n1499: $$\n1500: "
    },
    {
      "directive_type": "proposition",
      "label": "prop-boundary-rate-explicit",
      "title": "Boundary Contraction Rate (Parameter-Explicit)",
      "start_line": 1526,
      "end_line": 1602,
      "header_lines": [
        1527
      ],
      "content_start": 1529,
      "content_end": 1601,
      "content": "1529: :label: prop-boundary-rate-explicit\n1530: \n1531: The boundary contraction rate depends on the cloning rate and boundary stiffness:\n1532: \n1533: $$\n1534: \\kappa_b = \\min\\left(\\lambda \\cdot \\frac{\\Delta f_{\\text{boundary}}}{f_{\\text{typical}}}, \\kappa_{\\text{wall}}\\right)\n1535: $$\n1536: \n1537: where:\n1538: - $\\Delta f_{\\text{boundary}} = f(\\text{interior}) - f(\\text{near boundary})$ is the fitness gap\n1539: - $\\kappa_{\\text{wall}} = \\kappa_{\\text{pot}} + \\gamma$ is the confining potential's contraction rate\n1540: \n1541: The equilibrium constant is:\n1542: \n1543: $$\n1544: C_b = O\\left(\\frac{\\sigma_v^2 \\tau}{d_{\\text{safe}}^2}\\right) + O(\\tau^2)\n1545: $$\n1546: \n1547: **Proof:**\n1548: \n1549: From the Safe Harbor Theorem (03_cloning.md, Section 7), the cloning operator removes walkers near the boundary at rate:\n1550: \n1551: $$\n1552: \\kappa_b^{\\text{clone}} = \\lambda \\cdot P(\\text{walker is near boundary}) \\cdot \\frac{\\Delta f_{\\text{boundary}}}{\\mathbb{E}[f]}\n1553: $$\n1554: \n1555: For walkers inside the Safe Harbor region ($|x - \\bar{x}| \\geq d_{\\text{safe}}$), the fitness deficit is:\n1556: \n1557: $$\n1558: \\Delta f_{\\text{boundary}} \\sim \\varphi_{\\text{barrier}}(x) - \\varphi_{\\text{barrier}}(\\bar{x}) \\sim \\kappa_{\\text{wall}} (x - \\bar{x})^2\n1559: $$\n1560: \n1561: Thus:\n1562: \n1563: $$\n1564: \\kappa_b^{\\text{clone}} \\sim \\lambda \\cdot \\frac{\\kappa_{\\text{wall}} d_{\\text{safe}}^2}{f_{\\text{typical}}}\n1565: $$\n1566: \n1567: The kinetic operator also contracts via the confining potential:\n1568: \n1569: $$\n1570: \\kappa_b^{\\text{kin}} = \\kappa_{\\text{pot}} + \\gamma\n1571: $$\n1572: \n1573: where $\\kappa_{\\text{pot}}$ comes from:\n1574: \n1575: $$\n1576: -\\nabla \\varphi_{\\text{barrier}}(x) = -\\kappa_{\\text{wall}} (x - x_{\\partial})\n1577: $$\n1578: \n1579: and $\\gamma$ from velocity damping.\n1580: \n1581: The total rate is the minimum:\n1582: \n1583: $$\n1584: \\kappa_b = \\min(\\kappa_b^{\\text{clone}}, \\kappa_b^{\\text{kin}})\n1585: $$\n1586: \n1587: The source term $C_b$ comes from thermal kicks pushing walkers outward:\n1588: \n1589: $$\n1590: \\Delta x \\sim v \\tau \\sim \\frac{\\sigma_v}{\\sqrt{\\gamma}} \\sqrt{\\tau} \\cdot \\tau = \\frac{\\sigma_v \\tau^{3/2}}{\\sqrt{\\gamma}}\n1591: $$\n1592: \n1593: The probability of reaching the boundary from distance $d_{\\text{safe}}$ in one step is:\n1594: \n1595: $$\n1596: P(\\text{reach boundary}) \\sim \\frac{\\sigma_v \\tau^{3/2}}{\\sqrt{\\gamma} d_{\\text{safe}}}\n1597: $$\n1598: \n1599: The expected increase in $W_b$ per step is:\n1600: \n1601: $$",
      "metadata": {
        "label": "prop-boundary-rate-explicit"
      },
      "section": "## 5. Explicit Parameter Dependence and Convergence Rates",
      "references": [],
      "raw_directive": "1526: **Explicit expansion:**\n1527: \n1528: :::{prf:proposition} Boundary Contraction Rate (Parameter-Explicit)\n1529: :label: prop-boundary-rate-explicit\n1530: \n1531: The boundary contraction rate depends on the cloning rate and boundary stiffness:\n1532: \n1533: $$\n1534: \\kappa_b = \\min\\left(\\lambda \\cdot \\frac{\\Delta f_{\\text{boundary}}}{f_{\\text{typical}}}, \\kappa_{\\text{wall}}\\right)\n1535: $$\n1536: \n1537: where:\n1538: - $\\Delta f_{\\text{boundary}} = f(\\text{interior}) - f(\\text{near boundary})$ is the fitness gap\n1539: - $\\kappa_{\\text{wall}} = \\kappa_{\\text{pot}} + \\gamma$ is the confining potential's contraction rate\n1540: \n1541: The equilibrium constant is:\n1542: \n1543: $$\n1544: C_b = O\\left(\\frac{\\sigma_v^2 \\tau}{d_{\\text{safe}}^2}\\right) + O(\\tau^2)\n1545: $$\n1546: \n1547: **Proof:**\n1548: \n1549: From the Safe Harbor Theorem (03_cloning.md, Section 7), the cloning operator removes walkers near the boundary at rate:\n1550: \n1551: $$\n1552: \\kappa_b^{\\text{clone}} = \\lambda \\cdot P(\\text{walker is near boundary}) \\cdot \\frac{\\Delta f_{\\text{boundary}}}{\\mathbb{E}[f]}\n1553: $$\n1554: \n1555: For walkers inside the Safe Harbor region ($|x - \\bar{x}| \\geq d_{\\text{safe}}$), the fitness deficit is:\n1556: \n1557: $$\n1558: \\Delta f_{\\text{boundary}} \\sim \\varphi_{\\text{barrier}}(x) - \\varphi_{\\text{barrier}}(\\bar{x}) \\sim \\kappa_{\\text{wall}} (x - \\bar{x})^2\n1559: $$\n1560: \n1561: Thus:\n1562: \n1563: $$\n1564: \\kappa_b^{\\text{clone}} \\sim \\lambda \\cdot \\frac{\\kappa_{\\text{wall}} d_{\\text{safe}}^2}{f_{\\text{typical}}}\n1565: $$\n1566: \n1567: The kinetic operator also contracts via the confining potential:\n1568: \n1569: $$\n1570: \\kappa_b^{\\text{kin}} = \\kappa_{\\text{pot}} + \\gamma\n1571: $$\n1572: \n1573: where $\\kappa_{\\text{pot}}$ comes from:\n1574: \n1575: $$\n1576: -\\nabla \\varphi_{\\text{barrier}}(x) = -\\kappa_{\\text{wall}} (x - x_{\\partial})\n1577: $$\n1578: \n1579: and $\\gamma$ from velocity damping.\n1580: \n1581: The total rate is the minimum:\n1582: \n1583: $$\n1584: \\kappa_b = \\min(\\kappa_b^{\\text{clone}}, \\kappa_b^{\\text{kin}})\n1585: $$\n1586: \n1587: The source term $C_b$ comes from thermal kicks pushing walkers outward:\n1588: \n1589: $$\n1590: \\Delta x \\sim v \\tau \\sim \\frac{\\sigma_v}{\\sqrt{\\gamma}} \\sqrt{\\tau} \\cdot \\tau = \\frac{\\sigma_v \\tau^{3/2}}{\\sqrt{\\gamma}}\n1591: $$\n1592: \n1593: The probability of reaching the boundary from distance $d_{\\text{safe}}$ in one step is:\n1594: \n1595: $$\n1596: P(\\text{reach boundary}) \\sim \\frac{\\sigma_v \\tau^{3/2}}{\\sqrt{\\gamma} d_{\\text{safe}}}\n1597: $$\n1598: \n1599: The expected increase in $W_b$ per step is:\n1600: \n1601: $$\n1602: C_b \\sim \\frac{\\sigma_v^2 \\tau}{d_{\\text{safe}}^2} + O(\\tau^2)"
    },
    {
      "directive_type": "theorem",
      "label": "thm-synergistic-rate-derivation",
      "title": "Synergistic Rate Derivation from Component Drifts",
      "start_line": 1629,
      "end_line": 1721,
      "header_lines": [
        1630
      ],
      "content_start": 1632,
      "content_end": 1720,
      "content": "1632: :label: thm-synergistic-rate-derivation\n1633: \n1634: The total drift inequality combines component-wise drift bounds from cloning and kinetic operators to yield explicit synergistic convergence.\n1635: \n1636: **Component Drift Structure:**\n1637: \n1638: From the cloning operator {prf:ref}`thm-positional-variance-contraction` and kinetic operator {prf:ref}`thm-velocity-variance-contraction`, each Lyapunov component satisfies:\n1639: \n1640: $$\n1641: \\begin{aligned}\n1642: \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] &\\leq -\\kappa_x V_{\\text{Var},x} + C_x + C_{xv} V_{\\text{Var},v} + C_{xW} V_W \\\\\n1643: \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}] &\\leq -\\kappa_v V_{\\text{Var},v} + C_v + C_{vx} V_{\\text{Var},x} \\\\\n1644: \\mathbb{E}_{\\text{clone}}[\\Delta V_W] &\\leq -\\kappa_W V_W + C_W \\\\\n1645: \\mathbb{E}_{\\text{clone}}[\\Delta W_b] &\\leq -\\kappa_b W_b + C_b\n1646: \\end{aligned}\n1647: $$\n1648: \n1649: where cross-component coupling terms $C_{xv}, C_{xW}, C_{vx}$ arise from expansion by the complementary operator.\n1650: \n1651: **Weighted Combination:**\n1652: \n1653: Define the weighted Lyapunov function:\n1654: \n1655: $$\n1656: V_{\\text{total}} = V_{\\text{Var},x} + \\alpha_v V_{\\text{Var},v} + \\alpha_W V_W + \\alpha_b W_b\n1657: $$\n1658: \n1659: Taking expectations over a full step (kinetic + cloning):\n1660: \n1661: $$\n1662: \\begin{aligned}\n1663: \\mathbb{E}[\\Delta V_{\\text{total}}] &= \\mathbb{E}[\\Delta V_{\\text{Var},x}] + \\alpha_v \\mathbb{E}[\\Delta V_{\\text{Var},v}] + \\alpha_W \\mathbb{E}[\\Delta V_W] + \\alpha_b \\mathbb{E}[\\Delta W_b] \\\\\n1664: &\\leq (-\\kappa_x V_{\\text{Var},x} + C_x + C_{xv} V_{\\text{Var},v} + C_{xW} V_W) \\\\\n1665: &\\quad + \\alpha_v(-\\kappa_v V_{\\text{Var},v} + C_v + C_{vx} V_{\\text{Var},x}) \\\\\n1666: &\\quad + \\alpha_W(-\\kappa_W V_W + C_W) \\\\\n1667: &\\quad + \\alpha_b(-\\kappa_b W_b + C_b)\n1668: \\end{aligned}\n1669: $$\n1670: \n1671: **Weight Selection for Coupling Domination:**\n1672: \n1673: Choose weights to ensure coupling terms are dominated by contraction:\n1674: \n1675: $$\n1676: \\alpha_v \\geq \\frac{C_{xv}}{\\kappa_v V_{\\text{Var},v}^{\\text{eq}}}, \\quad\n1677: \\alpha_W \\geq \\frac{C_{xW}}{\\kappa_W V_W^{\\text{eq}}}, \\quad\n1678: \\alpha_v \\kappa_v \\geq C_{vx} / V_{\\text{Var},x}^{\\text{eq}}\n1679: $$\n1680: \n1681: With these weights, the coupling terms satisfy:\n1682: \n1683: $$\n1684: C_{xv} V_{\\text{Var},v} - \\alpha_v \\kappa_v V_{\\text{Var},v} \\leq -\\epsilon_v \\alpha_v \\kappa_v V_{\\text{Var},v}\n1685: $$\n1686: \n1687: and similarly for other cross terms, where $\\epsilon_v, \\epsilon_W \\ll 1$ are small positive fractions.\n1688: \n1689: **Synergistic Rate:**\n1690: \n1691: After cancellation of dominated coupling terms:\n1692: \n1693: $$\n1694: \\mathbb{E}[\\Delta V_{\\text{total}}] \\leq -\\kappa_{\\text{total}} V_{\\text{total}} + C_{\\text{total}}\n1695: $$\n1696: \n1697: where:\n1698: \n1699: $$\n1700: \\kappa_{\\text{total}} = \\min(\\kappa_x, \\alpha_v \\kappa_v, \\alpha_W \\kappa_W, \\alpha_b \\kappa_b) \\cdot (1 - \\epsilon_{\\text{coupling}})\n1701: $$\n1702: \n1703: $$\n1704: C_{\\text{total}} = C_x + \\alpha_v C_v + \\alpha_W C_W + \\alpha_b C_b\n1705: $$\n1706: \n1707: and $\\epsilon_{\\text{coupling}} = \\max(\\epsilon_v, \\epsilon_W, \\ldots)$ is the residual coupling ratio after weight balancing.\n1708: \n1709: **Physical Interpretation:**\n1710: \n1711: The synergistic rate $\\kappa_{\\text{total}}$ is determined by:\n1712: 1. **Bottleneck principle**: The weakest contraction rate dominates (min over components)\n1713: 2. **Coupling penalty**: $\\epsilon_{\\text{coupling}}$ reduces the effective rate due to energy transfer between components\n1714: 3. **Weight balancing**: Optimal $\\alpha_i$ maximize $\\alpha_i \\kappa_i$ subject to coupling domination\n1715: \n1716: When $\\epsilon_{\\text{coupling}} \\ll 1$, the total rate approaches the bottleneck component rate. The equilibrium variance is:\n1717: \n1718: $$\n1719: V_{\\text{total}}^{\\text{QSD}} = \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}\n1720: $$",
      "metadata": {
        "label": "thm-synergistic-rate-derivation"
      },
      "section": "## 5. Explicit Parameter Dependence and Convergence Rates",
      "references": [
        "thm-positional-variance-contraction",
        "thm-velocity-variance-contraction"
      ],
      "raw_directive": "1629: **Explicit expansion:**\n1630: \n1631: :::{prf:theorem} Synergistic Rate Derivation from Component Drifts\n1632: :label: thm-synergistic-rate-derivation\n1633: \n1634: The total drift inequality combines component-wise drift bounds from cloning and kinetic operators to yield explicit synergistic convergence.\n1635: \n1636: **Component Drift Structure:**\n1637: \n1638: From the cloning operator {prf:ref}`thm-positional-variance-contraction` and kinetic operator {prf:ref}`thm-velocity-variance-contraction`, each Lyapunov component satisfies:\n1639: \n1640: $$\n1641: \\begin{aligned}\n1642: \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] &\\leq -\\kappa_x V_{\\text{Var},x} + C_x + C_{xv} V_{\\text{Var},v} + C_{xW} V_W \\\\\n1643: \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}] &\\leq -\\kappa_v V_{\\text{Var},v} + C_v + C_{vx} V_{\\text{Var},x} \\\\\n1644: \\mathbb{E}_{\\text{clone}}[\\Delta V_W] &\\leq -\\kappa_W V_W + C_W \\\\\n1645: \\mathbb{E}_{\\text{clone}}[\\Delta W_b] &\\leq -\\kappa_b W_b + C_b\n1646: \\end{aligned}\n1647: $$\n1648: \n1649: where cross-component coupling terms $C_{xv}, C_{xW}, C_{vx}$ arise from expansion by the complementary operator.\n1650: \n1651: **Weighted Combination:**\n1652: \n1653: Define the weighted Lyapunov function:\n1654: \n1655: $$\n1656: V_{\\text{total}} = V_{\\text{Var},x} + \\alpha_v V_{\\text{Var},v} + \\alpha_W V_W + \\alpha_b W_b\n1657: $$\n1658: \n1659: Taking expectations over a full step (kinetic + cloning):\n1660: \n1661: $$\n1662: \\begin{aligned}\n1663: \\mathbb{E}[\\Delta V_{\\text{total}}] &= \\mathbb{E}[\\Delta V_{\\text{Var},x}] + \\alpha_v \\mathbb{E}[\\Delta V_{\\text{Var},v}] + \\alpha_W \\mathbb{E}[\\Delta V_W] + \\alpha_b \\mathbb{E}[\\Delta W_b] \\\\\n1664: &\\leq (-\\kappa_x V_{\\text{Var},x} + C_x + C_{xv} V_{\\text{Var},v} + C_{xW} V_W) \\\\\n1665: &\\quad + \\alpha_v(-\\kappa_v V_{\\text{Var},v} + C_v + C_{vx} V_{\\text{Var},x}) \\\\\n1666: &\\quad + \\alpha_W(-\\kappa_W V_W + C_W) \\\\\n1667: &\\quad + \\alpha_b(-\\kappa_b W_b + C_b)\n1668: \\end{aligned}\n1669: $$\n1670: \n1671: **Weight Selection for Coupling Domination:**\n1672: \n1673: Choose weights to ensure coupling terms are dominated by contraction:\n1674: \n1675: $$\n1676: \\alpha_v \\geq \\frac{C_{xv}}{\\kappa_v V_{\\text{Var},v}^{\\text{eq}}}, \\quad\n1677: \\alpha_W \\geq \\frac{C_{xW}}{\\kappa_W V_W^{\\text{eq}}}, \\quad\n1678: \\alpha_v \\kappa_v \\geq C_{vx} / V_{\\text{Var},x}^{\\text{eq}}\n1679: $$\n1680: \n1681: With these weights, the coupling terms satisfy:\n1682: \n1683: $$\n1684: C_{xv} V_{\\text{Var},v} - \\alpha_v \\kappa_v V_{\\text{Var},v} \\leq -\\epsilon_v \\alpha_v \\kappa_v V_{\\text{Var},v}\n1685: $$\n1686: \n1687: and similarly for other cross terms, where $\\epsilon_v, \\epsilon_W \\ll 1$ are small positive fractions.\n1688: \n1689: **Synergistic Rate:**\n1690: \n1691: After cancellation of dominated coupling terms:\n1692: \n1693: $$\n1694: \\mathbb{E}[\\Delta V_{\\text{total}}] \\leq -\\kappa_{\\text{total}} V_{\\text{total}} + C_{\\text{total}}\n1695: $$\n1696: \n1697: where:\n1698: \n1699: $$\n1700: \\kappa_{\\text{total}} = \\min(\\kappa_x, \\alpha_v \\kappa_v, \\alpha_W \\kappa_W, \\alpha_b \\kappa_b) \\cdot (1 - \\epsilon_{\\text{coupling}})\n1701: $$\n1702: \n1703: $$\n1704: C_{\\text{total}} = C_x + \\alpha_v C_v + \\alpha_W C_W + \\alpha_b C_b\n1705: $$\n1706: \n1707: and $\\epsilon_{\\text{coupling}} = \\max(\\epsilon_v, \\epsilon_W, \\ldots)$ is the residual coupling ratio after weight balancing.\n1708: \n1709: **Physical Interpretation:**\n1710: \n1711: The synergistic rate $\\kappa_{\\text{total}}$ is determined by:\n1712: 1. **Bottleneck principle**: The weakest contraction rate dominates (min over components)\n1713: 2. **Coupling penalty**: $\\epsilon_{\\text{coupling}}$ reduces the effective rate due to energy transfer between components\n1714: 3. **Weight balancing**: Optimal $\\alpha_i$ maximize $\\alpha_i \\kappa_i$ subject to coupling domination\n1715: \n1716: When $\\epsilon_{\\text{coupling}} \\ll 1$, the total rate approaches the bottleneck component rate. The equilibrium variance is:\n1717: \n1718: $$\n1719: V_{\\text{total}}^{\\text{QSD}} = \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}\n1720: $$\n1721: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-total-rate-explicit",
      "title": "Total Convergence Rate (Parameter-Explicit)",
      "start_line": 1740,
      "end_line": 1817,
      "header_lines": [
        1741
      ],
      "content_start": 1743,
      "content_end": 1816,
      "content": "1743: :label: thm-total-rate-explicit\n1744: \n1745: The total geometric convergence rate is:\n1746: \n1747: $$\n1748: \\kappa_{\\text{total}} = \\min(\\kappa_x, \\kappa_v, \\kappa_W, \\kappa_b) \\cdot (1 - \\epsilon_{\\text{coupling}})\n1749: $$\n1750: \n1751: where $\\epsilon_{\\text{coupling}} \\ll 1$ is the expansion-to-contraction ratio:\n1752: \n1753: $$\n1754: \\epsilon_{\\text{coupling}} = \\max\\left(\n1755: \\frac{\\alpha_v C_{xv}}{\\kappa_v V_{\\text{Var},v}},\n1756: \\frac{\\alpha_W C_{xW}}{\\kappa_W V_W},\n1757: \\frac{C_{vx}}{\\kappa_x V_{\\text{Var},x}},\n1758: \\ldots\n1759: \\right)\n1760: $$\n1761: \n1762: The equilibrium constant is:\n1763: \n1764: $$\n1765: C_{\\text{total}} = \\frac{C_x + \\alpha_v C_v' + \\alpha_W C_W' + \\alpha_b C_b}{\\kappa_{\\text{total}}}\n1766: $$\n1767: \n1768: **Explicit formulas:**\n1769: \n1770: Substituting from previous sections:\n1771: \n1772: $$\n1773: \\kappa_{\\text{total}} \\sim \\min\\left(\n1774: \\lambda, \\quad 2\\gamma, \\quad \\frac{c_{\\text{hypo}}^2 \\gamma}{1 + \\gamma/\\lambda_{\\min}}, \\quad \\lambda \\frac{\\Delta f_{\\text{boundary}}}{f_{\\text{typical}}}\n1775: \\right) \\cdot (1 - O(\\tau))\n1776: $$\n1777: \n1778: $$\n1779: C_{\\text{total}} \\sim \\frac{1}{\\kappa_{\\text{total}}} \\left(\n1780: \\frac{\\sigma_v^2 \\tau^2}{\\gamma \\lambda} + \\frac{d\\sigma_v^2}{\\gamma} + \\frac{\\sigma_v^2 \\tau}{N^{1/d}} + \\frac{\\sigma_v^2 \\tau}{d_{\\text{safe}}^2}\n1781: \\right)\n1782: $$\n1783: \n1784: **Proof:**\n1785: \n1786: From {prf:ref}`thm-foster-lyapunov-main` (Synergistic Composition, Chapter 7), the weights $\\alpha_v, \\alpha_W, \\alpha_b$ are chosen to satisfy:\n1787: \n1788: $$\n1789: \\alpha_v \\geq \\frac{C_{xv}}{\\kappa_v V_{\\text{Var},v}^{\\text{eq}}}, \\quad\n1790: \\alpha_W \\geq \\frac{C_{xW}}{\\kappa_W V_W^{\\text{eq}}}, \\quad\n1791: \\text{etc.}\n1792: $$\n1793: \n1794: These ensure:\n1795: \n1796: $$\n1797: \\mathbb{E}[\\Delta V_{\\text{total}}] \\leq -\\kappa_{\\text{total}} V_{\\text{total}} + C_{\\text{total}}\n1798: $$\n1799: \n1800: The coupling ratio $\\epsilon_{\\text{coupling}}$ is the fraction of contraction \"wasted\" on compensating other operators' expansion. As long as:\n1801: \n1802: $$\n1803: \\epsilon_{\\text{coupling}} < 1 - \\delta \\quad (\\text{for some } \\delta > 0)\n1804: $$\n1805: \n1806: we have geometric convergence.\n1807: \n1808: The weakest contraction rate dominates (bottleneck):\n1809: \n1810: $$\n1811: \\kappa_{\\text{total}} = \\min_i(\\kappa_i) \\cdot (1 - \\epsilon_{\\text{coupling}})\n1812: $$\n1813: \n1814: The equilibrium is determined by balancing all source terms:\n1815: \n1816: $$",
      "metadata": {
        "label": "thm-total-rate-explicit"
      },
      "section": "## 5. Explicit Parameter Dependence and Convergence Rates",
      "references": [
        "thm-foster-lyapunov-main"
      ],
      "raw_directive": "1740: :::\n1741: \n1742: :::{prf:theorem} Total Convergence Rate (Parameter-Explicit)\n1743: :label: thm-total-rate-explicit\n1744: \n1745: The total geometric convergence rate is:\n1746: \n1747: $$\n1748: \\kappa_{\\text{total}} = \\min(\\kappa_x, \\kappa_v, \\kappa_W, \\kappa_b) \\cdot (1 - \\epsilon_{\\text{coupling}})\n1749: $$\n1750: \n1751: where $\\epsilon_{\\text{coupling}} \\ll 1$ is the expansion-to-contraction ratio:\n1752: \n1753: $$\n1754: \\epsilon_{\\text{coupling}} = \\max\\left(\n1755: \\frac{\\alpha_v C_{xv}}{\\kappa_v V_{\\text{Var},v}},\n1756: \\frac{\\alpha_W C_{xW}}{\\kappa_W V_W},\n1757: \\frac{C_{vx}}{\\kappa_x V_{\\text{Var},x}},\n1758: \\ldots\n1759: \\right)\n1760: $$\n1761: \n1762: The equilibrium constant is:\n1763: \n1764: $$\n1765: C_{\\text{total}} = \\frac{C_x + \\alpha_v C_v' + \\alpha_W C_W' + \\alpha_b C_b}{\\kappa_{\\text{total}}}\n1766: $$\n1767: \n1768: **Explicit formulas:**\n1769: \n1770: Substituting from previous sections:\n1771: \n1772: $$\n1773: \\kappa_{\\text{total}} \\sim \\min\\left(\n1774: \\lambda, \\quad 2\\gamma, \\quad \\frac{c_{\\text{hypo}}^2 \\gamma}{1 + \\gamma/\\lambda_{\\min}}, \\quad \\lambda \\frac{\\Delta f_{\\text{boundary}}}{f_{\\text{typical}}}\n1775: \\right) \\cdot (1 - O(\\tau))\n1776: $$\n1777: \n1778: $$\n1779: C_{\\text{total}} \\sim \\frac{1}{\\kappa_{\\text{total}}} \\left(\n1780: \\frac{\\sigma_v^2 \\tau^2}{\\gamma \\lambda} + \\frac{d\\sigma_v^2}{\\gamma} + \\frac{\\sigma_v^2 \\tau}{N^{1/d}} + \\frac{\\sigma_v^2 \\tau}{d_{\\text{safe}}^2}\n1781: \\right)\n1782: $$\n1783: \n1784: **Proof:**\n1785: \n1786: From {prf:ref}`thm-foster-lyapunov-main` (Synergistic Composition, Chapter 7), the weights $\\alpha_v, \\alpha_W, \\alpha_b$ are chosen to satisfy:\n1787: \n1788: $$\n1789: \\alpha_v \\geq \\frac{C_{xv}}{\\kappa_v V_{\\text{Var},v}^{\\text{eq}}}, \\quad\n1790: \\alpha_W \\geq \\frac{C_{xW}}{\\kappa_W V_W^{\\text{eq}}}, \\quad\n1791: \\text{etc.}\n1792: $$\n1793: \n1794: These ensure:\n1795: \n1796: $$\n1797: \\mathbb{E}[\\Delta V_{\\text{total}}] \\leq -\\kappa_{\\text{total}} V_{\\text{total}} + C_{\\text{total}}\n1798: $$\n1799: \n1800: The coupling ratio $\\epsilon_{\\text{coupling}}$ is the fraction of contraction \"wasted\" on compensating other operators' expansion. As long as:\n1801: \n1802: $$\n1803: \\epsilon_{\\text{coupling}} < 1 - \\delta \\quad (\\text{for some } \\delta > 0)\n1804: $$\n1805: \n1806: we have geometric convergence.\n1807: \n1808: The weakest contraction rate dominates (bottleneck):\n1809: \n1810: $$\n1811: \\kappa_{\\text{total}} = \\min_i(\\kappa_i) \\cdot (1 - \\epsilon_{\\text{coupling}})\n1812: $$\n1813: \n1814: The equilibrium is determined by balancing all source terms:\n1815: \n1816: $$\n1817: V_{\\text{total}}^{\\text{eq}} = \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}"
    },
    {
      "directive_type": "proposition",
      "label": "prop-mixing-time-explicit",
      "title": "Mixing Time (Parameter-Explicit)",
      "start_line": 1863,
      "end_line": 1917,
      "header_lines": [
        1864
      ],
      "content_start": 1866,
      "content_end": 1916,
      "content": "1866: :label: prop-mixing-time-explicit\n1867: \n1868: The time to reach $\\epsilon$-proximity to equilibrium is:\n1869: \n1870: $$\n1871: T_{\\text{mix}}(\\epsilon) = \\frac{1}{\\kappa_{\\text{total}}} \\ln\\left(\\frac{V_{\\text{total}}^{\\text{init}}}{\\epsilon C_{\\text{total}}}\\right)\n1872: $$\n1873: \n1874: For typical initialization $V_{\\text{total}}^{\\text{init}} \\sim O(1)$ and target $\\epsilon = 0.01$:\n1875: \n1876: $$\n1877: T_{\\text{mix}} \\sim \\frac{5}{\\kappa_{\\text{total}}} = \\frac{5}{\\min(\\lambda, 2\\gamma, \\kappa_W, \\kappa_b)}\n1878: $$\n1879: \n1880: **Proof:**\n1881: \n1882: From the Foster-Lyapunov condition:\n1883: \n1884: $$\n1885: \\mathbb{E}[V_{\\text{total}}(t)] \\leq e^{-\\kappa_{\\text{total}} t} V_{\\text{total}}^{\\text{init}} + \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}(1 - e^{-\\kappa_{\\text{total}} t})\n1886: $$\n1887: \n1888: At equilibrium:\n1889: \n1890: $$\n1891: \\mathbb{E}[V_{\\text{total}}^{\\text{eq}}] = \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}\n1892: $$\n1893: \n1894: The error decays as:\n1895: \n1896: $$\n1897: |\\mathbb{E}[V_{\\text{total}}(t)] - V_{\\text{total}}^{\\text{eq}}| \\leq e^{-\\kappa_{\\text{total}} t} V_{\\text{total}}^{\\text{init}}\n1898: $$\n1899: \n1900: To reach $\\epsilon$-accuracy:\n1901: \n1902: $$\n1903: e^{-\\kappa_{\\text{total}} T_{\\text{mix}}} V_{\\text{total}}^{\\text{init}} = \\epsilon \\cdot V_{\\text{total}}^{\\text{eq}} = \\epsilon \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}\n1904: $$\n1905: \n1906: Solving:\n1907: \n1908: $$\n1909: T_{\\text{mix}} = \\frac{1}{\\kappa_{\\text{total}}} \\ln\\left(\\frac{V_{\\text{total}}^{\\text{init}} \\kappa_{\\text{total}}}{\\epsilon C_{\\text{total}}}\\right)\n1910: $$\n1911: \n1912: For $V_{\\text{total}}^{\\text{init}} / C_{\\text{total}} \\sim O(1)$:\n1913: \n1914: $$\n1915: T_{\\text{mix}} \\sim \\frac{\\ln(1/\\epsilon)}{\\kappa_{\\text{total}}}\n1916: $$",
      "metadata": {
        "label": "prop-mixing-time-explicit"
      },
      "section": "## 5. Explicit Parameter Dependence and Convergence Rates",
      "references": [],
      "raw_directive": "1863: Using the explicit rates, we can estimate the time to reach equilibrium.\n1864: \n1865: :::{prf:proposition} Mixing Time (Parameter-Explicit)\n1866: :label: prop-mixing-time-explicit\n1867: \n1868: The time to reach $\\epsilon$-proximity to equilibrium is:\n1869: \n1870: $$\n1871: T_{\\text{mix}}(\\epsilon) = \\frac{1}{\\kappa_{\\text{total}}} \\ln\\left(\\frac{V_{\\text{total}}^{\\text{init}}}{\\epsilon C_{\\text{total}}}\\right)\n1872: $$\n1873: \n1874: For typical initialization $V_{\\text{total}}^{\\text{init}} \\sim O(1)$ and target $\\epsilon = 0.01$:\n1875: \n1876: $$\n1877: T_{\\text{mix}} \\sim \\frac{5}{\\kappa_{\\text{total}}} = \\frac{5}{\\min(\\lambda, 2\\gamma, \\kappa_W, \\kappa_b)}\n1878: $$\n1879: \n1880: **Proof:**\n1881: \n1882: From the Foster-Lyapunov condition:\n1883: \n1884: $$\n1885: \\mathbb{E}[V_{\\text{total}}(t)] \\leq e^{-\\kappa_{\\text{total}} t} V_{\\text{total}}^{\\text{init}} + \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}(1 - e^{-\\kappa_{\\text{total}} t})\n1886: $$\n1887: \n1888: At equilibrium:\n1889: \n1890: $$\n1891: \\mathbb{E}[V_{\\text{total}}^{\\text{eq}}] = \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}\n1892: $$\n1893: \n1894: The error decays as:\n1895: \n1896: $$\n1897: |\\mathbb{E}[V_{\\text{total}}(t)] - V_{\\text{total}}^{\\text{eq}}| \\leq e^{-\\kappa_{\\text{total}} t} V_{\\text{total}}^{\\text{init}}\n1898: $$\n1899: \n1900: To reach $\\epsilon$-accuracy:\n1901: \n1902: $$\n1903: e^{-\\kappa_{\\text{total}} T_{\\text{mix}}} V_{\\text{total}}^{\\text{init}} = \\epsilon \\cdot V_{\\text{total}}^{\\text{eq}} = \\epsilon \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}\n1904: $$\n1905: \n1906: Solving:\n1907: \n1908: $$\n1909: T_{\\text{mix}} = \\frac{1}{\\kappa_{\\text{total}}} \\ln\\left(\\frac{V_{\\text{total}}^{\\text{init}} \\kappa_{\\text{total}}}{\\epsilon C_{\\text{total}}}\\right)\n1910: $$\n1911: \n1912: For $V_{\\text{total}}^{\\text{init}} / C_{\\text{total}} \\sim O(1)$:\n1913: \n1914: $$\n1915: T_{\\text{mix}} \\sim \\frac{\\ln(1/\\epsilon)}{\\kappa_{\\text{total}}}\n1916: $$\n1917: "
    },
    {
      "directive_type": "algorithm",
      "label": "alg-param-selection",
      "title": "Parameter Selection for Optimal Convergence",
      "start_line": 1953,
      "end_line": 2034,
      "header_lines": [
        1954
      ],
      "content_start": 1956,
      "content_end": 2033,
      "content": "1956: :label: alg-param-selection\n1957: \n1958: **Input:** Problem dimension $d$, budget $N$, landscape curvature estimate $\\lambda_{\\min}$\n1959: \n1960: **Goal:** Choose $(\\gamma, \\lambda, \\sigma_v, \\tau, d_{\\text{safe}}, \\kappa_{\\text{wall}})$ to maximize $\\kappa_{\\text{total}}$ while keeping $C_{\\text{total}}$ reasonable.\n1961: \n1962: **Step 1: Balance friction and cloning**\n1963: \n1964: Choose $\\gamma \\sim \\lambda$ to avoid bottlenecks:\n1965: \n1966: $$\n1967: \\gamma = \\lambda = \\sqrt{\\lambda_{\\min}}\n1968: $$\n1969: \n1970: **Justification:**\n1971: - If $\\gamma \\ll \\lambda$: velocity thermalization is the bottleneck ($\\kappa_{\\text{total}} \\sim 2\\gamma$)\n1972: - If $\\lambda \\ll \\gamma$: positional contraction is the bottleneck ($\\kappa_{\\text{total}} \\sim \\lambda$)\n1973: - Balanced: $\\kappa_{\\text{total}} \\sim \\min(2\\gamma, \\lambda) = \\sqrt{\\lambda_{\\min}}$\n1974: \n1975: **Step 2: Choose noise intensity for exploration**\n1976: \n1977: Set thermal noise to match desired exploration scale $\\sigma_{\\text{explore}}$:\n1978: \n1979: $$\n1980: \\sigma_v = \\sqrt{\\gamma \\sigma_{\\text{explore}}^2}\n1981: $$\n1982: \n1983: **Justification:** The equilibrium positional variance is:\n1984: \n1985: $$\n1986: V_{\\text{Var},x}^{\\text{eq}} \\sim \\frac{\\sigma_v^2 \\tau^2}{\\gamma \\lambda} \\sim \\sigma_{\\text{explore}}^2\n1987: $$\n1988: \n1989: **Step 3: Choose timestep from stability**\n1990: \n1991: Use CFL-like condition:\n1992: \n1993: $$\n1994: \\tau = \\frac{c_{\\text{CFL}}}{\\sqrt{\\gamma \\lambda_{\\max}}}\n1995: $$\n1996: \n1997: where $\\lambda_{\\max}$ is the largest curvature and $c_{\\text{CFL}} \\sim 0.1 - 0.5$.\n1998: \n1999: **Justification:** Ensures:\n2000: - BAOAB stability: $\\gamma \\tau \\ll 1$\n2001: - Symplectic accuracy: $\\sqrt{\\lambda_{\\max}} \\tau \\ll 1$\n2002: - Weak error: $O(\\tau^2)$ corrections negligible\n2003: \n2004: **Step 4: Set boundary parameters for safety**\n2005: \n2006: Choose Safe Harbor distance from swarm variance:\n2007: \n2008: $$\n2009: d_{\\text{safe}} = 3\\sqrt{V_{\\text{Var},x}^{\\text{eq}}} \\sim 3\\sigma_{\\text{explore}}\n2010: $$\n2011: \n2012: Choose boundary stiffness from extinction tolerance:\n2013: \n2014: $$\n2015: \\kappa_{\\text{wall}} = \\frac{\\lambda f_{\\text{typical}}}{\\Delta f_{\\text{desired}}}\n2016: $$\n2017: \n2018: to ensure $P(\\text{extinction per step}) \\lesssim e^{-\\Theta(N)}$.\n2019: \n2020: **Step 5: Scale with swarm size**\n2021: \n2022: For dimension $d$ and desired Wasserstein accuracy $\\epsilon_W$:\n2023: \n2024: $$\n2025: N \\geq \\left(\\frac{\\sigma_v^2 \\tau}{\\epsilon_W^2 \\kappa_W}\\right)^d\n2026: $$\n2027: \n2028: **Output:** Optimized parameters $(\\gamma^*, \\lambda^*, \\sigma_v^*, \\tau^*, d_{\\text{safe}}^*, \\kappa_{\\text{wall}}^*)$\n2029: \n2030: **Expected performance:**\n2031: \n2032: $$\n2033: \\kappa_{\\text{total}} \\sim \\sqrt{\\lambda_{\\min}}, \\quad",
      "metadata": {
        "label": "alg-param-selection"
      },
      "section": "## 5. Explicit Parameter Dependence and Convergence Rates",
      "references": [],
      "raw_directive": "1953: Based on the explicit formulas, here is a practical strategy for choosing parameters:\n1954: \n1955: :::{prf:algorithm} Parameter Selection for Optimal Convergence\n1956: :label: alg-param-selection\n1957: \n1958: **Input:** Problem dimension $d$, budget $N$, landscape curvature estimate $\\lambda_{\\min}$\n1959: \n1960: **Goal:** Choose $(\\gamma, \\lambda, \\sigma_v, \\tau, d_{\\text{safe}}, \\kappa_{\\text{wall}})$ to maximize $\\kappa_{\\text{total}}$ while keeping $C_{\\text{total}}$ reasonable.\n1961: \n1962: **Step 1: Balance friction and cloning**\n1963: \n1964: Choose $\\gamma \\sim \\lambda$ to avoid bottlenecks:\n1965: \n1966: $$\n1967: \\gamma = \\lambda = \\sqrt{\\lambda_{\\min}}\n1968: $$\n1969: \n1970: **Justification:**\n1971: - If $\\gamma \\ll \\lambda$: velocity thermalization is the bottleneck ($\\kappa_{\\text{total}} \\sim 2\\gamma$)\n1972: - If $\\lambda \\ll \\gamma$: positional contraction is the bottleneck ($\\kappa_{\\text{total}} \\sim \\lambda$)\n1973: - Balanced: $\\kappa_{\\text{total}} \\sim \\min(2\\gamma, \\lambda) = \\sqrt{\\lambda_{\\min}}$\n1974: \n1975: **Step 2: Choose noise intensity for exploration**\n1976: \n1977: Set thermal noise to match desired exploration scale $\\sigma_{\\text{explore}}$:\n1978: \n1979: $$\n1980: \\sigma_v = \\sqrt{\\gamma \\sigma_{\\text{explore}}^2}\n1981: $$\n1982: \n1983: **Justification:** The equilibrium positional variance is:\n1984: \n1985: $$\n1986: V_{\\text{Var},x}^{\\text{eq}} \\sim \\frac{\\sigma_v^2 \\tau^2}{\\gamma \\lambda} \\sim \\sigma_{\\text{explore}}^2\n1987: $$\n1988: \n1989: **Step 3: Choose timestep from stability**\n1990: \n1991: Use CFL-like condition:\n1992: \n1993: $$\n1994: \\tau = \\frac{c_{\\text{CFL}}}{\\sqrt{\\gamma \\lambda_{\\max}}}\n1995: $$\n1996: \n1997: where $\\lambda_{\\max}$ is the largest curvature and $c_{\\text{CFL}} \\sim 0.1 - 0.5$.\n1998: \n1999: **Justification:** Ensures:\n2000: - BAOAB stability: $\\gamma \\tau \\ll 1$\n2001: - Symplectic accuracy: $\\sqrt{\\lambda_{\\max}} \\tau \\ll 1$\n2002: - Weak error: $O(\\tau^2)$ corrections negligible\n2003: \n2004: **Step 4: Set boundary parameters for safety**\n2005: \n2006: Choose Safe Harbor distance from swarm variance:\n2007: \n2008: $$\n2009: d_{\\text{safe}} = 3\\sqrt{V_{\\text{Var},x}^{\\text{eq}}} \\sim 3\\sigma_{\\text{explore}}\n2010: $$\n2011: \n2012: Choose boundary stiffness from extinction tolerance:\n2013: \n2014: $$\n2015: \\kappa_{\\text{wall}} = \\frac{\\lambda f_{\\text{typical}}}{\\Delta f_{\\text{desired}}}\n2016: $$\n2017: \n2018: to ensure $P(\\text{extinction per step}) \\lesssim e^{-\\Theta(N)}$.\n2019: \n2020: **Step 5: Scale with swarm size**\n2021: \n2022: For dimension $d$ and desired Wasserstein accuracy $\\epsilon_W$:\n2023: \n2024: $$\n2025: N \\geq \\left(\\frac{\\sigma_v^2 \\tau}{\\epsilon_W^2 \\kappa_W}\\right)^d\n2026: $$\n2027: \n2028: **Output:** Optimized parameters $(\\gamma^*, \\lambda^*, \\sigma_v^*, \\tau^*, d_{\\text{safe}}^*, \\kappa_{\\text{wall}}^*)$\n2029: \n2030: **Expected performance:**\n2031: \n2032: $$\n2033: \\kappa_{\\text{total}} \\sim \\sqrt{\\lambda_{\\min}}, \\quad\n2034: T_{\\text{mix}} \\sim \\frac{5}{\\sqrt{\\lambda_{\\min}}}"
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}