{
  "chapter_index": 3,
  "section_id": "## 3. Synergistic Composition and Foster-Lyapunov Condition",
  "directive_count": 4,
  "hints": [
    {
      "directive_type": "definition",
      "label": "def-full-lyapunov-recall",
      "title": "Synergistic Lyapunov Function (Recall)",
      "start_line": 227,
      "end_line": 241,
      "header_lines": [
        228
      ],
      "content_start": 230,
      "content_end": 240,
      "content": "230: :label: def-full-lyapunov-recall\n231: \n232: From 03_cloning.md Definition 3.3.1:\n233: \n234: $$\n235: V_{\\text{total}}(S_1, S_2) = V_W(S_1, S_2) + c_V V_{\\text{Var}}(S_1, S_2) + c_B W_b(S_1, S_2)\n236: $$\n237: \n238: where:\n239: - $V_W = V_{\\text{loc}} + V_{\\text{struct}}$: Inter-swarm error\n240: - $V_{\\text{Var}} = V_{\\text{Var},x} + V_{\\text{Var},v}$: Intra-swarm variance",
      "metadata": {
        "label": "def-full-lyapunov-recall"
      },
      "section": "## 3. Synergistic Composition and Foster-Lyapunov Condition",
      "references": [],
      "raw_directive": "227: ### 3.2. The Full Lyapunov Function (Recall)\n228: \n229: :::{prf:definition} Synergistic Lyapunov Function (Recall)\n230: :label: def-full-lyapunov-recall\n231: \n232: From 03_cloning.md Definition 3.3.1:\n233: \n234: $$\n235: V_{\\text{total}}(S_1, S_2) = V_W(S_1, S_2) + c_V V_{\\text{Var}}(S_1, S_2) + c_B W_b(S_1, S_2)\n236: $$\n237: \n238: where:\n239: - $V_W = V_{\\text{loc}} + V_{\\text{struct}}$: Inter-swarm error\n240: - $V_{\\text{Var}} = V_{\\text{Var},x} + V_{\\text{Var},v}$: Intra-swarm variance\n241: - $W_b$: Boundary potential"
    },
    {
      "directive_type": "proposition",
      "label": "prop-complete-drift-summary",
      "title": "Complete Drift Characterization",
      "start_line": 247,
      "end_line": 260,
      "header_lines": [
        248
      ],
      "content_start": 250,
      "content_end": 259,
      "content": "250: :label: prop-complete-drift-summary\n251: \n252: | Component | $\\mathbb{E}_{\\text{clone}}[\\Delta \\cdot]$ | $\\mathbb{E}_{\\text{kin}}[\\Delta \\cdot]$ |\n253: |:----------|:------------------------------------------|:----------------------------------------|\n254: | $V_W$ | $\\leq C_W$ | $\\leq -\\kappa_W V_W \\tau + C_W'\\tau$ |\n255: | $V_{\\text{Var},x}$ | $\\leq -\\kappa_x V_{\\text{Var},x} + C_x$ | $\\leq C_{\\text{kin},x}\\tau$ |\n256: | $V_{\\text{Var},v}$ | $\\leq C_v$ | $\\leq -2\\gamma V_{\\text{Var},v}\\tau + d\\sigma_{\\max}^2\\tau$ |\n257: | $W_b$ | $\\leq -\\kappa_b W_b + C_b$ | $\\leq -\\kappa_{\\text{pot}} W_b \\tau + C_{\\text{pot}}\\tau$ |\n258: \n259: **Sources:**",
      "metadata": {
        "label": "prop-complete-drift-summary"
      },
      "section": "## 3. Synergistic Composition and Foster-Lyapunov Condition",
      "references": [],
      "raw_directive": "247: We summarize all drift results:\n248: \n249: :::{prf:proposition} Complete Drift Characterization\n250: :label: prop-complete-drift-summary\n251: \n252: | Component | $\\mathbb{E}_{\\text{clone}}[\\Delta \\cdot]$ | $\\mathbb{E}_{\\text{kin}}[\\Delta \\cdot]$ |\n253: |:----------|:------------------------------------------|:----------------------------------------|\n254: | $V_W$ | $\\leq C_W$ | $\\leq -\\kappa_W V_W \\tau + C_W'\\tau$ |\n255: | $V_{\\text{Var},x}$ | $\\leq -\\kappa_x V_{\\text{Var},x} + C_x$ | $\\leq C_{\\text{kin},x}\\tau$ |\n256: | $V_{\\text{Var},v}$ | $\\leq C_v$ | $\\leq -2\\gamma V_{\\text{Var},v}\\tau + d\\sigma_{\\max}^2\\tau$ |\n257: | $W_b$ | $\\leq -\\kappa_b W_b + C_b$ | $\\leq -\\kappa_{\\text{pot}} W_b \\tau + C_{\\text{pot}}\\tau$ |\n258: \n259: **Sources:**\n260: - Cloning drifts: 03_cloning.md Theorem 12.3.1"
    },
    {
      "directive_type": "theorem",
      "label": "thm-foster-lyapunov-main",
      "title": "Foster-Lyapunov Drift for the Composed Operator",
      "start_line": 264,
      "end_line": 288,
      "header_lines": [
        265
      ],
      "content_start": 267,
      "content_end": 287,
      "content": "267: :label: thm-foster-lyapunov-main\n268: \n269: Under the foundational axioms, there exist coupling constants $c_V^*, c_B^* > 0$ such that the composed operator $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ satisfies:\n270: \n271: $$\n272: \\mathbb{E}_{\\text{total}}[V_{\\text{total}}(S') \\mid S] \\leq (1 - \\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S) + C_{\\text{total}}\n273: $$\n274: \n275: where:\n276: $$\n277: \\kappa_{\\text{total}} := \\min\\left(\\frac{\\kappa_W}{2}, \\frac{c_V^* \\kappa_x}{2}, \\frac{c_V^* \\gamma}{2}, \\frac{c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}{2}\\right) > 0\n278: $$\n279: \n280: $$\n281: C_{\\text{total}} := C_W + C_W'\\tau + c_V^*(C_x + C_v + C_{\\text{kin},x}\\tau) + c_B^*(C_b + C_{\\text{pot}}\\tau) < \\infty\n282: $$\n283: \n284: **Both constants are independent of $N$.**\n285: \n286: **Consequence:** This is a **Foster-Lyapunov drift condition**, which implies:\n287: 1. Geometric ergodicity",
      "metadata": {
        "label": "thm-foster-lyapunov-main"
      },
      "section": "## 3. Synergistic Composition and Foster-Lyapunov Condition",
      "references": [],
      "raw_directive": "264: ### 3.4. Main Theorem: Synergistic Foster-Lyapunov Condition\n265: \n266: :::{prf:theorem} Foster-Lyapunov Drift for the Composed Operator\n267: :label: thm-foster-lyapunov-main\n268: \n269: Under the foundational axioms, there exist coupling constants $c_V^*, c_B^* > 0$ such that the composed operator $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ satisfies:\n270: \n271: $$\n272: \\mathbb{E}_{\\text{total}}[V_{\\text{total}}(S') \\mid S] \\leq (1 - \\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S) + C_{\\text{total}}\n273: $$\n274: \n275: where:\n276: $$\n277: \\kappa_{\\text{total}} := \\min\\left(\\frac{\\kappa_W}{2}, \\frac{c_V^* \\kappa_x}{2}, \\frac{c_V^* \\gamma}{2}, \\frac{c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}{2}\\right) > 0\n278: $$\n279: \n280: $$\n281: C_{\\text{total}} := C_W + C_W'\\tau + c_V^*(C_x + C_v + C_{\\text{kin},x}\\tau) + c_B^*(C_b + C_{\\text{pot}}\\tau) < \\infty\n282: $$\n283: \n284: **Both constants are independent of $N$.**\n285: \n286: **Consequence:** This is a **Foster-Lyapunov drift condition**, which implies:\n287: 1. Geometric ergodicity\n288: 2. Exponential convergence to equilibrium"
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-foster-lyapunov-main",
      "title": null,
      "start_line": 292,
      "end_line": 518,
      "header_lines": [
        293
      ],
      "content_start": 295,
      "content_end": 517,
      "content": "295: :label: proof-thm-foster-lyapunov-main\n296: \n297: **Proof (Rigorous Verification of Coupling Constants).**\n298: \n299: This proof verifies that there exist finite coupling constants $c_V^*, c_B^* > 0$ such that the Foster-Lyapunov condition holds with explicit $\\kappa_{\\text{total}}$ and $C_{\\text{total}}$.\n300: \n301: **PART I: Decomposition of the Composed Operator**\n302: \n303: The total Lyapunov function is:\n304: \n305: $$\n306: V_{\\text{total}} = V_W + c_V V_{\\text{Var}} + c_B W_b\n307: $$\n308: \n309: where $V_{\\text{Var}} = V_{\\text{Var},x} + V_{\\text{Var},v}$.\n310: \n311: The composed operator $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ acts as:\n312: \n313: $$\n314: S \\xrightarrow{\\Psi_{\\text{clone}}} S^{\\text{clone}} \\xrightarrow{\\Psi_{\\text{kin}}} S'\n315: $$\n316: \n317: **By the tower property of expectation:**\n318: \n319: $$\n320: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{total}}] + \\mathbb{E}_{\\text{clone}}[\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{total}} \\mid S^{\\text{clone}}]]\n321: $$\n322: \n323: **PART II: Collect All Drift Inequalities**\n324: \n325: From previous chapters, we have the following drift bounds:\n326: \n327: **From Cloning (03_cloning.md):**\n328: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_W] \\leq C_W$ (bounded expansion)\n329: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] \\leq -\\kappa_x V_{\\text{Var},x} + C_x$ (contraction)\n330: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] \\leq C_v$ (bounded expansion)\n331: - $\\mathbb{E}_{\\text{clone}}[\\Delta W_b] \\leq -\\kappa_b W_b + C_b$ (contraction)\n332: \n333: **From Kinetics (this document):**\n334: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_W] \\leq -\\kappa_W V_W \\tau + C_W'\\tau$ (Theorem 2.3.1)\n335: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},x}] \\leq C_{\\text{kin},x}\\tau$ (Theorem 4.3.1, bounded expansion)\n336: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v}\\tau + d\\sigma_{\\max}^2\\tau$ (Theorem 3.3.1)\n337: - $\\mathbb{E}_{\\text{kin}}[\\Delta W_b] \\leq -\\kappa_{\\text{pot}} W_b \\tau + C_{\\text{pot}}\\tau$ (Theorem 5.3.1)\n338: \n339: **PART III: Aggregate Drifts for Each Component**\n340: \n341: **Component 1: Inter-swarm error $V_W$**\n342: \n343: $$\n344: \\mathbb{E}_{\\text{total}}[\\Delta V_W] = \\mathbb{E}_{\\text{clone}}[\\Delta V_W] + \\mathbb{E}_{\\text{kin}}[\\Delta V_W]\n345: $$\n346: \n347: $$\n348: \\leq C_W + (-\\kappa_W V_W \\tau + C_W'\\tau) = -\\kappa_W V_W \\tau + (C_W + C_W'\\tau)\n349: $$\n350: \n351: **Component 2: Positional variance $V_{\\text{Var},x}$**\n352: \n353: $$\n354: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},x}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] + \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},x}]\n355: $$\n356: \n357: $$\n358: \\leq (-\\kappa_x V_{\\text{Var},x} + C_x) + C_{\\text{kin},x}\\tau = -\\kappa_x V_{\\text{Var},x} + (C_x + C_{\\text{kin},x}\\tau)\n359: $$\n360: \n361: **Component 3: Velocity variance $V_{\\text{Var},v}$**\n362: \n363: $$\n364: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},v}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] + \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}]\n365: $$\n366: \n367: $$\n368: \\leq C_v + (-2\\gamma V_{\\text{Var},v}\\tau + d\\sigma_{\\max}^2\\tau) = -2\\gamma V_{\\text{Var},v}\\tau + (C_v + d\\sigma_{\\max}^2\\tau)\n369: $$\n370: \n371: **Component 4: Boundary potential $W_b$**\n372: \n373: $$\n374: \\mathbb{E}_{\\text{total}}[\\Delta W_b] = \\mathbb{E}_{\\text{clone}}[\\Delta W_b] + \\mathbb{E}_{\\text{kin}}[\\Delta W_b]\n375: $$\n376: \n377: $$\n378: \\leq (-\\kappa_b W_b + C_b) + (-\\kappa_{\\text{pot}} W_b\\tau + C_{\\text{pot}}\\tau)\n379: $$\n380: \n381: $$\n382: = -(\\kappa_b + \\kappa_{\\text{pot}}\\tau) W_b + (C_b + C_{\\text{pot}}\\tau)\n383: $$\n384: \n385: **PART IV: Combine with Coupling Constants**\n386: \n387: $$\n388: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] = \\mathbb{E}_{\\text{total}}[\\Delta V_W] + c_V \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},x}] + c_V \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},v}] + c_B \\mathbb{E}_{\\text{total}}[\\Delta W_b]\n389: $$\n390: \n391: Substituting the bounds:\n392: \n393: $$\n394: \\leq -\\kappa_W V_W \\tau + (C_W + C_W'\\tau)\n395: $$\n396: \n397: $$\n398: + c_V[-\\kappa_x V_{\\text{Var},x} + (C_x + C_{\\text{kin},x}\\tau)]\n399: $$\n400: \n401: $$\n402: + c_V[-2\\gamma V_{\\text{Var},v}\\tau + (C_v + d\\sigma_{\\max}^2\\tau)]\n403: $$\n404: \n405: $$\n406: + c_B[-(\\kappa_b + \\kappa_{\\text{pot}}\\tau) W_b + (C_b + C_{\\text{pot}}\\tau)]\n407: $$\n408: \n409: **Factor out the Lyapunov components:**\n410: \n411: $$\n412: = -[\\kappa_W\\tau \\cdot V_W + c_V\\kappa_x \\cdot V_{\\text{Var},x} + c_V 2\\gamma\\tau \\cdot V_{\\text{Var},v} + c_B(\\kappa_b + \\kappa_{\\text{pot}}\\tau) \\cdot W_b]\n413: $$\n414: \n415: $$\n416: + [C_W + C_W'\\tau + c_V(C_x + C_{\\text{kin},x}\\tau) + c_V(C_v + d\\sigma_{\\max}^2\\tau) + c_B(C_b + C_{\\text{pot}}\\tau)]\n417: $$\n418: \n419: **PART V: Design Coupling Constants for Balanced Contraction**\n420: \n421: We need to find $c_V^*, c_B^* > 0$ such that all components contract at a common rate.\n422: \n423: **Target:** Make all contraction coefficients equal to $\\frac{\\kappa_W\\tau}{2}$.\n424: \n425: **For $V_W$:** Already has coefficient $\\kappa_W\\tau$.\n426: \n427: **For $V_{\\text{Var},x}$:** Require $c_V\\kappa_x = \\frac{\\kappa_W\\tau}{2}$, so:\n428: \n429: $$\n430: c_V^* = \\frac{\\kappa_W\\tau}{2\\kappa_x}\n431: $$\n432: \n433: **Verification that $c_V^* < \\infty$:** By Theorem 03_cloning.md (Ch 10), $\\kappa_x > 0$ is bounded below by a constant independent of $N$, so $c_V^* < \\infty$. \u2713\n434: \n435: **For $V_{\\text{Var},v}$:** Require $c_V^* \\cdot 2\\gamma\\tau = \\frac{\\kappa_W\\tau}{2}$:\n436: \n437: $$\n438: \\frac{\\kappa_W\\tau}{2\\kappa_x} \\cdot 2\\gamma\\tau = \\frac{\\kappa_W\\tau}{2}\n439: $$\n440: \n441: $$\n442: \\implies \\frac{\\gamma\\tau}{\\kappa_x} = \\frac{1}{2}\n443: $$\n444: \n445: **This is NOT automatically satisfied!** We have a constraint: we must choose $\\tau$ such that $\\gamma\\tau \\leq \\kappa_x/2$.\n446: \n447: **Resolution:** Redefine the target rates. Instead, set:\n448: \n449: $$\n450: \\kappa_{\\text{total}} := \\min\\left(\\frac{\\kappa_W\\tau}{2}, \\frac{c_V^*\\kappa_x}{2}, \\frac{c_V^* 2\\gamma\\tau}{2}, \\frac{c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}{2}\\right)\n451: $$\n452: \n453: This ensures $\\kappa_{\\text{total}} > 0$ is the **minimum** contraction rate across all components.\n454: \n455: **For $W_b$:** Require $c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau) = \\frac{\\kappa_W\\tau}{2}$:\n456: \n457: $$\n458: c_B^* = \\frac{\\kappa_W\\tau}{2(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}\n459: $$\n460: \n461: **Verification that $c_B^* < \\infty$:** By Theorem 03_cloning.md (Ch 11), $\\kappa_b > 0$, so $c_B^* < \\infty$. \u2713\n462: \n463: **PART VI: Verify Foster-Lyapunov Form**\n464: \n465: With the chosen coupling constants:\n466: \n467: $$\n468: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] \\leq -2\\kappa_{\\text{total}} V_{\\text{total}} + C_{\\text{total}}\n469: $$\n470: \n471: where:\n472: \n473: $$\n474: \\kappa_{\\text{total}} = \\min\\left(\\frac{\\kappa_W\\tau}{2}, \\frac{c_V^*\\kappa_x}{2}, \\frac{c_V^* 2\\gamma\\tau}{2}, \\frac{c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}{2}\\right) > 0\n475: $$\n476: \n477: $$\n478: C_{\\text{total}} = C_W + C_W'\\tau + c_V^*(C_x + C_{\\text{kin},x}\\tau + C_v + d\\sigma_{\\max}^2\\tau) + c_B^*(C_b + C_{\\text{pot}}\\tau) < \\infty\n479: $$\n480: \n481: **Rewrite in standard Foster-Lyapunov form:**\n482: \n483: $$\n484: \\mathbb{E}_{\\text{total}}[V_{\\text{total}}(S')] \\leq (1 - 2\\kappa_{\\text{total}}) V_{\\text{total}}(S) + C_{\\text{total}}\n485: $$\n486: \n487: **For small $\\tau$:** $(1 - 2\\kappa_{\\text{total}}) \\approx (1 - \\kappa_{\\text{total}}\\tau)$, giving:\n488: \n489: $$\n490: \\mathbb{E}_{\\text{total}}[V_{\\text{total}}(S')] \\leq (1 - \\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S) + C_{\\text{total}}\n491: $$\n492: \n493: **PART VII: Verify N-Independence**\n494: \n495: **Key verification:** Both $c_V^*$ and $c_B^*$ are **independent of $N$** because:\n496: - $\\kappa_W$, $\\kappa_x$, $\\kappa_b$ are all $O(1)$ independent of $N$ (proven in previous chapters)\n497: - $\\tau$ is fixed\n498: - All constants in $C_{\\text{total}}$ are $O(1)$ or $O(d)$ but independent of $N$\n499: \n500: **This is crucial for scalability!**\n501: \n502: **PART VIII: Consequence - Foster-Lyapunov Condition**\n503: \n504: The inequality:\n505: \n506: $$\n507: \\mathbb{E}[V_{\\text{total}}(S')] \\leq (1 - \\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S) + C_{\\text{total}}\n508: $$\n509: \n510: is the **Foster-Lyapunov drift condition** with:\n511: - Contraction rate: $\\kappa_{\\text{total}} > 0$\n512: - Drift constant: $C_{\\text{total}} < \\infty$\n513: \n514: **By Foster-Lyapunov theory (Meyn & Tweedie, 2009, Theorem 14.0.1), this implies:**\n515: 1. **Geometric ergodicity**: The Markov chain converges to equilibrium at exponential rate $e^{-\\kappa_{\\text{total}} t}$\n516: 2. **Existence of unique QSD**: The quasi-stationary distribution exists and is unique\n517: 3. **Concentration**: The system spends most time in a compact set $\\{V_{\\text{total}} \\leq C_{\\text{total}}/\\kappa_{\\text{total}}\\}$",
      "metadata": {
        "label": "proof-thm-foster-lyapunov-main"
      },
      "section": "## 3. Synergistic Composition and Foster-Lyapunov Condition",
      "references": [],
      "raw_directive": "292: ### 3.5. Proof: Choosing the Coupling Constants\n293: \n294: :::{prf:proof}\n295: :label: proof-thm-foster-lyapunov-main\n296: \n297: **Proof (Rigorous Verification of Coupling Constants).**\n298: \n299: This proof verifies that there exist finite coupling constants $c_V^*, c_B^* > 0$ such that the Foster-Lyapunov condition holds with explicit $\\kappa_{\\text{total}}$ and $C_{\\text{total}}$.\n300: \n301: **PART I: Decomposition of the Composed Operator**\n302: \n303: The total Lyapunov function is:\n304: \n305: $$\n306: V_{\\text{total}} = V_W + c_V V_{\\text{Var}} + c_B W_b\n307: $$\n308: \n309: where $V_{\\text{Var}} = V_{\\text{Var},x} + V_{\\text{Var},v}$.\n310: \n311: The composed operator $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$ acts as:\n312: \n313: $$\n314: S \\xrightarrow{\\Psi_{\\text{clone}}} S^{\\text{clone}} \\xrightarrow{\\Psi_{\\text{kin}}} S'\n315: $$\n316: \n317: **By the tower property of expectation:**\n318: \n319: $$\n320: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{total}}] + \\mathbb{E}_{\\text{clone}}[\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{total}} \\mid S^{\\text{clone}}]]\n321: $$\n322: \n323: **PART II: Collect All Drift Inequalities**\n324: \n325: From previous chapters, we have the following drift bounds:\n326: \n327: **From Cloning (03_cloning.md):**\n328: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_W] \\leq C_W$ (bounded expansion)\n329: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] \\leq -\\kappa_x V_{\\text{Var},x} + C_x$ (contraction)\n330: - $\\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] \\leq C_v$ (bounded expansion)\n331: - $\\mathbb{E}_{\\text{clone}}[\\Delta W_b] \\leq -\\kappa_b W_b + C_b$ (contraction)\n332: \n333: **From Kinetics (this document):**\n334: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_W] \\leq -\\kappa_W V_W \\tau + C_W'\\tau$ (Theorem 2.3.1)\n335: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},x}] \\leq C_{\\text{kin},x}\\tau$ (Theorem 4.3.1, bounded expansion)\n336: - $\\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v}\\tau + d\\sigma_{\\max}^2\\tau$ (Theorem 3.3.1)\n337: - $\\mathbb{E}_{\\text{kin}}[\\Delta W_b] \\leq -\\kappa_{\\text{pot}} W_b \\tau + C_{\\text{pot}}\\tau$ (Theorem 5.3.1)\n338: \n339: **PART III: Aggregate Drifts for Each Component**\n340: \n341: **Component 1: Inter-swarm error $V_W$**\n342: \n343: $$\n344: \\mathbb{E}_{\\text{total}}[\\Delta V_W] = \\mathbb{E}_{\\text{clone}}[\\Delta V_W] + \\mathbb{E}_{\\text{kin}}[\\Delta V_W]\n345: $$\n346: \n347: $$\n348: \\leq C_W + (-\\kappa_W V_W \\tau + C_W'\\tau) = -\\kappa_W V_W \\tau + (C_W + C_W'\\tau)\n349: $$\n350: \n351: **Component 2: Positional variance $V_{\\text{Var},x}$**\n352: \n353: $$\n354: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},x}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] + \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},x}]\n355: $$\n356: \n357: $$\n358: \\leq (-\\kappa_x V_{\\text{Var},x} + C_x) + C_{\\text{kin},x}\\tau = -\\kappa_x V_{\\text{Var},x} + (C_x + C_{\\text{kin},x}\\tau)\n359: $$\n360: \n361: **Component 3: Velocity variance $V_{\\text{Var},v}$**\n362: \n363: $$\n364: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},v}] = \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] + \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}]\n365: $$\n366: \n367: $$\n368: \\leq C_v + (-2\\gamma V_{\\text{Var},v}\\tau + d\\sigma_{\\max}^2\\tau) = -2\\gamma V_{\\text{Var},v}\\tau + (C_v + d\\sigma_{\\max}^2\\tau)\n369: $$\n370: \n371: **Component 4: Boundary potential $W_b$**\n372: \n373: $$\n374: \\mathbb{E}_{\\text{total}}[\\Delta W_b] = \\mathbb{E}_{\\text{clone}}[\\Delta W_b] + \\mathbb{E}_{\\text{kin}}[\\Delta W_b]\n375: $$\n376: \n377: $$\n378: \\leq (-\\kappa_b W_b + C_b) + (-\\kappa_{\\text{pot}} W_b\\tau + C_{\\text{pot}}\\tau)\n379: $$\n380: \n381: $$\n382: = -(\\kappa_b + \\kappa_{\\text{pot}}\\tau) W_b + (C_b + C_{\\text{pot}}\\tau)\n383: $$\n384: \n385: **PART IV: Combine with Coupling Constants**\n386: \n387: $$\n388: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] = \\mathbb{E}_{\\text{total}}[\\Delta V_W] + c_V \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},x}] + c_V \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{Var},v}] + c_B \\mathbb{E}_{\\text{total}}[\\Delta W_b]\n389: $$\n390: \n391: Substituting the bounds:\n392: \n393: $$\n394: \\leq -\\kappa_W V_W \\tau + (C_W + C_W'\\tau)\n395: $$\n396: \n397: $$\n398: + c_V[-\\kappa_x V_{\\text{Var},x} + (C_x + C_{\\text{kin},x}\\tau)]\n399: $$\n400: \n401: $$\n402: + c_V[-2\\gamma V_{\\text{Var},v}\\tau + (C_v + d\\sigma_{\\max}^2\\tau)]\n403: $$\n404: \n405: $$\n406: + c_B[-(\\kappa_b + \\kappa_{\\text{pot}}\\tau) W_b + (C_b + C_{\\text{pot}}\\tau)]\n407: $$\n408: \n409: **Factor out the Lyapunov components:**\n410: \n411: $$\n412: = -[\\kappa_W\\tau \\cdot V_W + c_V\\kappa_x \\cdot V_{\\text{Var},x} + c_V 2\\gamma\\tau \\cdot V_{\\text{Var},v} + c_B(\\kappa_b + \\kappa_{\\text{pot}}\\tau) \\cdot W_b]\n413: $$\n414: \n415: $$\n416: + [C_W + C_W'\\tau + c_V(C_x + C_{\\text{kin},x}\\tau) + c_V(C_v + d\\sigma_{\\max}^2\\tau) + c_B(C_b + C_{\\text{pot}}\\tau)]\n417: $$\n418: \n419: **PART V: Design Coupling Constants for Balanced Contraction**\n420: \n421: We need to find $c_V^*, c_B^* > 0$ such that all components contract at a common rate.\n422: \n423: **Target:** Make all contraction coefficients equal to $\\frac{\\kappa_W\\tau}{2}$.\n424: \n425: **For $V_W$:** Already has coefficient $\\kappa_W\\tau$.\n426: \n427: **For $V_{\\text{Var},x}$:** Require $c_V\\kappa_x = \\frac{\\kappa_W\\tau}{2}$, so:\n428: \n429: $$\n430: c_V^* = \\frac{\\kappa_W\\tau}{2\\kappa_x}\n431: $$\n432: \n433: **Verification that $c_V^* < \\infty$:** By Theorem 03_cloning.md (Ch 10), $\\kappa_x > 0$ is bounded below by a constant independent of $N$, so $c_V^* < \\infty$. \u2713\n434: \n435: **For $V_{\\text{Var},v}$:** Require $c_V^* \\cdot 2\\gamma\\tau = \\frac{\\kappa_W\\tau}{2}$:\n436: \n437: $$\n438: \\frac{\\kappa_W\\tau}{2\\kappa_x} \\cdot 2\\gamma\\tau = \\frac{\\kappa_W\\tau}{2}\n439: $$\n440: \n441: $$\n442: \\implies \\frac{\\gamma\\tau}{\\kappa_x} = \\frac{1}{2}\n443: $$\n444: \n445: **This is NOT automatically satisfied!** We have a constraint: we must choose $\\tau$ such that $\\gamma\\tau \\leq \\kappa_x/2$.\n446: \n447: **Resolution:** Redefine the target rates. Instead, set:\n448: \n449: $$\n450: \\kappa_{\\text{total}} := \\min\\left(\\frac{\\kappa_W\\tau}{2}, \\frac{c_V^*\\kappa_x}{2}, \\frac{c_V^* 2\\gamma\\tau}{2}, \\frac{c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}{2}\\right)\n451: $$\n452: \n453: This ensures $\\kappa_{\\text{total}} > 0$ is the **minimum** contraction rate across all components.\n454: \n455: **For $W_b$:** Require $c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau) = \\frac{\\kappa_W\\tau}{2}$:\n456: \n457: $$\n458: c_B^* = \\frac{\\kappa_W\\tau}{2(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}\n459: $$\n460: \n461: **Verification that $c_B^* < \\infty$:** By Theorem 03_cloning.md (Ch 11), $\\kappa_b > 0$, so $c_B^* < \\infty$. \u2713\n462: \n463: **PART VI: Verify Foster-Lyapunov Form**\n464: \n465: With the chosen coupling constants:\n466: \n467: $$\n468: \\mathbb{E}_{\\text{total}}[\\Delta V_{\\text{total}}] \\leq -2\\kappa_{\\text{total}} V_{\\text{total}} + C_{\\text{total}}\n469: $$\n470: \n471: where:\n472: \n473: $$\n474: \\kappa_{\\text{total}} = \\min\\left(\\frac{\\kappa_W\\tau}{2}, \\frac{c_V^*\\kappa_x}{2}, \\frac{c_V^* 2\\gamma\\tau}{2}, \\frac{c_B^*(\\kappa_b + \\kappa_{\\text{pot}}\\tau)}{2}\\right) > 0\n475: $$\n476: \n477: $$\n478: C_{\\text{total}} = C_W + C_W'\\tau + c_V^*(C_x + C_{\\text{kin},x}\\tau + C_v + d\\sigma_{\\max}^2\\tau) + c_B^*(C_b + C_{\\text{pot}}\\tau) < \\infty\n479: $$\n480: \n481: **Rewrite in standard Foster-Lyapunov form:**\n482: \n483: $$\n484: \\mathbb{E}_{\\text{total}}[V_{\\text{total}}(S')] \\leq (1 - 2\\kappa_{\\text{total}}) V_{\\text{total}}(S) + C_{\\text{total}}\n485: $$\n486: \n487: **For small $\\tau$:** $(1 - 2\\kappa_{\\text{total}}) \\approx (1 - \\kappa_{\\text{total}}\\tau)$, giving:\n488: \n489: $$\n490: \\mathbb{E}_{\\text{total}}[V_{\\text{total}}(S')] \\leq (1 - \\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S) + C_{\\text{total}}\n491: $$\n492: \n493: **PART VII: Verify N-Independence**\n494: \n495: **Key verification:** Both $c_V^*$ and $c_B^*$ are **independent of $N$** because:\n496: - $\\kappa_W$, $\\kappa_x$, $\\kappa_b$ are all $O(1)$ independent of $N$ (proven in previous chapters)\n497: - $\\tau$ is fixed\n498: - All constants in $C_{\\text{total}}$ are $O(1)$ or $O(d)$ but independent of $N$\n499: \n500: **This is crucial for scalability!**\n501: \n502: **PART VIII: Consequence - Foster-Lyapunov Condition**\n503: \n504: The inequality:\n505: \n506: $$\n507: \\mathbb{E}[V_{\\text{total}}(S')] \\leq (1 - \\kappa_{\\text{total}}\\tau) V_{\\text{total}}(S) + C_{\\text{total}}\n508: $$\n509: \n510: is the **Foster-Lyapunov drift condition** with:\n511: - Contraction rate: $\\kappa_{\\text{total}} > 0$\n512: - Drift constant: $C_{\\text{total}} < \\infty$\n513: \n514: **By Foster-Lyapunov theory (Meyn & Tweedie, 2009, Theorem 14.0.1), this implies:**\n515: 1. **Geometric ergodicity**: The Markov chain converges to equilibrium at exponential rate $e^{-\\kappa_{\\text{total}} t}$\n516: 2. **Existence of unique QSD**: The quasi-stationary distribution exists and is unique\n517: 3. **Concentration**: The system spends most time in a compact set $\\{V_{\\text{total}} \\leq C_{\\text{total}}/\\kappa_{\\text{total}}\\}$\n518: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}