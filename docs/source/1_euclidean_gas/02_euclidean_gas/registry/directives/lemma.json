{
  "document_id": "02_euclidean_gas",
  "stage": "directives",
  "directive_type": "lemma",
  "generated_at": "2025-11-08T23:19:38.226844+00:00",
  "count": 19,
  "items": [
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-kinetic-lipschitz",
      "title": "Lipschitz property of the kinetic flow",
      "start_line": 555,
      "end_line": 610,
      "header_lines": [
        556
      ],
      "content_start": 558,
      "content_end": 609,
      "content": "558: :label: lem-sasaki-kinetic-lipschitz\n559: \n560: For $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and any $\\xi_v,\\xi_x\\in\\mathbb R^d$ define\n561: \n562: $$\n563: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\big(v+\\tfrac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n564: \n565: $$\n566: Then\n567: \n568: $$\n569: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')),\\qquad L_{\\mathrm{flow}}:=1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}.\n570: \n571: $$\n572: \n573: ```{dropdown} Proof\n574: :::{prf:proof}\n575: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and $\\xi_v,\\xi_x\\in\\mathbb R^d$. Define the uncapped velocities\n576: \n577: $$\n578: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad\\tilde v':=v'+\\frac{\\tau}{m}F(x')-\\gamma_{\\mathrm{fric}}\\tau\\big(v'-u(x')\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n579: \n580: $$\n581: \n582: Because the same velocity noise $\\xi_v$ appears in both expressions, it cancels in the difference $\\tilde v-\\tilde v'$. We bound the displacement in four steps.\n583: \n584: 1. **Uncapped velocity difference.** Using the triangle inequality, the Lipschitz constant $L_F$ of $F$, and the Lipschitz constant $L_u$ of $u$, we obtain\n585: \n586: $$\n587: \\begin{aligned}\n588: \\|\\tilde v-\\tilde v'\\|&\\le \\|v-v'\\|+\\frac{\\tau}{m}\\|F(x)-F(x')\\|+\\gamma_{\\mathrm{fric}}\\tau\\|v-v'\\|+\\gamma_{\\mathrm{fric}}\\tau\\|u(x)-u(x')\\|\\\\\n589: &\\le(1+\\gamma_{\\mathrm{fric}}\\tau)\\,\\|v-v'\\|+\\Big(\\frac{\\tau}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau L_u\\Big)\\,\\|x-x'\\|.\n590: \\end{aligned}\n591: \n592: $$\n593: \n594: 2. **Lipschitz projection.** Lemma {prf:ref}`lem-squashing-properties-generic` shows the smooth squashing map $\\psi_v$ is $1$-Lipschitz, so the same inequality holds for the capped velocities $v^+:=\\psi_v(\\tilde v)$ and $v'^+:=\\psi_v(\\tilde v')$.\n595: \n596: 3. **Position update.** The Euler step sets $x^+:=x+\\tau v^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ and $x'^+:=x'+\\tau v'^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Hence\n597: \n598: $$\n599: \\|x^+-x'^+\\|\\le\\|x-x'\\|+\\tau\\,\\|v^+-v'^+\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u\\Big)\\|x-x'\\|+\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)\\|v-v'\\|.\n600: \n601: $$\n602: \n603: 4. **Express via the Sasaki metric.** The Sasaki distance satisfies $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))^2=\\|x-x'\\|^2+\\lambda_v\\|v-v'\\|^2$, so $\\|x-x'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ and $\\|v-v'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}/\\sqrt{\\lambda_v}$. Substituting these bounds into the inequality from Step 3 yields\n604: \n605: $$\n606: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}\\Big) d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')).\n607: \n608: $$\n609: ",
      "metadata": {
        "label": "lem-sasaki-kinetic-lipschitz"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-squashing-properties-generic"
      ],
      "raw_directive": "555: 2. **Boundary regularity & smoothness.** Lemma {prf:ref}`lem-euclidean-boundary-holder` bounds the death probability with explicit Hölder constants, verifying the boundary axioms ({prf:ref}`def-axiom-boundary-regularity`, {prf:ref}`def-axiom-boundary-smoothness`).\n556: \n557: :::{prf:lemma} Lipschitz property of the kinetic flow\n558: :label: lem-sasaki-kinetic-lipschitz\n559: \n560: For $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and any $\\xi_v,\\xi_x\\in\\mathbb R^d$ define\n561: \n562: $$\n563: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\big(v+\\tfrac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n564: \n565: $$\n566: Then\n567: \n568: $$\n569: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')),\\qquad L_{\\mathrm{flow}}:=1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}.\n570: \n571: $$\n572: \n573: ```{dropdown} Proof\n574: :::{prf:proof}\n575: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and $\\xi_v,\\xi_x\\in\\mathbb R^d$. Define the uncapped velocities\n576: \n577: $$\n578: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad\\tilde v':=v'+\\frac{\\tau}{m}F(x')-\\gamma_{\\mathrm{fric}}\\tau\\big(v'-u(x')\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n579: \n580: $$\n581: \n582: Because the same velocity noise $\\xi_v$ appears in both expressions, it cancels in the difference $\\tilde v-\\tilde v'$. We bound the displacement in four steps.\n583: \n584: 1. **Uncapped velocity difference.** Using the triangle inequality, the Lipschitz constant $L_F$ of $F$, and the Lipschitz constant $L_u$ of $u$, we obtain\n585: \n586: $$\n587: \\begin{aligned}\n588: \\|\\tilde v-\\tilde v'\\|&\\le \\|v-v'\\|+\\frac{\\tau}{m}\\|F(x)-F(x')\\|+\\gamma_{\\mathrm{fric}}\\tau\\|v-v'\\|+\\gamma_{\\mathrm{fric}}\\tau\\|u(x)-u(x')\\|\\\\\n589: &\\le(1+\\gamma_{\\mathrm{fric}}\\tau)\\,\\|v-v'\\|+\\Big(\\frac{\\tau}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau L_u\\Big)\\,\\|x-x'\\|.\n590: \\end{aligned}\n591: \n592: $$\n593: \n594: 2. **Lipschitz projection.** Lemma {prf:ref}`lem-squashing-properties-generic` shows the smooth squashing map $\\psi_v$ is $1$-Lipschitz, so the same inequality holds for the capped velocities $v^+:=\\psi_v(\\tilde v)$ and $v'^+:=\\psi_v(\\tilde v')$.\n595: \n596: 3. **Position update.** The Euler step sets $x^+:=x+\\tau v^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ and $x'^+:=x'+\\tau v'^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Hence\n597: \n598: $$\n599: \\|x^+-x'^+\\|\\le\\|x-x'\\|+\\tau\\,\\|v^+-v'^+\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u\\Big)\\|x-x'\\|+\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)\\|v-v'\\|.\n600: \n601: $$\n602: \n603: 4. **Express via the Sasaki metric.** The Sasaki distance satisfies $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))^2=\\|x-x'\\|^2+\\lambda_v\\|v-v'\\|^2$, so $\\|x-x'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ and $\\|v-v'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}/\\sqrt{\\lambda_v}$. Substituting these bounds into the inequality from Step 3 yields\n604: \n605: $$\n606: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}\\Big) d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')).\n607: \n608: $$\n609: \n610: The constant in parentheses is $L_{\\mathrm{flow}}$, completing the proof.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-boundary-holder",
      "title": "Hölder continuity of the death probability",
      "start_line": 612,
      "end_line": 727,
      "header_lines": [
        613
      ],
      "content_start": 615,
      "content_end": 726,
      "content": "615: :label: lem-euclidean-boundary-holder\n616: \n617: ```{dropdown} Proof\n618: :::{prf:proof}\n619: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and set $\\Delta:=d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))$. Let $C$ be any compact subset of $\\mathbb R^d$ containing $x$ and $x'$, so that the local constants from Lemma {prf:ref}`lem-euclidean-geometric-consistency` apply uniformly on $C$. For independent $\\xi_v,\\xi_x\\sim\\mathcal N(0,I_d)$ define\n620: \n621: $$\n622: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\Big(v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\Big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n623: \n624: $$\n625: \n626: Lemma {prf:ref}`lem-sasaki-kinetic-lipschitz` delivers $\\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,\\Delta$ almost surely. Consequently\n627: \n628: $$\n629: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)+\\mathbb P\\big(\\Phi_{x',v'}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big).\n630: \n631: $$\n632: \n633: We bound the first term; the second is identical with primed variables.\n634: \n635: 1. **Tubular neighbourhood volume.** Because $\\partial\\mathcal X_{\\mathrm{valid}}$ is $C^1$ with bounded curvature, the tubular-neighbourhood theorem (\\[Federer 69, §4.18\\]) provides $\\varepsilon_{\\mathrm{tube}}>0$ and\n636: \n637: $$\n638: C_{\\partial}:=\\sup_{0<\\varepsilon\\le\\varepsilon_{\\mathrm{tube}}}\\frac{\\operatorname{Vol}(N_\\varepsilon(\\partial\\mathcal X_{\\mathrm{valid}}))}{\\varepsilon}<\\infty.\n639: \n640: $$\n641: \n642: By monotonicity it suffices to treat $L_{\\mathrm{flow}}\\Delta\\le\\varepsilon_{\\mathrm{tube}}$; otherwise the Hölder bound follows immediately.\n643: \n644: 2. **Affine Gaussian contribution (no capping).** Introduce the uncapped velocity update\n645: \n646: $$\n647: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n648: \n649: $$\n650: \n651: Then $\\tilde x:=x+\\tau\\tilde v+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ is Gaussian with mean $x+\\tau m(x,v)$, where $m(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))$, and covariance $\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)I_d$. Its density is\n652: \n653: $$\n654: p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}\\exp\\Big(-\\frac{\\|y-(x+\\tau m(x,v))\\|^2}{2\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)}\\Big).\n655: \n656: $$\n657: \n658: The density attains its supremum at the mean, yielding\n659: \n660: $$\n661: p_{\\mathrm{aff}}:=\\sup_{y\\in\\mathbb R^d}p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}.\n662: \n663: $$\n664: \n665: This constant governs the contribution of $C^c:=\\{\\|\\tilde v\\|\\le V_{\\mathrm{alg}}\\}$, where the velocity cap is inactive.\n666: \n667: 3. **Directional density under capping.** Let $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Lemma {prf:ref}`lem-euclidean-geometric-consistency` gives $\\mathbb P(E)\\le\\rho_*(C)$. On $E$ write $\\tilde v=ru$ with $r>V_{\\mathrm{alg}}$ and $u\\in S^{d-1}$. The capped velocity is $v^+=V_{\\mathrm{alg}}u$, whose conditional density equals\n668: \n669: $$\n670: g(u)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\int_{V_{\\mathrm{alg}}}^{\\infty}\\exp\\Big(-\\frac{\\|ru-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big) r^{d-1}\\,dr.\n671: \n672: $$\n673: \n674: The local bounds on $F$ and $u$ over $C$ imply\n675: \n676: $$\n677: \\|m(x,v)\\|\\le M_{\\mathrm{kin}}(C).\n678: \n679: $$\n680: \n681: For $r\\ge V_{\\mathrm{alg}}$ the inequality $\\|a-b\\|^2\\ge\\tfrac{1}{2}\\|a\\|^2-\\|b\\|^2$ yields\n682: \n683: $$\n684: \\|ru-m(x,v)\\|^2\\ge\\frac{r^2}{2}-M_{\\mathrm{kin}}(C)^2.\n685: \n686: $$\n687: \n688: Substituting into $g(u)$ and changing variables via $s=r^2/(4\\sigma_v^2\\tau)$ produces\n689: \n690: $$\n691: g(u)\\le\\frac{\\exp(M_{\\mathrm{kin}}(C)^2/(2\\sigma_v^2\\tau))}{(2\\pi\\sigma_v^2\\tau)^{d/2}}(2\\sigma_v^2\\tau)^{d/2}\\Gamma\\Big(\\frac{d}{2},\\frac{V_{\\mathrm{alg}}^2}{4\\sigma_v^2\\tau}\\Big)=:q_{\\mathrm{dir}}(C),\n692: \n693: $$\n694: \n695: where $\\Gamma(\\cdot,\\cdot)$ is the upper incomplete gamma function. Thus the capped direction has uniformly bounded density.\n696: \n697: 4. **Probability of hitting the tube.** For any Borel $A\\subseteq\\mathcal X$ split according to $E$:\n698: \n699: $$\n700: \\begin{aligned}\n701: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\big)&=\\mathbb P(E^c)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E^c\\big)+\\mathbb P(E)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E\\big)\\\\\n702: &\\le p_{\\mathrm{aff}}\\operatorname{Vol}(A)+\\rho_*(C) q_{\\mathrm{dir}}(C)\\operatorname{Vol}(A).\n703: \\end{aligned}\n704: \n705: $$\n706: \n707: Taking $A=N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})$ and using Step 1 yields\n708: \n709: $$\n710: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)\\le\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n711: \n712: $$\n713: \n714: Combining the two probabilities shows\n715: \n716: $$\n717: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n718: \n719: $$\n720: \n721: Therefore $\\alpha_B^{\\mathrm{Sasaki}}=1$ with Hölder constant\n722: \n723: $$\n724: L_{\\mathrm{death}}^{\\mathrm{Sasaki}}(C):=2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}.\n725: \n726: $$",
      "metadata": {
        "label": "lem-euclidean-boundary-holder"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-euclidean-geometric-consistency",
        "lem-sasaki-kinetic-lipschitz"
      ],
      "raw_directive": "612: :::\n613: \n614: :::{prf:lemma} Hölder continuity of the death probability\n615: :label: lem-euclidean-boundary-holder\n616: \n617: ```{dropdown} Proof\n618: :::{prf:proof}\n619: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and set $\\Delta:=d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))$. Let $C$ be any compact subset of $\\mathbb R^d$ containing $x$ and $x'$, so that the local constants from Lemma {prf:ref}`lem-euclidean-geometric-consistency` apply uniformly on $C$. For independent $\\xi_v,\\xi_x\\sim\\mathcal N(0,I_d)$ define\n620: \n621: $$\n622: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\Big(v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\Big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n623: \n624: $$\n625: \n626: Lemma {prf:ref}`lem-sasaki-kinetic-lipschitz` delivers $\\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,\\Delta$ almost surely. Consequently\n627: \n628: $$\n629: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)+\\mathbb P\\big(\\Phi_{x',v'}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big).\n630: \n631: $$\n632: \n633: We bound the first term; the second is identical with primed variables.\n634: \n635: 1. **Tubular neighbourhood volume.** Because $\\partial\\mathcal X_{\\mathrm{valid}}$ is $C^1$ with bounded curvature, the tubular-neighbourhood theorem (\\[Federer 69, §4.18\\]) provides $\\varepsilon_{\\mathrm{tube}}>0$ and\n636: \n637: $$\n638: C_{\\partial}:=\\sup_{0<\\varepsilon\\le\\varepsilon_{\\mathrm{tube}}}\\frac{\\operatorname{Vol}(N_\\varepsilon(\\partial\\mathcal X_{\\mathrm{valid}}))}{\\varepsilon}<\\infty.\n639: \n640: $$\n641: \n642: By monotonicity it suffices to treat $L_{\\mathrm{flow}}\\Delta\\le\\varepsilon_{\\mathrm{tube}}$; otherwise the Hölder bound follows immediately.\n643: \n644: 2. **Affine Gaussian contribution (no capping).** Introduce the uncapped velocity update\n645: \n646: $$\n647: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n648: \n649: $$\n650: \n651: Then $\\tilde x:=x+\\tau\\tilde v+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ is Gaussian with mean $x+\\tau m(x,v)$, where $m(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))$, and covariance $\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)I_d$. Its density is\n652: \n653: $$\n654: p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}\\exp\\Big(-\\frac{\\|y-(x+\\tau m(x,v))\\|^2}{2\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)}\\Big).\n655: \n656: $$\n657: \n658: The density attains its supremum at the mean, yielding\n659: \n660: $$\n661: p_{\\mathrm{aff}}:=\\sup_{y\\in\\mathbb R^d}p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}.\n662: \n663: $$\n664: \n665: This constant governs the contribution of $C^c:=\\{\\|\\tilde v\\|\\le V_{\\mathrm{alg}}\\}$, where the velocity cap is inactive.\n666: \n667: 3. **Directional density under capping.** Let $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Lemma {prf:ref}`lem-euclidean-geometric-consistency` gives $\\mathbb P(E)\\le\\rho_*(C)$. On $E$ write $\\tilde v=ru$ with $r>V_{\\mathrm{alg}}$ and $u\\in S^{d-1}$. The capped velocity is $v^+=V_{\\mathrm{alg}}u$, whose conditional density equals\n668: \n669: $$\n670: g(u)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\int_{V_{\\mathrm{alg}}}^{\\infty}\\exp\\Big(-\\frac{\\|ru-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big) r^{d-1}\\,dr.\n671: \n672: $$\n673: \n674: The local bounds on $F$ and $u$ over $C$ imply\n675: \n676: $$\n677: \\|m(x,v)\\|\\le M_{\\mathrm{kin}}(C).\n678: \n679: $$\n680: \n681: For $r\\ge V_{\\mathrm{alg}}$ the inequality $\\|a-b\\|^2\\ge\\tfrac{1}{2}\\|a\\|^2-\\|b\\|^2$ yields\n682: \n683: $$\n684: \\|ru-m(x,v)\\|^2\\ge\\frac{r^2}{2}-M_{\\mathrm{kin}}(C)^2.\n685: \n686: $$\n687: \n688: Substituting into $g(u)$ and changing variables via $s=r^2/(4\\sigma_v^2\\tau)$ produces\n689: \n690: $$\n691: g(u)\\le\\frac{\\exp(M_{\\mathrm{kin}}(C)^2/(2\\sigma_v^2\\tau))}{(2\\pi\\sigma_v^2\\tau)^{d/2}}(2\\sigma_v^2\\tau)^{d/2}\\Gamma\\Big(\\frac{d}{2},\\frac{V_{\\mathrm{alg}}^2}{4\\sigma_v^2\\tau}\\Big)=:q_{\\mathrm{dir}}(C),\n692: \n693: $$\n694: \n695: where $\\Gamma(\\cdot,\\cdot)$ is the upper incomplete gamma function. Thus the capped direction has uniformly bounded density.\n696: \n697: 4. **Probability of hitting the tube.** For any Borel $A\\subseteq\\mathcal X$ split according to $E$:\n698: \n699: $$\n700: \\begin{aligned}\n701: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\big)&=\\mathbb P(E^c)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E^c\\big)+\\mathbb P(E)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E\\big)\\\\\n702: &\\le p_{\\mathrm{aff}}\\operatorname{Vol}(A)+\\rho_*(C) q_{\\mathrm{dir}}(C)\\operatorname{Vol}(A).\n703: \\end{aligned}\n704: \n705: $$\n706: \n707: Taking $A=N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})$ and using Step 1 yields\n708: \n709: $$\n710: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)\\le\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n711: \n712: $$\n713: \n714: Combining the two probabilities shows\n715: \n716: $$\n717: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n718: \n719: $$\n720: \n721: Therefore $\\alpha_B^{\\mathrm{Sasaki}}=1$ with Hölder constant\n722: \n723: $$\n724: L_{\\mathrm{death}}^{\\mathrm{Sasaki}}(C):=2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}.\n725: \n726: $$\n727: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-reward-regularity",
      "title": "Reward regularity in the Sasaki metric",
      "start_line": 734,
      "end_line": 759,
      "header_lines": [
        735
      ],
      "content_start": 737,
      "content_end": 758,
      "content": "737: :label: lem-euclidean-reward-regularity\n738: \n739: The reward function $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ is continuous on $(\\mathcal Y,d_{\\mathcal Y}^{\\mathrm{Sasaki}})$ and therefore satisfies the Axiom of Reward Regularity ({prf:ref}`def-axiom-reward-regularity`).\n740: \n741: ```{dropdown} Proof\n742: :::{prf:proof}\n743: Let $\\mathcal Y^{\\circ}:=B(0,R_x)\\times B(0,V_{\\mathrm{alg}})$ be the image of the projection $\\varphi:\\mathbb R^d\\times\\mathbb R^d\\to\\mathcal Y^{\\circ}$. For $y=(y_x,y_v)\\in\\mathcal Y^{\\circ}$ the inverse mapping is explicit:\n744: \n745: $$\n746: \\psi_C^{-1}(y)=\\frac{C}{1-\\|y\\|/C}\\,y\\qquad(\\|y\\|<C).\n747: \n748: $$\n749: \n750: Define $R_{\\mathcal Y}:\\mathcal Y^{\\circ}\\to\\mathbb R$ by\n751: \n752: $$\n753: R_{\\mathcal Y}(y):=R_{\\mathrm{pos}}\\big(\\psi_{R_x}^{-1}(y_x)\\big)-\\lambda_{\\mathrm{vel}}\\,\\big\\|\\psi_{V_{\\mathrm{alg}}}^{-1}(y_v)\\big\\|^2.\n754: \n755: $$\n756: \n757: This is well defined because the squashing maps are bijections between $\\mathbb R^d$ and the open balls $B(0,R_x)$ and $B(0,V_{\\mathrm{alg}})$. The maps $\\psi_{R_x}^{-1}$ and $\\psi_{V_{\\mathrm{alg}}}^{-1}$ are continuous on $\\mathcal Y^{\\circ}$, and the compositions with $R_{\\mathrm{pos}}$ and the quadratic velocity term are continuous. Hence $R_{\\mathcal Y}$ is continuous on $\\mathcal Y^{\\circ}$.\n758: ",
      "metadata": {
        "label": "lem-euclidean-reward-regularity"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-axiom-reward-regularity"
      ],
      "raw_directive": "734: The ambient space $(\\mathcal X,d_{\\mathcal X})$ remains Euclidean with Lebesgue reference measure, so the canonical density and integration arguments carry over ({prf:ref}`def-ambient-euclidean`). Because $\\mathcal X_{\\mathrm{valid}}$ is compact and $F=\\nabla R_{\\mathrm{pos}}$ is Lipschitz on this set, both $F$ and the auxiliary flow field $u$ are uniformly bounded; these bounds are the only ingredients required by the kinetic and boundary estimates recorded below.\n735: \n736: :::{prf:lemma} Reward regularity in the Sasaki metric\n737: :label: lem-euclidean-reward-regularity\n738: \n739: The reward function $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ is continuous on $(\\mathcal Y,d_{\\mathcal Y}^{\\mathrm{Sasaki}})$ and therefore satisfies the Axiom of Reward Regularity ({prf:ref}`def-axiom-reward-regularity`).\n740: \n741: ```{dropdown} Proof\n742: :::{prf:proof}\n743: Let $\\mathcal Y^{\\circ}:=B(0,R_x)\\times B(0,V_{\\mathrm{alg}})$ be the image of the projection $\\varphi:\\mathbb R^d\\times\\mathbb R^d\\to\\mathcal Y^{\\circ}$. For $y=(y_x,y_v)\\in\\mathcal Y^{\\circ}$ the inverse mapping is explicit:\n744: \n745: $$\n746: \\psi_C^{-1}(y)=\\frac{C}{1-\\|y\\|/C}\\,y\\qquad(\\|y\\|<C).\n747: \n748: $$\n749: \n750: Define $R_{\\mathcal Y}:\\mathcal Y^{\\circ}\\to\\mathbb R$ by\n751: \n752: $$\n753: R_{\\mathcal Y}(y):=R_{\\mathrm{pos}}\\big(\\psi_{R_x}^{-1}(y_x)\\big)-\\lambda_{\\mathrm{vel}}\\,\\big\\|\\psi_{V_{\\mathrm{alg}}}^{-1}(y_v)\\big\\|^2.\n754: \n755: $$\n756: \n757: This is well defined because the squashing maps are bijections between $\\mathbb R^d$ and the open balls $B(0,R_x)$ and $B(0,V_{\\mathrm{alg}})$. The maps $\\psi_{R_x}^{-1}$ and $\\psi_{V_{\\mathrm{alg}}}^{-1}$ are continuous on $\\mathcal Y^{\\circ}$, and the compositions with $R_{\\mathrm{pos}}$ and the quadratic velocity term are continuous. Hence $R_{\\mathcal Y}$ is continuous on $\\mathcal Y^{\\circ}$.\n758: \n759: Because $R_{\\mathcal Y}$ is continuous on $\\mathcal Y^{\\circ}$ and $\\mathcal Y^{\\circ}$ is bounded, the restriction of $R_{\\mathcal Y}$ to any compact subset of $\\mathcal Y^{\\circ}$ is uniformly continuous. In particular, the walker positions belong to the compact valid domain $\\mathcal X_{\\mathrm{valid}}$, so the image $\\varphi(\\mathcal X_{\\mathrm{valid}}\\times\\mathcal V_{\\mathrm{alg}})$ is compact and $R_{\\mathcal Y}$ is uniformly continuous (indeed, Lipschitz) on that set. Consequently the reward evaluated along the Sasaki projection is uniformly continuous, satisfying the reward-regularity axiom without invoking a global Lipschitz bound for $R_{\\mathrm{pos}}$ on $\\mathbb R^d$. :::",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-richness",
      "title": "Environmental richness with a kinetic regularizer",
      "start_line": 761,
      "end_line": 788,
      "header_lines": [
        762
      ],
      "content_start": 764,
      "content_end": 787,
      "content": "764: :label: lem-euclidean-richness\n765: \n766: The reward $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ with $\\lambda_{\\mathrm{vel}}>0$ satisfies the Axiom of Environmental Richness ({prf:ref}`def-axiom-environmental-richness`).\n767: \n768: ```{dropdown} Proof\n769: :::{prf:proof}\n770: Fix $(x_0,v_0)\\in\\mathcal Y$ and radius $r>0$. Every Sasaki ball of radius $r$ contains the set of velocities with Euclidean norm at most $r/\\sqrt{\\lambda_v}$ around $v_0$. Let\n771: \n772: $$\n773: \\delta:=\\min\\Big\\{\\frac{r}{\\sqrt{\\lambda_v}},\\,\\frac{V_{\\mathrm{alg}}}{2}\\Big\\}>0.\n774: \n775: $$\n776: Consider the two velocities $v_1:=v_0$ and $v_2:=v_0+\\delta e$, where the direction $e$ is chosen as follows:\n777: \n778: 1. If $\\|v_0\\|\\le V_{\\mathrm{alg}}-\\delta$, take $e$ orthogonal to $v_0$. Then $\\|v_2\\|^2=\\|v_0\\|^2+\\delta^2\\le V_{\\mathrm{alg}}^2$, so $v_2\\in\\mathcal V_{\\mathrm{alg}}$ and $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x_0,v_0),(x_0,v_2))=\\sqrt{\\lambda_v}\\,\\delta\\le r$.\n779: 2. If $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta$, set $e:=-v_0/\\|v_0\\|$ (if $v_0=0$, pick any unit vector). The new velocity has norm $\\|v_0\\| - \\delta\\le V_{\\mathrm{alg}}$ and again lies within the Sasaki ball.\n780: \n781: In both cases the velocities stay in the ball, and the reward difference equals\n782: \n783: $$\n784: |R(x_0,v_1)-R(x_0,v_2)|=\\lambda_{\\mathrm{vel}}\\,|\\|v_2\\|^2-\\|v_0\\|^2|\\ge \\lambda_{\\mathrm{vel}}\\,\\delta^2.\n785: \n786: $$\n787: For the inward-pointing choice we use that $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta\\ge V_{\\mathrm{alg}}/2\\ge\\delta$ because $\\delta\\le V_{\\mathrm{alg}}/2$, guaranteeing the same lower bound.",
      "metadata": {
        "label": "lem-euclidean-richness"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-axiom-environmental-richness"
      ],
      "raw_directive": "761: :::\n762: \n763: :::{prf:lemma} Environmental richness with a kinetic regularizer\n764: :label: lem-euclidean-richness\n765: \n766: The reward $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ with $\\lambda_{\\mathrm{vel}}>0$ satisfies the Axiom of Environmental Richness ({prf:ref}`def-axiom-environmental-richness`).\n767: \n768: ```{dropdown} Proof\n769: :::{prf:proof}\n770: Fix $(x_0,v_0)\\in\\mathcal Y$ and radius $r>0$. Every Sasaki ball of radius $r$ contains the set of velocities with Euclidean norm at most $r/\\sqrt{\\lambda_v}$ around $v_0$. Let\n771: \n772: $$\n773: \\delta:=\\min\\Big\\{\\frac{r}{\\sqrt{\\lambda_v}},\\,\\frac{V_{\\mathrm{alg}}}{2}\\Big\\}>0.\n774: \n775: $$\n776: Consider the two velocities $v_1:=v_0$ and $v_2:=v_0+\\delta e$, where the direction $e$ is chosen as follows:\n777: \n778: 1. If $\\|v_0\\|\\le V_{\\mathrm{alg}}-\\delta$, take $e$ orthogonal to $v_0$. Then $\\|v_2\\|^2=\\|v_0\\|^2+\\delta^2\\le V_{\\mathrm{alg}}^2$, so $v_2\\in\\mathcal V_{\\mathrm{alg}}$ and $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x_0,v_0),(x_0,v_2))=\\sqrt{\\lambda_v}\\,\\delta\\le r$.\n779: 2. If $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta$, set $e:=-v_0/\\|v_0\\|$ (if $v_0=0$, pick any unit vector). The new velocity has norm $\\|v_0\\| - \\delta\\le V_{\\mathrm{alg}}$ and again lies within the Sasaki ball.\n780: \n781: In both cases the velocities stay in the ball, and the reward difference equals\n782: \n783: $$\n784: |R(x_0,v_1)-R(x_0,v_2)|=\\lambda_{\\mathrm{vel}}\\,|\\|v_2\\|^2-\\|v_0\\|^2|\\ge \\lambda_{\\mathrm{vel}}\\,\\delta^2.\n785: \n786: $$\n787: For the inward-pointing choice we use that $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta\\ge V_{\\mathrm{alg}}/2\\ge\\delta$ because $\\delta\\le V_{\\mathrm{alg}}/2$, guaranteeing the same lower bound.\n788: Hence the variance of $R$ on the ball is at least $\\sigma_{\\mathrm{rich}}^2(r):=\\lambda_{\\mathrm{vel}}^2\\delta^4/4>0$, establishing environmental richness. :::",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-perturb-moment",
      "title": "Perturbation second moment in the Sasaki metric",
      "start_line": 801,
      "end_line": 889,
      "header_lines": [
        802
      ],
      "content_start": 804,
      "content_end": 888,
      "content": "804: :label: lem-euclidean-perturb-moment\n805: \n806: ```{dropdown} Proof\n807: :::{prf:proof}\n808: Introduce the uncapped velocity update\n809: \n810: $$\n811: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad \\xi_v\\sim\\mathcal N(0,I_d).\n812: \n813: $$\n814: \n815: Write $a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)$. {ref}`Stage 4 <sec-eg-stage4>` applies the cap and Euler step to obtain\n816: \n817: $$\n818: v^+:=\\psi_v(\\tilde v),\\qquad x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x,\n819: \n820: $$\n821: \n822: with $\\xi_x\\sim\\mathcal N(0,I_d)$ independent of $\\xi_v$.\n823: \n824: We bound the expected Sasaki increment in three explicit steps.\n825: \n826: 1. **Positional increment.** The cap guarantees $\\|v^+\\|\\le V_{\\mathrm{alg}}$. Hence\n827: \n828: $$\n829: \\|x^+-x\\|\\le\\tau\\,\\|v^+\\|+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|\\le\\tau V_{\\mathrm{alg}}+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|,\n830: \n831: $$\n832: \n833: so $\\mathbb E\\big[\\|x^+-x\\|^2\\big]\\le 2\\tau^2 V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d$.\n834: \n835: 2. **Velocity increment.** Lemma {prf:ref}`lem-squashing-properties-generic` gives $\\|v^+-v\\|\\le\\|\\tilde v-v\\|$. The random increment decomposes as\n836: \n837: $$\n838: \\tilde v-v=a(x,v)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n839: \n840: $$\n841: \n842: Let $F_0:=\\|F(0)\\|$ and $u_0:=\\|u(0)\\|$. The Lipschitz bounds $\\|F(x)\\|\\le F_0+L_F\\|x\\|$ and $\\|u(x)\\|\\le u_0+L_u\\|x\\|$ imply\n843: \n844: $$\n845: \\|a(x,v)\\|\\le\\frac{\\tau}{m}\\big(F_0+L_F\\|x\\|\\big)+\\gamma_{\\mathrm{fric}}\\tau\\Big(\\|v\\|+u_0+L_u\\|x\\|\\Big).\n846: \n847: $$\n848: \n849: Define the coefficients\n850: \n851: $$\n852: A_x:=\\tau\\Big(\\frac{L_F}{m}+\\gamma_{\\mathrm{fric}}L_u\\Big),\\qquad A_v:=\\gamma_{\\mathrm{fric}}\\tau,\\qquad A_0:=\\frac{\\tau}{m}F_0+\\gamma_{\\mathrm{fric}}\\tau u_0.\n853: \n854: $$\n855: \n856: Then $\\|a(x,v)\\|\\le A_x\\|x\\|+A_v\\|v\\|+A_0$. Using $\\mathbb E\\|\\xi_v\\|^2=d$ and $(\\alpha+\\beta+\\gamma)^2\\le 3(\\alpha^2+\\beta^2+\\gamma^2)$ gives\n857: \n858: $$\n859: \\mathbb E\\big[\\|\\tilde v-v\\|^2\\big]\\le 3A_x^2\\|x\\|^2+3A_v^2\\|v\\|^2+3A_0^2+\\sigma_v^2\\tau d.\n860: \n861: $$\n862: \n863: 3. **Assemble the Sasaki moment.** By definition of the Sasaki metric,\n864: \n865: $$\n866: d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2=\\|x^+-x\\|^2+\\lambda_v\\,\\|v^+-v\\|^2.\n867: \n868: $$\n869: \n870: Taking expectations and combining the bounds from Steps 1–2 yields\n871: \n872: $$\n873: \\mathbb E\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2\\big]\\le C_x^{(\\mathrm{pert})}\\,\\|x\\|^2+C_v^{(\\mathrm{pert})}\\,\\|v\\|^2+C_0^{(\\mathrm{pert})},\n874: \n875: $$\n876: \n877: with\n878: \n879: $$\n880: \\begin{aligned}\n881: C_x^{(\\mathrm{pert})}&:=3\\lambda_vA_x^2,\\\\\n882: C_v^{(\\mathrm{pert})}&:=3\\lambda_vA_v^2,\\\\\n883: C_0^{(\\mathrm{pert})}&:=2\\tau^2V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d+3\\lambda_vA_0^2+\\lambda_v\\sigma_v^2\\tau d.\n884: \\end{aligned}\n885: \n886: $$\n887: \n888: The kinetic kernel is Feller: it composes the continuous affine map $(x,v)\\mapsto(x,\\tilde v)$, the 1-Lipschitz projection $\\psi_v$, and addition of a Gaussian with full support; appending the deterministic status update preserves this property.",
      "metadata": {
        "label": "lem-euclidean-perturb-moment"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "sec-eg-stage4",
        "lem-squashing-properties-generic"
      ],
      "raw_directive": "801: :::\n802: \n803: :::{prf:lemma} Perturbation second moment in the Sasaki metric\n804: :label: lem-euclidean-perturb-moment\n805: \n806: ```{dropdown} Proof\n807: :::{prf:proof}\n808: Introduce the uncapped velocity update\n809: \n810: $$\n811: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad \\xi_v\\sim\\mathcal N(0,I_d).\n812: \n813: $$\n814: \n815: Write $a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)$. {ref}`Stage 4 <sec-eg-stage4>` applies the cap and Euler step to obtain\n816: \n817: $$\n818: v^+:=\\psi_v(\\tilde v),\\qquad x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x,\n819: \n820: $$\n821: \n822: with $\\xi_x\\sim\\mathcal N(0,I_d)$ independent of $\\xi_v$.\n823: \n824: We bound the expected Sasaki increment in three explicit steps.\n825: \n826: 1. **Positional increment.** The cap guarantees $\\|v^+\\|\\le V_{\\mathrm{alg}}$. Hence\n827: \n828: $$\n829: \\|x^+-x\\|\\le\\tau\\,\\|v^+\\|+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|\\le\\tau V_{\\mathrm{alg}}+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|,\n830: \n831: $$\n832: \n833: so $\\mathbb E\\big[\\|x^+-x\\|^2\\big]\\le 2\\tau^2 V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d$.\n834: \n835: 2. **Velocity increment.** Lemma {prf:ref}`lem-squashing-properties-generic` gives $\\|v^+-v\\|\\le\\|\\tilde v-v\\|$. The random increment decomposes as\n836: \n837: $$\n838: \\tilde v-v=a(x,v)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n839: \n840: $$\n841: \n842: Let $F_0:=\\|F(0)\\|$ and $u_0:=\\|u(0)\\|$. The Lipschitz bounds $\\|F(x)\\|\\le F_0+L_F\\|x\\|$ and $\\|u(x)\\|\\le u_0+L_u\\|x\\|$ imply\n843: \n844: $$\n845: \\|a(x,v)\\|\\le\\frac{\\tau}{m}\\big(F_0+L_F\\|x\\|\\big)+\\gamma_{\\mathrm{fric}}\\tau\\Big(\\|v\\|+u_0+L_u\\|x\\|\\Big).\n846: \n847: $$\n848: \n849: Define the coefficients\n850: \n851: $$\n852: A_x:=\\tau\\Big(\\frac{L_F}{m}+\\gamma_{\\mathrm{fric}}L_u\\Big),\\qquad A_v:=\\gamma_{\\mathrm{fric}}\\tau,\\qquad A_0:=\\frac{\\tau}{m}F_0+\\gamma_{\\mathrm{fric}}\\tau u_0.\n853: \n854: $$\n855: \n856: Then $\\|a(x,v)\\|\\le A_x\\|x\\|+A_v\\|v\\|+A_0$. Using $\\mathbb E\\|\\xi_v\\|^2=d$ and $(\\alpha+\\beta+\\gamma)^2\\le 3(\\alpha^2+\\beta^2+\\gamma^2)$ gives\n857: \n858: $$\n859: \\mathbb E\\big[\\|\\tilde v-v\\|^2\\big]\\le 3A_x^2\\|x\\|^2+3A_v^2\\|v\\|^2+3A_0^2+\\sigma_v^2\\tau d.\n860: \n861: $$\n862: \n863: 3. **Assemble the Sasaki moment.** By definition of the Sasaki metric,\n864: \n865: $$\n866: d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2=\\|x^+-x\\|^2+\\lambda_v\\,\\|v^+-v\\|^2.\n867: \n868: $$\n869: \n870: Taking expectations and combining the bounds from Steps 1–2 yields\n871: \n872: $$\n873: \\mathbb E\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2\\big]\\le C_x^{(\\mathrm{pert})}\\,\\|x\\|^2+C_v^{(\\mathrm{pert})}\\,\\|v\\|^2+C_0^{(\\mathrm{pert})},\n874: \n875: $$\n876: \n877: with\n878: \n879: $$\n880: \\begin{aligned}\n881: C_x^{(\\mathrm{pert})}&:=3\\lambda_vA_x^2,\\\\\n882: C_v^{(\\mathrm{pert})}&:=3\\lambda_vA_v^2,\\\\\n883: C_0^{(\\mathrm{pert})}&:=2\\tau^2V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d+3\\lambda_vA_0^2+\\lambda_v\\sigma_v^2\\tau d.\n884: \\end{aligned}\n885: \n886: $$\n887: \n888: The kinetic kernel is Feller: it composes the continuous affine map $(x,v)\\mapsto(x,\\tilde v)$, the 1-Lipschitz projection $\\psi_v$, and addition of a Gaussian with full support; appending the deterministic status update preserves this property.\n889: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-geometric-consistency",
      "title": "Geometric consistency under the capped kinetic kernel",
      "start_line": 892,
      "end_line": 1025,
      "header_lines": [
        893
      ],
      "content_start": 895,
      "content_end": 1024,
      "content": "895: :label: lem-euclidean-geometric-consistency\n896: \n897: ```{dropdown} Proof\n898: :::{prf:proof}\n899: Because $\\mathcal X_{\\mathrm{valid}}$ is compact and $F$ and $u$ are continuous, the drift and anisotropy envelopes appearing in the Axiom of Geometric Consistency admit finite global bounds. To make the dependence on the geometry explicit we index the constants by an arbitrary compact subset $C \\subset \\mathcal X_{\\mathrm{valid}}`; in practice we take $C = \\mathcal X_{\\mathrm{valid}}` and obtain uniform constants on the entire valid domain.\n900: \n901: Let $C\\subset\\mathbb R^d$ be an arbitrary compact set and define the local envelopes\n902: \n903: $$\n904: F_C:=\\sup_{x\\in C}\\|F(x)\\|,\\qquad u_C:=\\sup_{x\\in C}\\|u(x)\\|,\n905: \n906: $$\n907: \n908: which are finite by continuity. Set\n909: \n910: $$\n911: C_{\\mathrm{force}}(C):=\\frac{F_C}{m}+\\gamma_{\\mathrm{fric}}\\big(V_{\\mathrm{alg}}+u_C\\big),\\qquad M_{\\mathrm{kin}}(C):=V_{\\mathrm{alg}}+\\frac{\\tau}{m}F_C+\\gamma_{\\mathrm{fric}}\\tau\\big(V_{\\mathrm{alg}}+u_C\\big).\n912: \n913: $$\n914: \n915: Let $\\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v$ with $\\xi_v\\sim\\mathcal N(0,I_d)$ and set $v^+:=\\psi_v(\\tilde v)$, $x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Denote\n916: \n917: $$\n918: a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big).\n919: \n920: $$\n921: \n922: We supply explicit constants for the drift and anisotropy parts of Definition {prf:ref}`def-axiom-geometric-consistency`.\n923: \n924: 1. **Drift of the mean displacement.** Because $\\|v\\|\\le V_{\\mathrm{alg}}$ we have\n925: \n926: $$\n927: \\|\\mathbb E[x^+-x]\\|=\\tau\\,\\|\\mathbb E[v^+]\\|\\le\\tau\\big(\\|\\mathbb E[v^+-v]\\|+V_{\\mathrm{alg}}\\big).\n928: \n929: $$\n930: \n931: The increment of the velocity splits as\n932: \n933: $$\n934: \\mathbb E[v^+-v]=\\mathbb E[\\tilde v-v]+\\mathbb E[\\psi_v(\\tilde v)-\\tilde v].\n935: \n936: $$\n937: \n938: The affine term obeys $\\|\\mathbb E[\\tilde v-v]\\|=\\|a(x,v)\\|\\le\\tau C_{\\mathrm{force}}(C)$. The projection error equals $(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+$ and is supported on the capping event $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Markov's inequality applied to\n939: \n940: $$\n941: \\mathbb E\\|\\tilde v\\|^2=\\|a(x,v)\\|^2+\\sigma_v^2\\tau\\,\\mathbb E\\|\\xi\\|^2\\le(\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d+V_{\\mathrm{alg}}^2\n942: \n943: $$\n944: \n945: then yields\n946: \n947: $$\n948: \\mathbb E[(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+]\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d-V_{\\mathrm{alg}}^2}{V_{\\mathrm{alg}}}=:\\varepsilon_{\\mathrm{cap}}^{\\max}(C).\n949: \n950: $$\n951: \n952: Thus $\\|\\mathbb E[v^+-v]\\|\\le\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)$ and\n953: \n954: $$\n955: \\|\\mathbb E[x^+-x]\\|\\le\\tau\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big).\n956: \n957: $$\n958: \n959: Combining the position and velocity components gives\n960: \n961: $$\n962: \\kappa_{\\mathrm{drift}}^{\\mathrm{Sasaki}}(C):=\\sqrt{\\tau^2\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big)^2+\\lambda_v\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)\\big)^2}.\n963: \n964: $$\n965: \n966: 2. **Probability of capping.** The same second-moment estimate implies\n967: \n968: $$\n969: \\rho_*(C):=\\mathbb P(E)\\le\\frac{\\mathbb E\\|\\tilde v\\|^2}{V_{\\mathrm{alg}}^2}\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d}{V_{\\mathrm{alg}}^2}.\n970: \n971: $$\n972: \n973: 3. **Lower bound on the uncapped density.** The mean of $\\tilde v$ satisfies\n974: \n975: $$\n976: \\|m(x,v)\\|=\\Big\\|v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))\\Big\\|\\le M_{\\mathrm{kin}}(C).\n977: \n978: $$\n979: \n980: The Gaussian density of $\\tilde v$ is\n981: \n982: $$\n983: p_{\\tilde v}(y)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{\\|y-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big).\n984: \n985: $$\n986: \n987: For $u\\in S^{d-1}$ and $0\\le r\\le V_{\\mathrm{alg}}/2$ the inequality $\\|a-b\\|^2\\le 2\\|a\\|^2+2\\|b\\|^2$ yields\n988: \n989: $$\n990: \\|ru-m(x,v)\\|^2\\le\\Big(\\frac{V_{\\mathrm{alg}}}{2}+M_{\\mathrm{kin}}(C)\\Big)^2.\n991: \n992: $$\n993: \n994: Hence $p_{\\tilde v}(ru)\\ge c_{d,0}$ where\n995: \n996: $$\n997: c_{d,0}(C):=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{(V_{\\mathrm{alg}}/2+M_{\\mathrm{kin}}(C))^2}{2\\sigma_v^2\\tau}\\Big)>0.\n998: \n999: $$\n1000: \n1001: Integrating over the radial segment $[0,V_{\\mathrm{alg}}/2]$ yields\n1002: \n1003: $$\n1004: P(\\tilde v\\in K(u))\\ge c_{d,0}(C)\\int_{0}^{V_{\\mathrm{alg}}/2} r^{d-1}\\,dr=:c_d(C)>0,\n1005: \n1006: $$\n1007: \n1008: where $K(u):=\\{ru:0\\le r\\le V_{\\mathrm{alg}}/2\\}$ and we used the polar-volume factor $r^{d-1}$. Thus every cone with opening direction $u$ receives probability at least $c_d(C)$.\n1009: \n1010: 4. **Pushforward through the cap.** On $E^c$ the cap is inactive and $v^+=\\tilde v$, so the lower bound from Step 3 applies. On $E$ the map $\\psi_v$ replaces the radial component by $V_{\\mathrm{alg}}$ while leaving the direction $u$ unchanged, whence the directional distribution of $v^+$ dominates $(1-\\rho_*(C))c_d(C)$ times the surface measure $\\sigma_{d-1}$ on $S^{d-1}$. Equivalently, for every measurable $A\\subseteq S^{d-1}$\n1011: \n1012: $$\n1013: P(v^+\\in A)\\ge(1-\\rho_*(C))c_d(C)\\,\\sigma_{d-1}(A).\n1014: \n1015: $$\n1016: \n1017: Taking reciprocals furnishes the anisotropy constant\n1018: \n1019: $$\n1020: \\kappa_{\\mathrm{anisotropy}}^{\\mathrm{Sasaki}}(C):=\\frac{1}{(1-\\rho_*(C))c_d(C)}.\n1021: \n1022: $$\n1023: \n1024: These constants realise the drift and anisotropy requirements of Definition {prf:ref}`def-axiom-geometric-consistency` on the compact set $C$. Since $C$ was arbitrary, the bounds hold uniformly on every compact subset of the state space, which suffices for the non-compact geometric-consistency axiom.",
      "metadata": {
        "label": "lem-euclidean-geometric-consistency"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-axiom-geometric-consistency"
      ],
      "raw_directive": "892: 2. **Geometric consistency constants.** Lemma {prf:ref}`lem-euclidean-geometric-consistency` bounds the drift and anisotropy parameters in the Sasaki geometry.\n893: \n894: :::{prf:lemma} Geometric consistency under the capped kinetic kernel\n895: :label: lem-euclidean-geometric-consistency\n896: \n897: ```{dropdown} Proof\n898: :::{prf:proof}\n899: Because $\\mathcal X_{\\mathrm{valid}}$ is compact and $F$ and $u$ are continuous, the drift and anisotropy envelopes appearing in the Axiom of Geometric Consistency admit finite global bounds. To make the dependence on the geometry explicit we index the constants by an arbitrary compact subset $C \\subset \\mathcal X_{\\mathrm{valid}}`; in practice we take $C = \\mathcal X_{\\mathrm{valid}}` and obtain uniform constants on the entire valid domain.\n900: \n901: Let $C\\subset\\mathbb R^d$ be an arbitrary compact set and define the local envelopes\n902: \n903: $$\n904: F_C:=\\sup_{x\\in C}\\|F(x)\\|,\\qquad u_C:=\\sup_{x\\in C}\\|u(x)\\|,\n905: \n906: $$\n907: \n908: which are finite by continuity. Set\n909: \n910: $$\n911: C_{\\mathrm{force}}(C):=\\frac{F_C}{m}+\\gamma_{\\mathrm{fric}}\\big(V_{\\mathrm{alg}}+u_C\\big),\\qquad M_{\\mathrm{kin}}(C):=V_{\\mathrm{alg}}+\\frac{\\tau}{m}F_C+\\gamma_{\\mathrm{fric}}\\tau\\big(V_{\\mathrm{alg}}+u_C\\big).\n912: \n913: $$\n914: \n915: Let $\\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v$ with $\\xi_v\\sim\\mathcal N(0,I_d)$ and set $v^+:=\\psi_v(\\tilde v)$, $x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Denote\n916: \n917: $$\n918: a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big).\n919: \n920: $$\n921: \n922: We supply explicit constants for the drift and anisotropy parts of Definition {prf:ref}`def-axiom-geometric-consistency`.\n923: \n924: 1. **Drift of the mean displacement.** Because $\\|v\\|\\le V_{\\mathrm{alg}}$ we have\n925: \n926: $$\n927: \\|\\mathbb E[x^+-x]\\|=\\tau\\,\\|\\mathbb E[v^+]\\|\\le\\tau\\big(\\|\\mathbb E[v^+-v]\\|+V_{\\mathrm{alg}}\\big).\n928: \n929: $$\n930: \n931: The increment of the velocity splits as\n932: \n933: $$\n934: \\mathbb E[v^+-v]=\\mathbb E[\\tilde v-v]+\\mathbb E[\\psi_v(\\tilde v)-\\tilde v].\n935: \n936: $$\n937: \n938: The affine term obeys $\\|\\mathbb E[\\tilde v-v]\\|=\\|a(x,v)\\|\\le\\tau C_{\\mathrm{force}}(C)$. The projection error equals $(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+$ and is supported on the capping event $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Markov's inequality applied to\n939: \n940: $$\n941: \\mathbb E\\|\\tilde v\\|^2=\\|a(x,v)\\|^2+\\sigma_v^2\\tau\\,\\mathbb E\\|\\xi\\|^2\\le(\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d+V_{\\mathrm{alg}}^2\n942: \n943: $$\n944: \n945: then yields\n946: \n947: $$\n948: \\mathbb E[(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+]\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d-V_{\\mathrm{alg}}^2}{V_{\\mathrm{alg}}}=:\\varepsilon_{\\mathrm{cap}}^{\\max}(C).\n949: \n950: $$\n951: \n952: Thus $\\|\\mathbb E[v^+-v]\\|\\le\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)$ and\n953: \n954: $$\n955: \\|\\mathbb E[x^+-x]\\|\\le\\tau\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big).\n956: \n957: $$\n958: \n959: Combining the position and velocity components gives\n960: \n961: $$\n962: \\kappa_{\\mathrm{drift}}^{\\mathrm{Sasaki}}(C):=\\sqrt{\\tau^2\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big)^2+\\lambda_v\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)\\big)^2}.\n963: \n964: $$\n965: \n966: 2. **Probability of capping.** The same second-moment estimate implies\n967: \n968: $$\n969: \\rho_*(C):=\\mathbb P(E)\\le\\frac{\\mathbb E\\|\\tilde v\\|^2}{V_{\\mathrm{alg}}^2}\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d}{V_{\\mathrm{alg}}^2}.\n970: \n971: $$\n972: \n973: 3. **Lower bound on the uncapped density.** The mean of $\\tilde v$ satisfies\n974: \n975: $$\n976: \\|m(x,v)\\|=\\Big\\|v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))\\Big\\|\\le M_{\\mathrm{kin}}(C).\n977: \n978: $$\n979: \n980: The Gaussian density of $\\tilde v$ is\n981: \n982: $$\n983: p_{\\tilde v}(y)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{\\|y-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big).\n984: \n985: $$\n986: \n987: For $u\\in S^{d-1}$ and $0\\le r\\le V_{\\mathrm{alg}}/2$ the inequality $\\|a-b\\|^2\\le 2\\|a\\|^2+2\\|b\\|^2$ yields\n988: \n989: $$\n990: \\|ru-m(x,v)\\|^2\\le\\Big(\\frac{V_{\\mathrm{alg}}}{2}+M_{\\mathrm{kin}}(C)\\Big)^2.\n991: \n992: $$\n993: \n994: Hence $p_{\\tilde v}(ru)\\ge c_{d,0}$ where\n995: \n996: $$\n997: c_{d,0}(C):=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{(V_{\\mathrm{alg}}/2+M_{\\mathrm{kin}}(C))^2}{2\\sigma_v^2\\tau}\\Big)>0.\n998: \n999: $$\n1000: \n1001: Integrating over the radial segment $[0,V_{\\mathrm{alg}}/2]$ yields\n1002: \n1003: $$\n1004: P(\\tilde v\\in K(u))\\ge c_{d,0}(C)\\int_{0}^{V_{\\mathrm{alg}}/2} r^{d-1}\\,dr=:c_d(C)>0,\n1005: \n1006: $$\n1007: \n1008: where $K(u):=\\{ru:0\\le r\\le V_{\\mathrm{alg}}/2\\}$ and we used the polar-volume factor $r^{d-1}$. Thus every cone with opening direction $u$ receives probability at least $c_d(C)$.\n1009: \n1010: 4. **Pushforward through the cap.** On $E^c$ the cap is inactive and $v^+=\\tilde v$, so the lower bound from Step 3 applies. On $E$ the map $\\psi_v$ replaces the radial component by $V_{\\mathrm{alg}}$ while leaving the direction $u$ unchanged, whence the directional distribution of $v^+$ dominates $(1-\\rho_*(C))c_d(C)$ times the surface measure $\\sigma_{d-1}$ on $S^{d-1}$. Equivalently, for every measurable $A\\subseteq S^{d-1}$\n1011: \n1012: $$\n1013: P(v^+\\in A)\\ge(1-\\rho_*(C))c_d(C)\\,\\sigma_{d-1}(A).\n1014: \n1015: $$\n1016: \n1017: Taking reciprocals furnishes the anisotropy constant\n1018: \n1019: $$\n1020: \\kappa_{\\mathrm{anisotropy}}^{\\mathrm{Sasaki}}(C):=\\frac{1}{(1-\\rho_*(C))c_d(C)}.\n1021: \n1022: $$\n1023: \n1024: These constants realise the drift and anisotropy requirements of Definition {prf:ref}`def-axiom-geometric-consistency` on the compact set $C$. Since $C$ was arbitrary, the bounds hold uniformly on every compact subset of the state space, which suffices for the non-compact geometric-consistency axiom.\n1025: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-single-walker-positional-error",
      "title": "Single-walker positional error bound in the Sasaki metric",
      "start_line": 1056,
      "end_line": 1108,
      "header_lines": [
        1057
      ],
      "content_start": 1059,
      "content_end": 1107,
      "content": "1059: :label: lem-sasaki-single-walker-positional-error\n1060: \n1061: Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. For a given walker $i$ that is alive in swarm $\\mathcal S_1$ ($s_{1,i}=1$), let $\\mathbb C_i(\\mathcal S_1)$ be its companion selection measure.\n1062: \n1063: The absolute error in its expected distance due to the positional displacement of the walkers between the two states, evaluated over the fixed companion set from $\\mathcal S_1$, is bounded by the sum of its own displacement and the average displacement of its potential companions.\n1064: \n1065: $$\n1066: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1067: \n1068: $$\n1069: \n1070: ```{dropdown} Proof\n1071: :::{prf:proof}\n1072: Let $\\Delta_{\\mathrm{pos},i}$ denote the absolute error term we wish to bound. The proof proceeds by applying standard metric and probability inequalities.\n1073: \n1074: **Step 1: Apply Linearity of Expectation.**\n1075: We combine the two terms into a single expectation over the fixed companion selection measure $\\mathbb C_i(\\mathcal S_1)$.\n1076: \n1077: $$\n1078: \\Delta_{\\mathrm{pos},i} = \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right|\n1079: \n1080: $$\n1081: \n1082: **Step 2: Apply Jensen's Inequality.**\n1083: Using Jensen's inequality for the convex function $f(x)=|x|$, we can move the absolute value inside the expectation, which provides an upper bound:\n1084: \n1085: $$\n1086: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\right]\n1087: \n1088: $$\n1089: \n1090: **Step 3: Apply the Reverse Triangle Inequality.**\n1091: The term inside the expectation is the absolute difference between two distance values. For any points $a,b,c,d$ in a metric space $(M,d)$, the reverse triangle inequality states that $|d(a,b) - d(c,d)| \\le d(a,c) + d(b,d)$. Applying this to the Sasaki metric $d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ yields:\n1092: \n1093: $$\n1094: \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c}))\n1095: \n1096: $$\n1097: \n1098: **Step 4: Finalize the Bound.**\n1099: We substitute the inequality from Step 3 back into the expression from Step 2.\n1100: \n1101: $$\n1102: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1103: \n1104: $$\n1105: \n1106: By linearity of expectation, we can separate the terms. The first term, $d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i}))$, is a constant with respect to the expectation over the companion index $c$. This gives the final bound as stated in the lemma.\n1107: ",
      "metadata": {
        "label": "lem-sasaki-single-walker-positional-error"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [],
      "raw_directive": "1056: and let $D_{\\mathcal Y}:=\\operatorname{diam}_{d_{\\mathcal Y}^{\\mathrm{Sasaki}}}(\\mathcal Y)$.\n1057: \n1058: :::{prf:lemma} Single-walker positional error bound in the Sasaki metric\n1059: :label: lem-sasaki-single-walker-positional-error\n1060: \n1061: Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. For a given walker $i$ that is alive in swarm $\\mathcal S_1$ ($s_{1,i}=1$), let $\\mathbb C_i(\\mathcal S_1)$ be its companion selection measure.\n1062: \n1063: The absolute error in its expected distance due to the positional displacement of the walkers between the two states, evaluated over the fixed companion set from $\\mathcal S_1$, is bounded by the sum of its own displacement and the average displacement of its potential companions.\n1064: \n1065: $$\n1066: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1067: \n1068: $$\n1069: \n1070: ```{dropdown} Proof\n1071: :::{prf:proof}\n1072: Let $\\Delta_{\\mathrm{pos},i}$ denote the absolute error term we wish to bound. The proof proceeds by applying standard metric and probability inequalities.\n1073: \n1074: **Step 1: Apply Linearity of Expectation.**\n1075: We combine the two terms into a single expectation over the fixed companion selection measure $\\mathbb C_i(\\mathcal S_1)$.\n1076: \n1077: $$\n1078: \\Delta_{\\mathrm{pos},i} = \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right|\n1079: \n1080: $$\n1081: \n1082: **Step 2: Apply Jensen's Inequality.**\n1083: Using Jensen's inequality for the convex function $f(x)=|x|$, we can move the absolute value inside the expectation, which provides an upper bound:\n1084: \n1085: $$\n1086: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\right]\n1087: \n1088: $$\n1089: \n1090: **Step 3: Apply the Reverse Triangle Inequality.**\n1091: The term inside the expectation is the absolute difference between two distance values. For any points $a,b,c,d$ in a metric space $(M,d)$, the reverse triangle inequality states that $|d(a,b) - d(c,d)| \\le d(a,c) + d(b,d)$. Applying this to the Sasaki metric $d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ yields:\n1092: \n1093: $$\n1094: \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c}))\n1095: \n1096: $$\n1097: \n1098: **Step 4: Finalize the Bound.**\n1099: We substitute the inequality from Step 3 back into the expression from Step 2.\n1100: \n1101: $$\n1102: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1103: \n1104: $$\n1105: \n1106: By linearity of expectation, we can separate the terms. The first term, $d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i}))$, is a constant with respect to the expectation over the companion index $c$. This gives the final bound as stated in the lemma.\n1107: \n1108: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-single-walker-structural-error",
      "title": "Single-walker structural error bound in the Sasaki metric",
      "start_line": 1110,
      "end_line": 1146,
      "header_lines": [
        1111
      ],
      "content_start": 1113,
      "content_end": 1145,
      "content": "1113: :label: lem-sasaki-single-walker-structural-error\n1114: \n1115: Let $i\\in\\mathcal A_{\\mathrm{stable}}$ and keep the second swarm’s capped positions fixed. Let the initial swarm have at least two alive walkers, $k_1=|\\mathcal A(\\mathcal S_1)| \\ge 2$. The absolute error in the expected distance for walker $i$ due to the change in the companion selection measure is bounded by:\n1116: \n1117: $$\n1118: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_2)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le \\frac{2 D_{\\mathcal Y}}{k_1-1} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1119: \n1120: $$\n1121: \n1122: where $D_{\\mathcal Y}$ is the diameter of the algorithmic space.\n1123: \n1124: ```{dropdown} Proof\n1125: :::{prf:proof}\n1126: This result is a direct application of the framework's **Total Error Bound in Terms of Status Changes** ({prf:ref}`thm-total-error-status-bound`) to the specific function of interest in the Sasaki geometry.\n1127: \n1128: **Step 1: Identify the Function and its Bound.**\n1129: Let the function being evaluated under the expectation be $f(c) := d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c}))$. This function measures the Sasaki distance from the fixed walker $i$ to a potential companion $c$, using the positions from the second swarm. By definition, any distance in the algorithmic space is bounded by the space's diameter, $D_{\\mathcal Y}$. Therefore, we have a uniform bound on the function's value: $|f(c)| \\le D_{\\mathcal Y} =: M_f$.\n1130: \n1131: **Step 2: Identify the Companion Support Sets.**\n1132: Let $S_1 = S_i(\\mathcal{S}_1)$ and $S_2 = S_i(\\mathcal{S}_2)$ be the companion support sets for walker $i$ in the two swarms. Since walker $i$ is alive in $\\mathcal S_1$ (i.e., $i \\in \\mathcal A_{\\mathrm{stable}} \\subseteq \\mathcal A_1$) and the precondition states $k_1 \\ge 2$, the initial support set is $S_1 = \\mathcal A_1 \\setminus \\{i\\}$. Its size is therefore $|S_1| = k_1 - 1 > 0$.\n1133: \n1134: **Step 3: Apply the General Error Bound.**\n1135: The framework theorem {prf:ref}`thm-total-error-status-bound` provides a general bound for the change in expectation of a bounded function due to a change in the underlying support set:\n1136: \n1137: $$\n1138: \\text{Error} \\le \\frac{2 M_f}{|S_1|} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1139: \n1140: $$\n1141: This bound is purely algebraic and holds for any choice of metric or bounded function.\n1142: \n1143: **Step 4: Substitute and Finalize.**\n1144: We substitute our specific function bound $M_f = D_{\\mathcal Y}$ and the support set size $|S_1| = k_1 - 1$ into the general formula. This immediately yields the stated bound for the structural error component.\n1145: ",
      "metadata": {
        "label": "lem-sasaki-single-walker-structural-error"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "thm-total-error-status-bound"
      ],
      "raw_directive": "1110: :::\n1111: \n1112: :::{prf:lemma} Single-walker structural error bound in the Sasaki metric\n1113: :label: lem-sasaki-single-walker-structural-error\n1114: \n1115: Let $i\\in\\mathcal A_{\\mathrm{stable}}$ and keep the second swarm’s capped positions fixed. Let the initial swarm have at least two alive walkers, $k_1=|\\mathcal A(\\mathcal S_1)| \\ge 2$. The absolute error in the expected distance for walker $i$ due to the change in the companion selection measure is bounded by:\n1116: \n1117: $$\n1118: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_2)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le \\frac{2 D_{\\mathcal Y}}{k_1-1} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1119: \n1120: $$\n1121: \n1122: where $D_{\\mathcal Y}$ is the diameter of the algorithmic space.\n1123: \n1124: ```{dropdown} Proof\n1125: :::{prf:proof}\n1126: This result is a direct application of the framework's **Total Error Bound in Terms of Status Changes** ({prf:ref}`thm-total-error-status-bound`) to the specific function of interest in the Sasaki geometry.\n1127: \n1128: **Step 1: Identify the Function and its Bound.**\n1129: Let the function being evaluated under the expectation be $f(c) := d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c}))$. This function measures the Sasaki distance from the fixed walker $i$ to a potential companion $c$, using the positions from the second swarm. By definition, any distance in the algorithmic space is bounded by the space's diameter, $D_{\\mathcal Y}$. Therefore, we have a uniform bound on the function's value: $|f(c)| \\le D_{\\mathcal Y} =: M_f$.\n1130: \n1131: **Step 2: Identify the Companion Support Sets.**\n1132: Let $S_1 = S_i(\\mathcal{S}_1)$ and $S_2 = S_i(\\mathcal{S}_2)$ be the companion support sets for walker $i$ in the two swarms. Since walker $i$ is alive in $\\mathcal S_1$ (i.e., $i \\in \\mathcal A_{\\mathrm{stable}} \\subseteq \\mathcal A_1$) and the precondition states $k_1 \\ge 2$, the initial support set is $S_1 = \\mathcal A_1 \\setminus \\{i\\}$. Its size is therefore $|S_1| = k_1 - 1 > 0$.\n1133: \n1134: **Step 3: Apply the General Error Bound.**\n1135: The framework theorem {prf:ref}`thm-total-error-status-bound` provides a general bound for the change in expectation of a bounded function due to a change in the underlying support set:\n1136: \n1137: $$\n1138: \\text{Error} \\le \\frac{2 M_f}{|S_1|} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1139: \n1140: $$\n1141: This bound is purely algebraic and holds for any choice of metric or bounded function.\n1142: \n1143: **Step 4: Substitute and Finalize.**\n1144: We substitute our specific function bound $M_f = D_{\\mathcal Y}$ and the support set size $|S_1| = k_1 - 1$ into the general formula. This immediately yields the stated bound for the structural error component.\n1145: \n1146: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-total-squared-error-stable",
      "title": "Mean-square error on stable walkers (Sasaki)",
      "start_line": 1150,
      "end_line": 1184,
      "header_lines": [
        1151
      ],
      "content_start": 1153,
      "content_end": 1183,
      "content": "1153: :label: lem-sasaki-total-squared-error-stable\n1154: \n1155: Let $\\mathcal S_1,\\mathcal S_2$ be swarms with alive sets $\\mathcal A_r$ and let $\\mathbf d^{(r)}$ denote the expected raw distance vector produced by the measurement operator on $\\mathcal S_r$. Write $\\mathcal A_{\\mathrm{stable}}:=\\mathcal A_1\\cap\\mathcal A_2$ and $k_{\\mathrm{stable}}:=|\\mathcal A_{\\mathrm{stable}}|$. Then\n1156: \n1157: $$\n1158: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\big|d^{(1)}_i-d^{(2)}_i\\big|^2\\le C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}})\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1159: \n1160: $$\n1161: \n1162: where $C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}}):=2\\Big(1+\\frac{k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\Big)$.\n1163: \n1164: ```{dropdown} Proof\n1165: :::{prf:proof}\n1166: For $i\\in\\mathcal A_{\\mathrm{stable}}$ set $\\Delta_i:=|d^{(1)}_i-d^{(2)}_i|$. Lemma {prf:ref}`lem-sasaki-single-walker-positional-error` gives\n1167: \n1168: $$\n1169: \\Delta_i\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i})) + \\mathbb E_{c\\sim\\mathbb C_i(\\mathcal S_1)}\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}),\\varphi(w_{2,c}))\\big].\n1170: \n1171: $$\n1172: \n1173: Apply $(a+b)^2\\le 2a^2+2b^2$ and Jensen's inequality to obtain\n1174: \n1175: $$\n1176: \\Delta_i^2\\le 2\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i}))^2 + \\frac{2}{k_1-1}\\sum_{j\\in\\mathcal A_1} d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,j}),\\varphi(w_{2,j}))^2,\n1177: \n1178: $$\n1179: where the averaging denominator $k_1-1$ is interpreted as $1$ when $k_1=1$. Summing over $i\\in\\mathcal A_{\\mathrm{stable}}$ yields\n1180: \n1181: $$\n1182: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\Delta_i^2\\le 2\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2)+\\frac{2k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1183: ",
      "metadata": {
        "label": "lem-sasaki-total-squared-error-stable"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-sasaki-single-walker-positional-error"
      ],
      "raw_directive": "1150: \n1151: \n1152: :::{prf:lemma} Mean-square error on stable walkers (Sasaki)\n1153: :label: lem-sasaki-total-squared-error-stable\n1154: \n1155: Let $\\mathcal S_1,\\mathcal S_2$ be swarms with alive sets $\\mathcal A_r$ and let $\\mathbf d^{(r)}$ denote the expected raw distance vector produced by the measurement operator on $\\mathcal S_r$. Write $\\mathcal A_{\\mathrm{stable}}:=\\mathcal A_1\\cap\\mathcal A_2$ and $k_{\\mathrm{stable}}:=|\\mathcal A_{\\mathrm{stable}}|$. Then\n1156: \n1157: $$\n1158: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\big|d^{(1)}_i-d^{(2)}_i\\big|^2\\le C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}})\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1159: \n1160: $$\n1161: \n1162: where $C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}}):=2\\Big(1+\\frac{k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\Big)$.\n1163: \n1164: ```{dropdown} Proof\n1165: :::{prf:proof}\n1166: For $i\\in\\mathcal A_{\\mathrm{stable}}$ set $\\Delta_i:=|d^{(1)}_i-d^{(2)}_i|$. Lemma {prf:ref}`lem-sasaki-single-walker-positional-error` gives\n1167: \n1168: $$\n1169: \\Delta_i\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i})) + \\mathbb E_{c\\sim\\mathbb C_i(\\mathcal S_1)}\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}),\\varphi(w_{2,c}))\\big].\n1170: \n1171: $$\n1172: \n1173: Apply $(a+b)^2\\le 2a^2+2b^2$ and Jensen's inequality to obtain\n1174: \n1175: $$\n1176: \\Delta_i^2\\le 2\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i}))^2 + \\frac{2}{k_1-1}\\sum_{j\\in\\mathcal A_1} d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,j}),\\varphi(w_{2,j}))^2,\n1177: \n1178: $$\n1179: where the averaging denominator $k_1-1$ is interpreted as $1$ when $k_1=1$. Summing over $i\\in\\mathcal A_{\\mathrm{stable}}$ yields\n1180: \n1181: $$\n1182: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\Delta_i^2\\le 2\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2)+\\frac{2k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1183: \n1184: $$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-aggregator-value",
      "title": "Value continuity of the empirical moments",
      "start_line": 1222,
      "end_line": 1237,
      "header_lines": [
        1223
      ],
      "content_start": 1225,
      "content_end": 1236,
      "content": "1225: :label: lem-sasaki-aggregator-value\n1226: \n1227: Fix a swarm $\\mathcal S$ with alive index set $\\mathcal A(\\mathcal S)$ of size $k\\ge 1$. Let $\\mathbf v_1,\\mathbf v_2\\in\\mathbb R^k$ be two scalar value vectors whose components satisfy $|v_{j,i}|\\le V_{\\max}$. Then the empirical mean and second moment obey\n1228: \n1229: $$\n1230: |\\mu(\\mathcal S,\\mathbf v_1)-\\mu(\\mathcal S,\\mathbf v_2)|\\le \\frac{1}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2,\\qquad|m_2(\\mathcal S,\\mathbf v_1)-m_2(\\mathcal S,\\mathbf v_2)|\\le \\frac{2V_{\\max}}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2.\n1231: \n1232: $$\n1233: \n1234: ```{dropdown} Proof\n1235: :::{prf:proof}\n1236: The identities follow from the gradient calculations $\\nabla\\mu=(1/k)\\mathbf 1$ and $\\nabla m_2=(2/k)\\mathbf v$ together with Cauchy–Schwarz, as in Lemma 6.2.2.a of the framework.",
      "metadata": {
        "label": "lem-sasaki-aggregator-value"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [],
      "raw_directive": "1222: Whenever aggregators act on reward vectors we use the uniform bound $V_{\\mathrm{max}}^{(R)}:=\\max\\{|R_{\\min}|,R_{\\max}\\}$; for distance vectors we use $V_{\\mathrm{max}}^{(d)}:=D_{\\mathcal Y}$. For swarms $\\mathcal S_r$ write $k_r:=|\\mathcal A(\\mathcal S_r)|$, define $k_{\\min}:=\\max\\{1,\\min(k_1,k_2)\\}$, and let $n_c:=\\sum_{i=1}^N(s_{1,i}-s_{2,i})^2$ count the status changes.\n1223: \n1224: :::{prf:lemma} Value continuity of the empirical moments\n1225: :label: lem-sasaki-aggregator-value\n1226: \n1227: Fix a swarm $\\mathcal S$ with alive index set $\\mathcal A(\\mathcal S)$ of size $k\\ge 1$. Let $\\mathbf v_1,\\mathbf v_2\\in\\mathbb R^k$ be two scalar value vectors whose components satisfy $|v_{j,i}|\\le V_{\\max}$. Then the empirical mean and second moment obey\n1228: \n1229: $$\n1230: |\\mu(\\mathcal S,\\mathbf v_1)-\\mu(\\mathcal S,\\mathbf v_2)|\\le \\frac{1}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2,\\qquad|m_2(\\mathcal S,\\mathbf v_1)-m_2(\\mathcal S,\\mathbf v_2)|\\le \\frac{2V_{\\max}}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2.\n1231: \n1232: $$\n1233: \n1234: ```{dropdown} Proof\n1235: :::{prf:proof}\n1236: The identities follow from the gradient calculations $\\nabla\\mu=(1/k)\\mathbf 1$ and $\\nabla m_2=(2/k)\\mathbf v$ together with Cauchy–Schwarz, as in Lemma 6.2.2.a of the framework.\n1237: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-aggregator-structural",
      "title": "Structural continuity of the empirical moments",
      "start_line": 1239,
      "end_line": 1254,
      "header_lines": [
        1240
      ],
      "content_start": 1242,
      "content_end": 1253,
      "content": "1242: :label: lem-sasaki-aggregator-structural\n1243: \n1244: Let $\\mathcal S_r=((x_{r,i},v_{r,i},s_{r,i}))_{i=1}^N$ with alive counts $k_r\\ge 1$ and let $\\mathbf v$ be a scalar vector on the union of alive indices satisfying $|v_i|\\le V_{\\max}$. Set $k_{\\min}:=\\max\\{1,\\min(k_1,k_2)\\}$ and $n_c:=\\sum_{i=1}^N(s_{1,i}-s_{2,i})^2$. Then\n1245: \n1246: $$\n1247: |\\mu(\\mathcal S_1,\\mathbf v)-\\mu(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}}{k_{\\min}}\\,n_c,\\qquad|m_2(\\mathcal S_1,\\mathbf v)-m_2(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}^2}{k_{\\min}}\\,n_c.\n1248: \n1249: $$\n1250: \n1251: ```{dropdown} Proof\n1252: :::{prf:proof}\n1253: The proof mirrors Lemma 6.2.2.b of the framework. Decompose the difference in means into contributions from walkers that remain alive in both swarms and those that change status. The former vanish, whereas the latter introduce at most $V_{\\max}$ per status flip. Accounting for the normalisation factors $1/k_r$ and the difference in alive counts yields the stated bounds. The argument for $m_2$ uses $|a^2-b^2|\\le 2V_{\\max}|a-b|$.",
      "metadata": {
        "label": "lem-sasaki-aggregator-structural"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [],
      "raw_directive": "1239: :::\n1240: \n1241: :::{prf:lemma} Structural continuity of the empirical moments\n1242: :label: lem-sasaki-aggregator-structural\n1243: \n1244: Let $\\mathcal S_r=((x_{r,i},v_{r,i},s_{r,i}))_{i=1}^N$ with alive counts $k_r\\ge 1$ and let $\\mathbf v$ be a scalar vector on the union of alive indices satisfying $|v_i|\\le V_{\\max}$. Set $k_{\\min}:=\\max\\{1,\\min(k_1,k_2)\\}$ and $n_c:=\\sum_{i=1}^N(s_{1,i}-s_{2,i})^2$. Then\n1245: \n1246: $$\n1247: |\\mu(\\mathcal S_1,\\mathbf v)-\\mu(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}}{k_{\\min}}\\,n_c,\\qquad|m_2(\\mathcal S_1,\\mathbf v)-m_2(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}^2}{k_{\\min}}\\,n_c.\n1248: \n1249: $$\n1250: \n1251: ```{dropdown} Proof\n1252: :::{prf:proof}\n1253: The proof mirrors Lemma 6.2.2.b of the framework. Decompose the difference in means into contributions from walkers that remain alive in both swarms and those that change status. The former vanish, whereas the latter introduce at most $V_{\\max}$ per status flip. Accounting for the normalisation factors $1/k_r$ and the difference in alive counts yields the stated bounds. The argument for $m_2$ uses $|a^2-b^2|\\le 2V_{\\max}|a-b|$.\n1254: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-aggregator-lipschitz",
      "title": "Lipschitz data for the Sasaki empirical aggregators",
      "start_line": 1256,
      "end_line": 1276,
      "header_lines": [
        1257
      ],
      "content_start": 1259,
      "content_end": 1275,
      "content": "1259: :label: lem-sasaki-aggregator-lipschitz\n1260: \n1261: For reward vectors take $V_{\\max}=V_{\\mathrm{max}}^{(R)}$; for distance vectors take $V_{\\max}=V_{\\mathrm{max}}^{(d)}$. The empirical mean and second moment satisfy the aggregator axioms with\n1262: \n1263: $$\n1264: L_{\\mu,M}^{\\mathrm{Sasaki}}(k)=\\frac{1}{\\sqrt{k}},\\qquad L_{m_2,M}^{\\mathrm{Sasaki}}(k)=\\frac{2V_{\\max}}{\\sqrt{k}},\n1265: \n1266: $$\n1267: \n1268: $$\n1269: L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}}{k_{\\min}},\\qquad L_{m_2,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}^2}{k_{\\min}},\n1270: \n1271: $$\n1272: and growth exponents $p_{\\mu,S}=p_{m_2,S}=p_{\\mathrm{worst\text{-}case}}=-1$. Consequently $\\kappa_{\\mathrm{var}}^{\\mathrm{Sasaki}}=\\kappa_{\\mathrm{range}}^{\\mathrm{Sasaki}}=1$ as in the canonical framework.\n1273: \n1274: ```{dropdown} Proof\n1275: :::{prf:proof}",
      "metadata": {
        "label": "lem-sasaki-aggregator-lipschitz"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-sasaki-aggregator-value",
        "lem-sasaki-aggregator-structural"
      ],
      "raw_directive": "1256: :::\n1257: \n1258: :::{prf:lemma} Lipschitz data for the Sasaki empirical aggregators\n1259: :label: lem-sasaki-aggregator-lipschitz\n1260: \n1261: For reward vectors take $V_{\\max}=V_{\\mathrm{max}}^{(R)}$; for distance vectors take $V_{\\max}=V_{\\mathrm{max}}^{(d)}$. The empirical mean and second moment satisfy the aggregator axioms with\n1262: \n1263: $$\n1264: L_{\\mu,M}^{\\mathrm{Sasaki}}(k)=\\frac{1}{\\sqrt{k}},\\qquad L_{m_2,M}^{\\mathrm{Sasaki}}(k)=\\frac{2V_{\\max}}{\\sqrt{k}},\n1265: \n1266: $$\n1267: \n1268: $$\n1269: L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}}{k_{\\min}},\\qquad L_{m_2,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}^2}{k_{\\min}},\n1270: \n1271: $$\n1272: and growth exponents $p_{\\mu,S}=p_{m_2,S}=p_{\\mathrm{worst\text{-}case}}=-1$. Consequently $\\kappa_{\\mathrm{var}}^{\\mathrm{Sasaki}}=\\kappa_{\\mathrm{range}}^{\\mathrm{Sasaki}}=1$ as in the canonical framework.\n1273: \n1274: ```{dropdown} Proof\n1275: :::{prf:proof}\n1276: Combine Lemmas {prf:ref}`lem-sasaki-aggregator-value` and {prf:ref}`lem-sasaki-aggregator-structural` with the dispersion metric identity $n_c\\le(N/\\sqrt{\\lambda_{\\mathrm{status}}})d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1,\\mathcal S_2)$ to obtain the stated Lipschitz functions and exponents.",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-value-error-decomposition",
      "title": "Decomposition of the Value Error",
      "start_line": 1349,
      "end_line": 1417,
      "header_lines": [
        1350
      ],
      "content_start": 1352,
      "content_end": 1416,
      "content": "1352: :label: lem-sasaki-value-error-decomposition\n1353: \n1354: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. Let $(\\mu_1, \\sigma'_1)$ and $(\\mu_2, \\sigma'_2)$ be the corresponding statistical properties, and let $\\mathbf z_1$ and $\\mathbf z_2$ be the corresponding standardized vectors.\n1355: \n1356: The total value error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of three components:\n1357: \n1358: $$\n1359: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1360: \n1361: $$\n1362: \n1363: where:\n1364: 1.  **The Direct Shift ($\\Delta_{\\text{direct}}$):** The error from the change in the raw value vector itself, scaled by the initial standard deviation.\n1365: \n1366:     $$\n1367:     \\Delta_{\\text{direct}} := \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1}\n1368:     $$\n1369: \n1370: 2.  **The Mean Shift ($\\Delta_{\\text{mean}}$):** The error from the change in the aggregator's computed mean, applied uniformly to all walkers.\n1371: \n1372:     $$\n1373:     \\Delta_{\\text{mean}} := \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1}\n1374:     $$\n1375:     where $\\mathbf{1}$ is a k-dimensional vector of ones.\n1376: \n1377: 3.  **The Denominator Shift ($\\Delta_{\\text{denom}}$):** The error from the change in the regularized standard deviation, which rescales the second standardized vector.\n1378: \n1379:     $$\n1380:     \\Delta_{\\text{denom}} := \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\n1381:     $$\n1382: \n1383: Furthermore, the total squared error is bounded by three times the sum of the squared norms of these components:\n1384: \n1385: $$\n1386: \\|\\Delta\\mathbf{z}\\|_2^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1387: \n1388: $$\n1389: \n1390: ```{dropdown} Proof\n1391: :::{prf:proof}\n1392: **Step 1: Algebraic Decomposition.**\n1393: The proof of the decomposition is a direct algebraic manipulation. We start with the definition of the error and add and subtract the intermediate term $(\\mathbf r_2 - \\mu_2) / \\sigma'_1$.\n1394: \n1395: $$\n1396: \\begin{aligned}\n1397: \\Delta\\mathbf{z} &= \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\\\\n1398: &= \\left( \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} \\right) + \\left( \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\right) \\\\\n1399: &= \\frac{(\\mathbf r_1 - \\mathbf r_2) - (\\mu_1 - \\mu_2)}{\\sigma'_1} + (\\mathbf r_2 - \\mu_2) \\left( \\frac{1}{\\sigma'_1} - \\frac{1}{\\sigma'_2} \\right) \\\\\n1400: &= \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} + \\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\mathbf{1} + \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\\\\n1401: &= \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1402: \\end{aligned}\n1403: \n1404: $$\n1405: The final line follows by recognizing the definitions of the three components.\n1406: \n1407: **Step 2: Bound on the Squared Norm.**\n1408: The bound on the total squared norm follows from the triangle inequality (`||A+B+C|| <= ||A|| + ||B|| + ||C||`) and the elementary inequality $(a+b+c)^2 \\le 3(a^2+b^2+c^2)$ for non-negative reals. For vectors, this becomes:\n1409: \n1410: $$\n1411: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\\|_2^2 \\le \\left( \\|\\Delta_{\\text{direct}}\\|_2 + \\|\\Delta_{\\text{mean}}\\|_2 + \\|\\Delta_{\\text{denom}}\\|_2 \\right)^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1412: \n1413: $$\n1414: \n1415: This completes the proof.\n1416: ",
      "metadata": {
        "label": "lem-sasaki-value-error-decomposition"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [],
      "raw_directive": "1349: ##### 2.3.4.1. Sub-Lemma: Algebraic Decomposition of the Value Error\n1350: \n1351: :::{prf:lemma} Decomposition of the Value Error\n1352: :label: lem-sasaki-value-error-decomposition\n1353: \n1354: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. Let $(\\mu_1, \\sigma'_1)$ and $(\\mu_2, \\sigma'_2)$ be the corresponding statistical properties, and let $\\mathbf z_1$ and $\\mathbf z_2$ be the corresponding standardized vectors.\n1355: \n1356: The total value error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of three components:\n1357: \n1358: $$\n1359: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1360: \n1361: $$\n1362: \n1363: where:\n1364: 1.  **The Direct Shift ($\\Delta_{\\text{direct}}$):** The error from the change in the raw value vector itself, scaled by the initial standard deviation.\n1365: \n1366:     $$\n1367:     \\Delta_{\\text{direct}} := \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1}\n1368:     $$\n1369: \n1370: 2.  **The Mean Shift ($\\Delta_{\\text{mean}}$):** The error from the change in the aggregator's computed mean, applied uniformly to all walkers.\n1371: \n1372:     $$\n1373:     \\Delta_{\\text{mean}} := \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1}\n1374:     $$\n1375:     where $\\mathbf{1}$ is a k-dimensional vector of ones.\n1376: \n1377: 3.  **The Denominator Shift ($\\Delta_{\\text{denom}}$):** The error from the change in the regularized standard deviation, which rescales the second standardized vector.\n1378: \n1379:     $$\n1380:     \\Delta_{\\text{denom}} := \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\n1381:     $$\n1382: \n1383: Furthermore, the total squared error is bounded by three times the sum of the squared norms of these components:\n1384: \n1385: $$\n1386: \\|\\Delta\\mathbf{z}\\|_2^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1387: \n1388: $$\n1389: \n1390: ```{dropdown} Proof\n1391: :::{prf:proof}\n1392: **Step 1: Algebraic Decomposition.**\n1393: The proof of the decomposition is a direct algebraic manipulation. We start with the definition of the error and add and subtract the intermediate term $(\\mathbf r_2 - \\mu_2) / \\sigma'_1$.\n1394: \n1395: $$\n1396: \\begin{aligned}\n1397: \\Delta\\mathbf{z} &= \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\\\\n1398: &= \\left( \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} \\right) + \\left( \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\right) \\\\\n1399: &= \\frac{(\\mathbf r_1 - \\mathbf r_2) - (\\mu_1 - \\mu_2)}{\\sigma'_1} + (\\mathbf r_2 - \\mu_2) \\left( \\frac{1}{\\sigma'_1} - \\frac{1}{\\sigma'_2} \\right) \\\\\n1400: &= \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} + \\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\mathbf{1} + \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\\\\n1401: &= \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1402: \\end{aligned}\n1403: \n1404: $$\n1405: The final line follows by recognizing the definitions of the three components.\n1406: \n1407: **Step 2: Bound on the Squared Norm.**\n1408: The bound on the total squared norm follows from the triangle inequality (`||A+B+C|| <= ||A|| + ||B|| + ||C||`) and the elementary inequality $(a+b+c)^2 \\le 3(a^2+b^2+c^2)$ for non-negative reals. For vectors, this becomes:\n1409: \n1410: $$\n1411: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\\|_2^2 \\le \\left( \\|\\Delta_{\\text{direct}}\\|_2 + \\|\\Delta_{\\text{mean}}\\|_2 + \\|\\Delta_{\\text{denom}}\\|_2 \\right)^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1412: \n1413: $$\n1414: \n1415: This completes the proof.\n1416: \n1417: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-direct-shift-bound-sq",
      "title": "Bound on the Squared Direct Shift Component",
      "start_line": 1421,
      "end_line": 1467,
      "header_lines": [
        1422
      ],
      "content_start": 1424,
      "content_end": 1466,
      "content": "1424: :label: lem-sasaki-direct-shift-bound-sq\n1425: \n1426: Let $\\mathcal S$ be a fixed swarm state. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. The squared Euclidean norm of the direct shift error component, $\\Delta_{\\text{direct}} = (\\mathbf r_1 - \\mathbf r_2) / \\sigma'_1$, is bounded as follows:\n1427: \n1428: $$\n1429: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1430: \n1431: $$\n1432: \n1433: where $\\sigma_{\\min,\\mathrm{patch}} := \\sqrt{\\kappa_{\\mathrm{var,min}}+\\varepsilon_{\\mathrm{std}}^2}$ is the uniform lower bound from the regularized standard deviation.\n1434: \n1435: ```{dropdown} Proof\n1436: :::{prf:proof}\n1437: The proof is a direct application of the definition of $\\Delta_{\\text{direct}}$ and the uniform lower bound on the regularized standard deviation.\n1438: \n1439: 1.  **Start with the Definition.**\n1440:     The squared L2-norm of the direct shift component is:\n1441: \n1442:     $$\n1443:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\left\\| \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} \\right\\|_2^2\n1444:     $$\n1445: \n1446: 2.  **Factor out the Scalar Term.**\n1447:     Since $\\sigma'_1$ is a scalar value for the fixed swarm state and value vector $\\mathbf r_1$, we can factor it out of the norm:\n1448: \n1449:     $$\n1450:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\frac{1}{(\\sigma'_1)^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1451:     $$\n1452: \n1453: 3.  **Apply the Uniform Lower Bound.**\n1454:     The regularized standard deviation function $\\sigma'_{\\mathrm{patch}}(V)$ is, by construction in the framework ({prf:ref}`def-statistical-properties-measurement`), strictly positive and uniformly bounded below by the constant $\\sigma_{\\min,\\mathrm{patch}}$. Therefore, $\\sigma'_1 \\ge \\sigma_{\\min,\\mathrm{patch}} > 0$. This implies:\n1455: \n1456:     $$\n1457:     \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1458:     $$\n1459: \n1460: 4.  **Combine to Finalize the Bound.**\n1461:     Substituting the inequality from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1462: \n1463:     $$\n1464:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1465:     $$\n1466: ",
      "metadata": {
        "label": "lem-sasaki-direct-shift-bound-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-statistical-properties-measurement"
      ],
      "raw_directive": "1421: ##### 2.3.4.2. Sub-Lemma: Bounding the Squared Direct Shift Component\n1422: \n1423: :::{prf:lemma} Bound on the Squared Direct Shift Component\n1424: :label: lem-sasaki-direct-shift-bound-sq\n1425: \n1426: Let $\\mathcal S$ be a fixed swarm state. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. The squared Euclidean norm of the direct shift error component, $\\Delta_{\\text{direct}} = (\\mathbf r_1 - \\mathbf r_2) / \\sigma'_1$, is bounded as follows:\n1427: \n1428: $$\n1429: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1430: \n1431: $$\n1432: \n1433: where $\\sigma_{\\min,\\mathrm{patch}} := \\sqrt{\\kappa_{\\mathrm{var,min}}+\\varepsilon_{\\mathrm{std}}^2}$ is the uniform lower bound from the regularized standard deviation.\n1434: \n1435: ```{dropdown} Proof\n1436: :::{prf:proof}\n1437: The proof is a direct application of the definition of $\\Delta_{\\text{direct}}$ and the uniform lower bound on the regularized standard deviation.\n1438: \n1439: 1.  **Start with the Definition.**\n1440:     The squared L2-norm of the direct shift component is:\n1441: \n1442:     $$\n1443:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\left\\| \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} \\right\\|_2^2\n1444:     $$\n1445: \n1446: 2.  **Factor out the Scalar Term.**\n1447:     Since $\\sigma'_1$ is a scalar value for the fixed swarm state and value vector $\\mathbf r_1$, we can factor it out of the norm:\n1448: \n1449:     $$\n1450:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\frac{1}{(\\sigma'_1)^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1451:     $$\n1452: \n1453: 3.  **Apply the Uniform Lower Bound.**\n1454:     The regularized standard deviation function $\\sigma'_{\\mathrm{patch}}(V)$ is, by construction in the framework ({prf:ref}`def-statistical-properties-measurement`), strictly positive and uniformly bounded below by the constant $\\sigma_{\\min,\\mathrm{patch}}$. Therefore, $\\sigma'_1 \\ge \\sigma_{\\min,\\mathrm{patch}} > 0$. This implies:\n1455: \n1456:     $$\n1457:     \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1458:     $$\n1459: \n1460: 4.  **Combine to Finalize the Bound.**\n1461:     Substituting the inequality from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1462: \n1463:     $$\n1464:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1465:     $$\n1466: \n1467: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-mean-shift-bound-sq",
      "title": "Bound on the Squared Mean Shift Component",
      "start_line": 1471,
      "end_line": 1520,
      "header_lines": [
        1472
      ],
      "content_start": 1474,
      "content_end": 1519,
      "content": "1474: :label: lem-sasaki-mean-shift-bound-sq\n1475: \n1476: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors. The squared Euclidean norm of the mean shift error component, $\\Delta_{\\text{mean}} = ((\\mu_2 - \\mu_1) / \\sigma'_1) \\cdot \\mathbf{1}$, is bounded as follows:\n1477: \n1478: $$\n1479: \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1480: \n1481: $$\n1482: \n1483: where $L_{\\mu,M}^{\\mathrm{Sasaki}}(k)$ is the axiomatic **Value Lipschitz Function** for the aggregator's mean from {prf:ref}`lem-sasaki-aggregator-lipschitz`.\n1484: \n1485: ```{dropdown} Proof\n1486: :::{prf:proof}\n1487: The proof combines the definition of the mean shift component with the axiomatic continuity of the mean aggregator.\n1488: \n1489: 1.  **Start with the Definition.**\n1490:     The squared L2-norm of the mean shift component is:\n1491: \n1492:     $$\n1493:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\left\\| \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1} \\right\\|_2^2\n1494:     $$\n1495: \n1496: 2.  **Factor out the Scalar and Evaluate the Norm.**\n1497:     The term $(\\mu_2 - \\mu_1) / \\sigma'_1$ is a scalar. The L2-norm of the k-dimensional vector of ones, $\\mathbf{1}$, is $\\|\\mathbf{1}\\|_2 = \\sqrt{k}$. Therefore, the squared norm is:\n1498: \n1499:     $$\n1500:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} \\cdot \\|\\mathbf{1}\\|_2^2 = \\frac{k \\cdot (\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2}\n1501:     $$\n1502: \n1503: 3.  **Apply Axiomatic Continuity of the Mean.**\n1504:     The empirical aggregator is Lipschitz continuous with respect to the raw value vector, as established in {prf:ref}`lem-sasaki-aggregator-value`. This provides the bound:\n1505: \n1506:     $$\n1507:     |\\mu_2 - \\mu_1|^2 \\le \\left(L_{\\mu,M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1508:     $$\n1509: \n1510: 4.  **Apply the Uniform Lower Bound.**\n1511:     As in the previous lemma, we use the bound $1/(\\sigma'_1)^2 \\le 1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1512: \n1513: 5.  **Combine to Finalize the Bound.**\n1514:     Substituting the bounds from Step 3 and Step 4 into the expression from Step 2 yields the final result as stated in the lemma.\n1515: \n1516:     $$\n1517:     \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1518:     $$\n1519: ",
      "metadata": {
        "label": "lem-sasaki-mean-shift-bound-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-sasaki-aggregator-lipschitz",
        "lem-sasaki-aggregator-value"
      ],
      "raw_directive": "1471: ##### 2.3.4.3. Sub-Lemma: Bounding the Squared Mean Shift Component\n1472: \n1473: :::{prf:lemma} Bound on the Squared Mean Shift Component\n1474: :label: lem-sasaki-mean-shift-bound-sq\n1475: \n1476: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors. The squared Euclidean norm of the mean shift error component, $\\Delta_{\\text{mean}} = ((\\mu_2 - \\mu_1) / \\sigma'_1) \\cdot \\mathbf{1}$, is bounded as follows:\n1477: \n1478: $$\n1479: \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1480: \n1481: $$\n1482: \n1483: where $L_{\\mu,M}^{\\mathrm{Sasaki}}(k)$ is the axiomatic **Value Lipschitz Function** for the aggregator's mean from {prf:ref}`lem-sasaki-aggregator-lipschitz`.\n1484: \n1485: ```{dropdown} Proof\n1486: :::{prf:proof}\n1487: The proof combines the definition of the mean shift component with the axiomatic continuity of the mean aggregator.\n1488: \n1489: 1.  **Start with the Definition.**\n1490:     The squared L2-norm of the mean shift component is:\n1491: \n1492:     $$\n1493:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\left\\| \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1} \\right\\|_2^2\n1494:     $$\n1495: \n1496: 2.  **Factor out the Scalar and Evaluate the Norm.**\n1497:     The term $(\\mu_2 - \\mu_1) / \\sigma'_1$ is a scalar. The L2-norm of the k-dimensional vector of ones, $\\mathbf{1}$, is $\\|\\mathbf{1}\\|_2 = \\sqrt{k}$. Therefore, the squared norm is:\n1498: \n1499:     $$\n1500:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} \\cdot \\|\\mathbf{1}\\|_2^2 = \\frac{k \\cdot (\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2}\n1501:     $$\n1502: \n1503: 3.  **Apply Axiomatic Continuity of the Mean.**\n1504:     The empirical aggregator is Lipschitz continuous with respect to the raw value vector, as established in {prf:ref}`lem-sasaki-aggregator-value`. This provides the bound:\n1505: \n1506:     $$\n1507:     |\\mu_2 - \\mu_1|^2 \\le \\left(L_{\\mu,M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1508:     $$\n1509: \n1510: 4.  **Apply the Uniform Lower Bound.**\n1511:     As in the previous lemma, we use the bound $1/(\\sigma'_1)^2 \\le 1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1512: \n1513: 5.  **Combine to Finalize the Bound.**\n1514:     Substituting the bounds from Step 3 and Step 4 into the expression from Step 2 yields the final result as stated in the lemma.\n1515: \n1516:     $$\n1517:     \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1518:     $$\n1519: \n1520: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-denom-shift-bound-sq",
      "title": "Bounding the Squared Denominator Shift Component",
      "start_line": 1524,
      "end_line": 1584,
      "header_lines": [
        1525
      ],
      "content_start": 1527,
      "content_end": 1583,
      "content": "1527: :label: lem-sasaki-denom-shift-bound-sq\n1528: \n1529: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the denominator shift error component, $\\Delta_{\\text{denom}} = \\mathbf z_2 \\cdot ((\\sigma'_2 - \\sigma'_1) / \\sigma'_1)$, is bounded as follows:\n1530: \n1531: $$\n1532: \\|\\Delta_{\\text{denom}}\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\left( \\frac{L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1533: \n1534: $$\n1535: \n1536: where $L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)$ is the derived Lipschitz constant for the regularized standard deviation.\n1537: \n1538: ```{dropdown} Proof\n1539: :::{prf:proof}\n1540: The proof bounds the squared norm by bounding its three constituent parts: the norm of the standardized vector, the change in the regularized standard deviation, and the inverse of the standard deviation.\n1541: \n1542: 1.  **Start with the Definition.**\n1543:     The squared L2-norm of the denominator shift component is:\n1544: \n1545:     $$\n1546:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\left\\| \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\right\\|_2^2\n1547:     $$\n1548: \n1549: 2.  **Factor out the Scalar Term.**\n1550:     The fractional term involving the standard deviations is a scalar. We factor it out of the norm:\n1551: \n1552:     $$\n1553:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\|\\mathbf z_2\\|_2^2 \\cdot \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2}\n1554:     $$\n1555: \n1556: 3.  **Bound Each Factor.**\n1557:     We now find a deterministic upper bound for each of the three factors in the expression.\n1558:     *   **Bound on `||z2||_2^2`**: The framework provides a universal bound on the squared norm of any standardized vector, proven in {prf:ref}`thm-z-score-norm-bound`. For the k-dimensional vector $\\mathbf z_2$, this is:\n1559: \n1560:         $$\n1561:         \\|\\mathbf z_2\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1562:         $$\n1563: \n1564:     *   **Bound on `(sigma'_2 - sigma'_1)^2`**: The regularized standard deviation function is Lipschitz continuous with respect to the raw value vector, as established by composing the Lipschitz properties of the aggregator moments and the patching function itself ({prf:ref}`lem-stats-value-continuity` in the framework). This gives:\n1565: \n1566:         $$\n1567:         (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1568:         $$\n1569: \n1570:     *   **Bound on `1/(sigma'_1)^2`**: As in the preceding lemmas, we use the uniform lower bound:\n1571: \n1572:         $$\n1573:         \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1574:         $$\n1575: \n1576: 4.  **Combine to Finalize the Bound.**\n1577:     Substituting the bounds for all three factors from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1578: \n1579:     $$\n1580:     \\|\\Delta_{\\text{denom}}\\|_2^2 \\le \\left( k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\right) \\cdot \\left( \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2 \\right) \\cdot \\left( \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right)\n1581:     $$\n1582:     Rearranging the terms gives the stated result.\n1583: ",
      "metadata": {
        "label": "lem-sasaki-denom-shift-bound-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "thm-z-score-norm-bound",
        "lem-stats-value-continuity"
      ],
      "raw_directive": "1524: ##### 2.3.4.4. Sub-Lemma: Bounding the Squared Denominator Shift Component\n1525: \n1526: :::{prf:lemma} Bounding the Squared Denominator Shift Component\n1527: :label: lem-sasaki-denom-shift-bound-sq\n1528: \n1529: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the denominator shift error component, $\\Delta_{\\text{denom}} = \\mathbf z_2 \\cdot ((\\sigma'_2 - \\sigma'_1) / \\sigma'_1)$, is bounded as follows:\n1530: \n1531: $$\n1532: \\|\\Delta_{\\text{denom}}\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\left( \\frac{L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1533: \n1534: $$\n1535: \n1536: where $L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)$ is the derived Lipschitz constant for the regularized standard deviation.\n1537: \n1538: ```{dropdown} Proof\n1539: :::{prf:proof}\n1540: The proof bounds the squared norm by bounding its three constituent parts: the norm of the standardized vector, the change in the regularized standard deviation, and the inverse of the standard deviation.\n1541: \n1542: 1.  **Start with the Definition.**\n1543:     The squared L2-norm of the denominator shift component is:\n1544: \n1545:     $$\n1546:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\left\\| \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\right\\|_2^2\n1547:     $$\n1548: \n1549: 2.  **Factor out the Scalar Term.**\n1550:     The fractional term involving the standard deviations is a scalar. We factor it out of the norm:\n1551: \n1552:     $$\n1553:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\|\\mathbf z_2\\|_2^2 \\cdot \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2}\n1554:     $$\n1555: \n1556: 3.  **Bound Each Factor.**\n1557:     We now find a deterministic upper bound for each of the three factors in the expression.\n1558:     *   **Bound on `||z2||_2^2`**: The framework provides a universal bound on the squared norm of any standardized vector, proven in {prf:ref}`thm-z-score-norm-bound`. For the k-dimensional vector $\\mathbf z_2$, this is:\n1559: \n1560:         $$\n1561:         \\|\\mathbf z_2\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1562:         $$\n1563: \n1564:     *   **Bound on `(sigma'_2 - sigma'_1)^2`**: The regularized standard deviation function is Lipschitz continuous with respect to the raw value vector, as established by composing the Lipschitz properties of the aggregator moments and the patching function itself ({prf:ref}`lem-stats-value-continuity` in the framework). This gives:\n1565: \n1566:         $$\n1567:         (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1568:         $$\n1569: \n1570:     *   **Bound on `1/(sigma'_1)^2`**: As in the preceding lemmas, we use the uniform lower bound:\n1571: \n1572:         $$\n1573:         \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1574:         $$\n1575: \n1576: 4.  **Combine to Finalize the Bound.**\n1577:     Substituting the bounds for all three factors from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1578: \n1579:     $$\n1580:     \\|\\Delta_{\\text{denom}}\\|_2^2 \\le \\left( k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\right) \\cdot \\left( \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2 \\right) \\cdot \\left( \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right)\n1581:     $$\n1582:     Rearranging the terms gives the stated result.\n1583: \n1584: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-structural-error-decomposition",
      "title": "Decomposition of the Structural Error",
      "start_line": 1695,
      "end_line": 1747,
      "header_lines": [
        1696
      ],
      "content_start": 1698,
      "content_end": 1746,
      "content": "1698: :label: lem-sasaki-structural-error-decomposition\n1699: \n1700: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. Let $\\mathbf z_1 = z(\\mathcal S_1, \\mathbf r_2)$ and $\\mathbf z_2 = z(\\mathcal S_2, \\mathbf r_2)$ be the corresponding N-dimensional standardized vectors, computed using the fixed raw values from the second swarm but the structure of each respective swarm.\n1701: \n1702: The total structural error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of two **orthogonal** components:\n1703: \n1704: $$\n1705: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\n1706: \n1707: $$\n1708: \n1709: where:\n1710: 1.  **The Direct Error ($\\Delta_{\\text{direct}}$):** The error vector whose non-zero components correspond to walkers whose status changes between $\\mathcal S_1$ and $\\mathcal S_2$.\n1711: 2.  **The Indirect Error ($\\Delta_{\\text{indirect}}$):** The error vector whose non-zero components correspond to walkers that are alive in both swarms.\n1712: \n1713: Because these two vectors have disjoint support, the squared L2-norm of the total error is the sum of the squared L2-norms of the components:\n1714: \n1715: $$\n1716: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1717: \n1718: $$\n1719: \n1720: ```{dropdown} Proof\n1721: :::{prf:proof}\n1722: The proof follows from partitioning the sum of squared errors over the N walker indices. Let the full set of indices be $\\{1, ..., N\\}$.\n1723: \n1724: 1.  **Define Index Partitions.**\n1725:     Let $\\mathcal{A}_{\\text{unstable}} := \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$ be the set of indices of walkers whose survival status changes. Let $\\mathcal{A}_{\\text{stable}} := \\mathcal{A}(\\mathcal S_1) \\cap \\mathcal{A}(\\mathcal S_2)$ be the set of indices for walkers that remain alive. Let $\\mathcal{D}_{\\text{stable}}$ be the indices of walkers dead in both swarms. These three sets form a partition of $\\{1, ..., N\\}$.\n1726: \n1727: 2.  **Analyze Error Components on Each Partition.**\n1728:     *   For $i \\in \\mathcal{A}_{\\text{unstable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero.\n1729:     *   For $i \\in \\mathcal{A}_{\\text{stable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero because the statistical moments $(\\mu, \\sigma')$ change with the swarm structure.\n1730:     *   For $i \\in \\mathcal{D}_{\\text{stable}}$, both $z_{1,i}$ and $z_{2,i}$ are deterministically zero by the definition of the standardization operator. The error component is zero.\n1731: \n1732: 3.  **Define Orthogonal Error Vectors.**\n1733:     We define the vector $\\Delta_{\\text{direct}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{unstable}}$ and zero otherwise. We define $\\Delta_{\\text{indirect}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{stable}}$ and zero otherwise. By construction, $\\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}$.\n1734: \n1735: 4.  **Show Orthogonality.**\n1736:     The two vectors have disjoint support, meaning for any index $i$, at most one of the vectors can have a non-zero component. Therefore, their dot product is zero: $\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}} = 0$.\n1737: \n1738: 5.  **Finalize the Squared Norm Identity.**\n1739:     For orthogonal vectors, the squared norm of the sum is the sum of the squared norms:\n1740: \n1741:     $$\n1742:     \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2 + 2(\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}}) = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1743:     $$\n1744: \n1745: This completes the proof.\n1746: ",
      "metadata": {
        "label": "lem-sasaki-structural-error-decomposition"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [],
      "raw_directive": "1695: ##### 2.3.6.1. Sub-Lemma: Decomposition of the Structural Error\n1696: \n1697: :::{prf:lemma} Decomposition of the Structural Error\n1698: :label: lem-sasaki-structural-error-decomposition\n1699: \n1700: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. Let $\\mathbf z_1 = z(\\mathcal S_1, \\mathbf r_2)$ and $\\mathbf z_2 = z(\\mathcal S_2, \\mathbf r_2)$ be the corresponding N-dimensional standardized vectors, computed using the fixed raw values from the second swarm but the structure of each respective swarm.\n1701: \n1702: The total structural error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of two **orthogonal** components:\n1703: \n1704: $$\n1705: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\n1706: \n1707: $$\n1708: \n1709: where:\n1710: 1.  **The Direct Error ($\\Delta_{\\text{direct}}$):** The error vector whose non-zero components correspond to walkers whose status changes between $\\mathcal S_1$ and $\\mathcal S_2$.\n1711: 2.  **The Indirect Error ($\\Delta_{\\text{indirect}}$):** The error vector whose non-zero components correspond to walkers that are alive in both swarms.\n1712: \n1713: Because these two vectors have disjoint support, the squared L2-norm of the total error is the sum of the squared L2-norms of the components:\n1714: \n1715: $$\n1716: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1717: \n1718: $$\n1719: \n1720: ```{dropdown} Proof\n1721: :::{prf:proof}\n1722: The proof follows from partitioning the sum of squared errors over the N walker indices. Let the full set of indices be $\\{1, ..., N\\}$.\n1723: \n1724: 1.  **Define Index Partitions.**\n1725:     Let $\\mathcal{A}_{\\text{unstable}} := \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$ be the set of indices of walkers whose survival status changes. Let $\\mathcal{A}_{\\text{stable}} := \\mathcal{A}(\\mathcal S_1) \\cap \\mathcal{A}(\\mathcal S_2)$ be the set of indices for walkers that remain alive. Let $\\mathcal{D}_{\\text{stable}}$ be the indices of walkers dead in both swarms. These three sets form a partition of $\\{1, ..., N\\}$.\n1726: \n1727: 2.  **Analyze Error Components on Each Partition.**\n1728:     *   For $i \\in \\mathcal{A}_{\\text{unstable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero.\n1729:     *   For $i \\in \\mathcal{A}_{\\text{stable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero because the statistical moments $(\\mu, \\sigma')$ change with the swarm structure.\n1730:     *   For $i \\in \\mathcal{D}_{\\text{stable}}$, both $z_{1,i}$ and $z_{2,i}$ are deterministically zero by the definition of the standardization operator. The error component is zero.\n1731: \n1732: 3.  **Define Orthogonal Error Vectors.**\n1733:     We define the vector $\\Delta_{\\text{direct}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{unstable}}$ and zero otherwise. We define $\\Delta_{\\text{indirect}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{stable}}$ and zero otherwise. By construction, $\\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}$.\n1734: \n1735: 4.  **Show Orthogonality.**\n1736:     The two vectors have disjoint support, meaning for any index $i$, at most one of the vectors can have a non-zero component. Therefore, their dot product is zero: $\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}} = 0$.\n1737: \n1738: 5.  **Finalize the Squared Norm Identity.**\n1739:     For orthogonal vectors, the squared norm of the sum is the sum of the squared norms:\n1740: \n1741:     $$\n1742:     \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2 + 2(\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}}) = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1743:     $$\n1744: \n1745: This completes the proof.\n1746: \n1747: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-direct-structural-error-sq",
      "title": "Bound on the Squared Direct Structural Error",
      "start_line": 1751,
      "end_line": 1801,
      "header_lines": [
        1752
      ],
      "content_start": 1754,
      "content_end": 1800,
      "content": "1754: :label: lem-sasaki-direct-structural-error-sq\n1755: \n1756: Let $\\mathbf r_2$ be a fixed raw value vector with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the direct structural error component, $\\|\\Delta_{\\text{direct}}\\|_2^2$, is bounded by a term linear in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1757: \n1758: $$\n1759: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1760: \n1761: $$\n1762: \n1763: ```{dropdown} Proof\n1764: :::{prf:proof}\n1765: The proof bounds the squared error for each unstable walker and sums the results.\n1766: \n1767: 1.  **Isolate the Sum.**\n1768:     By definition, the vector $\\Delta_{\\text{direct}}$ has non-zero components only for walkers in the unstable set $\\mathcal{A}_{\\text{unstable}} = \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$. The number of walkers in this set is exactly $n_c = n_c(\\mathcal S_1, \\mathcal S_2)$. The squared norm is the sum of the squared errors over this set:\n1769: \n1770:     $$\n1771:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2\n1772:     $$\n1773: \n1774: 2.  **Bound the Error for a Single Unstable Walker.**\n1775:     Consider a single walker $i \\in \\mathcal{A}_{\\text{unstable}}$. Its status changes between $\\mathcal S_1$ and $\\mathcal S_2$. This means one of two cases:\n1776:     *   Case A: Walker $i$ is alive in $\\mathcal S_1$ and dead in $\\mathcal S_2$. Then $z_{2,i} = 0$. The error is $(z_{1,i})^2$.\n1777:     *   Case B: Walker $i$ is dead in $\\mathcal S_1$ and alive in $\\mathcal S_2$. Then $z_{1,i} = 0$. The error is $(-z_{2,i})^2 = (z_{2,i})^2$.\n1778: \n1779:     In both cases, the squared error for walker $i$ is the square of a single, valid standardized score.\n1780: \n1781: 3.  **Apply the Universal Z-Score Bound.**\n1782:     The framework provides a universal bound for the magnitude of any single standardized score in {prf:ref}`thm-z-score-norm-bound`, which is $|z_j| \\le 2V_{\\max}^{(R)} / \\sigma_{\\min,\\mathrm{patch}}$. Squaring this gives a uniform bound for the squared error of any unstable walker:\n1783: \n1784:     $$\n1785:     (z_{1,i} - z_{2,i})^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1786:     $$\n1787: \n1788: 4.  **Sum Over All Unstable Walkers.**\n1789:     We sum this uniform bound over all $n_c$ walkers in the unstable set:\n1790: \n1791:     $$\n1792:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i=1}^{n_c} \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1793:     $$\n1794: \n1795:     This yields the final result as stated in the lemma.\n1796: \n1797:     $$\n1798:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le n_c \\cdot \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1799:     $$\n1800: ",
      "metadata": {
        "label": "lem-sasaki-direct-structural-error-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "thm-z-score-norm-bound"
      ],
      "raw_directive": "1751: ##### 2.3.6.2. Sub-Lemma: Bounding the Squared Direct Structural Error\n1752: \n1753: :::{prf:lemma} Bound on the Squared Direct Structural Error\n1754: :label: lem-sasaki-direct-structural-error-sq\n1755: \n1756: Let $\\mathbf r_2$ be a fixed raw value vector with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the direct structural error component, $\\|\\Delta_{\\text{direct}}\\|_2^2$, is bounded by a term linear in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1757: \n1758: $$\n1759: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1760: \n1761: $$\n1762: \n1763: ```{dropdown} Proof\n1764: :::{prf:proof}\n1765: The proof bounds the squared error for each unstable walker and sums the results.\n1766: \n1767: 1.  **Isolate the Sum.**\n1768:     By definition, the vector $\\Delta_{\\text{direct}}$ has non-zero components only for walkers in the unstable set $\\mathcal{A}_{\\text{unstable}} = \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$. The number of walkers in this set is exactly $n_c = n_c(\\mathcal S_1, \\mathcal S_2)$. The squared norm is the sum of the squared errors over this set:\n1769: \n1770:     $$\n1771:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2\n1772:     $$\n1773: \n1774: 2.  **Bound the Error for a Single Unstable Walker.**\n1775:     Consider a single walker $i \\in \\mathcal{A}_{\\text{unstable}}$. Its status changes between $\\mathcal S_1$ and $\\mathcal S_2$. This means one of two cases:\n1776:     *   Case A: Walker $i$ is alive in $\\mathcal S_1$ and dead in $\\mathcal S_2$. Then $z_{2,i} = 0$. The error is $(z_{1,i})^2$.\n1777:     *   Case B: Walker $i$ is dead in $\\mathcal S_1$ and alive in $\\mathcal S_2$. Then $z_{1,i} = 0$. The error is $(-z_{2,i})^2 = (z_{2,i})^2$.\n1778: \n1779:     In both cases, the squared error for walker $i$ is the square of a single, valid standardized score.\n1780: \n1781: 3.  **Apply the Universal Z-Score Bound.**\n1782:     The framework provides a universal bound for the magnitude of any single standardized score in {prf:ref}`thm-z-score-norm-bound`, which is $|z_j| \\le 2V_{\\max}^{(R)} / \\sigma_{\\min,\\mathrm{patch}}$. Squaring this gives a uniform bound for the squared error of any unstable walker:\n1783: \n1784:     $$\n1785:     (z_{1,i} - z_{2,i})^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1786:     $$\n1787: \n1788: 4.  **Sum Over All Unstable Walkers.**\n1789:     We sum this uniform bound over all $n_c$ walkers in the unstable set:\n1790: \n1791:     $$\n1792:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i=1}^{n_c} \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1793:     $$\n1794: \n1795:     This yields the final result as stated in the lemma.\n1796: \n1797:     $$\n1798:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le n_c \\cdot \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1799:     $$\n1800: \n1801: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-indirect-structural-error-sq",
      "title": "Bound on the Squared Indirect Structural Error",
      "start_line": 1805,
      "end_line": 1891,
      "header_lines": [
        1806
      ],
      "content_start": 1808,
      "content_end": 1890,
      "content": "1808: :label: lem-sasaki-indirect-structural-error-sq\n1809: \n1810: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. The squared Euclidean norm of the indirect structural error component, $\\|\\Delta_{\\text{indirect}}\\|_2^2$, is bounded by a term quadratic in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1811: \n1812: $$\n1813: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1814: \n1815: $$\n1816: \n1817: where $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}$ is the **Squared Indirect Structural Error Coefficient** defined in {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1818: \n1819: ```{dropdown} Proof\n1820: :::{prf:proof}\n1821: The proof decomposes the error for each stable walker into a mean-shift and a denominator-shift component and then bounds the sum of their squares.\n1822: \n1823: **Step 1: Decompose the Error for a Single Stable Walker.**\n1824: For any walker $i$ in the stable set $\\mathcal A_{\\mathrm{stable}} = \\mathcal A(\\mathcal S_1) \\cap \\mathcal A(\\mathcal S_2)$, the error is:\n1825: \n1826: $$\n1827: \\begin{aligned}\n1828: z_{1,i} - z_{2,i} &= \\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2} \\\\\n1829: &= \\left(\\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_1}\\right) + \\left(\\frac{r_{2,i} - \\mu_2}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2}\\right) \\\\\n1830: &= \\underbrace{\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}}_{\\text{Mean Shift}} + \\underbrace{z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}}_{\\text{Denominator Shift}}\n1831: \\end{aligned}\n1832: \n1833: $$\n1834: The squared error for this single walker is bounded using $(a+b)^2 \\le 2(a^2+b^2)$:\n1835: \n1836: $$\n1837: (z_{1,i} - z_{2,i})^2 \\le 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1838: \n1839: $$\n1840: \n1841: **Step 2: Sum the Errors Over All Stable Walkers.**\n1842: The total squared indirect error is the sum over all $i \\in \\mathcal A_{\\mathrm{stable}}$. Let $k_{\\mathrm{stable}} := |\\mathcal A_{\\mathrm{stable}}|$.\n1843: \n1844: $$\n1845: \\|\\Delta_{\\text{indirect}}\\|_2^2 = \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1846: \n1847: $$\n1848: \n1849: This can be simplified:\n1850: \n1851: $$\n1852: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} + 2 \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2} \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2\n1853: \n1854: $$\n1855: \n1856: **Step 3: Bound the Components.**\n1857: We now bound each term using the axiomatic properties of the aggregator and the uniform bounds from the framework.\n1858: *   **Bound on `(mu_2 - mu_1)^2`**: The structural continuity of the empirical mean ({prf:ref}`lem-sasaki-aggregator-structural`) gives:\n1859: \n1860:     $$\n1861:     (\\mu_2 - \\mu_1)^2 \\le \\left(L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min}) \\cdot n_c\\right)^2\n1862:     $$\n1863: *   **Bound on `(sigma'_2 - sigma'_1)^2`**: By composing the structural continuity of the variance with the Lipschitz property of the patching function ({prf:ref}`lem-stats-structural-continuity` in the framework), we get:\n1864: \n1865:     $$\n1866:     (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',S}^{\\mathrm{Sasaki}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c\\right)^2\n1867:     $$\n1868: *   **Bound on `sum(z_2,i^2)`**: The sum is over the stable set, which is a subset of the alive walkers in $\\mathcal S_2$. Thus, the sum is bounded by the total squared norm of the z-score vector for $\\mathcal S_2$:\n1869: \n1870:     $$\n1871:     \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2 \\le \\|\\mathbf z_2\\|_2^2 \\le k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1872:     $$\n1873: *   **Bound on `1/(sigma'_1)^2`**: This is bounded by $1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1874: \n1875: **Step 4: Assemble the Final Bound.**\n1876: Substituting these bounds back into the inequality from Step 2 gives a bound that is quadratic in $n_c$.\n1877: \n1878: $$\n1879: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 \\frac{(L_{\\sigma',S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1880: \n1881: $$\n1882: \n1883: Factoring out $n_c^2$ and combining the coefficients gives:\n1884: \n1885: $$\n1886: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le \\left[ 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2 \\frac{(L_{\\sigma',S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right] \\cdot n_c^2\n1887: \n1888: $$\n1889: The term in the brackets is precisely the definition of the **Squared Indirect Structural Error Coefficient**, $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2)$. This completes the proof.\n1890: ",
      "metadata": {
        "label": "lem-sasaki-indirect-structural-error-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-sasaki-structural-coeffs-sq",
        "lem-sasaki-aggregator-structural",
        "lem-stats-structural-continuity"
      ],
      "raw_directive": "1805: ##### 2.3.6.3. Sub-Lemma: Bounding the Squared Indirect Structural Error\n1806: \n1807: :::{prf:lemma} Bound on the Squared Indirect Structural Error\n1808: :label: lem-sasaki-indirect-structural-error-sq\n1809: \n1810: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. The squared Euclidean norm of the indirect structural error component, $\\|\\Delta_{\\text{indirect}}\\|_2^2$, is bounded by a term quadratic in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1811: \n1812: $$\n1813: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1814: \n1815: $$\n1816: \n1817: where $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}$ is the **Squared Indirect Structural Error Coefficient** defined in {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1818: \n1819: ```{dropdown} Proof\n1820: :::{prf:proof}\n1821: The proof decomposes the error for each stable walker into a mean-shift and a denominator-shift component and then bounds the sum of their squares.\n1822: \n1823: **Step 1: Decompose the Error for a Single Stable Walker.**\n1824: For any walker $i$ in the stable set $\\mathcal A_{\\mathrm{stable}} = \\mathcal A(\\mathcal S_1) \\cap \\mathcal A(\\mathcal S_2)$, the error is:\n1825: \n1826: $$\n1827: \\begin{aligned}\n1828: z_{1,i} - z_{2,i} &= \\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2} \\\\\n1829: &= \\left(\\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_1}\\right) + \\left(\\frac{r_{2,i} - \\mu_2}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2}\\right) \\\\\n1830: &= \\underbrace{\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}}_{\\text{Mean Shift}} + \\underbrace{z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}}_{\\text{Denominator Shift}}\n1831: \\end{aligned}\n1832: \n1833: $$\n1834: The squared error for this single walker is bounded using $(a+b)^2 \\le 2(a^2+b^2)$:\n1835: \n1836: $$\n1837: (z_{1,i} - z_{2,i})^2 \\le 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1838: \n1839: $$\n1840: \n1841: **Step 2: Sum the Errors Over All Stable Walkers.**\n1842: The total squared indirect error is the sum over all $i \\in \\mathcal A_{\\mathrm{stable}}$. Let $k_{\\mathrm{stable}} := |\\mathcal A_{\\mathrm{stable}}|$.\n1843: \n1844: $$\n1845: \\|\\Delta_{\\text{indirect}}\\|_2^2 = \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1846: \n1847: $$\n1848: \n1849: This can be simplified:\n1850: \n1851: $$\n1852: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} + 2 \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2} \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2\n1853: \n1854: $$\n1855: \n1856: **Step 3: Bound the Components.**\n1857: We now bound each term using the axiomatic properties of the aggregator and the uniform bounds from the framework.\n1858: *   **Bound on `(mu_2 - mu_1)^2`**: The structural continuity of the empirical mean ({prf:ref}`lem-sasaki-aggregator-structural`) gives:\n1859: \n1860:     $$\n1861:     (\\mu_2 - \\mu_1)^2 \\le \\left(L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min}) \\cdot n_c\\right)^2\n1862:     $$\n1863: *   **Bound on `(sigma'_2 - sigma'_1)^2`**: By composing the structural continuity of the variance with the Lipschitz property of the patching function ({prf:ref}`lem-stats-structural-continuity` in the framework), we get:\n1864: \n1865:     $$\n1866:     (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',S}^{\\mathrm{Sasaki}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c\\right)^2\n1867:     $$\n1868: *   **Bound on `sum(z_2,i^2)`**: The sum is over the stable set, which is a subset of the alive walkers in $\\mathcal S_2$. Thus, the sum is bounded by the total squared norm of the z-score vector for $\\mathcal S_2$:\n1869: \n1870:     $$\n1871:     \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2 \\le \\|\\mathbf z_2\\|_2^2 \\le k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1872:     $$\n1873: *   **Bound on `1/(sigma'_1)^2`**: This is bounded by $1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1874: \n1875: **Step 4: Assemble the Final Bound.**\n1876: Substituting these bounds back into the inequality from Step 2 gives a bound that is quadratic in $n_c$.\n1877: \n1878: $$\n1879: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 \\frac{(L_{\\sigma',S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1880: \n1881: $$\n1882: \n1883: Factoring out $n_c^2$ and combining the coefficients gives:\n1884: \n1885: $$\n1886: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le \\left[ 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2 \\frac{(L_{\\sigma',S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right] \\cdot n_c^2\n1887: \n1888: $$\n1889: The term in the brackets is precisely the definition of the **Squared Indirect Structural Error Coefficient**, $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2)$. This completes the proof.\n1890: \n1891: **Q.E.D.**",
      "_registry_context": {
        "stage": "directives",
        "document_id": "02_euclidean_gas",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)"
      }
    }
  ]
}