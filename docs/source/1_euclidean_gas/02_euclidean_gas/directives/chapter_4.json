{
  "chapter_index": 4,
  "section_id": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
  "directive_count": 28,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-kinetic-lipschitz",
      "title": "Lipschitz property of the kinetic flow",
      "start_line": 555,
      "end_line": 612,
      "header_lines": [
        556
      ],
      "content_start": 558,
      "content_end": 611,
      "content": "558: :label: lem-sasaki-kinetic-lipschitz\n559: \n560: For $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and any $\\xi_v,\\xi_x\\in\\mathbb R^d$ define\n561: \n562: $$\n563: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\big(v+\\tfrac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n564: \n565: $$\n566: Then\n567: \n568: $$\n569: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')),\\qquad L_{\\mathrm{flow}}:=1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}.\n570: \n571: $$\n572: \n573: Referenced by {prf:ref}`lem-euclidean-boundary-holder`.\n574: \n575: ```{dropdown} Proof\n576: :::{prf:proof}\n577: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and $\\xi_v,\\xi_x\\in\\mathbb R^d$. Define the uncapped velocities\n578: \n579: $$\n580: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad\\tilde v':=v'+\\frac{\\tau}{m}F(x')-\\gamma_{\\mathrm{fric}}\\tau\\big(v'-u(x')\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n581: \n582: $$\n583: \n584: Because the same velocity noise $\\xi_v$ appears in both expressions, it cancels in the difference $\\tilde v-\\tilde v'$. We bound the displacement in four steps.\n585: \n586: 1. **Uncapped velocity difference.** Using the triangle inequality, the Lipschitz constant $L_F$ of $F$, and the Lipschitz constant $L_u$ of $u$, we obtain\n587: \n588: $$\n589: \\begin{aligned}\n590: \\|\\tilde v-\\tilde v'\\|&\\le \\|v-v'\\|+\\frac{\\tau}{m}\\|F(x)-F(x')\\|+\\gamma_{\\mathrm{fric}}\\tau\\|v-v'\\|+\\gamma_{\\mathrm{fric}}\\tau\\|u(x)-u(x')\\|\\\\\n591: &\\le(1+\\gamma_{\\mathrm{fric}}\\tau)\\,\\|v-v'\\|+\\Big(\\frac{\\tau}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau L_u\\Big)\\,\\|x-x'\\|.\n592: \\end{aligned}\n593: \n594: $$\n595: \n596: 2. **Lipschitz projection.** Lemma {prf:ref}`lem-squashing-properties-generic` shows the smooth squashing map $\\psi_v$ is $1$-Lipschitz, so the same inequality holds for the capped velocities $v^+:=\\psi_v(\\tilde v)$ and $v'^+:=\\psi_v(\\tilde v')$.\n597: \n598: 3. **Position update.** The Euler step sets $x^+:=x+\\tau v^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ and $x'^+:=x'+\\tau v'^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Hence\n599: \n600: $$\n601: \\|x^+-x'^+\\|\\le\\|x-x'\\|+\\tau\\,\\|v^+-v'^+\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u\\Big)\\|x-x'\\|+\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)\\|v-v'\\|.\n602: \n603: $$\n604: \n605: 4. **Express via the Sasaki metric.** The Sasaki distance satisfies $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))^2=\\|x-x'\\|^2+\\lambda_v\\|v-v'\\|^2$, so $\\|x-x'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ and $\\|v-v'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}/\\sqrt{\\lambda_v}$. Substituting these bounds into the inequality from Step 3 yields\n606: \n607: $$\n608: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}\\Big) d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')).\n609: \n610: $$\n611: ",
      "metadata": {
        "label": "lem-sasaki-kinetic-lipschitz"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-euclidean-boundary-holder",
        "lem-squashing-properties-generic"
      ],
      "raw_directive": "555: 2. **Boundary regularity & smoothness.** Lemma {prf:ref}`lem-euclidean-boundary-holder` bounds the death probability with explicit H\u00f6lder constants, verifying the boundary axioms ({prf:ref}`def-axiom-boundary-regularity`, {prf:ref}`def-axiom-boundary-smoothness`).\n556: \n557: :::{prf:lemma} Lipschitz property of the kinetic flow\n558: :label: lem-sasaki-kinetic-lipschitz\n559: \n560: For $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and any $\\xi_v,\\xi_x\\in\\mathbb R^d$ define\n561: \n562: $$\n563: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\big(v+\\tfrac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n564: \n565: $$\n566: Then\n567: \n568: $$\n569: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')),\\qquad L_{\\mathrm{flow}}:=1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}.\n570: \n571: $$\n572: \n573: Referenced by {prf:ref}`lem-euclidean-boundary-holder`.\n574: \n575: ```{dropdown} Proof\n576: :::{prf:proof}\n577: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and $\\xi_v,\\xi_x\\in\\mathbb R^d$. Define the uncapped velocities\n578: \n579: $$\n580: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad\\tilde v':=v'+\\frac{\\tau}{m}F(x')-\\gamma_{\\mathrm{fric}}\\tau\\big(v'-u(x')\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n581: \n582: $$\n583: \n584: Because the same velocity noise $\\xi_v$ appears in both expressions, it cancels in the difference $\\tilde v-\\tilde v'$. We bound the displacement in four steps.\n585: \n586: 1. **Uncapped velocity difference.** Using the triangle inequality, the Lipschitz constant $L_F$ of $F$, and the Lipschitz constant $L_u$ of $u$, we obtain\n587: \n588: $$\n589: \\begin{aligned}\n590: \\|\\tilde v-\\tilde v'\\|&\\le \\|v-v'\\|+\\frac{\\tau}{m}\\|F(x)-F(x')\\|+\\gamma_{\\mathrm{fric}}\\tau\\|v-v'\\|+\\gamma_{\\mathrm{fric}}\\tau\\|u(x)-u(x')\\|\\\\\n591: &\\le(1+\\gamma_{\\mathrm{fric}}\\tau)\\,\\|v-v'\\|+\\Big(\\frac{\\tau}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau L_u\\Big)\\,\\|x-x'\\|.\n592: \\end{aligned}\n593: \n594: $$\n595: \n596: 2. **Lipschitz projection.** Lemma {prf:ref}`lem-squashing-properties-generic` shows the smooth squashing map $\\psi_v$ is $1$-Lipschitz, so the same inequality holds for the capped velocities $v^+:=\\psi_v(\\tilde v)$ and $v'^+:=\\psi_v(\\tilde v')$.\n597: \n598: 3. **Position update.** The Euler step sets $x^+:=x+\\tau v^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ and $x'^+:=x'+\\tau v'^+ +\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Hence\n599: \n600: $$\n601: \\|x^+-x'^+\\|\\le\\|x-x'\\|+\\tau\\,\\|v^+-v'^+\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u\\Big)\\|x-x'\\|+\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)\\|v-v'\\|.\n602: \n603: $$\n604: \n605: 4. **Express via the Sasaki metric.** The Sasaki distance satisfies $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))^2=\\|x-x'\\|^2+\\lambda_v\\|v-v'\\|^2$, so $\\|x-x'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ and $\\|v-v'\\|\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}/\\sqrt{\\lambda_v}$. Substituting these bounds into the inequality from Step 3 yields\n606: \n607: $$\n608: \\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le\\Big(1+\\frac{\\tau^2}{m}L_F+\\gamma_{\\mathrm{fric}}\\tau^2L_u+\\frac{\\tau(1+\\gamma_{\\mathrm{fric}}\\tau)}{\\sqrt{\\lambda_v}}\\Big) d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v')).\n609: \n610: $$\n611: \n612: The constant in parentheses is $L_{\\mathrm{flow}}$, completing the proof."
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-boundary-holder",
      "title": "H\u00f6lder continuity of the death probability",
      "start_line": 614,
      "end_line": 731,
      "header_lines": [
        615
      ],
      "content_start": 617,
      "content_end": 730,
      "content": "617: :label: lem-euclidean-boundary-holder\n618: \n619: Referenced by {prf:ref}`thm-euclidean-feller`.\n620: \n621: ```{dropdown} Proof\n622: :::{prf:proof}\n623: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and set $\\Delta:=d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))$. Let $C$ be any compact subset of $\\mathbb R^d$ containing $x$ and $x'$, so that the local constants from Lemma {prf:ref}`lem-euclidean-geometric-consistency` apply uniformly on $C$. For independent $\\xi_v,\\xi_x\\sim\\mathcal N(0,I_d)$ define\n624: \n625: $$\n626: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\Big(v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\Big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n627: \n628: $$\n629: \n630: Lemma {prf:ref}`lem-sasaki-kinetic-lipschitz` delivers $\\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,\\Delta$ almost surely. Consequently\n631: \n632: $$\n633: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)+\\mathbb P\\big(\\Phi_{x',v'}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big).\n634: \n635: $$\n636: \n637: We bound the first term; the second is identical with primed variables.\n638: \n639: 1. **Tubular neighbourhood volume.** Because $\\partial\\mathcal X_{\\mathrm{valid}}$ is $C^1$ with bounded curvature, the tubular-neighbourhood theorem (\\[Federer 69, \u00a74.18\\]) provides $\\varepsilon_{\\mathrm{tube}}>0$ and\n640: \n641: $$\n642: C_{\\partial}:=\\sup_{0<\\varepsilon\\le\\varepsilon_{\\mathrm{tube}}}\\frac{\\operatorname{Vol}(N_\\varepsilon(\\partial\\mathcal X_{\\mathrm{valid}}))}{\\varepsilon}<\\infty.\n643: \n644: $$\n645: \n646: By monotonicity it suffices to treat $L_{\\mathrm{flow}}\\Delta\\le\\varepsilon_{\\mathrm{tube}}$; otherwise the H\u00f6lder bound follows immediately.\n647: \n648: 2. **Affine Gaussian contribution (no capping).** Introduce the uncapped velocity update\n649: \n650: $$\n651: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n652: \n653: $$\n654: \n655: Then $\\tilde x:=x+\\tau\\tilde v+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ is Gaussian with mean $x+\\tau m(x,v)$, where $m(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))$, and covariance $\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)I_d$. Its density is\n656: \n657: $$\n658: p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}\\exp\\Big(-\\frac{\\|y-(x+\\tau m(x,v))\\|^2}{2\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)}\\Big).\n659: \n660: $$\n661: \n662: The density attains its supremum at the mean, yielding\n663: \n664: $$\n665: p_{\\mathrm{aff}}:=\\sup_{y\\in\\mathbb R^d}p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}.\n666: \n667: $$\n668: \n669: This constant governs the contribution of $C^c:=\\{\\|\\tilde v\\|\\le V_{\\mathrm{alg}}\\}$, where the velocity cap is inactive.\n670: \n671: 3. **Directional density under capping.** Let $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Lemma {prf:ref}`lem-euclidean-geometric-consistency` gives $\\mathbb P(E)\\le\\rho_*(C)$. On $E$ write $\\tilde v=ru$ with $r>V_{\\mathrm{alg}}$ and $u\\in S^{d-1}$. The capped velocity is $v^+=V_{\\mathrm{alg}}u$, whose conditional density equals\n672: \n673: $$\n674: g(u)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\int_{V_{\\mathrm{alg}}}^{\\infty}\\exp\\Big(-\\frac{\\|ru-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big) r^{d-1}\\,dr.\n675: \n676: $$\n677: \n678: The local bounds on $F$ and $u$ over $C$ imply\n679: \n680: $$\n681: \\|m(x,v)\\|\\le M_{\\mathrm{kin}}(C).\n682: \n683: $$\n684: \n685: For $r\\ge V_{\\mathrm{alg}}$ the inequality $\\|a-b\\|^2\\ge\\tfrac{1}{2}\\|a\\|^2-\\|b\\|^2$ yields\n686: \n687: $$\n688: \\|ru-m(x,v)\\|^2\\ge\\frac{r^2}{2}-M_{\\mathrm{kin}}(C)^2.\n689: \n690: $$\n691: \n692: Substituting into $g(u)$ and changing variables via $s=r^2/(4\\sigma_v^2\\tau)$ produces\n693: \n694: $$\n695: g(u)\\le\\frac{\\exp(M_{\\mathrm{kin}}(C)^2/(2\\sigma_v^2\\tau))}{(2\\pi\\sigma_v^2\\tau)^{d/2}}(2\\sigma_v^2\\tau)^{d/2}\\Gamma\\Big(\\frac{d}{2},\\frac{V_{\\mathrm{alg}}^2}{4\\sigma_v^2\\tau}\\Big)=:q_{\\mathrm{dir}}(C),\n696: \n697: $$\n698: \n699: where $\\Gamma(\\cdot,\\cdot)$ is the upper incomplete gamma function. Thus the capped direction has uniformly bounded density.\n700: \n701: 4. **Probability of hitting the tube.** For any Borel $A\\subseteq\\mathcal X$ split according to $E$:\n702: \n703: $$\n704: \\begin{aligned}\n705: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\big)&=\\mathbb P(E^c)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E^c\\big)+\\mathbb P(E)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E\\big)\\\\\n706: &\\le p_{\\mathrm{aff}}\\operatorname{Vol}(A)+\\rho_*(C) q_{\\mathrm{dir}}(C)\\operatorname{Vol}(A).\n707: \\end{aligned}\n708: \n709: $$\n710: \n711: Taking $A=N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})$ and using Step 1 yields\n712: \n713: $$\n714: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)\\le\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n715: \n716: $$\n717: \n718: Combining the two probabilities shows\n719: \n720: $$\n721: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n722: \n723: $$\n724: \n725: Therefore $\\alpha_B^{\\mathrm{Sasaki}}=1$ with H\u00f6lder constant\n726: \n727: $$\n728: L_{\\mathrm{death}}^{\\mathrm{Sasaki}}(C):=2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}.\n729: \n730: $$",
      "metadata": {
        "label": "lem-euclidean-boundary-holder"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "thm-euclidean-feller",
        "lem-euclidean-geometric-consistency",
        "lem-sasaki-kinetic-lipschitz"
      ],
      "raw_directive": "614: :::\n615: \n616: :::{prf:lemma} H\u00f6lder continuity of the death probability\n617: :label: lem-euclidean-boundary-holder\n618: \n619: Referenced by {prf:ref}`thm-euclidean-feller`.\n620: \n621: ```{dropdown} Proof\n622: :::{prf:proof}\n623: Fix $(x,v),(x',v')\\in\\mathcal X\\times\\mathcal V_{\\mathrm{alg}}$ and set $\\Delta:=d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x,v),(x',v'))$. Let $C$ be any compact subset of $\\mathbb R^d$ containing $x$ and $x'$, so that the local constants from Lemma {prf:ref}`lem-euclidean-geometric-consistency` apply uniformly on $C$. For independent $\\xi_v,\\xi_x\\sim\\mathcal N(0,I_d)$ define\n624: \n625: $$\n626: \\Phi_{x,v}(\\xi_v,\\xi_x):=x+\\tau\\psi_v\\Big(v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v\\Big)+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x.\n627: \n628: $$\n629: \n630: Lemma {prf:ref}`lem-sasaki-kinetic-lipschitz` delivers $\\|\\Phi_{x,v}(\\xi_v,\\xi_x)-\\Phi_{x',v'}(\\xi_v,\\xi_x)\\|\\le L_{\\mathrm{flow}}\\,\\Delta$ almost surely. Consequently\n631: \n632: $$\n633: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)+\\mathbb P\\big(\\Phi_{x',v'}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big).\n634: \n635: $$\n636: \n637: We bound the first term; the second is identical with primed variables.\n638: \n639: 1. **Tubular neighbourhood volume.** Because $\\partial\\mathcal X_{\\mathrm{valid}}$ is $C^1$ with bounded curvature, the tubular-neighbourhood theorem (\\[Federer 69, \u00a74.18\\]) provides $\\varepsilon_{\\mathrm{tube}}>0$ and\n640: \n641: $$\n642: C_{\\partial}:=\\sup_{0<\\varepsilon\\le\\varepsilon_{\\mathrm{tube}}}\\frac{\\operatorname{Vol}(N_\\varepsilon(\\partial\\mathcal X_{\\mathrm{valid}}))}{\\varepsilon}<\\infty.\n643: \n644: $$\n645: \n646: By monotonicity it suffices to treat $L_{\\mathrm{flow}}\\Delta\\le\\varepsilon_{\\mathrm{tube}}$; otherwise the H\u00f6lder bound follows immediately.\n647: \n648: 2. **Affine Gaussian contribution (no capping).** Introduce the uncapped velocity update\n649: \n650: $$\n651: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n652: \n653: $$\n654: \n655: Then $\\tilde x:=x+\\tau\\tilde v+\\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$ is Gaussian with mean $x+\\tau m(x,v)$, where $m(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))$, and covariance $\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)I_d$. Its density is\n656: \n657: $$\n658: p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}\\exp\\Big(-\\frac{\\|y-(x+\\tau m(x,v))\\|^2}{2\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2)}\\Big).\n659: \n660: $$\n661: \n662: The density attains its supremum at the mean, yielding\n663: \n664: $$\n665: p_{\\mathrm{aff}}:=\\sup_{y\\in\\mathbb R^d}p_{\\tilde x}(y)=\\frac{1}{(2\\pi\\tau(\\sigma_v^2\\tau^2+\\sigma_x^2))^{d/2}}.\n666: \n667: $$\n668: \n669: This constant governs the contribution of $C^c:=\\{\\|\\tilde v\\|\\le V_{\\mathrm{alg}}\\}$, where the velocity cap is inactive.\n670: \n671: 3. **Directional density under capping.** Let $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Lemma {prf:ref}`lem-euclidean-geometric-consistency` gives $\\mathbb P(E)\\le\\rho_*(C)$. On $E$ write $\\tilde v=ru$ with $r>V_{\\mathrm{alg}}$ and $u\\in S^{d-1}$. The capped velocity is $v^+=V_{\\mathrm{alg}}u$, whose conditional density equals\n672: \n673: $$\n674: g(u)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\int_{V_{\\mathrm{alg}}}^{\\infty}\\exp\\Big(-\\frac{\\|ru-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big) r^{d-1}\\,dr.\n675: \n676: $$\n677: \n678: The local bounds on $F$ and $u$ over $C$ imply\n679: \n680: $$\n681: \\|m(x,v)\\|\\le M_{\\mathrm{kin}}(C).\n682: \n683: $$\n684: \n685: For $r\\ge V_{\\mathrm{alg}}$ the inequality $\\|a-b\\|^2\\ge\\tfrac{1}{2}\\|a\\|^2-\\|b\\|^2$ yields\n686: \n687: $$\n688: \\|ru-m(x,v)\\|^2\\ge\\frac{r^2}{2}-M_{\\mathrm{kin}}(C)^2.\n689: \n690: $$\n691: \n692: Substituting into $g(u)$ and changing variables via $s=r^2/(4\\sigma_v^2\\tau)$ produces\n693: \n694: $$\n695: g(u)\\le\\frac{\\exp(M_{\\mathrm{kin}}(C)^2/(2\\sigma_v^2\\tau))}{(2\\pi\\sigma_v^2\\tau)^{d/2}}(2\\sigma_v^2\\tau)^{d/2}\\Gamma\\Big(\\frac{d}{2},\\frac{V_{\\mathrm{alg}}^2}{4\\sigma_v^2\\tau}\\Big)=:q_{\\mathrm{dir}}(C),\n696: \n697: $$\n698: \n699: where $\\Gamma(\\cdot,\\cdot)$ is the upper incomplete gamma function. Thus the capped direction has uniformly bounded density.\n700: \n701: 4. **Probability of hitting the tube.** For any Borel $A\\subseteq\\mathcal X$ split according to $E$:\n702: \n703: $$\n704: \\begin{aligned}\n705: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\big)&=\\mathbb P(E^c)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E^c\\big)+\\mathbb P(E)\\,\\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in A\\mid E\\big)\\\\\n706: &\\le p_{\\mathrm{aff}}\\operatorname{Vol}(A)+\\rho_*(C) q_{\\mathrm{dir}}(C)\\operatorname{Vol}(A).\n707: \\end{aligned}\n708: \n709: $$\n710: \n711: Taking $A=N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})$ and using Step 1 yields\n712: \n713: $$\n714: \\mathbb P\\big(\\Phi_{x,v}(\\xi)\\in N_{L_{\\mathrm{flow}}\\Delta}(\\partial\\mathcal X_{\\mathrm{valid}})\\big)\\le\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n715: \n716: $$\n717: \n718: Combining the two probabilities shows\n719: \n720: $$\n721: |p_{\\mathrm{dead}}(x,v)-p_{\\mathrm{dead}}(x',v')|\\le2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}\\,\\Delta.\n722: \n723: $$\n724: \n725: Therefore $\\alpha_B^{\\mathrm{Sasaki}}=1$ with H\u00f6lder constant\n726: \n727: $$\n728: L_{\\mathrm{death}}^{\\mathrm{Sasaki}}(C):=2\\big(p_{\\mathrm{aff}}+\\rho_*(C)q_{\\mathrm{dir}}(C)\\big)C_{\\partial}L_{\\mathrm{flow}}.\n729: \n730: $$\n731: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-reward-regularity",
      "title": "Reward regularity in the Sasaki metric",
      "start_line": 738,
      "end_line": 765,
      "header_lines": [
        739
      ],
      "content_start": 741,
      "content_end": 764,
      "content": "741: :label: lem-euclidean-reward-regularity\n742: \n743: The reward function $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ is continuous on $(\\mathcal Y,d_{\\mathcal Y}^{\\mathrm{Sasaki}})$ and therefore satisfies the Axiom of Reward Regularity ({prf:ref}`def-axiom-reward-regularity`).\n744: \n745: Referenced by {prf:ref}`unlabeled-proof-1047`.\n746: \n747: ```{dropdown} Proof\n748: :::{prf:proof}\n749: Let $\\mathcal Y^{\\circ}:=B(0,R_x)\\times B(0,V_{\\mathrm{alg}})$ be the image of the projection $\\varphi:\\mathbb R^d\\times\\mathbb R^d\\to\\mathcal Y^{\\circ}$. For $y=(y_x,y_v)\\in\\mathcal Y^{\\circ}$ the inverse mapping is explicit:\n750: \n751: $$\n752: \\psi_C^{-1}(y)=\\frac{C}{1-\\|y\\|/C}\\,y\\qquad(\\|y\\|<C).\n753: \n754: $$\n755: \n756: Define $R_{\\mathcal Y}:\\mathcal Y^{\\circ}\\to\\mathbb R$ by\n757: \n758: $$\n759: R_{\\mathcal Y}(y):=R_{\\mathrm{pos}}\\big(\\psi_{R_x}^{-1}(y_x)\\big)-\\lambda_{\\mathrm{vel}}\\,\\big\\|\\psi_{V_{\\mathrm{alg}}}^{-1}(y_v)\\big\\|^2.\n760: \n761: $$\n762: \n763: This is well defined because the squashing maps are bijections between $\\mathbb R^d$ and the open balls $B(0,R_x)$ and $B(0,V_{\\mathrm{alg}})$. The maps $\\psi_{R_x}^{-1}$ and $\\psi_{V_{\\mathrm{alg}}}^{-1}$ are continuous on $\\mathcal Y^{\\circ}$, and the compositions with $R_{\\mathrm{pos}}$ and the quadratic velocity term are continuous. Hence $R_{\\mathcal Y}$ is continuous on $\\mathcal Y^{\\circ}$.\n764: ",
      "metadata": {
        "label": "lem-euclidean-reward-regularity"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-axiom-reward-regularity",
        "unlabeled-proof-1047"
      ],
      "raw_directive": "738: The ambient space ({prf:ref}`def-ambient-euclidean`) $(\\mathcal X,d_{\\mathcal X})$ remains Euclidean with Lebesgue reference measure, so the canonical density and integration arguments carry over. Because $\\mathcal X_{\\mathrm{valid}}$ is compact and $F=\\nabla R_{\\mathrm{pos}}$ is Lipschitz on this set, both $F$ and the auxiliary flow field $u$ are uniformly bounded; these bounds are the only ingredients required by the kinetic and boundary estimates recorded below.\n739: \n740: :::{prf:lemma} Reward regularity in the Sasaki metric\n741: :label: lem-euclidean-reward-regularity\n742: \n743: The reward function $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ is continuous on $(\\mathcal Y,d_{\\mathcal Y}^{\\mathrm{Sasaki}})$ and therefore satisfies the Axiom of Reward Regularity ({prf:ref}`def-axiom-reward-regularity`).\n744: \n745: Referenced by {prf:ref}`unlabeled-proof-1047`.\n746: \n747: ```{dropdown} Proof\n748: :::{prf:proof}\n749: Let $\\mathcal Y^{\\circ}:=B(0,R_x)\\times B(0,V_{\\mathrm{alg}})$ be the image of the projection $\\varphi:\\mathbb R^d\\times\\mathbb R^d\\to\\mathcal Y^{\\circ}$. For $y=(y_x,y_v)\\in\\mathcal Y^{\\circ}$ the inverse mapping is explicit:\n750: \n751: $$\n752: \\psi_C^{-1}(y)=\\frac{C}{1-\\|y\\|/C}\\,y\\qquad(\\|y\\|<C).\n753: \n754: $$\n755: \n756: Define $R_{\\mathcal Y}:\\mathcal Y^{\\circ}\\to\\mathbb R$ by\n757: \n758: $$\n759: R_{\\mathcal Y}(y):=R_{\\mathrm{pos}}\\big(\\psi_{R_x}^{-1}(y_x)\\big)-\\lambda_{\\mathrm{vel}}\\,\\big\\|\\psi_{V_{\\mathrm{alg}}}^{-1}(y_v)\\big\\|^2.\n760: \n761: $$\n762: \n763: This is well defined because the squashing maps are bijections between $\\mathbb R^d$ and the open balls $B(0,R_x)$ and $B(0,V_{\\mathrm{alg}})$. The maps $\\psi_{R_x}^{-1}$ and $\\psi_{V_{\\mathrm{alg}}}^{-1}$ are continuous on $\\mathcal Y^{\\circ}$, and the compositions with $R_{\\mathrm{pos}}$ and the quadratic velocity term are continuous. Hence $R_{\\mathcal Y}$ is continuous on $\\mathcal Y^{\\circ}$.\n764: \n765: Because $R_{\\mathcal Y}$ is continuous on $\\mathcal Y^{\\circ}$ and $\\mathcal Y^{\\circ}$ is bounded, the restriction of $R_{\\mathcal Y}$ to any compact subset of $\\mathcal Y^{\\circ}$ is uniformly continuous. In particular, the walker positions belong to the compact valid domain $\\mathcal X_{\\mathrm{valid}}$, so the image $\\varphi(\\mathcal X_{\\mathrm{valid}}\\times\\mathcal V_{\\mathrm{alg}})$ is compact and $R_{\\mathcal Y}$ is uniformly continuous (indeed, Lipschitz) on that set. Consequently the reward evaluated along the Sasaki projection is uniformly continuous, satisfying the reward-regularity axiom without invoking a global Lipschitz bound for $R_{\\mathrm{pos}}$ on $\\mathbb R^d$. :::"
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-richness",
      "title": "Environmental richness with a kinetic regularizer",
      "start_line": 767,
      "end_line": 794,
      "header_lines": [
        768
      ],
      "content_start": 770,
      "content_end": 793,
      "content": "770: :label: lem-euclidean-richness\n771: \n772: The reward $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ with $\\lambda_{\\mathrm{vel}}>0$ satisfies the Axiom of Environmental Richness ({prf:ref}`def-axiom-environmental-richness`).\n773: \n774: ```{dropdown} Proof\n775: :::{prf:proof}\n776: Fix $(x_0,v_0)\\in\\mathcal Y$ and radius $r>0$. Every Sasaki ball of radius $r$ contains the set of velocities with Euclidean norm at most $r/\\sqrt{\\lambda_v}$ around $v_0$. Let\n777: \n778: $$\n779: \\delta:=\\min\\Big\\{\\frac{r}{\\sqrt{\\lambda_v}},\\,\\frac{V_{\\mathrm{alg}}}{2}\\Big\\}>0.\n780: \n781: $$\n782: Consider the two velocities $v_1:=v_0$ and $v_2:=v_0+\\delta e$, where the direction $e$ is chosen as follows:\n783: \n784: 1. If $\\|v_0\\|\\le V_{\\mathrm{alg}}-\\delta$, take $e$ orthogonal to $v_0$. Then $\\|v_2\\|^2=\\|v_0\\|^2+\\delta^2\\le V_{\\mathrm{alg}}^2$, so $v_2\\in\\mathcal V_{\\mathrm{alg}}$ and $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x_0,v_0),(x_0,v_2))=\\sqrt{\\lambda_v}\\,\\delta\\le r$.\n785: 2. If $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta$, set $e:=-v_0/\\|v_0\\|$ (if $v_0=0$, pick any unit vector). The new velocity has norm $\\|v_0\\| - \\delta\\le V_{\\mathrm{alg}}$ and again lies within the Sasaki ball.\n786: \n787: In both cases the velocities stay in the ball, and the reward difference equals\n788: \n789: $$\n790: |R(x_0,v_1)-R(x_0,v_2)|=\\lambda_{\\mathrm{vel}}\\,|\\|v_2\\|^2-\\|v_0\\|^2|\\ge \\lambda_{\\mathrm{vel}}\\,\\delta^2.\n791: \n792: $$\n793: For the inward-pointing choice we use that $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta\\ge V_{\\mathrm{alg}}/2\\ge\\delta$ because $\\delta\\le V_{\\mathrm{alg}}/2$, guaranteeing the same lower bound.",
      "metadata": {
        "label": "lem-euclidean-richness"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-axiom-environmental-richness"
      ],
      "raw_directive": "767: :::\n768: \n769: :::{prf:lemma} Environmental richness with a kinetic regularizer\n770: :label: lem-euclidean-richness\n771: \n772: The reward $R(x,v)=R_{\\mathrm{pos}}(x)-\\lambda_{\\mathrm{vel}}\\|v\\|^2$ with $\\lambda_{\\mathrm{vel}}>0$ satisfies the Axiom of Environmental Richness ({prf:ref}`def-axiom-environmental-richness`).\n773: \n774: ```{dropdown} Proof\n775: :::{prf:proof}\n776: Fix $(x_0,v_0)\\in\\mathcal Y$ and radius $r>0$. Every Sasaki ball of radius $r$ contains the set of velocities with Euclidean norm at most $r/\\sqrt{\\lambda_v}$ around $v_0$. Let\n777: \n778: $$\n779: \\delta:=\\min\\Big\\{\\frac{r}{\\sqrt{\\lambda_v}},\\,\\frac{V_{\\mathrm{alg}}}{2}\\Big\\}>0.\n780: \n781: $$\n782: Consider the two velocities $v_1:=v_0$ and $v_2:=v_0+\\delta e$, where the direction $e$ is chosen as follows:\n783: \n784: 1. If $\\|v_0\\|\\le V_{\\mathrm{alg}}-\\delta$, take $e$ orthogonal to $v_0$. Then $\\|v_2\\|^2=\\|v_0\\|^2+\\delta^2\\le V_{\\mathrm{alg}}^2$, so $v_2\\in\\mathcal V_{\\mathrm{alg}}$ and $d_{\\mathcal Y}^{\\mathrm{Sasaki}}((x_0,v_0),(x_0,v_2))=\\sqrt{\\lambda_v}\\,\\delta\\le r$.\n785: 2. If $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta$, set $e:=-v_0/\\|v_0\\|$ (if $v_0=0$, pick any unit vector). The new velocity has norm $\\|v_0\\| - \\delta\\le V_{\\mathrm{alg}}$ and again lies within the Sasaki ball.\n786: \n787: In both cases the velocities stay in the ball, and the reward difference equals\n788: \n789: $$\n790: |R(x_0,v_1)-R(x_0,v_2)|=\\lambda_{\\mathrm{vel}}\\,|\\|v_2\\|^2-\\|v_0\\|^2|\\ge \\lambda_{\\mathrm{vel}}\\,\\delta^2.\n791: \n792: $$\n793: For the inward-pointing choice we use that $\\|v_0\\|>V_{\\mathrm{alg}}-\\delta\\ge V_{\\mathrm{alg}}/2\\ge\\delta$ because $\\delta\\le V_{\\mathrm{alg}}/2$, guaranteeing the same lower bound.\n794: Hence the variance of $R$ on the ball is at least $\\sigma_{\\mathrm{rich}}^2(r):=\\lambda_{\\mathrm{vel}}^2\\delta^4/4>0$, establishing environmental richness. :::"
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-perturb-moment",
      "title": "Perturbation second moment in the Sasaki metric",
      "start_line": 807,
      "end_line": 897,
      "header_lines": [
        808
      ],
      "content_start": 810,
      "content_end": 896,
      "content": "810: :label: lem-euclidean-perturb-moment\n811: \n812: Referenced by {prf:ref}`thm-euclidean-feller`.\n813: \n814: ```{dropdown} Proof\n815: :::{prf:proof}\n816: Introduce the uncapped velocity update\n817: \n818: $$\n819: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad \\xi_v\\sim\\mathcal N(0,I_d).\n820: \n821: $$\n822: \n823: Write $a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)$. {ref}`Stage 4 <sec-eg-stage4>` applies the cap and Euler step to obtain\n824: \n825: $$\n826: v^+:=\\psi_v(\\tilde v),\\qquad x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x,\n827: \n828: $$\n829: \n830: with $\\xi_x\\sim\\mathcal N(0,I_d)$ independent of $\\xi_v$.\n831: \n832: We bound the expected Sasaki increment in three explicit steps.\n833: \n834: 1. **Positional increment.** The cap guarantees $\\|v^+\\|\\le V_{\\mathrm{alg}}$. Hence\n835: \n836: $$\n837: \\|x^+-x\\|\\le\\tau\\,\\|v^+\\|+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|\\le\\tau V_{\\mathrm{alg}}+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|,\n838: \n839: $$\n840: \n841: so $\\mathbb E\\big[\\|x^+-x\\|^2\\big]\\le 2\\tau^2 V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d$.\n842: \n843: 2. **Velocity increment.** Lemma {prf:ref}`lem-squashing-properties-generic` gives $\\|v^+-v\\|\\le\\|\\tilde v-v\\|$. The random increment decomposes as\n844: \n845: $$\n846: \\tilde v-v=a(x,v)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n847: \n848: $$\n849: \n850: Let $F_0:=\\|F(0)\\|$ and $u_0:=\\|u(0)\\|$. The Lipschitz bounds $\\|F(x)\\|\\le F_0+L_F\\|x\\|$ and $\\|u(x)\\|\\le u_0+L_u\\|x\\|$ imply\n851: \n852: $$\n853: \\|a(x,v)\\|\\le\\frac{\\tau}{m}\\big(F_0+L_F\\|x\\|\\big)+\\gamma_{\\mathrm{fric}}\\tau\\Big(\\|v\\|+u_0+L_u\\|x\\|\\Big).\n854: \n855: $$\n856: \n857: Define the coefficients\n858: \n859: $$\n860: A_x:=\\tau\\Big(\\frac{L_F}{m}+\\gamma_{\\mathrm{fric}}L_u\\Big),\\qquad A_v:=\\gamma_{\\mathrm{fric}}\\tau,\\qquad A_0:=\\frac{\\tau}{m}F_0+\\gamma_{\\mathrm{fric}}\\tau u_0.\n861: \n862: $$\n863: \n864: Then $\\|a(x,v)\\|\\le A_x\\|x\\|+A_v\\|v\\|+A_0$. Using $\\mathbb E\\|\\xi_v\\|^2=d$ and $(\\alpha+\\beta+\\gamma)^2\\le 3(\\alpha^2+\\beta^2+\\gamma^2)$ gives\n865: \n866: $$\n867: \\mathbb E\\big[\\|\\tilde v-v\\|^2\\big]\\le 3A_x^2\\|x\\|^2+3A_v^2\\|v\\|^2+3A_0^2+\\sigma_v^2\\tau d.\n868: \n869: $$\n870: \n871: 3. **Assemble the Sasaki moment.** By definition of the Sasaki metric,\n872: \n873: $$\n874: d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2=\\|x^+-x\\|^2+\\lambda_v\\,\\|v^+-v\\|^2.\n875: \n876: $$\n877: \n878: Taking expectations and combining the bounds from Steps 1\u20132 yields\n879: \n880: $$\n881: \\mathbb E\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2\\big]\\le C_x^{(\\mathrm{pert})}\\,\\|x\\|^2+C_v^{(\\mathrm{pert})}\\,\\|v\\|^2+C_0^{(\\mathrm{pert})},\n882: \n883: $$\n884: \n885: with\n886: \n887: $$\n888: \\begin{aligned}\n889: C_x^{(\\mathrm{pert})}&:=3\\lambda_vA_x^2,\\\\\n890: C_v^{(\\mathrm{pert})}&:=3\\lambda_vA_v^2,\\\\\n891: C_0^{(\\mathrm{pert})}&:=2\\tau^2V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d+3\\lambda_vA_0^2+\\lambda_v\\sigma_v^2\\tau d.\n892: \\end{aligned}\n893: \n894: $$\n895: \n896: The kinetic kernel is Feller: it composes the continuous affine map $(x,v)\\mapsto(x,\\tilde v)$, the 1-Lipschitz projection $\\psi_v$, and addition of a Gaussian with full support; appending the deterministic status update preserves this property.",
      "metadata": {
        "label": "lem-euclidean-perturb-moment"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "thm-euclidean-feller",
        "sec-eg-stage4",
        "lem-squashing-properties-generic"
      ],
      "raw_directive": "807: :::\n808: \n809: :::{prf:lemma} Perturbation second moment in the Sasaki metric\n810: :label: lem-euclidean-perturb-moment\n811: \n812: Referenced by {prf:ref}`thm-euclidean-feller`.\n813: \n814: ```{dropdown} Proof\n815: :::{prf:proof}\n816: Introduce the uncapped velocity update\n817: \n818: $$\n819: \\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v,\\qquad \\xi_v\\sim\\mathcal N(0,I_d).\n820: \n821: $$\n822: \n823: Write $a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)$. {ref}`Stage 4 <sec-eg-stage4>` applies the cap and Euler step to obtain\n824: \n825: $$\n826: v^+:=\\psi_v(\\tilde v),\\qquad x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x,\n827: \n828: $$\n829: \n830: with $\\xi_x\\sim\\mathcal N(0,I_d)$ independent of $\\xi_v$.\n831: \n832: We bound the expected Sasaki increment in three explicit steps.\n833: \n834: 1. **Positional increment.** The cap guarantees $\\|v^+\\|\\le V_{\\mathrm{alg}}$. Hence\n835: \n836: $$\n837: \\|x^+-x\\|\\le\\tau\\,\\|v^+\\|+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|\\le\\tau V_{\\mathrm{alg}}+\\sqrt{\\tau}\\,\\sigma_x\\,\\|\\xi_x\\|,\n838: \n839: $$\n840: \n841: so $\\mathbb E\\big[\\|x^+-x\\|^2\\big]\\le 2\\tau^2 V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d$.\n842: \n843: 2. **Velocity increment.** Lemma {prf:ref}`lem-squashing-properties-generic` gives $\\|v^+-v\\|\\le\\|\\tilde v-v\\|$. The random increment decomposes as\n844: \n845: $$\n846: \\tilde v-v=a(x,v)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v.\n847: \n848: $$\n849: \n850: Let $F_0:=\\|F(0)\\|$ and $u_0:=\\|u(0)\\|$. The Lipschitz bounds $\\|F(x)\\|\\le F_0+L_F\\|x\\|$ and $\\|u(x)\\|\\le u_0+L_u\\|x\\|$ imply\n851: \n852: $$\n853: \\|a(x,v)\\|\\le\\frac{\\tau}{m}\\big(F_0+L_F\\|x\\|\\big)+\\gamma_{\\mathrm{fric}}\\tau\\Big(\\|v\\|+u_0+L_u\\|x\\|\\Big).\n854: \n855: $$\n856: \n857: Define the coefficients\n858: \n859: $$\n860: A_x:=\\tau\\Big(\\frac{L_F}{m}+\\gamma_{\\mathrm{fric}}L_u\\Big),\\qquad A_v:=\\gamma_{\\mathrm{fric}}\\tau,\\qquad A_0:=\\frac{\\tau}{m}F_0+\\gamma_{\\mathrm{fric}}\\tau u_0.\n861: \n862: $$\n863: \n864: Then $\\|a(x,v)\\|\\le A_x\\|x\\|+A_v\\|v\\|+A_0$. Using $\\mathbb E\\|\\xi_v\\|^2=d$ and $(\\alpha+\\beta+\\gamma)^2\\le 3(\\alpha^2+\\beta^2+\\gamma^2)$ gives\n865: \n866: $$\n867: \\mathbb E\\big[\\|\\tilde v-v\\|^2\\big]\\le 3A_x^2\\|x\\|^2+3A_v^2\\|v\\|^2+3A_0^2+\\sigma_v^2\\tau d.\n868: \n869: $$\n870: \n871: 3. **Assemble the Sasaki moment.** By definition of the Sasaki metric,\n872: \n873: $$\n874: d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2=\\|x^+-x\\|^2+\\lambda_v\\,\\|v^+-v\\|^2.\n875: \n876: $$\n877: \n878: Taking expectations and combining the bounds from Steps 1\u20132 yields\n879: \n880: $$\n881: \\mathbb E\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}\\big((x,v),(x^+,v^+)\\big)^2\\big]\\le C_x^{(\\mathrm{pert})}\\,\\|x\\|^2+C_v^{(\\mathrm{pert})}\\,\\|v\\|^2+C_0^{(\\mathrm{pert})},\n882: \n883: $$\n884: \n885: with\n886: \n887: $$\n888: \\begin{aligned}\n889: C_x^{(\\mathrm{pert})}&:=3\\lambda_vA_x^2,\\\\\n890: C_v^{(\\mathrm{pert})}&:=3\\lambda_vA_v^2,\\\\\n891: C_0^{(\\mathrm{pert})}&:=2\\tau^2V_{\\mathrm{alg}}^2+2\\tau\\sigma_x^2 d+3\\lambda_vA_0^2+\\lambda_v\\sigma_v^2\\tau d.\n892: \\end{aligned}\n893: \n894: $$\n895: \n896: The kinetic kernel is Feller: it composes the continuous affine map $(x,v)\\mapsto(x,\\tilde v)$, the 1-Lipschitz projection $\\psi_v$, and addition of a Gaussian with full support; appending the deterministic status update preserves this property.\n897: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-euclidean-geometric-consistency",
      "title": "Geometric consistency under the capped kinetic kernel",
      "start_line": 900,
      "end_line": 1035,
      "header_lines": [
        901
      ],
      "content_start": 903,
      "content_end": 1034,
      "content": "903: :label: lem-euclidean-geometric-consistency\n904: \n905: Referenced by {prf:ref}`lem-euclidean-boundary-holder`.\n906: \n907: ```{dropdown} Proof\n908: :::{prf:proof}\n909: Because $\\mathcal X_{\\mathrm{valid}}$ is compact and $F$ and $u$ are continuous, the drift and anisotropy envelopes appearing in the Axiom of Geometric Consistency admit finite global bounds. To make the dependence on the geometry explicit we index the constants by an arbitrary compact subset $C \\subset \\mathcal X_{\\mathrm{valid}}`; in practice we take $C = \\mathcal X_{\\mathrm{valid}}` and obtain uniform constants on the entire valid domain.\n910: \n911: Let $C\\subset\\mathbb R^d$ be an arbitrary compact set and define the local envelopes\n912: \n913: $$\n914: F_C:=\\sup_{x\\in C}\\|F(x)\\|,\\qquad u_C:=\\sup_{x\\in C}\\|u(x)\\|,\n915: \n916: $$\n917: \n918: which are finite by continuity. Set\n919: \n920: $$\n921: C_{\\mathrm{force}}(C):=\\frac{F_C}{m}+\\gamma_{\\mathrm{fric}}\\big(V_{\\mathrm{alg}}+u_C\\big),\\qquad M_{\\mathrm{kin}}(C):=V_{\\mathrm{alg}}+\\frac{\\tau}{m}F_C+\\gamma_{\\mathrm{fric}}\\tau\\big(V_{\\mathrm{alg}}+u_C\\big).\n922: \n923: $$\n924: \n925: Let $\\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v$ with $\\xi_v\\sim\\mathcal N(0,I_d)$ and set $v^+:=\\psi_v(\\tilde v)$, $x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Denote\n926: \n927: $$\n928: a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big).\n929: \n930: $$\n931: \n932: We supply explicit constants for the drift and anisotropy parts of Definition {prf:ref}`def-axiom-geometric-consistency`.\n933: \n934: 1. **Drift of the mean displacement.** Because $\\|v\\|\\le V_{\\mathrm{alg}}$ we have\n935: \n936: $$\n937: \\|\\mathbb E[x^+-x]\\|=\\tau\\,\\|\\mathbb E[v^+]\\|\\le\\tau\\big(\\|\\mathbb E[v^+-v]\\|+V_{\\mathrm{alg}}\\big).\n938: \n939: $$\n940: \n941: The increment of the velocity splits as\n942: \n943: $$\n944: \\mathbb E[v^+-v]=\\mathbb E[\\tilde v-v]+\\mathbb E[\\psi_v(\\tilde v)-\\tilde v].\n945: \n946: $$\n947: \n948: The affine term obeys $\\|\\mathbb E[\\tilde v-v]\\|=\\|a(x,v)\\|\\le\\tau C_{\\mathrm{force}}(C)$. The projection error equals $(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+$ and is supported on the capping event $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Markov's inequality applied to\n949: \n950: $$\n951: \\mathbb E\\|\\tilde v\\|^2=\\|a(x,v)\\|^2+\\sigma_v^2\\tau\\,\\mathbb E\\|\\xi\\|^2\\le(\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d+V_{\\mathrm{alg}}^2\n952: \n953: $$\n954: \n955: then yields\n956: \n957: $$\n958: \\mathbb E[(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+]\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d-V_{\\mathrm{alg}}^2}{V_{\\mathrm{alg}}}=:\\varepsilon_{\\mathrm{cap}}^{\\max}(C).\n959: \n960: $$\n961: \n962: Thus $\\|\\mathbb E[v^+-v]\\|\\le\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)$ and\n963: \n964: $$\n965: \\|\\mathbb E[x^+-x]\\|\\le\\tau\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big).\n966: \n967: $$\n968: \n969: Combining the position and velocity components gives\n970: \n971: $$\n972: \\kappa_{\\mathrm{drift}}^{\\mathrm{Sasaki}}(C):=\\sqrt{\\tau^2\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big)^2+\\lambda_v\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)\\big)^2}.\n973: \n974: $$\n975: \n976: 2. **Probability of capping.** The same second-moment estimate implies\n977: \n978: $$\n979: \\rho_*(C):=\\mathbb P(E)\\le\\frac{\\mathbb E\\|\\tilde v\\|^2}{V_{\\mathrm{alg}}^2}\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d}{V_{\\mathrm{alg}}^2}.\n980: \n981: $$\n982: \n983: 3. **Lower bound on the uncapped density.** The mean of $\\tilde v$ satisfies\n984: \n985: $$\n986: \\|m(x,v)\\|=\\Big\\|v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))\\Big\\|\\le M_{\\mathrm{kin}}(C).\n987: \n988: $$\n989: \n990: The Gaussian density of $\\tilde v$ is\n991: \n992: $$\n993: p_{\\tilde v}(y)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{\\|y-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big).\n994: \n995: $$\n996: \n997: For $u\\in S^{d-1}$ and $0\\le r\\le V_{\\mathrm{alg}}/2$ the inequality $\\|a-b\\|^2\\le 2\\|a\\|^2+2\\|b\\|^2$ yields\n998: \n999: $$\n1000: \\|ru-m(x,v)\\|^2\\le\\Big(\\frac{V_{\\mathrm{alg}}}{2}+M_{\\mathrm{kin}}(C)\\Big)^2.\n1001: \n1002: $$\n1003: \n1004: Hence $p_{\\tilde v}(ru)\\ge c_{d,0}$ where\n1005: \n1006: $$\n1007: c_{d,0}(C):=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{(V_{\\mathrm{alg}}/2+M_{\\mathrm{kin}}(C))^2}{2\\sigma_v^2\\tau}\\Big)>0.\n1008: \n1009: $$\n1010: \n1011: Integrating over the radial segment $[0,V_{\\mathrm{alg}}/2]$ yields\n1012: \n1013: $$\n1014: P(\\tilde v\\in K(u))\\ge c_{d,0}(C)\\int_{0}^{V_{\\mathrm{alg}}/2} r^{d-1}\\,dr=:c_d(C)>0,\n1015: \n1016: $$\n1017: \n1018: where $K(u):=\\{ru:0\\le r\\le V_{\\mathrm{alg}}/2\\}$ and we used the polar-volume factor $r^{d-1}$. Thus every cone with opening direction $u$ receives probability at least $c_d(C)$.\n1019: \n1020: 4. **Pushforward through the cap.** On $E^c$ the cap is inactive and $v^+=\\tilde v$, so the lower bound from Step 3 applies. On $E$ the map $\\psi_v$ replaces the radial component by $V_{\\mathrm{alg}}$ while leaving the direction $u$ unchanged, whence the directional distribution of $v^+$ dominates $(1-\\rho_*(C))c_d(C)$ times the surface measure $\\sigma_{d-1}$ on $S^{d-1}$. Equivalently, for every measurable $A\\subseteq S^{d-1}$\n1021: \n1022: $$\n1023: P(v^+\\in A)\\ge(1-\\rho_*(C))c_d(C)\\,\\sigma_{d-1}(A).\n1024: \n1025: $$\n1026: \n1027: Taking reciprocals furnishes the anisotropy constant\n1028: \n1029: $$\n1030: \\kappa_{\\mathrm{anisotropy}}^{\\mathrm{Sasaki}}(C):=\\frac{1}{(1-\\rho_*(C))c_d(C)}.\n1031: \n1032: $$\n1033: \n1034: These constants realise the drift and anisotropy requirements of Definition {prf:ref}`def-axiom-geometric-consistency` on the compact set $C$. Since $C$ was arbitrary, the bounds hold uniformly on every compact subset of the state space, which suffices for the non-compact geometric-consistency axiom.",
      "metadata": {
        "label": "lem-euclidean-geometric-consistency"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-euclidean-boundary-holder",
        "def-axiom-geometric-consistency"
      ],
      "raw_directive": "900: 2. **Geometric consistency constants.** Lemma {prf:ref}`lem-euclidean-geometric-consistency` bounds the drift and anisotropy parameters in the Sasaki geometry.\n901: \n902: :::{prf:lemma} Geometric consistency under the capped kinetic kernel\n903: :label: lem-euclidean-geometric-consistency\n904: \n905: Referenced by {prf:ref}`lem-euclidean-boundary-holder`.\n906: \n907: ```{dropdown} Proof\n908: :::{prf:proof}\n909: Because $\\mathcal X_{\\mathrm{valid}}$ is compact and $F$ and $u$ are continuous, the drift and anisotropy envelopes appearing in the Axiom of Geometric Consistency admit finite global bounds. To make the dependence on the geometry explicit we index the constants by an arbitrary compact subset $C \\subset \\mathcal X_{\\mathrm{valid}}`; in practice we take $C = \\mathcal X_{\\mathrm{valid}}` and obtain uniform constants on the entire valid domain.\n910: \n911: Let $C\\subset\\mathbb R^d$ be an arbitrary compact set and define the local envelopes\n912: \n913: $$\n914: F_C:=\\sup_{x\\in C}\\|F(x)\\|,\\qquad u_C:=\\sup_{x\\in C}\\|u(x)\\|,\n915: \n916: $$\n917: \n918: which are finite by continuity. Set\n919: \n920: $$\n921: C_{\\mathrm{force}}(C):=\\frac{F_C}{m}+\\gamma_{\\mathrm{fric}}\\big(V_{\\mathrm{alg}}+u_C\\big),\\qquad M_{\\mathrm{kin}}(C):=V_{\\mathrm{alg}}+\\frac{\\tau}{m}F_C+\\gamma_{\\mathrm{fric}}\\tau\\big(V_{\\mathrm{alg}}+u_C\\big).\n922: \n923: $$\n924: \n925: Let $\\tilde v:=v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big)+\\sqrt{\\sigma_v^2\\tau}\\,\\xi_v$ with $\\xi_v\\sim\\mathcal N(0,I_d)$ and set $v^+:=\\psi_v(\\tilde v)$, $x^+:=x+\\tau v^+ + \\sqrt{\\tau}\\,\\sigma_x\\,\\xi_x$. Denote\n926: \n927: $$\n928: a(x,v):=\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau\\big(v-u(x)\\big).\n929: \n930: $$\n931: \n932: We supply explicit constants for the drift and anisotropy parts of Definition {prf:ref}`def-axiom-geometric-consistency`.\n933: \n934: 1. **Drift of the mean displacement.** Because $\\|v\\|\\le V_{\\mathrm{alg}}$ we have\n935: \n936: $$\n937: \\|\\mathbb E[x^+-x]\\|=\\tau\\,\\|\\mathbb E[v^+]\\|\\le\\tau\\big(\\|\\mathbb E[v^+-v]\\|+V_{\\mathrm{alg}}\\big).\n938: \n939: $$\n940: \n941: The increment of the velocity splits as\n942: \n943: $$\n944: \\mathbb E[v^+-v]=\\mathbb E[\\tilde v-v]+\\mathbb E[\\psi_v(\\tilde v)-\\tilde v].\n945: \n946: $$\n947: \n948: The affine term obeys $\\|\\mathbb E[\\tilde v-v]\\|=\\|a(x,v)\\|\\le\\tau C_{\\mathrm{force}}(C)$. The projection error equals $(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+$ and is supported on the capping event $E:=\\{\\|\\tilde v\\|>V_{\\mathrm{alg}}\\}$. Markov's inequality applied to\n949: \n950: $$\n951: \\mathbb E\\|\\tilde v\\|^2=\\|a(x,v)\\|^2+\\sigma_v^2\\tau\\,\\mathbb E\\|\\xi\\|^2\\le(\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d+V_{\\mathrm{alg}}^2\n952: \n953: $$\n954: \n955: then yields\n956: \n957: $$\n958: \\mathbb E[(\\|\\tilde v\\|-V_{\\mathrm{alg}})_+]\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d-V_{\\mathrm{alg}}^2}{V_{\\mathrm{alg}}}=:\\varepsilon_{\\mathrm{cap}}^{\\max}(C).\n959: \n960: $$\n961: \n962: Thus $\\|\\mathbb E[v^+-v]\\|\\le\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)$ and\n963: \n964: $$\n965: \\|\\mathbb E[x^+-x]\\|\\le\\tau\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big).\n966: \n967: $$\n968: \n969: Combining the position and velocity components gives\n970: \n971: $$\n972: \\kappa_{\\mathrm{drift}}^{\\mathrm{Sasaki}}(C):=\\sqrt{\\tau^2\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)+V_{\\mathrm{alg}}\\big)^2+\\lambda_v\\big(\\tau C_{\\mathrm{force}}(C)+\\varepsilon_{\\mathrm{cap}}^{\\max}(C)\\big)^2}.\n973: \n974: $$\n975: \n976: 2. **Probability of capping.** The same second-moment estimate implies\n977: \n978: $$\n979: \\rho_*(C):=\\mathbb P(E)\\le\\frac{\\mathbb E\\|\\tilde v\\|^2}{V_{\\mathrm{alg}}^2}\\le\\frac{(V_{\\mathrm{alg}}+\\tau C_{\\mathrm{force}}(C))^2+\\sigma_v^2\\tau d}{V_{\\mathrm{alg}}^2}.\n980: \n981: $$\n982: \n983: 3. **Lower bound on the uncapped density.** The mean of $\\tilde v$ satisfies\n984: \n985: $$\n986: \\|m(x,v)\\|=\\Big\\|v+\\frac{\\tau}{m}F(x)-\\gamma_{\\mathrm{fric}}\\tau(v-u(x))\\Big\\|\\le M_{\\mathrm{kin}}(C).\n987: \n988: $$\n989: \n990: The Gaussian density of $\\tilde v$ is\n991: \n992: $$\n993: p_{\\tilde v}(y)=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{\\|y-m(x,v)\\|^2}{2\\sigma_v^2\\tau}\\Big).\n994: \n995: $$\n996: \n997: For $u\\in S^{d-1}$ and $0\\le r\\le V_{\\mathrm{alg}}/2$ the inequality $\\|a-b\\|^2\\le 2\\|a\\|^2+2\\|b\\|^2$ yields\n998: \n999: $$\n1000: \\|ru-m(x,v)\\|^2\\le\\Big(\\frac{V_{\\mathrm{alg}}}{2}+M_{\\mathrm{kin}}(C)\\Big)^2.\n1001: \n1002: $$\n1003: \n1004: Hence $p_{\\tilde v}(ru)\\ge c_{d,0}$ where\n1005: \n1006: $$\n1007: c_{d,0}(C):=\\frac{1}{(2\\pi\\sigma_v^2\\tau)^{d/2}}\\exp\\Big(-\\frac{(V_{\\mathrm{alg}}/2+M_{\\mathrm{kin}}(C))^2}{2\\sigma_v^2\\tau}\\Big)>0.\n1008: \n1009: $$\n1010: \n1011: Integrating over the radial segment $[0,V_{\\mathrm{alg}}/2]$ yields\n1012: \n1013: $$\n1014: P(\\tilde v\\in K(u))\\ge c_{d,0}(C)\\int_{0}^{V_{\\mathrm{alg}}/2} r^{d-1}\\,dr=:c_d(C)>0,\n1015: \n1016: $$\n1017: \n1018: where $K(u):=\\{ru:0\\le r\\le V_{\\mathrm{alg}}/2\\}$ and we used the polar-volume factor $r^{d-1}$. Thus every cone with opening direction $u$ receives probability at least $c_d(C)$.\n1019: \n1020: 4. **Pushforward through the cap.** On $E^c$ the cap is inactive and $v^+=\\tilde v$, so the lower bound from Step 3 applies. On $E$ the map $\\psi_v$ replaces the radial component by $V_{\\mathrm{alg}}$ while leaving the direction $u$ unchanged, whence the directional distribution of $v^+$ dominates $(1-\\rho_*(C))c_d(C)$ times the surface measure $\\sigma_{d-1}$ on $S^{d-1}$. Equivalently, for every measurable $A\\subseteq S^{d-1}$\n1021: \n1022: $$\n1023: P(v^+\\in A)\\ge(1-\\rho_*(C))c_d(C)\\,\\sigma_{d-1}(A).\n1024: \n1025: $$\n1026: \n1027: Taking reciprocals furnishes the anisotropy constant\n1028: \n1029: $$\n1030: \\kappa_{\\mathrm{anisotropy}}^{\\mathrm{Sasaki}}(C):=\\frac{1}{(1-\\rho_*(C))c_d(C)}.\n1031: \n1032: $$\n1033: \n1034: These constants realise the drift and anisotropy requirements of Definition {prf:ref}`def-axiom-geometric-consistency` on the compact set $C$. Since $C$ was arbitrary, the bounds hold uniformly on every compact subset of the state space, which suffices for the non-compact geometric-consistency axiom.\n1035: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-single-walker-positional-error",
      "title": "Single-walker positional error bound in the Sasaki metric",
      "start_line": 1066,
      "end_line": 1120,
      "header_lines": [
        1067
      ],
      "content_start": 1069,
      "content_end": 1119,
      "content": "1069: :label: lem-sasaki-single-walker-positional-error\n1070: \n1071: Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. For a given walker $i$ that is alive in swarm $\\mathcal S_1$ ($s_{1,i}=1$), let $\\mathbb C_i(\\mathcal S_1)$ be its companion selection measure.\n1072: \n1073: The absolute error in its expected distance due to the positional displacement of the walkers between the two states, evaluated over the fixed companion set from $\\mathcal S_1$, is bounded by the sum of its own displacement and the average displacement of its potential companions.\n1074: \n1075: Referenced by {prf:ref}`lem-sasaki-total-squared-error-stable` and {prf:ref}`thm-euclidean-feller`.\n1076: \n1077: $$\n1078: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1079: \n1080: $$\n1081: \n1082: ```{dropdown} Proof\n1083: :::{prf:proof}\n1084: Let $\\Delta_{\\mathrm{pos},i}$ denote the absolute error term we wish to bound. The proof proceeds by applying standard metric and probability inequalities.\n1085: \n1086: **Step 1: Apply Linearity of Expectation.**\n1087: We combine the two terms into a single expectation over the fixed companion selection measure $\\mathbb C_i(\\mathcal S_1)$.\n1088: \n1089: $$\n1090: \\Delta_{\\mathrm{pos},i} = \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right|\n1091: \n1092: $$\n1093: \n1094: **Step 2: Apply Jensen's Inequality.**\n1095: Using Jensen's inequality for the convex function $f(x)=|x|$, we can move the absolute value inside the expectation, which provides an upper bound:\n1096: \n1097: $$\n1098: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\right]\n1099: \n1100: $$\n1101: \n1102: **Step 3: Apply the Reverse Triangle Inequality.**\n1103: The term inside the expectation is the absolute difference between two distance values. For any points $a,b,c,d$ in a metric space $(M,d)$, the reverse triangle inequality states that $|d(a,b) - d(c,d)| \\le d(a,c) + d(b,d)$. Applying this to the Sasaki metric $d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ yields:\n1104: \n1105: $$\n1106: \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c}))\n1107: \n1108: $$\n1109: \n1110: **Step 4: Finalize the Bound.**\n1111: We substitute the inequality from Step 3 back into the expression from Step 2.\n1112: \n1113: $$\n1114: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1115: \n1116: $$\n1117: \n1118: By linearity of expectation, we can separate the terms. The first term, $d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i}))$, is a constant with respect to the expectation over the companion index $c$. This gives the final bound as stated in the lemma.\n1119: ",
      "metadata": {
        "label": "lem-sasaki-single-walker-positional-error"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-sasaki-total-squared-error-stable",
        "thm-euclidean-feller"
      ],
      "raw_directive": "1066: and let $D_{\\mathcal Y}:=\\operatorname{diam}_{d_{\\mathcal Y}^{\\mathrm{Sasaki}}}(\\mathcal Y)$.\n1067: \n1068: :::{prf:lemma} Single-walker positional error bound in the Sasaki metric\n1069: :label: lem-sasaki-single-walker-positional-error\n1070: \n1071: Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. For a given walker $i$ that is alive in swarm $\\mathcal S_1$ ($s_{1,i}=1$), let $\\mathbb C_i(\\mathcal S_1)$ be its companion selection measure.\n1072: \n1073: The absolute error in its expected distance due to the positional displacement of the walkers between the two states, evaluated over the fixed companion set from $\\mathcal S_1$, is bounded by the sum of its own displacement and the average displacement of its potential companions.\n1074: \n1075: Referenced by {prf:ref}`lem-sasaki-total-squared-error-stable` and {prf:ref}`thm-euclidean-feller`.\n1076: \n1077: $$\n1078: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1079: \n1080: $$\n1081: \n1082: ```{dropdown} Proof\n1083: :::{prf:proof}\n1084: Let $\\Delta_{\\mathrm{pos},i}$ denote the absolute error term we wish to bound. The proof proceeds by applying standard metric and probability inequalities.\n1085: \n1086: **Step 1: Apply Linearity of Expectation.**\n1087: We combine the two terms into a single expectation over the fixed companion selection measure $\\mathbb C_i(\\mathcal S_1)$.\n1088: \n1089: $$\n1090: \\Delta_{\\mathrm{pos},i} = \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right|\n1091: \n1092: $$\n1093: \n1094: **Step 2: Apply Jensen's Inequality.**\n1095: Using Jensen's inequality for the convex function $f(x)=|x|$, we can move the absolute value inside the expectation, which provides an upper bound:\n1096: \n1097: $$\n1098: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\right]\n1099: \n1100: $$\n1101: \n1102: **Step 3: Apply the Reverse Triangle Inequality.**\n1103: The term inside the expectation is the absolute difference between two distance values. For any points $a,b,c,d$ in a metric space $(M,d)$, the reverse triangle inequality states that $|d(a,b) - d(c,d)| \\le d(a,c) + d(b,d)$. Applying this to the Sasaki metric $d_{\\mathcal Y}^{\\mathrm{Sasaki}}$ yields:\n1104: \n1105: $$\n1106: \\left| d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{1,c})) - d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right| \\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c}))\n1107: \n1108: $$\n1109: \n1110: **Step 4: Finalize the Bound.**\n1111: We substitute the inequality from Step 3 back into the expression from Step 2.\n1112: \n1113: $$\n1114: \\Delta_{\\mathrm{pos},i} \\le \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i})) + d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}), \\varphi(w_{2,c})) \\right]\n1115: \n1116: $$\n1117: \n1118: By linearity of expectation, we can separate the terms. The first term, $d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i}))$, is a constant with respect to the expectation over the companion index $c$. This gives the final bound as stated in the lemma.\n1119: \n1120: **Q.E.D.**"
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-single-walker-structural-error",
      "title": "Single-walker structural error bound in the Sasaki metric",
      "start_line": 1122,
      "end_line": 1160,
      "header_lines": [
        1123
      ],
      "content_start": 1125,
      "content_end": 1159,
      "content": "1125: :label: lem-sasaki-single-walker-structural-error\n1126: \n1127: Let $i\\in\\mathcal A_{\\mathrm{stable}}$ and keep the second swarm's capped positions fixed. Let the initial swarm have at least two alive walkers, $k_1=|\\mathcal A(\\mathcal S_1)| \\ge 2$. The absolute error in the expected distance for walker $i$ due to the change in the companion selection measure is bounded by:\n1128: \n1129: Referenced by {prf:ref}`thm-sasaki-distance-ms`.\n1130: \n1131: $$\n1132: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_2)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le \\frac{2 D_{\\mathcal Y}}{k_1-1} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1133: \n1134: $$\n1135: \n1136: where $D_{\\mathcal Y}$ is the diameter of the algorithmic space.\n1137: \n1138: ```{dropdown} Proof\n1139: :::{prf:proof}\n1140: This result is a direct application of the framework's **Total Error Bound in Terms of Status Changes** ({prf:ref}`thm-total-error-status-bound`) to the specific function of interest in the Sasaki geometry.\n1141: \n1142: **Step 1: Identify the Function and its Bound.**\n1143: Let the function being evaluated under the expectation be $f(c) := d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c}))$. This function measures the Sasaki distance from the fixed walker $i$ to a potential companion $c$, using the positions from the second swarm. By definition, any distance in the algorithmic space is bounded by the space's diameter, $D_{\\mathcal Y}$. Therefore, we have a uniform bound on the function's value: $|f(c)| \\le D_{\\mathcal Y} =: M_f$.\n1144: \n1145: **Step 2: Identify the Companion Support Sets.**\n1146: Let $S_1 = S_i(\\mathcal{S}_1)$ and $S_2 = S_i(\\mathcal{S}_2)$ be the companion support sets for walker $i$ in the two swarms. Since walker $i$ is alive in $\\mathcal S_1$ (i.e., $i \\in \\mathcal A_{\\mathrm{stable}} \\subseteq \\mathcal A_1$) and the precondition states $k_1 \\ge 2$, the initial support set is $S_1 = \\mathcal A_1 \\setminus \\{i\\}$. Its size is therefore $|S_1| = k_1 - 1 > 0$.\n1147: \n1148: **Step 3: Apply the General Error Bound.**\n1149: The framework theorem {prf:ref}`thm-total-error-status-bound` provides a general bound for the change in expectation of a bounded function due to a change in the underlying support set:\n1150: \n1151: $$\n1152: \\text{Error} \\le \\frac{2 M_f}{|S_1|} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1153: \n1154: $$\n1155: This bound is purely algebraic and holds for any choice of metric or bounded function.\n1156: \n1157: **Step 4: Substitute and Finalize.**\n1158: We substitute our specific function bound $M_f = D_{\\mathcal Y}$ and the support set size $|S_1| = k_1 - 1$ into the general formula. This immediately yields the stated bound for the structural error component.\n1159: ",
      "metadata": {
        "label": "lem-sasaki-single-walker-structural-error"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "thm-sasaki-distance-ms",
        "thm-total-error-status-bound"
      ],
      "raw_directive": "1122: :::\n1123: \n1124: :::{prf:lemma} Single-walker structural error bound in the Sasaki metric\n1125: :label: lem-sasaki-single-walker-structural-error\n1126: \n1127: Let $i\\in\\mathcal A_{\\mathrm{stable}}$ and keep the second swarm's capped positions fixed. Let the initial swarm have at least two alive walkers, $k_1=|\\mathcal A(\\mathcal S_1)| \\ge 2$. The absolute error in the expected distance for walker $i$ due to the change in the companion selection measure is bounded by:\n1128: \n1129: Referenced by {prf:ref}`thm-sasaki-distance-ms`.\n1130: \n1131: $$\n1132: \\left| \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_1)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] - \\mathbb{E}_{c \\sim \\mathbb{C}_i(\\mathcal{S}_2)} \\left[ d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c})) \\right] \\right| \\le \\frac{2 D_{\\mathcal Y}}{k_1-1} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1133: \n1134: $$\n1135: \n1136: where $D_{\\mathcal Y}$ is the diameter of the algorithmic space.\n1137: \n1138: ```{dropdown} Proof\n1139: :::{prf:proof}\n1140: This result is a direct application of the framework's **Total Error Bound in Terms of Status Changes** ({prf:ref}`thm-total-error-status-bound`) to the specific function of interest in the Sasaki geometry.\n1141: \n1142: **Step 1: Identify the Function and its Bound.**\n1143: Let the function being evaluated under the expectation be $f(c) := d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{2,i}), \\varphi(w_{2,c}))$. This function measures the Sasaki distance from the fixed walker $i$ to a potential companion $c$, using the positions from the second swarm. By definition, any distance in the algorithmic space is bounded by the space's diameter, $D_{\\mathcal Y}$. Therefore, we have a uniform bound on the function's value: $|f(c)| \\le D_{\\mathcal Y} =: M_f$.\n1144: \n1145: **Step 2: Identify the Companion Support Sets.**\n1146: Let $S_1 = S_i(\\mathcal{S}_1)$ and $S_2 = S_i(\\mathcal{S}_2)$ be the companion support sets for walker $i$ in the two swarms. Since walker $i$ is alive in $\\mathcal S_1$ (i.e., $i \\in \\mathcal A_{\\mathrm{stable}} \\subseteq \\mathcal A_1$) and the precondition states $k_1 \\ge 2$, the initial support set is $S_1 = \\mathcal A_1 \\setminus \\{i\\}$. Its size is therefore $|S_1| = k_1 - 1 > 0$.\n1147: \n1148: **Step 3: Apply the General Error Bound.**\n1149: The framework theorem {prf:ref}`thm-total-error-status-bound` provides a general bound for the change in expectation of a bounded function due to a change in the underlying support set:\n1150: \n1151: $$\n1152: \\text{Error} \\le \\frac{2 M_f}{|S_1|} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1153: \n1154: $$\n1155: This bound is purely algebraic and holds for any choice of metric or bounded function.\n1156: \n1157: **Step 4: Substitute and Finalize.**\n1158: We substitute our specific function bound $M_f = D_{\\mathcal Y}$ and the support set size $|S_1| = k_1 - 1$ into the general formula. This immediately yields the stated bound for the structural error component.\n1159: \n1160: **Q.E.D.**"
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-total-squared-error-stable",
      "title": "Mean-square error on stable walkers (Sasaki)",
      "start_line": 1164,
      "end_line": 1200,
      "header_lines": [
        1165
      ],
      "content_start": 1167,
      "content_end": 1199,
      "content": "1167: :label: lem-sasaki-total-squared-error-stable\n1168: \n1169: Let $\\mathcal S_1,\\mathcal S_2$ be swarms with alive sets $\\mathcal A_r$ and let $\\mathbf d^{(r)}$ denote the expected raw distance vector produced by the measurement operator on $\\mathcal S_r$. Write $\\mathcal A_{\\mathrm{stable}}:=\\mathcal A_1\\cap\\mathcal A_2$ and $k_{\\mathrm{stable}}:=|\\mathcal A_{\\mathrm{stable}}|$. Then\n1170: \n1171: $$\n1172: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\big|d^{(1)}_i-d^{(2)}_i\\big|^2\\le C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}})\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1173: \n1174: $$\n1175: \n1176: where $C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}}):=2\\Big(1+\\frac{k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\Big)$.\n1177: \n1178: Referenced by {prf:ref}`thm-sasaki-distance-ms`.\n1179: \n1180: ```{dropdown} Proof\n1181: :::{prf:proof}\n1182: For $i\\in\\mathcal A_{\\mathrm{stable}}$ set $\\Delta_i:=|d^{(1)}_i-d^{(2)}_i|$. Lemma {prf:ref}`lem-sasaki-single-walker-positional-error` gives\n1183: \n1184: $$\n1185: \\Delta_i\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i})) + \\mathbb E_{c\\sim\\mathbb C_i(\\mathcal S_1)}\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}),\\varphi(w_{2,c}))\\big].\n1186: \n1187: $$\n1188: \n1189: Apply $(a+b)^2\\le 2a^2+2b^2$ and Jensen's inequality to obtain\n1190: \n1191: $$\n1192: \\Delta_i^2\\le 2\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i}))^2 + \\frac{2}{k_1-1}\\sum_{j\\in\\mathcal A_1} d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,j}),\\varphi(w_{2,j}))^2,\n1193: \n1194: $$\n1195: where the averaging denominator $k_1-1$ is interpreted as $1$ when $k_1=1$. Summing over $i\\in\\mathcal A_{\\mathrm{stable}}$ yields\n1196: \n1197: $$\n1198: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\Delta_i^2\\le 2\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2)+\\frac{2k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1199: ",
      "metadata": {
        "label": "lem-sasaki-total-squared-error-stable"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "thm-sasaki-distance-ms",
        "lem-sasaki-single-walker-positional-error"
      ],
      "raw_directive": "1164: \n1165: \n1166: :::{prf:lemma} Mean-square error on stable walkers (Sasaki)\n1167: :label: lem-sasaki-total-squared-error-stable\n1168: \n1169: Let $\\mathcal S_1,\\mathcal S_2$ be swarms with alive sets $\\mathcal A_r$ and let $\\mathbf d^{(r)}$ denote the expected raw distance vector produced by the measurement operator on $\\mathcal S_r$. Write $\\mathcal A_{\\mathrm{stable}}:=\\mathcal A_1\\cap\\mathcal A_2$ and $k_{\\mathrm{stable}}:=|\\mathcal A_{\\mathrm{stable}}|$. Then\n1170: \n1171: $$\n1172: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\big|d^{(1)}_i-d^{(2)}_i\\big|^2\\le C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}})\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1173: \n1174: $$\n1175: \n1176: where $C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}}):=2\\Big(1+\\frac{k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\Big)$.\n1177: \n1178: Referenced by {prf:ref}`thm-sasaki-distance-ms`.\n1179: \n1180: ```{dropdown} Proof\n1181: :::{prf:proof}\n1182: For $i\\in\\mathcal A_{\\mathrm{stable}}$ set $\\Delta_i:=|d^{(1)}_i-d^{(2)}_i|$. Lemma {prf:ref}`lem-sasaki-single-walker-positional-error` gives\n1183: \n1184: $$\n1185: \\Delta_i\\le d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i})) + \\mathbb E_{c\\sim\\mathbb C_i(\\mathcal S_1)}\\big[d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,c}),\\varphi(w_{2,c}))\\big].\n1186: \n1187: $$\n1188: \n1189: Apply $(a+b)^2\\le 2a^2+2b^2$ and Jensen's inequality to obtain\n1190: \n1191: $$\n1192: \\Delta_i^2\\le 2\\,d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}),\\varphi(w_{2,i}))^2 + \\frac{2}{k_1-1}\\sum_{j\\in\\mathcal A_1} d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,j}),\\varphi(w_{2,j}))^2,\n1193: \n1194: $$\n1195: where the averaging denominator $k_1-1$ is interpreted as $1$ when $k_1=1$. Summing over $i\\in\\mathcal A_{\\mathrm{stable}}$ yields\n1196: \n1197: $$\n1198: \\sum_{i\\in\\mathcal A_{\\mathrm{stable}}}\\Delta_i^2\\le 2\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2)+\\frac{2k_{\\mathrm{stable}}}{\\max\\{1,k_1-1\\}}\\,\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),\n1199: \n1200: $$"
    },
    {
      "directive_type": "theorem",
      "label": "thm-sasaki-distance-ms",
      "title": "Mean-square continuity of the distance measurement (Sasaki)",
      "start_line": 1202,
      "end_line": 1226,
      "header_lines": [
        1203
      ],
      "content_start": 1205,
      "content_end": 1225,
      "content": "1205: :label: thm-sasaki-distance-ms\n1206: \n1207: Let $\\mathbf d^{(r)}$ be the expected raw distance vectors of swarms $\\mathcal S_r$. With $k_{\\min}:=\\max\\{1,\\min(k_1,k_2)\\}$, $k_{\\mathrm{stable}}:=|\\mathcal A_{\\mathrm{stable}}|$, and alive-difference count $n_c:=\\sum_{i=1}^N(s_{1,i}-s_{2,i})^2$, define\n1208: \n1209: $$\n1210: F_{d,ms}^{\\mathrm{Sasaki}}(\\Delta_{\\mathrm{pos}}^2,n_c):=C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}})\\,\\Delta_{\\mathrm{pos}}^2+4k_{\\mathrm{stable}}\\frac{D_{\\mathcal Y}^2}{\\max\\{1,k_1-1\\}^2}\\,n_c^2+4D_{\\mathcal Y}^2 n_c.\n1211: \n1212: $$\n1213: \n1214: Referenced by {prf:ref}`thm-euclidean-feller`.\n1215: \n1216: Then\n1217: \n1218: $$\n1219: \\big\\|\\mathbf d^{(1)}-\\mathbf d^{(2)}\\big\\|_2^2\\le F_{d,ms}^{\\mathrm{Sasaki}}\\big(\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),n_c(\\mathcal S_1,\\mathcal S_2)\\big).\n1220: \n1221: $$\n1222: \n1223: ```{dropdown} Proof\n1224: :::{prf:proof}\n1225: Decompose the index set into stable walkers $\\mathcal A_{\\mathrm{stable}}$ and the complement. For stable walkers the bound in Lemma {prf:ref}`lem-sasaki-total-squared-error-stable` applies. For walkers whose status changes between the two swarms we use $|d^{(1)}_i-d^{(2)}_i|\\le D_{\\mathcal Y}$ because each expected distance is bounded by the diameter of the Sasaki algorithmic space. There are at most $2n_c$ such indices, contributing at most $4D_{\\mathcal Y}^2n_c$ to the squared error.",
      "metadata": {
        "label": "thm-sasaki-distance-ms"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "thm-euclidean-feller",
        "lem-sasaki-total-squared-error-stable",
        "lem-sasaki-single-walker-structural-error"
      ],
      "raw_directive": "1202: :::\n1203: \n1204: :::{prf:theorem} Mean-square continuity of the distance measurement (Sasaki)\n1205: :label: thm-sasaki-distance-ms\n1206: \n1207: Let $\\mathbf d^{(r)}$ be the expected raw distance vectors of swarms $\\mathcal S_r$. With $k_{\\min}:=\\max\\{1,\\min(k_1,k_2)\\}$, $k_{\\mathrm{stable}}:=|\\mathcal A_{\\mathrm{stable}}|$, and alive-difference count $n_c:=\\sum_{i=1}^N(s_{1,i}-s_{2,i})^2$, define\n1208: \n1209: $$\n1210: F_{d,ms}^{\\mathrm{Sasaki}}(\\Delta_{\\mathrm{pos}}^2,n_c):=C_{\\mathrm{pos}}^{\\mathrm{Sasaki}}(k_1,k_{\\mathrm{stable}})\\,\\Delta_{\\mathrm{pos}}^2+4k_{\\mathrm{stable}}\\frac{D_{\\mathcal Y}^2}{\\max\\{1,k_1-1\\}^2}\\,n_c^2+4D_{\\mathcal Y}^2 n_c.\n1211: \n1212: $$\n1213: \n1214: Referenced by {prf:ref}`thm-euclidean-feller`.\n1215: \n1216: Then\n1217: \n1218: $$\n1219: \\big\\|\\mathbf d^{(1)}-\\mathbf d^{(2)}\\big\\|_2^2\\le F_{d,ms}^{\\mathrm{Sasaki}}\\big(\\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2),n_c(\\mathcal S_1,\\mathcal S_2)\\big).\n1220: \n1221: $$\n1222: \n1223: ```{dropdown} Proof\n1224: :::{prf:proof}\n1225: Decompose the index set into stable walkers $\\mathcal A_{\\mathrm{stable}}$ and the complement. For stable walkers the bound in Lemma {prf:ref}`lem-sasaki-total-squared-error-stable` applies. For walkers whose status changes between the two swarms we use $|d^{(1)}_i-d^{(2)}_i|\\le D_{\\mathcal Y}$ because each expected distance is bounded by the diameter of the Sasaki algorithmic space. There are at most $2n_c$ such indices, contributing at most $4D_{\\mathcal Y}^2n_c$ to the squared error.\n1226: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-aggregator-value",
      "title": "Value continuity of the empirical moments",
      "start_line": 1240,
      "end_line": 1257,
      "header_lines": [
        1241
      ],
      "content_start": 1243,
      "content_end": 1256,
      "content": "1243: :label: lem-sasaki-aggregator-value\n1244: \n1245: Fix a swarm $\\mathcal S$ with alive index set $\\mathcal A(\\mathcal S)$ of size $k\\ge 1$. Let $\\mathbf v_1,\\mathbf v_2\\in\\mathbb R^k$ be two scalar value vectors whose components satisfy $|v_{j,i}|\\le V_{\\max}$. Then the empirical mean and second moment obey\n1246: \n1247: Referenced by {prf:ref}`lem-sasaki-aggregator-lipschitz` and {prf:ref}`lem-sasaki-mean-shift-bound-sq`.\n1248: \n1249: $$\n1250: |\\mu(\\mathcal S,\\mathbf v_1)-\\mu(\\mathcal S,\\mathbf v_2)|\\le \\frac{1}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2,\\qquad|m_2(\\mathcal S,\\mathbf v_1)-m_2(\\mathcal S,\\mathbf v_2)|\\le \\frac{2V_{\\max}}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2.\n1251: \n1252: $$\n1253: \n1254: ```{dropdown} Proof\n1255: :::{prf:proof}\n1256: The identities follow from the gradient calculations $\\nabla\\mu=(1/k)\\mathbf 1$ and $\\nabla m_2=(2/k)\\mathbf v$ together with Cauchy\u2013Schwarz, as in Lemma 6.2.2.a of the framework.",
      "metadata": {
        "label": "lem-sasaki-aggregator-value"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-sasaki-aggregator-lipschitz",
        "lem-sasaki-mean-shift-bound-sq"
      ],
      "raw_directive": "1240: Whenever aggregators act on reward vectors we use the uniform bound $V_{\\mathrm{max}}^{(R)}:=\\max\\{|R_{\\min}|,R_{\\max}\\}$; for distance vectors we use $V_{\\mathrm{max}}^{(d)}:=D_{\\mathcal Y}$. For swarms $\\mathcal S_r$ write $k_r:=|\\mathcal A(\\mathcal S_r)|$, define $k_{\\min}:=\\max\\{1,\\min(k_1,k_2)\\}$, and let $n_c:=\\sum_{i=1}^N(s_{1,i}-s_{2,i})^2$ count the status changes.\n1241: \n1242: :::{prf:lemma} Value continuity of the empirical moments\n1243: :label: lem-sasaki-aggregator-value\n1244: \n1245: Fix a swarm $\\mathcal S$ with alive index set $\\mathcal A(\\mathcal S)$ of size $k\\ge 1$. Let $\\mathbf v_1,\\mathbf v_2\\in\\mathbb R^k$ be two scalar value vectors whose components satisfy $|v_{j,i}|\\le V_{\\max}$. Then the empirical mean and second moment obey\n1246: \n1247: Referenced by {prf:ref}`lem-sasaki-aggregator-lipschitz` and {prf:ref}`lem-sasaki-mean-shift-bound-sq`.\n1248: \n1249: $$\n1250: |\\mu(\\mathcal S,\\mathbf v_1)-\\mu(\\mathcal S,\\mathbf v_2)|\\le \\frac{1}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2,\\qquad|m_2(\\mathcal S,\\mathbf v_1)-m_2(\\mathcal S,\\mathbf v_2)|\\le \\frac{2V_{\\max}}{\\sqrt{k}}\\,\\|\\mathbf v_1-\\mathbf v_2\\|_2.\n1251: \n1252: $$\n1253: \n1254: ```{dropdown} Proof\n1255: :::{prf:proof}\n1256: The identities follow from the gradient calculations $\\nabla\\mu=(1/k)\\mathbf 1$ and $\\nabla m_2=(2/k)\\mathbf v$ together with Cauchy\u2013Schwarz, as in Lemma 6.2.2.a of the framework.\n1257: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-aggregator-structural",
      "title": "Structural continuity of the empirical moments",
      "start_line": 1259,
      "end_line": 1276,
      "header_lines": [
        1260
      ],
      "content_start": 1262,
      "content_end": 1275,
      "content": "1262: :label: lem-sasaki-aggregator-structural\n1263: \n1264: Let $\\mathcal S_r=((x_{r,i},v_{r,i},s_{r,i}))_{i=1}^N$ with alive counts $k_r\\ge 1$ and let $\\mathbf v$ be a scalar vector on the union of alive indices satisfying $|v_i|\\le V_{\\max}$. Set $k_{\\min}:=\\max\\{1,\\min(k_1,k_2)\\}$ and $n_c:=\\sum_{i=1}^N(s_{1,i}-s_{2,i})^2$. Then\n1265: \n1266: Referenced by {prf:ref}`lem-sasaki-aggregator-lipschitz` and {prf:ref}`lem-sasaki-indirect-structural-error-sq`.\n1267: \n1268: $$\n1269: |\\mu(\\mathcal S_1,\\mathbf v)-\\mu(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}}{k_{\\min}}\\,n_c,\\qquad|m_2(\\mathcal S_1,\\mathbf v)-m_2(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}^2}{k_{\\min}}\\,n_c.\n1270: \n1271: $$\n1272: \n1273: ```{dropdown} Proof\n1274: :::{prf:proof}\n1275: The proof mirrors Lemma 6.2.2.b of the framework. Decompose the difference in means into contributions from walkers that remain alive in both swarms and those that change status. The former vanish, whereas the latter introduce at most $V_{\\max}$ per status flip. Accounting for the normalisation factors $1/k_r$ and the difference in alive counts yields the stated bounds. The argument for $m_2$ uses $|a^2-b^2|\\le 2V_{\\max}|a-b|$.",
      "metadata": {
        "label": "lem-sasaki-aggregator-structural"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-sasaki-aggregator-lipschitz",
        "lem-sasaki-indirect-structural-error-sq"
      ],
      "raw_directive": "1259: :::\n1260: \n1261: :::{prf:lemma} Structural continuity of the empirical moments\n1262: :label: lem-sasaki-aggregator-structural\n1263: \n1264: Let $\\mathcal S_r=((x_{r,i},v_{r,i},s_{r,i}))_{i=1}^N$ with alive counts $k_r\\ge 1$ and let $\\mathbf v$ be a scalar vector on the union of alive indices satisfying $|v_i|\\le V_{\\max}$. Set $k_{\\min}:=\\max\\{1,\\min(k_1,k_2)\\}$ and $n_c:=\\sum_{i=1}^N(s_{1,i}-s_{2,i})^2$. Then\n1265: \n1266: Referenced by {prf:ref}`lem-sasaki-aggregator-lipschitz` and {prf:ref}`lem-sasaki-indirect-structural-error-sq`.\n1267: \n1268: $$\n1269: |\\mu(\\mathcal S_1,\\mathbf v)-\\mu(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}}{k_{\\min}}\\,n_c,\\qquad|m_2(\\mathcal S_1,\\mathbf v)-m_2(\\mathcal S_2,\\mathbf v)|\\le \\frac{3V_{\\max}^2}{k_{\\min}}\\,n_c.\n1270: \n1271: $$\n1272: \n1273: ```{dropdown} Proof\n1274: :::{prf:proof}\n1275: The proof mirrors Lemma 6.2.2.b of the framework. Decompose the difference in means into contributions from walkers that remain alive in both swarms and those that change status. The former vanish, whereas the latter introduce at most $V_{\\max}$ per status flip. Accounting for the normalisation factors $1/k_r$ and the difference in alive counts yields the stated bounds. The argument for $m_2$ uses $|a^2-b^2|\\le 2V_{\\max}|a-b|$.\n1276: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-aggregator-lipschitz",
      "title": "Lipschitz data for the Sasaki empirical aggregators",
      "start_line": 1278,
      "end_line": 1300,
      "header_lines": [
        1279
      ],
      "content_start": 1281,
      "content_end": 1299,
      "content": "1281: :label: lem-sasaki-aggregator-lipschitz\n1282: \n1283: For reward vectors take $V_{\\max}=V_{\\mathrm{max}}^{(R)}$; for distance vectors take $V_{\\max}=V_{\\mathrm{max}}^{(d)}$. The empirical mean and second moment satisfy the aggregator axioms with\n1284: \n1285: Referenced by {prf:ref}`lem-sasaki-mean-shift-bound-sq` and {prf:ref}`thm-euclidean-feller`.\n1286: \n1287: $$\n1288: L_{\\mu,M}^{\\mathrm{Sasaki}}(k)=\\frac{1}{\\sqrt{k}},\\qquad L_{m_2,M}^{\\mathrm{Sasaki}}(k)=\\frac{2V_{\\max}}{\\sqrt{k}},\n1289: \n1290: $$\n1291: \n1292: $$\n1293: L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}}{k_{\\min}},\\qquad L_{m_2,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}^2}{k_{\\min}},\n1294: \n1295: $$\n1296: and growth exponents $p_{\\mu,S}=p_{m_2,S}=p_{\\mathrm{worst\text{-}case}}=-1$. Consequently $\\kappa_{\\mathrm{var}}^{\\mathrm{Sasaki}}=\\kappa_{\\mathrm{range}}^{\\mathrm{Sasaki}}=1$ as in the canonical framework.\n1297: \n1298: ```{dropdown} Proof\n1299: :::{prf:proof}",
      "metadata": {
        "label": "lem-sasaki-aggregator-lipschitz"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-sasaki-mean-shift-bound-sq",
        "thm-euclidean-feller",
        "lem-sasaki-aggregator-value",
        "lem-sasaki-aggregator-structural"
      ],
      "raw_directive": "1278: :::\n1279: \n1280: :::{prf:lemma} Lipschitz data for the Sasaki empirical aggregators\n1281: :label: lem-sasaki-aggregator-lipschitz\n1282: \n1283: For reward vectors take $V_{\\max}=V_{\\mathrm{max}}^{(R)}$; for distance vectors take $V_{\\max}=V_{\\mathrm{max}}^{(d)}$. The empirical mean and second moment satisfy the aggregator axioms with\n1284: \n1285: Referenced by {prf:ref}`lem-sasaki-mean-shift-bound-sq` and {prf:ref}`thm-euclidean-feller`.\n1286: \n1287: $$\n1288: L_{\\mu,M}^{\\mathrm{Sasaki}}(k)=\\frac{1}{\\sqrt{k}},\\qquad L_{m_2,M}^{\\mathrm{Sasaki}}(k)=\\frac{2V_{\\max}}{\\sqrt{k}},\n1289: \n1290: $$\n1291: \n1292: $$\n1293: L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}}{k_{\\min}},\\qquad L_{m_2,S}^{\\mathrm{Sasaki}}(k_{\\min})=\\frac{3V_{\\max}^2}{k_{\\min}},\n1294: \n1295: $$\n1296: and growth exponents $p_{\\mu,S}=p_{m_2,S}=p_{\\mathrm{worst\text{-}case}}=-1$. Consequently $\\kappa_{\\mathrm{var}}^{\\mathrm{Sasaki}}=\\kappa_{\\mathrm{range}}^{\\mathrm{Sasaki}}=1$ as in the canonical framework.\n1297: \n1298: ```{dropdown} Proof\n1299: :::{prf:proof}\n1300: Combine Lemmas {prf:ref}`lem-sasaki-aggregator-value` and {prf:ref}`lem-sasaki-aggregator-structural` with the dispersion metric identity $n_c\\le(N/\\sqrt{\\lambda_{\\mathrm{status}}})d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1,\\mathcal S_2)$ to obtain the stated Lipschitz functions and exponents."
    },
    {
      "directive_type": "definition",
      "label": "def-sasaki-standardization-constants",
      "title": "Standardization constants (Sasaki geometry)",
      "start_line": 1309,
      "end_line": 1349,
      "header_lines": [
        1310
      ],
      "content_start": 1312,
      "content_end": 1348,
      "content": "1312: :label: def-sasaki-standardization-constants\n1313: \n1314: Let $\\sigma_{\\min,\\mathrm{patch}}:=\\sqrt{\\kappa_{\\mathrm{var,min}}+\\varepsilon_{\\mathrm{std}}^2}$ be the uniform lower bound on the regularized standard deviation, and let $L_{\\sigma'_{\\mathrm{patch}}}$ be its global Lipschitz constant from Lemma {prf:ref}`lem-sigma-patch-lipschitz`.\n1315: \n1316: ##### Value Error Coefficients\n1317: The following coefficients bound the error in the standardization operator when the swarm structure is fixed but the raw values change due to positional displacement. They are notably independent of the number of alive walkers, `k`.\n1318: \n1319: -   **Direct Shift Coefficient ($C_{V,\\mathrm{direct}}$):** Bounding the error from the direct change in the raw value vector.\n1320: \n1321:     $$\n1322:     C_{V,\\mathrm{direct}} := \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}}\n1323:     $$\n1324: \n1325: -   **Mean Shift Coefficient ($C_{V,\\mathrm{mean}}$):** Bounding the error from the resulting change in the empirical mean.\n1326: \n1327:     $$\n1328:     C_{V,\\mathrm{mean}} := \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}}\n1329:     $$\n1330: \n1331: -   **Denominator Shift Coefficient ($C_{V,\\mathrm{denom}}$):** Bounding the error from the resulting change in the regularized standard deviation.\n1332: \n1333:     $$\n1334:     C_{V,\\mathrm{denom}} := \\frac{8\\big(V_{\\mathrm{max}}^{(R)}\\big)^2 L_{\\sigma'_{\\mathrm{patch}}}}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1335:     $$\n1336: \n1337: -   **Total Value Error Coefficient ($C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}$):** The composite coefficient for the full Lipschitz bound on the value error, which aggregates the component-wise effects.\n1338: \n1339:     $$\n1340:     C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}} := L_R^{\\mathrm{Sasaki}} \\left( C_{V,\\mathrm{direct}} + C_{V,\\mathrm{mean}} + C_{V,\\mathrm{denom}} \\right) = L_R^{\\mathrm{Sasaki}} \\left( \\frac{2}{\\sigma_{\\min,\\mathrm{patch}}} + \\frac{8\\big(V_{\\mathrm{max}}^{(R)}\\big)^2 L_{\\sigma'_{\\mathrm{patch}}}}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right)\n1341:     $$\n1342: \n1343: ##### Structural Error Coefficients\n1344: The structural error coefficients, which are used in the subsequent theorem for structural continuity, remain as defined:\n1345: \n1346: $$\n1347: C_{S,\\mathrm{direct}}^{\\mathrm{Sasaki}}(k_{\\min}):=\\frac{V_{\\mathrm{max}}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}+\\frac{2\\big(V_{\\mathrm{max}}^{(R)}\\big)^2}{\\sigma_{\\min,\\mathrm{patch}}^2},\n1348: \\qquad C_{S,\\mathrm{indirect}}^{\\mathrm{Sasaki}}(k_{\\min}):=\\frac{3V_{\\mathrm{max}}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}k_{\\min}}+\\frac{6\\big(V_{\\mathrm{max}}^{(R)}\\big)^2}{\\sigma_{\\min,\\mathrm{patch}}^2k_{\\min}}L_{\\sigma',M}^{\\mathrm{Sasaki}}(k_{\\min}).",
      "metadata": {
        "label": "def-sasaki-standardization-constants"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-sigma-patch-lipschitz"
      ],
      "raw_directive": "1309: $$\n1310: \n1311: :::{prf:definition} Standardization constants (Sasaki geometry)\n1312: :label: def-sasaki-standardization-constants\n1313: \n1314: Let $\\sigma_{\\min,\\mathrm{patch}}:=\\sqrt{\\kappa_{\\mathrm{var,min}}+\\varepsilon_{\\mathrm{std}}^2}$ be the uniform lower bound on the regularized standard deviation, and let $L_{\\sigma'_{\\mathrm{patch}}}$ be its global Lipschitz constant from Lemma {prf:ref}`lem-sigma-patch-lipschitz`.\n1315: \n1316: ##### Value Error Coefficients\n1317: The following coefficients bound the error in the standardization operator when the swarm structure is fixed but the raw values change due to positional displacement. They are notably independent of the number of alive walkers, `k`.\n1318: \n1319: -   **Direct Shift Coefficient ($C_{V,\\mathrm{direct}}$):** Bounding the error from the direct change in the raw value vector.\n1320: \n1321:     $$\n1322:     C_{V,\\mathrm{direct}} := \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}}\n1323:     $$\n1324: \n1325: -   **Mean Shift Coefficient ($C_{V,\\mathrm{mean}}$):** Bounding the error from the resulting change in the empirical mean.\n1326: \n1327:     $$\n1328:     C_{V,\\mathrm{mean}} := \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}}\n1329:     $$\n1330: \n1331: -   **Denominator Shift Coefficient ($C_{V,\\mathrm{denom}}$):** Bounding the error from the resulting change in the regularized standard deviation.\n1332: \n1333:     $$\n1334:     C_{V,\\mathrm{denom}} := \\frac{8\\big(V_{\\mathrm{max}}^{(R)}\\big)^2 L_{\\sigma'_{\\mathrm{patch}}}}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1335:     $$\n1336: \n1337: -   **Total Value Error Coefficient ($C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}$):** The composite coefficient for the full Lipschitz bound on the value error, which aggregates the component-wise effects.\n1338: \n1339:     $$\n1340:     C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}} := L_R^{\\mathrm{Sasaki}} \\left( C_{V,\\mathrm{direct}} + C_{V,\\mathrm{mean}} + C_{V,\\mathrm{denom}} \\right) = L_R^{\\mathrm{Sasaki}} \\left( \\frac{2}{\\sigma_{\\min,\\mathrm{patch}}} + \\frac{8\\big(V_{\\mathrm{max}}^{(R)}\\big)^2 L_{\\sigma'_{\\mathrm{patch}}}}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right)\n1341:     $$\n1342: \n1343: ##### Structural Error Coefficients\n1344: The structural error coefficients, which are used in the subsequent theorem for structural continuity, remain as defined:\n1345: \n1346: $$\n1347: C_{S,\\mathrm{direct}}^{\\mathrm{Sasaki}}(k_{\\min}):=\\frac{V_{\\mathrm{max}}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}+\\frac{2\\big(V_{\\mathrm{max}}^{(R)}\\big)^2}{\\sigma_{\\min,\\mathrm{patch}}^2},\n1348: \\qquad C_{S,\\mathrm{indirect}}^{\\mathrm{Sasaki}}(k_{\\min}):=\\frac{3V_{\\mathrm{max}}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}k_{\\min}}+\\frac{6\\big(V_{\\mathrm{max}}^{(R)}\\big)^2}{\\sigma_{\\min,\\mathrm{patch}}^2k_{\\min}}L_{\\sigma',M}^{\\mathrm{Sasaki}}(k_{\\min}).\n1349: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-sasaki-standardization-value-sq",
      "title": "Value continuity of patched standardization (Sasaki)",
      "start_line": 1358,
      "end_line": 1369,
      "header_lines": [
        1359
      ],
      "content_start": 1361,
      "content_end": 1368,
      "content": "1361: :label: thm-sasaki-standardization-value-sq\n1362: \n1363: Suppose $\\mathcal S_1$ and $\\mathcal S_2$ share the same alive set $\\mathcal A$ of size $k\\ge 1$ (so $n_c(\\mathcal S_1,\\mathcal S_2)=0$). The N-dimensional standardization operator is Lipschitz continuous with respect to positional changes in the Sasaki metric. The squared L2-norm of the output error is bounded as follows:\n1364: \n1365: $$\n1366: \\big\\|z(\\mathcal S_1)-z(\\mathcal S_2)\\big\\|_2^2 \\le C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S_1) \\cdot \\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2).\n1367: \n1368: $$",
      "metadata": {
        "label": "thm-sasaki-standardization-value-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-sasaki-standardization-constants-sq"
      ],
      "raw_directive": "1358: #### 2.3.4. Theorem: Value Continuity of Patched Standardization (Sasaki)\n1359: \n1360: :::{prf:theorem} Value continuity of patched standardization (Sasaki)\n1361: :label: thm-sasaki-standardization-value-sq\n1362: \n1363: Suppose $\\mathcal S_1$ and $\\mathcal S_2$ share the same alive set $\\mathcal A$ of size $k\\ge 1$ (so $n_c(\\mathcal S_1,\\mathcal S_2)=0$). The N-dimensional standardization operator is Lipschitz continuous with respect to positional changes in the Sasaki metric. The squared L2-norm of the output error is bounded as follows:\n1364: \n1365: $$\n1366: \\big\\|z(\\mathcal S_1)-z(\\mathcal S_2)\\big\\|_2^2 \\le C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S_1) \\cdot \\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2).\n1367: \n1368: $$\n1369: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-value-error-decomposition",
      "title": "Decomposition of the Value Error",
      "start_line": 1373,
      "end_line": 1443,
      "header_lines": [
        1374
      ],
      "content_start": 1376,
      "content_end": 1442,
      "content": "1376: :label: lem-sasaki-value-error-decomposition\n1377: \n1378: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. Let $(\\mu_1, \\sigma'_1)$ and $(\\mu_2, \\sigma'_2)$ be the corresponding statistical properties, and let $\\mathbf z_1$ and $\\mathbf z_2$ be the corresponding standardized vectors.\n1379: \n1380: Referenced by {prf:ref}`unlabeled-proof-1047`.\n1381: \n1382: The total value error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of three components:\n1383: \n1384: $$\n1385: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1386: \n1387: $$\n1388: \n1389: where:\n1390: 1.  **The Direct Shift ($\\Delta_{\\text{direct}}$):** The error from the change in the raw value vector itself, scaled by the initial standard deviation.\n1391: \n1392:     $$\n1393:     \\Delta_{\\text{direct}} := \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1}\n1394:     $$\n1395: \n1396: 2.  **The Mean Shift ($\\Delta_{\\text{mean}}$):** The error from the change in the aggregator's computed mean, applied uniformly to all walkers.\n1397: \n1398:     $$\n1399:     \\Delta_{\\text{mean}} := \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1}\n1400:     $$\n1401:     where $\\mathbf{1}$ is a k-dimensional vector of ones.\n1402: \n1403: 3.  **The Denominator Shift ($\\Delta_{\\text{denom}}$):** The error from the change in the regularized standard deviation, which rescales the second standardized vector.\n1404: \n1405:     $$\n1406:     \\Delta_{\\text{denom}} := \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\n1407:     $$\n1408: \n1409: Furthermore, the total squared error is bounded by three times the sum of the squared norms of these components:\n1410: \n1411: $$\n1412: \\|\\Delta\\mathbf{z}\\|_2^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1413: \n1414: $$\n1415: \n1416: ```{dropdown} Proof\n1417: :::{prf:proof}\n1418: **Step 1: Algebraic Decomposition.**\n1419: The proof of the decomposition is a direct algebraic manipulation. We start with the definition of the error and add and subtract the intermediate term $(\\mathbf r_2 - \\mu_2) / \\sigma'_1$.\n1420: \n1421: $$\n1422: \\begin{aligned}\n1423: \\Delta\\mathbf{z} &= \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\\\\n1424: &= \\left( \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} \\right) + \\left( \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\right) \\\\\n1425: &= \\frac{(\\mathbf r_1 - \\mathbf r_2) - (\\mu_1 - \\mu_2)}{\\sigma'_1} + (\\mathbf r_2 - \\mu_2) \\left( \\frac{1}{\\sigma'_1} - \\frac{1}{\\sigma'_2} \\right) \\\\\n1426: &= \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} + \\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\mathbf{1} + \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\\\\n1427: &= \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1428: \\end{aligned}\n1429: \n1430: $$\n1431: The final line follows by recognizing the definitions of the three components.\n1432: \n1433: **Step 2: Bound on the Squared Norm.**\n1434: The bound on the total squared norm follows from the triangle inequality (`||A+B+C|| <= ||A|| + ||B|| + ||C||`) and the elementary inequality $(a+b+c)^2 \\le 3(a^2+b^2+c^2)$ for non-negative reals. For vectors, this becomes:\n1435: \n1436: $$\n1437: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\\|_2^2 \\le \\left( \\|\\Delta_{\\text{direct}}\\|_2 + \\|\\Delta_{\\text{mean}}\\|_2 + \\|\\Delta_{\\text{denom}}\\|_2 \\right)^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1438: \n1439: $$\n1440: \n1441: This completes the proof.\n1442: ",
      "metadata": {
        "label": "lem-sasaki-value-error-decomposition"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "unlabeled-proof-1047"
      ],
      "raw_directive": "1373: ##### 2.3.4.1. Sub-Lemma: Algebraic Decomposition of the Value Error\n1374: \n1375: :::{prf:lemma} Decomposition of the Value Error\n1376: :label: lem-sasaki-value-error-decomposition\n1377: \n1378: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. Let $(\\mu_1, \\sigma'_1)$ and $(\\mu_2, \\sigma'_2)$ be the corresponding statistical properties, and let $\\mathbf z_1$ and $\\mathbf z_2$ be the corresponding standardized vectors.\n1379: \n1380: Referenced by {prf:ref}`unlabeled-proof-1047`.\n1381: \n1382: The total value error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of three components:\n1383: \n1384: $$\n1385: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1386: \n1387: $$\n1388: \n1389: where:\n1390: 1.  **The Direct Shift ($\\Delta_{\\text{direct}}$):** The error from the change in the raw value vector itself, scaled by the initial standard deviation.\n1391: \n1392:     $$\n1393:     \\Delta_{\\text{direct}} := \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1}\n1394:     $$\n1395: \n1396: 2.  **The Mean Shift ($\\Delta_{\\text{mean}}$):** The error from the change in the aggregator's computed mean, applied uniformly to all walkers.\n1397: \n1398:     $$\n1399:     \\Delta_{\\text{mean}} := \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1}\n1400:     $$\n1401:     where $\\mathbf{1}$ is a k-dimensional vector of ones.\n1402: \n1403: 3.  **The Denominator Shift ($\\Delta_{\\text{denom}}$):** The error from the change in the regularized standard deviation, which rescales the second standardized vector.\n1404: \n1405:     $$\n1406:     \\Delta_{\\text{denom}} := \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\n1407:     $$\n1408: \n1409: Furthermore, the total squared error is bounded by three times the sum of the squared norms of these components:\n1410: \n1411: $$\n1412: \\|\\Delta\\mathbf{z}\\|_2^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1413: \n1414: $$\n1415: \n1416: ```{dropdown} Proof\n1417: :::{prf:proof}\n1418: **Step 1: Algebraic Decomposition.**\n1419: The proof of the decomposition is a direct algebraic manipulation. We start with the definition of the error and add and subtract the intermediate term $(\\mathbf r_2 - \\mu_2) / \\sigma'_1$.\n1420: \n1421: $$\n1422: \\begin{aligned}\n1423: \\Delta\\mathbf{z} &= \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\\\\n1424: &= \\left( \\frac{\\mathbf r_1 - \\mu_1}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} \\right) + \\left( \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_1} - \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\right) \\\\\n1425: &= \\frac{(\\mathbf r_1 - \\mathbf r_2) - (\\mu_1 - \\mu_2)}{\\sigma'_1} + (\\mathbf r_2 - \\mu_2) \\left( \\frac{1}{\\sigma'_1} - \\frac{1}{\\sigma'_2} \\right) \\\\\n1426: &= \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} + \\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\mathbf{1} + \\frac{\\mathbf r_2 - \\mu_2}{\\sigma'_2} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\\\\n1427: &= \\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\n1428: \\end{aligned}\n1429: \n1430: $$\n1431: The final line follows by recognizing the definitions of the three components.\n1432: \n1433: **Step 2: Bound on the Squared Norm.**\n1434: The bound on the total squared norm follows from the triangle inequality (`||A+B+C|| <= ||A|| + ||B|| + ||C||`) and the elementary inequality $(a+b+c)^2 \\le 3(a^2+b^2+c^2)$ for non-negative reals. For vectors, this becomes:\n1435: \n1436: $$\n1437: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{mean}} + \\Delta_{\\text{denom}}\\|_2^2 \\le \\left( \\|\\Delta_{\\text{direct}}\\|_2 + \\|\\Delta_{\\text{mean}}\\|_2 + \\|\\Delta_{\\text{denom}}\\|_2 \\right)^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1438: \n1439: $$\n1440: \n1441: This completes the proof.\n1442: \n1443: **Q.E.D.**"
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-direct-shift-bound-sq",
      "title": "Bound on the Squared Direct Shift Component",
      "start_line": 1447,
      "end_line": 1495,
      "header_lines": [
        1448
      ],
      "content_start": 1450,
      "content_end": 1494,
      "content": "1450: :label: lem-sasaki-direct-shift-bound-sq\n1451: \n1452: Let $\\mathcal S$ be a fixed swarm state. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. The squared Euclidean norm of the direct shift error component, $\\Delta_{\\text{direct}} = (\\mathbf r_1 - \\mathbf r_2) / \\sigma'_1$, is bounded as follows:\n1453: \n1454: Referenced by {prf:ref}`unlabeled-proof-1047`.\n1455: \n1456: $$\n1457: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1458: \n1459: $$\n1460: \n1461: where $\\sigma_{\\min,\\mathrm{patch}} := \\sqrt{\\kappa_{\\mathrm{var,min}}+\\varepsilon_{\\mathrm{std}}^2}$ is the uniform lower bound from the regularized standard deviation.\n1462: \n1463: ```{dropdown} Proof\n1464: :::{prf:proof}\n1465: The proof is a direct application of the definition of $\\Delta_{\\text{direct}}$ and the uniform lower bound on the regularized standard deviation.\n1466: \n1467: 1.  **Start with the Definition.**\n1468:     The squared L2-norm of the direct shift component is:\n1469: \n1470:     $$\n1471:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\left\\| \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} \\right\\|_2^2\n1472:     $$\n1473: \n1474: 2.  **Factor out the Scalar Term.**\n1475:     Since $\\sigma'_1$ is a scalar value for the fixed swarm state and value vector $\\mathbf r_1$, we can factor it out of the norm:\n1476: \n1477:     $$\n1478:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\frac{1}{(\\sigma'_1)^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1479:     $$\n1480: \n1481: 3.  **Apply the Uniform Lower Bound.**\n1482:     The regularized standard deviation function $\\sigma'_{\\mathrm{patch}}(V)$ is, by construction in the framework ({prf:ref}`def-statistical-properties-measurement`), strictly positive and uniformly bounded below by the constant $\\sigma_{\\min,\\mathrm{patch}}$. Therefore, $\\sigma'_1 \\ge \\sigma_{\\min,\\mathrm{patch}} > 0$. This implies:\n1483: \n1484:     $$\n1485:     \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1486:     $$\n1487: \n1488: 4.  **Combine to Finalize the Bound.**\n1489:     Substituting the inequality from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1490: \n1491:     $$\n1492:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1493:     $$\n1494: ",
      "metadata": {
        "label": "lem-sasaki-direct-shift-bound-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "unlabeled-proof-1047",
        "def-statistical-properties-measurement"
      ],
      "raw_directive": "1447: ##### 2.3.4.2. Sub-Lemma: Bounding the Squared Direct Shift Component\n1448: \n1449: :::{prf:lemma} Bound on the Squared Direct Shift Component\n1450: :label: lem-sasaki-direct-shift-bound-sq\n1451: \n1452: Let $\\mathcal S$ be a fixed swarm state. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors for the alive set. The squared Euclidean norm of the direct shift error component, $\\Delta_{\\text{direct}} = (\\mathbf r_1 - \\mathbf r_2) / \\sigma'_1$, is bounded as follows:\n1453: \n1454: Referenced by {prf:ref}`unlabeled-proof-1047`.\n1455: \n1456: $$\n1457: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1458: \n1459: $$\n1460: \n1461: where $\\sigma_{\\min,\\mathrm{patch}} := \\sqrt{\\kappa_{\\mathrm{var,min}}+\\varepsilon_{\\mathrm{std}}^2}$ is the uniform lower bound from the regularized standard deviation.\n1462: \n1463: ```{dropdown} Proof\n1464: :::{prf:proof}\n1465: The proof is a direct application of the definition of $\\Delta_{\\text{direct}}$ and the uniform lower bound on the regularized standard deviation.\n1466: \n1467: 1.  **Start with the Definition.**\n1468:     The squared L2-norm of the direct shift component is:\n1469: \n1470:     $$\n1471:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\left\\| \\frac{\\mathbf r_1 - \\mathbf r_2}{\\sigma'_1} \\right\\|_2^2\n1472:     $$\n1473: \n1474: 2.  **Factor out the Scalar Term.**\n1475:     Since $\\sigma'_1$ is a scalar value for the fixed swarm state and value vector $\\mathbf r_1$, we can factor it out of the norm:\n1476: \n1477:     $$\n1478:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\frac{1}{(\\sigma'_1)^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1479:     $$\n1480: \n1481: 3.  **Apply the Uniform Lower Bound.**\n1482:     The regularized standard deviation function $\\sigma'_{\\mathrm{patch}}(V)$ is, by construction in the framework ({prf:ref}`def-statistical-properties-measurement`), strictly positive and uniformly bounded below by the constant $\\sigma_{\\min,\\mathrm{patch}}$. Therefore, $\\sigma'_1 \\ge \\sigma_{\\min,\\mathrm{patch}} > 0$. This implies:\n1483: \n1484:     $$\n1485:     \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1486:     $$\n1487: \n1488: 4.  **Combine to Finalize the Bound.**\n1489:     Substituting the inequality from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1490: \n1491:     $$\n1492:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1493:     $$\n1494: \n1495: **Q.E.D.**"
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-mean-shift-bound-sq",
      "title": "Bound on the Squared Mean Shift Component",
      "start_line": 1499,
      "end_line": 1550,
      "header_lines": [
        1500
      ],
      "content_start": 1502,
      "content_end": 1549,
      "content": "1502: :label: lem-sasaki-mean-shift-bound-sq\n1503: \n1504: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors. The squared Euclidean norm of the mean shift error component, $\\Delta_{\\text{mean}} = ((\\mu_2 - \\mu_1) / \\sigma'_1) \\cdot \\mathbf{1}$, is bounded as follows:\n1505: \n1506: Referenced by {prf:ref}`unlabeled-proof-1047`.\n1507: \n1508: $$\n1509: \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1510: \n1511: $$\n1512: \n1513: where $L_{\\mu,M}^{\\mathrm{Sasaki}}(k)$ is the axiomatic **Value Lipschitz Function** for the aggregator's mean from {prf:ref}`lem-sasaki-aggregator-lipschitz`.\n1514: \n1515: ```{dropdown} Proof\n1516: :::{prf:proof}\n1517: The proof combines the definition of the mean shift component with the axiomatic continuity of the mean aggregator.\n1518: \n1519: 1.  **Start with the Definition.**\n1520:     The squared L2-norm of the mean shift component is:\n1521: \n1522:     $$\n1523:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\left\\| \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1} \\right\\|_2^2\n1524:     $$\n1525: \n1526: 2.  **Factor out the Scalar and Evaluate the Norm.**\n1527:     The term $(\\mu_2 - \\mu_1) / \\sigma'_1$ is a scalar. The L2-norm of the k-dimensional vector of ones, $\\mathbf{1}$, is $\\|\\mathbf{1}\\|_2 = \\sqrt{k}$. Therefore, the squared norm is:\n1528: \n1529:     $$\n1530:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} \\cdot \\|\\mathbf{1}\\|_2^2 = \\frac{k \\cdot (\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2}\n1531:     $$\n1532: \n1533: 3.  **Apply Axiomatic Continuity of the Mean.**\n1534:     The empirical aggregator is Lipschitz continuous with respect to the raw value vector, as established in {prf:ref}`lem-sasaki-aggregator-value`. This provides the bound:\n1535: \n1536:     $$\n1537:     |\\mu_2 - \\mu_1|^2 \\le \\left(L_{\\mu,M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1538:     $$\n1539: \n1540: 4.  **Apply the Uniform Lower Bound.**\n1541:     As in the previous lemma, we use the bound $1/(\\sigma'_1)^2 \\le 1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1542: \n1543: 5.  **Combine to Finalize the Bound.**\n1544:     Substituting the bounds from Step 3 and Step 4 into the expression from Step 2 yields the final result as stated in the lemma.\n1545: \n1546:     $$\n1547:     \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1548:     $$\n1549: ",
      "metadata": {
        "label": "lem-sasaki-mean-shift-bound-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "unlabeled-proof-1047",
        "lem-sasaki-aggregator-lipschitz",
        "lem-sasaki-aggregator-value"
      ],
      "raw_directive": "1499: ##### 2.3.4.3. Sub-Lemma: Bounding the Squared Mean Shift Component\n1500: \n1501: :::{prf:lemma} Bound on the Squared Mean Shift Component\n1502: :label: lem-sasaki-mean-shift-bound-sq\n1503: \n1504: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors. The squared Euclidean norm of the mean shift error component, $\\Delta_{\\text{mean}} = ((\\mu_2 - \\mu_1) / \\sigma'_1) \\cdot \\mathbf{1}$, is bounded as follows:\n1505: \n1506: Referenced by {prf:ref}`unlabeled-proof-1047`.\n1507: \n1508: $$\n1509: \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1510: \n1511: $$\n1512: \n1513: where $L_{\\mu,M}^{\\mathrm{Sasaki}}(k)$ is the axiomatic **Value Lipschitz Function** for the aggregator's mean from {prf:ref}`lem-sasaki-aggregator-lipschitz`.\n1514: \n1515: ```{dropdown} Proof\n1516: :::{prf:proof}\n1517: The proof combines the definition of the mean shift component with the axiomatic continuity of the mean aggregator.\n1518: \n1519: 1.  **Start with the Definition.**\n1520:     The squared L2-norm of the mean shift component is:\n1521: \n1522:     $$\n1523:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\left\\| \\frac{\\mu_2 - \\mu_1}{\\sigma'_1} \\cdot \\mathbf{1} \\right\\|_2^2\n1524:     $$\n1525: \n1526: 2.  **Factor out the Scalar and Evaluate the Norm.**\n1527:     The term $(\\mu_2 - \\mu_1) / \\sigma'_1$ is a scalar. The L2-norm of the k-dimensional vector of ones, $\\mathbf{1}$, is $\\|\\mathbf{1}\\|_2 = \\sqrt{k}$. Therefore, the squared norm is:\n1528: \n1529:     $$\n1530:     \\|\\Delta_{\\text{mean}}\\|_2^2 = \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} \\cdot \\|\\mathbf{1}\\|_2^2 = \\frac{k \\cdot (\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2}\n1531:     $$\n1532: \n1533: 3.  **Apply Axiomatic Continuity of the Mean.**\n1534:     The empirical aggregator is Lipschitz continuous with respect to the raw value vector, as established in {prf:ref}`lem-sasaki-aggregator-value`. This provides the bound:\n1535: \n1536:     $$\n1537:     |\\mu_2 - \\mu_1|^2 \\le \\left(L_{\\mu,M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1538:     $$\n1539: \n1540: 4.  **Apply the Uniform Lower Bound.**\n1541:     As in the previous lemma, we use the bound $1/(\\sigma'_1)^2 \\le 1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1542: \n1543: 5.  **Combine to Finalize the Bound.**\n1544:     Substituting the bounds from Step 3 and Step 4 into the expression from Step 2 yields the final result as stated in the lemma.\n1545: \n1546:     $$\n1547:     \\|\\Delta_{\\text{mean}}\\|_2^2 \\le \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1548:     $$\n1549: \n1550: **Q.E.D.**"
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-denom-shift-bound-sq",
      "title": "Bounding the Squared Denominator Shift Component",
      "start_line": 1554,
      "end_line": 1616,
      "header_lines": [
        1555
      ],
      "content_start": 1557,
      "content_end": 1615,
      "content": "1557: :label: lem-sasaki-denom-shift-bound-sq\n1558: \n1559: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the denominator shift error component, $\\Delta_{\\text{denom}} = \\mathbf z_2 \\cdot ((\\sigma'_2 - \\sigma'_1) / \\sigma'_1)$, is bounded as follows:\n1560: \n1561: Referenced by {prf:ref}`unlabeled-proof-1047`.\n1562: \n1563: $$\n1564: \\|\\Delta_{\\text{denom}}\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\left( \\frac{L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1565: \n1566: $$\n1567: \n1568: where $L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)$ is the derived Lipschitz constant for the regularized standard deviation.\n1569: \n1570: ```{dropdown} Proof\n1571: :::{prf:proof}\n1572: The proof bounds the squared norm by bounding its three constituent parts: the norm of the standardized vector, the change in the regularized standard deviation, and the inverse of the standard deviation.\n1573: \n1574: 1.  **Start with the Definition.**\n1575:     The squared L2-norm of the denominator shift component is:\n1576: \n1577:     $$\n1578:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\left\\| \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\right\\|_2^2\n1579:     $$\n1580: \n1581: 2.  **Factor out the Scalar Term.**\n1582:     The fractional term involving the standard deviations is a scalar. We factor it out of the norm:\n1583: \n1584:     $$\n1585:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\|\\mathbf z_2\\|_2^2 \\cdot \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2}\n1586:     $$\n1587: \n1588: 3.  **Bound Each Factor.**\n1589:     We now find a deterministic upper bound for each of the three factors in the expression.\n1590:     *   **Bound on `||z2||_2^2`**: The framework provides a universal bound on the squared norm of any standardized vector, proven in {prf:ref}`thm-z-score-norm-bound`. For the k-dimensional vector $\\mathbf z_2$, this is:\n1591: \n1592:         $$\n1593:         \\|\\mathbf z_2\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1594:         $$\n1595: \n1596:     *   **Bound on `(sigma'_2 - sigma'_1)^2`**: The regularized standard deviation function is Lipschitz continuous with respect to the raw value vector, as established by composing the Lipschitz properties of the aggregator moments and the patching function itself ({prf:ref}`lem-stats-value-continuity` in the framework). This gives:\n1597: \n1598:         $$\n1599:         (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1600:         $$\n1601: \n1602:     *   **Bound on `1/(sigma'_1)^2`**: As in the preceding lemmas, we use the uniform lower bound:\n1603: \n1604:         $$\n1605:         \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1606:         $$\n1607: \n1608: 4.  **Combine to Finalize the Bound.**\n1609:     Substituting the bounds for all three factors from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1610: \n1611:     $$\n1612:     \\|\\Delta_{\\text{denom}}\\|_2^2 \\le \\left( k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\right) \\cdot \\left( \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2 \\right) \\cdot \\left( \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right)\n1613:     $$\n1614:     Rearranging the terms gives the stated result.\n1615: ",
      "metadata": {
        "label": "lem-sasaki-denom-shift-bound-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "unlabeled-proof-1047",
        "thm-z-score-norm-bound",
        "lem-stats-value-continuity"
      ],
      "raw_directive": "1554: ##### 2.3.4.4. Sub-Lemma: Bounding the Squared Denominator Shift Component\n1555: \n1556: :::{prf:lemma} Bounding the Squared Denominator Shift Component\n1557: :label: lem-sasaki-denom-shift-bound-sq\n1558: \n1559: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$. Let $\\mathbf r_1$ and $\\mathbf r_2$ be two raw value vectors with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the denominator shift error component, $\\Delta_{\\text{denom}} = \\mathbf z_2 \\cdot ((\\sigma'_2 - \\sigma'_1) / \\sigma'_1)$, is bounded as follows:\n1560: \n1561: Referenced by {prf:ref}`unlabeled-proof-1047`.\n1562: \n1563: $$\n1564: \\|\\Delta_{\\text{denom}}\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\left( \\frac{L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1565: \n1566: $$\n1567: \n1568: where $L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)$ is the derived Lipschitz constant for the regularized standard deviation.\n1569: \n1570: ```{dropdown} Proof\n1571: :::{prf:proof}\n1572: The proof bounds the squared norm by bounding its three constituent parts: the norm of the standardized vector, the change in the regularized standard deviation, and the inverse of the standard deviation.\n1573: \n1574: 1.  **Start with the Definition.**\n1575:     The squared L2-norm of the denominator shift component is:\n1576: \n1577:     $$\n1578:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\left\\| \\mathbf z_2 \\cdot \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1} \\right\\|_2^2\n1579:     $$\n1580: \n1581: 2.  **Factor out the Scalar Term.**\n1582:     The fractional term involving the standard deviations is a scalar. We factor it out of the norm:\n1583: \n1584:     $$\n1585:     \\|\\Delta_{\\text{denom}}\\|_2^2 = \\|\\mathbf z_2\\|_2^2 \\cdot \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2}\n1586:     $$\n1587: \n1588: 3.  **Bound Each Factor.**\n1589:     We now find a deterministic upper bound for each of the three factors in the expression.\n1590:     *   **Bound on `||z2||_2^2`**: The framework provides a universal bound on the squared norm of any standardized vector, proven in {prf:ref}`thm-z-score-norm-bound`. For the k-dimensional vector $\\mathbf z_2$, this is:\n1591: \n1592:         $$\n1593:         \\|\\mathbf z_2\\|_2^2 \\le k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1594:         $$\n1595: \n1596:     *   **Bound on `(sigma'_2 - sigma'_1)^2`**: The regularized standard deviation function is Lipschitz continuous with respect to the raw value vector, as established by composing the Lipschitz properties of the aggregator moments and the patching function itself ({prf:ref}`lem-stats-value-continuity` in the framework). This gives:\n1597: \n1598:         $$\n1599:         (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1600:         $$\n1601: \n1602:     *   **Bound on `1/(sigma'_1)^2`**: As in the preceding lemmas, we use the uniform lower bound:\n1603: \n1604:         $$\n1605:         \\frac{1}{(\\sigma'_1)^2} \\le \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1606:         $$\n1607: \n1608: 4.  **Combine to Finalize the Bound.**\n1609:     Substituting the bounds for all three factors from Step 3 into the expression from Step 2 yields the final bound as stated in the lemma.\n1610: \n1611:     $$\n1612:     \\|\\Delta_{\\text{denom}}\\|_2^2 \\le \\left( k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\right) \\cdot \\left( \\left(L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)\\right)^2 \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2 \\right) \\cdot \\left( \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right)\n1613:     $$\n1614:     Rearranging the terms gives the stated result.\n1615: \n1616: **Q.E.D.**"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-1079",
      "title": "of {prf:ref}`thm-sasaki-standardization-value-sq`",
      "start_line": 1620,
      "end_line": 1674,
      "header_lines": [],
      "content_start": 1622,
      "content_end": 1673,
      "content": "1622: :::{prf:proof} of {prf:ref}`thm-sasaki-standardization-value-sq`\n1623: \n1624: The proof establishes the final bound by assembling the deterministic bounds for each of the three error components derived in the preceding sub-lemmas.\n1625: \n1626: **Step 1: Start with the Decomposed Error Bound.**\n1627: From the algebraic decomposition in {prf:ref}`lem-sasaki-value-error-decomposition`, the total squared value error is bounded by:\n1628: \n1629: $$\n1630: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1631: \n1632: $$\n1633: \n1634: **Step 2: Substitute the Bounds for Each Component.**\n1635: We substitute the deterministic bounds for the squared norm of each component, which all relate the component error to the squared norm of the raw value difference, $\\|\\mathbf r_1 - \\mathbf r_2\\|_2^2$.\n1636: \n1637: *   From {prf:ref}`lem-sasaki-direct-shift-bound-sq`:\n1638: \n1639:     $$\n1640:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le C_{V,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S_1) \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1641:     $$\n1642: *   From {prf:ref}`lem-sasaki-mean-shift-bound-sq`:\n1643: \n1644:     $$\n1645:     \\|\\Delta_{\\text{mean}}\\|_2^2 \\le C_{V,\\mathrm{mean}}^{\\mathrm{sq}}(\\mathcal S_1) \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1646:     $$\n1647: *   From {prf:ref}`lem-sasaki-denom-shift-bound-sq`:\n1648: \n1649:     $$\n1650:     \\|\\Delta_{\\text{denom}}\\|_2^2 \\le C_{V,\\mathrm{denom}}^{\\mathrm{sq}}(\\mathcal S_1) \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1651:     $$\n1652: \n1653: **Step 3: Combine and Factor.**\n1654: Substituting these into the inequality from Step 1 and factoring out the common term $\\|\\mathbf r_1 - \\mathbf r_2\\|_2^2$ gives:\n1655: \n1656: $$\n1657: \\|z_1 - z_2\\|_2^2 \\le 3 \\left( C_{V,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S_1) + C_{V,\\mathrm{mean}}^{\\mathrm{sq}}(\\mathcal S_1) + C_{V,\\mathrm{denom}}^{\\mathrm{sq}}(\\mathcal S_1) \\right) \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1658: \n1659: $$\n1660: \n1661: By definition ({prf:ref}`def-sasaki-standardization-constants-sq`), the term in parentheses is the **Total Value Error Coefficient**, $C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S_1)$.\n1662: \n1663: **Step 4: Relate Raw Value Error to Positional Displacement.**\n1664: The raw reward vector difference is bounded by the positional displacement via the Lipschitz continuity of the reward function ({prf:ref}`lem-euclidean-reward-regularity`):\n1665: \n1666: $$\n1667: \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2 = \\sum_{i \\in \\mathcal A} |R(x_{1,i},v_{1,i}) - R(x_{2,i},v_{2,i})|^2 \\le \\sum_{i \\in \\mathcal A} \\left(L_R^{\\mathrm{Sasaki}}\\right)^2 d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i}))^2 \\le \\left(L_R^{\\mathrm{Sasaki}}\\right)^2 \\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2)\n1668: \n1669: $$\n1670: \n1671: **Step 5: Final Assembly.**\n1672: Substituting the bound from Step 4 into the inequality from Step 3 yields the final result. The constant of proportionality in the theorem statement absorbs the Lipschitz constant of the reward function. For clarity, we can redefine the total coefficient to include this factor, or leave it explicit as shown here. Let's define a new total coefficient to match the theorem statement:\n1673: $C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}} := 3 \\cdot \\left( C_{V,\\mathrm{direct}}^{\\mathrm{sq}} + \\dots \\right) \\cdot (L_R^{\\mathrm{Sasaki}})^2$. This completes the proof.",
      "metadata": {},
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-sasaki-value-error-decomposition",
        "lem-sasaki-direct-shift-bound-sq",
        "lem-sasaki-mean-shift-bound-sq",
        "lem-sasaki-denom-shift-bound-sq",
        "def-sasaki-standardization-constants-sq",
        "lem-euclidean-reward-regularity"
      ],
      "raw_directive": "1620: ##### 2.3.4.5. Proof of Theorem 2.3.4\n1621: \n1622: :::{prf:proof} of {prf:ref}`thm-sasaki-standardization-value-sq`\n1623: \n1624: The proof establishes the final bound by assembling the deterministic bounds for each of the three error components derived in the preceding sub-lemmas.\n1625: \n1626: **Step 1: Start with the Decomposed Error Bound.**\n1627: From the algebraic decomposition in {prf:ref}`lem-sasaki-value-error-decomposition`, the total squared value error is bounded by:\n1628: \n1629: $$\n1630: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2 \\le 3\\left( \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{mean}}\\|_2^2 + \\|\\Delta_{\\text{denom}}\\|_2^2 \\right)\n1631: \n1632: $$\n1633: \n1634: **Step 2: Substitute the Bounds for Each Component.**\n1635: We substitute the deterministic bounds for the squared norm of each component, which all relate the component error to the squared norm of the raw value difference, $\\|\\mathbf r_1 - \\mathbf r_2\\|_2^2$.\n1636: \n1637: *   From {prf:ref}`lem-sasaki-direct-shift-bound-sq`:\n1638: \n1639:     $$\n1640:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le C_{V,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S_1) \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1641:     $$\n1642: *   From {prf:ref}`lem-sasaki-mean-shift-bound-sq`:\n1643: \n1644:     $$\n1645:     \\|\\Delta_{\\text{mean}}\\|_2^2 \\le C_{V,\\mathrm{mean}}^{\\mathrm{sq}}(\\mathcal S_1) \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1646:     $$\n1647: *   From {prf:ref}`lem-sasaki-denom-shift-bound-sq`:\n1648: \n1649:     $$\n1650:     \\|\\Delta_{\\text{denom}}\\|_2^2 \\le C_{V,\\mathrm{denom}}^{\\mathrm{sq}}(\\mathcal S_1) \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1651:     $$\n1652: \n1653: **Step 3: Combine and Factor.**\n1654: Substituting these into the inequality from Step 1 and factoring out the common term $\\|\\mathbf r_1 - \\mathbf r_2\\|_2^2$ gives:\n1655: \n1656: $$\n1657: \\|z_1 - z_2\\|_2^2 \\le 3 \\left( C_{V,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S_1) + C_{V,\\mathrm{mean}}^{\\mathrm{sq}}(\\mathcal S_1) + C_{V,\\mathrm{denom}}^{\\mathrm{sq}}(\\mathcal S_1) \\right) \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n1658: \n1659: $$\n1660: \n1661: By definition ({prf:ref}`def-sasaki-standardization-constants-sq`), the term in parentheses is the **Total Value Error Coefficient**, $C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S_1)$.\n1662: \n1663: **Step 4: Relate Raw Value Error to Positional Displacement.**\n1664: The raw reward vector difference is bounded by the positional displacement via the Lipschitz continuity of the reward function ({prf:ref}`lem-euclidean-reward-regularity`):\n1665: \n1666: $$\n1667: \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2 = \\sum_{i \\in \\mathcal A} |R(x_{1,i},v_{1,i}) - R(x_{2,i},v_{2,i})|^2 \\le \\sum_{i \\in \\mathcal A} \\left(L_R^{\\mathrm{Sasaki}}\\right)^2 d_{\\mathcal Y}^{\\mathrm{Sasaki}}(\\varphi(w_{1,i}), \\varphi(w_{2,i}))^2 \\le \\left(L_R^{\\mathrm{Sasaki}}\\right)^2 \\Delta_{\\mathrm{pos,Sasaki}}^2(\\mathcal S_1,\\mathcal S_2)\n1668: \n1669: $$\n1670: \n1671: **Step 5: Final Assembly.**\n1672: Substituting the bound from Step 4 into the inequality from Step 3 yields the final result. The constant of proportionality in the theorem statement absorbs the Lipschitz constant of the reward function. For clarity, we can redefine the total coefficient to include this factor, or leave it explicit as shown here. Let's define a new total coefficient to match the theorem statement:\n1673: $C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}} := 3 \\cdot \\left( C_{V,\\mathrm{direct}}^{\\mathrm{sq}} + \\dots \\right) \\cdot (L_R^{\\mathrm{Sasaki}})^2$. This completes the proof.\n1674: "
    },
    {
      "directive_type": "definition",
      "label": "def-sasaki-standardization-constants-sq",
      "title": "Value Error Coefficients (Squared Form)",
      "start_line": 1678,
      "end_line": 1710,
      "header_lines": [
        1679
      ],
      "content_start": 1681,
      "content_end": 1709,
      "content": "1681: :label: def-sasaki-standardization-constants-sq\n1682: \n1683: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$, and let $M$ be the chosen **Swarm Aggregation Operator**. The coefficients for the bounds on the squared value error are defined as follows:\n1684: \n1685: Referenced by {prf:ref}`unlabeled-proof-1047` and {prf:ref}`thm-sasaki-standardization-value-sq`.\n1686: \n1687: 1.  **The Squared Direct Shift Coefficient ($C_{V,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S)$):**\n1688: \n1689:     $$\n1690:     C_{V,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S) := \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1691:     $$\n1692: \n1693: 2.  **The Squared Mean Shift Coefficient ($C_{V,\\mathrm{mean}}^{\\mathrm{sq}}(\\mathcal S)$):**\n1694: \n1695:     $$\n1696:     C_{V,\\mathrm{mean}}^{\\mathrm{sq}}(\\mathcal S) := \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1697:     $$\n1698: \n1699: 3.  **The Squared Denominator Shift Coefficient ($C_{V,\\mathrm{denom}}^{\\mathrm{sq}}(\\mathcal S)$):**\n1700: \n1701:     $$\n1702:     C_{V,\\mathrm{denom}}^{\\mathrm{sq}}(\\mathcal S) := k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\left( \\frac{L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1703:     $$\n1704: \n1705: 4.  **The Total Value Error Coefficient ($C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S)$):** The composite coefficient that bounds the total squared value error, incorporating the factor of 3 from the error decomposition.\n1706: \n1707:     $$\n1708:     C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S) := 3 \\cdot \\left( C_{V,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S) + C_{V,\\mathrm{mean}}^{\\mathrm{sq}}(\\mathcal S) + C_{V,\\mathrm{denom}}^{\\mathrm{sq}}(\\mathcal S) \\right)\n1709:     $$",
      "metadata": {
        "label": "def-sasaki-standardization-constants-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "unlabeled-proof-1047",
        "thm-sasaki-standardization-value-sq"
      ],
      "raw_directive": "1678: ##### 2.3.5. Definition: Value Error Coefficients (Squared Form)\n1679: \n1680: :::{prf:definition} Value Error Coefficients (Squared Form)\n1681: :label: def-sasaki-standardization-constants-sq\n1682: \n1683: Let $\\mathcal S$ be a fixed swarm state with alive set $\\mathcal A$ of size $k \\ge 1$, and let $M$ be the chosen **Swarm Aggregation Operator**. The coefficients for the bounds on the squared value error are defined as follows:\n1684: \n1685: Referenced by {prf:ref}`unlabeled-proof-1047` and {prf:ref}`thm-sasaki-standardization-value-sq`.\n1686: \n1687: 1.  **The Squared Direct Shift Coefficient ($C_{V,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S)$):**\n1688: \n1689:     $$\n1690:     C_{V,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S) := \\frac{1}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1691:     $$\n1692: \n1693: 2.  **The Squared Mean Shift Coefficient ($C_{V,\\mathrm{mean}}^{\\mathrm{sq}}(\\mathcal S)$):**\n1694: \n1695:     $$\n1696:     C_{V,\\mathrm{mean}}^{\\mathrm{sq}}(\\mathcal S) := \\frac{k \\cdot (L_{\\mu,M}^{\\mathrm{Sasaki}}(k))^2}{\\sigma_{\\min,\\mathrm{patch}}^2}\n1697:     $$\n1698: \n1699: 3.  **The Squared Denominator Shift Coefficient ($C_{V,\\mathrm{denom}}^{\\mathrm{sq}}(\\mathcal S)$):**\n1700: \n1701:     $$\n1702:     C_{V,\\mathrm{denom}}^{\\mathrm{sq}}(\\mathcal S) := k \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\left( \\frac{L_{\\sigma',M}^{\\mathrm{Sasaki}}(k)}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1703:     $$\n1704: \n1705: 4.  **The Total Value Error Coefficient ($C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S)$):** The composite coefficient that bounds the total squared value error, incorporating the factor of 3 from the error decomposition.\n1706: \n1707:     $$\n1708:     C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S) := 3 \\cdot \\left( C_{V,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S) + C_{V,\\mathrm{mean}}^{\\mathrm{sq}}(\\mathcal S) + C_{V,\\mathrm{denom}}^{\\mathrm{sq}}(\\mathcal S) \\right)\n1709:     $$\n1710: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-sasaki-standardization-structural-sq",
      "title": "Structural Continuity of Patched Standardization (Sasaki)",
      "start_line": 1714,
      "end_line": 1727,
      "header_lines": [
        1715
      ],
      "content_start": 1717,
      "content_end": 1726,
      "content": "1717: :label: thm-sasaki-standardization-structural-sq\n1718: \n1719: For general swarms $\\mathcal S_1,\\mathcal S_2$ with alive counts $k_r\\ge 1$, the squared L2-norm of the output error of the standardization operator is bounded by a function of the number of status changes, $n_c(\\mathcal S_1,\\mathcal S_2)$.\n1720: \n1721: Referenced by {prf:ref}`def-sasaki-structural-coeffs-sq` and {prf:ref}`lem-sasaki-standardization-lipschitz`.\n1722: \n1723: $$\n1724: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2 \\le C_{S,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2) + C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1725: \n1726: $$",
      "metadata": {
        "label": "thm-sasaki-standardization-structural-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-sasaki-structural-coeffs-sq",
        "lem-sasaki-standardization-lipschitz"
      ],
      "raw_directive": "1714: ###### 2.3.6. Theorem: Structural Continuity of Patched Standardization (Sasaki)\n1715: \n1716: :::{prf:theorem} Structural Continuity of Patched Standardization (Sasaki)\n1717: :label: thm-sasaki-standardization-structural-sq\n1718: \n1719: For general swarms $\\mathcal S_1,\\mathcal S_2$ with alive counts $k_r\\ge 1$, the squared L2-norm of the output error of the standardization operator is bounded by a function of the number of status changes, $n_c(\\mathcal S_1,\\mathcal S_2)$.\n1720: \n1721: Referenced by {prf:ref}`def-sasaki-structural-coeffs-sq` and {prf:ref}`lem-sasaki-standardization-lipschitz`.\n1722: \n1723: $$\n1724: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2 \\le C_{S,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2) + C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1725: \n1726: $$\n1727: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-structural-error-decomposition",
      "title": "Decomposition of the Structural Error",
      "start_line": 1731,
      "end_line": 1785,
      "header_lines": [
        1732
      ],
      "content_start": 1734,
      "content_end": 1784,
      "content": "1734: :label: lem-sasaki-structural-error-decomposition\n1735: \n1736: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. Let $\\mathbf z_1 = z(\\mathcal S_1, \\mathbf r_2)$ and $\\mathbf z_2 = z(\\mathcal S_2, \\mathbf r_2)$ be the corresponding N-dimensional standardized vectors, computed using the fixed raw values from the second swarm but the structure of each respective swarm.\n1737: \n1738: Referenced by {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1739: \n1740: The total structural error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of two **orthogonal** components:\n1741: \n1742: $$\n1743: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\n1744: \n1745: $$\n1746: \n1747: where:\n1748: 1.  **The Direct Error ($\\Delta_{\\text{direct}}$):** The error vector whose non-zero components correspond to walkers whose status changes between $\\mathcal S_1$ and $\\mathcal S_2$.\n1749: 2.  **The Indirect Error ($\\Delta_{\\text{indirect}}$):** The error vector whose non-zero components correspond to walkers that are alive in both swarms.\n1750: \n1751: Because these two vectors have disjoint support, the squared L2-norm of the total error is the sum of the squared L2-norms of the components:\n1752: \n1753: $$\n1754: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1755: \n1756: $$\n1757: \n1758: ```{dropdown} Proof\n1759: :::{prf:proof}\n1760: The proof follows from partitioning the sum of squared errors over the N walker indices. Let the full set of indices be $\\{1, ..., N\\}$.\n1761: \n1762: 1.  **Define Index Partitions.**\n1763:     Let $\\mathcal{A}_{\\text{unstable}} := \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$ be the set of indices of walkers whose survival status changes. Let $\\mathcal{A}_{\\text{stable}} := \\mathcal{A}(\\mathcal S_1) \\cap \\mathcal{A}(\\mathcal S_2)$ be the set of indices for walkers that remain alive. Let $\\mathcal{D}_{\\text{stable}}$ be the indices of walkers dead in both swarms. These three sets form a partition of $\\{1, ..., N\\}$.\n1764: \n1765: 2.  **Analyze Error Components on Each Partition.**\n1766:     *   For $i \\in \\mathcal{A}_{\\text{unstable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero.\n1767:     *   For $i \\in \\mathcal{A}_{\\text{stable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero because the statistical moments $(\\mu, \\sigma')$ change with the swarm structure.\n1768:     *   For $i \\in \\mathcal{D}_{\\text{stable}}$, both $z_{1,i}$ and $z_{2,i}$ are deterministically zero by the definition of the standardization operator. The error component is zero.\n1769: \n1770: 3.  **Define Orthogonal Error Vectors.**\n1771:     We define the vector $\\Delta_{\\text{direct}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{unstable}}$ and zero otherwise. We define $\\Delta_{\\text{indirect}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{stable}}$ and zero otherwise. By construction, $\\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}$.\n1772: \n1773: 4.  **Show Orthogonality.**\n1774:     The two vectors have disjoint support, meaning for any index $i$, at most one of the vectors can have a non-zero component. Therefore, their dot product is zero: $\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}} = 0$.\n1775: \n1776: 5.  **Finalize the Squared Norm Identity.**\n1777:     For orthogonal vectors, the squared norm of the sum is the sum of the squared norms:\n1778: \n1779:     $$\n1780:     \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2 + 2(\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}}) = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1781:     $$\n1782: \n1783: This completes the proof.\n1784: ",
      "metadata": {
        "label": "lem-sasaki-structural-error-decomposition"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-sasaki-structural-coeffs-sq"
      ],
      "raw_directive": "1731: ##### 2.3.6.1. Sub-Lemma: Decomposition of the Structural Error\n1732: \n1733: :::{prf:lemma} Decomposition of the Structural Error\n1734: :label: lem-sasaki-structural-error-decomposition\n1735: \n1736: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. Let $\\mathbf z_1 = z(\\mathcal S_1, \\mathbf r_2)$ and $\\mathbf z_2 = z(\\mathcal S_2, \\mathbf r_2)$ be the corresponding N-dimensional standardized vectors, computed using the fixed raw values from the second swarm but the structure of each respective swarm.\n1737: \n1738: Referenced by {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1739: \n1740: The total structural error vector, $\\Delta\\mathbf{z} = \\mathbf z_1 - \\mathbf z_2$, can be expressed as the sum of two **orthogonal** components:\n1741: \n1742: $$\n1743: \\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\n1744: \n1745: $$\n1746: \n1747: where:\n1748: 1.  **The Direct Error ($\\Delta_{\\text{direct}}$):** The error vector whose non-zero components correspond to walkers whose status changes between $\\mathcal S_1$ and $\\mathcal S_2$.\n1749: 2.  **The Indirect Error ($\\Delta_{\\text{indirect}}$):** The error vector whose non-zero components correspond to walkers that are alive in both swarms.\n1750: \n1751: Because these two vectors have disjoint support, the squared L2-norm of the total error is the sum of the squared L2-norms of the components:\n1752: \n1753: $$\n1754: \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1755: \n1756: $$\n1757: \n1758: ```{dropdown} Proof\n1759: :::{prf:proof}\n1760: The proof follows from partitioning the sum of squared errors over the N walker indices. Let the full set of indices be $\\{1, ..., N\\}$.\n1761: \n1762: 1.  **Define Index Partitions.**\n1763:     Let $\\mathcal{A}_{\\text{unstable}} := \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$ be the set of indices of walkers whose survival status changes. Let $\\mathcal{A}_{\\text{stable}} := \\mathcal{A}(\\mathcal S_1) \\cap \\mathcal{A}(\\mathcal S_2)$ be the set of indices for walkers that remain alive. Let $\\mathcal{D}_{\\text{stable}}$ be the indices of walkers dead in both swarms. These three sets form a partition of $\\{1, ..., N\\}$.\n1764: \n1765: 2.  **Analyze Error Components on Each Partition.**\n1766:     *   For $i \\in \\mathcal{A}_{\\text{unstable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero.\n1767:     *   For $i \\in \\mathcal{A}_{\\text{stable}}$, the error component $(z_{1,i} - z_{2,i})$ is generally non-zero because the statistical moments $(\\mu, \\sigma')$ change with the swarm structure.\n1768:     *   For $i \\in \\mathcal{D}_{\\text{stable}}$, both $z_{1,i}$ and $z_{2,i}$ are deterministically zero by the definition of the standardization operator. The error component is zero.\n1769: \n1770: 3.  **Define Orthogonal Error Vectors.**\n1771:     We define the vector $\\Delta_{\\text{direct}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{unstable}}$ and zero otherwise. We define $\\Delta_{\\text{indirect}}$ such that its components are $(\\Delta\\mathbf{z})_i$ for $i \\in \\mathcal{A}_{\\text{stable}}$ and zero otherwise. By construction, $\\Delta\\mathbf{z} = \\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}$.\n1772: \n1773: 4.  **Show Orthogonality.**\n1774:     The two vectors have disjoint support, meaning for any index $i$, at most one of the vectors can have a non-zero component. Therefore, their dot product is zero: $\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}} = 0$.\n1775: \n1776: 5.  **Finalize the Squared Norm Identity.**\n1777:     For orthogonal vectors, the squared norm of the sum is the sum of the squared norms:\n1778: \n1779:     $$\n1780:     \\|\\Delta\\mathbf{z}\\|_2^2 = \\|\\Delta_{\\text{direct}} + \\Delta_{\\text{indirect}}\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2 + 2(\\Delta_{\\text{direct}} \\cdot \\Delta_{\\text{indirect}}) = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1781:     $$\n1782: \n1783: This completes the proof.\n1784: \n1785: **Q.E.D.**"
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-direct-structural-error-sq",
      "title": "Bound on the Squared Direct Structural Error",
      "start_line": 1789,
      "end_line": 1841,
      "header_lines": [
        1790
      ],
      "content_start": 1792,
      "content_end": 1840,
      "content": "1792: :label: lem-sasaki-direct-structural-error-sq\n1793: \n1794: Let $\\mathbf r_2$ be a fixed raw value vector with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the direct structural error component, $\\|\\Delta_{\\text{direct}}\\|_2^2$, is bounded by a term linear in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1795: \n1796: Referenced by {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1797: \n1798: $$\n1799: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1800: \n1801: $$\n1802: \n1803: ```{dropdown} Proof\n1804: :::{prf:proof}\n1805: The proof bounds the squared error for each unstable walker and sums the results.\n1806: \n1807: 1.  **Isolate the Sum.**\n1808:     By definition, the vector $\\Delta_{\\text{direct}}$ has non-zero components only for walkers in the unstable set $\\mathcal{A}_{\\text{unstable}} = \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$. The number of walkers in this set is exactly $n_c = n_c(\\mathcal S_1, \\mathcal S_2)$. The squared norm is the sum of the squared errors over this set:\n1809: \n1810:     $$\n1811:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2\n1812:     $$\n1813: \n1814: 2.  **Bound the Error for a Single Unstable Walker.**\n1815:     Consider a single walker $i \\in \\mathcal{A}_{\\text{unstable}}$. Its status changes between $\\mathcal S_1$ and $\\mathcal S_2$. This means one of two cases:\n1816:     *   Case A: Walker $i$ is alive in $\\mathcal S_1$ and dead in $\\mathcal S_2$. Then $z_{2,i} = 0$. The error is $(z_{1,i})^2$.\n1817:     *   Case B: Walker $i$ is dead in $\\mathcal S_1$ and alive in $\\mathcal S_2$. Then $z_{1,i} = 0$. The error is $(-z_{2,i})^2 = (z_{2,i})^2$.\n1818: \n1819:     In both cases, the squared error for walker $i$ is the square of a single, valid standardized score.\n1820: \n1821: 3.  **Apply the Universal Z-Score Bound.**\n1822:     The framework provides a universal bound for the magnitude of any single standardized score in {prf:ref}`thm-z-score-norm-bound`, which is $|z_j| \\le 2V_{\\max}^{(R)} / \\sigma_{\\min,\\mathrm{patch}}$. Squaring this gives a uniform bound for the squared error of any unstable walker:\n1823: \n1824:     $$\n1825:     (z_{1,i} - z_{2,i})^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1826:     $$\n1827: \n1828: 4.  **Sum Over All Unstable Walkers.**\n1829:     We sum this uniform bound over all $n_c$ walkers in the unstable set:\n1830: \n1831:     $$\n1832:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i=1}^{n_c} \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1833:     $$\n1834: \n1835:     This yields the final result as stated in the lemma.\n1836: \n1837:     $$\n1838:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le n_c \\cdot \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1839:     $$\n1840: ",
      "metadata": {
        "label": "lem-sasaki-direct-structural-error-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-sasaki-structural-coeffs-sq",
        "thm-z-score-norm-bound"
      ],
      "raw_directive": "1789: ##### 2.3.6.2. Sub-Lemma: Bounding the Squared Direct Structural Error\n1790: \n1791: :::{prf:lemma} Bound on the Squared Direct Structural Error\n1792: :label: lem-sasaki-direct-structural-error-sq\n1793: \n1794: Let $\\mathbf r_2$ be a fixed raw value vector with components bounded by $V_{\\max}^{(R)}$. The squared Euclidean norm of the direct structural error component, $\\|\\Delta_{\\text{direct}}\\|_2^2$, is bounded by a term linear in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1795: \n1796: Referenced by {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1797: \n1798: $$\n1799: \\|\\Delta_{\\text{direct}}\\|_2^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2 \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1800: \n1801: $$\n1802: \n1803: ```{dropdown} Proof\n1804: :::{prf:proof}\n1805: The proof bounds the squared error for each unstable walker and sums the results.\n1806: \n1807: 1.  **Isolate the Sum.**\n1808:     By definition, the vector $\\Delta_{\\text{direct}}$ has non-zero components only for walkers in the unstable set $\\mathcal{A}_{\\text{unstable}} = \\mathcal{A}(\\mathcal S_1) \\triangle \\mathcal{A}(\\mathcal S_2)$. The number of walkers in this set is exactly $n_c = n_c(\\mathcal S_1, \\mathcal S_2)$. The squared norm is the sum of the squared errors over this set:\n1809: \n1810:     $$\n1811:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2\n1812:     $$\n1813: \n1814: 2.  **Bound the Error for a Single Unstable Walker.**\n1815:     Consider a single walker $i \\in \\mathcal{A}_{\\text{unstable}}$. Its status changes between $\\mathcal S_1$ and $\\mathcal S_2$. This means one of two cases:\n1816:     *   Case A: Walker $i$ is alive in $\\mathcal S_1$ and dead in $\\mathcal S_2$. Then $z_{2,i} = 0$. The error is $(z_{1,i})^2$.\n1817:     *   Case B: Walker $i$ is dead in $\\mathcal S_1$ and alive in $\\mathcal S_2$. Then $z_{1,i} = 0$. The error is $(-z_{2,i})^2 = (z_{2,i})^2$.\n1818: \n1819:     In both cases, the squared error for walker $i$ is the square of a single, valid standardized score.\n1820: \n1821: 3.  **Apply the Universal Z-Score Bound.**\n1822:     The framework provides a universal bound for the magnitude of any single standardized score in {prf:ref}`thm-z-score-norm-bound`, which is $|z_j| \\le 2V_{\\max}^{(R)} / \\sigma_{\\min,\\mathrm{patch}}$. Squaring this gives a uniform bound for the squared error of any unstable walker:\n1823: \n1824:     $$\n1825:     (z_{1,i} - z_{2,i})^2 \\le \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1826:     $$\n1827: \n1828: 4.  **Sum Over All Unstable Walkers.**\n1829:     We sum this uniform bound over all $n_c$ walkers in the unstable set:\n1830: \n1831:     $$\n1832:     \\|\\Delta_{\\text{direct}}\\|_2^2 = \\sum_{i \\in \\mathcal{A}_{\\text{unstable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i=1}^{n_c} \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1833:     $$\n1834: \n1835:     This yields the final result as stated in the lemma.\n1836: \n1837:     $$\n1838:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le n_c \\cdot \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1839:     $$\n1840: \n1841: **Q.E.D.**"
    },
    {
      "directive_type": "lemma",
      "label": "lem-sasaki-indirect-structural-error-sq",
      "title": "Bound on the Squared Indirect Structural Error",
      "start_line": 1845,
      "end_line": 1933,
      "header_lines": [
        1846
      ],
      "content_start": 1848,
      "content_end": 1932,
      "content": "1848: :label: lem-sasaki-indirect-structural-error-sq\n1849: \n1850: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. The squared Euclidean norm of the indirect structural error component, $\\|\\Delta_{\\text{indirect}}\\|_2^2$, is bounded by a term quadratic in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1851: \n1852: Referenced by {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1853: \n1854: $$\n1855: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1856: \n1857: $$\n1858: \n1859: where $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}$ is the **Squared Indirect Structural Error Coefficient** defined in {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1860: \n1861: ```{dropdown} Proof\n1862: :::{prf:proof}\n1863: The proof decomposes the error for each stable walker into a mean-shift and a denominator-shift component and then bounds the sum of their squares.\n1864: \n1865: **Step 1: Decompose the Error for a Single Stable Walker.**\n1866: For any walker $i$ in the stable set $\\mathcal A_{\\mathrm{stable}} = \\mathcal A(\\mathcal S_1) \\cap \\mathcal A(\\mathcal S_2)$, the error is:\n1867: \n1868: $$\n1869: \\begin{aligned}\n1870: z_{1,i} - z_{2,i} &= \\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2} \\\\\n1871: &= \\left(\\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_1}\\right) + \\left(\\frac{r_{2,i} - \\mu_2}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2}\\right) \\\\\n1872: &= \\underbrace{\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}}_{\\text{Mean Shift}} + \\underbrace{z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}}_{\\text{Denominator Shift}}\n1873: \\end{aligned}\n1874: \n1875: $$\n1876: The squared error for this single walker is bounded using $(a+b)^2 \\le 2(a^2+b^2)$:\n1877: \n1878: $$\n1879: (z_{1,i} - z_{2,i})^2 \\le 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1880: \n1881: $$\n1882: \n1883: **Step 2: Sum the Errors Over All Stable Walkers.**\n1884: The total squared indirect error is the sum over all $i \\in \\mathcal A_{\\mathrm{stable}}$. Let $k_{\\mathrm{stable}} := |\\mathcal A_{\\mathrm{stable}}|$.\n1885: \n1886: $$\n1887: \\|\\Delta_{\\text{indirect}}\\|_2^2 = \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1888: \n1889: $$\n1890: \n1891: This can be simplified:\n1892: \n1893: $$\n1894: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} + 2 \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2} \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2\n1895: \n1896: $$\n1897: \n1898: **Step 3: Bound the Components.**\n1899: We now bound each term using the axiomatic properties of the aggregator and the uniform bounds from the framework.\n1900: *   **Bound on `(mu_2 - mu_1)^2`**: The structural continuity of the empirical mean ({prf:ref}`lem-sasaki-aggregator-structural`) gives:\n1901: \n1902:     $$\n1903:     (\\mu_2 - \\mu_1)^2 \\le \\left(L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min}) \\cdot n_c\\right)^2\n1904:     $$\n1905: *   **Bound on `(sigma'_2 - sigma'_1)^2`**: By composing the structural continuity of the variance with the Lipschitz property of the patching function ({prf:ref}`lem-stats-structural-continuity` in the framework), we get:\n1906: \n1907:     $$\n1908:     (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',S}^{\\mathrm{Sasaki}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c\\right)^2\n1909:     $$\n1910: *   **Bound on `sum(z_2,i^2)`**: The sum is over the stable set, which is a subset of the alive walkers in $\\mathcal S_2$. Thus, the sum is bounded by the total squared norm of the z-score vector for $\\mathcal S_2$:\n1911: \n1912:     $$\n1913:     \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2 \\le \\|\\mathbf z_2\\|_2^2 \\le k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1914:     $$\n1915: *   **Bound on `1/(sigma'_1)^2`**: This is bounded by $1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1916: \n1917: **Step 4: Assemble the Final Bound.**\n1918: Substituting these bounds back into the inequality from Step 2 gives a bound that is quadratic in $n_c$.\n1919: \n1920: $$\n1921: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 \\frac{(L_{\\sigma',S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1922: \n1923: $$\n1924: \n1925: Factoring out $n_c^2$ and combining the coefficients gives:\n1926: \n1927: $$\n1928: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le \\left[ 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2 \\frac{(L_{\\sigma',S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right] \\cdot n_c^2\n1929: \n1930: $$\n1931: The term in the brackets is precisely the definition of the **Squared Indirect Structural Error Coefficient**, $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2)$. This completes the proof.\n1932: ",
      "metadata": {
        "label": "lem-sasaki-indirect-structural-error-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "def-sasaki-structural-coeffs-sq",
        "lem-sasaki-aggregator-structural",
        "lem-stats-structural-continuity"
      ],
      "raw_directive": "1845: ##### 2.3.6.3. Sub-Lemma: Bounding the Squared Indirect Structural Error\n1846: \n1847: :::{prf:lemma} Bound on the Squared Indirect Structural Error\n1848: :label: lem-sasaki-indirect-structural-error-sq\n1849: \n1850: Let $\\mathbf r_2$ be a fixed raw value vector. Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states. The squared Euclidean norm of the indirect structural error component, $\\|\\Delta_{\\text{indirect}}\\|_2^2$, is bounded by a term quadratic in the number of status changes, $n_c(\\mathcal S_1, \\mathcal S_2)$.\n1851: \n1852: Referenced by {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1853: \n1854: $$\n1855: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1856: \n1857: $$\n1858: \n1859: where $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}$ is the **Squared Indirect Structural Error Coefficient** defined in {prf:ref}`def-sasaki-structural-coeffs-sq`.\n1860: \n1861: ```{dropdown} Proof\n1862: :::{prf:proof}\n1863: The proof decomposes the error for each stable walker into a mean-shift and a denominator-shift component and then bounds the sum of their squares.\n1864: \n1865: **Step 1: Decompose the Error for a Single Stable Walker.**\n1866: For any walker $i$ in the stable set $\\mathcal A_{\\mathrm{stable}} = \\mathcal A(\\mathcal S_1) \\cap \\mathcal A(\\mathcal S_2)$, the error is:\n1867: \n1868: $$\n1869: \\begin{aligned}\n1870: z_{1,i} - z_{2,i} &= \\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2} \\\\\n1871: &= \\left(\\frac{r_{2,i} - \\mu_1}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_1}\\right) + \\left(\\frac{r_{2,i} - \\mu_2}{\\sigma'_1} - \\frac{r_{2,i} - \\mu_2}{\\sigma'_2}\\right) \\\\\n1872: &= \\underbrace{\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}}_{\\text{Mean Shift}} + \\underbrace{z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}}_{\\text{Denominator Shift}}\n1873: \\end{aligned}\n1874: \n1875: $$\n1876: The squared error for this single walker is bounded using $(a+b)^2 \\le 2(a^2+b^2)$:\n1877: \n1878: $$\n1879: (z_{1,i} - z_{2,i})^2 \\le 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1880: \n1881: $$\n1882: \n1883: **Step 2: Sum the Errors Over All Stable Walkers.**\n1884: The total squared indirect error is the sum over all $i \\in \\mathcal A_{\\mathrm{stable}}$. Let $k_{\\mathrm{stable}} := |\\mathcal A_{\\mathrm{stable}}|$.\n1885: \n1886: $$\n1887: \\|\\Delta_{\\text{indirect}}\\|_2^2 = \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{1,i} - z_{2,i})^2 \\le \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(\\frac{\\mu_2 - \\mu_1}{\\sigma'_1}\\right)^2 + \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} 2\\left(z_{2,i} \\frac{\\sigma'_2 - \\sigma'_1}{\\sigma'_1}\\right)^2\n1888: \n1889: $$\n1890: \n1891: This can be simplified:\n1892: \n1893: $$\n1894: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(\\mu_2 - \\mu_1)^2}{(\\sigma'_1)^2} + 2 \\frac{(\\sigma'_2 - \\sigma'_1)^2}{(\\sigma'_1)^2} \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2\n1895: \n1896: $$\n1897: \n1898: **Step 3: Bound the Components.**\n1899: We now bound each term using the axiomatic properties of the aggregator and the uniform bounds from the framework.\n1900: *   **Bound on `(mu_2 - mu_1)^2`**: The structural continuity of the empirical mean ({prf:ref}`lem-sasaki-aggregator-structural`) gives:\n1901: \n1902:     $$\n1903:     (\\mu_2 - \\mu_1)^2 \\le \\left(L_{\\mu,S}^{\\mathrm{Sasaki}}(k_{\\min}) \\cdot n_c\\right)^2\n1904:     $$\n1905: *   **Bound on `(sigma'_2 - sigma'_1)^2`**: By composing the structural continuity of the variance with the Lipschitz property of the patching function ({prf:ref}`lem-stats-structural-continuity` in the framework), we get:\n1906: \n1907:     $$\n1908:     (\\sigma'_2 - \\sigma'_1)^2 \\le \\left(L_{\\sigma',S}^{\\mathrm{Sasaki}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c\\right)^2\n1909:     $$\n1910: *   **Bound on `sum(z_2,i^2)`**: The sum is over the stable set, which is a subset of the alive walkers in $\\mathcal S_2$. Thus, the sum is bounded by the total squared norm of the z-score vector for $\\mathcal S_2$:\n1911: \n1912:     $$\n1913:     \\sum_{i \\in \\mathcal A_{\\mathrm{stable}}} (z_{2,i})^2 \\le \\|\\mathbf z_2\\|_2^2 \\le k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1914:     $$\n1915: *   **Bound on `1/(sigma'_1)^2`**: This is bounded by $1/\\sigma_{\\min,\\mathrm{patch}}^2$.\n1916: \n1917: **Step 4: Assemble the Final Bound.**\n1918: Substituting these bounds back into the inequality from Step 2 gives a bound that is quadratic in $n_c$.\n1919: \n1920: $$\n1921: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 \\frac{(L_{\\sigma',S})^2 n_c^2}{\\sigma_{\\min,\\mathrm{patch}}^2} k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2\n1922: \n1923: $$\n1924: \n1925: Factoring out $n_c^2$ and combining the coefficients gives:\n1926: \n1927: $$\n1928: \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le \\left[ 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} + 2 k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2 \\frac{(L_{\\sigma',S})^2}{\\sigma_{\\min,\\mathrm{patch}}^2} \\right] \\cdot n_c^2\n1929: \n1930: $$\n1931: The term in the brackets is precisely the definition of the **Squared Indirect Structural Error Coefficient**, $C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2)$. This completes the proof.\n1932: \n1933: **Q.E.D.**"
    },
    {
      "directive_type": "proof",
      "label": "def-sasaki-structural-coeffs-sq",
      "title": "of {prf:ref}`thm-sasaki-standardization-structural-sq`",
      "start_line": 1937,
      "end_line": 1995,
      "header_lines": [
        1978
      ],
      "content_start": 1938,
      "content_end": 1994,
      "content": "1938: \n1939: :::{prf:proof} of {prf:ref}`thm-sasaki-standardization-structural-sq`\n1940: The proof establishes the final bound by assembling the deterministic bounds for the two orthogonal error components derived in the preceding sub-lemmas.\n1941: \n1942: **Step 1: Start with the Orthogonal Decomposition.**\n1943: From {prf:ref}`lem-sasaki-structural-error-decomposition`, the total squared structural error is the sum of the squared norms of the direct and indirect error components:\n1944: \n1945: $$\n1946: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1947: \n1948: $$\n1949: \n1950: **Step 2: Substitute the Bounds for Each Component.**\n1951: We substitute the deterministic bounds for the squared norm of each component.\n1952: \n1953: *   From {prf:ref}`lem-sasaki-direct-structural-error-sq`, the direct error is bounded by a term linear in $n_c$:\n1954: \n1955:     $$\n1956:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le C_{S,\\mathrm{direct}}^{\\mathrm{sq}} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1957:     $$\n1958: \n1959: *   From {prf:ref}`lem-sasaki-indirect-structural-error-sq`, the indirect error is bounded by a term quadratic in $n_c$:\n1960: \n1961:     $$\n1962:     \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1963:     $$\n1964: \n1965: **Step 3: Combine the Bounds.**\n1966: Summing the two bounds from Step 2 directly gives the final inequality as stated in Theorem {prf:ref}`thm-sasaki-standardization-structural-sq`.\n1967: \n1968: $$\n1969: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2 \\le C_{S,\\mathrm{direct}}^{\\mathrm{sq}} \\cdot n_c(\\mathcal S_1, \\mathcal S_2) + C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1970: \n1971: $$\n1972: \n1973: This completes the proof, establishing a deterministic, worst-case bound on the operator's output error due to structural changes.\n1974: \n1975: **Q.E.D.**\n1976: \n1977: ##### 2.3.7. Structural Error Coefficients (Squared Form)\n1978: \n1979: :::{prf:definition} Structural Error Coefficients (Squared Form)\n1980: :label: def-sasaki-structural-coeffs-sq\n1981: \n1982: Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states with alive sets $\\mathcal A_1$ and $\\mathcal A_2$, of sizes $k_1:=|\\mathcal A_1|$ and $k_2:=|\\mathcal A_2|$. Let $k_{\\mathrm{stable}}:=|\\mathcal A_1\\cap\\mathcal A_2|$. The coefficients for the bounds on the squared structural error are defined as follows:\n1983: \n1984: Referenced by {prf:ref}`lem-sasaki-indirect-structural-error-sq` and {prf:ref}`thm-sasaki-standardization-structural-sq`.\n1985: \n1986: 1.  **The Squared Direct Structural Error Coefficient ($C_{S,\\mathrm{direct}}^{\\mathrm{sq}}$):** The coefficient of the term linear in $n_c$.\n1987: \n1988:     $$\n1989:     C_{S,\\mathrm{direct}}^{\\mathrm{sq}} := \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1990:     $$\n1991: \n1992: 2.  **The Squared Indirect Structural Error Coefficient ($C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2)$):** The coefficient of the term quadratic in $n_c$, which bounds the error for the stable walkers.\n1993: \n1994:     $$",
      "metadata": {
        "label": "def-sasaki-structural-coeffs-sq"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "lem-sasaki-structural-error-decomposition",
        "lem-sasaki-direct-structural-error-sq",
        "lem-sasaki-indirect-structural-error-sq",
        "thm-sasaki-standardization-structural-sq"
      ],
      "raw_directive": "1937: ##### 2.3.6.4. Proof of Theorem 2.3.6\n1938: \n1939: :::{prf:proof} of {prf:ref}`thm-sasaki-standardization-structural-sq`\n1940: The proof establishes the final bound by assembling the deterministic bounds for the two orthogonal error components derived in the preceding sub-lemmas.\n1941: \n1942: **Step 1: Start with the Orthogonal Decomposition.**\n1943: From {prf:ref}`lem-sasaki-structural-error-decomposition`, the total squared structural error is the sum of the squared norms of the direct and indirect error components:\n1944: \n1945: $$\n1946: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2 = \\|\\Delta_{\\text{direct}}\\|_2^2 + \\|\\Delta_{\\text{indirect}}\\|_2^2\n1947: \n1948: $$\n1949: \n1950: **Step 2: Substitute the Bounds for Each Component.**\n1951: We substitute the deterministic bounds for the squared norm of each component.\n1952: \n1953: *   From {prf:ref}`lem-sasaki-direct-structural-error-sq`, the direct error is bounded by a term linear in $n_c$:\n1954: \n1955:     $$\n1956:     \\|\\Delta_{\\text{direct}}\\|_2^2 \\le C_{S,\\mathrm{direct}}^{\\mathrm{sq}} \\cdot n_c(\\mathcal S_1, \\mathcal S_2)\n1957:     $$\n1958: \n1959: *   From {prf:ref}`lem-sasaki-indirect-structural-error-sq`, the indirect error is bounded by a term quadratic in $n_c$:\n1960: \n1961:     $$\n1962:     \\|\\Delta_{\\text{indirect}}\\|_2^2 \\le C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1963:     $$\n1964: \n1965: **Step 3: Combine the Bounds.**\n1966: Summing the two bounds from Step 2 directly gives the final inequality as stated in Theorem {prf:ref}`thm-sasaki-standardization-structural-sq`.\n1967: \n1968: $$\n1969: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2 \\le C_{S,\\mathrm{direct}}^{\\mathrm{sq}} \\cdot n_c(\\mathcal S_1, \\mathcal S_2) + C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c(\\mathcal S_1, \\mathcal S_2)^2\n1970: \n1971: $$\n1972: \n1973: This completes the proof, establishing a deterministic, worst-case bound on the operator's output error due to structural changes.\n1974: \n1975: **Q.E.D.**\n1976: \n1977: ##### 2.3.7. Structural Error Coefficients (Squared Form)\n1978: \n1979: :::{prf:definition} Structural Error Coefficients (Squared Form)\n1980: :label: def-sasaki-structural-coeffs-sq\n1981: \n1982: Let $\\mathcal S_1$ and $\\mathcal S_2$ be two swarm states with alive sets $\\mathcal A_1$ and $\\mathcal A_2$, of sizes $k_1:=|\\mathcal A_1|$ and $k_2:=|\\mathcal A_2|$. Let $k_{\\mathrm{stable}}:=|\\mathcal A_1\\cap\\mathcal A_2|$. The coefficients for the bounds on the squared structural error are defined as follows:\n1983: \n1984: Referenced by {prf:ref}`lem-sasaki-indirect-structural-error-sq` and {prf:ref}`thm-sasaki-standardization-structural-sq`.\n1985: \n1986: 1.  **The Squared Direct Structural Error Coefficient ($C_{S,\\mathrm{direct}}^{\\mathrm{sq}}$):** The coefficient of the term linear in $n_c$.\n1987: \n1988:     $$\n1989:     C_{S,\\mathrm{direct}}^{\\mathrm{sq}} := \\left( \\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}} \\right)^2\n1990:     $$\n1991: \n1992: 2.  **The Squared Indirect Structural Error Coefficient ($C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2)$):** The coefficient of the term quadratic in $n_c$, which bounds the error for the stable walkers.\n1993: \n1994:     $$\n1995:     C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) := 2 k_{\\mathrm{stable}} \\frac{(L_{\\mu,S}^{\\mathrm{Sasaki}})^2}{\\sigma_{\\min,\\mathrm{patch}}^{2}} + 2 k_2 \\left(\\frac{2V_{\\max}^{(R)}}{\\sigma_{\\min,\\mathrm{patch}}}\\right)^2 \\frac{(L_{\\sigma',S}^{\\mathrm{Sasaki}})^2}{\\sigma_{\\min,\\mathrm{patch}}^{2}}"
    },
    {
      "directive_type": "theorem",
      "label": "lem-sasaki-standardization-lipschitz",
      "title": "Composite Continuity of the Patched Standardization Operator (Sasaki)",
      "start_line": 2001,
      "end_line": 2099,
      "header_lines": [
        2002,
        2086
      ],
      "content_start": 2004,
      "content_end": 2098,
      "content": "2004: :label: thm-sasaki-standardization-composite-sq\n2005: \n2006: The N-dimensional standardization operator $z(\\mathcal S)$, when applied to the reward vector, is continuous with respect to the dispersion metric. For any two swarms $\\mathcal S_1, \\mathcal S_2$ with $k_1=|\\mathcal A(\\mathcal S_1)|\\ge 1$, the squared L2-norm of the output error is bounded by a composite function of the squared dispersion distance:\n2007: \n2008: $$\n2009: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2 \\le L_{z,L}^2(\\mathcal S_1,\\mathcal S_2) \\cdot d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1, \\mathcal S_2)^2 + L_{z,H}^2(\\mathcal S_1,\\mathcal S_2) \\cdot d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1, \\mathcal S_2)^4\n2010: \n2011: $$\n2012: \n2013: where $L_{z,L}^2$ and $L_{z,H}^2$ are state-dependent coefficients representing the Lipschitz and higher-order parts of the bound, respectively. Consequently, the logistic rescale operator $u(\\mathcal S) = g_A(z(\\mathcal S))$ is also continuous.\n2014: \n2015: ```{dropdown} Proof\n2016: :::{prf:proof}\n2017: The proof establishes a deterministic bound on the total error $\\|z(\\mathcal S_1, \\mathbf r_1) - z(\\mathcal S_2, \\mathbf r_2)\\|_2^2$ by combining the bounds for value-induced error and structure-induced error.\n2018: \n2019: **Step 1: Decomposing the Total Error.**\n2020: Let $\\mathbf r_1$ and $\\mathbf r_2$ be the raw reward vectors for swarms $\\mathcal S_1$ and $\\mathcal S_2$. We introduce an intermediate vector $z(\\mathcal S_1, \\mathbf r_2)$ and use the inequality $\\|A-C\\|_2^2 \\le 2(\\|A-B\\|_2^2 + \\|B-C\\|_2^2)$. The total squared error is bounded by the sum of a pure value error component and a pure structural error component:\n2021: \n2022: $$\n2023: \\|z(\\mathcal S_1, \\mathbf r_1) - z(\\mathcal S_2, \\mathbf r_2)\\|_2^2 \\le 2\\,\\|\\underbrace{z(\\mathcal S_1, \\mathbf r_1) - z(\\mathcal S_1, \\mathbf r_2)}_{E_V}\\|_2^2 + 2\\,\\|\\underbrace{z(\\mathcal S_1, \\mathbf r_2) - z(\\mathcal S_2, \\mathbf r_2)}_{E_S}\\|_2^2\n2024: \n2025: $$\n2026: \n2027: **Step 2: Bounding the Squared Value Error Term (`||E_V||_2^2`).**\n2028: The first term is a pure value error for the fixed swarm structure $\\mathcal S_1$. We apply Theorem {prf:ref}`thm-sasaki-standardization-value`:\n2029: \n2030: $$\n2031: \\|E_V\\|_2^2 \\le C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S_1) \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n2032: \n2033: $$\n2034: The squared difference of the raw reward vectors is bounded by the sum of contributions from walkers with stable status and unstable status:\n2035: \n2036: $$\n2037: \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2 = \\sum_{i \\in \\mathcal A_1 \\cap \\mathcal A_2} |r_{1,i}-r_{2,i}|^2 + \\sum_{i \\in \\mathcal A_1 \\triangle \\mathcal A_2} |r_{1,i}-r_{2,i}|^2 \\le (L_R^{\\mathrm{Sasaki}})^2 \\Delta_{\\mathrm{pos,Sasaki}}^2 + n_c (2 V_{\\max}^{(R)})^2\n2038: \n2039: $$\n2040: where we used that for unstable walkers, one reward is zero and the other is bounded by $V_{\\max}^{(R)}$.\n2041: \n2042: **Step 3: Bounding the Squared Structural Error Term (`||E_S||_2^2`).**\n2043: The second term is a pure structural error for the fixed raw value vector $\\mathbf r_2$. We apply Theorem {prf:ref}`thm-sasaki-standardization-structural-sq`:\n2044: \n2045: $$\n2046: \\|E_S\\|_2^2 \\le C_{S,\\mathrm{direct}}^{\\mathrm{sq}} \\cdot n_c + C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c^2\n2047: \n2048: $$\n2049: \n2050: **Step 4: Assembling the Composite Bound in Terms of Displacement Components.**\n2051: Combining the bounds from Steps 2 and 3 into the decomposition from Step 1 gives a complete bound in terms of $\\Delta_{\\mathrm{pos,Sasaki}}^2$ and $n_c$:\n2052: \n2053: $$\n2054: \\|z_1 - z_2\\|_2^2 \\le 2\\,C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}} \\left[ (L_R^{\\mathrm{Sasaki}})^2 \\Delta_{\\mathrm{pos,Sasaki}}^2 + 4(V_{\\max}^{(R)})^2 n_c \\right] + 2 \\left[ C_{S,\\mathrm{direct}}^{\\mathrm{sq}} n_c + C_{S,\\mathrm{indirect}}^{\\mathrm{sq}} n_c^2 \\right]\n2055: \n2056: $$\n2057: \n2058: **Step 5: Expressing the Bound in Terms of the Dispersion Metric.**\n2059: Let $d^2:=d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1,\\mathcal S_2)^2$. From the definition of the dispersion metric we obtain\n2060: \n2061: $$\n2062: \\Delta_{\\mathrm{pos,Sasaki}}^2\\le N d^2,\\qquad n_c\\le\\frac{N}{\\lambda_{\\mathrm{status}}}d^2,\\qquad n_c^2\\le\\left(\\frac{N}{\\lambda_{\\mathrm{status}}}\\right)^2 d^4.\n2063: \n2064: $$\n2065: \n2066: Substituting these bounds into the expression from Step 4 yields\n2067: \n2068: $$\n2069: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2\\le L_{z,L}^2(\\mathcal S_1,\\mathcal S_2)d^2+L_{z,H}^2(\\mathcal S_1,\\mathcal S_2)d^4.\n2070: \n2071: $$\n2072: \n2073: The coefficients are explicit:\n2074: \n2075: $$\n2076: \\begin{aligned}\n2077: L_{z,L}^2(\\mathcal S_1,\\mathcal S_2)&:=2C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S_1)(L_R^{\\mathrm{Sasaki}})^2N\\\\&\\quad{}+\\frac{N}{\\lambda_{\\mathrm{status}}}\\Big(8C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S_1)(V_{\\max}^{(R)})^2+2C_{S,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S_1,\\mathcal S_2)\\Big),\\\\[4pt]\n2078: L_{z,H}^2(\\mathcal S_1,\\mathcal S_2)&:=2C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1,\\mathcal S_2)\\left(\\frac{N}{\\lambda_{\\mathrm{status}}}\\right)^2.\n2079: \\end{aligned}\n2080: \n2081: $$\n2082: \n2083: All quantities on the right-hand side depend only on the swarm parameters and the bounds established earlier, so the coefficients are finite. Since the rescale function $g_A$ is globally Lipschitz ({prf:ref}`thm-rescale-function-lipschitz`), the continuity of $z$ implies the continuity of the composite operator $u(\\mathcal S)=g_A(z(\\mathcal S))$.\n2084: \n2085: **Q.E.D.**\n2086: ```\n2087: :::{prf:lemma} Lipschitz continuity of patched standardization (Sasaki)\n2088: :label: lem-sasaki-standardization-lipschitz\n2089: \n2090: The bounds in Theorem {prf:ref}`thm-sasaki-standardization-composite-sq` show that the patched standardization operator $z$ is continuous with respect to the dispersion metric. In particular, $z$ admits the composite Lipschitz\u2013H\u00f6lder control\n2091: \n2092: $$\n2093: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2\\le L_{z,L}^2(\\mathcal S_1,\\mathcal S_2)\\,d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1,\\mathcal S_2)^2+L_{z,H}^2(\\mathcal S_1,\\mathcal S_2)\\,d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1,\\mathcal S_2)^4.\n2094: \n2095: $$\n2096: \n2097: ```{dropdown} Proof\n2098: :::{prf:proof}",
      "metadata": {
        "label": "lem-sasaki-standardization-lipschitz"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [
        "thm-sasaki-standardization-value",
        "thm-sasaki-standardization-structural-sq",
        "thm-rescale-function-lipschitz",
        "thm-sasaki-standardization-composite-sq"
      ],
      "raw_directive": "2001: ###### 2.3.8. Theorem: Composite Continuity of the Patched Standardization Operator\n2002: \n2003: :::{prf:theorem} Composite Continuity of the Patched Standardization Operator (Sasaki)\n2004: :label: thm-sasaki-standardization-composite-sq\n2005: \n2006: The N-dimensional standardization operator $z(\\mathcal S)$, when applied to the reward vector, is continuous with respect to the dispersion metric. For any two swarms $\\mathcal S_1, \\mathcal S_2$ with $k_1=|\\mathcal A(\\mathcal S_1)|\\ge 1$, the squared L2-norm of the output error is bounded by a composite function of the squared dispersion distance:\n2007: \n2008: $$\n2009: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2 \\le L_{z,L}^2(\\mathcal S_1,\\mathcal S_2) \\cdot d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1, \\mathcal S_2)^2 + L_{z,H}^2(\\mathcal S_1,\\mathcal S_2) \\cdot d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1, \\mathcal S_2)^4\n2010: \n2011: $$\n2012: \n2013: where $L_{z,L}^2$ and $L_{z,H}^2$ are state-dependent coefficients representing the Lipschitz and higher-order parts of the bound, respectively. Consequently, the logistic rescale operator $u(\\mathcal S) = g_A(z(\\mathcal S))$ is also continuous.\n2014: \n2015: ```{dropdown} Proof\n2016: :::{prf:proof}\n2017: The proof establishes a deterministic bound on the total error $\\|z(\\mathcal S_1, \\mathbf r_1) - z(\\mathcal S_2, \\mathbf r_2)\\|_2^2$ by combining the bounds for value-induced error and structure-induced error.\n2018: \n2019: **Step 1: Decomposing the Total Error.**\n2020: Let $\\mathbf r_1$ and $\\mathbf r_2$ be the raw reward vectors for swarms $\\mathcal S_1$ and $\\mathcal S_2$. We introduce an intermediate vector $z(\\mathcal S_1, \\mathbf r_2)$ and use the inequality $\\|A-C\\|_2^2 \\le 2(\\|A-B\\|_2^2 + \\|B-C\\|_2^2)$. The total squared error is bounded by the sum of a pure value error component and a pure structural error component:\n2021: \n2022: $$\n2023: \\|z(\\mathcal S_1, \\mathbf r_1) - z(\\mathcal S_2, \\mathbf r_2)\\|_2^2 \\le 2\\,\\|\\underbrace{z(\\mathcal S_1, \\mathbf r_1) - z(\\mathcal S_1, \\mathbf r_2)}_{E_V}\\|_2^2 + 2\\,\\|\\underbrace{z(\\mathcal S_1, \\mathbf r_2) - z(\\mathcal S_2, \\mathbf r_2)}_{E_S}\\|_2^2\n2024: \n2025: $$\n2026: \n2027: **Step 2: Bounding the Squared Value Error Term (`||E_V||_2^2`).**\n2028: The first term is a pure value error for the fixed swarm structure $\\mathcal S_1$. We apply Theorem {prf:ref}`thm-sasaki-standardization-value`:\n2029: \n2030: $$\n2031: \\|E_V\\|_2^2 \\le C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S_1) \\cdot \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2\n2032: \n2033: $$\n2034: The squared difference of the raw reward vectors is bounded by the sum of contributions from walkers with stable status and unstable status:\n2035: \n2036: $$\n2037: \\|\\mathbf r_1 - \\mathbf r_2\\|_2^2 = \\sum_{i \\in \\mathcal A_1 \\cap \\mathcal A_2} |r_{1,i}-r_{2,i}|^2 + \\sum_{i \\in \\mathcal A_1 \\triangle \\mathcal A_2} |r_{1,i}-r_{2,i}|^2 \\le (L_R^{\\mathrm{Sasaki}})^2 \\Delta_{\\mathrm{pos,Sasaki}}^2 + n_c (2 V_{\\max}^{(R)})^2\n2038: \n2039: $$\n2040: where we used that for unstable walkers, one reward is zero and the other is bounded by $V_{\\max}^{(R)}$.\n2041: \n2042: **Step 3: Bounding the Squared Structural Error Term (`||E_S||_2^2`).**\n2043: The second term is a pure structural error for the fixed raw value vector $\\mathbf r_2$. We apply Theorem {prf:ref}`thm-sasaki-standardization-structural-sq`:\n2044: \n2045: $$\n2046: \\|E_S\\|_2^2 \\le C_{S,\\mathrm{direct}}^{\\mathrm{sq}} \\cdot n_c + C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1, \\mathcal S_2) \\cdot n_c^2\n2047: \n2048: $$\n2049: \n2050: **Step 4: Assembling the Composite Bound in Terms of Displacement Components.**\n2051: Combining the bounds from Steps 2 and 3 into the decomposition from Step 1 gives a complete bound in terms of $\\Delta_{\\mathrm{pos,Sasaki}}^2$ and $n_c$:\n2052: \n2053: $$\n2054: \\|z_1 - z_2\\|_2^2 \\le 2\\,C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}} \\left[ (L_R^{\\mathrm{Sasaki}})^2 \\Delta_{\\mathrm{pos,Sasaki}}^2 + 4(V_{\\max}^{(R)})^2 n_c \\right] + 2 \\left[ C_{S,\\mathrm{direct}}^{\\mathrm{sq}} n_c + C_{S,\\mathrm{indirect}}^{\\mathrm{sq}} n_c^2 \\right]\n2055: \n2056: $$\n2057: \n2058: **Step 5: Expressing the Bound in Terms of the Dispersion Metric.**\n2059: Let $d^2:=d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1,\\mathcal S_2)^2$. From the definition of the dispersion metric we obtain\n2060: \n2061: $$\n2062: \\Delta_{\\mathrm{pos,Sasaki}}^2\\le N d^2,\\qquad n_c\\le\\frac{N}{\\lambda_{\\mathrm{status}}}d^2,\\qquad n_c^2\\le\\left(\\frac{N}{\\lambda_{\\mathrm{status}}}\\right)^2 d^4.\n2063: \n2064: $$\n2065: \n2066: Substituting these bounds into the expression from Step 4 yields\n2067: \n2068: $$\n2069: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2\\le L_{z,L}^2(\\mathcal S_1,\\mathcal S_2)d^2+L_{z,H}^2(\\mathcal S_1,\\mathcal S_2)d^4.\n2070: \n2071: $$\n2072: \n2073: The coefficients are explicit:\n2074: \n2075: $$\n2076: \\begin{aligned}\n2077: L_{z,L}^2(\\mathcal S_1,\\mathcal S_2)&:=2C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S_1)(L_R^{\\mathrm{Sasaki}})^2N\\\\&\\quad{}+\\frac{N}{\\lambda_{\\mathrm{status}}}\\Big(8C_{V,\\mathrm{total}}^{\\mathrm{Sasaki}}(\\mathcal S_1)(V_{\\max}^{(R)})^2+2C_{S,\\mathrm{direct}}^{\\mathrm{sq}}(\\mathcal S_1,\\mathcal S_2)\\Big),\\\\[4pt]\n2078: L_{z,H}^2(\\mathcal S_1,\\mathcal S_2)&:=2C_{S,\\mathrm{indirect}}^{\\mathrm{sq}}(\\mathcal S_1,\\mathcal S_2)\\left(\\frac{N}{\\lambda_{\\mathrm{status}}}\\right)^2.\n2079: \\end{aligned}\n2080: \n2081: $$\n2082: \n2083: All quantities on the right-hand side depend only on the swarm parameters and the bounds established earlier, so the coefficients are finite. Since the rescale function $g_A$ is globally Lipschitz ({prf:ref}`thm-rescale-function-lipschitz`), the continuity of $z$ implies the continuity of the composite operator $u(\\mathcal S)=g_A(z(\\mathcal S))$.\n2084: \n2085: **Q.E.D.**\n2086: ```\n2087: :::{prf:lemma} Lipschitz continuity of patched standardization (Sasaki)\n2088: :label: lem-sasaki-standardization-lipschitz\n2089: \n2090: The bounds in Theorem {prf:ref}`thm-sasaki-standardization-composite-sq` show that the patched standardization operator $z$ is continuous with respect to the dispersion metric. In particular, $z$ admits the composite Lipschitz\u2013H\u00f6lder control\n2091: \n2092: $$\n2093: \\|z(\\mathcal S_1)-z(\\mathcal S_2)\\|_2^2\\le L_{z,L}^2(\\mathcal S_1,\\mathcal S_2)\\,d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1,\\mathcal S_2)^2+L_{z,H}^2(\\mathcal S_1,\\mathcal S_2)\\,d_{\\mathrm{Disp},\\mathcal Y}^{\\mathrm{Sasaki}}(\\mathcal S_1,\\mathcal S_2)^4.\n2094: \n2095: $$\n2096: \n2097: ```{dropdown} Proof\n2098: :::{prf:proof}\n2099: The inequality is precisely the statement of Theorem {prf:ref}`thm-sasaki-standardization-composite-sq`; no additional work is required."
    },
    {
      "directive_type": "axiom",
      "label": "axiom-non-deceptive",
      "title": "Axiom of Non-Deceptive Landscapes",
      "start_line": 2128,
      "end_line": 2139,
      "header_lines": [
        2129
      ],
      "content_start": 2131,
      "content_end": 2138,
      "content": "2131: :label: axiom-non-deceptive\n2132: \n2133: The environment $(X_{\\mathrm{valid}}, R_{\\mathrm{pos}})$ is **non-deceptive** if there exist constants $\\kappa_{\\mathrm{grad}} > 0$ and $L_{\\mathrm{grad}} > 0$ such that for any two points $x, y \\in X_{\\mathrm{valid}}$ with $\\|x - y\\| \\ge L_{\\mathrm{grad}}$, the average squared norm of the reward gradient along the line segment connecting them is bounded below:\n2134: \n2135: $$\n2136: \\frac{1}{\\|x-y\\|} \\int_{0}^{\\|x-y\\|} \\big\\|\\nabla R_{\\mathrm{pos}}\\big(x + t\\tfrac{y-x}{\\|y-x\\|}\\big)\\big\\|^2 dt \\ge \\kappa_{\\mathrm{grad}}.\n2137: \n2138: $$",
      "metadata": {
        "label": "axiom-non-deceptive"
      },
      "section": "## 4. Axiom-by-axiom validation (Sasaki formulation)",
      "references": [],
      "raw_directive": "2128: For the geometric ergodicity proof in `convergence.md` to hold, the Euclidean Gas must satisfy an additional environmental axiom that strengthens the Axiom of Environmental Richness. This axiom prevents pathological scenarios where positional diversity and reward signals become decoupled.\n2129: \n2130: :::{prf:axiom} Axiom of Non-Deceptive Landscapes\n2131: :label: axiom-non-deceptive\n2132: \n2133: The environment $(X_{\\mathrm{valid}}, R_{\\mathrm{pos}})$ is **non-deceptive** if there exist constants $\\kappa_{\\mathrm{grad}} > 0$ and $L_{\\mathrm{grad}} > 0$ such that for any two points $x, y \\in X_{\\mathrm{valid}}$ with $\\|x - y\\| \\ge L_{\\mathrm{grad}}$, the average squared norm of the reward gradient along the line segment connecting them is bounded below:\n2134: \n2135: $$\n2136: \\frac{1}{\\|x-y\\|} \\int_{0}^{\\|x-y\\|} \\big\\|\\nabla R_{\\mathrm{pos}}\\big(x + t\\tfrac{y-x}{\\|y-x\\|}\\big)\\big\\|^2 dt \\ge \\kappa_{\\mathrm{grad}}.\n2137: \n2138: $$\n2139: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}