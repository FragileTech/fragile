{
  "document_id": "11_hk_convergence",
  "stage": "directives",
  "directive_type": "lemma",
  "generated_at": "2025-11-08T17:16:20.201147+00:00",
  "count": 13,
  "items": [
    {
      "directive_type": "lemma",
      "label": "lem-mass-contraction-revival-death",
      "title": "Mass Contraction via Revival and Death",
      "start_line": 181,
      "end_line": 221,
      "header_lines": [
        182
      ],
      "content_start": 184,
      "content_end": 220,
      "content": "184: :label: lem-mass-contraction-revival-death\n185: \n186: Let $k_t = \\|\\mu_t\\|$ denote the number of alive walkers at time $t$ (the total mass of the empirical measure). Let $k_* = \\|\\pi_{\\text{QSD}}\\|$ denote the equilibrium alive count under the QSD.\n187: \n188: Assume:\n189: 1. **Birth Mechanism**: The Fragile Gas creates new walkers via two processes:\n190:    - Guaranteed revival of all dead walkers (from {prf:ref}`def-axiom-guaranteed-revival`)\n191:    - Cloning of alive walkers with rate $\\lambda_{\\text{clone}}(k_t)$ per walker\n192: \n193:    Total births: $B_t = (N - k_t) + C_t$ where $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$\n194: \n195: 2. **Death Mechanism**: Boundary exit causes death with rate $\\bar{p}_{\\text{kill}}(k_t)$, giving $\\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(k_t) k_t$\n196: \n197: 3. **QSD Equilibrium**: The equilibrium mass $k_*$ satisfies $(N - k_*) + \\lambda_{\\text{clone}}^* k_* = \\bar{p}_{\\text{kill}}^* k_*$\n198: \n199: 4. **Lipschitz Continuity**: Both $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k)$ are Lipschitz continuous:\n200:    - $|\\lambda_{\\text{clone}}(k_t) - \\lambda_{\\text{clone}}^*| \\leq L_\\lambda |k_t - k_*|$\n201:    - $|\\bar{p}_{\\text{kill}}(k_t) - \\bar{p}_{\\text{kill}}^*| \\leq L_p |k_t - k_*|$\n202: \n203: Then there exist constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$ such that:\n204: \n205: $$\n206: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n207: \n208: $$\n209: \n210: where:\n211: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n212: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n213: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n214: - $L_\\lambda$ is the Lipschitz constant of the cloning rate\n215: - $L_p$ is the Lipschitz constant of the killing rate\n216: - $N$ is the total number of walkers (alive + dead)\n217: \n218: **Assumptions:**\n219: 1. $\\epsilon^2 + \\epsilon < 1$, which requires $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (achieved when $L_p L_\\lambda = O(1/N^2)$ for large $N$)\n220: 2. $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with $L_g^{(2)} = O(N^{-1})$ (natural for density-dependent rates)",
      "metadata": {
        "label": "lem-mass-contraction-revival-death"
      },
      "section": "## 2. Lemma A: Mass Contraction from Revival and Death",
      "raw_directive": "181: This lemma establishes that the combined effect of the revival mechanism (Axiom of Guaranteed Revival) and boundary death causes the total alive mass to contract toward the QSD equilibrium mass. The proof analyzes the full distribution of the mass change, accounting for both revival (mass increase) and boundary death (mass decrease).\n182: \n183: :::{prf:lemma} Mass Contraction via Revival and Death\n184: :label: lem-mass-contraction-revival-death\n185: \n186: Let $k_t = \\|\\mu_t\\|$ denote the number of alive walkers at time $t$ (the total mass of the empirical measure). Let $k_* = \\|\\pi_{\\text{QSD}}\\|$ denote the equilibrium alive count under the QSD.\n187: \n188: Assume:\n189: 1. **Birth Mechanism**: The Fragile Gas creates new walkers via two processes:\n190:    - Guaranteed revival of all dead walkers (from {prf:ref}`def-axiom-guaranteed-revival`)\n191:    - Cloning of alive walkers with rate $\\lambda_{\\text{clone}}(k_t)$ per walker\n192: \n193:    Total births: $B_t = (N - k_t) + C_t$ where $\\mathbb{E}[C_t | k_t] = \\lambda_{\\text{clone}}(k_t) k_t$\n194: \n195: 2. **Death Mechanism**: Boundary exit causes death with rate $\\bar{p}_{\\text{kill}}(k_t)$, giving $\\mathbb{E}[D_t | k_t] = \\bar{p}_{\\text{kill}}(k_t) k_t$\n196: \n197: 3. **QSD Equilibrium**: The equilibrium mass $k_*$ satisfies $(N - k_*) + \\lambda_{\\text{clone}}^* k_* = \\bar{p}_{\\text{kill}}^* k_*$\n198: \n199: 4. **Lipschitz Continuity**: Both $\\lambda_{\\text{clone}}(k)$ and $\\bar{p}_{\\text{kill}}(k)$ are Lipschitz continuous:\n200:    - $|\\lambda_{\\text{clone}}(k_t) - \\lambda_{\\text{clone}}^*| \\leq L_\\lambda |k_t - k_*|$\n201:    - $|\\bar{p}_{\\text{kill}}(k_t) - \\bar{p}_{\\text{kill}}^*| \\leq L_p |k_t - k_*|$\n202: \n203: Then there exist constants $\\kappa_{\\text{mass}} > 0$ and $C_{\\text{mass}} < \\infty$ such that:\n204: \n205: $$\n206: \\mathbb{E}[(k_{t+1} - k_*)^2] \\leq (1 - 2\\kappa_{\\text{mass}}) \\mathbb{E}[(k_t - k_*)^2] + C_{\\text{mass}}\n207: \n208: $$\n209: \n210: where:\n211: - $\\kappa_{\\text{mass}} = \\frac{1 - \\epsilon - \\epsilon^2}{2}$ with $\\epsilon = (1 + 2L_p N + \\bar{p}_{\\text{kill}}^*)(L_\\lambda N + \\lambda_{\\text{clone}}^*)$\n212: - $C_{\\text{mass}} = C_N \\cdot N$ where $C_N = C_{\\text{var}} + O(1/N)$\n213: - $C_{\\text{var}} = \\bar{p}_{\\max}(1 + \\lambda_{\\max}) + 2(1 + L_g^{(1)})^2 \\lambda_{\\max} + \\frac{1}{2}(L_g^{(2)})^2 \\lambda_{\\max}$ (variance constant from Step 6b)\n214: - $L_\\lambda$ is the Lipschitz constant of the cloning rate\n215: - $L_p$ is the Lipschitz constant of the killing rate\n216: - $N$ is the total number of walkers (alive + dead)\n217: \n218: **Assumptions:**\n219: 1. $\\epsilon^2 + \\epsilon < 1$, which requires $\\epsilon < \\frac{\\sqrt{5} - 1}{2} \\approx 0.618$ (achieved when $L_p L_\\lambda = O(1/N^2)$ for large $N$)\n220: 2. $\\bar{p}_{\\text{kill}}(k')$ is twice continuously differentiable with $L_g^{(2)} = O(N^{-1})$ (natural for density-dependent rates)\n221: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Lemma A: Mass Contraction from Revival and Death"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-structural-variance-contraction",
      "title": "Exponential Contraction of Structural Variance",
      "start_line": 1004,
      "end_line": 1024,
      "header_lines": [
        1005
      ],
      "content_start": 1007,
      "content_end": 1023,
      "content": "1007: :label: lem-structural-variance-contraction\n1008: \n1009: Let $\\mu_t$ denote the empirical measure of a single realization of the Fragile Gas at time $t$, and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1010: \n1011: Then the structural variance contracts exponentially in expectation:\n1012: \n1013: $$\n1014: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} t} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}}(1 - e^{-\\lambda_{\\text{struct}} t})\n1015: \n1016: $$\n1017: \n1018: where:\n1019: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the exponential convergence rate\n1020: - $\\kappa_W > 0$ is the cloning operator Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n1021: - $\\kappa_{\\text{kin}} > 0$ is the kinetic operator contraction rate from {prf:ref}`thm-foster-lyapunov-main`\n1022: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ combines noise constants from both operators\n1023: - $\\tau$ is the time step size",
      "metadata": {
        "label": "lem-structural-variance-contraction"
      },
      "section": "## 3. Lemma B: Exponential Contraction of Structural Variance",
      "raw_directive": "1004: **Mathematical Foundation:** This lemma uses the Wasserstein contraction results established in the framework. The cloning operator ({prf:ref}`thm-main-contraction-full` from [04_wasserstein_contraction](04_wasserstein_contraction)) and the kinetic operator ({prf:ref}`thm-foster-lyapunov-main` from [06_convergence](06_convergence)) each provide contraction of the Wasserstein distance **in expectation** after one step of the dynamics.\n1005: \n1006: :::{prf:lemma} Exponential Contraction of Structural Variance\n1007: :label: lem-structural-variance-contraction\n1008: \n1009: Let $\\mu_t$ denote the empirical measure of a single realization of the Fragile Gas at time $t$, and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1010: \n1011: Then the structural variance contracts exponentially in expectation:\n1012: \n1013: $$\n1014: \\mathbb{E}[V_{\\text{struct}}(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} t} \\mathbb{E}[V_{\\text{struct}}(\\mu_0, \\pi_{\\text{QSD}})] + \\frac{C_{\\text{struct}}}{\\lambda_{\\text{struct}}}(1 - e^{-\\lambda_{\\text{struct}} t})\n1015: \n1016: $$\n1017: \n1018: where:\n1019: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the exponential convergence rate\n1020: - $\\kappa_W > 0$ is the cloning operator Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n1021: - $\\kappa_{\\text{kin}} > 0$ is the kinetic operator contraction rate from {prf:ref}`thm-foster-lyapunov-main`\n1022: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ combines noise constants from both operators\n1023: - $\\tau$ is the time step size\n1024: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. Lemma B: Exponential Contraction of Structural Variance"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-kinetic-hellinger-contraction",
      "title": "Kinetic Operator Hellinger Contraction",
      "start_line": 1169,
      "end_line": 1214,
      "header_lines": [
        1170
      ],
      "content_start": 1172,
      "content_end": 1213,
      "content": "1172: :label: lem-kinetic-hellinger-contraction\n1173: \n1174: Let $\\mu_t$ be the empirical measure of alive walkers at time $t$ and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1175: \n1176: **Assumption:** The normalized density ratio is uniformly bounded:\n1177: \n1178: $$\n1179: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n1180: \n1181: $$\n1182: \n1183: where $\\tilde{\\mu}_t = \\mu_t / \\|\\mu_t\\|$ and $\\tilde{\\pi}_{\\text{QSD}} = \\pi_{\\text{QSD}} / \\|\\pi_{\\text{QSD}}\\|$ are the normalized probability measures.\n1184: \n1185: Under this assumption and the kinetic operator $\\Psi_{\\text{kin}}$ (BAOAB + boundary killing), there exist constants $\\kappa_{\\text{kin}}(M) > 0$ and $C_{\\text{kin}} < \\infty$ such that:\n1186: \n1187: $$\n1188: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}}(M) \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n1189: \n1190: $$\n1191: \n1192: where $\\tau$ is the time step size.\n1193: \n1194: **Interpretation:** The Hellinger distance to the QSD decreases exponentially fast under the kinetic operator, with a rate constant $\\kappa_{\\text{kin}}(M)$ that depends on the density bound $M$, the friction $\\gamma$, the potential coercivity $\\alpha_U$, and the hypocoercive coupling. The $O(\\tau^2)$ term arises from the BAOAB discretization error.\n1195: \n1196: **Justification of Assumption:** This assumption is satisfied for the Euclidean Gas under the following conditions:\n1197: \n1198: 1. **Bounded initial density:** If the empirical measure at $t=0$ has a bounded density ratio $d\\mu_0/d\\pi_{\\text{QSD}} \\leq M_0 < \\infty$, which holds for any finite particle system initialized within the valid domain.\n1199: \n1200: 2. **Gaussian regularization from cloning:** The cloning operator applies Gaussian perturbations with variance $\\delta^2 > 0$ to all walkers (Axiom {prf:ref}`def-axiom-local-perturbation` from [01_fragile_gas_framework](01_fragile_gas_framework)). This acts as a convolution with a Gaussian kernel:\n1201:    $$\n1202:    \\tilde{\\mu}_{t+} = \\tilde{\\mu}_t * G_{\\delta}\n1203:    $$\n1204:    Gaussian convolution immediately regularizes any measure to have $C^\\infty$ density. Since $\\pi_{\\text{QSD}}$ also has smooth density (from the Gibbs structure with smooth potential), the ratio $d\\tilde{\\mu}_{t+}/d\\tilde{\\pi}_{\\text{QSD}}$ remains bounded.\n1205: \n1206: 3. **Preservation under Fokker-Planck evolution:** The kinetic operator evolves densities according to the Fokker-Planck PDE. The **parabolic maximum principle** ensures that if $\\sup_x (d\\mu_t/d\\pi)(x) \\leq M$ initially, then $\\sup_x (d\\mu_{t+\\tau}/d\\pi)(x) \\leq M' $ where $M'$ depends on $M$, $\\tau$, and system parameters but remains finite for finite time.\n1207: \n1208: 4. **Confinement prevents escape to low-density regions:** The confining potential $U$ from Axiom {prf:ref}`ax-confining-potential` ensures $\\pi_{\\text{QSD}}(x) \\geq c_{\\min} e^{-U(x)}$ for some $c_{\\min} > 0$. Combined with the boundary killing mechanism, walkers are concentrated in regions where $\\pi_{\\text{QSD}}$ has significant mass, preventing the ratio from diverging.\n1209: \n1210: **Practical bound:** For finite-time analysis (up to any fixed $T < \\infty$), the bound $M = M(T, M_0, \\delta, \\gamma, U)$ is guaranteed to be finite by the regularization and confinement mechanisms. The constant $M$ depends on:\n1211: - Initial bound $M_0$\n1212: - Cloning noise $\\delta$ (smaller $\\delta$ requires larger $M$)\n1213: - Friction $\\gamma$ (larger $\\gamma$ gives better regularization)",
      "metadata": {
        "label": "lem-kinetic-hellinger-contraction"
      },
      "section": "## 4. Lemma C: Kinetic Operator Hellinger Analysis",
      "raw_directive": "1169: The QSD $\\pi_{\\text{QSD}}$ is the quasi-stationary distribution—the unique invariant measure conditioned on survival (see [06_convergence](06_convergence)).\n1170: \n1171: :::{prf:lemma} Kinetic Operator Hellinger Contraction\n1172: :label: lem-kinetic-hellinger-contraction\n1173: \n1174: Let $\\mu_t$ be the empirical measure of alive walkers at time $t$ and let $\\pi_{\\text{QSD}}$ be the quasi-stationary distribution.\n1175: \n1176: **Assumption:** The normalized density ratio is uniformly bounded:\n1177: \n1178: $$\n1179: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n1180: \n1181: $$\n1182: \n1183: where $\\tilde{\\mu}_t = \\mu_t / \\|\\mu_t\\|$ and $\\tilde{\\pi}_{\\text{QSD}} = \\pi_{\\text{QSD}} / \\|\\pi_{\\text{QSD}}\\|$ are the normalized probability measures.\n1184: \n1185: Under this assumption and the kinetic operator $\\Psi_{\\text{kin}}$ (BAOAB + boundary killing), there exist constants $\\kappa_{\\text{kin}}(M) > 0$ and $C_{\\text{kin}} < \\infty$ such that:\n1186: \n1187: $$\n1188: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}}(M) \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n1189: \n1190: $$\n1191: \n1192: where $\\tau$ is the time step size.\n1193: \n1194: **Interpretation:** The Hellinger distance to the QSD decreases exponentially fast under the kinetic operator, with a rate constant $\\kappa_{\\text{kin}}(M)$ that depends on the density bound $M$, the friction $\\gamma$, the potential coercivity $\\alpha_U$, and the hypocoercive coupling. The $O(\\tau^2)$ term arises from the BAOAB discretization error.\n1195: \n1196: **Justification of Assumption:** This assumption is satisfied for the Euclidean Gas under the following conditions:\n1197: \n1198: 1. **Bounded initial density:** If the empirical measure at $t=0$ has a bounded density ratio $d\\mu_0/d\\pi_{\\text{QSD}} \\leq M_0 < \\infty$, which holds for any finite particle system initialized within the valid domain.\n1199: \n1200: 2. **Gaussian regularization from cloning:** The cloning operator applies Gaussian perturbations with variance $\\delta^2 > 0$ to all walkers (Axiom {prf:ref}`def-axiom-local-perturbation` from [01_fragile_gas_framework](01_fragile_gas_framework)). This acts as a convolution with a Gaussian kernel:\n1201:    $$\n1202:    \\tilde{\\mu}_{t+} = \\tilde{\\mu}_t * G_{\\delta}\n1203:    $$\n1204:    Gaussian convolution immediately regularizes any measure to have $C^\\infty$ density. Since $\\pi_{\\text{QSD}}$ also has smooth density (from the Gibbs structure with smooth potential), the ratio $d\\tilde{\\mu}_{t+}/d\\tilde{\\pi}_{\\text{QSD}}$ remains bounded.\n1205: \n1206: 3. **Preservation under Fokker-Planck evolution:** The kinetic operator evolves densities according to the Fokker-Planck PDE. The **parabolic maximum principle** ensures that if $\\sup_x (d\\mu_t/d\\pi)(x) \\leq M$ initially, then $\\sup_x (d\\mu_{t+\\tau}/d\\pi)(x) \\leq M' $ where $M'$ depends on $M$, $\\tau$, and system parameters but remains finite for finite time.\n1207: \n1208: 4. **Confinement prevents escape to low-density regions:** The confining potential $U$ from Axiom {prf:ref}`ax-confining-potential` ensures $\\pi_{\\text{QSD}}(x) \\geq c_{\\min} e^{-U(x)}$ for some $c_{\\min} > 0$. Combined with the boundary killing mechanism, walkers are concentrated in regions where $\\pi_{\\text{QSD}}$ has significant mass, preventing the ratio from diverging.\n1209: \n1210: **Practical bound:** For finite-time analysis (up to any fixed $T < \\infty$), the bound $M = M(T, M_0, \\delta, \\gamma, U)$ is guaranteed to be finite by the regularization and confinement mechanisms. The constant $M$ depends on:\n1211: - Initial bound $M_0$\n1212: - Cloning noise $\\delta$ (smaller $\\delta$ requires larger $M$)\n1213: - Friction $\\gamma$ (larger $\\gamma$ gives better regularization)\n1214: - Potential curvature (stronger confinement gives tighter bounds)",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Lemma C: Kinetic Operator Hellinger Analysis"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hormander-bracket",
      "title": "Hörmander's Bracket Condition",
      "start_line": 1993,
      "end_line": 2021,
      "header_lines": [
        1994
      ],
      "content_start": 1996,
      "content_end": 2020,
      "content": "1996: :label: lem-hormander-bracket\n1997: \n1998: **Reference**: `06_convergence.md` Section 4.4.1, lines 892-950\n1999: \n2000: The kinetic generator $\\mathcal{L}_{\\text{kin}}$ has the form:\n2001: \n2002: $$\n2003: \\mathcal{L}_{\\text{kin}} = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v + \\frac{\\sigma_v^2}{2} \\Delta_v\n2004: \n2005: $$\n2006: \n2007: where $A(x, v) = \\frac{1}{m}F(x) - \\gamma(v - u(x))$ is the velocity drift.\n2008: \n2009: The vector fields:\n2010: - $X_0 = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v$ (drift)\n2011: - $X_j = \\sigma_v \\partial_{v_j}$ (diffusion, $j = 1, \\ldots, d$)\n2012: \n2013: satisfy Hörmander's bracket condition:\n2014: \n2015: $$\n2016: \\text{Lie}\\{X_0, X_1, \\ldots, X_d, [X_0, X_1], \\ldots, [X_0, X_d]\\} = T_{(x,v)}\\Omega\n2017: \n2018: $$\n2019: \n2020: at every point $(x, v) \\in \\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$.",
      "metadata": {
        "label": "lem-hormander-bracket"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "1993: #### 2.2. Hypoelliptic Structure of the Kinetic Operator\n1994: \n1995: :::{prf:lemma} Hörmander's Bracket Condition\n1996: :label: lem-hormander-bracket\n1997: \n1998: **Reference**: `06_convergence.md` Section 4.4.1, lines 892-950\n1999: \n2000: The kinetic generator $\\mathcal{L}_{\\text{kin}}$ has the form:\n2001: \n2002: $$\n2003: \\mathcal{L}_{\\text{kin}} = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v + \\frac{\\sigma_v^2}{2} \\Delta_v\n2004: \n2005: $$\n2006: \n2007: where $A(x, v) = \\frac{1}{m}F(x) - \\gamma(v - u(x))$ is the velocity drift.\n2008: \n2009: The vector fields:\n2010: - $X_0 = v \\cdot \\nabla_x + A(x, v) \\cdot \\nabla_v$ (drift)\n2011: - $X_j = \\sigma_v \\partial_{v_j}$ (diffusion, $j = 1, \\ldots, d$)\n2012: \n2013: satisfy Hörmander's bracket condition:\n2014: \n2015: $$\n2016: \\text{Lie}\\{X_0, X_1, \\ldots, X_d, [X_0, X_1], \\ldots, [X_0, X_d]\\} = T_{(x,v)}\\Omega\n2017: \n2018: $$\n2019: \n2020: at every point $(x, v) \\in \\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$.\n2021: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-linfty-full-operator",
      "title": "$L^\\infty$ Bound for the Full Operator",
      "start_line": 2072,
      "end_line": 2284,
      "header_lines": [
        2073
      ],
      "content_start": 2075,
      "content_end": 2283,
      "content": "2075: :label: lem-linfty-full-operator\n2076: \n2077: Consider the full McKean-Vlasov-Fokker-Planck equation from §2.1:\n2078: \n2079: $$\n2080: \\frac{\\partial f}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* f + \\mathcal{L}_{\\text{clone}}^* f - c(z) f + B[f, m_d]\n2081: \n2082: $$\n2083: \n2084: with initial condition $\\|f_0\\|_\\infty \\leq M_0 < \\infty$. Assume a uniform-in-time lower bound on the alive mass, $m_a(t) = \\|f(t, \\cdot)\\|_{L^1} \\geq c_{\\text{mass}} > 0$ for all $t \\geq 0$ (to be proven in Section 4).\n2085: \n2086: Then for any finite time $T > 0$:\n2087: \n2088: $$\n2089: \\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R) < \\infty\n2090: \n2091: $$\n2092: \n2093: **Proof**:\n2094: \n2095: We decompose the evolution into four components and bound each separately using the parabolic Harnack inequality.\n2096: \n2097: **Step 1: Kinetic Evolution Alone**\n2098: \n2099: Consider first the pure kinetic evolution $\\partial_t f = \\mathcal{L}_{\\text{kin}}^* f$ with reflecting boundary conditions. By the parabolic Harnack inequality (Theorem {prf:ref}`thm-parabolic-harnack`), for any cylinder $Q_R$:\n2100: \n2101: $$\n2102: \\sup_{Q_{R/2}^-} f \\leq C_H \\inf_{Q_{R/2}^+} f\n2103: \n2104: $$\n2105: \n2106: For the initial value problem with $\\|f_0\\|_\\infty \\leq M_0$, we apply this iteratively over time slices to obtain:\n2107: \n2108: $$\n2109: \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(t, \\gamma, \\sigma_v, R, d) M_0\n2110: \n2111: $$\n2112: \n2113: where $C_{\\text{kin}}(t, \\cdot)$ is the hypoelliptic smoothing constant. For $t \\geq t_{\\text{mix}}$ (mixing time), this becomes a constant independent of $t$.\n2114: \n2115: **Key Quantitative Bound**: Using the explicit Gaussian heat kernel estimates from Hérau & Nier (2004, Lemma 2.1), for $t \\geq \\tau$ (one timestep):\n2116: \n2117: $$\n2118: C_{\\text{kin}}(t, \\cdot) \\leq C_0 \\left( \\frac{R^2}{\\sigma_v^2 \\gamma t} \\right)^{d/2} + C_1\n2119: \n2120: $$\n2121: \n2122: where $C_0, C_1$ depend only on the bracket depth and dimension.\n2123: \n2124: **Step 2: Cloning Operator **\n2125: \n2126: The cloning operator with Gaussian position jitter has the form (from `03_cloning.md` line 6022):\n2127: \n2128: $$\n2129: \\mathcal{L}_{\\text{clone}}^* f = \\int_\\Omega K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n2130: \n2131: $$\n2132: \n2133: where:\n2134: - $K_{\\text{clone}}(z, z') = \\frac{1}{(2\\pi\\sigma_x^2)^{d/2}} \\exp(-\\|x - x'\\|^2 / (2\\sigma_x^2)) \\times \\delta(v - v')$ is the Gaussian kernel\n2135: - $V[f](z, z')$ is the **fitness weighting functional** (depends nonlinearly on $f$ via virtual reward)\n2136: \n2137: **Critical Observation**: The cloning operator is **NOT** a simple convolution due to the fitness weighting $V[f]$. The operator has a nonlinear source-sink structure:\n2138: \n2139: $$\n2140: \\mathcal{L}_{\\text{clone}}^* f(z) = \\underbrace{\\int K_{\\text{clone}}(z, z') V[f](z, z') f(z') dz'}_{\\text{source}} - \\underbrace{f(z) \\int K_{\\text{clone}}(z, z') V[f](z, z') dz'}_{\\text{sink}}\n2141: \n2142: $$\n2143: \n2144: **Revised $L^\\infty$ Bound**: The fitness functional satisfies (from `03_cloning.md`):\n2145: \n2146: $$\n2147: 0 \\leq V[f](z, z') \\leq V_{\\max} := \\max\\left(1, \\frac{1}{\\eta}\\right)\n2148: \n2149: $$\n2150: \n2151: where $\\eta \\in (0, 1)$ is the rescaling parameter. Therefore:\n2152: \n2153: $$\n2154: |\\mathcal{L}_{\\text{clone}}^* f(z)| \\leq V_{\\max} \\left[\\int K_{\\text{clone}}(z, z') f(z') dz' + f(z) \\int K_{\\text{clone}}(z, z') dz'\\right]\n2155: \n2156: $$\n2157: \n2158: Since $\\int K_{\\text{clone}}(z, z') dz' = 1$ (normalized kernel) and the convolution $\\int K f' dx' \\leq \\|f\\|_\\infty$:\n2159: \n2160: $$\n2161: \\|\\mathcal{L}_{\\text{clone}}^* f\\|_\\infty \\leq 2 V_{\\max} \\|f\\|_\\infty\n2162: \n2163: $$\n2164: \n2165: Over a timestep $\\tau$, using forward Euler for the source term:\n2166: \n2167: $$\n2168: \\|f_{\\text{post-clone}}\\|_\\infty \\leq (1 + 2 V_{\\max} \\tau) \\|f_{\\text{pre-clone}}\\|_\\infty\n2169: \n2170: $$\n2171: \n2172: **Impact**: This increases the hypoelliptic constant $C_{\\text{hypo}}$ by a factor $(1 + 2V_{\\max}\\tau)^{T/\\tau}$, but remains finite for finite time $T$.\n2173: \n2174: **Step 3: Killing Term**\n2175: \n2176: The killing term $-c(z) f$ with $c(z) \\geq 0$ only removes mass:\n2177: \n2178: $$\n2179: \\|f_{\\text{post-kill}}\\|_\\infty \\leq \\|f_{\\text{pre-kill}}\\|_\\infty\n2180: \n2181: $$\n2182: \n2183: **Step 4: Revival Term (Mass-Dependent Source)**\n2184: \n2185: The revival operator re-injects mass into the safe region. From `07_mean_field.md`, the revival source has the form\n2186: \n2187: $$\n2188: r_{\\text{revival}}(z) = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}(z),\n2189: $$\n2190: \n2191: where $m_a(t) = \\int f(t, z) dz$ is the alive mass and $m_d(t)$ is the dead-mass flux. The kernel $f_{\\text{safe}}$ is deterministic, compactly supported, and normalized ($\\int f_{\\text{safe}} = 1$). On the event that Section 4 proves $m_a(t) \\geq c_{\\text{mass}}$, we have\n2192: \n2193: $$\n2194: \\frac{m_d(t)}{m_a(t)} = \\frac{\\int c(z) f(t,z) dz}{m_a(t)} \\leq \\|c\\|_\\infty.\n2195: $$\n2196: \n2197: Therefore\n2198: \n2199: $$\n2200: \\|r_{\\text{revival}}\\|_\\infty \\leq \\lambda_{\\text{rev}} \\|c\\|_\\infty \\|f_{\\text{safe}}\\|_\\infty =: C_{\\text{safe}},\n2201: $$\n2202: \n2203: which is a state-independent constant (no additional factor of $\\|f\\|_\\infty$ appears).\n2204: \n2205: **Step 5: Volterra Inequality for the Supremum Norm**\n2206: \n2207: Using the Duhamel formula for the full equation over time interval $[0, T]$:\n2208: \n2209: $$\n2210: f(T, z) = \\int_\\Omega p_T^{\\text{kin}}(z, z') f_0(z') dz' + \\int_0^T \\int_\\Omega p_{T-s}^{\\text{kin}}(z, z') S[f](s, z') dz' ds\n2211: \n2212: $$\n2213: \n2214: where $S[f] = \\mathcal{L}_{\\text{clone}}^* f - c f + B[f, m_d]$ is the source term and $p_t^{\\text{kin}}$ is the kinetic heat kernel.\n2215: \n2216: Taking supremum:\n2217: \n2218: $$\n2219: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\|S[f](s, \\cdot)\\|_\\infty ds\n2220: \n2221: $$\n2222: \n2223: Since cloning and killing preserve $L^\\infty$ bounds (Steps 2-3), and revival adds at most $C_{\\text{revival}}$ per unit time (Step 4):\n2224: \n2225: $$\n2226: \\|S[f](s, \\cdot)\\|_\\infty \\leq \\|f(s, \\cdot)\\|_\\infty + C_{\\text{revival}}\n2227: \n2228: $$\n2229: \n2230: This gives the integral inequality:\n2231: \n2232: $$\n2233: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\Big[(2V_{\\max} + \\|c\\|_\\infty) \\|f(s, \\cdot)\\|_\\infty + C_{\\text{safe}}\\Big] ds.\n2234: $$\n2235: \n2236: Define $u(t) = \\|f(t, \\cdot)\\|_\\infty$, $B_* := 2V_{\\max} + \\|c\\|_\\infty$, and $\\kappa_{\\text{kin}}(T) := \\int_0^T C_{\\text{kin}}(s) ds < \\infty$ (the kinetic estimate from Step 1 implies integrability). Then\n2237: \n2238: $$\n2239: u(T) \\leq C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) + B_* \\int_0^T C_{\\text{kin}}(T - s) u(s) ds.\n2240: $$\n2241: \n2242: **Step 6: Resolvent Grönwall Argument**\n2243: \n2244: Let $C_{\\text{kin}}^{\\max}(T) = \\sup_{0 \\leq s \\leq T} C_{\\text{kin}}(s)$ and $\\Psi(T) = \\int_0^T u(s) ds$. The convolution term satisfies\n2245: \n2246: $$\n2247: \\int_0^T C_{\\text{kin}}(T - s) u(s) ds \\leq C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n2248: $$\n2249: \n2250: Hence\n2251: \n2252: $$\n2253: u(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T),\n2254: \\qquad\n2255: A_T := C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T).\n2256: $$\n2257: \n2258: Differentiating $\\Psi$ yields the Volterra inequality\n2259: \n2260: $$\n2261: \\Psi'(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n2262: $$\n2263: \n2264: Gronwall’s lemma for first-order linear ODEs gives\n2265: \n2266: $$\n2267: \\Psi(T) \\leq \\int_0^T A_s \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) (T-s)\\right) ds.\n2268: $$\n2269: \n2270: Since $A_s \\leq C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) =: A_*$ for $s \\in [0, T]$, we obtain\n2271: \n2272: $$\n2273: u(T) \\leq A_* \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n2274: $$\n2275: \n2276: Therefore the hypoelliptic $L^\\infty$ bound holds with the explicit constant\n2277: \n2278: $$\n2279: C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R)\n2280: := \\Big[C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T)\\Big]\n2281: \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n2282: $$\n2283: ",
      "metadata": {
        "label": "lem-linfty-full-operator"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "2072: The full equation includes non-local cloning terms, killing, and revival. We handle these perturbatively:\n2073: \n2074: :::{prf:lemma} $L^\\infty$ Bound for the Full Operator\n2075: :label: lem-linfty-full-operator\n2076: \n2077: Consider the full McKean-Vlasov-Fokker-Planck equation from §2.1:\n2078: \n2079: $$\n2080: \\frac{\\partial f}{\\partial t} = \\mathcal{L}_{\\text{kin}}^* f + \\mathcal{L}_{\\text{clone}}^* f - c(z) f + B[f, m_d]\n2081: \n2082: $$\n2083: \n2084: with initial condition $\\|f_0\\|_\\infty \\leq M_0 < \\infty$. Assume a uniform-in-time lower bound on the alive mass, $m_a(t) = \\|f(t, \\cdot)\\|_{L^1} \\geq c_{\\text{mass}} > 0$ for all $t \\geq 0$ (to be proven in Section 4).\n2085: \n2086: Then for any finite time $T > 0$:\n2087: \n2088: $$\n2089: \\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R) < \\infty\n2090: \n2091: $$\n2092: \n2093: **Proof**:\n2094: \n2095: We decompose the evolution into four components and bound each separately using the parabolic Harnack inequality.\n2096: \n2097: **Step 1: Kinetic Evolution Alone**\n2098: \n2099: Consider first the pure kinetic evolution $\\partial_t f = \\mathcal{L}_{\\text{kin}}^* f$ with reflecting boundary conditions. By the parabolic Harnack inequality (Theorem {prf:ref}`thm-parabolic-harnack`), for any cylinder $Q_R$:\n2100: \n2101: $$\n2102: \\sup_{Q_{R/2}^-} f \\leq C_H \\inf_{Q_{R/2}^+} f\n2103: \n2104: $$\n2105: \n2106: For the initial value problem with $\\|f_0\\|_\\infty \\leq M_0$, we apply this iteratively over time slices to obtain:\n2107: \n2108: $$\n2109: \\|f(t, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(t, \\gamma, \\sigma_v, R, d) M_0\n2110: \n2111: $$\n2112: \n2113: where $C_{\\text{kin}}(t, \\cdot)$ is the hypoelliptic smoothing constant. For $t \\geq t_{\\text{mix}}$ (mixing time), this becomes a constant independent of $t$.\n2114: \n2115: **Key Quantitative Bound**: Using the explicit Gaussian heat kernel estimates from Hérau & Nier (2004, Lemma 2.1), for $t \\geq \\tau$ (one timestep):\n2116: \n2117: $$\n2118: C_{\\text{kin}}(t, \\cdot) \\leq C_0 \\left( \\frac{R^2}{\\sigma_v^2 \\gamma t} \\right)^{d/2} + C_1\n2119: \n2120: $$\n2121: \n2122: where $C_0, C_1$ depend only on the bracket depth and dimension.\n2123: \n2124: **Step 2: Cloning Operator **\n2125: \n2126: The cloning operator with Gaussian position jitter has the form (from `03_cloning.md` line 6022):\n2127: \n2128: $$\n2129: \\mathcal{L}_{\\text{clone}}^* f = \\int_\\Omega K_{\\text{clone}}(z, z') V[f](z, z') [f(z') - f(z)] dz'\n2130: \n2131: $$\n2132: \n2133: where:\n2134: - $K_{\\text{clone}}(z, z') = \\frac{1}{(2\\pi\\sigma_x^2)^{d/2}} \\exp(-\\|x - x'\\|^2 / (2\\sigma_x^2)) \\times \\delta(v - v')$ is the Gaussian kernel\n2135: - $V[f](z, z')$ is the **fitness weighting functional** (depends nonlinearly on $f$ via virtual reward)\n2136: \n2137: **Critical Observation**: The cloning operator is **NOT** a simple convolution due to the fitness weighting $V[f]$. The operator has a nonlinear source-sink structure:\n2138: \n2139: $$\n2140: \\mathcal{L}_{\\text{clone}}^* f(z) = \\underbrace{\\int K_{\\text{clone}}(z, z') V[f](z, z') f(z') dz'}_{\\text{source}} - \\underbrace{f(z) \\int K_{\\text{clone}}(z, z') V[f](z, z') dz'}_{\\text{sink}}\n2141: \n2142: $$\n2143: \n2144: **Revised $L^\\infty$ Bound**: The fitness functional satisfies (from `03_cloning.md`):\n2145: \n2146: $$\n2147: 0 \\leq V[f](z, z') \\leq V_{\\max} := \\max\\left(1, \\frac{1}{\\eta}\\right)\n2148: \n2149: $$\n2150: \n2151: where $\\eta \\in (0, 1)$ is the rescaling parameter. Therefore:\n2152: \n2153: $$\n2154: |\\mathcal{L}_{\\text{clone}}^* f(z)| \\leq V_{\\max} \\left[\\int K_{\\text{clone}}(z, z') f(z') dz' + f(z) \\int K_{\\text{clone}}(z, z') dz'\\right]\n2155: \n2156: $$\n2157: \n2158: Since $\\int K_{\\text{clone}}(z, z') dz' = 1$ (normalized kernel) and the convolution $\\int K f' dx' \\leq \\|f\\|_\\infty$:\n2159: \n2160: $$\n2161: \\|\\mathcal{L}_{\\text{clone}}^* f\\|_\\infty \\leq 2 V_{\\max} \\|f\\|_\\infty\n2162: \n2163: $$\n2164: \n2165: Over a timestep $\\tau$, using forward Euler for the source term:\n2166: \n2167: $$\n2168: \\|f_{\\text{post-clone}}\\|_\\infty \\leq (1 + 2 V_{\\max} \\tau) \\|f_{\\text{pre-clone}}\\|_\\infty\n2169: \n2170: $$\n2171: \n2172: **Impact**: This increases the hypoelliptic constant $C_{\\text{hypo}}$ by a factor $(1 + 2V_{\\max}\\tau)^{T/\\tau}$, but remains finite for finite time $T$.\n2173: \n2174: **Step 3: Killing Term**\n2175: \n2176: The killing term $-c(z) f$ with $c(z) \\geq 0$ only removes mass:\n2177: \n2178: $$\n2179: \\|f_{\\text{post-kill}}\\|_\\infty \\leq \\|f_{\\text{pre-kill}}\\|_\\infty\n2180: \n2181: $$\n2182: \n2183: **Step 4: Revival Term (Mass-Dependent Source)**\n2184: \n2185: The revival operator re-injects mass into the safe region. From `07_mean_field.md`, the revival source has the form\n2186: \n2187: $$\n2188: r_{\\text{revival}}(z) = \\lambda_{\\text{rev}} \\frac{m_d(t)}{m_a(t)} f_{\\text{safe}}(z),\n2189: $$\n2190: \n2191: where $m_a(t) = \\int f(t, z) dz$ is the alive mass and $m_d(t)$ is the dead-mass flux. The kernel $f_{\\text{safe}}$ is deterministic, compactly supported, and normalized ($\\int f_{\\text{safe}} = 1$). On the event that Section 4 proves $m_a(t) \\geq c_{\\text{mass}}$, we have\n2192: \n2193: $$\n2194: \\frac{m_d(t)}{m_a(t)} = \\frac{\\int c(z) f(t,z) dz}{m_a(t)} \\leq \\|c\\|_\\infty.\n2195: $$\n2196: \n2197: Therefore\n2198: \n2199: $$\n2200: \\|r_{\\text{revival}}\\|_\\infty \\leq \\lambda_{\\text{rev}} \\|c\\|_\\infty \\|f_{\\text{safe}}\\|_\\infty =: C_{\\text{safe}},\n2201: $$\n2202: \n2203: which is a state-independent constant (no additional factor of $\\|f\\|_\\infty$ appears).\n2204: \n2205: **Step 5: Volterra Inequality for the Supremum Norm**\n2206: \n2207: Using the Duhamel formula for the full equation over time interval $[0, T]$:\n2208: \n2209: $$\n2210: f(T, z) = \\int_\\Omega p_T^{\\text{kin}}(z, z') f_0(z') dz' + \\int_0^T \\int_\\Omega p_{T-s}^{\\text{kin}}(z, z') S[f](s, z') dz' ds\n2211: \n2212: $$\n2213: \n2214: where $S[f] = \\mathcal{L}_{\\text{clone}}^* f - c f + B[f, m_d]$ is the source term and $p_t^{\\text{kin}}$ is the kinetic heat kernel.\n2215: \n2216: Taking supremum:\n2217: \n2218: $$\n2219: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\|S[f](s, \\cdot)\\|_\\infty ds\n2220: \n2221: $$\n2222: \n2223: Since cloning and killing preserve $L^\\infty$ bounds (Steps 2-3), and revival adds at most $C_{\\text{revival}}$ per unit time (Step 4):\n2224: \n2225: $$\n2226: \\|S[f](s, \\cdot)\\|_\\infty \\leq \\|f(s, \\cdot)\\|_\\infty + C_{\\text{revival}}\n2227: \n2228: $$\n2229: \n2230: This gives the integral inequality:\n2231: \n2232: $$\n2233: \\|f(T, \\cdot)\\|_\\infty \\leq C_{\\text{kin}}(T) M_0 + \\int_0^T C_{\\text{kin}}(T - s) \\Big[(2V_{\\max} + \\|c\\|_\\infty) \\|f(s, \\cdot)\\|_\\infty + C_{\\text{safe}}\\Big] ds.\n2234: $$\n2235: \n2236: Define $u(t) = \\|f(t, \\cdot)\\|_\\infty$, $B_* := 2V_{\\max} + \\|c\\|_\\infty$, and $\\kappa_{\\text{kin}}(T) := \\int_0^T C_{\\text{kin}}(s) ds < \\infty$ (the kinetic estimate from Step 1 implies integrability). Then\n2237: \n2238: $$\n2239: u(T) \\leq C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) + B_* \\int_0^T C_{\\text{kin}}(T - s) u(s) ds.\n2240: $$\n2241: \n2242: **Step 6: Resolvent Grönwall Argument**\n2243: \n2244: Let $C_{\\text{kin}}^{\\max}(T) = \\sup_{0 \\leq s \\leq T} C_{\\text{kin}}(s)$ and $\\Psi(T) = \\int_0^T u(s) ds$. The convolution term satisfies\n2245: \n2246: $$\n2247: \\int_0^T C_{\\text{kin}}(T - s) u(s) ds \\leq C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n2248: $$\n2249: \n2250: Hence\n2251: \n2252: $$\n2253: u(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T),\n2254: \\qquad\n2255: A_T := C_{\\text{kin}}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T).\n2256: $$\n2257: \n2258: Differentiating $\\Psi$ yields the Volterra inequality\n2259: \n2260: $$\n2261: \\Psi'(T) \\leq A_T + B_* C_{\\text{kin}}^{\\max}(T) \\Psi(T).\n2262: $$\n2263: \n2264: Gronwall’s lemma for first-order linear ODEs gives\n2265: \n2266: $$\n2267: \\Psi(T) \\leq \\int_0^T A_s \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) (T-s)\\right) ds.\n2268: $$\n2269: \n2270: Since $A_s \\leq C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T) =: A_*$ for $s \\in [0, T]$, we obtain\n2271: \n2272: $$\n2273: u(T) \\leq A_* \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n2274: $$\n2275: \n2276: Therefore the hypoelliptic $L^\\infty$ bound holds with the explicit constant\n2277: \n2278: $$\n2279: C_{\\text{hypo}}(M_0, T, \\gamma, \\sigma_v, \\sigma_x, U, R)\n2280: := \\Big[C_{\\text{kin}}^{\\max}(T) M_0 + C_{\\text{safe}} \\kappa_{\\text{kin}}(T)\\Big]\n2281: \\exp\\!\\left(B_* C_{\\text{kin}}^{\\max}(T) T\\right).\n2282: $$\n2283: \n2284: This constant is finite for every finite $T$, depends on all physical parameters, and controls $\\sup_{t \\in [0, T]} \\|f(t, \\cdot)\\|_\\infty$. $\\square$",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-gaussian-kernel-lower-bound",
      "title": "Gaussian Kernel Lower Bound",
      "start_line": 2296,
      "end_line": 2346,
      "header_lines": [
        2297
      ],
      "content_start": 2299,
      "content_end": 2345,
      "content": "2299: :label: lem-gaussian-kernel-lower-bound\n2300: \n2301: Let $G_{\\sigma_x}(y) = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-\\|y\\|^2 / (2\\sigma_x^2))$ be the Gaussian kernel with variance $\\sigma_x^2 > 0$.\n2302: \n2303: For any $x_1, x_2 \\in B_R(0) \\subset \\mathbb{R}^d$:\n2304: \n2305: $$\n2306: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} \\leq \\exp\\left( \\frac{(2R)^2}{2\\sigma_x^2} \\right)\n2307: \n2308: $$\n2309: \n2310: Moreover, for any integrable density $\\rho$ with $\\|\\rho\\|_{L^1} = m > 0$:\n2311: \n2312: $$\n2313: \\inf_{x \\in B_R} \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq m \\cdot c_{\\sigma_x, R}\n2314: \n2315: $$\n2316: \n2317: where:\n2318: \n2319: $$\n2320: c_{\\sigma_x, R} := (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) > 0\n2321: \n2322: $$\n2323: \n2324: **Proof**:\n2325: \n2326: For the ratio bound, note that for $x_1, x_2 \\in B_R$:\n2327: \n2328: $$\n2329: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} = \\exp\\left( \\frac{\\|x_2\\|^2 - \\|x_1\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{\\|x_2\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{R^2}{2\\sigma_x^2} \\right)\n2330: \n2331: $$\n2332: \n2333: For the lower bound, fix $x \\in B_R$. For any $y \\in B_R$, $\\|x - y\\| \\leq 2R$, so:\n2334: \n2335: $$\n2336: G_{\\sigma_x}(x - y) \\geq (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) = c_{\\sigma_x, R}\n2337: \n2338: $$\n2339: \n2340: Therefore:\n2341: \n2342: $$\n2343: \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq c_{\\sigma_x, R} \\int_{B_R} \\rho(y) dy = c_{\\sigma_x, R} \\cdot m\n2344: \n2345: $$",
      "metadata": {
        "label": "lem-gaussian-kernel-lower-bound"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "2296: #### 3.1. Quantitative Gaussian Mollification Bounds\n2297: \n2298: :::{prf:lemma} Gaussian Kernel Lower Bound\n2299: :label: lem-gaussian-kernel-lower-bound\n2300: \n2301: Let $G_{\\sigma_x}(y) = (2\\pi\\sigma_x^2)^{-d/2} \\exp(-\\|y\\|^2 / (2\\sigma_x^2))$ be the Gaussian kernel with variance $\\sigma_x^2 > 0$.\n2302: \n2303: For any $x_1, x_2 \\in B_R(0) \\subset \\mathbb{R}^d$:\n2304: \n2305: $$\n2306: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} \\leq \\exp\\left( \\frac{(2R)^2}{2\\sigma_x^2} \\right)\n2307: \n2308: $$\n2309: \n2310: Moreover, for any integrable density $\\rho$ with $\\|\\rho\\|_{L^1} = m > 0$:\n2311: \n2312: $$\n2313: \\inf_{x \\in B_R} \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq m \\cdot c_{\\sigma_x, R}\n2314: \n2315: $$\n2316: \n2317: where:\n2318: \n2319: $$\n2320: c_{\\sigma_x, R} := (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) > 0\n2321: \n2322: $$\n2323: \n2324: **Proof**:\n2325: \n2326: For the ratio bound, note that for $x_1, x_2 \\in B_R$:\n2327: \n2328: $$\n2329: \\frac{G_{\\sigma_x}(x_1)}{G_{\\sigma_x}(x_2)} = \\exp\\left( \\frac{\\|x_2\\|^2 - \\|x_1\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{\\|x_2\\|^2}{2\\sigma_x^2} \\right) \\leq \\exp\\left( \\frac{R^2}{2\\sigma_x^2} \\right)\n2330: \n2331: $$\n2332: \n2333: For the lower bound, fix $x \\in B_R$. For any $y \\in B_R$, $\\|x - y\\| \\leq 2R$, so:\n2334: \n2335: $$\n2336: G_{\\sigma_x}(x - y) \\geq (2\\pi\\sigma_x^2)^{-d/2} \\exp\\left( -\\frac{(2R)^2}{2\\sigma_x^2} \\right) = c_{\\sigma_x, R}\n2337: \n2338: $$\n2339: \n2340: Therefore:\n2341: \n2342: $$\n2343: \\int_{B_R} G_{\\sigma_x}(x - y) \\rho(y) dy \\geq c_{\\sigma_x, R} \\int_{B_R} \\rho(y) dy = c_{\\sigma_x, R} \\cdot m\n2344: \n2345: $$\n2346: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-strict-positivity-cloning",
      "title": "Strict Positivity After Cloning",
      "start_line": 2350,
      "end_line": 2391,
      "header_lines": [
        2351
      ],
      "content_start": 2353,
      "content_end": 2390,
      "content": "2353: :label: lem-strict-positivity-cloning\n2354: \n2355: After applying the cloning operator with Gaussian position jitter $\\sigma_x > 0$, the density satisfies:\n2356: \n2357: $$\n2358: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n2359: \n2360: $$\n2361: \n2362: where $c_{\\sigma_x, R}$ is defined in Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`.\n2363: \n2364: **Proof**: From `03_cloning.md` (line 6022), the position update is:\n2365: \n2366: $$\n2367: x_i' = x_j + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n2368: \n2369: $$\n2370: \n2371: In the mean-field limit, this corresponds to convolution with the Gaussian kernel:\n2372: \n2373: $$\n2374: \\rho_{\\text{post-clone}}(x) = \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) w(y) \\rho_{\\text{pre-clone}}(y) dy\n2375: \n2376: $$\n2377: \n2378: where $w(y)$ is the fitness weighting (always positive). Since $w(y) \\geq \\eta > 0$ (floor from rescale transformation, `01_fragile_gas_framework.md`), we have:\n2379: \n2380: $$\n2381: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) \\rho_{\\text{pre-clone}}(y) dy\n2382: \n2383: $$\n2384: \n2385: Applying Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`:\n2386: \n2387: $$\n2388: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\cdot c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n2389: \n2390: $$",
      "metadata": {
        "label": "lem-strict-positivity-cloning"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "2350: #### 3.2. Lower Bound on Post-Cloning Density\n2351: \n2352: :::{prf:lemma} Strict Positivity After Cloning\n2353: :label: lem-strict-positivity-cloning\n2354: \n2355: After applying the cloning operator with Gaussian position jitter $\\sigma_x > 0$, the density satisfies:\n2356: \n2357: $$\n2358: \\inf_{x \\in \\mathcal{X}_{\\text{valid}}} \\rho_{\\text{post-clone}}(x) \\geq c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n2359: \n2360: $$\n2361: \n2362: where $c_{\\sigma_x, R}$ is defined in Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`.\n2363: \n2364: **Proof**: From `03_cloning.md` (line 6022), the position update is:\n2365: \n2366: $$\n2367: x_i' = x_j + \\sigma_x \\zeta_i^x \\quad \\text{where } \\zeta_i^x \\sim \\mathcal{N}(0, I_d)\n2368: \n2369: $$\n2370: \n2371: In the mean-field limit, this corresponds to convolution with the Gaussian kernel:\n2372: \n2373: $$\n2374: \\rho_{\\text{post-clone}}(x) = \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) w(y) \\rho_{\\text{pre-clone}}(y) dy\n2375: \n2376: $$\n2377: \n2378: where $w(y)$ is the fitness weighting (always positive). Since $w(y) \\geq \\eta > 0$ (floor from rescale transformation, `01_fragile_gas_framework.md`), we have:\n2379: \n2380: $$\n2381: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\int_{\\mathcal{X}_{\\text{valid}}} G_{\\sigma_x}(x - y) \\rho_{\\text{pre-clone}}(y) dy\n2382: \n2383: $$\n2384: \n2385: Applying Lemma {prf:ref}`lem-gaussian-kernel-lower-bound`:\n2386: \n2387: $$\n2388: \\rho_{\\text{post-clone}}(x) \\geq \\eta \\cdot c_{\\sigma_x, R} \\|\\rho_{\\text{pre-clone}}\\|_{L^1}\n2389: \n2390: $$\n2391: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-qsd-strict-positivity",
      "title": "QSD Strict Positivity",
      "start_line": 2395,
      "end_line": 2485,
      "header_lines": [
        2396
      ],
      "content_start": 2398,
      "content_end": 2484,
      "content": "2398: :label: lem-qsd-strict-positivity\n2399: \n2400: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ has a smooth density with respect to Lebesgue measure that satisfies\n2401: \n2402: $$\n2403: \\inf_{(x,v) \\in \\Omega} \\pi_{\\text{QSD}}(x, v) \\geq c_\\pi > 0,\n2404: $$\n2405: \n2406: where $\\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$ and\n2407: \n2408: $$\n2409: c_\\pi = \\big(\\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R}\\big) \\, m_{\\text{eq}},\n2410: \\qquad\n2411: c_{\\text{vel}} := (2\\pi\\sigma_v^2 \\beta_\\star)^{-d/2} \\exp\\!\\left(-\\frac{4 V_{\\max}^2}{2 \\sigma_v^2 \\beta_\\star}\\right).\n2412: $$\n2413: \n2414: Here $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ and $\\beta_\\star = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$ for a fixed velocity-refresh time $\\tau_v > 0$.\n2415: \n2416: **Proof**:\n2417: \n2418: **Step 1 (Velocity Refresh via Ornstein-Uhlenbeck Block)**  \n2419: During a kinetic window of length $\\tau_v$, the BAOAB operator evolves the velocity according to\n2420: \n2421: $$\n2422: p_v^{\\text{OU}}(\\tau_v; v_0, v)\n2423: = (2\\pi\\sigma_v^2 \\beta(\\tau_v))^{-d/2}\n2424: \\exp\\!\\left(-\\frac{|v - e^{-\\gamma \\tau_v} v_0|^2}{2 \\sigma_v^2 \\beta(\\tau_v)}\\right),\n2425: $$\n2426: \n2427: with $\\beta(\\tau_v) = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$. Because $V_{\\text{alg}}$ is compact ($|v| \\leq V_{\\max}$), choosing $\\tau_v$ so that $\\beta(\\tau_v) \\geq \\beta_\\star>0$ gives\n2428: \n2429: $$\n2430: p_v^{\\text{OU}}(\\tau_v; v_0, v) \\geq c_{\\text{vel}}\n2431: \\quad \\text{for all } v_0, v \\in V_{\\text{alg}}.\n2432: $$\n2433: \n2434: Hence a single kinetic block already spreads mass over **all** velocity directions with a state-independent density floor.\n2435: \n2436: **Step 2 (Spatial Mollification Without Velocity Restriction)**  \n2437: Conditioned on any $(x_1, v_1)$ produced by Step 1, the cloning kernel\n2438: \n2439: $$\n2440: K_{\\text{clone}}\\big((x_1, v_1), (x, v)\\big)\n2441: = \\eta \\, G_{\\sigma_x}(x - x_1) \\, \\delta(v - v_1)\n2442: $$\n2443: \n2444: acts on the position coordinate. Lemma {prf:ref}`lem-gaussian-kernel-lower-bound` implies\n2445: \n2446: $$\n2447: G_{\\sigma_x}(x - x_1) \\geq c_{\\sigma_x, R}\n2448: \\qquad \\forall x, x_1 \\in \\mathcal{X}_{\\text{valid}},\n2449: $$\n2450: \n2451: so positions are minorized by Lebesgue measure independently of the pre-cloning state.\n2452: \n2453: **Step 3 (Two-Step Doeblin Minorization)**  \n2454: Let $P^{(2)}$ denote “kinetic over $\\tau_v$” composed with “cloning.” For any measurable $A \\subseteq \\Omega$,\n2455: \n2456: $$\n2457: P^{(2)}((x_0, v_0), A)\n2458: = \\int_\\Omega p_v^{\\text{OU}}(\\tau_v; v_0, v_1) K_{\\text{clone}}\\big((x_1, v_1), A\\big) \\, dx_1 \\, dv_1\n2459: \\geq \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R} \\, |A|,\n2460: $$\n2461: \n2462: where $|A|$ is the Lebesgue measure of $A$ in $\\Omega$. Thus $P^{(2)}$ satisfies a genuine Doeblin condition\n2463: \n2464: $$\n2465: P^{(2)}(z, A) \\geq \\delta_2 \\, \\nu(A),\n2466: \\qquad\n2467: \\delta_2 := \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R},\n2468: $$\n2469: \n2470: with state-independent minorization measure $\\nu(A) = |A|/|\\Omega|$.\n2471: \n2472: **Step 4 (Transfer to the QSD)**  \n2473: For the invariant quasi-stationary distribution,\n2474: \n2475: $$\n2476: \\pi_{\\text{QSD}}(A)\n2477: = \\int_\\Omega P^{(2)}(z, A) \\, \\pi_{\\text{QSD}}(dz)\n2478: \\geq \\delta_2 \\, m_{\\text{eq}} \\, \\nu(A),\n2479: $$\n2480: \n2481: so $\\pi_{\\text{QSD}}$ possesses a density bounded below by $c_\\pi = \\delta_2 m_{\\text{eq}} / |\\Omega|$ at every point of $\\Omega$.\n2482: \n2483: **Step 5 (Smoothness)**  \n2484: Lemma {prf:ref}`lem-linfty-full-operator` provides hypoelliptic smoothing, giving $\\pi_{\\text{QSD}} \\in C^\\infty(\\Omega)$ and promoting the almost-everywhere lower bound to a pointwise one.",
      "metadata": {
        "label": "lem-qsd-strict-positivity"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "2395: #### 3.3. QSD Density Lower Bound via Multi-Step Minorization\n2396: \n2397: :::{prf:lemma} QSD Strict Positivity\n2398: :label: lem-qsd-strict-positivity\n2399: \n2400: The quasi-stationary distribution $\\pi_{\\text{QSD}}$ has a smooth density with respect to Lebesgue measure that satisfies\n2401: \n2402: $$\n2403: \\inf_{(x,v) \\in \\Omega} \\pi_{\\text{QSD}}(x, v) \\geq c_\\pi > 0,\n2404: $$\n2405: \n2406: where $\\Omega = \\mathcal{X}_{\\text{valid}} \\times V_{\\text{alg}}$ and\n2407: \n2408: $$\n2409: c_\\pi = \\big(\\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R}\\big) \\, m_{\\text{eq}},\n2410: \\qquad\n2411: c_{\\text{vel}} := (2\\pi\\sigma_v^2 \\beta_\\star)^{-d/2} \\exp\\!\\left(-\\frac{4 V_{\\max}^2}{2 \\sigma_v^2 \\beta_\\star}\\right).\n2412: $$\n2413: \n2414: Here $m_{\\text{eq}} = \\|\\pi_{\\text{QSD}}\\|_{L^1}$ and $\\beta_\\star = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$ for a fixed velocity-refresh time $\\tau_v > 0$.\n2415: \n2416: **Proof**:\n2417: \n2418: **Step 1 (Velocity Refresh via Ornstein-Uhlenbeck Block)**  \n2419: During a kinetic window of length $\\tau_v$, the BAOAB operator evolves the velocity according to\n2420: \n2421: $$\n2422: p_v^{\\text{OU}}(\\tau_v; v_0, v)\n2423: = (2\\pi\\sigma_v^2 \\beta(\\tau_v))^{-d/2}\n2424: \\exp\\!\\left(-\\frac{|v - e^{-\\gamma \\tau_v} v_0|^2}{2 \\sigma_v^2 \\beta(\\tau_v)}\\right),\n2425: $$\n2426: \n2427: with $\\beta(\\tau_v) = (1 - e^{-2\\gamma \\tau_v})/(2\\gamma)$. Because $V_{\\text{alg}}$ is compact ($|v| \\leq V_{\\max}$), choosing $\\tau_v$ so that $\\beta(\\tau_v) \\geq \\beta_\\star>0$ gives\n2428: \n2429: $$\n2430: p_v^{\\text{OU}}(\\tau_v; v_0, v) \\geq c_{\\text{vel}}\n2431: \\quad \\text{for all } v_0, v \\in V_{\\text{alg}}.\n2432: $$\n2433: \n2434: Hence a single kinetic block already spreads mass over **all** velocity directions with a state-independent density floor.\n2435: \n2436: **Step 2 (Spatial Mollification Without Velocity Restriction)**  \n2437: Conditioned on any $(x_1, v_1)$ produced by Step 1, the cloning kernel\n2438: \n2439: $$\n2440: K_{\\text{clone}}\\big((x_1, v_1), (x, v)\\big)\n2441: = \\eta \\, G_{\\sigma_x}(x - x_1) \\, \\delta(v - v_1)\n2442: $$\n2443: \n2444: acts on the position coordinate. Lemma {prf:ref}`lem-gaussian-kernel-lower-bound` implies\n2445: \n2446: $$\n2447: G_{\\sigma_x}(x - x_1) \\geq c_{\\sigma_x, R}\n2448: \\qquad \\forall x, x_1 \\in \\mathcal{X}_{\\text{valid}},\n2449: $$\n2450: \n2451: so positions are minorized by Lebesgue measure independently of the pre-cloning state.\n2452: \n2453: **Step 3 (Two-Step Doeblin Minorization)**  \n2454: Let $P^{(2)}$ denote “kinetic over $\\tau_v$” composed with “cloning.” For any measurable $A \\subseteq \\Omega$,\n2455: \n2456: $$\n2457: P^{(2)}((x_0, v_0), A)\n2458: = \\int_\\Omega p_v^{\\text{OU}}(\\tau_v; v_0, v_1) K_{\\text{clone}}\\big((x_1, v_1), A\\big) \\, dx_1 \\, dv_1\n2459: \\geq \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R} \\, |A|,\n2460: $$\n2461: \n2462: where $|A|$ is the Lebesgue measure of $A$ in $\\Omega$. Thus $P^{(2)}$ satisfies a genuine Doeblin condition\n2463: \n2464: $$\n2465: P^{(2)}(z, A) \\geq \\delta_2 \\, \\nu(A),\n2466: \\qquad\n2467: \\delta_2 := \\eta \\, c_{\\text{vel}} \\, c_{\\sigma_x, R},\n2468: $$\n2469: \n2470: with state-independent minorization measure $\\nu(A) = |A|/|\\Omega|$.\n2471: \n2472: **Step 4 (Transfer to the QSD)**  \n2473: For the invariant quasi-stationary distribution,\n2474: \n2475: $$\n2476: \\pi_{\\text{QSD}}(A)\n2477: = \\int_\\Omega P^{(2)}(z, A) \\, \\pi_{\\text{QSD}}(dz)\n2478: \\geq \\delta_2 \\, m_{\\text{eq}} \\, \\nu(A),\n2479: $$\n2480: \n2481: so $\\pi_{\\text{QSD}}$ possesses a density bounded below by $c_\\pi = \\delta_2 m_{\\text{eq}} / |\\Omega|$ at every point of $\\Omega$.\n2482: \n2483: **Step 5 (Smoothness)**  \n2484: Lemma {prf:ref}`lem-linfty-full-operator` provides hypoelliptic smoothing, giving $\\pi_{\\text{QSD}} \\in C^\\infty(\\Omega)$ and promoting the almost-everywhere lower bound to a pointwise one.\n2485: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-mass-lower-bound-high-prob",
      "title": "High-Probability Alive Mass Lower Bound",
      "start_line": 2570,
      "end_line": 2689,
      "header_lines": [
        2571
      ],
      "content_start": 2573,
      "content_end": 2688,
      "content": "2573: :label: lem-mass-lower-bound-high-prob\n2574: \n2575: For the Euclidean Gas with $N$ walkers there exist constants $c_{\\text{mass}}, C, \\delta > 0$, depending only on $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ and the initial mass $m_0$, such that for every $t \\geq 0$\n2576: \n2577: $$\n2578: \\mathbb{P}\\!\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - C (1+t) e^{-\\delta N}.\n2579: $$\n2580: \n2581: **Proof (full-process spectral gap + logistic ODE)**:\n2582: \n2583: We split the argument into an **early-time deterministic floor** and a **late-time concentration regime**. Throughout we denote $k_t = k_t(\\omega)$ the number of alive walkers and $m_a(t) = \\|\\rho_t\\|_{L^1}$ the PDE mass.\n2584: \n2585: **Step 0: Deterministic floor on $[0, t_{\\text{eq}}]$ via logistic ODE**  \n2586: The mass equation derived in `07_mean_field.md` reads\n2587: \n2588: $$\n2589: \\frac{d}{dt} m_a(t) = -\\int_\\Omega c(z) \\rho_t(z) dz + \\lambda_{\\text{rev}} \\big( 1 - m_a(t) \\big).\n2590: $$\n2591: \n2592: Using $\\int c(z) \\rho_t(z) dz \\leq c_{\\max} m_a(t)$, we obtain the comparison inequality\n2593: \n2594: $$\n2595: \\frac{d}{dt} m_a(t) \\geq - (c_{\\max} + \\lambda_{\\text{rev}}) m_a(t) + \\lambda_{\\text{rev}}.\n2596: $$\n2597: \n2598: Solving gives the explicit lower envelope\n2599: \n2600: $$\n2601: m_{\\text{floor}}(t)\n2602: = m_\\infty - \\big(m_\\infty - m_0\\big) e^{-(c_{\\max} + \\lambda_{\\text{rev}}) t},\n2603: \\qquad\n2604: m_\\infty = \\frac{\\lambda_{\\text{rev}}}{c_{\\max} + \\lambda_{\\text{rev}}} > 0.\n2605: $$\n2606: \n2607: Hence $m_a(t) \\geq m_{\\text{floor}}(t)$ for all $t \\geq 0$. Choosing the equilibration time $t_{\\text{eq}} = O(\\kappa_{\\text{QSD}}^{-1} \\log N)$, we set\n2608: \n2609: $$\n2610: c_{\\text{early}} := \\frac{1}{2} \\min_{0 \\leq s \\leq t_{\\text{eq}}} m_{\\text{floor}}(s) > 0.\n2611: $$\n2612: \n2613: The propagation-of-chaos estimate proved in Section 4.5 (Proposition {prf:ref}`prop-poc-mass`) states that, for any $\\epsilon > 0$,\n2614: \n2615: $$\n2616: \\mathbb{P}\\left( \\sup_{0 \\leq s \\leq t_{\\text{eq}}} \\left| \\frac{k_s}{N} - m_a(s) \\right| > \\epsilon \\right) \\leq C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N \\epsilon^2}.\n2617: $$\n2618: \n2619: Taking $\\epsilon = c_{\\text{early}}$ yields the early-time event\n2620: \n2621: $$\n2622: \\mathbb{P}\\left( \\inf_{0 \\leq s \\leq t_{\\text{eq}}} \\frac{k_s}{N} \\geq c_{\\text{early}} \\right) \\geq 1 - C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N c_{\\text{early}}^2}.\n2623: $$\n2624: \n2625: This establishes the desired floor on $[0, t_{\\text{eq}}]$.\n2626: \n2627: **Step 1: Spectral gap for configuration observables (removing the Markov assumption on $k_t$)**  \n2628: The $N$-particle process $Z_t = (z_t^{(1)}, \\ldots, z_t^{(N)})$ is geometrically ergodic with spectral gap $\\kappa_{\\text{full}} > 0$ in $L^2(\\Pi_{\\text{QSD}}^{(N)})$ (Theorem 4.5 of `06_convergence.md`). For any observable $F : \\Omega^N \\to \\mathbb{R}$,\n2629: \n2630: $$\n2631: \\text{Var}_{\\Pi_{\\text{QSD}}^{(N)}}(F) \\leq \\frac{1}{\\kappa_{\\text{full}}} \\langle -\\mathcal{L}^{(N)} F, F \\rangle.\n2632: $$\n2633: \n2634: We apply this to $F(Z) = k(Z)/N = N^{-1} \\sum_{i=1}^N \\mathbf{1}_{\\{\\text{walker } i \\text{ alive}\\}}$. Changing a single coordinate alters $F$ by at most $1/N$, so $F$ is $1/N$-Lipschitz with respect to the Hamming metric. By the Herbst argument for Markov semigroups with spectral gap (see, e.g., Joulin & Ollivier 2010, Theorem 5.1), $F$ satisfies\n2635: \n2636: $$\n2637: \\Pi_{\\text{QSD}}^{(N)}\\!\\left( \\left| \\frac{k}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n2638: \\leq 2 \\exp\\!\\left( - \\frac{\\kappa_{\\text{full}} N^2 r^2}{2} \\right)\n2639: \\leq 2 \\exp\\!\\left( - \\beta_{\\text{gap}} N r^2 \\right),\n2640: $$\n2641: \n2642: where we set $\\beta_{\\text{gap}} := \\kappa_{\\text{full}} / 2$ (the second inequality uses $N^2 \\geq N$ so the exponent now scales linearly in $N$).\n2643: \n2644: This argument works directly on the full configuration process $Z_t$; no Markov property for the projected count $k_t$ is required, thereby correcting the earlier (invalid) reduction to a standalone birth-death chain.\n2645: \n2646: **Step 2: Finite-time concentration after equilibration**  \n2647: Let $\\mathcal{L}_t$ be the law of $Z_t$ starting from any initial configuration with alive mass at least $c_{\\text{early}}$. By Theorem 4.5 of `06_convergence.md`,\n2648: \n2649: $$\n2650: \\|\\mathcal{L}_t - \\Pi_{\\text{QSD}}^{(N)}\\|_{\\text{TV}}\n2651: \\leq C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})} \\quad \\text{for } t \\geq t_{\\text{eq}}.\n2652: $$\n2653: \n2654: Therefore, for $t \\geq t_{\\text{eq}}$ and any $r > 0$,\n2655: \n2656: $$\n2657: \\mathbb{P}\\left( \\left| \\frac{k_t}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n2658: \\leq 2 e^{-\\beta_{\\text{gap}} N r^2} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n2659: $$\n2660: \n2661: Selecting $r = m_{\\text{eq}}/2$ yields\n2662: \n2663: $$\n2664: \\mathbb{P}\\left( \\frac{k_t}{N} \\leq \\frac{m_{\\text{eq}}}{2} \\right)\n2665: \\leq 2 e^{-\\beta_{\\text{gap}} N m_{\\text{eq}}^2 / 4} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n2666: $$\n2667: \n2668: **Step 3: Survival conditioning**  \n2669: The survival estimate of Theorem {prf:ref}`thm-exponential-survival` gives\n2670: \n2671: $$\n2672: \\mathbb{P}(\\tau_\\dagger \\leq t) \\leq t e^{-C_{\\text{surv}} N}.\n2673: $$\n2674: \n2675: Intersecting the complementary survival event with the concentration events from Steps 0-2 shows that, for all $t \\geq 0$,\n2676: \n2677: $$\n2678: \\mathbb{P}\\left( \\frac{k_t}{N} \\geq \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right) \\right)\n2679: \\geq 1 - C (1+t) e^{-\\delta N},\n2680: $$\n2681: \n2682: with $\\delta = \\min(\\beta_{\\text{pc}} c_{\\text{early}}^2, \\beta_{\\text{gap}} m_{\\text{eq}}^2/4, C_{\\text{surv}})$.\n2683: \n2684: Setting\n2685: \n2686: $$\n2687: c_{\\text{mass}} := \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right)\n2688: $$",
      "metadata": {
        "label": "lem-mass-lower-bound-high-prob"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "2570: #### 4.3. High-Probability Mass Lower Bound\n2571: \n2572: :::{prf:lemma} High-Probability Alive Mass Lower Bound\n2573: :label: lem-mass-lower-bound-high-prob\n2574: \n2575: For the Euclidean Gas with $N$ walkers there exist constants $c_{\\text{mass}}, C, \\delta > 0$, depending only on $(\\gamma, \\sigma_v, \\sigma_x, U, R)$ and the initial mass $m_0$, such that for every $t \\geq 0$\n2576: \n2577: $$\n2578: \\mathbb{P}\\!\\left( \\|\\rho_t\\|_{L^1} \\geq c_{\\text{mass}} \\right) \\geq 1 - C (1+t) e^{-\\delta N}.\n2579: $$\n2580: \n2581: **Proof (full-process spectral gap + logistic ODE)**:\n2582: \n2583: We split the argument into an **early-time deterministic floor** and a **late-time concentration regime**. Throughout we denote $k_t = k_t(\\omega)$ the number of alive walkers and $m_a(t) = \\|\\rho_t\\|_{L^1}$ the PDE mass.\n2584: \n2585: **Step 0: Deterministic floor on $[0, t_{\\text{eq}}]$ via logistic ODE**  \n2586: The mass equation derived in `07_mean_field.md` reads\n2587: \n2588: $$\n2589: \\frac{d}{dt} m_a(t) = -\\int_\\Omega c(z) \\rho_t(z) dz + \\lambda_{\\text{rev}} \\big( 1 - m_a(t) \\big).\n2590: $$\n2591: \n2592: Using $\\int c(z) \\rho_t(z) dz \\leq c_{\\max} m_a(t)$, we obtain the comparison inequality\n2593: \n2594: $$\n2595: \\frac{d}{dt} m_a(t) \\geq - (c_{\\max} + \\lambda_{\\text{rev}}) m_a(t) + \\lambda_{\\text{rev}}.\n2596: $$\n2597: \n2598: Solving gives the explicit lower envelope\n2599: \n2600: $$\n2601: m_{\\text{floor}}(t)\n2602: = m_\\infty - \\big(m_\\infty - m_0\\big) e^{-(c_{\\max} + \\lambda_{\\text{rev}}) t},\n2603: \\qquad\n2604: m_\\infty = \\frac{\\lambda_{\\text{rev}}}{c_{\\max} + \\lambda_{\\text{rev}}} > 0.\n2605: $$\n2606: \n2607: Hence $m_a(t) \\geq m_{\\text{floor}}(t)$ for all $t \\geq 0$. Choosing the equilibration time $t_{\\text{eq}} = O(\\kappa_{\\text{QSD}}^{-1} \\log N)$, we set\n2608: \n2609: $$\n2610: c_{\\text{early}} := \\frac{1}{2} \\min_{0 \\leq s \\leq t_{\\text{eq}}} m_{\\text{floor}}(s) > 0.\n2611: $$\n2612: \n2613: The propagation-of-chaos estimate proved in Section 4.5 (Proposition {prf:ref}`prop-poc-mass`) states that, for any $\\epsilon > 0$,\n2614: \n2615: $$\n2616: \\mathbb{P}\\left( \\sup_{0 \\leq s \\leq t_{\\text{eq}}} \\left| \\frac{k_s}{N} - m_a(s) \\right| > \\epsilon \\right) \\leq C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N \\epsilon^2}.\n2617: $$\n2618: \n2619: Taking $\\epsilon = c_{\\text{early}}$ yields the early-time event\n2620: \n2621: $$\n2622: \\mathbb{P}\\left( \\inf_{0 \\leq s \\leq t_{\\text{eq}}} \\frac{k_s}{N} \\geq c_{\\text{early}} \\right) \\geq 1 - C_{\\text{pc}} e^{-\\beta_{\\text{pc}} N c_{\\text{early}}^2}.\n2623: $$\n2624: \n2625: This establishes the desired floor on $[0, t_{\\text{eq}}]$.\n2626: \n2627: **Step 1: Spectral gap for configuration observables (removing the Markov assumption on $k_t$)**  \n2628: The $N$-particle process $Z_t = (z_t^{(1)}, \\ldots, z_t^{(N)})$ is geometrically ergodic with spectral gap $\\kappa_{\\text{full}} > 0$ in $L^2(\\Pi_{\\text{QSD}}^{(N)})$ (Theorem 4.5 of `06_convergence.md`). For any observable $F : \\Omega^N \\to \\mathbb{R}$,\n2629: \n2630: $$\n2631: \\text{Var}_{\\Pi_{\\text{QSD}}^{(N)}}(F) \\leq \\frac{1}{\\kappa_{\\text{full}}} \\langle -\\mathcal{L}^{(N)} F, F \\rangle.\n2632: $$\n2633: \n2634: We apply this to $F(Z) = k(Z)/N = N^{-1} \\sum_{i=1}^N \\mathbf{1}_{\\{\\text{walker } i \\text{ alive}\\}}$. Changing a single coordinate alters $F$ by at most $1/N$, so $F$ is $1/N$-Lipschitz with respect to the Hamming metric. By the Herbst argument for Markov semigroups with spectral gap (see, e.g., Joulin & Ollivier 2010, Theorem 5.1), $F$ satisfies\n2635: \n2636: $$\n2637: \\Pi_{\\text{QSD}}^{(N)}\\!\\left( \\left| \\frac{k}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n2638: \\leq 2 \\exp\\!\\left( - \\frac{\\kappa_{\\text{full}} N^2 r^2}{2} \\right)\n2639: \\leq 2 \\exp\\!\\left( - \\beta_{\\text{gap}} N r^2 \\right),\n2640: $$\n2641: \n2642: where we set $\\beta_{\\text{gap}} := \\kappa_{\\text{full}} / 2$ (the second inequality uses $N^2 \\geq N$ so the exponent now scales linearly in $N$).\n2643: \n2644: This argument works directly on the full configuration process $Z_t$; no Markov property for the projected count $k_t$ is required, thereby correcting the earlier (invalid) reduction to a standalone birth-death chain.\n2645: \n2646: **Step 2: Finite-time concentration after equilibration**  \n2647: Let $\\mathcal{L}_t$ be the law of $Z_t$ starting from any initial configuration with alive mass at least $c_{\\text{early}}$. By Theorem 4.5 of `06_convergence.md`,\n2648: \n2649: $$\n2650: \\|\\mathcal{L}_t - \\Pi_{\\text{QSD}}^{(N)}\\|_{\\text{TV}}\n2651: \\leq C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})} \\quad \\text{for } t \\geq t_{\\text{eq}}.\n2652: $$\n2653: \n2654: Therefore, for $t \\geq t_{\\text{eq}}$ and any $r > 0$,\n2655: \n2656: $$\n2657: \\mathbb{P}\\left( \\left| \\frac{k_t}{N} - m_{\\text{eq}} \\right| \\geq r \\right)\n2658: \\leq 2 e^{-\\beta_{\\text{gap}} N r^2} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n2659: $$\n2660: \n2661: Selecting $r = m_{\\text{eq}}/2$ yields\n2662: \n2663: $$\n2664: \\mathbb{P}\\left( \\frac{k_t}{N} \\leq \\frac{m_{\\text{eq}}}{2} \\right)\n2665: \\leq 2 e^{-\\beta_{\\text{gap}} N m_{\\text{eq}}^2 / 4} + C_{\\text{mix}} e^{-\\kappa_{\\text{full}} (t - t_{\\text{eq}})}.\n2666: $$\n2667: \n2668: **Step 3: Survival conditioning**  \n2669: The survival estimate of Theorem {prf:ref}`thm-exponential-survival` gives\n2670: \n2671: $$\n2672: \\mathbb{P}(\\tau_\\dagger \\leq t) \\leq t e^{-C_{\\text{surv}} N}.\n2673: $$\n2674: \n2675: Intersecting the complementary survival event with the concentration events from Steps 0-2 shows that, for all $t \\geq 0$,\n2676: \n2677: $$\n2678: \\mathbb{P}\\left( \\frac{k_t}{N} \\geq \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right) \\right)\n2679: \\geq 1 - C (1+t) e^{-\\delta N},\n2680: $$\n2681: \n2682: with $\\delta = \\min(\\beta_{\\text{pc}} c_{\\text{early}}^2, \\beta_{\\text{gap}} m_{\\text{eq}}^2/4, C_{\\text{surv}})$.\n2683: \n2684: Setting\n2685: \n2686: $$\n2687: c_{\\text{mass}} := \\min\\left( c_{\\text{early}}, \\frac{m_{\\text{eq}}}{2} \\right)\n2688: $$\n2689: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-linearized-spectral-gap",
      "title": "Exponential Decay in L¹ for Linearized Dynamics",
      "start_line": 3033,
      "end_line": 3068,
      "header_lines": [
        3034
      ],
      "content_start": 3036,
      "content_end": 3067,
      "content": "3036: :label: lem-linearized-spectral-gap\n3037: \n3038: The linearized operator $\\mathbb{L}^*$ around $\\pi_{\\text{QSD}}$ has a **spectral gap** in $L^2(\\pi_{\\text{QSD}})$:\n3039: \n3040: $$\n3041: \\mathbb{L}^* = -\\kappa_{\\text{lin}} + \\text{compact}\n3042: \n3043: $$\n3044: \n3045: where $\\kappa_{\\text{lin}} > 0$ is the gap. For any perturbation $\\eta_0$ with $\\|\\eta_0\\|_{L^1} \\leq \\delta$ sufficiently small, the linearized evolution satisfies:\n3046: \n3047: $$\n3048: \\|\\eta_t\\|_{L^1} \\leq \\|\\eta_0\\|_{L^1} e^{-\\kappa_{\\text{lin}} t / 2}\n3049: \n3050: $$\n3051: \n3052: for all $t \\geq 0$, provided $\\delta < \\delta_0$ for some threshold $\\delta_0$ determined by the nonlinearity $C_{\\text{nonlin}}$.\n3053: \n3054: **Proof Sketch**:\n3055: \n3056: This follows from standard perturbation theory for nonlinear parabolic equations:\n3057: \n3058: 1. **Spectral Gap**: The operator $\\mathbb{L}^*$ is the linearization of a hypoelliptic kinetic operator with compact perturbations (cloning, killing, revival). By the results in `06_convergence.md` (geometric ergodicity with rate $\\kappa_{\\text{QSD}}$), the linearized operator has a spectral gap $\\kappa_{\\text{lin}} \\approx \\kappa_{\\text{QSD}}$.\n3059: \n3060: 2. **Nonlinear Stability**: For the nonlinear equation $\\partial_t \\eta = \\mathbb{L}^* \\eta + \\mathcal{N}[\\eta]$, we use a Grönwall-type argument. The $L^1$ norm evolves as:\n3061: \n3062: $$\n3063: \\frac{d}{dt} \\|\\eta_t\\|_{L^1} \\leq -\\kappa_{\\text{lin}} \\|\\eta_t\\|_{L^1} + C_{\\text{nonlin}} \\|\\eta_t\\|_{L^1}^2\n3064: \n3065: $$\n3066: \n3067: For $\\|\\eta_0\\|_{L^1} \\leq \\delta_0 := \\kappa_{\\text{lin}} / (2 C_{\\text{nonlin}})$, the linear term dominates and we obtain exponential decay with rate $\\kappa_{\\text{lin}} / 2$.",
      "metadata": {
        "label": "lem-linearized-spectral-gap"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "3033: **Step 2B: Spectral Gap of the Linearized Operator**\n3034: \n3035: :::{prf:lemma} Exponential Decay in L¹ for Linearized Dynamics\n3036: :label: lem-linearized-spectral-gap\n3037: \n3038: The linearized operator $\\mathbb{L}^*$ around $\\pi_{\\text{QSD}}$ has a **spectral gap** in $L^2(\\pi_{\\text{QSD}})$:\n3039: \n3040: $$\n3041: \\mathbb{L}^* = -\\kappa_{\\text{lin}} + \\text{compact}\n3042: \n3043: $$\n3044: \n3045: where $\\kappa_{\\text{lin}} > 0$ is the gap. For any perturbation $\\eta_0$ with $\\|\\eta_0\\|_{L^1} \\leq \\delta$ sufficiently small, the linearized evolution satisfies:\n3046: \n3047: $$\n3048: \\|\\eta_t\\|_{L^1} \\leq \\|\\eta_0\\|_{L^1} e^{-\\kappa_{\\text{lin}} t / 2}\n3049: \n3050: $$\n3051: \n3052: for all $t \\geq 0$, provided $\\delta < \\delta_0$ for some threshold $\\delta_0$ determined by the nonlinearity $C_{\\text{nonlin}}$.\n3053: \n3054: **Proof Sketch**:\n3055: \n3056: This follows from standard perturbation theory for nonlinear parabolic equations:\n3057: \n3058: 1. **Spectral Gap**: The operator $\\mathbb{L}^*$ is the linearization of a hypoelliptic kinetic operator with compact perturbations (cloning, killing, revival). By the results in `06_convergence.md` (geometric ergodicity with rate $\\kappa_{\\text{QSD}}$), the linearized operator has a spectral gap $\\kappa_{\\text{lin}} \\approx \\kappa_{\\text{QSD}}$.\n3059: \n3060: 2. **Nonlinear Stability**: For the nonlinear equation $\\partial_t \\eta = \\mathbb{L}^* \\eta + \\mathcal{N}[\\eta]$, we use a Grönwall-type argument. The $L^1$ norm evolves as:\n3061: \n3062: $$\n3063: \\frac{d}{dt} \\|\\eta_t\\|_{L^1} \\leq -\\kappa_{\\text{lin}} \\|\\eta_t\\|_{L^1} + C_{\\text{nonlin}} \\|\\eta_t\\|_{L^1}^2\n3064: \n3065: $$\n3066: \n3067: For $\\|\\eta_0\\|_{L^1} \\leq \\delta_0 := \\kappa_{\\text{lin}} / (2 C_{\\text{nonlin}})$, the linear term dominates and we obtain exponential decay with rate $\\kappa_{\\text{lin}} / 2$.\n3068: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-hypoellipticity-full-linearized",
      "title": "Hypoellipticity Preservation via Bootstrap Argument",
      "start_line": 3074,
      "end_line": 3158,
      "header_lines": [
        3075
      ],
      "content_start": 3077,
      "content_end": 3157,
      "content": "3077: :label: lem-hypoellipticity-full-linearized\n3078: \n3079: The linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` is **hypoelliptic** in the sense that:\n3080: \n3081: If $\\partial_t \\eta = \\mathbb{L}^* \\eta$ with initial condition $\\eta_0 \\in L^1(\\Omega)$, then for any $t > 0$, the solution $\\eta_t \\in C^\\infty(\\Omega)$.\n3082: \n3083: **Proof**:\n3084: \n3085: The proof uses a **bootstrap argument** that separates the \"regularizing engine\" (kinetic operator) from the \"source terms\" (nonlocal operators).\n3086: \n3087: **Step 1: Isolate the Hypoelliptic Engine**\n3088: \n3089: Rearrange the evolution equation:\n3090: \n3091: $$\n3092: \\frac{\\partial \\eta}{\\partial t} - \\mathcal{L}_{\\text{kin}}^* \\eta = f[\\eta]\n3093: \n3094: $$\n3095: \n3096: where the \"source term\" is:\n3097: \n3098: $$\n3099: f[\\eta] := \\mathbb{L}_{\\text{clone}}^* \\eta - c(z) \\eta + \\mathbb{L}_{\\text{revival}}^* \\eta\n3100: \n3101: $$\n3102: \n3103: Define the hypoelliptic operator $\\mathbb{L}_{\\text{hypo}} := \\partial_t - \\mathcal{L}_{\\text{kin}}^*$. By Lemma {prf:ref}`lem-hormander-bracket` (Section 2.2), this operator satisfies Hörmander's bracket condition, making it hypoelliptic.\n3104: \n3105: **Step 2: Hörmander's Theorem**\n3106: \n3107: By Hörmander's theorem (Hörmander 1967, *Acta Math.* 119:147-171), if $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ and the source term $f \\in C^k(\\Omega)$ for some $k \\geq 0$, then the solution $\\eta$ is automatically smoother: $\\eta \\in C^{k+\\alpha}(\\Omega)$ for some $\\alpha > 0$ (and in fact, $\\eta \\in C^\\infty$ if $f \\in C^\\infty$).\n3108: \n3109: **Step 3: Regularity of the Source Term**\n3110: \n3111: The key observation is that **if $\\eta \\in C^k$, then $f[\\eta] \\in C^k$**. We verify each component:\n3112: \n3113: **Cloning operator**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator is:\n3114: \n3115: $$\n3116: \\mathbb{L}_{\\text{clone}}^* \\eta = \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n3117: \n3118: $$\n3119: \n3120: This is a convolution with the Gaussian kernel $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x - x') \\delta(v - v')$ plus multiplication by the fitness functional $V[\\pi]$ and its derivative $V'[\\pi]$.\n3121: \n3122: - The Gaussian kernel $G_{\\sigma_x}$ is $C^\\infty$ (analytic).\n3123: - The fitness functional $V[\\pi]$ depends on the potential $U$ and the virtual reward mechanism. From the Fragile framework (`02_euclidean_gas.md`, Axiom of Smooth Potential), the potential $U \\in C^\\infty(\\mathcal{X})$. The virtual reward is a functional of integrals of $\\pi$, which are smooth.\n3124: - **Conclusion**: Convolution with a $C^\\infty$ kernel preserves regularity. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{clone}}^* \\eta \\in C^k$.\n3125: \n3126: **Killing term**: $-c(z) \\eta$ where $c(z) \\geq 0$ is the killing rate. From the framework, $c(z)$ is smooth (defined by the domain boundaries with smooth indicator functions). If $\\eta \\in C^k$, then $c(z) \\eta \\in C^k$.\n3127: \n3128: **Revival term**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized revival operator is:\n3129: \n3130: $$\n3131: \\mathbb{L}_{\\text{revival}}^* \\eta = \\lambda_{\\text{rev}} \\frac{m_d}{m_{\\text{eq}}} \\left( f_{\\text{safe}} \\eta - \\frac{f_{\\text{safe}}}{m_{\\text{eq}}} \\int \\eta \\, dz \\right)\n3132: \n3133: $$\n3134: \n3135: where $f_{\\text{safe}}$ is the revival distribution (smooth by framework assumptions). The integral $\\int \\eta \\, dz$ is a scalar. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{revival}}^* \\eta \\in C^k$.\n3136: \n3137: **Overall**: All components of $f[\\eta]$ preserve regularity, so $\\eta \\in C^k \\Rightarrow f[\\eta] \\in C^k$.\n3138: \n3139: **Step 4: Bootstrap Loop**\n3140: \n3141: 1. **Initial regularity**: From basic parabolic theory, for short time $t > 0$, the solution $\\eta_t$ is at least continuous: $\\eta_t \\in C^0(\\Omega)$.\n3142: \n3143: 2. **Bootstrap iteration**: Assume $\\eta \\in C^k$ for some $k \\geq 0$. Then:\n3144:    - By Step 3, $f[\\eta] \\in C^k$\n3145:    - By Hörmander's theorem (Step 2), $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ implies $\\eta \\in C^{k+\\alpha}$\n3146:    - Therefore, $\\eta$ is strictly smoother than we assumed\n3147: \n3148: 3. **Infinite iteration**: Repeating this argument indefinitely, we conclude $\\eta \\in C^\\infty(\\Omega)$ for all $t > 0$.\n3149: \n3150: **Step 5: Nash-Aronson Applicability**\n3151: \n3152: Since the operator $\\mathbb{L}^*$ is hypoelliptic (produces $C^\\infty$ solutions), the standard theory of hypoelliptic parabolic equations applies. In particular:\n3153: \n3154: - The Nash inequality holds for $\\mathbb{L}^*$ (Hérau & Nier 2004, Theorem 2.1, extended to operators with smooth source terms)\n3155: - The ultracontractivity estimate (Nash-Aronson) follows from the Nash inequality via standard bootstrapping arguments (Aronson 1968; Carlen & Loss 1993)\n3156: \n3157: **Conclusion**: The full linearized operator $\\mathbb{L}^*$ is hypoelliptic, and the Nash-Aronson $L^1 \\to L^\\infty$ estimate applies to its semigroup.",
      "metadata": {
        "label": "lem-hypoellipticity-full-linearized"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "3074: Before we can apply parabolic regularity estimates (Nash-Aronson), we must establish that the full linearized operator $\\mathbb{L}^*$ (including nonlocal cloning and revival terms) preserves the hypoelliptic structure of the kinetic operator.\n3075: \n3076: :::{prf:lemma} Hypoellipticity Preservation via Bootstrap Argument\n3077: :label: lem-hypoellipticity-full-linearized\n3078: \n3079: The linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` is **hypoelliptic** in the sense that:\n3080: \n3081: If $\\partial_t \\eta = \\mathbb{L}^* \\eta$ with initial condition $\\eta_0 \\in L^1(\\Omega)$, then for any $t > 0$, the solution $\\eta_t \\in C^\\infty(\\Omega)$.\n3082: \n3083: **Proof**:\n3084: \n3085: The proof uses a **bootstrap argument** that separates the \"regularizing engine\" (kinetic operator) from the \"source terms\" (nonlocal operators).\n3086: \n3087: **Step 1: Isolate the Hypoelliptic Engine**\n3088: \n3089: Rearrange the evolution equation:\n3090: \n3091: $$\n3092: \\frac{\\partial \\eta}{\\partial t} - \\mathcal{L}_{\\text{kin}}^* \\eta = f[\\eta]\n3093: \n3094: $$\n3095: \n3096: where the \"source term\" is:\n3097: \n3098: $$\n3099: f[\\eta] := \\mathbb{L}_{\\text{clone}}^* \\eta - c(z) \\eta + \\mathbb{L}_{\\text{revival}}^* \\eta\n3100: \n3101: $$\n3102: \n3103: Define the hypoelliptic operator $\\mathbb{L}_{\\text{hypo}} := \\partial_t - \\mathcal{L}_{\\text{kin}}^*$. By Lemma {prf:ref}`lem-hormander-bracket` (Section 2.2), this operator satisfies Hörmander's bracket condition, making it hypoelliptic.\n3104: \n3105: **Step 2: Hörmander's Theorem**\n3106: \n3107: By Hörmander's theorem (Hörmander 1967, *Acta Math.* 119:147-171), if $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ and the source term $f \\in C^k(\\Omega)$ for some $k \\geq 0$, then the solution $\\eta$ is automatically smoother: $\\eta \\in C^{k+\\alpha}(\\Omega)$ for some $\\alpha > 0$ (and in fact, $\\eta \\in C^\\infty$ if $f \\in C^\\infty$).\n3108: \n3109: **Step 3: Regularity of the Source Term**\n3110: \n3111: The key observation is that **if $\\eta \\in C^k$, then $f[\\eta] \\in C^k$**. We verify each component:\n3112: \n3113: **Cloning operator**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator is:\n3114: \n3115: $$\n3116: \\mathbb{L}_{\\text{clone}}^* \\eta = \\int K_{\\text{clone}}(z, z') \\left[ V[\\pi](z, z') \\eta(z') + V'[\\pi](z, z') \\cdot \\eta \\cdot \\pi(z') - \\eta(z) V[\\pi](z, z') \\right] dz'\n3117: \n3118: $$\n3119: \n3120: This is a convolution with the Gaussian kernel $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x - x') \\delta(v - v')$ plus multiplication by the fitness functional $V[\\pi]$ and its derivative $V'[\\pi]$.\n3121: \n3122: - The Gaussian kernel $G_{\\sigma_x}$ is $C^\\infty$ (analytic).\n3123: - The fitness functional $V[\\pi]$ depends on the potential $U$ and the virtual reward mechanism. From the Fragile framework (`02_euclidean_gas.md`, Axiom of Smooth Potential), the potential $U \\in C^\\infty(\\mathcal{X})$. The virtual reward is a functional of integrals of $\\pi$, which are smooth.\n3124: - **Conclusion**: Convolution with a $C^\\infty$ kernel preserves regularity. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{clone}}^* \\eta \\in C^k$.\n3125: \n3126: **Killing term**: $-c(z) \\eta$ where $c(z) \\geq 0$ is the killing rate. From the framework, $c(z)$ is smooth (defined by the domain boundaries with smooth indicator functions). If $\\eta \\in C^k$, then $c(z) \\eta \\in C^k$.\n3127: \n3128: **Revival term**: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized revival operator is:\n3129: \n3130: $$\n3131: \\mathbb{L}_{\\text{revival}}^* \\eta = \\lambda_{\\text{rev}} \\frac{m_d}{m_{\\text{eq}}} \\left( f_{\\text{safe}} \\eta - \\frac{f_{\\text{safe}}}{m_{\\text{eq}}} \\int \\eta \\, dz \\right)\n3132: \n3133: $$\n3134: \n3135: where $f_{\\text{safe}}$ is the revival distribution (smooth by framework assumptions). The integral $\\int \\eta \\, dz$ is a scalar. If $\\eta \\in C^k$, then $\\mathbb{L}_{\\text{revival}}^* \\eta \\in C^k$.\n3136: \n3137: **Overall**: All components of $f[\\eta]$ preserve regularity, so $\\eta \\in C^k \\Rightarrow f[\\eta] \\in C^k$.\n3138: \n3139: **Step 4: Bootstrap Loop**\n3140: \n3141: 1. **Initial regularity**: From basic parabolic theory, for short time $t > 0$, the solution $\\eta_t$ is at least continuous: $\\eta_t \\in C^0(\\Omega)$.\n3142: \n3143: 2. **Bootstrap iteration**: Assume $\\eta \\in C^k$ for some $k \\geq 0$. Then:\n3144:    - By Step 3, $f[\\eta] \\in C^k$\n3145:    - By Hörmander's theorem (Step 2), $\\mathbb{L}_{\\text{hypo}}(\\eta) = f$ implies $\\eta \\in C^{k+\\alpha}$\n3146:    - Therefore, $\\eta$ is strictly smoother than we assumed\n3147: \n3148: 3. **Infinite iteration**: Repeating this argument indefinitely, we conclude $\\eta \\in C^\\infty(\\Omega)$ for all $t > 0$.\n3149: \n3150: **Step 5: Nash-Aronson Applicability**\n3151: \n3152: Since the operator $\\mathbb{L}^*$ is hypoelliptic (produces $C^\\infty$ solutions), the standard theory of hypoelliptic parabolic equations applies. In particular:\n3153: \n3154: - The Nash inequality holds for $\\mathbb{L}^*$ (Hérau & Nier 2004, Theorem 2.1, extended to operators with smooth source terms)\n3155: - The ultracontractivity estimate (Nash-Aronson) follows from the Nash inequality via standard bootstrapping arguments (Aronson 1968; Carlen & Loss 1993)\n3156: \n3157: **Conclusion**: The full linearized operator $\\mathbb{L}^*$ is hypoelliptic, and the Nash-Aronson $L^1 \\to L^\\infty$ estimate applies to its semigroup.\n3158: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-relative-boundedness-nonlocal",
      "title": "Relative Boundedness of Nonlocal Operators",
      "start_line": 3169,
      "end_line": 3274,
      "header_lines": [
        3170
      ],
      "content_start": 3172,
      "content_end": 3273,
      "content": "3172: :label: lem-relative-boundedness-nonlocal\n3173: \n3174: The linearized nonlocal operators $\\mathbb{L}_{\\text{clone}}^*$ and $\\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` are **relatively bounded** with respect to the kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ in $L^2(\\pi_{\\text{QSD}}^{-1})$:\n3175: \n3176: $$\n3177: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2} \\leq C_1 \\|g\\|_{L^2}\n3178: $$\n3179: \n3180: $$\n3181: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq C_2 \\|g\\|_{L^2}\n3182: $$\n3183: \n3184: with constants $C_1, C_2 < \\kappa_{\\text{kin}} / 2$ where $\\kappa_{\\text{kin}} > 0$ is the kinetic spectral gap.\n3185: \n3186: **Consequence**: The full linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ retains a spectral gap:\n3187: \n3188: $$\n3189: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n3190: $$\n3191: \n3192: and the associated Dirichlet form $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle_{\\pi_{\\text{QSD}}^{-1}}$ is coercive:\n3193: \n3194: $$\n3195: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2\n3196: \n3197: $$\n3198: \n3199: **Proof**:\n3200: \n3201: **Part 1: Cloning Operator Bound**\n3202: \n3203: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator has the form:\n3204: \n3205: $$\n3206: \\mathbb{L}_{\\text{clone}}^* g(z) = \\int_\\Omega K_{\\text{clone}}(z, z') W(z, z') [g(z') - g(z)] dz'\n3207: $$\n3208: \n3209: where $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x-x') \\delta(v-v')$ is the Gaussian position kernel and $W(z, z')$ is a bounded fitness-dependent weight with $\\|W\\|_\\infty \\leq V_{\\max}$.\n3210: \n3211: By the **Schur test** for integral operators:\n3212: \n3213: $$\n3214: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2}^2 = \\int_\\Omega \\left| \\int_\\Omega K(z,z') W(z,z') [g(z') - g(z)] dz' \\right|^2 dz\n3215: $$\n3216: \n3217: Using Cauchy-Schwarz and the fact that $K$ is a probability kernel ($\\int K(z, z') dz' = 1$):\n3218: \n3219: $$\n3220: \\leq 2 V_{\\max}^2 \\left[ \\int_\\Omega |g(z')|^2 dz' + \\int_\\Omega |g(z)|^2 dz \\right] = 4 V_{\\max}^2 \\|g\\|_{L^2}^2\n3221: $$\n3222: \n3223: Therefore, $C_1 = 2 V_{\\max}$.\n3224: \n3225: **Part 2: Revival Operator Bound**\n3226: \n3227: The linearized revival operator (from Lemma {prf:ref}`lem-linearization-qsd`) has the form:\n3228: \n3229: $$\n3230: \\mathbb{L}_{\\text{revival}}^* g = \\lambda_{\\text{rev}} \\left[ \\frac{m_d}{m_{\\text{eq}}} - \\frac{\\langle g, 1 \\rangle}{m_{\\text{eq}}} \\right] f_{\\text{safe}}\n3231: $$\n3232: \n3233: where $f_{\\text{safe}}$ is the safe-region density with $\\|f_{\\text{safe}}\\|_{L^\\infty} \\leq C_{\\text{safe}}$ and $m_d, m_{\\text{eq}}$ are the dead and equilibrium masses.\n3234: \n3235: The $L^2$ norm is:\n3236: \n3237: $$\n3238: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq \\lambda_{\\text{rev}} \\left( \\frac{\\|c\\|_\\infty m_{\\text{eq}}}{m_{\\text{eq}}} + \\frac{|\\langle g, 1 \\rangle|}{m_{\\text{eq}}} \\right) \\|f_{\\text{safe}}\\|_{L^2}\n3239: $$\n3240: \n3241: Using Cauchy-Schwarz for the inner product: $|\\langle g, 1 \\rangle| \\leq \\|g\\|_{L^2} \\cdot \\|1\\|_{L^2}$:\n3242: \n3243: $$\n3244: \\leq \\lambda_{\\text{rev}} C_{\\text{safe}} \\left( \\|c\\|_\\infty + \\frac{1}{m_{\\text{eq}}} \\|1\\|_{L^2} \\right) \\|g\\|_{L^2}\n3245: $$\n3246: \n3247: Therefore, $C_2 = \\lambda_{\\text{rev}} C_{\\text{safe}} (\\|c\\|_\\infty + \\|1\\|_{L^2} / m_{\\text{eq}})$.\n3248: \n3249: **Part 3: Kato-Rellich Perturbation Theory**\n3250: \n3251: From `06_convergence.md`, the pure kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ has spectral gap $\\kappa_{\\text{kin}} > 0$. By **Kato-Rellich perturbation theory** for sectorial operators (Kato 1995, *Perturbation Theory for Linear Operators*, Springer, Theorem IV.3.17):\n3252: \n3253: If the perturbation operators $\\mathbb{L}_{\\text{clone}}^*$, $\\mathbb{L}_{\\text{revival}}^*$, and $-c(z)$ satisfy $\\|B g\\|_{L^2} \\leq \\beta \\|g\\|_{L^2}$ with $\\beta < \\kappa_{\\text{kin}}$, then the perturbed operator retains a spectral gap:\n3254: \n3255: $$\n3256: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n3257: $$\n3258: \n3259: **Part 4: Dirichlet Form Coercivity**\n3260: \n3261: The Dirichlet form is:\n3262: \n3263: $$\n3264: \\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle = \\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle + \\text{perturbation terms}\n3265: $$\n3266: \n3267: The kinetic part satisfies $\\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle \\geq \\kappa_{\\text{kin}} \\|g\\|_{L^2}^2$ (by spectral gap). The perturbation terms contribute at most $(C_1 + C_2 + \\|c\\|_\\infty) \\|g\\|_{L^2}^2$ in magnitude.\n3268: \n3269: Therefore:\n3270: \n3271: $$\n3272: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2 > 0\n3273: $$",
      "metadata": {
        "label": "lem-relative-boundedness-nonlocal"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "3169: Before applying Nash-Aronson theory, we must verify that the nonlocal cloning and revival operators do not destroy the coercive Dirichlet form structure of the kinetic operator.\n3170: \n3171: :::{prf:lemma} Relative Boundedness of Nonlocal Operators\n3172: :label: lem-relative-boundedness-nonlocal\n3173: \n3174: The linearized nonlocal operators $\\mathbb{L}_{\\text{clone}}^*$ and $\\mathbb{L}_{\\text{revival}}^*$ from Lemma {prf:ref}`lem-linearization-qsd` are **relatively bounded** with respect to the kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ in $L^2(\\pi_{\\text{QSD}}^{-1})$:\n3175: \n3176: $$\n3177: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2} \\leq C_1 \\|g\\|_{L^2}\n3178: $$\n3179: \n3180: $$\n3181: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq C_2 \\|g\\|_{L^2}\n3182: $$\n3183: \n3184: with constants $C_1, C_2 < \\kappa_{\\text{kin}} / 2$ where $\\kappa_{\\text{kin}} > 0$ is the kinetic spectral gap.\n3185: \n3186: **Consequence**: The full linearized operator $\\mathbb{L}^* = \\mathcal{L}_{\\text{kin}}^* + \\mathbb{L}_{\\text{clone}}^* - c(z) + \\mathbb{L}_{\\text{revival}}^*$ retains a spectral gap:\n3187: \n3188: $$\n3189: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n3190: $$\n3191: \n3192: and the associated Dirichlet form $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle_{\\pi_{\\text{QSD}}^{-1}}$ is coercive:\n3193: \n3194: $$\n3195: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2\n3196: \n3197: $$\n3198: \n3199: **Proof**:\n3200: \n3201: **Part 1: Cloning Operator Bound**\n3202: \n3203: From Lemma {prf:ref}`lem-linearization-qsd`, the linearized cloning operator has the form:\n3204: \n3205: $$\n3206: \\mathbb{L}_{\\text{clone}}^* g(z) = \\int_\\Omega K_{\\text{clone}}(z, z') W(z, z') [g(z') - g(z)] dz'\n3207: $$\n3208: \n3209: where $K_{\\text{clone}}(z, z') = G_{\\sigma_x}(x-x') \\delta(v-v')$ is the Gaussian position kernel and $W(z, z')$ is a bounded fitness-dependent weight with $\\|W\\|_\\infty \\leq V_{\\max}$.\n3210: \n3211: By the **Schur test** for integral operators:\n3212: \n3213: $$\n3214: \\|\\mathbb{L}_{\\text{clone}}^* g\\|_{L^2}^2 = \\int_\\Omega \\left| \\int_\\Omega K(z,z') W(z,z') [g(z') - g(z)] dz' \\right|^2 dz\n3215: $$\n3216: \n3217: Using Cauchy-Schwarz and the fact that $K$ is a probability kernel ($\\int K(z, z') dz' = 1$):\n3218: \n3219: $$\n3220: \\leq 2 V_{\\max}^2 \\left[ \\int_\\Omega |g(z')|^2 dz' + \\int_\\Omega |g(z)|^2 dz \\right] = 4 V_{\\max}^2 \\|g\\|_{L^2}^2\n3221: $$\n3222: \n3223: Therefore, $C_1 = 2 V_{\\max}$.\n3224: \n3225: **Part 2: Revival Operator Bound**\n3226: \n3227: The linearized revival operator (from Lemma {prf:ref}`lem-linearization-qsd`) has the form:\n3228: \n3229: $$\n3230: \\mathbb{L}_{\\text{revival}}^* g = \\lambda_{\\text{rev}} \\left[ \\frac{m_d}{m_{\\text{eq}}} - \\frac{\\langle g, 1 \\rangle}{m_{\\text{eq}}} \\right] f_{\\text{safe}}\n3231: $$\n3232: \n3233: where $f_{\\text{safe}}$ is the safe-region density with $\\|f_{\\text{safe}}\\|_{L^\\infty} \\leq C_{\\text{safe}}$ and $m_d, m_{\\text{eq}}$ are the dead and equilibrium masses.\n3234: \n3235: The $L^2$ norm is:\n3236: \n3237: $$\n3238: \\|\\mathbb{L}_{\\text{revival}}^* g\\|_{L^2} \\leq \\lambda_{\\text{rev}} \\left( \\frac{\\|c\\|_\\infty m_{\\text{eq}}}{m_{\\text{eq}}} + \\frac{|\\langle g, 1 \\rangle|}{m_{\\text{eq}}} \\right) \\|f_{\\text{safe}}\\|_{L^2}\n3239: $$\n3240: \n3241: Using Cauchy-Schwarz for the inner product: $|\\langle g, 1 \\rangle| \\leq \\|g\\|_{L^2} \\cdot \\|1\\|_{L^2}$:\n3242: \n3243: $$\n3244: \\leq \\lambda_{\\text{rev}} C_{\\text{safe}} \\left( \\|c\\|_\\infty + \\frac{1}{m_{\\text{eq}}} \\|1\\|_{L^2} \\right) \\|g\\|_{L^2}\n3245: $$\n3246: \n3247: Therefore, $C_2 = \\lambda_{\\text{rev}} C_{\\text{safe}} (\\|c\\|_\\infty + \\|1\\|_{L^2} / m_{\\text{eq}})$.\n3248: \n3249: **Part 3: Kato-Rellich Perturbation Theory**\n3250: \n3251: From `06_convergence.md`, the pure kinetic operator $\\mathcal{L}_{\\text{kin}}^*$ has spectral gap $\\kappa_{\\text{kin}} > 0$. By **Kato-Rellich perturbation theory** for sectorial operators (Kato 1995, *Perturbation Theory for Linear Operators*, Springer, Theorem IV.3.17):\n3252: \n3253: If the perturbation operators $\\mathbb{L}_{\\text{clone}}^*$, $\\mathbb{L}_{\\text{revival}}^*$, and $-c(z)$ satisfy $\\|B g\\|_{L^2} \\leq \\beta \\|g\\|_{L^2}$ with $\\beta < \\kappa_{\\text{kin}}$, then the perturbed operator retains a spectral gap:\n3254: \n3255: $$\n3256: \\kappa_{\\text{lin}} \\geq \\kappa_{\\text{kin}} - (C_1 + C_2 + \\|c\\|_\\infty) > 0\n3257: $$\n3258: \n3259: **Part 4: Dirichlet Form Coercivity**\n3260: \n3261: The Dirichlet form is:\n3262: \n3263: $$\n3264: \\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle = \\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle + \\text{perturbation terms}\n3265: $$\n3266: \n3267: The kinetic part satisfies $\\langle g, -\\mathcal{L}_{\\text{kin}}^* g \\rangle \\geq \\kappa_{\\text{kin}} \\|g\\|_{L^2}^2$ (by spectral gap). The perturbation terms contribute at most $(C_1 + C_2 + \\|c\\|_\\infty) \\|g\\|_{L^2}^2$ in magnitude.\n3268: \n3269: Therefore:\n3270: \n3271: $$\n3272: \\mathcal{E}(g) \\geq \\kappa_{\\text{lin}} \\|g\\|_{L^2}^2 > 0\n3273: $$\n3274: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    },
    {
      "directive_type": "lemma",
      "label": "lem-l1-to-linfty-near-qsd",
      "title": "Nash-Aronson Type L¹-to-L∞ Bound for Linearized Operator",
      "start_line": 3282,
      "end_line": 3346,
      "header_lines": [
        3283
      ],
      "content_start": 3285,
      "content_end": 3345,
      "content": "3285: :label: lem-l1-to-linfty-near-qsd\n3286: \n3287: For the linearized evolution $\\partial_t \\eta = \\mathbb{L}^* \\eta$ starting from $\\eta_0$ with $\\|\\eta_0\\|_{L^1} = m$ and $\\|\\eta_0\\|_{L^\\infty} \\leq M$, there exist constants $C_{\\text{Nash}}, \\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\sigma_x, R, d$) such that for any $t \\geq \\tau$ (one timestep):\n3288: \n3289: $$\n3290: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n3291: \n3292: $$\n3293: \n3294: **Interpretation**: The $L^\\infty$ norm of perturbations decays to a level controlled by the $L^1$ norm, with a heat-kernel-like rate $t^{-d/2}$.\n3295: \n3296: **Proof**:\n3297: \n3298: This is a classical result in parabolic regularity theory, adapted to the hypoelliptic kinetic setting.\n3299: \n3300: **Step 1: Nash Inequality for Kinetic Operators**\n3301: \n3302: From Hérau & Nier (2004, *Arch. Ration. Mech. Anal.* 171:151-218, Theorem 2.1), hypoelliptic kinetic operators satisfy a Nash-type inequality: for any smooth function $g$ with $\\|g\\|_{L^1} = m$:\n3303: \n3304: $$\n3305: \\|g\\|_{L^2}^{2 + 4/d} \\leq C_N \\left( \\mathcal{E}(g) \\|g\\|_{L^1}^{4/d} + \\|g\\|_{L^1}^{2 + 4/d} \\right)\n3306: \n3307: $$\n3308: \n3309: where $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle$ is the Dirichlet form (entropy production).\n3310: \n3311: **Step 2: L²-to-L∞ Bootstrapping**\n3312: \n3313: For parabolic equations, the Nash inequality implies ultracontractivity of the semigroup $e^{t \\mathbb{L}^*}$: there exists $C_U$ such that:\n3314: \n3315: $$\n3316: \\|e^{t \\mathbb{L}^*}\\|_{L^1 \\to L^\\infty} \\leq \\frac{C_U}{t^{d/2}}\n3317: \n3318: $$\n3319: \n3320: for $t \\geq \\tau$. This is the **Nash-Aronson estimate** (Aronson 1968, *Bull. Amer. Math. Soc.* 74:47-49).\n3321: \n3322: **Step 3: Semigroup Decomposition**\n3323: \n3324: For $\\eta_0$ with mixed $L^1$ and $L^\\infty$ bounds, we use the semigroup property:\n3325: \n3326: $$\n3327: \\eta_t = e^{t \\mathbb{L}^*} \\eta_0\n3328: \n3329: $$\n3330: \n3331: Decompose $\\eta_0 = \\eta_0^{\\text{small}} + \\eta_0^{\\text{large}}$ where $\\|\\eta_0^{\\text{small}}\\|_{L^\\infty}$ is small but $\\|\\eta_0^{\\text{small}}\\|_{L^1} = m$, and $\\|\\eta_0^{\\text{large}}\\|_{L^1}$ is small. Then:\n3332: \n3333: $$\n3334: \\|\\eta_t\\|_{L^\\infty} \\leq \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{small}}\\|_{L^\\infty} + \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{large}}\\|_{L^\\infty}\n3335: \n3336: $$\n3337: \n3338: The first term is bounded by the ultracontractivity estimate: $C_U m / t^{d/2}$. The second term decays exponentially by the spectral gap: $M e^{-\\alpha t}$.\n3339: \n3340: Combining these:\n3341: \n3342: $$\n3343: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n3344: \n3345: $$",
      "metadata": {
        "label": "lem-l1-to-linfty-near-qsd"
      },
      "section": "## 5. Rigorous Proof of Bounded Density Ratio",
      "raw_directive": "3282: This is the key technical lemma that upgrades weak ($L^1$) convergence to strong ($L^\\infty$) bounds.\n3283: \n3284: :::{prf:lemma} Nash-Aronson Type L¹-to-L∞ Bound for Linearized Operator\n3285: :label: lem-l1-to-linfty-near-qsd\n3286: \n3287: For the linearized evolution $\\partial_t \\eta = \\mathbb{L}^* \\eta$ starting from $\\eta_0$ with $\\|\\eta_0\\|_{L^1} = m$ and $\\|\\eta_0\\|_{L^\\infty} \\leq M$, there exist constants $C_{\\text{Nash}}, \\alpha > 0$ (depending on $\\gamma, \\sigma_v, \\sigma_x, R, d$) such that for any $t \\geq \\tau$ (one timestep):\n3288: \n3289: $$\n3290: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n3291: \n3292: $$\n3293: \n3294: **Interpretation**: The $L^\\infty$ norm of perturbations decays to a level controlled by the $L^1$ norm, with a heat-kernel-like rate $t^{-d/2}$.\n3295: \n3296: **Proof**:\n3297: \n3298: This is a classical result in parabolic regularity theory, adapted to the hypoelliptic kinetic setting.\n3299: \n3300: **Step 1: Nash Inequality for Kinetic Operators**\n3301: \n3302: From Hérau & Nier (2004, *Arch. Ration. Mech. Anal.* 171:151-218, Theorem 2.1), hypoelliptic kinetic operators satisfy a Nash-type inequality: for any smooth function $g$ with $\\|g\\|_{L^1} = m$:\n3303: \n3304: $$\n3305: \\|g\\|_{L^2}^{2 + 4/d} \\leq C_N \\left( \\mathcal{E}(g) \\|g\\|_{L^1}^{4/d} + \\|g\\|_{L^1}^{2 + 4/d} \\right)\n3306: \n3307: $$\n3308: \n3309: where $\\mathcal{E}(g) = \\langle g, -\\mathbb{L}^* g \\rangle$ is the Dirichlet form (entropy production).\n3310: \n3311: **Step 2: L²-to-L∞ Bootstrapping**\n3312: \n3313: For parabolic equations, the Nash inequality implies ultracontractivity of the semigroup $e^{t \\mathbb{L}^*}$: there exists $C_U$ such that:\n3314: \n3315: $$\n3316: \\|e^{t \\mathbb{L}^*}\\|_{L^1 \\to L^\\infty} \\leq \\frac{C_U}{t^{d/2}}\n3317: \n3318: $$\n3319: \n3320: for $t \\geq \\tau$. This is the **Nash-Aronson estimate** (Aronson 1968, *Bull. Amer. Math. Soc.* 74:47-49).\n3321: \n3322: **Step 3: Semigroup Decomposition**\n3323: \n3324: For $\\eta_0$ with mixed $L^1$ and $L^\\infty$ bounds, we use the semigroup property:\n3325: \n3326: $$\n3327: \\eta_t = e^{t \\mathbb{L}^*} \\eta_0\n3328: \n3329: $$\n3330: \n3331: Decompose $\\eta_0 = \\eta_0^{\\text{small}} + \\eta_0^{\\text{large}}$ where $\\|\\eta_0^{\\text{small}}\\|_{L^\\infty}$ is small but $\\|\\eta_0^{\\text{small}}\\|_{L^1} = m$, and $\\|\\eta_0^{\\text{large}}\\|_{L^1}$ is small. Then:\n3332: \n3333: $$\n3334: \\|\\eta_t\\|_{L^\\infty} \\leq \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{small}}\\|_{L^\\infty} + \\|e^{t \\mathbb{L}^*} \\eta_0^{\\text{large}}\\|_{L^\\infty}\n3335: \n3336: $$\n3337: \n3338: The first term is bounded by the ultracontractivity estimate: $C_U m / t^{d/2}$. The second term decays exponentially by the spectral gap: $M e^{-\\alpha t}$.\n3339: \n3340: Combining these:\n3341: \n3342: $$\n3343: \\|\\eta_t\\|_{L^\\infty} \\leq C_{\\text{Nash}} \\left( \\frac{m}{t^{d/2}} + M e^{-\\alpha t} \\right)\n3344: \n3345: $$\n3346: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_hk_convergence",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Rigorous Proof of Bounded Density Ratio"
      }
    }
  ]
}