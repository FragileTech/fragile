{
  "chapter_index": 6,
  "section_id": "## 6. Main Theorem: Exponential HK-Convergence of the Fragile Gas",
  "directive_count": 3,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-hk-convergence-main-assembly",
      "title": "Exponential HK-Convergence of the Fragile Gas",
      "start_line": 3805,
      "end_line": 3846,
      "header_lines": [
        3806
      ],
      "content_start": 3808,
      "content_end": 3845,
      "content": "3808: :label: thm-hk-convergence-main-assembly\n3809: \n3810: Let $\\mu_t$ denote the empirical measure of alive walkers at time $t$ under the Fragile Gas dynamics $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$, and let $\\pi_{\\text{QSD}}$ denote the quasi-stationary distribution.\n3811: \n3812: **Assumptions:**\n3813: \n3814: 1. **Mass Contraction ({prf:ref}`lem-mass-contraction-revival-death`)**: The birth-death balance satisfies the conditions of {prf:ref}`lem-mass-contraction-revival-death` with $\\kappa_{\\text{mass}} > 0$.\n3815: \n3816: 2. **Structural Variance Contraction ({prf:ref}`lem-structural-variance-contraction`)**: The Wasserstein contraction conditions of {prf:ref}`lem-structural-variance-contraction` hold with $\\lambda_{\\text{struct}} > 0$.\n3817: \n3818: 3. **Bounded Density Ratio (Theorem {prf:ref}`thm-uniform-density-bound-hk`)**: The density ratio is uniformly bounded:\n3819: \n3820: $$\n3821: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n3822: \n3823: $$\n3824: \n3825: The proof uses: (1) hypoelliptic regularity and parabolic Harnack inequalities (Kusuoka & Stroock 1985), (2) Gaussian mollification and multi-step Doeblin minorization (Hairer & Mattingly 2011), and (3) stochastic mass conservation via QSD theory (Champagnat & Villemonais 2016). See Chapter 5 for the complete proof.\n3826: \n3827: Under these assumptions, the **additive Hellinger-Kantorovich distance** (Definition {prf:ref}`def-hk-metric-intro`) contracts exponentially to a neighborhood of the QSD:\n3828: \n3829: $$\n3830: \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK}}{\\kappa_{HK}}(1 - e^{-\\kappa_{HK} t})\n3831: \n3832: $$\n3833: \n3834: where:\n3835: - $\\kappa_{HK} = \\min(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}) > 0$ is the overall convergence rate\n3836: - $C_{HK} < \\infty$ is a constant combining noise and discretization errors from all three components\n3837: \n3838: **Note on Mass Contraction:** The mass equilibration rate from {prf:ref}`lem-mass-contraction-revival-death` is already incorporated into $\\kappa_{\\text{kin}} = \\min(\\lambda_{\\text{mass}}, \\alpha_{\\text{shape}}/2)$ where $\\lambda_{\\text{mass}} = r_* + c_*$. The coupled Lyapunov functional approach in {prf:ref}`lem-kinetic-hellinger-contraction` (Step 5) automatically handles the mass-shape coupling, so we do not need a separate $\\kappa_{\\text{mass}}$ term in the overall rate formula.\n3839: \n3840: **Implication (Exponential Convergence):**\n3841: \n3842: $$\n3843: d_{HK}(\\mu_t, \\pi_{\\text{QSD}}) \\leq e^{-\\kappa_{HK} t/2} \\cdot d_{HK}(\\mu_0, \\pi_{\\text{QSD}}) + \\sqrt{\\frac{C_{HK}}{\\kappa_{HK}}}\n3844: \n3845: $$",
      "metadata": {
        "label": "thm-hk-convergence-main-assembly"
      },
      "section": "## 6. Main Theorem: Exponential HK-Convergence of the Fragile Gas",
      "references": [
        "lem-mass-contraction-revival-death",
        "lem-structural-variance-contraction",
        "thm-uniform-density-bound-hk",
        "def-hk-metric-intro",
        "lem-kinetic-hellinger-contraction"
      ],
      "raw_directive": "3805: ### 6.1. Statement of the Main Theorem\n3806: \n3807: :::{prf:theorem} Exponential HK-Convergence of the Fragile Gas\n3808: :label: thm-hk-convergence-main-assembly\n3809: \n3810: Let $\\mu_t$ denote the empirical measure of alive walkers at time $t$ under the Fragile Gas dynamics $\\Psi_{\\text{total}} = \\Psi_{\\text{kin}} \\circ \\Psi_{\\text{clone}}$, and let $\\pi_{\\text{QSD}}$ denote the quasi-stationary distribution.\n3811: \n3812: **Assumptions:**\n3813: \n3814: 1. **Mass Contraction ({prf:ref}`lem-mass-contraction-revival-death`)**: The birth-death balance satisfies the conditions of {prf:ref}`lem-mass-contraction-revival-death` with $\\kappa_{\\text{mass}} > 0$.\n3815: \n3816: 2. **Structural Variance Contraction ({prf:ref}`lem-structural-variance-contraction`)**: The Wasserstein contraction conditions of {prf:ref}`lem-structural-variance-contraction` hold with $\\lambda_{\\text{struct}} > 0$.\n3817: \n3818: 3. **Bounded Density Ratio (Theorem {prf:ref}`thm-uniform-density-bound-hk`)**: The density ratio is uniformly bounded:\n3819: \n3820: $$\n3821: \\sup_{t \\geq 0} \\sup_{x \\in \\mathcal{X}_{\\text{valid}}} \\frac{d\\tilde{\\mu}_t}{d\\tilde{\\pi}_{\\text{QSD}}}(x) \\leq M < \\infty\n3822: \n3823: $$\n3824: \n3825: The proof uses: (1) hypoelliptic regularity and parabolic Harnack inequalities (Kusuoka & Stroock 1985), (2) Gaussian mollification and multi-step Doeblin minorization (Hairer & Mattingly 2011), and (3) stochastic mass conservation via QSD theory (Champagnat & Villemonais 2016). See Chapter 5 for the complete proof.\n3826: \n3827: Under these assumptions, the **additive Hellinger-Kantorovich distance** (Definition {prf:ref}`def-hk-metric-intro`) contracts exponentially to a neighborhood of the QSD:\n3828: \n3829: $$\n3830: \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK}}{\\kappa_{HK}}(1 - e^{-\\kappa_{HK} t})\n3831: \n3832: $$\n3833: \n3834: where:\n3835: - $\\kappa_{HK} = \\min(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}) > 0$ is the overall convergence rate\n3836: - $C_{HK} < \\infty$ is a constant combining noise and discretization errors from all three components\n3837: \n3838: **Note on Mass Contraction:** The mass equilibration rate from {prf:ref}`lem-mass-contraction-revival-death` is already incorporated into $\\kappa_{\\text{kin}} = \\min(\\lambda_{\\text{mass}}, \\alpha_{\\text{shape}}/2)$ where $\\lambda_{\\text{mass}} = r_* + c_*$. The coupled Lyapunov functional approach in {prf:ref}`lem-kinetic-hellinger-contraction` (Step 5) automatically handles the mass-shape coupling, so we do not need a separate $\\kappa_{\\text{mass}}$ term in the overall rate formula.\n3839: \n3840: **Implication (Exponential Convergence):**\n3841: \n3842: $$\n3843: d_{HK}(\\mu_t, \\pi_{\\text{QSD}}) \\leq e^{-\\kappa_{HK} t/2} \\cdot d_{HK}(\\mu_0, \\pi_{\\text{QSD}}) + \\sqrt{\\frac{C_{HK}}{\\kappa_{HK}}}\n3844: \n3845: $$\n3846: "
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-hk-convergence-main-assembly",
      "title": null,
      "start_line": 3850,
      "end_line": 4235,
      "header_lines": [
        3851
      ],
      "content_start": 3853,
      "content_end": 4234,
      "content": "3853: :label: proof-thm-hk-convergence-main-assembly\n3854: \n3855: The proof assembles the three lemmas by carefully tracking how each component of the HK metric evolves under one iteration of $\\Psi_{\\text{total}}$.\n3856: \n3857: **Recall: HK Metric Structure**\n3858: \n3859: For sub-probability measures $\\mu_1, \\mu_2$ on $(\\mathcal{X}, d)$, the Hellinger-Kantorovich metric decomposes as:\n3860: \n3861: $$\n3862: d_{HK}^2(\\mu_1, \\mu_2) = d_H^2(\\mu_1, \\mu_2) + W_2^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)\n3863: \n3864: $$\n3865: \n3866: where:\n3867: - $d_H^2(\\mu_1, \\mu_2)$ is the Hellinger distance (captures both mass and shape differences)\n3868: - $W_2^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ is the Wasserstein-2 distance between normalized measures $\\tilde{\\mu}_i = \\mu_i/\\|\\mu_i\\|$ (captures spatial structure)\n3869: \n3870: **Strategy:** We establish contraction of each component separately, then combine with careful tracking of cross-terms and error accumulation.\n3871: \n3872: ### 6.3. Step 1: Hellinger Component Contraction\n3873: \n3874: From {prf:ref}`lem-kinetic-hellinger-contraction`, the Hellinger distance contracts under the full dynamics via a coupled Lyapunov functional approach:\n3875: \n3876: $$\n3877: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}} \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n3878: \n3879: $$\n3880: \n3881: where:\n3882: - $\\kappa_{\\text{kin}} = \\min(\\lambda_{\\text{mass}}, \\alpha_{\\text{shape}}/2) > 0$ (from coupled Lyapunov analysis in {prf:ref}`lem-kinetic-hellinger-contraction`, Step 5)\n3883: - $\\lambda_{\\text{mass}} = r_* + c_*$ combines revival rate $r_*$ and death rate $c_*$\n3884: - $\\alpha_{\\text{shape}} = 2\\alpha_{\\text{eff}} / (1 + \\log M)$ is the shape contraction rate from direct Hellinger evolution\n3885: - $C_{\\text{kin}} = 4C_m + 4\\sqrt{k_*} K_H$ combines mass variance and BAOAB discretization errors\n3886: \n3887: **Key Insight from {prf:ref}`lem-kinetic-hellinger-contraction`:** The Hellinger component already incorporates mass contraction via the decomposition:\n3888: \n3889: $$\n3890: d_H^2(\\mu, \\pi) = (\\sqrt{k_t} - \\sqrt{k_*})^2 + \\sqrt{k_t k_*} \\cdot d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi})\n3891: \n3892: $$\n3893: \n3894: where the first term measures mass deviation and the second measures normalized shape deviation. Both contract under the kinetic operator, and their coupling is controlled via Cauchy-Schwarz bounds.\n3895: \n3896: **Implication for Assembly:** The Hellinger contraction bound from {prf:ref}`lem-kinetic-hellinger-contraction` is already a **complete bound** for the full Hellinger distance including mass effects. We do not need to separately combine {prf:ref}`lem-mass-contraction-revival-death`'s mass contraction\u2014it is already accounted for in the proof of {prf:ref}`lem-kinetic-hellinger-contraction`.\n3897: \n3898: ### 6.4. Step 2: Wasserstein Component Contraction\n3899: \n3900: From {prf:ref}`lem-structural-variance-contraction`, the structural variance (normalized Wasserstein distance) contracts:\n3901: \n3902: $$\n3903: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} \\tau} W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}}\n3904: \n3905: $$\n3906: \n3907: where:\n3908: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}}) > 0$\n3909: - $\\kappa_W > 0$ is the cloning Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n3910: - $\\kappa_{\\text{kin}} > 0$ is the kinetic Foster-Lyapunov rate from {prf:ref}`thm-foster-lyapunov-main`\n3911: - $C_{\\text{struct}} = C_W + C_{\\text{kin}} \\tau^2$ combines noise from both operators\n3912: \n3913: **Realization-Level Nature:** This bound applies to individual realizations (paths) of the particle system, not just to expectations over the law. The Wasserstein distance $W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})$ is a deterministic function of the realization $\\mu_t$, and both operators contract it pathwise.\n3914: \n3915: **Approximation for Small Time Steps:** For $\\tau \\ll 1$, we can approximate $e^{-\\lambda_{\\text{struct}} \\tau} \\approx 1 - \\lambda_{\\text{struct}} \\tau + O(\\tau^2)$:\n3916: \n3917: $$\n3918: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})] \\leq (1 - \\lambda_{\\text{struct}} \\tau) W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}} + O(\\tau^2)\n3919: \n3920: $$\n3921: \n3922: ### 6.5. Step 3: Combining Both Components\n3923: \n3924: **Full HK Metric Evolution:**\n3925: \n3926: By the definition of the HK metric ({prf:ref}`def-hk-metric-intro`), we have:\n3927: \n3928: $$\n3929: d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) = d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) + W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})\n3930: \n3931: $$\n3932: \n3933: Taking expectations:\n3934: \n3935: $$\n3936: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] = \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] + \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})]\n3937: \n3938: $$\n3939: \n3940: **Substituting Component Bounds:**\n3941: \n3942: From Step 1 ({prf:ref}`lem-kinetic-hellinger-contraction`), we have:\n3943: \n3944: $$\n3945: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}} \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n3946: \n3947: $$\n3948: \n3949: From Step 2 ({prf:ref}`lem-structural-variance-contraction`), using the first-order approximation $e^{-\\lambda_{\\text{struct}} \\tau} \\leq 1 - \\lambda_{\\text{struct}} \\tau + \\frac{(\\lambda_{\\text{struct}} \\tau)^2}{2}$:\n3950: \n3951: $$\n3952: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\lambda_{\\text{struct}} \\tau) W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}} + \\frac{(\\lambda_{\\text{struct}})^2 \\tau^2}{2} W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n3953: \n3954: $$\n3955: \n3956: Taking expectations over $\\mu_t$:\n3957: \n3958: $$\n3959: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi)] \\leq (1 - \\kappa_{\\text{kin}} \\tau) \\mathbb{E}[d_H^2(\\mu_t, \\pi)] + C_{\\text{kin}} \\tau^2 + (1 - \\lambda_{\\text{struct}} \\tau) \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})] + C_{\\text{struct}} + R_\\tau\n3960: \n3961: $$\n3962: \n3963: where the remainder term is:\n3964: \n3965: $$\n3966: R_\\tau := \\frac{(\\lambda_{\\text{struct}})^2 \\tau^2}{2} \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})]\n3967: \n3968: $$\n3969: \n3970: **Bounding the Remainder:**\n3971: \n3972: Since walkers are confined to a ball of radius $R$, we have $W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) \\leq \\text{diam}(\\mathcal{X})^2 \\leq (2R)^2$. Thus:\n3973: \n3974: $$\n3975: R_\\tau \\leq 2 (\\lambda_{\\text{struct}} R)^2 \\tau^2 =: C_{\\text{quad}} \\tau^2\n3976: \n3977: $$\n3978: \n3979: **Uniform Contraction Rate:**\n3980: \n3981: Define the **bottleneck rate** as:\n3982: \n3983: $$\n3984: \\kappa_{HK} := \\min(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}) > 0\n3985: \n3986: $$\n3987: \n3988: This is the slowest contraction rate among all components and determines the overall convergence speed.\n3989: \n3990: **Lemma (Bottleneck Inequality):** For any $a, b \\geq 0$ and rates $\\alpha, \\beta > 0$, if $\\kappa := \\min(\\alpha, \\beta)$, then:\n3991: \n3992: $$\n3993: (1 - \\alpha \\tau) a + (1 - \\beta \\tau) b \\leq (1 - \\kappa \\tau)(a + b) \\quad \\text{for } \\tau \\in (0, 1/\\max(\\alpha,\\beta))\n3994: \n3995: $$\n3996: \n3997: **Proof:** Expanding the right-hand side:\n3998: \n3999: $$\n4000: (1 - \\kappa \\tau)(a + b) = a + b - \\kappa \\tau (a + b)\n4001: \n4002: $$\n4003: \n4004: The left-hand side is:\n4005: \n4006: $$\n4007: a + b - \\alpha \\tau a - \\beta \\tau b\n4008: \n4009: $$\n4010: \n4011: We need $\\alpha \\tau a + \\beta \\tau b \\geq \\kappa \\tau (a + b)$, i.e., $\\alpha a + \\beta b \\geq \\kappa (a + b)$.\n4012: \n4013: Since $\\kappa = \\min(\\alpha, \\beta)$, we have $\\alpha \\geq \\kappa$ and $\\beta \\geq \\kappa$, hence:\n4014: \n4015: $$\n4016: \\alpha a + \\beta b \\geq \\kappa a + \\kappa b = \\kappa(a + b) \\quad \\checkmark\n4017: \n4018: $$\n4019: \n4020: **Applying the Bottleneck Inequality:**\n4021: \n4022: With $a = \\mathbb{E}[d_H^2(\\mu_t, \\pi)]$, $b = \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})]$, $\\alpha = \\kappa_{\\text{kin}}$, $\\beta = \\lambda_{\\text{struct}}$:\n4023: \n4024: $$\n4025: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi)] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi)] + C_{\\text{kin}} \\tau^2 + C_{\\text{struct}} + C_{\\text{quad}} \\tau^2\n4026: \n4027: $$\n4028: \n4029: **Combined Error Constant:**\n4030: \n4031: The total error from combining both bounds is:\n4032: \n4033: $$\n4034: C_{\\text{kin}} \\tau^2 + C_{\\text{struct}} + C_{\\text{quad}} \\tau^2\n4035: \n4036: $$\n4037: \n4038: To express this in the form $C_{HK}(\\tau) \\tau^2$, we define:\n4039: \n4040: $$\n4041: C_{HK}(\\tau) := C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_{\\text{struct}}}{\\tau^2}\n4042: \n4043: $$\n4044: \n4045: Then:\n4046: \n4047: $$\n4048: C_{HK}(\\tau) \\tau^2 = (C_{\\text{kin}} + C_{\\text{quad}}) \\tau^2 + C_{\\text{struct}} \\quad \\checkmark\n4049: \n4050: $$\n4051: \n4052: This gives the one-step bound:\n4053: \n4054: $$\n4055: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] + C_{HK}(\\tau) \\tau^2\n4056: \n4057: $$\n4058: \n4059: **Properties of $C_{HK}(\\tau)$:**\n4060: \n4061: 1. **Explicit dependence:** $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_{\\text{struct}}}{\\tau^2}$ where:\n4062:    - $C_{\\text{quad}} = 2(\\lambda_{\\text{struct}} R)^2$ (quadratic remainder from exponential expansion)\n4063:    - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ (from {prf:ref}`lem-structural-variance-contraction`)\n4064: \n4065: 2. **Scaling with $\\tau$:**\n4066:    - Substituting $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$:\n4067: \n4068: $$\n4069: C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_W}{\\tau^2} + C_{\\text{kin}}\n4070: \n4071: $$\n4072: \n4073:    - If $C_W = O(1)$ (cloning noise dominates), then $C_{HK}(\\tau) \\sim O(1/\\tau^2)$ as $\\tau \\to 0$\n4074:    - If $C_W = O(\\tau^2)$ (ideal discretization), then $C_{HK}(\\tau) = O(1)$\n4075: \n4076: 3. **Finiteness:** For any fixed $\\tau \\in (0, \\tau_{\\max}]$, we have $C_{HK}(\\tau) < \\infty$\n4077: \n4078: **Final One-Step Bound:**\n4079: \n4080: For a fixed time step $\\tau > 0$, setting $C_{HK} := C_{HK}(\\tau)$, we have proven:\n4081: \n4082: $$\n4083: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] + C_{HK} \\tau^2\n4084: \n4085: $$\n4086: \n4087: This is the fundamental one-step contraction inequality for the HK metric.\n4088: \n4089: ### 6.6. Step 4: Iteration and Exponential Bound\n4090: \n4091: Having established the one-step contraction inequality, we now iterate it to obtain the full exponential decay bound.\n4092: \n4093: **Discrete-Time Iteration:**\n4094: \n4095: We have for all $k \\geq 0$:\n4096: \n4097: $$\n4098: \\mathbb{E}[d_{HK}^2(\\mu_{k+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_k, \\pi_{\\text{QSD}})] + C_{HK} \\tau^2\n4099: \n4100: $$\n4101: \n4102: **Lemma (Affine Recursion).** Let $(X_n)_{n \\geq 0}$ satisfy $X_{n+1} \\leq \\rho X_n + \\sigma$ for $\\rho \\in (0,1)$ and $\\sigma \\geq 0$. Then:\n4103: \n4104: $$\n4105: X_n \\leq \\rho^n X_0 + \\sigma \\sum_{j=0}^{n-1} \\rho^j = \\rho^n X_0 + \\sigma \\frac{1 - \\rho^n}{1 - \\rho}\n4106: \n4107: $$\n4108: \n4109: **Proof.** By induction. Base case ($n=0$): $X_0 \\leq X_0$ trivially.\n4110: \n4111: Inductive step: Assume $X_n \\leq \\rho^n X_0 + \\sigma \\frac{1-\\rho^n}{1-\\rho}$. Then:\n4112: \n4113: $$\n4114: X_{n+1} \\leq \\rho X_n + \\sigma \\leq \\rho\\left(\\rho^n X_0 + \\sigma \\frac{1-\\rho^n}{1-\\rho}\\right) + \\sigma = \\rho^{n+1} X_0 + \\sigma \\left(\\frac{\\rho(1-\\rho^n)}{1-\\rho} + 1\\right)\n4115: \n4116: $$\n4117: \n4118: Simplifying the coefficient of $\\sigma$:\n4119: \n4120: $$\n4121: \\frac{\\rho(1-\\rho^n)}{1-\\rho} + 1 = \\frac{\\rho(1-\\rho^n) + (1-\\rho)}{1-\\rho} = \\frac{\\rho - \\rho^{n+1} + 1 - \\rho}{1-\\rho} = \\frac{1 - \\rho^{n+1}}{1-\\rho} \\quad \\checkmark\n4122: \n4123: $$\n4124: \n4125: **Applying the Affine Recursion Lemma:**\n4126: \n4127: With $X_n = \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi_{\\text{QSD}})]$, $\\rho = 1 - \\kappa_{HK} \\tau \\in (0,1)$ (assuming $\\tau < 1/\\kappa_{HK}$), and $\\sigma = C_{HK} \\tau^2$:\n4128: \n4129: $$\n4130: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + C_{HK} \\tau^2 \\frac{1 - (1 - \\kappa_{HK} \\tau)^n}{\\kappa_{HK} \\tau}\n4131: \n4132: $$\n4133: \n4134: Simplifying:\n4135: \n4136: $$\n4137: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - (1 - \\kappa_{HK} \\tau)^n]\n4138: \n4139: $$\n4140: \n4141: **Continuous-Time Bound via Inequality:**\n4142: \n4143: To transition rigorously from discrete to continuous time, we use a standard logarithmic inequality.\n4144: \n4145: **Lemma (Logarithmic Inequality).** For $x \\in (0,1)$:\n4146: \n4147: $$\n4148: \\log(1 - x) \\leq -x\n4149: \n4150: $$\n4151: \n4152: **Proof.** Consider $f(x) = \\log(1-x) + x$. Then $f(0) = 0$ and $f'(x) = -1/(1-x) + 1 = x/(1-x) > 0$ for $x > 0$. Thus $f$ is strictly increasing, so $f(x) > f(0) = 0$ for $x > 0$. Wait, this gives the wrong inequality direction.\n4153: \n4154: Actually, $f'(x) = -1/(1-x) + 1 = (1-x-1)/(1-x) = -x/(1-x) < 0$ for $x \\in (0,1)$. Thus $f$ is strictly decreasing, so $f(x) < f(0) = 0$, giving $\\log(1-x) < -x$ for $x \\in (0,1)$. $\\square$\n4155: \n4156: **Applying the Logarithmic Inequality:**\n4157: \n4158: For $\\kappa_{HK} \\tau < 1$, we have:\n4159: \n4160: $$\n4161: (1 - \\kappa_{HK} \\tau)^n = \\exp(n \\log(1 - \\kappa_{HK} \\tau)) \\leq \\exp(-n \\kappa_{HK} \\tau) = \\exp(-\\kappa_{HK} t)\n4162: \n4163: $$\n4164: \n4165: where $t = n\\tau$ (note: $n$ may be non-integer if $t/\\tau$ is not an integer, but the bound holds for $n = \\lfloor t/\\tau \\rfloor$ or $n = \\lceil t/\\tau \\rceil$).\n4166: \n4167: **Theorem (Exponential Decay in HK Metric - Discrete Time).** For any time $t_n = n\\tau$ (discrete time steps), the Fragile Gas satisfies:\n4168: \n4169: $$\n4170: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK}(\\tau) \\tau}{\\kappa_{HK}}\n4171: \n4172: $$\n4173: \n4174: where $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + C_{\\text{struct}}/\\tau^2$ is the time-step-dependent error constant.\n4175: \n4176: **Proof.** From the affine recursion lemma:\n4177: \n4178: $$\n4179: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - (1 - \\kappa_{HK} \\tau)^n]\n4180: \n4181: $$\n4182: \n4183: Using $(1 - \\kappa_{HK} \\tau)^n \\leq e^{-\\kappa_{HK} t_n}$:\n4184: \n4185: $$\n4186: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi)] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - e^{-\\kappa_{HK} t_n}]\n4187: \n4188: $$\n4189: \n4190: Since $1 - e^{-\\kappa_{HK} t_n} \\leq 1$:\n4191: \n4192: $$\n4193: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK} \\tau}{\\kappa_{HK}}\n4194: \n4195: $$\n4196: \n4197: This completes the proof. $\\square$\n4198: \n4199: **Interpretation:** The theorem establishes exponential decay of the HK distance to the QSD for the discrete-time Fragile Gas dynamics. The steady-state error floor $\\sqrt{C_{HK} \\tau / \\kappa_{HK}}$ depends explicitly on the time step $\\tau$, reflecting the fact that this is a bound for a specific discretization of the underlying continuous dynamics.\n4200: \n4201: **Corollary (Convergence in Metric).** Taking square roots and using the Cauchy-Schwarz inequality:\n4202: \n4203: $$\n4204: d_{HK}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\sqrt{\\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})]} \\leq e^{-\\kappa_{HK} t/2} d_{HK}(\\mu_0, \\pi_{\\text{QSD}}) + \\sqrt{\\frac{C_{HK} \\tau}{\\kappa_{HK}}}\n4205: \n4206: $$\n4207: \n4208: **Remark on Expectation vs. Realization:** The bound holds for the expectation $\\mathbb{E}[d_{HK}]$ taken over all randomness (cloning selection, Langevin noise, boundary exits). Individual realizations may fluctuate, but concentration inequalities (future work) would bound the deviation from this expected trajectory.\n4209: \n4210: **Steady-State Limit:**\n4211: \n4212: As $t \\to \\infty$, the exponential term vanishes, and:\n4213: \n4214: $$\n4215: \\lim_{t \\to \\infty} \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] \\leq \\frac{C_{HK} \\tau}{\\kappa_{HK}}\n4216: \n4217: $$\n4218: \n4219: This is the **invariant error floor**, determined by the balance between contraction rate $\\kappa_{HK}$ and noise accumulation rate $C_{HK} \\tau$.\n4220: \n4221: **Conclusion of Proof:**\n4222: \n4223: We have proven that for discrete times $t_n = n\\tau$, the Fragile Gas satisfies:\n4224: \n4225: $$\n4226: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK}(\\tau) \\tau}{\\kappa_{HK}}\n4227: \n4228: $$\n4229: \n4230: with explicit convergence rate $\\kappa_{HK} = \\min(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}) > 0$ and error constant $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + C_{\\text{struct}}/\\tau^2$, where:\n4231: - $C_{\\text{kin}}$: kinetic operator BAOAB discretization error\n4232: - $C_{\\text{quad}} = 2(\\lambda_{\\text{struct}} R)^2$: quadratic correction from exponential approximation\n4233: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$: structural variance noise\n4234: ",
      "metadata": {
        "label": "proof-thm-hk-convergence-main-assembly"
      },
      "section": "## 6. Main Theorem: Exponential HK-Convergence of the Fragile Gas",
      "references": [
        "lem-kinetic-hellinger-contraction",
        "lem-mass-contraction-revival-death",
        "lem-structural-variance-contraction",
        "thm-main-contraction-full",
        "thm-foster-lyapunov-main",
        "def-hk-metric-intro",
        "thm-hk-convergence-main-assembly"
      ],
      "raw_directive": "3850: ### 6.2. Proof Strategy and HK Metric Decomposition\n3851: \n3852: :::{prf:proof}\n3853: :label: proof-thm-hk-convergence-main-assembly\n3854: \n3855: The proof assembles the three lemmas by carefully tracking how each component of the HK metric evolves under one iteration of $\\Psi_{\\text{total}}$.\n3856: \n3857: **Recall: HK Metric Structure**\n3858: \n3859: For sub-probability measures $\\mu_1, \\mu_2$ on $(\\mathcal{X}, d)$, the Hellinger-Kantorovich metric decomposes as:\n3860: \n3861: $$\n3862: d_{HK}^2(\\mu_1, \\mu_2) = d_H^2(\\mu_1, \\mu_2) + W_2^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)\n3863: \n3864: $$\n3865: \n3866: where:\n3867: - $d_H^2(\\mu_1, \\mu_2)$ is the Hellinger distance (captures both mass and shape differences)\n3868: - $W_2^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ is the Wasserstein-2 distance between normalized measures $\\tilde{\\mu}_i = \\mu_i/\\|\\mu_i\\|$ (captures spatial structure)\n3869: \n3870: **Strategy:** We establish contraction of each component separately, then combine with careful tracking of cross-terms and error accumulation.\n3871: \n3872: ### 6.3. Step 1: Hellinger Component Contraction\n3873: \n3874: From {prf:ref}`lem-kinetic-hellinger-contraction`, the Hellinger distance contracts under the full dynamics via a coupled Lyapunov functional approach:\n3875: \n3876: $$\n3877: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}} \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n3878: \n3879: $$\n3880: \n3881: where:\n3882: - $\\kappa_{\\text{kin}} = \\min(\\lambda_{\\text{mass}}, \\alpha_{\\text{shape}}/2) > 0$ (from coupled Lyapunov analysis in {prf:ref}`lem-kinetic-hellinger-contraction`, Step 5)\n3883: - $\\lambda_{\\text{mass}} = r_* + c_*$ combines revival rate $r_*$ and death rate $c_*$\n3884: - $\\alpha_{\\text{shape}} = 2\\alpha_{\\text{eff}} / (1 + \\log M)$ is the shape contraction rate from direct Hellinger evolution\n3885: - $C_{\\text{kin}} = 4C_m + 4\\sqrt{k_*} K_H$ combines mass variance and BAOAB discretization errors\n3886: \n3887: **Key Insight from {prf:ref}`lem-kinetic-hellinger-contraction`:** The Hellinger component already incorporates mass contraction via the decomposition:\n3888: \n3889: $$\n3890: d_H^2(\\mu, \\pi) = (\\sqrt{k_t} - \\sqrt{k_*})^2 + \\sqrt{k_t k_*} \\cdot d_H^2(\\tilde{\\mu}_t, \\tilde{\\pi})\n3891: \n3892: $$\n3893: \n3894: where the first term measures mass deviation and the second measures normalized shape deviation. Both contract under the kinetic operator, and their coupling is controlled via Cauchy-Schwarz bounds.\n3895: \n3896: **Implication for Assembly:** The Hellinger contraction bound from {prf:ref}`lem-kinetic-hellinger-contraction` is already a **complete bound** for the full Hellinger distance including mass effects. We do not need to separately combine {prf:ref}`lem-mass-contraction-revival-death`'s mass contraction\u2014it is already accounted for in the proof of {prf:ref}`lem-kinetic-hellinger-contraction`.\n3897: \n3898: ### 6.4. Step 2: Wasserstein Component Contraction\n3899: \n3900: From {prf:ref}`lem-structural-variance-contraction`, the structural variance (normalized Wasserstein distance) contracts:\n3901: \n3902: $$\n3903: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})] \\leq e^{-\\lambda_{\\text{struct}} \\tau} W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}}\n3904: \n3905: $$\n3906: \n3907: where:\n3908: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}}) > 0$\n3909: - $\\kappa_W > 0$ is the cloning Wasserstein contraction rate from {prf:ref}`thm-main-contraction-full`\n3910: - $\\kappa_{\\text{kin}} > 0$ is the kinetic Foster-Lyapunov rate from {prf:ref}`thm-foster-lyapunov-main`\n3911: - $C_{\\text{struct}} = C_W + C_{\\text{kin}} \\tau^2$ combines noise from both operators\n3912: \n3913: **Realization-Level Nature:** This bound applies to individual realizations (paths) of the particle system, not just to expectations over the law. The Wasserstein distance $W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})$ is a deterministic function of the realization $\\mu_t$, and both operators contract it pathwise.\n3914: \n3915: **Approximation for Small Time Steps:** For $\\tau \\ll 1$, we can approximate $e^{-\\lambda_{\\text{struct}} \\tau} \\approx 1 - \\lambda_{\\text{struct}} \\tau + O(\\tau^2)$:\n3916: \n3917: $$\n3918: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})] \\leq (1 - \\lambda_{\\text{struct}} \\tau) W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}} + O(\\tau^2)\n3919: \n3920: $$\n3921: \n3922: ### 6.5. Step 3: Combining Both Components\n3923: \n3924: **Full HK Metric Evolution:**\n3925: \n3926: By the definition of the HK metric ({prf:ref}`def-hk-metric-intro`), we have:\n3927: \n3928: $$\n3929: d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) = d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) + W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})\n3930: \n3931: $$\n3932: \n3933: Taking expectations:\n3934: \n3935: $$\n3936: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] = \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] + \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}})]\n3937: \n3938: $$\n3939: \n3940: **Substituting Component Bounds:**\n3941: \n3942: From Step 1 ({prf:ref}`lem-kinetic-hellinger-contraction`), we have:\n3943: \n3944: $$\n3945: \\mathbb{E}[d_H^2(\\mu_{t+1}, \\pi_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\kappa_{\\text{kin}} \\tau) d_H^2(\\mu_t, \\pi_{\\text{QSD}}) + C_{\\text{kin}} \\tau^2\n3946: \n3947: $$\n3948: \n3949: From Step 2 ({prf:ref}`lem-structural-variance-contraction`), using the first-order approximation $e^{-\\lambda_{\\text{struct}} \\tau} \\leq 1 - \\lambda_{\\text{struct}} \\tau + \\frac{(\\lambda_{\\text{struct}} \\tau)^2}{2}$:\n3950: \n3951: $$\n3952: \\mathbb{E}[W_2^2(\\tilde{\\mu}_{t+1}, \\tilde{\\pi}_{\\text{QSD}}) | \\mu_t] \\leq (1 - \\lambda_{\\text{struct}} \\tau) W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) + C_{\\text{struct}} + \\frac{(\\lambda_{\\text{struct}})^2 \\tau^2}{2} W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}})\n3953: \n3954: $$\n3955: \n3956: Taking expectations over $\\mu_t$:\n3957: \n3958: $$\n3959: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi)] \\leq (1 - \\kappa_{\\text{kin}} \\tau) \\mathbb{E}[d_H^2(\\mu_t, \\pi)] + C_{\\text{kin}} \\tau^2 + (1 - \\lambda_{\\text{struct}} \\tau) \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})] + C_{\\text{struct}} + R_\\tau\n3960: \n3961: $$\n3962: \n3963: where the remainder term is:\n3964: \n3965: $$\n3966: R_\\tau := \\frac{(\\lambda_{\\text{struct}})^2 \\tau^2}{2} \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})]\n3967: \n3968: $$\n3969: \n3970: **Bounding the Remainder:**\n3971: \n3972: Since walkers are confined to a ball of radius $R$, we have $W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi}_{\\text{QSD}}) \\leq \\text{diam}(\\mathcal{X})^2 \\leq (2R)^2$. Thus:\n3973: \n3974: $$\n3975: R_\\tau \\leq 2 (\\lambda_{\\text{struct}} R)^2 \\tau^2 =: C_{\\text{quad}} \\tau^2\n3976: \n3977: $$\n3978: \n3979: **Uniform Contraction Rate:**\n3980: \n3981: Define the **bottleneck rate** as:\n3982: \n3983: $$\n3984: \\kappa_{HK} := \\min(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}) > 0\n3985: \n3986: $$\n3987: \n3988: This is the slowest contraction rate among all components and determines the overall convergence speed.\n3989: \n3990: **Lemma (Bottleneck Inequality):** For any $a, b \\geq 0$ and rates $\\alpha, \\beta > 0$, if $\\kappa := \\min(\\alpha, \\beta)$, then:\n3991: \n3992: $$\n3993: (1 - \\alpha \\tau) a + (1 - \\beta \\tau) b \\leq (1 - \\kappa \\tau)(a + b) \\quad \\text{for } \\tau \\in (0, 1/\\max(\\alpha,\\beta))\n3994: \n3995: $$\n3996: \n3997: **Proof:** Expanding the right-hand side:\n3998: \n3999: $$\n4000: (1 - \\kappa \\tau)(a + b) = a + b - \\kappa \\tau (a + b)\n4001: \n4002: $$\n4003: \n4004: The left-hand side is:\n4005: \n4006: $$\n4007: a + b - \\alpha \\tau a - \\beta \\tau b\n4008: \n4009: $$\n4010: \n4011: We need $\\alpha \\tau a + \\beta \\tau b \\geq \\kappa \\tau (a + b)$, i.e., $\\alpha a + \\beta b \\geq \\kappa (a + b)$.\n4012: \n4013: Since $\\kappa = \\min(\\alpha, \\beta)$, we have $\\alpha \\geq \\kappa$ and $\\beta \\geq \\kappa$, hence:\n4014: \n4015: $$\n4016: \\alpha a + \\beta b \\geq \\kappa a + \\kappa b = \\kappa(a + b) \\quad \\checkmark\n4017: \n4018: $$\n4019: \n4020: **Applying the Bottleneck Inequality:**\n4021: \n4022: With $a = \\mathbb{E}[d_H^2(\\mu_t, \\pi)]$, $b = \\mathbb{E}[W_2^2(\\tilde{\\mu}_t, \\tilde{\\pi})]$, $\\alpha = \\kappa_{\\text{kin}}$, $\\beta = \\lambda_{\\text{struct}}$:\n4023: \n4024: $$\n4025: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi)] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi)] + C_{\\text{kin}} \\tau^2 + C_{\\text{struct}} + C_{\\text{quad}} \\tau^2\n4026: \n4027: $$\n4028: \n4029: **Combined Error Constant:**\n4030: \n4031: The total error from combining both bounds is:\n4032: \n4033: $$\n4034: C_{\\text{kin}} \\tau^2 + C_{\\text{struct}} + C_{\\text{quad}} \\tau^2\n4035: \n4036: $$\n4037: \n4038: To express this in the form $C_{HK}(\\tau) \\tau^2$, we define:\n4039: \n4040: $$\n4041: C_{HK}(\\tau) := C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_{\\text{struct}}}{\\tau^2}\n4042: \n4043: $$\n4044: \n4045: Then:\n4046: \n4047: $$\n4048: C_{HK}(\\tau) \\tau^2 = (C_{\\text{kin}} + C_{\\text{quad}}) \\tau^2 + C_{\\text{struct}} \\quad \\checkmark\n4049: \n4050: $$\n4051: \n4052: This gives the one-step bound:\n4053: \n4054: $$\n4055: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] + C_{HK}(\\tau) \\tau^2\n4056: \n4057: $$\n4058: \n4059: **Properties of $C_{HK}(\\tau)$:**\n4060: \n4061: 1. **Explicit dependence:** $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_{\\text{struct}}}{\\tau^2}$ where:\n4062:    - $C_{\\text{quad}} = 2(\\lambda_{\\text{struct}} R)^2$ (quadratic remainder from exponential expansion)\n4063:    - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$ (from {prf:ref}`lem-structural-variance-contraction`)\n4064: \n4065: 2. **Scaling with $\\tau$:**\n4066:    - Substituting $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$:\n4067: \n4068: $$\n4069: C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + \\frac{C_W}{\\tau^2} + C_{\\text{kin}}\n4070: \n4071: $$\n4072: \n4073:    - If $C_W = O(1)$ (cloning noise dominates), then $C_{HK}(\\tau) \\sim O(1/\\tau^2)$ as $\\tau \\to 0$\n4074:    - If $C_W = O(\\tau^2)$ (ideal discretization), then $C_{HK}(\\tau) = O(1)$\n4075: \n4076: 3. **Finiteness:** For any fixed $\\tau \\in (0, \\tau_{\\max}]$, we have $C_{HK}(\\tau) < \\infty$\n4077: \n4078: **Final One-Step Bound:**\n4079: \n4080: For a fixed time step $\\tau > 0$, setting $C_{HK} := C_{HK}(\\tau)$, we have proven:\n4081: \n4082: $$\n4083: \\mathbb{E}[d_{HK}^2(\\mu_{t+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] + C_{HK} \\tau^2\n4084: \n4085: $$\n4086: \n4087: This is the fundamental one-step contraction inequality for the HK metric.\n4088: \n4089: ### 6.6. Step 4: Iteration and Exponential Bound\n4090: \n4091: Having established the one-step contraction inequality, we now iterate it to obtain the full exponential decay bound.\n4092: \n4093: **Discrete-Time Iteration:**\n4094: \n4095: We have for all $k \\geq 0$:\n4096: \n4097: $$\n4098: \\mathbb{E}[d_{HK}^2(\\mu_{k+1}, \\pi_{\\text{QSD}})] \\leq (1 - \\kappa_{HK} \\tau) \\mathbb{E}[d_{HK}^2(\\mu_k, \\pi_{\\text{QSD}})] + C_{HK} \\tau^2\n4099: \n4100: $$\n4101: \n4102: **Lemma (Affine Recursion).** Let $(X_n)_{n \\geq 0}$ satisfy $X_{n+1} \\leq \\rho X_n + \\sigma$ for $\\rho \\in (0,1)$ and $\\sigma \\geq 0$. Then:\n4103: \n4104: $$\n4105: X_n \\leq \\rho^n X_0 + \\sigma \\sum_{j=0}^{n-1} \\rho^j = \\rho^n X_0 + \\sigma \\frac{1 - \\rho^n}{1 - \\rho}\n4106: \n4107: $$\n4108: \n4109: **Proof.** By induction. Base case ($n=0$): $X_0 \\leq X_0$ trivially.\n4110: \n4111: Inductive step: Assume $X_n \\leq \\rho^n X_0 + \\sigma \\frac{1-\\rho^n}{1-\\rho}$. Then:\n4112: \n4113: $$\n4114: X_{n+1} \\leq \\rho X_n + \\sigma \\leq \\rho\\left(\\rho^n X_0 + \\sigma \\frac{1-\\rho^n}{1-\\rho}\\right) + \\sigma = \\rho^{n+1} X_0 + \\sigma \\left(\\frac{\\rho(1-\\rho^n)}{1-\\rho} + 1\\right)\n4115: \n4116: $$\n4117: \n4118: Simplifying the coefficient of $\\sigma$:\n4119: \n4120: $$\n4121: \\frac{\\rho(1-\\rho^n)}{1-\\rho} + 1 = \\frac{\\rho(1-\\rho^n) + (1-\\rho)}{1-\\rho} = \\frac{\\rho - \\rho^{n+1} + 1 - \\rho}{1-\\rho} = \\frac{1 - \\rho^{n+1}}{1-\\rho} \\quad \\checkmark\n4122: \n4123: $$\n4124: \n4125: **Applying the Affine Recursion Lemma:**\n4126: \n4127: With $X_n = \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi_{\\text{QSD}})]$, $\\rho = 1 - \\kappa_{HK} \\tau \\in (0,1)$ (assuming $\\tau < 1/\\kappa_{HK}$), and $\\sigma = C_{HK} \\tau^2$:\n4128: \n4129: $$\n4130: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + C_{HK} \\tau^2 \\frac{1 - (1 - \\kappa_{HK} \\tau)^n}{\\kappa_{HK} \\tau}\n4131: \n4132: $$\n4133: \n4134: Simplifying:\n4135: \n4136: $$\n4137: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - (1 - \\kappa_{HK} \\tau)^n]\n4138: \n4139: $$\n4140: \n4141: **Continuous-Time Bound via Inequality:**\n4142: \n4143: To transition rigorously from discrete to continuous time, we use a standard logarithmic inequality.\n4144: \n4145: **Lemma (Logarithmic Inequality).** For $x \\in (0,1)$:\n4146: \n4147: $$\n4148: \\log(1 - x) \\leq -x\n4149: \n4150: $$\n4151: \n4152: **Proof.** Consider $f(x) = \\log(1-x) + x$. Then $f(0) = 0$ and $f'(x) = -1/(1-x) + 1 = x/(1-x) > 0$ for $x > 0$. Thus $f$ is strictly increasing, so $f(x) > f(0) = 0$ for $x > 0$. Wait, this gives the wrong inequality direction.\n4153: \n4154: Actually, $f'(x) = -1/(1-x) + 1 = (1-x-1)/(1-x) = -x/(1-x) < 0$ for $x \\in (0,1)$. Thus $f$ is strictly decreasing, so $f(x) < f(0) = 0$, giving $\\log(1-x) < -x$ for $x \\in (0,1)$. $\\square$\n4155: \n4156: **Applying the Logarithmic Inequality:**\n4157: \n4158: For $\\kappa_{HK} \\tau < 1$, we have:\n4159: \n4160: $$\n4161: (1 - \\kappa_{HK} \\tau)^n = \\exp(n \\log(1 - \\kappa_{HK} \\tau)) \\leq \\exp(-n \\kappa_{HK} \\tau) = \\exp(-\\kappa_{HK} t)\n4162: \n4163: $$\n4164: \n4165: where $t = n\\tau$ (note: $n$ may be non-integer if $t/\\tau$ is not an integer, but the bound holds for $n = \\lfloor t/\\tau \\rfloor$ or $n = \\lceil t/\\tau \\rceil$).\n4166: \n4167: **Theorem (Exponential Decay in HK Metric - Discrete Time).** For any time $t_n = n\\tau$ (discrete time steps), the Fragile Gas satisfies:\n4168: \n4169: $$\n4170: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK}(\\tau) \\tau}{\\kappa_{HK}}\n4171: \n4172: $$\n4173: \n4174: where $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + C_{\\text{struct}}/\\tau^2$ is the time-step-dependent error constant.\n4175: \n4176: **Proof.** From the affine recursion lemma:\n4177: \n4178: $$\n4179: \\mathbb{E}[d_{HK}^2(\\mu_n, \\pi)] \\leq (1 - \\kappa_{HK} \\tau)^n d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - (1 - \\kappa_{HK} \\tau)^n]\n4180: \n4181: $$\n4182: \n4183: Using $(1 - \\kappa_{HK} \\tau)^n \\leq e^{-\\kappa_{HK} t_n}$:\n4184: \n4185: $$\n4186: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi)] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi) + \\frac{C_{HK} \\tau}{\\kappa_{HK}} [1 - e^{-\\kappa_{HK} t_n}]\n4187: \n4188: $$\n4189: \n4190: Since $1 - e^{-\\kappa_{HK} t_n} \\leq 1$:\n4191: \n4192: $$\n4193: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK} \\tau}{\\kappa_{HK}}\n4194: \n4195: $$\n4196: \n4197: This completes the proof. $\\square$\n4198: \n4199: **Interpretation:** The theorem establishes exponential decay of the HK distance to the QSD for the discrete-time Fragile Gas dynamics. The steady-state error floor $\\sqrt{C_{HK} \\tau / \\kappa_{HK}}$ depends explicitly on the time step $\\tau$, reflecting the fact that this is a bound for a specific discretization of the underlying continuous dynamics.\n4200: \n4201: **Corollary (Convergence in Metric).** Taking square roots and using the Cauchy-Schwarz inequality:\n4202: \n4203: $$\n4204: d_{HK}(\\mu_t, \\pi_{\\text{QSD}}) \\leq \\sqrt{\\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})]} \\leq e^{-\\kappa_{HK} t/2} d_{HK}(\\mu_0, \\pi_{\\text{QSD}}) + \\sqrt{\\frac{C_{HK} \\tau}{\\kappa_{HK}}}\n4205: \n4206: $$\n4207: \n4208: **Remark on Expectation vs. Realization:** The bound holds for the expectation $\\mathbb{E}[d_{HK}]$ taken over all randomness (cloning selection, Langevin noise, boundary exits). Individual realizations may fluctuate, but concentration inequalities (future work) would bound the deviation from this expected trajectory.\n4209: \n4210: **Steady-State Limit:**\n4211: \n4212: As $t \\to \\infty$, the exponential term vanishes, and:\n4213: \n4214: $$\n4215: \\lim_{t \\to \\infty} \\mathbb{E}[d_{HK}^2(\\mu_t, \\pi_{\\text{QSD}})] \\leq \\frac{C_{HK} \\tau}{\\kappa_{HK}}\n4216: \n4217: $$\n4218: \n4219: This is the **invariant error floor**, determined by the balance between contraction rate $\\kappa_{HK}$ and noise accumulation rate $C_{HK} \\tau$.\n4220: \n4221: **Conclusion of Proof:**\n4222: \n4223: We have proven that for discrete times $t_n = n\\tau$, the Fragile Gas satisfies:\n4224: \n4225: $$\n4226: \\mathbb{E}[d_{HK}^2(\\mu_{t_n}, \\pi_{\\text{QSD}})] \\leq e^{-\\kappa_{HK} t_n} d_{HK}^2(\\mu_0, \\pi_{\\text{QSD}}) + \\frac{C_{HK}(\\tau) \\tau}{\\kappa_{HK}}\n4227: \n4228: $$\n4229: \n4230: with explicit convergence rate $\\kappa_{HK} = \\min(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}) > 0$ and error constant $C_{HK}(\\tau) = C_{\\text{kin}} + C_{\\text{quad}} + C_{\\text{struct}}/\\tau^2$, where:\n4231: - $C_{\\text{kin}}$: kinetic operator BAOAB discretization error\n4232: - $C_{\\text{quad}} = 2(\\lambda_{\\text{struct}} R)^2$: quadratic correction from exponential approximation\n4233: - $C_{\\text{struct}} = C_W + C_{\\text{kin}}\\tau^2$: structural variance noise\n4234: \n4235: This completes the proof of Theorem {prf:ref}`thm-hk-convergence-main-assembly`. $\\square$"
    },
    {
      "directive_type": "theorem",
      "label": "thm-hk-summary",
      "title": "Exponential HK-Convergence (Summary)",
      "start_line": 4452,
      "end_line": 4474,
      "header_lines": [
        4453
      ],
      "content_start": 4455,
      "content_end": 4473,
      "content": "4455: :label: thm-hk-summary\n4456: \n4457: The Fragile Gas converges exponentially fast to its quasi-stationary distribution in the Hellinger-Kantorovich metric:\n4458: \n4459: $$\n4460: d_{HK}(\\mu_t, \\pi_{\\text{QSD}}) \\leq e^{-\\kappa_{HK} t/2} d_{HK}(\\mu_0, \\pi_{\\text{QSD}}) + O\\left(\\sqrt{\\frac{C_{HK}}{\\kappa_{HK}}}\\right)\n4461: \n4462: $$\n4463: \n4464: with explicit rate:\n4465: \n4466: $$\n4467: \\kappa_{HK} = \\min\\left(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}\\right) = \\min\\left(\\min(2(r_* + c_*), \\frac{\\alpha_{\\text{eff}}}{C_{\\text{rev}}(M)}), \\min\\left(\\frac{\\kappa_W}{\\tau}, \\kappa_{\\text{kin}}\\right)\\right) > 0\n4468: \n4469: $$\n4470: \n4471: where:\n4472: - $\\kappa_{\\text{kin}} = \\min(2(r_* + c_*), \\alpha_{\\text{eff}}/C_{\\text{rev}}(M))$ is the kinetic (Hellinger) contraction rate\n4473: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the structural (Wasserstein) contraction rate",
      "metadata": {
        "label": "thm-hk-summary"
      },
      "section": "## 6. Main Theorem: Exponential HK-Convergence of the Fragile Gas",
      "references": [],
      "raw_directive": "4452: We have proven:\n4453: \n4454: :::{prf:theorem} Exponential HK-Convergence (Summary)\n4455: :label: thm-hk-summary\n4456: \n4457: The Fragile Gas converges exponentially fast to its quasi-stationary distribution in the Hellinger-Kantorovich metric:\n4458: \n4459: $$\n4460: d_{HK}(\\mu_t, \\pi_{\\text{QSD}}) \\leq e^{-\\kappa_{HK} t/2} d_{HK}(\\mu_0, \\pi_{\\text{QSD}}) + O\\left(\\sqrt{\\frac{C_{HK}}{\\kappa_{HK}}}\\right)\n4461: \n4462: $$\n4463: \n4464: with explicit rate:\n4465: \n4466: $$\n4467: \\kappa_{HK} = \\min\\left(\\kappa_{\\text{kin}}, \\lambda_{\\text{struct}}\\right) = \\min\\left(\\min(2(r_* + c_*), \\frac{\\alpha_{\\text{eff}}}{C_{\\text{rev}}(M)}), \\min\\left(\\frac{\\kappa_W}{\\tau}, \\kappa_{\\text{kin}}\\right)\\right) > 0\n4468: \n4469: $$\n4470: \n4471: where:\n4472: - $\\kappa_{\\text{kin}} = \\min(2(r_* + c_*), \\alpha_{\\text{eff}}/C_{\\text{rev}}(M))$ is the kinetic (Hellinger) contraction rate\n4473: - $\\lambda_{\\text{struct}} = \\min(\\kappa_W/\\tau, \\kappa_{\\text{kin}})$ is the structural (Wasserstein) contraction rate\n4474: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}