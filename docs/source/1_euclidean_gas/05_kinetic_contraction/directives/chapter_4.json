{
  "chapter_index": 4,
  "section_id": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
  "directive_count": 9,
  "hints": [
    {
      "directive_type": "remark",
      "label": "unlabeled-remark-28",
      "title": "No Convexity Required",
      "start_line": 1339,
      "end_line": 1356,
      "header_lines": [
        1340
      ],
      "content_start": 1342,
      "content_end": 1355,
      "content": "1342: :class: important\n1343: \n1344: **Critical clarification:** The hypocoercive contraction proven in this chapter uses **only**:\n1345: 1. **Coercivity** of $U$ (Axiom 3.3.1) - confinement at infinity\n1346: 2. **Lipschitz continuity** of forces on compact regions\n1347: 3. **Friction-transport coupling** through the hypocoercive norm\n1348: 4. **Non-degenerate noise** (Axiom 3.3.2)\n1349: \n1350: We do **NOT** assume:\n1351: - Convexity of $U$ (monotonicity of forces)\n1352: - Strong convexity (uniform lower bound on $\\nabla^2 U$)\n1353: - Dissipativity outside the boundary\n1354: \n1355: The proof works for **W-shaped potentials**, **multi-well landscapes**, and any coercive potential. The effective contraction rate $\\alpha_{\\text{eff}}$ depends on $\\min(\\gamma, \\alpha_U)$ but not on convexity moduli.",
      "metadata": {
        "class": "important"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1339: This chapter proves that this hypocoercive mechanism contracts the inter-swarm Wasserstein distance $V_W$.\n1340: \n1341: :::{prf:remark} No Convexity Required\n1342: :class: important\n1343: \n1344: **Critical clarification:** The hypocoercive contraction proven in this chapter uses **only**:\n1345: 1. **Coercivity** of $U$ (Axiom 3.3.1) - confinement at infinity\n1346: 2. **Lipschitz continuity** of forces on compact regions\n1347: 3. **Friction-transport coupling** through the hypocoercive norm\n1348: 4. **Non-degenerate noise** (Axiom 3.3.2)\n1349: \n1350: We do **NOT** assume:\n1351: - Convexity of $U$ (monotonicity of forces)\n1352: - Strong convexity (uniform lower bound on $\\nabla^2 U$)\n1353: - Dissipativity outside the boundary\n1354: \n1355: The proof works for **W-shaped potentials**, **multi-well landscapes**, and any coercive potential. The effective contraction rate $\\alpha_{\\text{eff}}$ depends on $\\min(\\gamma, \\alpha_U)$ but not on convexity moduli.\n1356: "
    },
    {
      "directive_type": "definition",
      "label": "def-hypocoercive-norm",
      "title": "The Hypocoercive Norm",
      "start_line": 1362,
      "end_line": 1394,
      "header_lines": [
        1363
      ],
      "content_start": 1365,
      "content_end": 1393,
      "content": "1365: :label: def-hypocoercive-norm\n1366: \n1367: For the coupled swarm state $(S_1, S_2)$, define the **hypocoercive norm squared** on the phase-space difference:\n1368: \n1369: $$\n1370: \\|\\!(\\Delta x, \\Delta v)\\!\\|_h^2 := \\|\\Delta x\\|^2 + \\lambda_v \\|\\Delta v\\|^2 + b \\langle \\Delta x, \\Delta v \\rangle\n1371: \n1372: $$\n1373: \n1374: where:\n1375: - $\\Delta x = x_1 - x_2$: Position difference\n1376: - $\\Delta v = v_1 - v_2$: Velocity difference\n1377: - $\\lambda_v > 0$: Velocity weight (of order $1/\\gamma$)\n1378: - $b \\in \\mathbb{R}$: Coupling coefficient (chosen appropriately)\n1379: \n1380: **For the empirical measures:** The hypocoercive Wasserstein distance is:\n1381: \n1382: $$\n1383: V_W(\\mu_1, \\mu_2) = W_h^2(\\mu_1, \\mu_2)\n1384: \n1385: $$\n1386: \n1387: where $W_h$ is the Wasserstein-2 distance with cost $\\|\\!(\\Delta x, \\Delta v)\\!\\|_h^2$.\n1388: \n1389: **Decomposition (from 03_cloning.md):**\n1390: \n1391: $$\n1392: V_W = V_{\\text{loc}} + V_{\\text{struct}}\n1393: ",
      "metadata": {
        "label": "def-hypocoercive-norm"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1362: To analyze hypocoercivity, we must work with a specially designed norm that couples position and velocity.\n1363: \n1364: :::{prf:definition} The Hypocoercive Norm\n1365: :label: def-hypocoercive-norm\n1366: \n1367: For the coupled swarm state $(S_1, S_2)$, define the **hypocoercive norm squared** on the phase-space difference:\n1368: \n1369: $$\n1370: \\|\\!(\\Delta x, \\Delta v)\\!\\|_h^2 := \\|\\Delta x\\|^2 + \\lambda_v \\|\\Delta v\\|^2 + b \\langle \\Delta x, \\Delta v \\rangle\n1371: \n1372: $$\n1373: \n1374: where:\n1375: - $\\Delta x = x_1 - x_2$: Position difference\n1376: - $\\Delta v = v_1 - v_2$: Velocity difference\n1377: - $\\lambda_v > 0$: Velocity weight (of order $1/\\gamma$)\n1378: - $b \\in \\mathbb{R}$: Coupling coefficient (chosen appropriately)\n1379: \n1380: **For the empirical measures:** The hypocoercive Wasserstein distance is:\n1381: \n1382: $$\n1383: V_W(\\mu_1, \\mu_2) = W_h^2(\\mu_1, \\mu_2)\n1384: \n1385: $$\n1386: \n1387: where $W_h$ is the Wasserstein-2 distance with cost $\\|\\!(\\Delta x, \\Delta v)\\!\\|_h^2$.\n1388: \n1389: **Decomposition (from 03_cloning.md):**\n1390: \n1391: $$\n1392: V_W = V_{\\text{loc}} + V_{\\text{struct}}\n1393: \n1394: $$"
    },
    {
      "directive_type": "remark",
      "label": "rem-coupling-term-intuition",
      "title": "Intuition for the Coupling Term",
      "start_line": 1396,
      "end_line": 1406,
      "header_lines": [
        1397
      ],
      "content_start": 1399,
      "content_end": 1405,
      "content": "1399: :label: rem-coupling-term-intuition\n1400: \n1401: The coupling term $b\\langle \\Delta x, \\Delta v \\rangle$ is the key to hypocoercivity:\n1402: \n1403: - **Without coupling** ($b = 0$): Position and velocity evolve independently in the norm. The degenerate noise in $v$ doesn't help regularize $x$.\n1404: \n1405: - **With coupling** ($b \\neq 0$): The cross term creates a \"rotation\" in the $(x,v)$ phase space. Even though noise only enters in $v$, the coupling allows dissipation to \"leak\" into the $x$ coordinate.",
      "metadata": {
        "label": "rem-coupling-term-intuition"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1396: :::\n1397: \n1398: :::{prf:remark} Intuition for the Coupling Term\n1399: :label: rem-coupling-term-intuition\n1400: \n1401: The coupling term $b\\langle \\Delta x, \\Delta v \\rangle$ is the key to hypocoercivity:\n1402: \n1403: - **Without coupling** ($b = 0$): Position and velocity evolve independently in the norm. The degenerate noise in $v$ doesn't help regularize $x$.\n1404: \n1405: - **With coupling** ($b \\neq 0$): The cross term creates a \"rotation\" in the $(x,v)$ phase space. Even though noise only enters in $v$, the coupling allows dissipation to \"leak\" into the $x$ coordinate.\n1406: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-inter-swarm-contraction-kinetic",
      "title": "Inter-Swarm Error Contraction Under Kinetic Operator",
      "start_line": 1410,
      "end_line": 1445,
      "header_lines": [
        1411
      ],
      "content_start": 1413,
      "content_end": 1444,
      "content": "1413: :label: thm-inter-swarm-contraction-kinetic\n1414: \n1415: Under the axioms of Chapter 3, there exist constants $\\kappa_W > 0$, $C_W' < \\infty$, and hypocoercive parameters $(\\lambda_v, b)$, all independent of $N$, such that:\n1416: \n1417: $$\n1418: \\mathbb{E}_{\\text{kin}}[V_W(S'_1, S'_2) \\mid S_1, S_2] \\leq (1 - \\kappa_W \\tau) V_W(S_1, S_2) + C_W' \\tau\n1419: \n1420: $$\n1421: \n1422: where $\\tau$ is the timestep and $S'_1, S'_2$ are the outputs after the kinetic evolution.\n1423: \n1424: **Equivalently (one-step drift):**\n1425: \n1426: $$\n1427: \\mathbb{E}_{\\text{kin}}[\\Delta V_W] \\leq -\\kappa_W V_W + C_W'\n1428: \n1429: $$\n1430: \n1431: **Key Properties:**\n1432: \n1433: 1. **Contraction rate** $\\kappa_W$ scales as:\n1434:    \n1435: $$\n1436: \\kappa_W \\sim \\min(\\gamma, \\alpha_U, \\sigma_{\\min}^2)\n1437: \n1438: $$\n1439:    where $\\gamma$ is friction, $\\alpha_U$ is the confinement strength, and $\\sigma_{\\min}^2$ is the minimum diffusion eigenvalue.\n1440: \n1441: 2. **Expansion bound** $C_W'$ accounts for:\n1442:    - Bounded noise injection ($\\sim \\sigma_{\\max}^2$)\n1443:    - Status changes (deaths creating divergence)\n1444:    - Boundary effects",
      "metadata": {
        "label": "thm-inter-swarm-contraction-kinetic"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1410: ### 4.3. Main Theorem: Hypocoercive Contraction\n1411: \n1412: :::{prf:theorem} Inter-Swarm Error Contraction Under Kinetic Operator\n1413: :label: thm-inter-swarm-contraction-kinetic\n1414: \n1415: Under the axioms of Chapter 3, there exist constants $\\kappa_W > 0$, $C_W' < \\infty$, and hypocoercive parameters $(\\lambda_v, b)$, all independent of $N$, such that:\n1416: \n1417: $$\n1418: \\mathbb{E}_{\\text{kin}}[V_W(S'_1, S'_2) \\mid S_1, S_2] \\leq (1 - \\kappa_W \\tau) V_W(S_1, S_2) + C_W' \\tau\n1419: \n1420: $$\n1421: \n1422: where $\\tau$ is the timestep and $S'_1, S'_2$ are the outputs after the kinetic evolution.\n1423: \n1424: **Equivalently (one-step drift):**\n1425: \n1426: $$\n1427: \\mathbb{E}_{\\text{kin}}[\\Delta V_W] \\leq -\\kappa_W V_W + C_W'\n1428: \n1429: $$\n1430: \n1431: **Key Properties:**\n1432: \n1433: 1. **Contraction rate** $\\kappa_W$ scales as:\n1434:    \n1435: $$\n1436: \\kappa_W \\sim \\min(\\gamma, \\alpha_U, \\sigma_{\\min}^2)\n1437: \n1438: $$\n1439:    where $\\gamma$ is friction, $\\alpha_U$ is the confinement strength, and $\\sigma_{\\min}^2$ is the minimum diffusion eigenvalue.\n1440: \n1441: 2. **Expansion bound** $C_W'$ accounts for:\n1442:    - Bounded noise injection ($\\sim \\sigma_{\\max}^2$)\n1443:    - Status changes (deaths creating divergence)\n1444:    - Boundary effects\n1445: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-location-error-drift-kinetic",
      "title": "Drift of Location Error Under Kinetics",
      "start_line": 1460,
      "end_line": 1475,
      "header_lines": [
        1461
      ],
      "content_start": 1463,
      "content_end": 1474,
      "content": "1463: :label: lem-location-error-drift-kinetic\n1464: \n1465: The location error $V_{\\text{loc}} = \\|\\Delta\\mu_x\\|^2 + \\lambda_v\\|\\Delta\\mu_v\\|^2 + b\\langle\\Delta\\mu_x, \\Delta\\mu_v\\rangle$ satisfies:\n1466: \n1467: $$\n1468: \\mathbb{E}[\\Delta V_{\\text{loc}}] \\leq -\\left[\\frac{\\alpha_{\\text{eff}}}{2} + \\gamma \\lambda_v - \\frac{b^2}{4\\lambda_v}\\right] V_{\\text{loc}} \\tau + C_{\\text{loc}}' \\tau\n1469: \n1470: $$\n1471: \n1472: where:\n1473: - $\\alpha_{\\text{eff}} = \\alpha_{\\text{eff}}(\\gamma, \\alpha_U, L_F, \\sigma_{\\min})$ is the effective contraction rate from hypocoercivity (not requiring convexity)\n1474: - $C_{\\text{loc}}' = O(\\sigma_{\\max}^2 + n_{\\text{status}})$ accounts for noise and status changes",
      "metadata": {
        "label": "lem-location-error-drift-kinetic"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1460: ### 4.5. Location Error Drift\n1461: \n1462: :::{prf:lemma} Drift of Location Error Under Kinetics\n1463: :label: lem-location-error-drift-kinetic\n1464: \n1465: The location error $V_{\\text{loc}} = \\|\\Delta\\mu_x\\|^2 + \\lambda_v\\|\\Delta\\mu_v\\|^2 + b\\langle\\Delta\\mu_x, \\Delta\\mu_v\\rangle$ satisfies:\n1466: \n1467: $$\n1468: \\mathbb{E}[\\Delta V_{\\text{loc}}] \\leq -\\left[\\frac{\\alpha_{\\text{eff}}}{2} + \\gamma \\lambda_v - \\frac{b^2}{4\\lambda_v}\\right] V_{\\text{loc}} \\tau + C_{\\text{loc}}' \\tau\n1469: \n1470: $$\n1471: \n1472: where:\n1473: - $\\alpha_{\\text{eff}} = \\alpha_{\\text{eff}}(\\gamma, \\alpha_U, L_F, \\sigma_{\\min})$ is the effective contraction rate from hypocoercivity (not requiring convexity)\n1474: - $C_{\\text{loc}}' = O(\\sigma_{\\max}^2 + n_{\\text{status}})$ accounts for noise and status changes\n1475: "
    },
    {
      "directive_type": "proof",
      "label": "def-core-exterior-regions",
      "title": null,
      "start_line": 1477,
      "end_line": 1586,
      "header_lines": [
        1478,
        1567
      ],
      "content_start": 1479,
      "content_end": 1585,
      "content": "1479: :::{prf:proof}\n1480: :label: proof-lem-location-error-drift-kinetic\n1481: **Proof (Drift Matrix Analysis).**\n1482: \n1483: This proof establishes hypocoercive contraction **without assuming convexity** of $U$. Instead, we use:\n1484: 1. **Coercivity** (Axiom 3.3.1): $U$ confines particles to a bounded region\n1485: 2. **Lipschitz forces**: $\\|\\nabla U(x) - \\nabla U(y)\\| \\leq L_F \\|x - y\\|$\n1486: 3. **Coupling between position and velocity** via the drift matrix\n1487: \n1488: **PART I: State Vector and Positive Definite Weight Matrix**\n1489: \n1490: Define the state vector:\n1491: \n1492: $$\n1493: z = \\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} \\in \\mathbb{R}^{2d}\n1494: \n1495: $$\n1496: \n1497: where $\\Delta\\mu_x = \\mu_{x,1} - \\mu_{x,2}$ and $\\Delta\\mu_v = \\mu_{v,1} - \\mu_{v,2}$.\n1498: \n1499: The Lyapunov function is:\n1500: \n1501: $$\n1502: V_{\\text{loc}}(z) = z^T Q z = \\|\\Delta\\mu_x\\|^2 + \\lambda_v \\|\\Delta\\mu_v\\|^2 + b\\langle \\Delta\\mu_x, \\Delta\\mu_v \\rangle\n1503: \n1504: $$\n1505: \n1506: with weight matrix:\n1507: \n1508: $$\n1509: Q = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix}\n1510: \n1511: $$\n1512: \n1513: **Positive definiteness requirement:** $Q \\succ 0$ if and only if $\\lambda_v > b^2/4$ (strict inequality).\n1514: \n1515: **PART II: Linear Dynamics and Drift Matrix**\n1516: \n1517: The barycenter differences evolve (neglecting noise and force terms temporarily) as:\n1518: \n1519: $$\n1520: \\frac{d}{dt}\\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix}\n1521: \n1522: $$\n1523: \n1524: Define the linear dynamics matrix:\n1525: \n1526: $$\n1527: M = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix}\n1528: \n1529: $$\n1530: \n1531: The drift of the quadratic form is:\n1532: \n1533: $$\n1534: \\frac{d}{dt}V_{\\text{loc}} = z^T (M^T Q + QM) z + 2z^T Q \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix} + \\text{(noise)}\n1535: \n1536: $$\n1537: \n1538: **Compute the drift matrix $D = M^T Q + QM$:**\n1539: \n1540: $$\n1541: M^T Q = \\begin{bmatrix} 0 & 0 \\\\ I_d & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ (1 - \\frac{b\\gamma}{2})I_d & (\\frac{b}{2} - \\gamma\\lambda_v)I_d \\end{bmatrix}\n1542: \n1543: $$\n1544: \n1545: $$\n1546: QM = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ 0 & (\\frac{b}{2} - \\gamma\\lambda_v)I_d \\end{bmatrix}\n1547: \n1548: $$\n1549: \n1550: $$\n1551: D = M^T Q + QM = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ (1 - \\frac{b\\gamma}{2})I_d & (b - 2\\gamma\\lambda_v)I_d \\end{bmatrix}\n1552: \n1553: $$\n1554: \n1555: **PART III: Force Contribution (No Convexity Assumption)**\n1556: \n1557: The force difference contributes:\n1558: \n1559: $$\n1560: 2z^T Q \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix} = 2(\\Delta\\mu_x)^T \\frac{b}{2}\\Delta F + 2(\\Delta\\mu_v)^T \\lambda_v \\Delta F\n1561: \n1562: $$\n1563: \n1564: where $\\Delta F = \\frac{1}{N_1}\\sum_{i \\in S_1} F(x_{1,i}) - \\frac{1}{N_2}\\sum_{i \\in S_2} F(x_{2,i})$.\n1565: \n1566: **Key insight:** We do NOT assume $F = -\\nabla U$ is monotone (i.e., convexity of $U$). Instead, we use a **two-region analysis** based on distance from the boundary:\n1567: \n1568: :::{prf:definition} Core and Exterior Regions\n1569: :label: def-core-exterior-regions\n1570: \n1571: For any $\\delta_{\\text{core}} > 0$, define:\n1572: \n1573: **Core Region** (interior domain):\n1574: \n1575: $$\n1576: \\mathcal{R}_{\\text{core}} := \\{x \\in \\mathcal{X}_{\\text{valid}} : \\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) \\geq \\delta_{\\text{core}}\\}\n1577: \n1578: $$\n1579: \n1580: **Exterior Region** (near boundary):\n1581: \n1582: $$\n1583: \\mathcal{R}_{\\text{ext}} := \\mathcal{X}_{\\text{valid}} \\setminus \\mathcal{R}_{\\text{core}} = \\{x \\in \\mathcal{X}_{\\text{valid}} : \\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) < \\delta_{\\text{core}}\\}\n1584: \n1585: $$",
      "metadata": {
        "label": "def-core-exterior-regions"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1477: :::\n1478: \n1479: :::{prf:proof}\n1480: :label: proof-lem-location-error-drift-kinetic\n1481: **Proof (Drift Matrix Analysis).**\n1482: \n1483: This proof establishes hypocoercive contraction **without assuming convexity** of $U$. Instead, we use:\n1484: 1. **Coercivity** (Axiom 3.3.1): $U$ confines particles to a bounded region\n1485: 2. **Lipschitz forces**: $\\|\\nabla U(x) - \\nabla U(y)\\| \\leq L_F \\|x - y\\|$\n1486: 3. **Coupling between position and velocity** via the drift matrix\n1487: \n1488: **PART I: State Vector and Positive Definite Weight Matrix**\n1489: \n1490: Define the state vector:\n1491: \n1492: $$\n1493: z = \\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} \\in \\mathbb{R}^{2d}\n1494: \n1495: $$\n1496: \n1497: where $\\Delta\\mu_x = \\mu_{x,1} - \\mu_{x,2}$ and $\\Delta\\mu_v = \\mu_{v,1} - \\mu_{v,2}$.\n1498: \n1499: The Lyapunov function is:\n1500: \n1501: $$\n1502: V_{\\text{loc}}(z) = z^T Q z = \\|\\Delta\\mu_x\\|^2 + \\lambda_v \\|\\Delta\\mu_v\\|^2 + b\\langle \\Delta\\mu_x, \\Delta\\mu_v \\rangle\n1503: \n1504: $$\n1505: \n1506: with weight matrix:\n1507: \n1508: $$\n1509: Q = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix}\n1510: \n1511: $$\n1512: \n1513: **Positive definiteness requirement:** $Q \\succ 0$ if and only if $\\lambda_v > b^2/4$ (strict inequality).\n1514: \n1515: **PART II: Linear Dynamics and Drift Matrix**\n1516: \n1517: The barycenter differences evolve (neglecting noise and force terms temporarily) as:\n1518: \n1519: $$\n1520: \\frac{d}{dt}\\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix}\n1521: \n1522: $$\n1523: \n1524: Define the linear dynamics matrix:\n1525: \n1526: $$\n1527: M = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix}\n1528: \n1529: $$\n1530: \n1531: The drift of the quadratic form is:\n1532: \n1533: $$\n1534: \\frac{d}{dt}V_{\\text{loc}} = z^T (M^T Q + QM) z + 2z^T Q \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix} + \\text{(noise)}\n1535: \n1536: $$\n1537: \n1538: **Compute the drift matrix $D = M^T Q + QM$:**\n1539: \n1540: $$\n1541: M^T Q = \\begin{bmatrix} 0 & 0 \\\\ I_d & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ (1 - \\frac{b\\gamma}{2})I_d & (\\frac{b}{2} - \\gamma\\lambda_v)I_d \\end{bmatrix}\n1542: \n1543: $$\n1544: \n1545: $$\n1546: QM = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ 0 & (\\frac{b}{2} - \\gamma\\lambda_v)I_d \\end{bmatrix}\n1547: \n1548: $$\n1549: \n1550: $$\n1551: D = M^T Q + QM = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ (1 - \\frac{b\\gamma}{2})I_d & (b - 2\\gamma\\lambda_v)I_d \\end{bmatrix}\n1552: \n1553: $$\n1554: \n1555: **PART III: Force Contribution (No Convexity Assumption)**\n1556: \n1557: The force difference contributes:\n1558: \n1559: $$\n1560: 2z^T Q \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix} = 2(\\Delta\\mu_x)^T \\frac{b}{2}\\Delta F + 2(\\Delta\\mu_v)^T \\lambda_v \\Delta F\n1561: \n1562: $$\n1563: \n1564: where $\\Delta F = \\frac{1}{N_1}\\sum_{i \\in S_1} F(x_{1,i}) - \\frac{1}{N_2}\\sum_{i \\in S_2} F(x_{2,i})$.\n1565: \n1566: **Key insight:** We do NOT assume $F = -\\nabla U$ is monotone (i.e., convexity of $U$). Instead, we use a **two-region analysis** based on distance from the boundary:\n1567: \n1568: :::{prf:definition} Core and Exterior Regions\n1569: :label: def-core-exterior-regions\n1570: \n1571: For any $\\delta_{\\text{core}} > 0$, define:\n1572: \n1573: **Core Region** (interior domain):\n1574: \n1575: $$\n1576: \\mathcal{R}_{\\text{core}} := \\{x \\in \\mathcal{X}_{\\text{valid}} : \\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) \\geq \\delta_{\\text{core}}\\}\n1577: \n1578: $$\n1579: \n1580: **Exterior Region** (near boundary):\n1581: \n1582: $$\n1583: \\mathcal{R}_{\\text{ext}} := \\mathcal{X}_{\\text{valid}} \\setminus \\mathcal{R}_{\\text{core}} = \\{x \\in \\mathcal{X}_{\\text{valid}} : \\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) < \\delta_{\\text{core}}\\}\n1584: \n1585: $$\n1586: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-structural-error-drift-kinetic",
      "title": "Drift of Structural Error Under Kinetics",
      "start_line": 1721,
      "end_line": 1732,
      "header_lines": [
        1722
      ],
      "content_start": 1724,
      "content_end": 1731,
      "content": "1724: :label: lem-structural-error-drift-kinetic\n1725: \n1726: The structural error $V_{\\text{struct}} = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ (Wasserstein distance between centered measures) satisfies:\n1727: \n1728: $$\n1729: \\mathbb{E}[\\Delta V_{\\text{struct}}] \\leq -\\kappa_{\\text{struct}} V_{\\text{struct}} \\tau + C_{\\text{struct}}' \\tau\n1730: \n1731: $$",
      "metadata": {
        "label": "lem-structural-error-drift-kinetic"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1721: ### 4.6. Structural Error Drift\n1722: \n1723: :::{prf:lemma} Drift of Structural Error Under Kinetics\n1724: :label: lem-structural-error-drift-kinetic\n1725: \n1726: The structural error $V_{\\text{struct}} = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ (Wasserstein distance between centered measures) satisfies:\n1727: \n1728: $$\n1729: \\mathbb{E}[\\Delta V_{\\text{struct}}] \\leq -\\kappa_{\\text{struct}} V_{\\text{struct}} \\tau + C_{\\text{struct}}' \\tau\n1730: \n1731: $$\n1732: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-structural-error-drift-kinetic",
      "title": null,
      "start_line": 1734,
      "end_line": 1798,
      "header_lines": [
        1735
      ],
      "content_start": 1736,
      "content_end": 1797,
      "content": "1736: :::{prf:proof}\n1737: :label: proof-lem-structural-error-drift-kinetic\n1738: **Proof (Empirical Measure and Optimal Transport).**\n1739: \n1740: This proof adapts Wasserstein gradient flow theory to **discrete N-particle systems** using empirical measures and optimal transport.\n1741: \n1742: **PART I: Empirical Measure Representation**\n1743: \n1744: For swarm $k$ with $N_k$ particles at positions $\\{x_{k,i}\\}$ and velocities $\\{v_{k,i}\\}$, define the **empirical measure**:\n1745: \n1746: $$\n1747: \\mu_k^N = \\frac{1}{N_k} \\sum_{i=1}^{N_k} \\delta_{(x_{k,i}, v_{k,i})}\n1748: \n1749: $$\n1750: \n1751: This is a probability measure on phase space $\\mathbb{R}^{2d}$ (position + velocity).\n1752: \n1753: **Centered empirical measure:** Shift by the barycenter:\n1754: \n1755: $$\n1756: \\tilde{\\mu}_k^N = \\frac{1}{N_k} \\sum_{i=1}^{N_k} \\delta_{(x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})}\n1757: \n1758: $$\n1759: \n1760: where $\\mu_{x,k} = \\frac{1}{N_k}\\sum_i x_{k,i}$ and $\\mu_{v,k} = \\frac{1}{N_k}\\sum_i v_{k,i}$.\n1761: \n1762: **PART II: Empirical Fokker-Planck Equation**\n1763: \n1764: The empirical measure evolves according to the **empirical Fokker-Planck equation**:\n1765: \n1766: $$\n1767: \\frac{\\partial \\mu_k^N}{\\partial t} = \\sum_{i=1}^{N_k} \\frac{1}{N_k} \\left[\\nabla_{x_i} \\cdot (v_i \\mu_k^N) + \\nabla_{v_i} \\cdot ((F(x_i) - \\gamma v_i) \\mu_k^N) + \\frac{1}{2}\\nabla_{v_i}^2 : (\\Sigma\\Sigma^T \\mu_k^N)\\right]\n1768: \n1769: $$\n1770: \n1771: **Key observation:** This is a sum of $N_k$ **individual Fokker-Planck operators**, each acting on a single Dirac mass.\n1772: \n1773: **PART III: Optimal Transport and Synchronous Coupling**\n1774: \n1775: The Wasserstein-2 distance between centered measures is:\n1776: \n1777: $$\n1778: V_{\\text{struct}} = W_2^2(\\tilde{\\mu}_1^N, \\tilde{\\mu}_2^N)\n1779: \n1780: $$\n1781: \n1782: **Index-matching coupling:** For computational tractability with synchronized swarm dynamics, we use the synchronous coupling where particles are **matched by index**:\n1783: \n1784: $$\n1785: \\pi^N = \\frac{1}{N} \\sum_{i=1}^N \\delta_{(z_{1,i}, z_{2,i})}\n1786: \n1787: $$\n1788: \n1789: where $z_{k,i} = (x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})$ are centered coordinates.\n1790: \n1791: :::{note}\n1792: **On optimality**: The index-matching coupling is generally **suboptimal** for the Wasserstein distance. Computing the true optimal coupling requires solving an assignment problem (e.g., via the Hungarian algorithm). However, for swarms evolved with **synchronized dynamics** (same Brownian motion realization for both swarms), the index-matching coupling becomes natural and provides a **computable upper bound**:\n1793: \n1794: $$\n1795: W_2^2(\\tilde{\\mu}_1^N, \\tilde{\\mu}_2^N) \\leq \\frac{1}{N}\\sum_{i=1}^N \\|z_{1,i} - z_{2,i}\\|_h^2\n1796: \n1797: $$",
      "metadata": {
        "label": "proof-lem-structural-error-drift-kinetic"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1734: :::\n1735: \n1736: :::{prf:proof}\n1737: :label: proof-lem-structural-error-drift-kinetic\n1738: **Proof (Empirical Measure and Optimal Transport).**\n1739: \n1740: This proof adapts Wasserstein gradient flow theory to **discrete N-particle systems** using empirical measures and optimal transport.\n1741: \n1742: **PART I: Empirical Measure Representation**\n1743: \n1744: For swarm $k$ with $N_k$ particles at positions $\\{x_{k,i}\\}$ and velocities $\\{v_{k,i}\\}$, define the **empirical measure**:\n1745: \n1746: $$\n1747: \\mu_k^N = \\frac{1}{N_k} \\sum_{i=1}^{N_k} \\delta_{(x_{k,i}, v_{k,i})}\n1748: \n1749: $$\n1750: \n1751: This is a probability measure on phase space $\\mathbb{R}^{2d}$ (position + velocity).\n1752: \n1753: **Centered empirical measure:** Shift by the barycenter:\n1754: \n1755: $$\n1756: \\tilde{\\mu}_k^N = \\frac{1}{N_k} \\sum_{i=1}^{N_k} \\delta_{(x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})}\n1757: \n1758: $$\n1759: \n1760: where $\\mu_{x,k} = \\frac{1}{N_k}\\sum_i x_{k,i}$ and $\\mu_{v,k} = \\frac{1}{N_k}\\sum_i v_{k,i}$.\n1761: \n1762: **PART II: Empirical Fokker-Planck Equation**\n1763: \n1764: The empirical measure evolves according to the **empirical Fokker-Planck equation**:\n1765: \n1766: $$\n1767: \\frac{\\partial \\mu_k^N}{\\partial t} = \\sum_{i=1}^{N_k} \\frac{1}{N_k} \\left[\\nabla_{x_i} \\cdot (v_i \\mu_k^N) + \\nabla_{v_i} \\cdot ((F(x_i) - \\gamma v_i) \\mu_k^N) + \\frac{1}{2}\\nabla_{v_i}^2 : (\\Sigma\\Sigma^T \\mu_k^N)\\right]\n1768: \n1769: $$\n1770: \n1771: **Key observation:** This is a sum of $N_k$ **individual Fokker-Planck operators**, each acting on a single Dirac mass.\n1772: \n1773: **PART III: Optimal Transport and Synchronous Coupling**\n1774: \n1775: The Wasserstein-2 distance between centered measures is:\n1776: \n1777: $$\n1778: V_{\\text{struct}} = W_2^2(\\tilde{\\mu}_1^N, \\tilde{\\mu}_2^N)\n1779: \n1780: $$\n1781: \n1782: **Index-matching coupling:** For computational tractability with synchronized swarm dynamics, we use the synchronous coupling where particles are **matched by index**:\n1783: \n1784: $$\n1785: \\pi^N = \\frac{1}{N} \\sum_{i=1}^N \\delta_{(z_{1,i}, z_{2,i})}\n1786: \n1787: $$\n1788: \n1789: where $z_{k,i} = (x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})$ are centered coordinates.\n1790: \n1791: :::{note}\n1792: **On optimality**: The index-matching coupling is generally **suboptimal** for the Wasserstein distance. Computing the true optimal coupling requires solving an assignment problem (e.g., via the Hungarian algorithm). However, for swarms evolved with **synchronized dynamics** (same Brownian motion realization for both swarms), the index-matching coupling becomes natural and provides a **computable upper bound**:\n1793: \n1794: $$\n1795: W_2^2(\\tilde{\\mu}_1^N, \\tilde{\\mu}_2^N) \\leq \\frac{1}{N}\\sum_{i=1}^N \\|z_{1,i} - z_{2,i}\\|_h^2\n1796: \n1797: $$\n1798: "
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-inter-swarm-contraction-kinetic",
      "title": null,
      "start_line": 1916,
      "end_line": 1949,
      "header_lines": [
        1917
      ],
      "content_start": 1918,
      "content_end": 1948,
      "content": "1918: :::{prf:proof}\n1919: :label: proof-thm-inter-swarm-contraction-kinetic\n1920: **Proof of Theorem 4.3.1.**\n1921: \n1922: Combine Lemmas 2.5.1 and 2.6.1 using the decomposition $V_W = V_{\\text{loc}} + V_{\\text{struct}}$:\n1923: \n1924: $$\n1925: \\begin{aligned}\n1926: \\mathbb{E}[\\Delta V_W] &= \\mathbb{E}[\\Delta V_{\\text{loc}}] + \\mathbb{E}[\\Delta V_{\\text{struct}}] \\\\\n1927: &\\leq -\\left[\\frac{\\alpha_U}{2} + \\gamma\\lambda_v - \\frac{b^2}{4\\lambda_v}\\right] V_{\\text{loc}} \\tau - \\kappa_{\\text{struct}} V_{\\text{struct}} \\tau + (C_{\\text{loc}}' + C_{\\text{struct}}') \\tau\n1928: \\end{aligned}\n1929: \n1930: $$\n1931: \n1932: Define $\\kappa_W := \\min\\left(\\frac{\\alpha_U}{2} + \\gamma\\lambda_v - \\frac{b^2}{4\\lambda_v}, \\kappa_{\\text{struct}}\\right)$ and $C_W' := C_{\\text{loc}}' + C_{\\text{struct}}'$.\n1933: \n1934: Then:\n1935: \n1936: $$\n1937: \\mathbb{E}[\\Delta V_W] \\leq -\\kappa_W (V_{\\text{loc}} + V_{\\text{struct}}) \\tau + C_W' \\tau = -\\kappa_W V_W \\tau + C_W' \\tau\n1938: \n1939: $$\n1940: \n1941: Rearranging:\n1942: \n1943: $$\n1944: \\mathbb{E}[V_W(S')] \\leq (1 - \\kappa_W \\tau) V_W(S) + C_W' \\tau\n1945: \n1946: $$\n1947: \n1948: **N-uniformity:** All constants depend only on $(\\gamma, \\alpha_U, \\sigma_{\\min}, \\sigma_{\\max}, \\text{domain geometry})$, not on $N$.",
      "metadata": {
        "label": "proof-thm-inter-swarm-contraction-kinetic"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1916: ### 4.7. Proof of Main Theorem\n1917: \n1918: :::{prf:proof}\n1919: :label: proof-thm-inter-swarm-contraction-kinetic\n1920: **Proof of Theorem 4.3.1.**\n1921: \n1922: Combine Lemmas 2.5.1 and 2.6.1 using the decomposition $V_W = V_{\\text{loc}} + V_{\\text{struct}}$:\n1923: \n1924: $$\n1925: \\begin{aligned}\n1926: \\mathbb{E}[\\Delta V_W] &= \\mathbb{E}[\\Delta V_{\\text{loc}}] + \\mathbb{E}[\\Delta V_{\\text{struct}}] \\\\\n1927: &\\leq -\\left[\\frac{\\alpha_U}{2} + \\gamma\\lambda_v - \\frac{b^2}{4\\lambda_v}\\right] V_{\\text{loc}} \\tau - \\kappa_{\\text{struct}} V_{\\text{struct}} \\tau + (C_{\\text{loc}}' + C_{\\text{struct}}') \\tau\n1928: \\end{aligned}\n1929: \n1930: $$\n1931: \n1932: Define $\\kappa_W := \\min\\left(\\frac{\\alpha_U}{2} + \\gamma\\lambda_v - \\frac{b^2}{4\\lambda_v}, \\kappa_{\\text{struct}}\\right)$ and $C_W' := C_{\\text{loc}}' + C_{\\text{struct}}'$.\n1933: \n1934: Then:\n1935: \n1936: $$\n1937: \\mathbb{E}[\\Delta V_W] \\leq -\\kappa_W (V_{\\text{loc}} + V_{\\text{struct}}) \\tau + C_W' \\tau = -\\kappa_W V_W \\tau + C_W' \\tau\n1938: \n1939: $$\n1940: \n1941: Rearranging:\n1942: \n1943: $$\n1944: \\mathbb{E}[V_W(S')] \\leq (1 - \\kappa_W \\tau) V_W(S) + C_W' \\tau\n1945: \n1946: $$\n1947: \n1948: **N-uniformity:** All constants depend only on $(\\gamma, \\alpha_U, \\sigma_{\\min}, \\sigma_{\\max}, \\text{domain geometry})$, not on $N$.\n1949: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}