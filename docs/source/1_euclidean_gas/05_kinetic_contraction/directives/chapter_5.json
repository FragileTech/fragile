{
  "chapter_index": 5,
  "section_id": "## 5. Velocity Variance Dissipation via Langevin Friction",
  "directive_count": 4,
  "hints": [
    {
      "directive_type": "definition",
      "label": "def-velocity-variance-recall",
      "title": "Velocity Variance Component (Recall)",
      "start_line": 1981,
      "end_line": 1994,
      "header_lines": [
        1982
      ],
      "content_start": 1984,
      "content_end": 1993,
      "content": "1984: :label: def-velocity-variance-recall\n1985: \n1986: From 03_cloning.md Definition 3.3.1, the velocity variance component of the Lyapunov function is:\n1987: \n1988: $$\n1989: V_{\\text{Var},v}(S_1, S_2) = \\frac{1}{N}\\sum_{k=1,2} \\sum_{i \\in \\mathcal{A}(S_k)} \\|\\delta_{v,k,i}\\|^2\n1990: \n1991: $$\n1992: \n1993: where $\\delta_{v,k,i} = v_{k,i} - \\mu_{v,k}$ is the centered velocity of walker $i$ in swarm $k$.",
      "metadata": {
        "label": "def-velocity-variance-recall"
      },
      "section": "## 5. Velocity Variance Dissipation via Langevin Friction",
      "raw_directive": "1981: ### 5.2. Velocity Variance Definition (Recall)\n1982: \n1983: :::{prf:definition} Velocity Variance Component (Recall)\n1984: :label: def-velocity-variance-recall\n1985: \n1986: From 03_cloning.md Definition 3.3.1, the velocity variance component of the Lyapunov function is:\n1987: \n1988: $$\n1989: V_{\\text{Var},v}(S_1, S_2) = \\frac{1}{N}\\sum_{k=1,2} \\sum_{i \\in \\mathcal{A}(S_k)} \\|\\delta_{v,k,i}\\|^2\n1990: \n1991: $$\n1992: \n1993: where $\\delta_{v,k,i} = v_{k,i} - \\mu_{v,k}$ is the centered velocity of walker $i$ in swarm $k$.\n1994: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-velocity-variance-contraction-kinetic",
      "title": "Velocity Variance Contraction Under Kinetic Operator",
      "start_line": 1998,
      "end_line": 2021,
      "header_lines": [
        1999
      ],
      "content_start": 2001,
      "content_end": 2020,
      "content": "2001: :label: thm-velocity-variance-contraction-kinetic\n2002: \n2003: Under the axioms of Chapter 3, the velocity variance satisfies:\n2004: \n2005: $$\n2006: \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + \\sigma_{\\max}^2 d \\tau\n2007: \n2008: $$\n2009: \n2010: where:\n2011: - $\\gamma > 0$ is the friction coefficient\n2012: - $\\sigma_{\\max}^2$ is the maximum eigenvalue of $\\Sigma\\Sigma^T$\n2013: - $d$ is the spatial dimension\n2014: \n2015: **Equivalently:**\n2016: \n2017: $$\n2018: \\mathbb{E}_{\\text{kin}}[V_{\\text{Var},v}(S')] \\leq (1 - 2\\gamma\\tau) V_{\\text{Var},v}(S) + \\sigma_{\\max}^2 d \\tau\n2019: \n2020: $$",
      "metadata": {
        "label": "thm-velocity-variance-contraction-kinetic"
      },
      "section": "## 5. Velocity Variance Dissipation via Langevin Friction",
      "raw_directive": "1998: ### 5.3. Main Theorem: Velocity Dissipation\n1999: \n2000: :::{prf:theorem} Velocity Variance Contraction Under Kinetic Operator\n2001: :label: thm-velocity-variance-contraction-kinetic\n2002: \n2003: Under the axioms of Chapter 3, the velocity variance satisfies:\n2004: \n2005: $$\n2006: \\mathbb{E}_{\\text{kin}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + \\sigma_{\\max}^2 d \\tau\n2007: \n2008: $$\n2009: \n2010: where:\n2011: - $\\gamma > 0$ is the friction coefficient\n2012: - $\\sigma_{\\max}^2$ is the maximum eigenvalue of $\\Sigma\\Sigma^T$\n2013: - $d$ is the spatial dimension\n2014: \n2015: **Equivalently:**\n2016: \n2017: $$\n2018: \\mathbb{E}_{\\text{kin}}[V_{\\text{Var},v}(S')] \\leq (1 - 2\\gamma\\tau) V_{\\text{Var},v}(S) + \\sigma_{\\max}^2 d \\tau\n2019: \n2020: $$\n2021: "
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-velocity-variance-contraction-kinetic",
      "title": null,
      "start_line": 2025,
      "end_line": 2285,
      "header_lines": [
        2026
      ],
      "content_start": 2027,
      "content_end": 2284,
      "content": "2027: :::{prf:proof}\n2028: :label: proof-thm-velocity-variance-contraction-kinetic\n2029: **Proof (Complete Algebraic Derivation).**\n2030: \n2031: This proof provides the full algebraic decomposition of velocity variance evolution using It\u00f4's lemma, the parallel axis theorem, and careful bookkeeping.\n2032: \n2033: **PART I: Single-Walker Velocity Evolution**\n2034: \n2035: For walker $i$ with velocity $v_i$, the Langevin equation is:\n2036: \n2037: $$\n2038: dv_i = F(x_i) dt - \\gamma v_i dt + \\Sigma(x_i, v_i) \\circ dW_i\n2039: \n2040: $$\n2041: \n2042: Apply **It\u00f4's lemma** to $\\|v_i\\|^2$:\n2043: \n2044: $$\n2045: d\\|v_i\\|^2 = 2\\langle v_i, dv_i \\rangle + \\|dv_i\\|^2\n2046: \n2047: $$\n2048: \n2049: **Compute the quadratic variation:**\n2050: \n2051: $$\n2052: \\|dv_i\\|^2 = \\|\\Sigma(x_i, v_i) \\circ dW_i\\|^2 = \\text{Tr}(\\Sigma\\Sigma^T) dt \\quad \\text{(It\u00f4 isometry)}\n2053: \n2054: $$\n2055: \n2056: **Substitute dynamics:**\n2057: \n2058: $$\n2059: d\\|v_i\\|^2 = 2\\langle v_i, F(x_i) - \\gamma v_i \\rangle dt + \\text{Tr}(\\Sigma\\Sigma^T) dt + 2\\langle v_i, \\Sigma dW_i \\rangle\n2060: \n2061: $$\n2062: \n2063: $$\n2064: = 2\\langle v_i, F(x_i) \\rangle dt - 2\\gamma \\|v_i\\|^2 dt + \\text{Tr}(\\Sigma\\Sigma^T) dt + 2\\langle v_i, \\Sigma dW_i \\rangle\n2065: \n2066: $$\n2067: \n2068: **Take expectations (martingale term vanishes):**\n2069: \n2070: $$\n2071: \\mathbb{E}[d\\|v_i\\|^2] = 2\\mathbb{E}[\\langle v_i, F(x_i) \\rangle] dt - 2\\gamma \\mathbb{E}[\\|v_i\\|^2] dt + \\mathbb{E}[\\text{Tr}(\\Sigma\\Sigma^T)] dt\n2072: \n2073: $$\n2074: \n2075: **PART II: Barycenter Velocity Evolution**\n2076: \n2077: For swarm $k$ with $N_k$ alive walkers, the barycenter velocity is:\n2078: \n2079: $$\n2080: \\mu_{v,k} = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} v_{k,i}\n2081: \n2082: $$\n2083: \n2084: Apply It\u00f4's lemma to $\\|\\mu_{v,k}\\|^2$:\n2085: \n2086: $$\n2087: d\\|\\mu_{v,k}\\|^2 = 2\\langle \\mu_{v,k}, d\\mu_{v,k} \\rangle + \\|d\\mu_{v,k}\\|^2\n2088: \n2089: $$\n2090: \n2091: **Barycenter evolution:**\n2092: \n2093: $$\n2094: d\\mu_{v,k} = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} dv_{k,i}\n2095: \n2096: $$\n2097: \n2098: $$\n2099: = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\Sigma(x_{k,i}, v_{k,i}) \\circ dW_i\n2100: \n2101: $$\n2102: \n2103: **Quadratic variation of barycenter:**\n2104: \n2105: $$\n2106: \\|d\\mu_{v,k}\\|^2 = \\left\\|\\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\Sigma dW_i\\right\\|^2 = \\frac{1}{N_k^2}\\sum_{i \\in \\mathcal{A}(S_k)} \\text{Tr}(\\Sigma_i\\Sigma_i^T) dt\n2107: \n2108: $$\n2109: \n2110: $$\n2111: \\leq \\frac{1}{N_k} \\sigma_{\\max}^2 d \\, dt\n2112: \n2113: $$\n2114: \n2115: **PART III: Parallel Axis Theorem (Sample Decomposition)**\n2116: \n2117: For any finite sample of vectors $\\{v_i\\}_{i=1}^N$ with sample mean $\\mu_v = \\frac{1}{N}\\sum_{i=1}^N v_i$:\n2118: \n2119: $$\n2120: \\frac{1}{N}\\sum_{i=1}^N \\|v_i\\|^2 = \\frac{1}{N}\\sum_{i=1}^N \\|v_i - \\mu_v\\|^2 + \\|\\mu_v\\|^2\n2121: \n2122: $$\n2123: \n2124: where the left-hand side is the **mean of squared norms**, the first term on the right is the **sample variance**, and the second term is the **squared sample mean**.\n2125: \n2126: **Rearranging:**\n2127: \n2128: $$\n2129: \\text{Var}(v) := \\frac{1}{N}\\sum_{i=1}^N \\|v_i - \\mu_v\\|^2 = \\frac{1}{N}\\sum_{i=1}^N \\|v_i\\|^2 - \\|\\mu_v\\|^2\n2130: \n2131: $$\n2132: \n2133: (\u2713 sympy-verified: `src/proofs/05_kinetic_contraction/test_parallel_axis_theorem.py::test_parallel_axis_theorem`)\n2134: \n2135: **PART IV: Variance Evolution for Single Swarm**\n2136: \n2137: For swarm $k$:\n2138: \n2139: $$\n2140: \\frac{d}{dt}\\text{Var}_k(v) = \\frac{d}{dt}\\left[\\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\|v_{k,i}\\|^2 - \\|\\mu_{v,k}\\|^2\\right]\n2141: \n2142: $$\n2143: \n2144: $$\n2145: = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\frac{d}{dt}\\mathbb{E}[\\|v_{k,i}\\|^2] - \\frac{d}{dt}\\mathbb{E}[\\|\\mu_{v,k}\\|^2]\n2146: \n2147: $$\n2148: \n2149: **From Part I:**\n2150: \n2151: $$\n2152: \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\frac{d}{dt}\\mathbb{E}[\\|v_{k,i}\\|^2] = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i}, F(x_{k,i}) \\rangle] - 2\\gamma \\frac{1}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i}\\|^2] + d\\sigma_{\\max}^2\n2153: \n2154: $$\n2155: \n2156: **From Part II:**\n2157: \n2158: $$\n2159: \\frac{d}{dt}\\mathbb{E}[\\|\\mu_{v,k}\\|^2] = 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} - \\gamma\\mu_{v,k} \\rangle] + O(1/N_k)\n2160: \n2161: $$\n2162: \n2163: where $F_{\\text{avg},k} = \\frac{1}{N_k}\\sum_i F(x_{k,i})$.\n2164: \n2165: **Key cancellation:** The force terms largely cancel when we subtract. The residual force-work term is:\n2166: \n2167: $$\n2168: \\Delta_{\\text{force}} := \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i}, F(x_{k,i}) \\rangle] - 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle]\n2169: \n2170: $$\n2171: \n2172: Expanding with $v_{k,i} = \\mu_{v,k} + (v_{k,i} - \\mu_{v,k})$:\n2173: \n2174: $$\n2175: = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i} - \\mu_{v,k}, F(x_{k,i}) \\rangle] + \\underbrace{2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle] - 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle]}_{=0}\n2176: \n2177: $$\n2178: \n2179: $$\n2180: = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i} - \\mu_{v,k}, F(x_{k,i}) \\rangle]\n2181: \n2182: $$\n2183: \n2184: **Quantitative bound via Cauchy-Schwarz:**\n2185: \n2186: $$\n2187: |\\Delta_{\\text{force}}| \\leq \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i} - \\mu_{v,k}\\| \\cdot \\|F(x_{k,i})\\|]\n2188: \n2189: $$\n2190: \n2191: By Axiom 3.3.3 (bounded forces): $\\|F(x)\\| \\leq F_{\\max}$ for $x$ in the interior. Thus:\n2192: \n2193: $$\n2194: \\leq \\frac{2F_{\\max}}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i} - \\mu_{v,k}\\|]\n2195: \n2196: $$\n2197: \n2198: By **Jensen's inequality**: $\\mathbb{E}[\\|v - \\mu_v\\|] \\leq \\sqrt{\\mathbb{E}[\\|v - \\mu_v\\|^2]}$. Therefore:\n2199: \n2200: $$\n2201: \\leq 2F_{\\max} \\sqrt{\\text{Var}_k(v)}\n2202: \n2203: $$\n2204: \n2205: **Sub-leading verification:** Compared to the friction term $-2\\gamma \\text{Var}_k(v)$, the force-work term has ratio:\n2206: \n2207: $$\n2208: \\frac{|\\Delta_{\\text{force}}|}{2\\gamma \\text{Var}_k(v)} \\leq \\frac{2F_{\\max} \\sqrt{\\text{Var}_k(v)}}{2\\gamma \\text{Var}_k(v)} = \\frac{F_{\\max}}{\\gamma \\sqrt{\\text{Var}_k(v)}} \\to 0 \\quad \\text{as } \\text{Var}_k(v) \\to \\infty\n2209: \n2210: $$\n2211: \n2212: Thus, for large velocity variance (which is when contraction is needed), the force-work term is **negligible** compared to friction dissipation.\n2213: \n2214: **Dominant contribution (neglecting sub-leading force-work term):**\n2215: \n2216: $$\n2217: \\frac{d}{dt}\\mathbb{E}[\\text{Var}_k(v)] \\leq -2\\gamma \\text{Var}_k(v) + 2F_{\\max}\\sqrt{\\text{Var}_k(v)} + d\\sigma_{\\max}^2\n2218: \n2219: $$\n2220: \n2221: For practical bounds, absorb the $\\sqrt{\\text{Var}}$ term into the constant:\n2222: \n2223: $$\n2224: \\approx -2\\gamma \\text{Var}_k(v) + d\\sigma_{\\max}^2 + C_{\\text{force}}\n2225: \n2226: $$\n2227: \n2228: where $C_{\\text{force}} = O(F_{\\max})$ accounts for the residual force-work contribution at equilibrium.\n2229: \n2230: **PART V: Aggregate Over Both Swarms**\n2231: \n2232: The total velocity variance is:\n2233: \n2234: $$\n2235: V_{\\text{Var},v} = \\frac{1}{2}\\sum_{k=1,2} \\text{Var}_k(v)\n2236: \n2237: $$\n2238: \n2239: Summing:\n2240: \n2241: $$\n2242: \\frac{d}{dt}\\mathbb{E}[V_{\\text{Var},v}] = \\frac{1}{2}\\sum_{k=1,2} \\frac{d}{dt}\\mathbb{E}[\\text{Var}_k(v)]\n2243: \n2244: $$\n2245: \n2246: $$\n2247: \\leq \\frac{1}{2}\\sum_{k=1,2} [-2\\gamma \\text{Var}_k(v) + d\\sigma_{\\max}^2]\n2248: \n2249: $$\n2250: \n2251: $$\n2252: = -2\\gamma V_{\\text{Var},v} + d\\sigma_{\\max}^2\n2253: \n2254: $$\n2255: \n2256: **PART VI: Discrete-Time Version**\n2257: \n2258: Apply Theorem 3.7.2 (BAOAB weak error) to obtain the discrete-time inequality:\n2259: \n2260: $$\n2261: \\mathbb{E}[\\Delta V_{\\text{Var},v}] = \\mathbb{E}[V_{\\text{Var},v}(t+\\tau) - V_{\\text{Var},v}(t)]\n2262: \n2263: $$\n2264: \n2265: $$\n2266: \\leq -2\\gamma V_{\\text{Var},v}(t) \\tau + d\\sigma_{\\max}^2 \\tau + O(\\tau^2)\n2267: \n2268: $$\n2269: \n2270: For sufficiently small $\\tau$, absorb $O(\\tau^2)$ into the constant term:\n2271: \n2272: $$\n2273: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + d\\sigma_{\\max}^2 \\tau\n2274: \n2275: $$\n2276: \n2277: **PART VII: Physical Interpretation**\n2278: \n2279: This result shows:\n2280: 1. **Contraction:** Friction dissipates velocity variance at rate $2\\gamma$ (twice the friction coefficient due to quadratic dependence)\n2281: 2. **Expansion:** Thermal noise adds variance at rate $d\\sigma_{\\max}^2$ (proportional to dimension and noise strength)\n2282: 3. **Equilibrium:** When $V_{\\text{Var},v} \\to V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$, the two terms balance (equipartition)\n2283: \n2284: **Key property:** The contraction rate $-2\\gamma$ is **independent of system size** $N$ or state - it's a fundamental property of Langevin dynamics.",
      "metadata": {
        "label": "proof-thm-velocity-variance-contraction-kinetic"
      },
      "section": "## 5. Velocity Variance Dissipation via Langevin Friction",
      "raw_directive": "2025: ### 5.4. Proof\n2026: \n2027: :::{prf:proof}\n2028: :label: proof-thm-velocity-variance-contraction-kinetic\n2029: **Proof (Complete Algebraic Derivation).**\n2030: \n2031: This proof provides the full algebraic decomposition of velocity variance evolution using It\u00f4's lemma, the parallel axis theorem, and careful bookkeeping.\n2032: \n2033: **PART I: Single-Walker Velocity Evolution**\n2034: \n2035: For walker $i$ with velocity $v_i$, the Langevin equation is:\n2036: \n2037: $$\n2038: dv_i = F(x_i) dt - \\gamma v_i dt + \\Sigma(x_i, v_i) \\circ dW_i\n2039: \n2040: $$\n2041: \n2042: Apply **It\u00f4's lemma** to $\\|v_i\\|^2$:\n2043: \n2044: $$\n2045: d\\|v_i\\|^2 = 2\\langle v_i, dv_i \\rangle + \\|dv_i\\|^2\n2046: \n2047: $$\n2048: \n2049: **Compute the quadratic variation:**\n2050: \n2051: $$\n2052: \\|dv_i\\|^2 = \\|\\Sigma(x_i, v_i) \\circ dW_i\\|^2 = \\text{Tr}(\\Sigma\\Sigma^T) dt \\quad \\text{(It\u00f4 isometry)}\n2053: \n2054: $$\n2055: \n2056: **Substitute dynamics:**\n2057: \n2058: $$\n2059: d\\|v_i\\|^2 = 2\\langle v_i, F(x_i) - \\gamma v_i \\rangle dt + \\text{Tr}(\\Sigma\\Sigma^T) dt + 2\\langle v_i, \\Sigma dW_i \\rangle\n2060: \n2061: $$\n2062: \n2063: $$\n2064: = 2\\langle v_i, F(x_i) \\rangle dt - 2\\gamma \\|v_i\\|^2 dt + \\text{Tr}(\\Sigma\\Sigma^T) dt + 2\\langle v_i, \\Sigma dW_i \\rangle\n2065: \n2066: $$\n2067: \n2068: **Take expectations (martingale term vanishes):**\n2069: \n2070: $$\n2071: \\mathbb{E}[d\\|v_i\\|^2] = 2\\mathbb{E}[\\langle v_i, F(x_i) \\rangle] dt - 2\\gamma \\mathbb{E}[\\|v_i\\|^2] dt + \\mathbb{E}[\\text{Tr}(\\Sigma\\Sigma^T)] dt\n2072: \n2073: $$\n2074: \n2075: **PART II: Barycenter Velocity Evolution**\n2076: \n2077: For swarm $k$ with $N_k$ alive walkers, the barycenter velocity is:\n2078: \n2079: $$\n2080: \\mu_{v,k} = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} v_{k,i}\n2081: \n2082: $$\n2083: \n2084: Apply It\u00f4's lemma to $\\|\\mu_{v,k}\\|^2$:\n2085: \n2086: $$\n2087: d\\|\\mu_{v,k}\\|^2 = 2\\langle \\mu_{v,k}, d\\mu_{v,k} \\rangle + \\|d\\mu_{v,k}\\|^2\n2088: \n2089: $$\n2090: \n2091: **Barycenter evolution:**\n2092: \n2093: $$\n2094: d\\mu_{v,k} = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} dv_{k,i}\n2095: \n2096: $$\n2097: \n2098: $$\n2099: = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\Sigma(x_{k,i}, v_{k,i}) \\circ dW_i\n2100: \n2101: $$\n2102: \n2103: **Quadratic variation of barycenter:**\n2104: \n2105: $$\n2106: \\|d\\mu_{v,k}\\|^2 = \\left\\|\\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\Sigma dW_i\\right\\|^2 = \\frac{1}{N_k^2}\\sum_{i \\in \\mathcal{A}(S_k)} \\text{Tr}(\\Sigma_i\\Sigma_i^T) dt\n2107: \n2108: $$\n2109: \n2110: $$\n2111: \\leq \\frac{1}{N_k} \\sigma_{\\max}^2 d \\, dt\n2112: \n2113: $$\n2114: \n2115: **PART III: Parallel Axis Theorem (Sample Decomposition)**\n2116: \n2117: For any finite sample of vectors $\\{v_i\\}_{i=1}^N$ with sample mean $\\mu_v = \\frac{1}{N}\\sum_{i=1}^N v_i$:\n2118: \n2119: $$\n2120: \\frac{1}{N}\\sum_{i=1}^N \\|v_i\\|^2 = \\frac{1}{N}\\sum_{i=1}^N \\|v_i - \\mu_v\\|^2 + \\|\\mu_v\\|^2\n2121: \n2122: $$\n2123: \n2124: where the left-hand side is the **mean of squared norms**, the first term on the right is the **sample variance**, and the second term is the **squared sample mean**.\n2125: \n2126: **Rearranging:**\n2127: \n2128: $$\n2129: \\text{Var}(v) := \\frac{1}{N}\\sum_{i=1}^N \\|v_i - \\mu_v\\|^2 = \\frac{1}{N}\\sum_{i=1}^N \\|v_i\\|^2 - \\|\\mu_v\\|^2\n2130: \n2131: $$\n2132: \n2133: (\u2713 sympy-verified: `src/proofs/05_kinetic_contraction/test_parallel_axis_theorem.py::test_parallel_axis_theorem`)\n2134: \n2135: **PART IV: Variance Evolution for Single Swarm**\n2136: \n2137: For swarm $k$:\n2138: \n2139: $$\n2140: \\frac{d}{dt}\\text{Var}_k(v) = \\frac{d}{dt}\\left[\\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\|v_{k,i}\\|^2 - \\|\\mu_{v,k}\\|^2\\right]\n2141: \n2142: $$\n2143: \n2144: $$\n2145: = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\frac{d}{dt}\\mathbb{E}[\\|v_{k,i}\\|^2] - \\frac{d}{dt}\\mathbb{E}[\\|\\mu_{v,k}\\|^2]\n2146: \n2147: $$\n2148: \n2149: **From Part I:**\n2150: \n2151: $$\n2152: \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\frac{d}{dt}\\mathbb{E}[\\|v_{k,i}\\|^2] = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i}, F(x_{k,i}) \\rangle] - 2\\gamma \\frac{1}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i}\\|^2] + d\\sigma_{\\max}^2\n2153: \n2154: $$\n2155: \n2156: **From Part II:**\n2157: \n2158: $$\n2159: \\frac{d}{dt}\\mathbb{E}[\\|\\mu_{v,k}\\|^2] = 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} - \\gamma\\mu_{v,k} \\rangle] + O(1/N_k)\n2160: \n2161: $$\n2162: \n2163: where $F_{\\text{avg},k} = \\frac{1}{N_k}\\sum_i F(x_{k,i})$.\n2164: \n2165: **Key cancellation:** The force terms largely cancel when we subtract. The residual force-work term is:\n2166: \n2167: $$\n2168: \\Delta_{\\text{force}} := \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i}, F(x_{k,i}) \\rangle] - 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle]\n2169: \n2170: $$\n2171: \n2172: Expanding with $v_{k,i} = \\mu_{v,k} + (v_{k,i} - \\mu_{v,k})$:\n2173: \n2174: $$\n2175: = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i} - \\mu_{v,k}, F(x_{k,i}) \\rangle] + \\underbrace{2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle] - 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle]}_{=0}\n2176: \n2177: $$\n2178: \n2179: $$\n2180: = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i} - \\mu_{v,k}, F(x_{k,i}) \\rangle]\n2181: \n2182: $$\n2183: \n2184: **Quantitative bound via Cauchy-Schwarz:**\n2185: \n2186: $$\n2187: |\\Delta_{\\text{force}}| \\leq \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i} - \\mu_{v,k}\\| \\cdot \\|F(x_{k,i})\\|]\n2188: \n2189: $$\n2190: \n2191: By Axiom 3.3.3 (bounded forces): $\\|F(x)\\| \\leq F_{\\max}$ for $x$ in the interior. Thus:\n2192: \n2193: $$\n2194: \\leq \\frac{2F_{\\max}}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i} - \\mu_{v,k}\\|]\n2195: \n2196: $$\n2197: \n2198: By **Jensen's inequality**: $\\mathbb{E}[\\|v - \\mu_v\\|] \\leq \\sqrt{\\mathbb{E}[\\|v - \\mu_v\\|^2]}$. Therefore:\n2199: \n2200: $$\n2201: \\leq 2F_{\\max} \\sqrt{\\text{Var}_k(v)}\n2202: \n2203: $$\n2204: \n2205: **Sub-leading verification:** Compared to the friction term $-2\\gamma \\text{Var}_k(v)$, the force-work term has ratio:\n2206: \n2207: $$\n2208: \\frac{|\\Delta_{\\text{force}}|}{2\\gamma \\text{Var}_k(v)} \\leq \\frac{2F_{\\max} \\sqrt{\\text{Var}_k(v)}}{2\\gamma \\text{Var}_k(v)} = \\frac{F_{\\max}}{\\gamma \\sqrt{\\text{Var}_k(v)}} \\to 0 \\quad \\text{as } \\text{Var}_k(v) \\to \\infty\n2209: \n2210: $$\n2211: \n2212: Thus, for large velocity variance (which is when contraction is needed), the force-work term is **negligible** compared to friction dissipation.\n2213: \n2214: **Dominant contribution (neglecting sub-leading force-work term):**\n2215: \n2216: $$\n2217: \\frac{d}{dt}\\mathbb{E}[\\text{Var}_k(v)] \\leq -2\\gamma \\text{Var}_k(v) + 2F_{\\max}\\sqrt{\\text{Var}_k(v)} + d\\sigma_{\\max}^2\n2218: \n2219: $$\n2220: \n2221: For practical bounds, absorb the $\\sqrt{\\text{Var}}$ term into the constant:\n2222: \n2223: $$\n2224: \\approx -2\\gamma \\text{Var}_k(v) + d\\sigma_{\\max}^2 + C_{\\text{force}}\n2225: \n2226: $$\n2227: \n2228: where $C_{\\text{force}} = O(F_{\\max})$ accounts for the residual force-work contribution at equilibrium.\n2229: \n2230: **PART V: Aggregate Over Both Swarms**\n2231: \n2232: The total velocity variance is:\n2233: \n2234: $$\n2235: V_{\\text{Var},v} = \\frac{1}{2}\\sum_{k=1,2} \\text{Var}_k(v)\n2236: \n2237: $$\n2238: \n2239: Summing:\n2240: \n2241: $$\n2242: \\frac{d}{dt}\\mathbb{E}[V_{\\text{Var},v}] = \\frac{1}{2}\\sum_{k=1,2} \\frac{d}{dt}\\mathbb{E}[\\text{Var}_k(v)]\n2243: \n2244: $$\n2245: \n2246: $$\n2247: \\leq \\frac{1}{2}\\sum_{k=1,2} [-2\\gamma \\text{Var}_k(v) + d\\sigma_{\\max}^2]\n2248: \n2249: $$\n2250: \n2251: $$\n2252: = -2\\gamma V_{\\text{Var},v} + d\\sigma_{\\max}^2\n2253: \n2254: $$\n2255: \n2256: **PART VI: Discrete-Time Version**\n2257: \n2258: Apply Theorem 3.7.2 (BAOAB weak error) to obtain the discrete-time inequality:\n2259: \n2260: $$\n2261: \\mathbb{E}[\\Delta V_{\\text{Var},v}] = \\mathbb{E}[V_{\\text{Var},v}(t+\\tau) - V_{\\text{Var},v}(t)]\n2262: \n2263: $$\n2264: \n2265: $$\n2266: \\leq -2\\gamma V_{\\text{Var},v}(t) \\tau + d\\sigma_{\\max}^2 \\tau + O(\\tau^2)\n2267: \n2268: $$\n2269: \n2270: For sufficiently small $\\tau$, absorb $O(\\tau^2)$ into the constant term:\n2271: \n2272: $$\n2273: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + d\\sigma_{\\max}^2 \\tau\n2274: \n2275: $$\n2276: \n2277: **PART VII: Physical Interpretation**\n2278: \n2279: This result shows:\n2280: 1. **Contraction:** Friction dissipates velocity variance at rate $2\\gamma$ (twice the friction coefficient due to quadratic dependence)\n2281: 2. **Expansion:** Thermal noise adds variance at rate $d\\sigma_{\\max}^2$ (proportional to dimension and noise strength)\n2282: 3. **Equilibrium:** When $V_{\\text{Var},v} \\to V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$, the two terms balance (equipartition)\n2283: \n2284: **Key property:** The contraction rate $-2\\gamma$ is **independent of system size** $N$ or state - it's a fundamental property of Langevin dynamics.\n2285: "
    },
    {
      "directive_type": "corollary",
      "label": "cor-net-velocity-contraction",
      "title": "Net Velocity Variance Contraction for Composed Operator",
      "start_line": 2289,
      "end_line": 2332,
      "header_lines": [
        2290
      ],
      "content_start": 2292,
      "content_end": 2331,
      "content": "2292: :label: cor-net-velocity-contraction\n2293: \n2294: From 03_cloning.md, the cloning operator satisfies:\n2295: \n2296: $$\n2297: \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] \\leq C_v\n2298: \n2299: $$\n2300: \n2301: Combining with the kinetic dissipation:\n2302: \n2303: $$\n2304: \\mathbb{E}_{\\text{clone} \\circ \\text{kin}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + (d\\sigma_{\\max}^2 \\tau + C_v)\n2305: \n2306: $$\n2307: \n2308: **For net contraction, we need:**\n2309: \n2310: $$\n2311: 2\\gamma V_{\\text{Var},v} \\tau > d\\sigma_{\\max}^2 \\tau + C_v\n2312: \n2313: $$\n2314: \n2315: **This holds when:**\n2316: \n2317: $$\n2318: V_{\\text{Var},v} > \\frac{d\\sigma_{\\max}^2}{2\\gamma} + \\frac{C_v}{2\\gamma\\tau}\n2319: \n2320: $$\n2321: \n2322: **Equilibrium bound:**\n2323: At equilibrium where $\\mathbb{E}[\\Delta V_{\\text{Var},v}] = 0$:\n2324: \n2325: $$\n2326: V_{\\text{Var},v}^{\\text{eq}} \\approx \\frac{d\\sigma_{\\max}^2}{2\\gamma} + \\frac{C_v}{2\\gamma\\tau}\n2327: \n2328: $$\n2329: \n2330: **Interpretation:** The equilibrium velocity variance is determined by the balance between:\n2331: - Thermal noise injection ($\\sigma_{\\max}^2$)",
      "metadata": {
        "label": "cor-net-velocity-contraction"
      },
      "section": "## 5. Velocity Variance Dissipation via Langevin Friction",
      "raw_directive": "2289: ### 5.5. Balancing with Cloning Expansion\n2290: \n2291: :::{prf:corollary} Net Velocity Variance Contraction for Composed Operator\n2292: :label: cor-net-velocity-contraction\n2293: \n2294: From 03_cloning.md, the cloning operator satisfies:\n2295: \n2296: $$\n2297: \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},v}] \\leq C_v\n2298: \n2299: $$\n2300: \n2301: Combining with the kinetic dissipation:\n2302: \n2303: $$\n2304: \\mathbb{E}_{\\text{clone} \\circ \\text{kin}}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + (d\\sigma_{\\max}^2 \\tau + C_v)\n2305: \n2306: $$\n2307: \n2308: **For net contraction, we need:**\n2309: \n2310: $$\n2311: 2\\gamma V_{\\text{Var},v} \\tau > d\\sigma_{\\max}^2 \\tau + C_v\n2312: \n2313: $$\n2314: \n2315: **This holds when:**\n2316: \n2317: $$\n2318: V_{\\text{Var},v} > \\frac{d\\sigma_{\\max}^2}{2\\gamma} + \\frac{C_v}{2\\gamma\\tau}\n2319: \n2320: $$\n2321: \n2322: **Equilibrium bound:**\n2323: At equilibrium where $\\mathbb{E}[\\Delta V_{\\text{Var},v}] = 0$:\n2324: \n2325: $$\n2326: V_{\\text{Var},v}^{\\text{eq}} \\approx \\frac{d\\sigma_{\\max}^2}{2\\gamma} + \\frac{C_v}{2\\gamma\\tau}\n2327: \n2328: $$\n2329: \n2330: **Interpretation:** The equilibrium velocity variance is determined by the balance between:\n2331: - Thermal noise injection ($\\sigma_{\\max}^2$)\n2332: - Friction dissipation ($\\gamma$)"
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}