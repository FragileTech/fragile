{
  "document_id": "05_kinetic_contraction",
  "stage": "directives",
  "directive_type": "proof",
  "generated_at": "2025-11-08T17:16:20.148492+00:00",
  "count": 7,
  "items": [
    {
      "directive_type": "proof",
      "label": "proof-prop-fokker-planck-kinetic",
      "title": null,
      "start_line": 449,
      "end_line": 461,
      "header_lines": [
        450
      ],
      "content_start": 451,
      "content_end": 460,
      "content": "451: :::{prf:proof}\n452: :label: proof-prop-fokker-planck-kinetic\n453: **Proof.**\n454: \n455: This follows from standard SDE theory. For Stratonovich SDEs, the Fokker-Planck equation is derived by:\n456: \n457: 1. Converting to Itô form (adding the Stratonovich correction)\n458: 2. Applying the Itô-to-Fokker-Planck correspondence\n459: \n460: For our isotropic case where Stratonovich = Itô, the derivation is immediate from Itô's lemma applied to test functions.",
      "metadata": {
        "label": "proof-prop-fokker-planck-kinetic"
      },
      "section": "## 3. The Kinetic Operator with Stratonovich Formulation",
      "raw_directive": "449: :::\n450: \n451: :::{prf:proof}\n452: :label: proof-prop-fokker-planck-kinetic\n453: **Proof.**\n454: \n455: This follows from standard SDE theory. For Stratonovich SDEs, the Fokker-Planck equation is derived by:\n456: \n457: 1. Converting to Itô form (adding the Stratonovich correction)\n458: 2. Applying the Itô-to-Fokker-Planck correspondence\n459: \n460: For our isotropic case where Stratonovich = Itô, the derivation is immediate from Itô's lemma applied to test functions.\n461: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_kinetic_contraction",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. The Kinetic Operator with Stratonovich Formulation"
      }
    },
    {
      "directive_type": "proof",
      "label": "def-core-exterior-regions",
      "title": null,
      "start_line": 1477,
      "end_line": 1586,
      "header_lines": [
        1478,
        1567
      ],
      "content_start": 1479,
      "content_end": 1585,
      "content": "1479: :::{prf:proof}\n1480: :label: proof-lem-location-error-drift-kinetic\n1481: **Proof (Drift Matrix Analysis).**\n1482: \n1483: This proof establishes hypocoercive contraction **without assuming convexity** of $U$. Instead, we use:\n1484: 1. **Coercivity** (Axiom 3.3.1): $U$ confines particles to a bounded region\n1485: 2. **Lipschitz forces**: $\\|\\nabla U(x) - \\nabla U(y)\\| \\leq L_F \\|x - y\\|$\n1486: 3. **Coupling between position and velocity** via the drift matrix\n1487: \n1488: **PART I: State Vector and Positive Definite Weight Matrix**\n1489: \n1490: Define the state vector:\n1491: \n1492: $$\n1493: z = \\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} \\in \\mathbb{R}^{2d}\n1494: \n1495: $$\n1496: \n1497: where $\\Delta\\mu_x = \\mu_{x,1} - \\mu_{x,2}$ and $\\Delta\\mu_v = \\mu_{v,1} - \\mu_{v,2}$.\n1498: \n1499: The Lyapunov function is:\n1500: \n1501: $$\n1502: V_{\\text{loc}}(z) = z^T Q z = \\|\\Delta\\mu_x\\|^2 + \\lambda_v \\|\\Delta\\mu_v\\|^2 + b\\langle \\Delta\\mu_x, \\Delta\\mu_v \\rangle\n1503: \n1504: $$\n1505: \n1506: with weight matrix:\n1507: \n1508: $$\n1509: Q = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix}\n1510: \n1511: $$\n1512: \n1513: **Positive definiteness requirement:** $Q \\succ 0$ if and only if $\\lambda_v > b^2/4$ (strict inequality).\n1514: \n1515: **PART II: Linear Dynamics and Drift Matrix**\n1516: \n1517: The barycenter differences evolve (neglecting noise and force terms temporarily) as:\n1518: \n1519: $$\n1520: \\frac{d}{dt}\\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix}\n1521: \n1522: $$\n1523: \n1524: Define the linear dynamics matrix:\n1525: \n1526: $$\n1527: M = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix}\n1528: \n1529: $$\n1530: \n1531: The drift of the quadratic form is:\n1532: \n1533: $$\n1534: \\frac{d}{dt}V_{\\text{loc}} = z^T (M^T Q + QM) z + 2z^T Q \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix} + \\text{(noise)}\n1535: \n1536: $$\n1537: \n1538: **Compute the drift matrix $D = M^T Q + QM$:**\n1539: \n1540: $$\n1541: M^T Q = \\begin{bmatrix} 0 & 0 \\\\ I_d & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ (1 - \\frac{b\\gamma}{2})I_d & (\\frac{b}{2} - \\gamma\\lambda_v)I_d \\end{bmatrix}\n1542: \n1543: $$\n1544: \n1545: $$\n1546: QM = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ 0 & (\\frac{b}{2} - \\gamma\\lambda_v)I_d \\end{bmatrix}\n1547: \n1548: $$\n1549: \n1550: $$\n1551: D = M^T Q + QM = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ (1 - \\frac{b\\gamma}{2})I_d & (b - 2\\gamma\\lambda_v)I_d \\end{bmatrix}\n1552: \n1553: $$\n1554: \n1555: **PART III: Force Contribution (No Convexity Assumption)**\n1556: \n1557: The force difference contributes:\n1558: \n1559: $$\n1560: 2z^T Q \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix} = 2(\\Delta\\mu_x)^T \\frac{b}{2}\\Delta F + 2(\\Delta\\mu_v)^T \\lambda_v \\Delta F\n1561: \n1562: $$\n1563: \n1564: where $\\Delta F = \\frac{1}{N_1}\\sum_{i \\in S_1} F(x_{1,i}) - \\frac{1}{N_2}\\sum_{i \\in S_2} F(x_{2,i})$.\n1565: \n1566: **Key insight:** We do NOT assume $F = -\\nabla U$ is monotone (i.e., convexity of $U$). Instead, we use a **two-region analysis** based on distance from the boundary:\n1567: \n1568: :::{prf:definition} Core and Exterior Regions\n1569: :label: def-core-exterior-regions\n1570: \n1571: For any $\\delta_{\\text{core}} > 0$, define:\n1572: \n1573: **Core Region** (interior domain):\n1574: \n1575: $$\n1576: \\mathcal{R}_{\\text{core}} := \\{x \\in \\mathcal{X}_{\\text{valid}} : \\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) \\geq \\delta_{\\text{core}}\\}\n1577: \n1578: $$\n1579: \n1580: **Exterior Region** (near boundary):\n1581: \n1582: $$\n1583: \\mathcal{R}_{\\text{ext}} := \\mathcal{X}_{\\text{valid}} \\setminus \\mathcal{R}_{\\text{core}} = \\{x \\in \\mathcal{X}_{\\text{valid}} : \\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) < \\delta_{\\text{core}}\\}\n1584: \n1585: $$",
      "metadata": {
        "label": "def-core-exterior-regions"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1477: :::\n1478: \n1479: :::{prf:proof}\n1480: :label: proof-lem-location-error-drift-kinetic\n1481: **Proof (Drift Matrix Analysis).**\n1482: \n1483: This proof establishes hypocoercive contraction **without assuming convexity** of $U$. Instead, we use:\n1484: 1. **Coercivity** (Axiom 3.3.1): $U$ confines particles to a bounded region\n1485: 2. **Lipschitz forces**: $\\|\\nabla U(x) - \\nabla U(y)\\| \\leq L_F \\|x - y\\|$\n1486: 3. **Coupling between position and velocity** via the drift matrix\n1487: \n1488: **PART I: State Vector and Positive Definite Weight Matrix**\n1489: \n1490: Define the state vector:\n1491: \n1492: $$\n1493: z = \\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} \\in \\mathbb{R}^{2d}\n1494: \n1495: $$\n1496: \n1497: where $\\Delta\\mu_x = \\mu_{x,1} - \\mu_{x,2}$ and $\\Delta\\mu_v = \\mu_{v,1} - \\mu_{v,2}$.\n1498: \n1499: The Lyapunov function is:\n1500: \n1501: $$\n1502: V_{\\text{loc}}(z) = z^T Q z = \\|\\Delta\\mu_x\\|^2 + \\lambda_v \\|\\Delta\\mu_v\\|^2 + b\\langle \\Delta\\mu_x, \\Delta\\mu_v \\rangle\n1503: \n1504: $$\n1505: \n1506: with weight matrix:\n1507: \n1508: $$\n1509: Q = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix}\n1510: \n1511: $$\n1512: \n1513: **Positive definiteness requirement:** $Q \\succ 0$ if and only if $\\lambda_v > b^2/4$ (strict inequality).\n1514: \n1515: **PART II: Linear Dynamics and Drift Matrix**\n1516: \n1517: The barycenter differences evolve (neglecting noise and force terms temporarily) as:\n1518: \n1519: $$\n1520: \\frac{d}{dt}\\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} \\Delta\\mu_x \\\\ \\Delta\\mu_v \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix}\n1521: \n1522: $$\n1523: \n1524: Define the linear dynamics matrix:\n1525: \n1526: $$\n1527: M = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix}\n1528: \n1529: $$\n1530: \n1531: The drift of the quadratic form is:\n1532: \n1533: $$\n1534: \\frac{d}{dt}V_{\\text{loc}} = z^T (M^T Q + QM) z + 2z^T Q \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix} + \\text{(noise)}\n1535: \n1536: $$\n1537: \n1538: **Compute the drift matrix $D = M^T Q + QM$:**\n1539: \n1540: $$\n1541: M^T Q = \\begin{bmatrix} 0 & 0 \\\\ I_d & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ (1 - \\frac{b\\gamma}{2})I_d & (\\frac{b}{2} - \\gamma\\lambda_v)I_d \\end{bmatrix}\n1542: \n1543: $$\n1544: \n1545: $$\n1546: QM = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ 0 & (\\frac{b}{2} - \\gamma\\lambda_v)I_d \\end{bmatrix}\n1547: \n1548: $$\n1549: \n1550: $$\n1551: D = M^T Q + QM = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ (1 - \\frac{b\\gamma}{2})I_d & (b - 2\\gamma\\lambda_v)I_d \\end{bmatrix}\n1552: \n1553: $$\n1554: \n1555: **PART III: Force Contribution (No Convexity Assumption)**\n1556: \n1557: The force difference contributes:\n1558: \n1559: $$\n1560: 2z^T Q \\begin{bmatrix} 0 \\\\ \\Delta F \\end{bmatrix} = 2(\\Delta\\mu_x)^T \\frac{b}{2}\\Delta F + 2(\\Delta\\mu_v)^T \\lambda_v \\Delta F\n1561: \n1562: $$\n1563: \n1564: where $\\Delta F = \\frac{1}{N_1}\\sum_{i \\in S_1} F(x_{1,i}) - \\frac{1}{N_2}\\sum_{i \\in S_2} F(x_{2,i})$.\n1565: \n1566: **Key insight:** We do NOT assume $F = -\\nabla U$ is monotone (i.e., convexity of $U$). Instead, we use a **two-region analysis** based on distance from the boundary:\n1567: \n1568: :::{prf:definition} Core and Exterior Regions\n1569: :label: def-core-exterior-regions\n1570: \n1571: For any $\\delta_{\\text{core}} > 0$, define:\n1572: \n1573: **Core Region** (interior domain):\n1574: \n1575: $$\n1576: \\mathcal{R}_{\\text{core}} := \\{x \\in \\mathcal{X}_{\\text{valid}} : \\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) \\geq \\delta_{\\text{core}}\\}\n1577: \n1578: $$\n1579: \n1580: **Exterior Region** (near boundary):\n1581: \n1582: $$\n1583: \\mathcal{R}_{\\text{ext}} := \\mathcal{X}_{\\text{valid}} \\setminus \\mathcal{R}_{\\text{core}} = \\{x \\in \\mathcal{X}_{\\text{valid}} : \\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) < \\delta_{\\text{core}}\\}\n1584: \n1585: $$\n1586: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_kinetic_contraction",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Hypocoercive Contraction of Inter-Swarm Error"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-structural-error-drift-kinetic",
      "title": null,
      "start_line": 1734,
      "end_line": 1798,
      "header_lines": [
        1735
      ],
      "content_start": 1736,
      "content_end": 1797,
      "content": "1736: :::{prf:proof}\n1737: :label: proof-lem-structural-error-drift-kinetic\n1738: **Proof (Empirical Measure and Optimal Transport).**\n1739: \n1740: This proof adapts Wasserstein gradient flow theory to **discrete N-particle systems** using empirical measures and optimal transport.\n1741: \n1742: **PART I: Empirical Measure Representation**\n1743: \n1744: For swarm $k$ with $N_k$ particles at positions $\\{x_{k,i}\\}$ and velocities $\\{v_{k,i}\\}$, define the **empirical measure**:\n1745: \n1746: $$\n1747: \\mu_k^N = \\frac{1}{N_k} \\sum_{i=1}^{N_k} \\delta_{(x_{k,i}, v_{k,i})}\n1748: \n1749: $$\n1750: \n1751: This is a probability measure on phase space $\\mathbb{R}^{2d}$ (position + velocity).\n1752: \n1753: **Centered empirical measure:** Shift by the barycenter:\n1754: \n1755: $$\n1756: \\tilde{\\mu}_k^N = \\frac{1}{N_k} \\sum_{i=1}^{N_k} \\delta_{(x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})}\n1757: \n1758: $$\n1759: \n1760: where $\\mu_{x,k} = \\frac{1}{N_k}\\sum_i x_{k,i}$ and $\\mu_{v,k} = \\frac{1}{N_k}\\sum_i v_{k,i}$.\n1761: \n1762: **PART II: Empirical Fokker-Planck Equation**\n1763: \n1764: The empirical measure evolves according to the **empirical Fokker-Planck equation**:\n1765: \n1766: $$\n1767: \\frac{\\partial \\mu_k^N}{\\partial t} = \\sum_{i=1}^{N_k} \\frac{1}{N_k} \\left[\\nabla_{x_i} \\cdot (v_i \\mu_k^N) + \\nabla_{v_i} \\cdot ((F(x_i) - \\gamma v_i) \\mu_k^N) + \\frac{1}{2}\\nabla_{v_i}^2 : (\\Sigma\\Sigma^T \\mu_k^N)\\right]\n1768: \n1769: $$\n1770: \n1771: **Key observation:** This is a sum of $N_k$ **individual Fokker-Planck operators**, each acting on a single Dirac mass.\n1772: \n1773: **PART III: Optimal Transport and Synchronous Coupling**\n1774: \n1775: The Wasserstein-2 distance between centered measures is:\n1776: \n1777: $$\n1778: V_{\\text{struct}} = W_2^2(\\tilde{\\mu}_1^N, \\tilde{\\mu}_2^N)\n1779: \n1780: $$\n1781: \n1782: **Index-matching coupling:** For computational tractability with synchronized swarm dynamics, we use the synchronous coupling where particles are **matched by index**:\n1783: \n1784: $$\n1785: \\pi^N = \\frac{1}{N} \\sum_{i=1}^N \\delta_{(z_{1,i}, z_{2,i})}\n1786: \n1787: $$\n1788: \n1789: where $z_{k,i} = (x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})$ are centered coordinates.\n1790: \n1791: :::{note}\n1792: **On optimality**: The index-matching coupling is generally **suboptimal** for the Wasserstein distance. Computing the true optimal coupling requires solving an assignment problem (e.g., via the Hungarian algorithm). However, for swarms evolved with **synchronized dynamics** (same Brownian motion realization for both swarms), the index-matching coupling becomes natural and provides a **computable upper bound**:\n1793: \n1794: $$\n1795: W_2^2(\\tilde{\\mu}_1^N, \\tilde{\\mu}_2^N) \\leq \\frac{1}{N}\\sum_{i=1}^N \\|z_{1,i} - z_{2,i}\\|_h^2\n1796: \n1797: $$",
      "metadata": {
        "label": "proof-lem-structural-error-drift-kinetic"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1734: :::\n1735: \n1736: :::{prf:proof}\n1737: :label: proof-lem-structural-error-drift-kinetic\n1738: **Proof (Empirical Measure and Optimal Transport).**\n1739: \n1740: This proof adapts Wasserstein gradient flow theory to **discrete N-particle systems** using empirical measures and optimal transport.\n1741: \n1742: **PART I: Empirical Measure Representation**\n1743: \n1744: For swarm $k$ with $N_k$ particles at positions $\\{x_{k,i}\\}$ and velocities $\\{v_{k,i}\\}$, define the **empirical measure**:\n1745: \n1746: $$\n1747: \\mu_k^N = \\frac{1}{N_k} \\sum_{i=1}^{N_k} \\delta_{(x_{k,i}, v_{k,i})}\n1748: \n1749: $$\n1750: \n1751: This is a probability measure on phase space $\\mathbb{R}^{2d}$ (position + velocity).\n1752: \n1753: **Centered empirical measure:** Shift by the barycenter:\n1754: \n1755: $$\n1756: \\tilde{\\mu}_k^N = \\frac{1}{N_k} \\sum_{i=1}^{N_k} \\delta_{(x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})}\n1757: \n1758: $$\n1759: \n1760: where $\\mu_{x,k} = \\frac{1}{N_k}\\sum_i x_{k,i}$ and $\\mu_{v,k} = \\frac{1}{N_k}\\sum_i v_{k,i}$.\n1761: \n1762: **PART II: Empirical Fokker-Planck Equation**\n1763: \n1764: The empirical measure evolves according to the **empirical Fokker-Planck equation**:\n1765: \n1766: $$\n1767: \\frac{\\partial \\mu_k^N}{\\partial t} = \\sum_{i=1}^{N_k} \\frac{1}{N_k} \\left[\\nabla_{x_i} \\cdot (v_i \\mu_k^N) + \\nabla_{v_i} \\cdot ((F(x_i) - \\gamma v_i) \\mu_k^N) + \\frac{1}{2}\\nabla_{v_i}^2 : (\\Sigma\\Sigma^T \\mu_k^N)\\right]\n1768: \n1769: $$\n1770: \n1771: **Key observation:** This is a sum of $N_k$ **individual Fokker-Planck operators**, each acting on a single Dirac mass.\n1772: \n1773: **PART III: Optimal Transport and Synchronous Coupling**\n1774: \n1775: The Wasserstein-2 distance between centered measures is:\n1776: \n1777: $$\n1778: V_{\\text{struct}} = W_2^2(\\tilde{\\mu}_1^N, \\tilde{\\mu}_2^N)\n1779: \n1780: $$\n1781: \n1782: **Index-matching coupling:** For computational tractability with synchronized swarm dynamics, we use the synchronous coupling where particles are **matched by index**:\n1783: \n1784: $$\n1785: \\pi^N = \\frac{1}{N} \\sum_{i=1}^N \\delta_{(z_{1,i}, z_{2,i})}\n1786: \n1787: $$\n1788: \n1789: where $z_{k,i} = (x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})$ are centered coordinates.\n1790: \n1791: :::{note}\n1792: **On optimality**: The index-matching coupling is generally **suboptimal** for the Wasserstein distance. Computing the true optimal coupling requires solving an assignment problem (e.g., via the Hungarian algorithm). However, for swarms evolved with **synchronized dynamics** (same Brownian motion realization for both swarms), the index-matching coupling becomes natural and provides a **computable upper bound**:\n1793: \n1794: $$\n1795: W_2^2(\\tilde{\\mu}_1^N, \\tilde{\\mu}_2^N) \\leq \\frac{1}{N}\\sum_{i=1}^N \\|z_{1,i} - z_{2,i}\\|_h^2\n1796: \n1797: $$\n1798: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_kinetic_contraction",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Hypocoercive Contraction of Inter-Swarm Error"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-inter-swarm-contraction-kinetic",
      "title": null,
      "start_line": 1916,
      "end_line": 1949,
      "header_lines": [
        1917
      ],
      "content_start": 1918,
      "content_end": 1948,
      "content": "1918: :::{prf:proof}\n1919: :label: proof-thm-inter-swarm-contraction-kinetic\n1920: **Proof of Theorem 4.3.1.**\n1921: \n1922: Combine Lemmas 2.5.1 and 2.6.1 using the decomposition $V_W = V_{\\text{loc}} + V_{\\text{struct}}$:\n1923: \n1924: $$\n1925: \\begin{aligned}\n1926: \\mathbb{E}[\\Delta V_W] &= \\mathbb{E}[\\Delta V_{\\text{loc}}] + \\mathbb{E}[\\Delta V_{\\text{struct}}] \\\\\n1927: &\\leq -\\left[\\frac{\\alpha_U}{2} + \\gamma\\lambda_v - \\frac{b^2}{4\\lambda_v}\\right] V_{\\text{loc}} \\tau - \\kappa_{\\text{struct}} V_{\\text{struct}} \\tau + (C_{\\text{loc}}' + C_{\\text{struct}}') \\tau\n1928: \\end{aligned}\n1929: \n1930: $$\n1931: \n1932: Define $\\kappa_W := \\min\\left(\\frac{\\alpha_U}{2} + \\gamma\\lambda_v - \\frac{b^2}{4\\lambda_v}, \\kappa_{\\text{struct}}\\right)$ and $C_W' := C_{\\text{loc}}' + C_{\\text{struct}}'$.\n1933: \n1934: Then:\n1935: \n1936: $$\n1937: \\mathbb{E}[\\Delta V_W] \\leq -\\kappa_W (V_{\\text{loc}} + V_{\\text{struct}}) \\tau + C_W' \\tau = -\\kappa_W V_W \\tau + C_W' \\tau\n1938: \n1939: $$\n1940: \n1941: Rearranging:\n1942: \n1943: $$\n1944: \\mathbb{E}[V_W(S')] \\leq (1 - \\kappa_W \\tau) V_W(S) + C_W' \\tau\n1945: \n1946: $$\n1947: \n1948: **N-uniformity:** All constants depend only on $(\\gamma, \\alpha_U, \\sigma_{\\min}, \\sigma_{\\max}, \\text{domain geometry})$, not on $N$.",
      "metadata": {
        "label": "proof-thm-inter-swarm-contraction-kinetic"
      },
      "section": "## 4. Hypocoercive Contraction of Inter-Swarm Error",
      "raw_directive": "1916: ### 4.7. Proof of Main Theorem\n1917: \n1918: :::{prf:proof}\n1919: :label: proof-thm-inter-swarm-contraction-kinetic\n1920: **Proof of Theorem 4.3.1.**\n1921: \n1922: Combine Lemmas 2.5.1 and 2.6.1 using the decomposition $V_W = V_{\\text{loc}} + V_{\\text{struct}}$:\n1923: \n1924: $$\n1925: \\begin{aligned}\n1926: \\mathbb{E}[\\Delta V_W] &= \\mathbb{E}[\\Delta V_{\\text{loc}}] + \\mathbb{E}[\\Delta V_{\\text{struct}}] \\\\\n1927: &\\leq -\\left[\\frac{\\alpha_U}{2} + \\gamma\\lambda_v - \\frac{b^2}{4\\lambda_v}\\right] V_{\\text{loc}} \\tau - \\kappa_{\\text{struct}} V_{\\text{struct}} \\tau + (C_{\\text{loc}}' + C_{\\text{struct}}') \\tau\n1928: \\end{aligned}\n1929: \n1930: $$\n1931: \n1932: Define $\\kappa_W := \\min\\left(\\frac{\\alpha_U}{2} + \\gamma\\lambda_v - \\frac{b^2}{4\\lambda_v}, \\kappa_{\\text{struct}}\\right)$ and $C_W' := C_{\\text{loc}}' + C_{\\text{struct}}'$.\n1933: \n1934: Then:\n1935: \n1936: $$\n1937: \\mathbb{E}[\\Delta V_W] \\leq -\\kappa_W (V_{\\text{loc}} + V_{\\text{struct}}) \\tau + C_W' \\tau = -\\kappa_W V_W \\tau + C_W' \\tau\n1938: \n1939: $$\n1940: \n1941: Rearranging:\n1942: \n1943: $$\n1944: \\mathbb{E}[V_W(S')] \\leq (1 - \\kappa_W \\tau) V_W(S) + C_W' \\tau\n1945: \n1946: $$\n1947: \n1948: **N-uniformity:** All constants depend only on $(\\gamma, \\alpha_U, \\sigma_{\\min}, \\sigma_{\\max}, \\text{domain geometry})$, not on $N$.\n1949: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_kinetic_contraction",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Hypocoercive Contraction of Inter-Swarm Error"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-velocity-variance-contraction-kinetic",
      "title": null,
      "start_line": 2025,
      "end_line": 2285,
      "header_lines": [
        2026
      ],
      "content_start": 2027,
      "content_end": 2284,
      "content": "2027: :::{prf:proof}\n2028: :label: proof-thm-velocity-variance-contraction-kinetic\n2029: **Proof (Complete Algebraic Derivation).**\n2030: \n2031: This proof provides the full algebraic decomposition of velocity variance evolution using Itô's lemma, the parallel axis theorem, and careful bookkeeping.\n2032: \n2033: **PART I: Single-Walker Velocity Evolution**\n2034: \n2035: For walker $i$ with velocity $v_i$, the Langevin equation is:\n2036: \n2037: $$\n2038: dv_i = F(x_i) dt - \\gamma v_i dt + \\Sigma(x_i, v_i) \\circ dW_i\n2039: \n2040: $$\n2041: \n2042: Apply **Itô's lemma** to $\\|v_i\\|^2$:\n2043: \n2044: $$\n2045: d\\|v_i\\|^2 = 2\\langle v_i, dv_i \\rangle + \\|dv_i\\|^2\n2046: \n2047: $$\n2048: \n2049: **Compute the quadratic variation:**\n2050: \n2051: $$\n2052: \\|dv_i\\|^2 = \\|\\Sigma(x_i, v_i) \\circ dW_i\\|^2 = \\text{Tr}(\\Sigma\\Sigma^T) dt \\quad \\text{(Itô isometry)}\n2053: \n2054: $$\n2055: \n2056: **Substitute dynamics:**\n2057: \n2058: $$\n2059: d\\|v_i\\|^2 = 2\\langle v_i, F(x_i) - \\gamma v_i \\rangle dt + \\text{Tr}(\\Sigma\\Sigma^T) dt + 2\\langle v_i, \\Sigma dW_i \\rangle\n2060: \n2061: $$\n2062: \n2063: $$\n2064: = 2\\langle v_i, F(x_i) \\rangle dt - 2\\gamma \\|v_i\\|^2 dt + \\text{Tr}(\\Sigma\\Sigma^T) dt + 2\\langle v_i, \\Sigma dW_i \\rangle\n2065: \n2066: $$\n2067: \n2068: **Take expectations (martingale term vanishes):**\n2069: \n2070: $$\n2071: \\mathbb{E}[d\\|v_i\\|^2] = 2\\mathbb{E}[\\langle v_i, F(x_i) \\rangle] dt - 2\\gamma \\mathbb{E}[\\|v_i\\|^2] dt + \\mathbb{E}[\\text{Tr}(\\Sigma\\Sigma^T)] dt\n2072: \n2073: $$\n2074: \n2075: **PART II: Barycenter Velocity Evolution**\n2076: \n2077: For swarm $k$ with $N_k$ alive walkers, the barycenter velocity is:\n2078: \n2079: $$\n2080: \\mu_{v,k} = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} v_{k,i}\n2081: \n2082: $$\n2083: \n2084: Apply Itô's lemma to $\\|\\mu_{v,k}\\|^2$:\n2085: \n2086: $$\n2087: d\\|\\mu_{v,k}\\|^2 = 2\\langle \\mu_{v,k}, d\\mu_{v,k} \\rangle + \\|d\\mu_{v,k}\\|^2\n2088: \n2089: $$\n2090: \n2091: **Barycenter evolution:**\n2092: \n2093: $$\n2094: d\\mu_{v,k} = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} dv_{k,i}\n2095: \n2096: $$\n2097: \n2098: $$\n2099: = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\Sigma(x_{k,i}, v_{k,i}) \\circ dW_i\n2100: \n2101: $$\n2102: \n2103: **Quadratic variation of barycenter:**\n2104: \n2105: $$\n2106: \\|d\\mu_{v,k}\\|^2 = \\left\\|\\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\Sigma dW_i\\right\\|^2 = \\frac{1}{N_k^2}\\sum_{i \\in \\mathcal{A}(S_k)} \\text{Tr}(\\Sigma_i\\Sigma_i^T) dt\n2107: \n2108: $$\n2109: \n2110: $$\n2111: \\leq \\frac{1}{N_k} \\sigma_{\\max}^2 d \\, dt\n2112: \n2113: $$\n2114: \n2115: **PART III: Parallel Axis Theorem (Sample Decomposition)**\n2116: \n2117: For any finite sample of vectors $\\{v_i\\}_{i=1}^N$ with sample mean $\\mu_v = \\frac{1}{N}\\sum_{i=1}^N v_i$:\n2118: \n2119: $$\n2120: \\frac{1}{N}\\sum_{i=1}^N \\|v_i\\|^2 = \\frac{1}{N}\\sum_{i=1}^N \\|v_i - \\mu_v\\|^2 + \\|\\mu_v\\|^2\n2121: \n2122: $$\n2123: \n2124: where the left-hand side is the **mean of squared norms**, the first term on the right is the **sample variance**, and the second term is the **squared sample mean**.\n2125: \n2126: **Rearranging:**\n2127: \n2128: $$\n2129: \\text{Var}(v) := \\frac{1}{N}\\sum_{i=1}^N \\|v_i - \\mu_v\\|^2 = \\frac{1}{N}\\sum_{i=1}^N \\|v_i\\|^2 - \\|\\mu_v\\|^2\n2130: \n2131: $$\n2132: \n2133: (✓ sympy-verified: `src/proofs/05_kinetic_contraction/test_parallel_axis_theorem.py::test_parallel_axis_theorem`)\n2134: \n2135: **PART IV: Variance Evolution for Single Swarm**\n2136: \n2137: For swarm $k$:\n2138: \n2139: $$\n2140: \\frac{d}{dt}\\text{Var}_k(v) = \\frac{d}{dt}\\left[\\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\|v_{k,i}\\|^2 - \\|\\mu_{v,k}\\|^2\\right]\n2141: \n2142: $$\n2143: \n2144: $$\n2145: = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\frac{d}{dt}\\mathbb{E}[\\|v_{k,i}\\|^2] - \\frac{d}{dt}\\mathbb{E}[\\|\\mu_{v,k}\\|^2]\n2146: \n2147: $$\n2148: \n2149: **From Part I:**\n2150: \n2151: $$\n2152: \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\frac{d}{dt}\\mathbb{E}[\\|v_{k,i}\\|^2] = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i}, F(x_{k,i}) \\rangle] - 2\\gamma \\frac{1}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i}\\|^2] + d\\sigma_{\\max}^2\n2153: \n2154: $$\n2155: \n2156: **From Part II:**\n2157: \n2158: $$\n2159: \\frac{d}{dt}\\mathbb{E}[\\|\\mu_{v,k}\\|^2] = 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} - \\gamma\\mu_{v,k} \\rangle] + O(1/N_k)\n2160: \n2161: $$\n2162: \n2163: where $F_{\\text{avg},k} = \\frac{1}{N_k}\\sum_i F(x_{k,i})$.\n2164: \n2165: **Key cancellation:** The force terms largely cancel when we subtract. The residual force-work term is:\n2166: \n2167: $$\n2168: \\Delta_{\\text{force}} := \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i}, F(x_{k,i}) \\rangle] - 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle]\n2169: \n2170: $$\n2171: \n2172: Expanding with $v_{k,i} = \\mu_{v,k} + (v_{k,i} - \\mu_{v,k})$:\n2173: \n2174: $$\n2175: = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i} - \\mu_{v,k}, F(x_{k,i}) \\rangle] + \\underbrace{2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle] - 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle]}_{=0}\n2176: \n2177: $$\n2178: \n2179: $$\n2180: = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i} - \\mu_{v,k}, F(x_{k,i}) \\rangle]\n2181: \n2182: $$\n2183: \n2184: **Quantitative bound via Cauchy-Schwarz:**\n2185: \n2186: $$\n2187: |\\Delta_{\\text{force}}| \\leq \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i} - \\mu_{v,k}\\| \\cdot \\|F(x_{k,i})\\|]\n2188: \n2189: $$\n2190: \n2191: By Axiom 3.3.3 (bounded forces): $\\|F(x)\\| \\leq F_{\\max}$ for $x$ in the interior. Thus:\n2192: \n2193: $$\n2194: \\leq \\frac{2F_{\\max}}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i} - \\mu_{v,k}\\|]\n2195: \n2196: $$\n2197: \n2198: By **Jensen's inequality**: $\\mathbb{E}[\\|v - \\mu_v\\|] \\leq \\sqrt{\\mathbb{E}[\\|v - \\mu_v\\|^2]}$. Therefore:\n2199: \n2200: $$\n2201: \\leq 2F_{\\max} \\sqrt{\\text{Var}_k(v)}\n2202: \n2203: $$\n2204: \n2205: **Sub-leading verification:** Compared to the friction term $-2\\gamma \\text{Var}_k(v)$, the force-work term has ratio:\n2206: \n2207: $$\n2208: \\frac{|\\Delta_{\\text{force}}|}{2\\gamma \\text{Var}_k(v)} \\leq \\frac{2F_{\\max} \\sqrt{\\text{Var}_k(v)}}{2\\gamma \\text{Var}_k(v)} = \\frac{F_{\\max}}{\\gamma \\sqrt{\\text{Var}_k(v)}} \\to 0 \\quad \\text{as } \\text{Var}_k(v) \\to \\infty\n2209: \n2210: $$\n2211: \n2212: Thus, for large velocity variance (which is when contraction is needed), the force-work term is **negligible** compared to friction dissipation.\n2213: \n2214: **Dominant contribution (neglecting sub-leading force-work term):**\n2215: \n2216: $$\n2217: \\frac{d}{dt}\\mathbb{E}[\\text{Var}_k(v)] \\leq -2\\gamma \\text{Var}_k(v) + 2F_{\\max}\\sqrt{\\text{Var}_k(v)} + d\\sigma_{\\max}^2\n2218: \n2219: $$\n2220: \n2221: For practical bounds, absorb the $\\sqrt{\\text{Var}}$ term into the constant:\n2222: \n2223: $$\n2224: \\approx -2\\gamma \\text{Var}_k(v) + d\\sigma_{\\max}^2 + C_{\\text{force}}\n2225: \n2226: $$\n2227: \n2228: where $C_{\\text{force}} = O(F_{\\max})$ accounts for the residual force-work contribution at equilibrium.\n2229: \n2230: **PART V: Aggregate Over Both Swarms**\n2231: \n2232: The total velocity variance is:\n2233: \n2234: $$\n2235: V_{\\text{Var},v} = \\frac{1}{2}\\sum_{k=1,2} \\text{Var}_k(v)\n2236: \n2237: $$\n2238: \n2239: Summing:\n2240: \n2241: $$\n2242: \\frac{d}{dt}\\mathbb{E}[V_{\\text{Var},v}] = \\frac{1}{2}\\sum_{k=1,2} \\frac{d}{dt}\\mathbb{E}[\\text{Var}_k(v)]\n2243: \n2244: $$\n2245: \n2246: $$\n2247: \\leq \\frac{1}{2}\\sum_{k=1,2} [-2\\gamma \\text{Var}_k(v) + d\\sigma_{\\max}^2]\n2248: \n2249: $$\n2250: \n2251: $$\n2252: = -2\\gamma V_{\\text{Var},v} + d\\sigma_{\\max}^2\n2253: \n2254: $$\n2255: \n2256: **PART VI: Discrete-Time Version**\n2257: \n2258: Apply Theorem 3.7.2 (BAOAB weak error) to obtain the discrete-time inequality:\n2259: \n2260: $$\n2261: \\mathbb{E}[\\Delta V_{\\text{Var},v}] = \\mathbb{E}[V_{\\text{Var},v}(t+\\tau) - V_{\\text{Var},v}(t)]\n2262: \n2263: $$\n2264: \n2265: $$\n2266: \\leq -2\\gamma V_{\\text{Var},v}(t) \\tau + d\\sigma_{\\max}^2 \\tau + O(\\tau^2)\n2267: \n2268: $$\n2269: \n2270: For sufficiently small $\\tau$, absorb $O(\\tau^2)$ into the constant term:\n2271: \n2272: $$\n2273: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + d\\sigma_{\\max}^2 \\tau\n2274: \n2275: $$\n2276: \n2277: **PART VII: Physical Interpretation**\n2278: \n2279: This result shows:\n2280: 1. **Contraction:** Friction dissipates velocity variance at rate $2\\gamma$ (twice the friction coefficient due to quadratic dependence)\n2281: 2. **Expansion:** Thermal noise adds variance at rate $d\\sigma_{\\max}^2$ (proportional to dimension and noise strength)\n2282: 3. **Equilibrium:** When $V_{\\text{Var},v} \\to V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$, the two terms balance (equipartition)\n2283: \n2284: **Key property:** The contraction rate $-2\\gamma$ is **independent of system size** $N$ or state - it's a fundamental property of Langevin dynamics.",
      "metadata": {
        "label": "proof-thm-velocity-variance-contraction-kinetic"
      },
      "section": "## 5. Velocity Variance Dissipation via Langevin Friction",
      "raw_directive": "2025: ### 5.4. Proof\n2026: \n2027: :::{prf:proof}\n2028: :label: proof-thm-velocity-variance-contraction-kinetic\n2029: **Proof (Complete Algebraic Derivation).**\n2030: \n2031: This proof provides the full algebraic decomposition of velocity variance evolution using Itô's lemma, the parallel axis theorem, and careful bookkeeping.\n2032: \n2033: **PART I: Single-Walker Velocity Evolution**\n2034: \n2035: For walker $i$ with velocity $v_i$, the Langevin equation is:\n2036: \n2037: $$\n2038: dv_i = F(x_i) dt - \\gamma v_i dt + \\Sigma(x_i, v_i) \\circ dW_i\n2039: \n2040: $$\n2041: \n2042: Apply **Itô's lemma** to $\\|v_i\\|^2$:\n2043: \n2044: $$\n2045: d\\|v_i\\|^2 = 2\\langle v_i, dv_i \\rangle + \\|dv_i\\|^2\n2046: \n2047: $$\n2048: \n2049: **Compute the quadratic variation:**\n2050: \n2051: $$\n2052: \\|dv_i\\|^2 = \\|\\Sigma(x_i, v_i) \\circ dW_i\\|^2 = \\text{Tr}(\\Sigma\\Sigma^T) dt \\quad \\text{(Itô isometry)}\n2053: \n2054: $$\n2055: \n2056: **Substitute dynamics:**\n2057: \n2058: $$\n2059: d\\|v_i\\|^2 = 2\\langle v_i, F(x_i) - \\gamma v_i \\rangle dt + \\text{Tr}(\\Sigma\\Sigma^T) dt + 2\\langle v_i, \\Sigma dW_i \\rangle\n2060: \n2061: $$\n2062: \n2063: $$\n2064: = 2\\langle v_i, F(x_i) \\rangle dt - 2\\gamma \\|v_i\\|^2 dt + \\text{Tr}(\\Sigma\\Sigma^T) dt + 2\\langle v_i, \\Sigma dW_i \\rangle\n2065: \n2066: $$\n2067: \n2068: **Take expectations (martingale term vanishes):**\n2069: \n2070: $$\n2071: \\mathbb{E}[d\\|v_i\\|^2] = 2\\mathbb{E}[\\langle v_i, F(x_i) \\rangle] dt - 2\\gamma \\mathbb{E}[\\|v_i\\|^2] dt + \\mathbb{E}[\\text{Tr}(\\Sigma\\Sigma^T)] dt\n2072: \n2073: $$\n2074: \n2075: **PART II: Barycenter Velocity Evolution**\n2076: \n2077: For swarm $k$ with $N_k$ alive walkers, the barycenter velocity is:\n2078: \n2079: $$\n2080: \\mu_{v,k} = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} v_{k,i}\n2081: \n2082: $$\n2083: \n2084: Apply Itô's lemma to $\\|\\mu_{v,k}\\|^2$:\n2085: \n2086: $$\n2087: d\\|\\mu_{v,k}\\|^2 = 2\\langle \\mu_{v,k}, d\\mu_{v,k} \\rangle + \\|d\\mu_{v,k}\\|^2\n2088: \n2089: $$\n2090: \n2091: **Barycenter evolution:**\n2092: \n2093: $$\n2094: d\\mu_{v,k} = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} dv_{k,i}\n2095: \n2096: $$\n2097: \n2098: $$\n2099: = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\Sigma(x_{k,i}, v_{k,i}) \\circ dW_i\n2100: \n2101: $$\n2102: \n2103: **Quadratic variation of barycenter:**\n2104: \n2105: $$\n2106: \\|d\\mu_{v,k}\\|^2 = \\left\\|\\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\Sigma dW_i\\right\\|^2 = \\frac{1}{N_k^2}\\sum_{i \\in \\mathcal{A}(S_k)} \\text{Tr}(\\Sigma_i\\Sigma_i^T) dt\n2107: \n2108: $$\n2109: \n2110: $$\n2111: \\leq \\frac{1}{N_k} \\sigma_{\\max}^2 d \\, dt\n2112: \n2113: $$\n2114: \n2115: **PART III: Parallel Axis Theorem (Sample Decomposition)**\n2116: \n2117: For any finite sample of vectors $\\{v_i\\}_{i=1}^N$ with sample mean $\\mu_v = \\frac{1}{N}\\sum_{i=1}^N v_i$:\n2118: \n2119: $$\n2120: \\frac{1}{N}\\sum_{i=1}^N \\|v_i\\|^2 = \\frac{1}{N}\\sum_{i=1}^N \\|v_i - \\mu_v\\|^2 + \\|\\mu_v\\|^2\n2121: \n2122: $$\n2123: \n2124: where the left-hand side is the **mean of squared norms**, the first term on the right is the **sample variance**, and the second term is the **squared sample mean**.\n2125: \n2126: **Rearranging:**\n2127: \n2128: $$\n2129: \\text{Var}(v) := \\frac{1}{N}\\sum_{i=1}^N \\|v_i - \\mu_v\\|^2 = \\frac{1}{N}\\sum_{i=1}^N \\|v_i\\|^2 - \\|\\mu_v\\|^2\n2130: \n2131: $$\n2132: \n2133: (✓ sympy-verified: `src/proofs/05_kinetic_contraction/test_parallel_axis_theorem.py::test_parallel_axis_theorem`)\n2134: \n2135: **PART IV: Variance Evolution for Single Swarm**\n2136: \n2137: For swarm $k$:\n2138: \n2139: $$\n2140: \\frac{d}{dt}\\text{Var}_k(v) = \\frac{d}{dt}\\left[\\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\|v_{k,i}\\|^2 - \\|\\mu_{v,k}\\|^2\\right]\n2141: \n2142: $$\n2143: \n2144: $$\n2145: = \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\frac{d}{dt}\\mathbb{E}[\\|v_{k,i}\\|^2] - \\frac{d}{dt}\\mathbb{E}[\\|\\mu_{v,k}\\|^2]\n2146: \n2147: $$\n2148: \n2149: **From Part I:**\n2150: \n2151: $$\n2152: \\frac{1}{N_k}\\sum_{i \\in \\mathcal{A}(S_k)} \\frac{d}{dt}\\mathbb{E}[\\|v_{k,i}\\|^2] = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i}, F(x_{k,i}) \\rangle] - 2\\gamma \\frac{1}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i}\\|^2] + d\\sigma_{\\max}^2\n2153: \n2154: $$\n2155: \n2156: **From Part II:**\n2157: \n2158: $$\n2159: \\frac{d}{dt}\\mathbb{E}[\\|\\mu_{v,k}\\|^2] = 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} - \\gamma\\mu_{v,k} \\rangle] + O(1/N_k)\n2160: \n2161: $$\n2162: \n2163: where $F_{\\text{avg},k} = \\frac{1}{N_k}\\sum_i F(x_{k,i})$.\n2164: \n2165: **Key cancellation:** The force terms largely cancel when we subtract. The residual force-work term is:\n2166: \n2167: $$\n2168: \\Delta_{\\text{force}} := \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i}, F(x_{k,i}) \\rangle] - 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle]\n2169: \n2170: $$\n2171: \n2172: Expanding with $v_{k,i} = \\mu_{v,k} + (v_{k,i} - \\mu_{v,k})$:\n2173: \n2174: $$\n2175: = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i} - \\mu_{v,k}, F(x_{k,i}) \\rangle] + \\underbrace{2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle] - 2\\mathbb{E}[\\langle \\mu_{v,k}, F_{\\text{avg},k} \\rangle]}_{=0}\n2176: \n2177: $$\n2178: \n2179: $$\n2180: = \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\langle v_{k,i} - \\mu_{v,k}, F(x_{k,i}) \\rangle]\n2181: \n2182: $$\n2183: \n2184: **Quantitative bound via Cauchy-Schwarz:**\n2185: \n2186: $$\n2187: |\\Delta_{\\text{force}}| \\leq \\frac{2}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i} - \\mu_{v,k}\\| \\cdot \\|F(x_{k,i})\\|]\n2188: \n2189: $$\n2190: \n2191: By Axiom 3.3.3 (bounded forces): $\\|F(x)\\| \\leq F_{\\max}$ for $x$ in the interior. Thus:\n2192: \n2193: $$\n2194: \\leq \\frac{2F_{\\max}}{N_k}\\sum_i \\mathbb{E}[\\|v_{k,i} - \\mu_{v,k}\\|]\n2195: \n2196: $$\n2197: \n2198: By **Jensen's inequality**: $\\mathbb{E}[\\|v - \\mu_v\\|] \\leq \\sqrt{\\mathbb{E}[\\|v - \\mu_v\\|^2]}$. Therefore:\n2199: \n2200: $$\n2201: \\leq 2F_{\\max} \\sqrt{\\text{Var}_k(v)}\n2202: \n2203: $$\n2204: \n2205: **Sub-leading verification:** Compared to the friction term $-2\\gamma \\text{Var}_k(v)$, the force-work term has ratio:\n2206: \n2207: $$\n2208: \\frac{|\\Delta_{\\text{force}}|}{2\\gamma \\text{Var}_k(v)} \\leq \\frac{2F_{\\max} \\sqrt{\\text{Var}_k(v)}}{2\\gamma \\text{Var}_k(v)} = \\frac{F_{\\max}}{\\gamma \\sqrt{\\text{Var}_k(v)}} \\to 0 \\quad \\text{as } \\text{Var}_k(v) \\to \\infty\n2209: \n2210: $$\n2211: \n2212: Thus, for large velocity variance (which is when contraction is needed), the force-work term is **negligible** compared to friction dissipation.\n2213: \n2214: **Dominant contribution (neglecting sub-leading force-work term):**\n2215: \n2216: $$\n2217: \\frac{d}{dt}\\mathbb{E}[\\text{Var}_k(v)] \\leq -2\\gamma \\text{Var}_k(v) + 2F_{\\max}\\sqrt{\\text{Var}_k(v)} + d\\sigma_{\\max}^2\n2218: \n2219: $$\n2220: \n2221: For practical bounds, absorb the $\\sqrt{\\text{Var}}$ term into the constant:\n2222: \n2223: $$\n2224: \\approx -2\\gamma \\text{Var}_k(v) + d\\sigma_{\\max}^2 + C_{\\text{force}}\n2225: \n2226: $$\n2227: \n2228: where $C_{\\text{force}} = O(F_{\\max})$ accounts for the residual force-work contribution at equilibrium.\n2229: \n2230: **PART V: Aggregate Over Both Swarms**\n2231: \n2232: The total velocity variance is:\n2233: \n2234: $$\n2235: V_{\\text{Var},v} = \\frac{1}{2}\\sum_{k=1,2} \\text{Var}_k(v)\n2236: \n2237: $$\n2238: \n2239: Summing:\n2240: \n2241: $$\n2242: \\frac{d}{dt}\\mathbb{E}[V_{\\text{Var},v}] = \\frac{1}{2}\\sum_{k=1,2} \\frac{d}{dt}\\mathbb{E}[\\text{Var}_k(v)]\n2243: \n2244: $$\n2245: \n2246: $$\n2247: \\leq \\frac{1}{2}\\sum_{k=1,2} [-2\\gamma \\text{Var}_k(v) + d\\sigma_{\\max}^2]\n2248: \n2249: $$\n2250: \n2251: $$\n2252: = -2\\gamma V_{\\text{Var},v} + d\\sigma_{\\max}^2\n2253: \n2254: $$\n2255: \n2256: **PART VI: Discrete-Time Version**\n2257: \n2258: Apply Theorem 3.7.2 (BAOAB weak error) to obtain the discrete-time inequality:\n2259: \n2260: $$\n2261: \\mathbb{E}[\\Delta V_{\\text{Var},v}] = \\mathbb{E}[V_{\\text{Var},v}(t+\\tau) - V_{\\text{Var},v}(t)]\n2262: \n2263: $$\n2264: \n2265: $$\n2266: \\leq -2\\gamma V_{\\text{Var},v}(t) \\tau + d\\sigma_{\\max}^2 \\tau + O(\\tau^2)\n2267: \n2268: $$\n2269: \n2270: For sufficiently small $\\tau$, absorb $O(\\tau^2)$ into the constant term:\n2271: \n2272: $$\n2273: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\leq -2\\gamma V_{\\text{Var},v} \\tau + d\\sigma_{\\max}^2 \\tau\n2274: \n2275: $$\n2276: \n2277: **PART VII: Physical Interpretation**\n2278: \n2279: This result shows:\n2280: 1. **Contraction:** Friction dissipates velocity variance at rate $2\\gamma$ (twice the friction coefficient due to quadratic dependence)\n2281: 2. **Expansion:** Thermal noise adds variance at rate $d\\sigma_{\\max}^2$ (proportional to dimension and noise strength)\n2282: 3. **Equilibrium:** When $V_{\\text{Var},v} \\to V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$, the two terms balance (equipartition)\n2283: \n2284: **Key property:** The contraction rate $-2\\gamma$ is **independent of system size** $N$ or state - it's a fundamental property of Langevin dynamics.\n2285: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_kinetic_contraction",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Velocity Variance Dissipation via Langevin Friction"
      }
    },
    {
      "directive_type": "proof",
      "label": "assump-uniform-variance-bounds",
      "title": null,
      "start_line": 2426,
      "end_line": 2649,
      "header_lines": [
        2427,
        2629
      ],
      "content_start": 2428,
      "content_end": 2648,
      "content": "2428: :::{prf:proof}\n2429: :label: proof-thm-positional-variance-bounded-expansion\n2430: **Proof (Integral Representation with OU Covariance Bounds).**\n2431: \n2432: **PART I: Integral Representation**\n2433: \n2434: For walker $i$ in swarm $k$, the centered position evolves deterministically:\n2435: \n2436: $$\n2437: d\\delta_{x,k,i} = \\delta_{v,k,i} \\, dt\n2438: \n2439: $$\n2440: \n2441: where $\\delta_{x,k,i}(t) = x_{k,i}(t) - \\mu_{x,k}(t)$ and $\\delta_{v,k,i}(t) = v_{k,i}(t) - \\mu_{v,k}(t)$.\n2442: \n2443: **Key observation:** Position has no direct stochastic term—it evolves as $dx = v \\, dt$. Therefore, Itô's lemma yields **no dt² correction term**.\n2444: \n2445: Integrating from $t=0$ to $t=\\tau$:\n2446: \n2447: $$\n2448: \\delta_{x,k,i}(\\tau) = \\delta_{x,k,i}(0) + \\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\n2449: \n2450: $$\n2451: \n2452: Squaring both sides:\n2453: \n2454: $$\n2455: \\|\\delta_{x,k,i}(\\tau)\\|^2 = \\|\\delta_{x,k,i}(0)\\|^2 + 2\\left\\langle \\delta_{x,k,i}(0), \\int_0^\\tau \\delta_{v,k,i}(s) \\, ds \\right\\rangle + \\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2\n2456: \n2457: $$\n2458: \n2459: **PART II: Linear Term—Position-Velocity Coupling**\n2460: \n2461: For the linear cross-term, expand to first order in $\\tau$:\n2462: \n2463: $$\n2464: \\int_0^\\tau \\delta_{v,k,i}(s) \\, ds \\approx \\delta_{v,k,i}(0) \\tau + O(\\tau^2)\n2465: \n2466: $$\n2467: \n2468: Thus:\n2469: \n2470: $$\n2471: 2\\left\\langle \\delta_{x,k,i}(0), \\int_0^\\tau \\delta_{v,k,i}(s) \\, ds \\right\\rangle \\approx 2\\langle \\delta_{x,k,i}(0), \\delta_{v,k,i}(0) \\rangle \\tau + O(\\tau^2)\n2472: \n2473: $$\n2474: \n2475: Taking expectations and using Cauchy-Schwarz:\n2476: \n2477: $$\n2478: \\left|\\mathbb{E}[\\langle \\delta_{x,k,i}, \\delta_{v,k,i} \\rangle]\\right| \\leq \\sqrt{\\mathbb{E}[\\|\\delta_{x,k,i}\\|^2] \\cdot \\mathbb{E}[\\|\\delta_{v,k,i}\\|^2]}\n2479: \n2480: $$\n2481: \n2482: At equilibrium, the underdamped Langevin dynamics ensures position-velocity decorrelation:\n2483: \n2484: $$\n2485: \\mathbb{E}_{\\text{eq}}[\\langle \\delta_x, \\delta_v \\rangle] = 0\n2486: \n2487: $$\n2488: \n2489: During transients, we use uniform bounds on variances (see Assumption {prf:ref}`assump-uniform-variance-bounds` below):\n2490: \n2491: $$\n2492: \\left|\\mathbb{E}\\left[2\\left\\langle \\delta_{x,k,i}(0), \\int_0^\\tau \\delta_{v,k,i}(s) \\, ds \\right\\rangle\\right]\\right| \\leq 2\\sqrt{M_x \\cdot M_v} \\, \\tau\n2493: \n2494: $$\n2495: \n2496: Define:\n2497: \n2498: $$\n2499: C_1 := 2\\sqrt{M_x \\cdot M_v}\n2500: \n2501: $$\n2502: \n2503: **PART III: Quadratic Term—Velocity Accumulation via Exponential Covariance Decay**\n2504: \n2505: The critical term is:\n2506: \n2507: $$\n2508: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2\\right]\n2509: \n2510: $$\n2511: \n2512: Expanding the squared norm:\n2513: \n2514: $$\n2515: \\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2 = \\int_0^\\tau \\int_0^\\tau \\langle \\delta_{v,k,i}(s_1), \\delta_{v,k,i}(s_2) \\rangle \\, ds_1 \\, ds_2\n2516: \n2517: $$\n2518: \n2519: Taking expectations:\n2520: \n2521: $$\n2522: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2\\right] = \\int_0^\\tau \\int_0^\\tau \\mathbb{E}[\\langle \\delta_{v,k,i}(s_1), \\delta_{v,k,i}(s_2) \\rangle] \\, ds_1 \\, ds_2\n2523: \n2524: $$\n2525: \n2526: **Velocity covariance bound:** The centered velocity $\\delta_v$ satisfies the underdamped Langevin SDE:\n2527: \n2528: $$\n2529: d\\delta_v = [F(x) - F(\\mu_x) - \\gamma \\delta_v] \\, dt + \\Sigma \\circ dW\n2530: \n2531: $$\n2532: \n2533: While $\\delta_v$ is not an exact Ornstein-Uhlenbeck (OU) process for general non-quadratic potentials $U$ (due to the nonlinear force term $F(x) - F(\\mu_x)$), the friction term $-\\gamma \\delta_v$ governs exponential decay of velocity correlations. Under the Lipschitz condition on $F$ (Axiom {prf:ref}`axiom-bounded-displacement` from 01_fragile_gas_framework.md) and constant friction $\\gamma > 0$, the velocity autocovariance satisfies the upper bound:\n2534: \n2535: $$\n2536: \\mathbb{E}[\\langle \\delta_{v}(s_1), \\delta_{v}(s_2) \\rangle] \\leq V_{\\text{Var},v}^{\\text{eq}} e^{-\\gamma |s_1 - s_2|}\n2537: \n2538: $$\n2539: \n2540: where $V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$ is the equilibrium velocity variance from {prf:ref}`thm-velocity-variance-contraction-kinetic`.\n2541: \n2542: **Double integral evaluation:**\n2543: \n2544: Using the exponential bound:\n2545: \n2546: $$\n2547: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2\\right] \\leq V_{\\text{Var},v}^{\\text{eq}} \\int_0^\\tau \\int_0^\\tau e^{-\\gamma |s_1 - s_2|} \\, ds_1 \\, ds_2\n2548: \n2549: $$\n2550: \n2551: By symmetry:\n2552: \n2553: $$\n2554: \\int_0^\\tau \\int_0^\\tau e^{-\\gamma |s_1 - s_2|} \\, ds_1 \\, ds_2 = 2\\int_0^\\tau \\int_0^{s_2} e^{-\\gamma(s_2 - s_1)} \\, ds_1 \\, ds_2\n2555: \n2556: $$\n2557: \n2558: Inner integral:\n2559: \n2560: $$\n2561: \\int_0^{s_2} e^{-\\gamma(s_2 - s_1)} \\, ds_1 = \\frac{1}{\\gamma}(1 - e^{-\\gamma s_2})\n2562: \n2563: $$\n2564: \n2565: Outer integral:\n2566: \n2567: $$\n2568: 2\\int_0^\\tau \\frac{1}{\\gamma}(1 - e^{-\\gamma s_2}) \\, ds_2 = \\frac{2}{\\gamma}\\left[\\tau - \\frac{1}{\\gamma}(1 - e^{-\\gamma \\tau})\\right]\n2569: \n2570: $$\n2571: \n2572: This exact identity holds for all $\\tau \\geq 0$. We analyze two regimes:\n2573: \n2574: **Regime 1: Small timesteps ($\\gamma \\tau \\ll 1$):**\n2575: \n2576: Expand $e^{-\\gamma \\tau} \\approx 1 - \\gamma \\tau + \\frac{\\gamma^2 \\tau^2}{2}$:\n2577: \n2578: $$\n2579: \\frac{2}{\\gamma}\\tau - \\frac{2}{\\gamma^2}\\left(\\gamma \\tau - \\frac{\\gamma^2 \\tau^2}{2}\\right) = \\frac{2}{\\gamma}\\tau - \\frac{2}{\\gamma}\\tau + \\tau^2 = \\tau^2 + O(\\tau^3)\n2580: \n2581: $$\n2582: \n2583: Multiplying by $V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$:\n2584: \n2585: $$\n2586: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v}(s) \\, ds\\right\\|^2\\right] \\leq \\frac{d\\sigma_{\\max}^2}{2\\gamma} \\cdot \\tau^2 + O(\\tau^3)\n2587: \n2588: $$\n2589: \n2590: **Regime 2: Finite timesteps ($\\gamma \\tau \\sim O(1)$):**\n2591: \n2592: Using $(1 - e^{-\\gamma \\tau})/\\gamma \\leq \\tau$, we obtain the uniform bound:\n2593: \n2594: $$\n2595: \\frac{2}{\\gamma}\\tau - \\frac{2}{\\gamma^2}(1 - e^{-\\gamma \\tau}) \\leq \\frac{2\\tau}{\\gamma}\n2596: \n2597: $$\n2598: \n2599: Multiplying by $V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$:\n2600: \n2601: $$\n2602: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v}(s) \\, ds\\right\\|^2\\right] \\leq \\frac{d\\sigma_{\\max}^2}{2\\gamma} \\cdot \\frac{2\\tau}{\\gamma} = \\frac{d\\sigma_{\\max}^2}{\\gamma^2} \\tau\n2603: \n2604: $$\n2605: \n2606: **Uniform bound for all $\\tau \\geq 0$:**\n2607: \n2608: Define:\n2609: \n2610: $$\n2611: C_2 := \\frac{d\\sigma_{\\max}^2}{\\gamma^2}\n2612: \n2613: $$\n2614: \n2615: Then for all $\\tau \\geq 0$:\n2616: \n2617: $$\n2618: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2\\right] \\leq C_2 \\tau\n2619: \n2620: $$\n2621: \n2622: **Physical interpretation:** Despite the integral being \"quadratic\" in form, the exponential correlation decay with characteristic time $1/\\gamma$ causes the effective accumulation to scale as $O(\\tau)$ for timesteps $\\tau \\sim 1/\\gamma$, not $O(\\tau^2)$. This is a standard result for OU-type processes and reflects the finite correlation time of velocity fluctuations.\n2623: \n2624: **PART IV: State-Independence via Uniform Variance Bounds**\n2625: \n2626: The constant $C_2$ depends only on system parameters ($d$, $\\sigma_{\\max}$, $\\gamma$) and is **inherently state-independent**.\n2627: \n2628: The constant $C_1$ requires uniform bounds on positional and velocity variances:\n2629: \n2630: :::{prf:assumption} Uniform Variance Bounds\n2631: :label: assump-uniform-variance-bounds\n2632: \n2633: There exist constants $M_x, M_v > 0$ such that for all swarm configurations along the kinetic evolution:\n2634: \n2635: $$\n2636: \\mathbb{E}[V_{\\text{Var},x}] \\leq M_x, \\quad \\mathbb{E}[V_{\\text{Var},v}] \\leq M_v\n2637: \n2638: $$\n2639: \n2640: These bounds are ensured by:\n2641: \n2642: 1. **Velocity variance:** {prf:ref}`thm-velocity-variance-contraction-kinetic` establishes that velocity variance equilibrates to $V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$ with exponential convergence. Thus $M_v = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$.\n2643: \n2644: 2. **Positional variance:** {prf:ref}`thm-positional-variance-contraction` (from 03_cloning.md, Chapter 10) establishes the Foster-Lyapunov drift inequality:\n2645: \n2646:    $$\n2647:    \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] \\leq -\\kappa_x V_{\\text{Var},x} + C_x\n2648:    $$",
      "metadata": {
        "label": "assump-uniform-variance-bounds"
      },
      "section": "## 6. Positional Diffusion and Bounded Expansion",
      "raw_directive": "2426: ### 6.4. Proof\n2427: \n2428: :::{prf:proof}\n2429: :label: proof-thm-positional-variance-bounded-expansion\n2430: **Proof (Integral Representation with OU Covariance Bounds).**\n2431: \n2432: **PART I: Integral Representation**\n2433: \n2434: For walker $i$ in swarm $k$, the centered position evolves deterministically:\n2435: \n2436: $$\n2437: d\\delta_{x,k,i} = \\delta_{v,k,i} \\, dt\n2438: \n2439: $$\n2440: \n2441: where $\\delta_{x,k,i}(t) = x_{k,i}(t) - \\mu_{x,k}(t)$ and $\\delta_{v,k,i}(t) = v_{k,i}(t) - \\mu_{v,k}(t)$.\n2442: \n2443: **Key observation:** Position has no direct stochastic term—it evolves as $dx = v \\, dt$. Therefore, Itô's lemma yields **no dt² correction term**.\n2444: \n2445: Integrating from $t=0$ to $t=\\tau$:\n2446: \n2447: $$\n2448: \\delta_{x,k,i}(\\tau) = \\delta_{x,k,i}(0) + \\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\n2449: \n2450: $$\n2451: \n2452: Squaring both sides:\n2453: \n2454: $$\n2455: \\|\\delta_{x,k,i}(\\tau)\\|^2 = \\|\\delta_{x,k,i}(0)\\|^2 + 2\\left\\langle \\delta_{x,k,i}(0), \\int_0^\\tau \\delta_{v,k,i}(s) \\, ds \\right\\rangle + \\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2\n2456: \n2457: $$\n2458: \n2459: **PART II: Linear Term—Position-Velocity Coupling**\n2460: \n2461: For the linear cross-term, expand to first order in $\\tau$:\n2462: \n2463: $$\n2464: \\int_0^\\tau \\delta_{v,k,i}(s) \\, ds \\approx \\delta_{v,k,i}(0) \\tau + O(\\tau^2)\n2465: \n2466: $$\n2467: \n2468: Thus:\n2469: \n2470: $$\n2471: 2\\left\\langle \\delta_{x,k,i}(0), \\int_0^\\tau \\delta_{v,k,i}(s) \\, ds \\right\\rangle \\approx 2\\langle \\delta_{x,k,i}(0), \\delta_{v,k,i}(0) \\rangle \\tau + O(\\tau^2)\n2472: \n2473: $$\n2474: \n2475: Taking expectations and using Cauchy-Schwarz:\n2476: \n2477: $$\n2478: \\left|\\mathbb{E}[\\langle \\delta_{x,k,i}, \\delta_{v,k,i} \\rangle]\\right| \\leq \\sqrt{\\mathbb{E}[\\|\\delta_{x,k,i}\\|^2] \\cdot \\mathbb{E}[\\|\\delta_{v,k,i}\\|^2]}\n2479: \n2480: $$\n2481: \n2482: At equilibrium, the underdamped Langevin dynamics ensures position-velocity decorrelation:\n2483: \n2484: $$\n2485: \\mathbb{E}_{\\text{eq}}[\\langle \\delta_x, \\delta_v \\rangle] = 0\n2486: \n2487: $$\n2488: \n2489: During transients, we use uniform bounds on variances (see Assumption {prf:ref}`assump-uniform-variance-bounds` below):\n2490: \n2491: $$\n2492: \\left|\\mathbb{E}\\left[2\\left\\langle \\delta_{x,k,i}(0), \\int_0^\\tau \\delta_{v,k,i}(s) \\, ds \\right\\rangle\\right]\\right| \\leq 2\\sqrt{M_x \\cdot M_v} \\, \\tau\n2493: \n2494: $$\n2495: \n2496: Define:\n2497: \n2498: $$\n2499: C_1 := 2\\sqrt{M_x \\cdot M_v}\n2500: \n2501: $$\n2502: \n2503: **PART III: Quadratic Term—Velocity Accumulation via Exponential Covariance Decay**\n2504: \n2505: The critical term is:\n2506: \n2507: $$\n2508: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2\\right]\n2509: \n2510: $$\n2511: \n2512: Expanding the squared norm:\n2513: \n2514: $$\n2515: \\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2 = \\int_0^\\tau \\int_0^\\tau \\langle \\delta_{v,k,i}(s_1), \\delta_{v,k,i}(s_2) \\rangle \\, ds_1 \\, ds_2\n2516: \n2517: $$\n2518: \n2519: Taking expectations:\n2520: \n2521: $$\n2522: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2\\right] = \\int_0^\\tau \\int_0^\\tau \\mathbb{E}[\\langle \\delta_{v,k,i}(s_1), \\delta_{v,k,i}(s_2) \\rangle] \\, ds_1 \\, ds_2\n2523: \n2524: $$\n2525: \n2526: **Velocity covariance bound:** The centered velocity $\\delta_v$ satisfies the underdamped Langevin SDE:\n2527: \n2528: $$\n2529: d\\delta_v = [F(x) - F(\\mu_x) - \\gamma \\delta_v] \\, dt + \\Sigma \\circ dW\n2530: \n2531: $$\n2532: \n2533: While $\\delta_v$ is not an exact Ornstein-Uhlenbeck (OU) process for general non-quadratic potentials $U$ (due to the nonlinear force term $F(x) - F(\\mu_x)$), the friction term $-\\gamma \\delta_v$ governs exponential decay of velocity correlations. Under the Lipschitz condition on $F$ (Axiom {prf:ref}`axiom-bounded-displacement` from 01_fragile_gas_framework.md) and constant friction $\\gamma > 0$, the velocity autocovariance satisfies the upper bound:\n2534: \n2535: $$\n2536: \\mathbb{E}[\\langle \\delta_{v}(s_1), \\delta_{v}(s_2) \\rangle] \\leq V_{\\text{Var},v}^{\\text{eq}} e^{-\\gamma |s_1 - s_2|}\n2537: \n2538: $$\n2539: \n2540: where $V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$ is the equilibrium velocity variance from {prf:ref}`thm-velocity-variance-contraction-kinetic`.\n2541: \n2542: **Double integral evaluation:**\n2543: \n2544: Using the exponential bound:\n2545: \n2546: $$\n2547: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2\\right] \\leq V_{\\text{Var},v}^{\\text{eq}} \\int_0^\\tau \\int_0^\\tau e^{-\\gamma |s_1 - s_2|} \\, ds_1 \\, ds_2\n2548: \n2549: $$\n2550: \n2551: By symmetry:\n2552: \n2553: $$\n2554: \\int_0^\\tau \\int_0^\\tau e^{-\\gamma |s_1 - s_2|} \\, ds_1 \\, ds_2 = 2\\int_0^\\tau \\int_0^{s_2} e^{-\\gamma(s_2 - s_1)} \\, ds_1 \\, ds_2\n2555: \n2556: $$\n2557: \n2558: Inner integral:\n2559: \n2560: $$\n2561: \\int_0^{s_2} e^{-\\gamma(s_2 - s_1)} \\, ds_1 = \\frac{1}{\\gamma}(1 - e^{-\\gamma s_2})\n2562: \n2563: $$\n2564: \n2565: Outer integral:\n2566: \n2567: $$\n2568: 2\\int_0^\\tau \\frac{1}{\\gamma}(1 - e^{-\\gamma s_2}) \\, ds_2 = \\frac{2}{\\gamma}\\left[\\tau - \\frac{1}{\\gamma}(1 - e^{-\\gamma \\tau})\\right]\n2569: \n2570: $$\n2571: \n2572: This exact identity holds for all $\\tau \\geq 0$. We analyze two regimes:\n2573: \n2574: **Regime 1: Small timesteps ($\\gamma \\tau \\ll 1$):**\n2575: \n2576: Expand $e^{-\\gamma \\tau} \\approx 1 - \\gamma \\tau + \\frac{\\gamma^2 \\tau^2}{2}$:\n2577: \n2578: $$\n2579: \\frac{2}{\\gamma}\\tau - \\frac{2}{\\gamma^2}\\left(\\gamma \\tau - \\frac{\\gamma^2 \\tau^2}{2}\\right) = \\frac{2}{\\gamma}\\tau - \\frac{2}{\\gamma}\\tau + \\tau^2 = \\tau^2 + O(\\tau^3)\n2580: \n2581: $$\n2582: \n2583: Multiplying by $V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$:\n2584: \n2585: $$\n2586: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v}(s) \\, ds\\right\\|^2\\right] \\leq \\frac{d\\sigma_{\\max}^2}{2\\gamma} \\cdot \\tau^2 + O(\\tau^3)\n2587: \n2588: $$\n2589: \n2590: **Regime 2: Finite timesteps ($\\gamma \\tau \\sim O(1)$):**\n2591: \n2592: Using $(1 - e^{-\\gamma \\tau})/\\gamma \\leq \\tau$, we obtain the uniform bound:\n2593: \n2594: $$\n2595: \\frac{2}{\\gamma}\\tau - \\frac{2}{\\gamma^2}(1 - e^{-\\gamma \\tau}) \\leq \\frac{2\\tau}{\\gamma}\n2596: \n2597: $$\n2598: \n2599: Multiplying by $V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$:\n2600: \n2601: $$\n2602: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v}(s) \\, ds\\right\\|^2\\right] \\leq \\frac{d\\sigma_{\\max}^2}{2\\gamma} \\cdot \\frac{2\\tau}{\\gamma} = \\frac{d\\sigma_{\\max}^2}{\\gamma^2} \\tau\n2603: \n2604: $$\n2605: \n2606: **Uniform bound for all $\\tau \\geq 0$:**\n2607: \n2608: Define:\n2609: \n2610: $$\n2611: C_2 := \\frac{d\\sigma_{\\max}^2}{\\gamma^2}\n2612: \n2613: $$\n2614: \n2615: Then for all $\\tau \\geq 0$:\n2616: \n2617: $$\n2618: \\mathbb{E}\\left[\\left\\|\\int_0^\\tau \\delta_{v,k,i}(s) \\, ds\\right\\|^2\\right] \\leq C_2 \\tau\n2619: \n2620: $$\n2621: \n2622: **Physical interpretation:** Despite the integral being \"quadratic\" in form, the exponential correlation decay with characteristic time $1/\\gamma$ causes the effective accumulation to scale as $O(\\tau)$ for timesteps $\\tau \\sim 1/\\gamma$, not $O(\\tau^2)$. This is a standard result for OU-type processes and reflects the finite correlation time of velocity fluctuations.\n2623: \n2624: **PART IV: State-Independence via Uniform Variance Bounds**\n2625: \n2626: The constant $C_2$ depends only on system parameters ($d$, $\\sigma_{\\max}$, $\\gamma$) and is **inherently state-independent**.\n2627: \n2628: The constant $C_1$ requires uniform bounds on positional and velocity variances:\n2629: \n2630: :::{prf:assumption} Uniform Variance Bounds\n2631: :label: assump-uniform-variance-bounds\n2632: \n2633: There exist constants $M_x, M_v > 0$ such that for all swarm configurations along the kinetic evolution:\n2634: \n2635: $$\n2636: \\mathbb{E}[V_{\\text{Var},x}] \\leq M_x, \\quad \\mathbb{E}[V_{\\text{Var},v}] \\leq M_v\n2637: \n2638: $$\n2639: \n2640: These bounds are ensured by:\n2641: \n2642: 1. **Velocity variance:** {prf:ref}`thm-velocity-variance-contraction-kinetic` establishes that velocity variance equilibrates to $V_{\\text{Var},v}^{\\text{eq}} = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$ with exponential convergence. Thus $M_v = \\frac{d\\sigma_{\\max}^2}{2\\gamma}$.\n2643: \n2644: 2. **Positional variance:** {prf:ref}`thm-positional-variance-contraction` (from 03_cloning.md, Chapter 10) establishes the Foster-Lyapunov drift inequality:\n2645: \n2646:    $$\n2647:    \\mathbb{E}_{\\text{clone}}[\\Delta V_{\\text{Var},x}] \\leq -\\kappa_x V_{\\text{Var},x} + C_x\n2648:    $$\n2649: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_kinetic_contraction",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. Positional Diffusion and Bounded Expansion"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-boundary-potential-contraction-kinetic",
      "title": "Boundary Potential Contraction from Confining Force",
      "start_line": 2794,
      "end_line": 3170,
      "header_lines": [
        2795
      ],
      "content_start": 2796,
      "content_end": 3169,
      "content": "2796: :::{prf:proof} Boundary Potential Contraction from Confining Force\n2797: :label: proof-thm-boundary-potential-contraction-kinetic\n2798: **Proof (Velocity-Weighted Lyapunov with Corrected Signs).**\n2799: \n2800: This proof establishes that the confining potential $U$ creates negative drift for the boundary potential $W_b$ through alignment between the inward-pointing force $F = -\\nabla U$ and the outward-pointing barrier gradient $\\nabla\\varphi_{\\text{barrier}}$.\n2801: \n2802: **PART I: Barrier Function Specification**\n2803: \n2804: We use an **exponential-distance barrier** on a boundary layer to ensure controlled derivatives. Let $\\rho: \\mathcal{X}_{\\text{valid}} \\to \\mathbb{R}$ be the **signed distance function**:\n2805: \n2806: $$\n2807: \\rho(x) = \\begin{cases}\n2808: -\\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) & \\text{if } x \\in \\mathcal{X}_{\\text{valid}} \\\\\n2809: 0 & \\text{if } x \\in \\partial\\mathcal{X}_{\\text{valid}}\n2810: \\end{cases}\n2811: \n2812: $$\n2813: \n2814: so $\\rho < 0$ in the interior and $\\nabla\\rho = \\vec{n}(x)$ (outward unit normal) near the boundary.\n2815: \n2816: **Barrier construction:** Fix $\\delta > 0$ (boundary layer width) and $c > 0$ (barrier strength). Define:\n2817: \n2818: $$\n2819: \\varphi_{\\text{barrier}}(x) = \\begin{cases}\n2820: 0 & \\text{if } \\rho(x) < -\\delta \\text{ (safe interior)} \\\\\n2821: \\exp\\left(\\frac{c \\cdot \\rho(x)}{\\delta}\\right) & \\text{if } -\\delta \\leq \\rho(x) < 0 \\text{ (boundary layer)} \\\\\n2822: +\\infty & \\text{if } x \\notin \\mathcal{X}_{\\text{valid}}\n2823: \\end{cases}\n2824: \n2825: $$\n2826: \n2827: with smooth transition at $\\rho = -\\delta$.\n2828: \n2829: **Geometric properties in the boundary layer** ($-\\delta \\leq \\rho < 0$):\n2830: \n2831: 1. **Gradient alignment:**\n2832: \n2833: $$\n2834: \\nabla\\varphi = \\frac{c}{\\delta} \\varphi \\cdot \\nabla\\rho = \\frac{c}{\\delta} \\varphi \\cdot \\vec{n}(x)\n2835: \n2836: $$\n2837: \n2838: where $\\vec{n}(x)$ is the outward unit normal. This gives:\n2839: \n2840: $$\n2841: \\|\\nabla\\varphi\\| = \\frac{c}{\\delta} \\varphi\n2842: \n2843: $$\n2844: \n2845: 2. **Hessian bound:** Assuming $\\mathcal{X}_{\\text{valid}}$ has $C^2$ boundary with bounded principal curvatures $\\|\\nabla\\vec{n}\\| \\leq K_{\\text{curv}}$:\n2846: \n2847: $$\n2848: \\nabla^2\\varphi = \\frac{c}{\\delta}\\varphi \\nabla\\vec{n} + \\left(\\frac{c}{\\delta}\\right)^2 \\varphi \\, \\vec{n}\\vec{n}^T\n2849: \n2850: $$\n2851: \n2852: Thus:\n2853: \n2854: $$\n2855: v^T (\\nabla^2\\varphi) v \\leq \\varphi \\left[\\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta} K_{\\text{curv}}\\right] \\|v\\|^2\n2856: \n2857: $$\n2858: \n2859: **PART II: Compatibility Condition (Corrected Sign)**\n2860: \n2861: By Axiom 3.3.1 part 4, the confining force satisfies:\n2862: \n2863: $$\n2864: \\langle \\vec{n}(x), F(x) \\rangle \\leq -\\alpha_{\\text{boundary}} \\quad \\text{for } \\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) < \\delta_{\\text{boundary}}\n2865: \n2866: $$\n2867: \n2868: where $\\vec{n}(x)$ is the **outward** unit normal.\n2869: \n2870: In the boundary layer, using $\\nabla\\varphi = \\frac{c}{\\delta}\\varphi \\cdot \\vec{n}$:\n2871: \n2872: $$\n2873: \\langle F(x), \\nabla\\varphi(x) \\rangle = \\frac{c}{\\delta}\\varphi(x) \\langle F(x), \\vec{n}(x) \\rangle \\leq -\\frac{c}{\\delta} \\alpha_{\\text{boundary}} \\varphi(x)\n2874: \n2875: $$\n2876: \n2877: **Key inequality (correct sign):**\n2878: \n2879: $$\n2880: \\langle F(x), \\nabla\\varphi(x) \\rangle \\leq -\\alpha_{\\text{align}} \\varphi(x)\n2881: \n2882: $$\n2883: \n2884: where $\\alpha_{\\text{align}} := \\frac{c}{\\delta} \\alpha_{\\text{boundary}} > 0$.\n2885: \n2886: **Physical interpretation:** The confining force $F$ points **inward** (toward safe region), the barrier gradient $\\nabla\\varphi$ points **outward** (away from safe region), so their inner product is **negative**. This creates the **negative drift** needed for contraction.\n2887: \n2888: **PART III: Velocity-Weighted Lyapunov Function**\n2889: \n2890: For particle $i$, define:\n2891: \n2892: $$\n2893: \\Phi_i := \\varphi_i + \\epsilon \\langle v_i, \\nabla\\varphi_i \\rangle\n2894: \n2895: $$\n2896: \n2897: where $\\varphi_i = \\varphi_{\\text{barrier}}(x_i)$ and $\\epsilon > 0$ is a coupling parameter (to be optimized).\n2898: \n2899: **Rationale:**\n2900: - $\\varphi_i$ measures current proximity to boundary\n2901: - $\\langle v_i, \\nabla\\varphi_i \\rangle$ measures velocity component **toward** boundary\n2902: - The coupling balances position and velocity contributions to achieve net contraction\n2903: \n2904: **PART IV: Generator Calculation (Corrected)**\n2905: \n2906: Apply the Fokker-Planck generator $\\mathcal{L}$ from Definition 3.7.1:\n2907: \n2908: $$\n2909: \\mathcal{L}f = v \\cdot \\nabla_x f + (F - \\gamma v) \\cdot \\nabla_v f + \\frac{1}{2}\\text{Tr}(A \\nabla_v^2 f)\n2910: \n2911: $$\n2912: \n2913: where $A = \\Sigma\\Sigma^T$ is the velocity diffusion matrix.\n2914: \n2915: **Term 1: Generator of $\\varphi_i$**\n2916: \n2917: Since $\\varphi_i = \\varphi(x_i)$ (no velocity dependence):\n2918: \n2919: $$\n2920: \\mathcal{L}\\varphi_i = v_i \\cdot \\nabla\\varphi_i + (F(x_i) - \\gamma v_i) \\cdot \\underbrace{\\nabla_v \\varphi_i}_{=0} + \\frac{1}{2}\\text{Tr}(A_i \\underbrace{\\nabla_v^2 \\varphi_i}_{=0})\n2921: \n2922: $$\n2923: \n2924: $$\n2925: = v_i \\cdot \\nabla\\varphi_i\n2926: \n2927: $$\n2928: \n2929: **Term 2: Generator of $\\langle v_i, \\nabla\\varphi_i \\rangle$ (CRITICAL CORRECTION)**\n2930: \n2931: Let $g(x, v) := \\langle v, \\nabla\\varphi(x) \\rangle$.\n2932: \n2933: **Velocity derivatives:**\n2934: \n2935: $$\n2936: \\nabla_v g = \\nabla\\varphi(x)\n2937: \n2938: $$\n2939: \n2940: $$\n2941: \\nabla_v^2 g = 0 \\quad \\text{(linear in } v \\text{, no second derivative!)}\n2942: \n2943: $$\n2944: \n2945: **Position derivatives:**\n2946: \n2947: $$\n2948: \\nabla_x g = (\\nabla^2\\varphi) v\n2949: \n2950: $$\n2951: \n2952: so:\n2953: \n2954: $$\n2955: v \\cdot \\nabla_x g = v^T (\\nabla^2\\varphi) v\n2956: \n2957: $$\n2958: \n2959: **Generator:**\n2960: \n2961: $$\n2962: \\mathcal{L}g = v^T (\\nabla^2\\varphi) v + (F - \\gamma v) \\cdot \\nabla\\varphi + \\frac{1}{2}\\text{Tr}(A \\underbrace{\\nabla_v^2 g}_{=0})\n2963: \n2964: $$\n2965: \n2966: $$\n2967: = v^T (\\nabla^2\\varphi) v + \\langle F, \\nabla\\varphi \\rangle - \\gamma \\langle v, \\nabla\\varphi \\rangle\n2968: \n2969: $$\n2970: \n2971: **Critical note:** The diffusion term vanishes because $g$ is **linear in $v$**, so $\\nabla_v^2 g = 0$. The original proof incorrectly included $\\frac{1}{2}\\text{Tr}(A \\nabla^2\\varphi)$, which mixes velocity diffusion with position Hessian — this is **wrong**.\n2972: \n2973: **PART V: Combine Terms**\n2974: \n2975: $$\n2976: \\mathcal{L}\\Phi_i = \\mathcal{L}\\varphi_i + \\epsilon \\mathcal{L}\\langle v_i, \\nabla\\varphi_i \\rangle\n2977: \n2978: $$\n2979: \n2980: $$\n2981: = v_i \\cdot \\nabla\\varphi_i + \\epsilon\\left[v_i^T (\\nabla^2\\varphi_i) v_i + \\langle F(x_i), \\nabla\\varphi_i \\rangle - \\gamma \\langle v_i, \\nabla\\varphi_i \\rangle\\right]\n2982: \n2983: $$\n2984: \n2985: $$\n2986: = (1 - \\epsilon\\gamma) \\langle v_i, \\nabla\\varphi_i \\rangle + \\epsilon \\langle F(x_i), \\nabla\\varphi_i \\rangle + \\epsilon v_i^T (\\nabla^2\\varphi_i) v_i\n2987: \n2988: $$\n2989: \n2990: **PART VI: Optimal Choice of $\\epsilon$**\n2991: \n2992: Choose $\\epsilon = \\frac{1}{\\gamma}$ to **completely eliminate** the cross-term:\n2993: \n2994: $$\n2995: 1 - \\epsilon\\gamma = 1 - \\frac{1}{\\gamma} \\cdot \\gamma = 0\n2996: \n2997: $$\n2998: \n2999: This gives:\n3000: \n3001: $$\n3002: \\mathcal{L}\\Phi_i = \\frac{1}{\\gamma}\\langle F(x_i), \\nabla\\varphi_i \\rangle + \\frac{1}{\\gamma} v_i^T (\\nabla^2\\varphi_i) v_i\n3003: \n3004: $$\n3005: \n3006: **PART VII: Apply Corrected Compatibility and Hessian Bounds**\n3007: \n3008: In the boundary layer ($-\\delta \\leq \\rho(x_i) < 0$):\n3009: \n3010: **Compatibility (corrected sign):**\n3011: \n3012: $$\n3013: \\langle F(x_i), \\nabla\\varphi_i \\rangle \\leq -\\alpha_{\\text{align}} \\varphi_i\n3014: \n3015: $$\n3016: \n3017: where $\\alpha_{\\text{align}} = \\frac{c}{\\delta} \\alpha_{\\text{boundary}}$.\n3018: \n3019: **Hessian bound:**\n3020: \n3021: $$\n3022: v_i^T (\\nabla^2\\varphi_i) v_i \\leq \\varphi_i \\left[\\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta} K_{\\text{curv}}\\right] \\|v_i\\|^2\n3023: \n3024: $$\n3025: \n3026: Define:\n3027: \n3028: $$\n3029: K_{\\varphi} := \\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta} K_{\\text{curv}}\n3030: \n3031: $$\n3032: \n3033: **PART VIII: Substitute and Bound**\n3034: \n3035: $$\n3036: \\mathcal{L}\\Phi_i \\leq \\frac{1}{\\gamma}\\left[-\\alpha_{\\text{align}} \\varphi_i + K_{\\varphi} \\varphi_i \\|v_i\\|^2\\right]\n3037: \n3038: $$\n3039: \n3040: $$\n3041: = \\frac{\\varphi_i}{\\gamma}\\left[K_{\\varphi} \\|v_i\\|^2 - \\alpha_{\\text{align}}\\right]\n3042: \n3043: $$\n3044: \n3045: **Velocity moment bound from Chapter 5:** By Theorem 5.3.1, the kinetic operator maintains:\n3046: \n3047: $$\n3048: \\mathbb{E}[\\|v_i\\|^2] \\leq V_{\\text{Var},v}^{\\text{eq}} := \\frac{d\\sigma_{\\max}^2}{2\\gamma}\n3049: \n3050: $$\n3051: \n3052: for all $i$ in equilibrium (or near-equilibrium during drift analysis).\n3053: \n3054: **Taking expectation:**\n3055: \n3056: $$\n3057: \\mathbb{E}[\\mathcal{L}\\Phi_i] \\leq \\frac{\\varphi_i}{\\gamma}\\left[K_{\\varphi} V_{\\text{Var},v}^{\\text{eq}} - \\alpha_{\\text{align}}\\right]\n3058: \n3059: $$\n3060: \n3061: **PART IX: Barrier Parameter Selection for Contraction**\n3062: \n3063: To ensure **negative drift**, we need:\n3064: \n3065: $$\n3066: K_{\\varphi} V_{\\text{Var},v}^{\\text{eq}} < \\alpha_{\\text{align}}\n3067: \n3068: $$\n3069: \n3070: Substituting definitions:\n3071: \n3072: $$\n3073: \\left[\\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta} K_{\\text{curv}}\\right] \\frac{d\\sigma_{\\max}^2}{2\\gamma} < \\frac{c}{\\delta} \\alpha_{\\text{boundary}}\n3074: \n3075: $$\n3076: \n3077: Multiply both sides by $\\frac{\\delta}{c}$ (assuming $c > 0$):\n3078: \n3079: $$\n3080: \\left[\\frac{c}{\\delta} + K_{\\text{curv}}\\right] \\frac{d\\sigma_{\\max}^2}{2\\gamma} < \\alpha_{\\text{boundary}}\n3081: \n3082: $$\n3083: \n3084: **Sufficient condition:** Choose $c$ small enough:\n3085: \n3086: $$\n3087: c < \\delta \\left[\\frac{2\\gamma \\alpha_{\\text{boundary}}}{d\\sigma_{\\max}^2} - K_{\\text{curv}}\\right]\n3088: \n3089: $$\n3090: \n3091: This is **always achievable** provided $\\alpha_{\\text{boundary}} > \\frac{K_{\\text{curv}} d\\sigma_{\\max}^2}{2\\gamma}$, which is guaranteed by Axiom 3.3.1 part 4 for sufficiently strong confining potential.\n3092: \n3093: **Resulting contraction rate:**\n3094: \n3095: $$\n3096: \\kappa_{\\text{pot}} := \\frac{1}{\\gamma}\\left[\\alpha_{\\text{align}} - K_{\\varphi} V_{\\text{Var},v}^{\\text{eq}}\\right] = \\frac{1}{\\gamma}\\left[\\frac{c}{\\delta}\\alpha_{\\text{boundary}} - \\left(\\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta}K_{\\text{curv}}\\right)\\frac{d\\sigma_{\\max}^2}{2\\gamma}\\right] > 0\n3097: \n3098: $$\n3099: \n3100: **PART X: Aggregate Over All Particles**\n3101: \n3102: Sum over all particles:\n3103: \n3104: $$\n3105: \\sum_{k,i} \\mathbb{E}[\\mathcal{L}\\Phi_{k,i}] \\leq -\\kappa_{\\text{pot}} \\sum_{k,i} \\varphi_{k,i} + C_{\\text{interior}}\n3106: \n3107: $$\n3108: \n3109: where $C_{\\text{interior}}$ accounts for particles in the safe interior (where $\\varphi = 0$) and the smooth transition region.\n3110: \n3111: Recall:\n3112: \n3113: $$\n3114: W_b = \\frac{1}{N}\\sum_{k,i} \\varphi_{\\text{barrier}}(x_{k,i})\n3115: \n3116: $$\n3117: \n3118: Thus:\n3119: \n3120: $$\n3121: \\frac{1}{N}\\sum_{k,i} \\mathbb{E}[\\mathcal{L}\\Phi_{k,i}] \\leq -\\kappa_{\\text{pot}} W_b + C_{\\text{pot}}\n3122: \n3123: $$\n3124: \n3125: where $C_{\\text{pot}} = \\frac{C_{\\text{interior}}}{N}$ is independent of $W_b$ (depends only on geometry and equilibrium statistics).\n3126: \n3127: **PART XI: Discrete-Time Version**\n3128: \n3129: By Theorem 3.7.2 (Discrete-Time Inheritance of Generator Drift), the continuous-time drift translates to discrete-time:\n3130: \n3131: $$\n3132: \\mathbb{E}_{\\text{kin}}[\\Delta W_b] \\leq -\\kappa_{\\text{pot}} W_b \\tau + C_{\\text{pot}} \\tau + O(\\tau^2)\n3133: \n3134: $$\n3135: \n3136: For sufficiently small $\\tau$, the $O(\\tau^2)$ term is absorbed into the modified constant.\n3137: \n3138: **Final result:**\n3139: \n3140: $$\n3141: \\boxed{\\mathbb{E}_{\\text{kin}}[\\Delta W_b] \\leq -\\kappa_{\\text{pot}} W_b \\tau + C_{\\text{pot}} \\tau}\n3142: \n3143: $$\n3144: \n3145: **Explicit constants:**\n3146: \n3147: $$\n3148: \\kappa_{\\text{pot}} = \\frac{1}{\\gamma}\\left[\\frac{c}{\\delta}\\alpha_{\\text{boundary}} - \\left(\\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta}K_{\\text{curv}}\\right)\\frac{d\\sigma_{\\max}^2}{2\\gamma}\\right]\n3149: \n3150: $$\n3151: \n3152: $$\n3153: C_{\\text{pot}} = O(1) \\quad \\text{(geometry-dependent)}\n3154: \n3155: $$\n3156: \n3157: **PART XII: Physical Interpretation**\n3158: \n3159: This result demonstrates:\n3160: \n3161: 1. **Confining force creates drift:** The negative alignment $\\langle F, \\nabla\\varphi \\rangle \\leq -\\alpha_{\\text{align}}\\varphi$ ensures particles near the boundary are pushed inward, creating negative drift in $\\varphi$.\n3162: \n3163: 2. **Velocity-weighted correction:** The term $\\epsilon\\langle v, \\nabla\\varphi \\rangle$ with $\\epsilon = \\frac{1}{\\gamma}$ captures particles **moving toward** the boundary, allowing the generator to act on both position and momentum.\n3164: \n3165: 3. **Hessian competition:** The Hessian term $v^T(\\nabla^2\\varphi)v$ represents curvature effects that can add positive drift. For small $c$ (weak barrier strength), this is dominated by the negative alignment term.\n3166: \n3167: 4. **Independent safety mechanism:** This contraction is **independent** of cloning — it's a fundamental property of the confining potential $U$. Combined with the Safe Harbor mechanism (03_cloning.md, Ch 11), this provides **layered defense** against extinction.\n3168: \n3169: 5. **Parameter tradeoff:** Smaller $c$ gives stronger contraction (larger $\\kappa_{\\text{pot}}$) but weaker barrier strength. The choice balances safety (keep $\\varphi$ finite) with convergence speed.",
      "metadata": {
        "label": "proof-thm-boundary-potential-contraction-kinetic"
      },
      "section": "## 7. Boundary Potential Contraction via Confining Potential",
      "raw_directive": "2794: ### 7.4. Proof\n2795: \n2796: :::{prf:proof} Boundary Potential Contraction from Confining Force\n2797: :label: proof-thm-boundary-potential-contraction-kinetic\n2798: **Proof (Velocity-Weighted Lyapunov with Corrected Signs).**\n2799: \n2800: This proof establishes that the confining potential $U$ creates negative drift for the boundary potential $W_b$ through alignment between the inward-pointing force $F = -\\nabla U$ and the outward-pointing barrier gradient $\\nabla\\varphi_{\\text{barrier}}$.\n2801: \n2802: **PART I: Barrier Function Specification**\n2803: \n2804: We use an **exponential-distance barrier** on a boundary layer to ensure controlled derivatives. Let $\\rho: \\mathcal{X}_{\\text{valid}} \\to \\mathbb{R}$ be the **signed distance function**:\n2805: \n2806: $$\n2807: \\rho(x) = \\begin{cases}\n2808: -\\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) & \\text{if } x \\in \\mathcal{X}_{\\text{valid}} \\\\\n2809: 0 & \\text{if } x \\in \\partial\\mathcal{X}_{\\text{valid}}\n2810: \\end{cases}\n2811: \n2812: $$\n2813: \n2814: so $\\rho < 0$ in the interior and $\\nabla\\rho = \\vec{n}(x)$ (outward unit normal) near the boundary.\n2815: \n2816: **Barrier construction:** Fix $\\delta > 0$ (boundary layer width) and $c > 0$ (barrier strength). Define:\n2817: \n2818: $$\n2819: \\varphi_{\\text{barrier}}(x) = \\begin{cases}\n2820: 0 & \\text{if } \\rho(x) < -\\delta \\text{ (safe interior)} \\\\\n2821: \\exp\\left(\\frac{c \\cdot \\rho(x)}{\\delta}\\right) & \\text{if } -\\delta \\leq \\rho(x) < 0 \\text{ (boundary layer)} \\\\\n2822: +\\infty & \\text{if } x \\notin \\mathcal{X}_{\\text{valid}}\n2823: \\end{cases}\n2824: \n2825: $$\n2826: \n2827: with smooth transition at $\\rho = -\\delta$.\n2828: \n2829: **Geometric properties in the boundary layer** ($-\\delta \\leq \\rho < 0$):\n2830: \n2831: 1. **Gradient alignment:**\n2832: \n2833: $$\n2834: \\nabla\\varphi = \\frac{c}{\\delta} \\varphi \\cdot \\nabla\\rho = \\frac{c}{\\delta} \\varphi \\cdot \\vec{n}(x)\n2835: \n2836: $$\n2837: \n2838: where $\\vec{n}(x)$ is the outward unit normal. This gives:\n2839: \n2840: $$\n2841: \\|\\nabla\\varphi\\| = \\frac{c}{\\delta} \\varphi\n2842: \n2843: $$\n2844: \n2845: 2. **Hessian bound:** Assuming $\\mathcal{X}_{\\text{valid}}$ has $C^2$ boundary with bounded principal curvatures $\\|\\nabla\\vec{n}\\| \\leq K_{\\text{curv}}$:\n2846: \n2847: $$\n2848: \\nabla^2\\varphi = \\frac{c}{\\delta}\\varphi \\nabla\\vec{n} + \\left(\\frac{c}{\\delta}\\right)^2 \\varphi \\, \\vec{n}\\vec{n}^T\n2849: \n2850: $$\n2851: \n2852: Thus:\n2853: \n2854: $$\n2855: v^T (\\nabla^2\\varphi) v \\leq \\varphi \\left[\\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta} K_{\\text{curv}}\\right] \\|v\\|^2\n2856: \n2857: $$\n2858: \n2859: **PART II: Compatibility Condition (Corrected Sign)**\n2860: \n2861: By Axiom 3.3.1 part 4, the confining force satisfies:\n2862: \n2863: $$\n2864: \\langle \\vec{n}(x), F(x) \\rangle \\leq -\\alpha_{\\text{boundary}} \\quad \\text{for } \\text{dist}(x, \\partial\\mathcal{X}_{\\text{valid}}) < \\delta_{\\text{boundary}}\n2865: \n2866: $$\n2867: \n2868: where $\\vec{n}(x)$ is the **outward** unit normal.\n2869: \n2870: In the boundary layer, using $\\nabla\\varphi = \\frac{c}{\\delta}\\varphi \\cdot \\vec{n}$:\n2871: \n2872: $$\n2873: \\langle F(x), \\nabla\\varphi(x) \\rangle = \\frac{c}{\\delta}\\varphi(x) \\langle F(x), \\vec{n}(x) \\rangle \\leq -\\frac{c}{\\delta} \\alpha_{\\text{boundary}} \\varphi(x)\n2874: \n2875: $$\n2876: \n2877: **Key inequality (correct sign):**\n2878: \n2879: $$\n2880: \\langle F(x), \\nabla\\varphi(x) \\rangle \\leq -\\alpha_{\\text{align}} \\varphi(x)\n2881: \n2882: $$\n2883: \n2884: where $\\alpha_{\\text{align}} := \\frac{c}{\\delta} \\alpha_{\\text{boundary}} > 0$.\n2885: \n2886: **Physical interpretation:** The confining force $F$ points **inward** (toward safe region), the barrier gradient $\\nabla\\varphi$ points **outward** (away from safe region), so their inner product is **negative**. This creates the **negative drift** needed for contraction.\n2887: \n2888: **PART III: Velocity-Weighted Lyapunov Function**\n2889: \n2890: For particle $i$, define:\n2891: \n2892: $$\n2893: \\Phi_i := \\varphi_i + \\epsilon \\langle v_i, \\nabla\\varphi_i \\rangle\n2894: \n2895: $$\n2896: \n2897: where $\\varphi_i = \\varphi_{\\text{barrier}}(x_i)$ and $\\epsilon > 0$ is a coupling parameter (to be optimized).\n2898: \n2899: **Rationale:**\n2900: - $\\varphi_i$ measures current proximity to boundary\n2901: - $\\langle v_i, \\nabla\\varphi_i \\rangle$ measures velocity component **toward** boundary\n2902: - The coupling balances position and velocity contributions to achieve net contraction\n2903: \n2904: **PART IV: Generator Calculation (Corrected)**\n2905: \n2906: Apply the Fokker-Planck generator $\\mathcal{L}$ from Definition 3.7.1:\n2907: \n2908: $$\n2909: \\mathcal{L}f = v \\cdot \\nabla_x f + (F - \\gamma v) \\cdot \\nabla_v f + \\frac{1}{2}\\text{Tr}(A \\nabla_v^2 f)\n2910: \n2911: $$\n2912: \n2913: where $A = \\Sigma\\Sigma^T$ is the velocity diffusion matrix.\n2914: \n2915: **Term 1: Generator of $\\varphi_i$**\n2916: \n2917: Since $\\varphi_i = \\varphi(x_i)$ (no velocity dependence):\n2918: \n2919: $$\n2920: \\mathcal{L}\\varphi_i = v_i \\cdot \\nabla\\varphi_i + (F(x_i) - \\gamma v_i) \\cdot \\underbrace{\\nabla_v \\varphi_i}_{=0} + \\frac{1}{2}\\text{Tr}(A_i \\underbrace{\\nabla_v^2 \\varphi_i}_{=0})\n2921: \n2922: $$\n2923: \n2924: $$\n2925: = v_i \\cdot \\nabla\\varphi_i\n2926: \n2927: $$\n2928: \n2929: **Term 2: Generator of $\\langle v_i, \\nabla\\varphi_i \\rangle$ (CRITICAL CORRECTION)**\n2930: \n2931: Let $g(x, v) := \\langle v, \\nabla\\varphi(x) \\rangle$.\n2932: \n2933: **Velocity derivatives:**\n2934: \n2935: $$\n2936: \\nabla_v g = \\nabla\\varphi(x)\n2937: \n2938: $$\n2939: \n2940: $$\n2941: \\nabla_v^2 g = 0 \\quad \\text{(linear in } v \\text{, no second derivative!)}\n2942: \n2943: $$\n2944: \n2945: **Position derivatives:**\n2946: \n2947: $$\n2948: \\nabla_x g = (\\nabla^2\\varphi) v\n2949: \n2950: $$\n2951: \n2952: so:\n2953: \n2954: $$\n2955: v \\cdot \\nabla_x g = v^T (\\nabla^2\\varphi) v\n2956: \n2957: $$\n2958: \n2959: **Generator:**\n2960: \n2961: $$\n2962: \\mathcal{L}g = v^T (\\nabla^2\\varphi) v + (F - \\gamma v) \\cdot \\nabla\\varphi + \\frac{1}{2}\\text{Tr}(A \\underbrace{\\nabla_v^2 g}_{=0})\n2963: \n2964: $$\n2965: \n2966: $$\n2967: = v^T (\\nabla^2\\varphi) v + \\langle F, \\nabla\\varphi \\rangle - \\gamma \\langle v, \\nabla\\varphi \\rangle\n2968: \n2969: $$\n2970: \n2971: **Critical note:** The diffusion term vanishes because $g$ is **linear in $v$**, so $\\nabla_v^2 g = 0$. The original proof incorrectly included $\\frac{1}{2}\\text{Tr}(A \\nabla^2\\varphi)$, which mixes velocity diffusion with position Hessian — this is **wrong**.\n2972: \n2973: **PART V: Combine Terms**\n2974: \n2975: $$\n2976: \\mathcal{L}\\Phi_i = \\mathcal{L}\\varphi_i + \\epsilon \\mathcal{L}\\langle v_i, \\nabla\\varphi_i \\rangle\n2977: \n2978: $$\n2979: \n2980: $$\n2981: = v_i \\cdot \\nabla\\varphi_i + \\epsilon\\left[v_i^T (\\nabla^2\\varphi_i) v_i + \\langle F(x_i), \\nabla\\varphi_i \\rangle - \\gamma \\langle v_i, \\nabla\\varphi_i \\rangle\\right]\n2982: \n2983: $$\n2984: \n2985: $$\n2986: = (1 - \\epsilon\\gamma) \\langle v_i, \\nabla\\varphi_i \\rangle + \\epsilon \\langle F(x_i), \\nabla\\varphi_i \\rangle + \\epsilon v_i^T (\\nabla^2\\varphi_i) v_i\n2987: \n2988: $$\n2989: \n2990: **PART VI: Optimal Choice of $\\epsilon$**\n2991: \n2992: Choose $\\epsilon = \\frac{1}{\\gamma}$ to **completely eliminate** the cross-term:\n2993: \n2994: $$\n2995: 1 - \\epsilon\\gamma = 1 - \\frac{1}{\\gamma} \\cdot \\gamma = 0\n2996: \n2997: $$\n2998: \n2999: This gives:\n3000: \n3001: $$\n3002: \\mathcal{L}\\Phi_i = \\frac{1}{\\gamma}\\langle F(x_i), \\nabla\\varphi_i \\rangle + \\frac{1}{\\gamma} v_i^T (\\nabla^2\\varphi_i) v_i\n3003: \n3004: $$\n3005: \n3006: **PART VII: Apply Corrected Compatibility and Hessian Bounds**\n3007: \n3008: In the boundary layer ($-\\delta \\leq \\rho(x_i) < 0$):\n3009: \n3010: **Compatibility (corrected sign):**\n3011: \n3012: $$\n3013: \\langle F(x_i), \\nabla\\varphi_i \\rangle \\leq -\\alpha_{\\text{align}} \\varphi_i\n3014: \n3015: $$\n3016: \n3017: where $\\alpha_{\\text{align}} = \\frac{c}{\\delta} \\alpha_{\\text{boundary}}$.\n3018: \n3019: **Hessian bound:**\n3020: \n3021: $$\n3022: v_i^T (\\nabla^2\\varphi_i) v_i \\leq \\varphi_i \\left[\\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta} K_{\\text{curv}}\\right] \\|v_i\\|^2\n3023: \n3024: $$\n3025: \n3026: Define:\n3027: \n3028: $$\n3029: K_{\\varphi} := \\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta} K_{\\text{curv}}\n3030: \n3031: $$\n3032: \n3033: **PART VIII: Substitute and Bound**\n3034: \n3035: $$\n3036: \\mathcal{L}\\Phi_i \\leq \\frac{1}{\\gamma}\\left[-\\alpha_{\\text{align}} \\varphi_i + K_{\\varphi} \\varphi_i \\|v_i\\|^2\\right]\n3037: \n3038: $$\n3039: \n3040: $$\n3041: = \\frac{\\varphi_i}{\\gamma}\\left[K_{\\varphi} \\|v_i\\|^2 - \\alpha_{\\text{align}}\\right]\n3042: \n3043: $$\n3044: \n3045: **Velocity moment bound from Chapter 5:** By Theorem 5.3.1, the kinetic operator maintains:\n3046: \n3047: $$\n3048: \\mathbb{E}[\\|v_i\\|^2] \\leq V_{\\text{Var},v}^{\\text{eq}} := \\frac{d\\sigma_{\\max}^2}{2\\gamma}\n3049: \n3050: $$\n3051: \n3052: for all $i$ in equilibrium (or near-equilibrium during drift analysis).\n3053: \n3054: **Taking expectation:**\n3055: \n3056: $$\n3057: \\mathbb{E}[\\mathcal{L}\\Phi_i] \\leq \\frac{\\varphi_i}{\\gamma}\\left[K_{\\varphi} V_{\\text{Var},v}^{\\text{eq}} - \\alpha_{\\text{align}}\\right]\n3058: \n3059: $$\n3060: \n3061: **PART IX: Barrier Parameter Selection for Contraction**\n3062: \n3063: To ensure **negative drift**, we need:\n3064: \n3065: $$\n3066: K_{\\varphi} V_{\\text{Var},v}^{\\text{eq}} < \\alpha_{\\text{align}}\n3067: \n3068: $$\n3069: \n3070: Substituting definitions:\n3071: \n3072: $$\n3073: \\left[\\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta} K_{\\text{curv}}\\right] \\frac{d\\sigma_{\\max}^2}{2\\gamma} < \\frac{c}{\\delta} \\alpha_{\\text{boundary}}\n3074: \n3075: $$\n3076: \n3077: Multiply both sides by $\\frac{\\delta}{c}$ (assuming $c > 0$):\n3078: \n3079: $$\n3080: \\left[\\frac{c}{\\delta} + K_{\\text{curv}}\\right] \\frac{d\\sigma_{\\max}^2}{2\\gamma} < \\alpha_{\\text{boundary}}\n3081: \n3082: $$\n3083: \n3084: **Sufficient condition:** Choose $c$ small enough:\n3085: \n3086: $$\n3087: c < \\delta \\left[\\frac{2\\gamma \\alpha_{\\text{boundary}}}{d\\sigma_{\\max}^2} - K_{\\text{curv}}\\right]\n3088: \n3089: $$\n3090: \n3091: This is **always achievable** provided $\\alpha_{\\text{boundary}} > \\frac{K_{\\text{curv}} d\\sigma_{\\max}^2}{2\\gamma}$, which is guaranteed by Axiom 3.3.1 part 4 for sufficiently strong confining potential.\n3092: \n3093: **Resulting contraction rate:**\n3094: \n3095: $$\n3096: \\kappa_{\\text{pot}} := \\frac{1}{\\gamma}\\left[\\alpha_{\\text{align}} - K_{\\varphi} V_{\\text{Var},v}^{\\text{eq}}\\right] = \\frac{1}{\\gamma}\\left[\\frac{c}{\\delta}\\alpha_{\\text{boundary}} - \\left(\\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta}K_{\\text{curv}}\\right)\\frac{d\\sigma_{\\max}^2}{2\\gamma}\\right] > 0\n3097: \n3098: $$\n3099: \n3100: **PART X: Aggregate Over All Particles**\n3101: \n3102: Sum over all particles:\n3103: \n3104: $$\n3105: \\sum_{k,i} \\mathbb{E}[\\mathcal{L}\\Phi_{k,i}] \\leq -\\kappa_{\\text{pot}} \\sum_{k,i} \\varphi_{k,i} + C_{\\text{interior}}\n3106: \n3107: $$\n3108: \n3109: where $C_{\\text{interior}}$ accounts for particles in the safe interior (where $\\varphi = 0$) and the smooth transition region.\n3110: \n3111: Recall:\n3112: \n3113: $$\n3114: W_b = \\frac{1}{N}\\sum_{k,i} \\varphi_{\\text{barrier}}(x_{k,i})\n3115: \n3116: $$\n3117: \n3118: Thus:\n3119: \n3120: $$\n3121: \\frac{1}{N}\\sum_{k,i} \\mathbb{E}[\\mathcal{L}\\Phi_{k,i}] \\leq -\\kappa_{\\text{pot}} W_b + C_{\\text{pot}}\n3122: \n3123: $$\n3124: \n3125: where $C_{\\text{pot}} = \\frac{C_{\\text{interior}}}{N}$ is independent of $W_b$ (depends only on geometry and equilibrium statistics).\n3126: \n3127: **PART XI: Discrete-Time Version**\n3128: \n3129: By Theorem 3.7.2 (Discrete-Time Inheritance of Generator Drift), the continuous-time drift translates to discrete-time:\n3130: \n3131: $$\n3132: \\mathbb{E}_{\\text{kin}}[\\Delta W_b] \\leq -\\kappa_{\\text{pot}} W_b \\tau + C_{\\text{pot}} \\tau + O(\\tau^2)\n3133: \n3134: $$\n3135: \n3136: For sufficiently small $\\tau$, the $O(\\tau^2)$ term is absorbed into the modified constant.\n3137: \n3138: **Final result:**\n3139: \n3140: $$\n3141: \\boxed{\\mathbb{E}_{\\text{kin}}[\\Delta W_b] \\leq -\\kappa_{\\text{pot}} W_b \\tau + C_{\\text{pot}} \\tau}\n3142: \n3143: $$\n3144: \n3145: **Explicit constants:**\n3146: \n3147: $$\n3148: \\kappa_{\\text{pot}} = \\frac{1}{\\gamma}\\left[\\frac{c}{\\delta}\\alpha_{\\text{boundary}} - \\left(\\left(\\frac{c}{\\delta}\\right)^2 + \\frac{c}{\\delta}K_{\\text{curv}}\\right)\\frac{d\\sigma_{\\max}^2}{2\\gamma}\\right]\n3149: \n3150: $$\n3151: \n3152: $$\n3153: C_{\\text{pot}} = O(1) \\quad \\text{(geometry-dependent)}\n3154: \n3155: $$\n3156: \n3157: **PART XII: Physical Interpretation**\n3158: \n3159: This result demonstrates:\n3160: \n3161: 1. **Confining force creates drift:** The negative alignment $\\langle F, \\nabla\\varphi \\rangle \\leq -\\alpha_{\\text{align}}\\varphi$ ensures particles near the boundary are pushed inward, creating negative drift in $\\varphi$.\n3162: \n3163: 2. **Velocity-weighted correction:** The term $\\epsilon\\langle v, \\nabla\\varphi \\rangle$ with $\\epsilon = \\frac{1}{\\gamma}$ captures particles **moving toward** the boundary, allowing the generator to act on both position and momentum.\n3164: \n3165: 3. **Hessian competition:** The Hessian term $v^T(\\nabla^2\\varphi)v$ represents curvature effects that can add positive drift. For small $c$ (weak barrier strength), this is dominated by the negative alignment term.\n3166: \n3167: 4. **Independent safety mechanism:** This contraction is **independent** of cloning — it's a fundamental property of the confining potential $U$. Combined with the Safe Harbor mechanism (03_cloning.md, Ch 11), this provides **layered defense** against extinction.\n3168: \n3169: 5. **Parameter tradeoff:** Smaller $c$ gives stronger contraction (larger $\\kappa_{\\text{pot}}$) but weaker barrier strength. The choice balances safety (keep $\\varphi$ finite) with convergence speed.\n3170: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "05_kinetic_contraction",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. Boundary Potential Contraction via Confining Potential"
      }
    }
  ]
}