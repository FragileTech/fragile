{
  "document_id": "04_wasserstein_contraction",
  "stage": "directives",
  "directive_type": "proof",
  "generated_at": "2025-11-09T21:44:26.140431+00:00",
  "count": 2,
  "items": [
    {
      "directive_type": "proof",
      "label": "proof-lem-cluster-alignment",
      "title": null,
      "start_line": 548,
      "end_line": 690,
      "header_lines": [
        549
      ],
      "content_start": 551,
      "content_end": 689,
      "content": "551: :label: proof-lem-cluster-alignment\n552: \n553: This is a **static proof** using only framework axioms and proven results from [03_cloning](03_cloning).\n554: \n555: **Step 1: Fitness Valley Exists (Static)**\n556: \n557: By the Confining Potential axiom (Axiom 2.1.1) and Environmental Richness axiom (Axiom 4.1.1), for separated local maxima $\\bar{x}_1$ and $\\bar{x}_2$, there exists a fitness valley:\n558: \n559: There exists $x_{\\text{valley}} \\in [\\bar{x}_1, \\bar{x}_2]$ with:\n560: \n561: $$\n562: F(x_{\\text{valley}}) < \\min(F(\\bar{x}_1), F(\\bar{x}_2)) - \\Delta_{\\text{valley}}\n563: \n564: $$\n565: \n566: for some $\\Delta_{\\text{valley}} > 0$ depending on $L$ and the landscape curvature.\n567: \n568: This is a **geometric fact** about the fitness function, not a dynamical consequence.\n569: \n570: **Step 2: Stability Condition Guarantees Fitness Ordering (Static)**\n571: \n572: By the Stability Condition (Theorem 7.5.2.4, [03_cloning](03_cloning), Section 7.5.2.4):\n573: \n574: $$\n575: \\mathbb{E}[V_{\\text{fit}} | i \\in H_k] < \\mathbb{E}[V_{\\text{fit}} | i \\in L_k]\n576: \n577: $$\n578: \n579: This is a **proven axiom** (derived from confining potential + reward structure), not a consequence of dynamics.\n580: \n581: Since $I_k \\subseteq H_k$ and $L_k \\subseteq J_k$:\n582: \n583: $$\n584: \\mathbb{E}[V_{\\text{fit}} | i \\in I_k] < \\mathbb{E}[V_{\\text{fit}} | i \\in J_k]\n585: \n586: $$\n587: \n588: **Step 3: Phase-Space Packing Guarantees Spatial Separation (Geometric)**\n589: \n590: By Corollary {prf:ref}`cor-between-group-dominance` (from Phase-Space Packing Lemma 6.4.1):\n591: \n592: $$\n593: \\|\\mu_x(I_1) - \\mu_x(J_1)\\| \\geq \\sqrt{c_{\\text{sep}}(\\varepsilon) V_{\\text{struct}}} =: R_{\\text{sep}}\n594: \n595: $$\n596: \n597: For $V_{\\text{struct}} > R^2_{\\text{spread}}$, this is a substantial separation.\n598: \n599: **Step 4: Geometric Consequence of Clustering Algorithm**\n600: \n601: Define the unit direction vector:\n602: \n603: $$\n604: u := \\frac{\\bar{x}_1 - \\bar{x}_2}{L}\n605: \n606: $$\n607: \n608: **Claim**: The target set $I_1$ cannot have its barycenter $\\mu_x(I_1)$ pointing toward $\\bar{x}_2$ (negative projection onto $u$).\n609: \n610: **Proof using clustering geometry**:\n611: \n612: By definition, $I_1 = U_1 \\cap H_1(\\varepsilon)$ where $H_1(\\varepsilon)$ is the high-error set identified by the clustering algorithm (Definition 6.3 in [03_cloning](03_cloning), line 2351).\n613: \n614: The clustering algorithm identifies $H_1$ as **spatially separated outlier clusters** with respect to the swarm's main body. Specifically, the algorithm constructs phase-space distance thresholds to identify walkers that are geometrically isolated.\n615: \n616: **Key geometric property**: For two separated swarms with barycenters $\\bar{x}_1$ and $\\bar{x}_2$ at distance $L > D_{\\min}(\\varepsilon)$:\n617: \n618: 1. The low-error set $L_1$ clusters near $\\bar{x}_1$ (by construction of clustering algorithm)\n619: 2. The complement $J_1 = \\mathcal{A}_1 \\setminus I_1$ contains $L_1$, so $\\mu_x(J_1) \\approx \\bar{x}_1$\n620: 3. The high-error set $H_1$ consists of outliers **away from** $\\bar{x}_1$\n621: \n622: **Geometric constraint from separation**: Given the swarm separation $L$ and the clustering threshold $D_{\\text{diam}}(\\varepsilon) = c_d \\varepsilon$ (from Phase-Space Packing Lemma 6.4.1):\n623: \n624: - If $\\mu_x(I_1)$ pointed toward $\\bar{x}_2$ (i.e., $\\langle \\mu_x(I_1) - \\bar{x}_1, u \\rangle < 0$), then walkers in $I_1$ would be in the region between the two swarms\n625: - But this \"inter-swarm\" region is at distance $< L/2$ from $\\bar{x}_1$\n626: - For separated swarms with $L \\gg D_{\\text{diam}}(\\varepsilon)$, such walkers would not be classified as outliers by the clustering algorithm\n627: - This contradicts $I_1 \\subseteq H_1$ (outlier set)\n628: \n629: **Conclusion**: By the geometric construction of the clustering algorithm, we must have:\n630: \n631: $$\n632: \\langle \\mu_x(I_1) - \\bar{x}_1, u \\rangle > 0\n633: \n634: $$\n635: \n636: This follows from the clustering algorithm's identification of outliers as spatially separated from the main body, combined with the geometric fact that the \"toward other swarm\" direction is not classified as an outlier direction when swarms are sufficiently separated.\n637: \n638: **Quantitative Justification**: The separation condition $L > D_{\\min}(\\varepsilon)$ is chosen such that $D_{\\min}(\\varepsilon) \\geq c_{\\text{geom}} \\cdot R_{\\text{spread}}(\\varepsilon)$ for a sufficiently large geometric constant $c_{\\text{geom}} > 0$ (typically $c_{\\text{geom}} \\geq 10$). By Definition 6.3 (Step 3, outlier cluster identification), the clustering algorithm sorts clusters by their contribution to hypocoercive variance:\n639: \n640: $$\n641: \\text{Contrib}(G_m) := |G_m| \\left(\\|\\mu_{x,m} - \\mu_x\\|^2 + \\lambda_v \\|\\mu_{v,m} - \\mu_v\\|^2\\right)\n642: $$\n643: \n644: where $\\mu_x$ is the global center of mass. For two swarms of comparable mass separated by $L \\gg R_{\\text{spread}}$, the global center lies approximately at the midpoint: $\\mu_x \\approx (\\bar{x}_1 + \\bar{x}_2)/2$. Therefore:\n645: \n646: - **Far-side clusters** (on opposite side from $\\bar{x}_2$): Distance from $\\mu_x$ is $\\approx L/2 + O(R_{\\text{spread}})$\n647: - **Inter-swarm clusters** (between barycenters): Distance from $\\mu_x$ is $< L/2$\n648: \n649: For $L \\geq c_{\\text{geom}} \\cdot R_{\\text{spread}}$ with $c_{\\text{geom}} \\gg 1$:\n650: \n651: $$\n652: \\|\\mu_{x,m}^{\\text{far}} - \\mu_x\\|^2 \\approx (L/2 + R_{\\text{spread}})^2 \\geq (L/2)^2 (1 + 2/c_{\\text{geom}})^2 \\gg (L/2)^2 \\gg \\|\\mu_{x,m}^{\\text{inter}} - \\mu_x\\|^2\n653: $$\n654: \n655: Therefore, the variance contribution ordering (Step 3 of Definition 6.3) necessarily selects far-side clusters as outliers before any inter-swarm clusters. This establishes that for the hypothesis $L > D_{\\min}(\\varepsilon)$, the target set $I_k$ consists of walkers on the far side (away from the other swarm's barycenter), as claimed.\n656: \n657: **Step 5: Quantitative Bound**\n658: \n659: By Step 4, we have established the directional constraint:\n660: \n661: $$\n662: \\langle \\mu_x(I_1) - \\bar{x}_1, u \\rangle > 0\n663: \n664: $$\n665: \n666: To obtain a quantitative lower bound, we use the cluster separation from Step 3: $\\|\\mu_x(I_1) - \\mu_x(J_1)\\| \\geq R_{\\text{sep}} := \\sqrt{c_{\\text{sep}}(\\varepsilon) V_{\\text{struct}}}$.\n667: \n668: By the low-error property of $J_1$, its barycenter satisfies $\\mu_x(J_1) \\approx \\bar{x}_1$ (within $O(R_{\\text{spread}})$).\n669: \n670: Using the triangle inequality and the directional constraint from Step 4:\n671: \n672: $$\n673: \\langle \\mu_x(I_1) - \\mu_x(J_1), \\bar{x}_1 - \\bar{x}_2 \\rangle \\approx \\langle \\mu_x(I_1) - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle > 0\n674: \n675: $$\n676: \n677: **Geometric alignment constant**: The precise quantitative bound depends on the geometric configuration of the clusters. Since both $\\mu_x(I_1) - \\bar{x}_1$ and $\\bar{x}_1 - \\bar{x}_2$ point in the same half-space (by Step 4), their inner product is positive.\n678: \n679: The alignment constant $c_{\\text{align}}(\\varepsilon) > 0$ is defined implicitly by:\n680: \n681: $$\n682: \\langle \\mu_x(I_1) - \\mu_x(J_1), \\bar{x}_1 - \\bar{x}_2 \\rangle \\geq c_{\\text{align}}(\\varepsilon) \\|\\mu_x(I_1) - \\mu_x(J_1)\\| \\cdot L\n683: \n684: $$\n685: \n686: The existence of such a positive constant follows from:\n687: 1. The directional constraint $\\langle \\mu_x(I_1) - \\bar{x}_1, u \\rangle > 0$ (Step 4)\n688: 2. The cluster separation bound $\\|\\mu_x(I_1) - \\mu_x(J_1)\\| \\geq R_{\\text{sep}}$ (Step 3)\n689: 3. The separation condition $L > D_{\\min}(\\varepsilon)$ (hypothesis)",
      "metadata": {
        "label": "proof-lem-cluster-alignment"
      },
      "section": "## 4. Cluster-Level Outlier Alignment",
      "references": [
        "cor-between-group-dominance"
      ],
      "raw_directive": "548: :::\n549: \n550: :::{prf:proof}\n551: :label: proof-lem-cluster-alignment\n552: \n553: This is a **static proof** using only framework axioms and proven results from [03_cloning](03_cloning).\n554: \n555: **Step 1: Fitness Valley Exists (Static)**\n556: \n557: By the Confining Potential axiom (Axiom 2.1.1) and Environmental Richness axiom (Axiom 4.1.1), for separated local maxima $\\bar{x}_1$ and $\\bar{x}_2$, there exists a fitness valley:\n558: \n559: There exists $x_{\\text{valley}} \\in [\\bar{x}_1, \\bar{x}_2]$ with:\n560: \n561: $$\n562: F(x_{\\text{valley}}) < \\min(F(\\bar{x}_1), F(\\bar{x}_2)) - \\Delta_{\\text{valley}}\n563: \n564: $$\n565: \n566: for some $\\Delta_{\\text{valley}} > 0$ depending on $L$ and the landscape curvature.\n567: \n568: This is a **geometric fact** about the fitness function, not a dynamical consequence.\n569: \n570: **Step 2: Stability Condition Guarantees Fitness Ordering (Static)**\n571: \n572: By the Stability Condition (Theorem 7.5.2.4, [03_cloning](03_cloning), Section 7.5.2.4):\n573: \n574: $$\n575: \\mathbb{E}[V_{\\text{fit}} | i \\in H_k] < \\mathbb{E}[V_{\\text{fit}} | i \\in L_k]\n576: \n577: $$\n578: \n579: This is a **proven axiom** (derived from confining potential + reward structure), not a consequence of dynamics.\n580: \n581: Since $I_k \\subseteq H_k$ and $L_k \\subseteq J_k$:\n582: \n583: $$\n584: \\mathbb{E}[V_{\\text{fit}} | i \\in I_k] < \\mathbb{E}[V_{\\text{fit}} | i \\in J_k]\n585: \n586: $$\n587: \n588: **Step 3: Phase-Space Packing Guarantees Spatial Separation (Geometric)**\n589: \n590: By Corollary {prf:ref}`cor-between-group-dominance` (from Phase-Space Packing Lemma 6.4.1):\n591: \n592: $$\n593: \\|\\mu_x(I_1) - \\mu_x(J_1)\\| \\geq \\sqrt{c_{\\text{sep}}(\\varepsilon) V_{\\text{struct}}} =: R_{\\text{sep}}\n594: \n595: $$\n596: \n597: For $V_{\\text{struct}} > R^2_{\\text{spread}}$, this is a substantial separation.\n598: \n599: **Step 4: Geometric Consequence of Clustering Algorithm**\n600: \n601: Define the unit direction vector:\n602: \n603: $$\n604: u := \\frac{\\bar{x}_1 - \\bar{x}_2}{L}\n605: \n606: $$\n607: \n608: **Claim**: The target set $I_1$ cannot have its barycenter $\\mu_x(I_1)$ pointing toward $\\bar{x}_2$ (negative projection onto $u$).\n609: \n610: **Proof using clustering geometry**:\n611: \n612: By definition, $I_1 = U_1 \\cap H_1(\\varepsilon)$ where $H_1(\\varepsilon)$ is the high-error set identified by the clustering algorithm (Definition 6.3 in [03_cloning](03_cloning), line 2351).\n613: \n614: The clustering algorithm identifies $H_1$ as **spatially separated outlier clusters** with respect to the swarm's main body. Specifically, the algorithm constructs phase-space distance thresholds to identify walkers that are geometrically isolated.\n615: \n616: **Key geometric property**: For two separated swarms with barycenters $\\bar{x}_1$ and $\\bar{x}_2$ at distance $L > D_{\\min}(\\varepsilon)$:\n617: \n618: 1. The low-error set $L_1$ clusters near $\\bar{x}_1$ (by construction of clustering algorithm)\n619: 2. The complement $J_1 = \\mathcal{A}_1 \\setminus I_1$ contains $L_1$, so $\\mu_x(J_1) \\approx \\bar{x}_1$\n620: 3. The high-error set $H_1$ consists of outliers **away from** $\\bar{x}_1$\n621: \n622: **Geometric constraint from separation**: Given the swarm separation $L$ and the clustering threshold $D_{\\text{diam}}(\\varepsilon) = c_d \\varepsilon$ (from Phase-Space Packing Lemma 6.4.1):\n623: \n624: - If $\\mu_x(I_1)$ pointed toward $\\bar{x}_2$ (i.e., $\\langle \\mu_x(I_1) - \\bar{x}_1, u \\rangle < 0$), then walkers in $I_1$ would be in the region between the two swarms\n625: - But this \"inter-swarm\" region is at distance $< L/2$ from $\\bar{x}_1$\n626: - For separated swarms with $L \\gg D_{\\text{diam}}(\\varepsilon)$, such walkers would not be classified as outliers by the clustering algorithm\n627: - This contradicts $I_1 \\subseteq H_1$ (outlier set)\n628: \n629: **Conclusion**: By the geometric construction of the clustering algorithm, we must have:\n630: \n631: $$\n632: \\langle \\mu_x(I_1) - \\bar{x}_1, u \\rangle > 0\n633: \n634: $$\n635: \n636: This follows from the clustering algorithm's identification of outliers as spatially separated from the main body, combined with the geometric fact that the \"toward other swarm\" direction is not classified as an outlier direction when swarms are sufficiently separated.\n637: \n638: **Quantitative Justification**: The separation condition $L > D_{\\min}(\\varepsilon)$ is chosen such that $D_{\\min}(\\varepsilon) \\geq c_{\\text{geom}} \\cdot R_{\\text{spread}}(\\varepsilon)$ for a sufficiently large geometric constant $c_{\\text{geom}} > 0$ (typically $c_{\\text{geom}} \\geq 10$). By Definition 6.3 (Step 3, outlier cluster identification), the clustering algorithm sorts clusters by their contribution to hypocoercive variance:\n639: \n640: $$\n641: \\text{Contrib}(G_m) := |G_m| \\left(\\|\\mu_{x,m} - \\mu_x\\|^2 + \\lambda_v \\|\\mu_{v,m} - \\mu_v\\|^2\\right)\n642: $$\n643: \n644: where $\\mu_x$ is the global center of mass. For two swarms of comparable mass separated by $L \\gg R_{\\text{spread}}$, the global center lies approximately at the midpoint: $\\mu_x \\approx (\\bar{x}_1 + \\bar{x}_2)/2$. Therefore:\n645: \n646: - **Far-side clusters** (on opposite side from $\\bar{x}_2$): Distance from $\\mu_x$ is $\\approx L/2 + O(R_{\\text{spread}})$\n647: - **Inter-swarm clusters** (between barycenters): Distance from $\\mu_x$ is $< L/2$\n648: \n649: For $L \\geq c_{\\text{geom}} \\cdot R_{\\text{spread}}$ with $c_{\\text{geom}} \\gg 1$:\n650: \n651: $$\n652: \\|\\mu_{x,m}^{\\text{far}} - \\mu_x\\|^2 \\approx (L/2 + R_{\\text{spread}})^2 \\geq (L/2)^2 (1 + 2/c_{\\text{geom}})^2 \\gg (L/2)^2 \\gg \\|\\mu_{x,m}^{\\text{inter}} - \\mu_x\\|^2\n653: $$\n654: \n655: Therefore, the variance contribution ordering (Step 3 of Definition 6.3) necessarily selects far-side clusters as outliers before any inter-swarm clusters. This establishes that for the hypothesis $L > D_{\\min}(\\varepsilon)$, the target set $I_k$ consists of walkers on the far side (away from the other swarm's barycenter), as claimed.\n656: \n657: **Step 5: Quantitative Bound**\n658: \n659: By Step 4, we have established the directional constraint:\n660: \n661: $$\n662: \\langle \\mu_x(I_1) - \\bar{x}_1, u \\rangle > 0\n663: \n664: $$\n665: \n666: To obtain a quantitative lower bound, we use the cluster separation from Step 3: $\\|\\mu_x(I_1) - \\mu_x(J_1)\\| \\geq R_{\\text{sep}} := \\sqrt{c_{\\text{sep}}(\\varepsilon) V_{\\text{struct}}}$.\n667: \n668: By the low-error property of $J_1$, its barycenter satisfies $\\mu_x(J_1) \\approx \\bar{x}_1$ (within $O(R_{\\text{spread}})$).\n669: \n670: Using the triangle inequality and the directional constraint from Step 4:\n671: \n672: $$\n673: \\langle \\mu_x(I_1) - \\mu_x(J_1), \\bar{x}_1 - \\bar{x}_2 \\rangle \\approx \\langle \\mu_x(I_1) - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle > 0\n674: \n675: $$\n676: \n677: **Geometric alignment constant**: The precise quantitative bound depends on the geometric configuration of the clusters. Since both $\\mu_x(I_1) - \\bar{x}_1$ and $\\bar{x}_1 - \\bar{x}_2$ point in the same half-space (by Step 4), their inner product is positive.\n678: \n679: The alignment constant $c_{\\text{align}}(\\varepsilon) > 0$ is defined implicitly by:\n680: \n681: $$\n682: \\langle \\mu_x(I_1) - \\mu_x(J_1), \\bar{x}_1 - \\bar{x}_2 \\rangle \\geq c_{\\text{align}}(\\varepsilon) \\|\\mu_x(I_1) - \\mu_x(J_1)\\| \\cdot L\n683: \n684: $$\n685: \n686: The existence of such a positive constant follows from:\n687: 1. The directional constraint $\\langle \\mu_x(I_1) - \\bar{x}_1, u \\rangle > 0$ (Step 4)\n688: 2. The cluster separation bound $\\|\\mu_x(I_1) - \\mu_x(J_1)\\| \\geq R_{\\text{sep}}$ (Step 3)\n689: 3. The separation condition $L > D_{\\min}(\\varepsilon)$ (hypothesis)\n690: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. Cluster-Level Outlier Alignment"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-main-contraction-full",
      "title": null,
      "start_line": 924,
      "end_line": 1015,
      "header_lines": [
        925
      ],
      "content_start": 927,
      "content_end": 1014,
      "content": "927: :label: proof-thm-main-contraction-full\n928: \n929: **Step 1: Expected Change in Population Cross-Distances**\n930: \n931: By Lemma {prf:ref}`lem-expected-distance-change` and Corollary {prf:ref}`cor-average-cloning`:\n932: \n933: $$\n934: \\mathbb{E}[\\Delta D_{IJ}] \\leq -p_u(\\varepsilon) \\cdot c_{\\text{geom}} \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 + O(\\delta^2)\n935: \n936: $$\n937: \n938: **Step 2: Relating Cluster Separation to Wasserstein Distance**\n939: \n940: By Corollary {prf:ref}`cor-between-group-dominance`:\n941: \n942: $$\n943: f_I f_J \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq c_{\\text{sep}}(\\varepsilon) V_{\\text{struct}}\n944: \n945: $$\n946: \n947: By Lemma {prf:ref}`lem-variance-wasserstein-link` (Structural Variance and Wasserstein Distance Relationship), for separated swarms:\n948: \n949: $$\n950: V_{\\text{struct}} \\geq c_{\\text{link}}^{-} W_2^2(\\mu_1, \\mu_2)\n951: \n952: $$\n953: \n954: where $c_{\\text{link}}^{-} = f_{UH}^2 / c_{\\text{sep}}(\\varepsilon)$ is N-uniform.\n955: \n956: Combining these inequalities:\n957: \n958: $$\n959: f_I f_J \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq c_{\\text{sep}}(\\varepsilon) \\cdot c_{\\text{link}}^{-} W_2^2(\\mu_1, \\mu_2)\n960: \n961: $$\n962: \n963: Therefore:\n964: \n965: $$\n966: \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq \\frac{c_{\\text{sep}}(\\varepsilon) \\cdot c_{\\text{link}}^{-}}{f_I f_J} W_2^2(\\mu_1, \\mu_2)\n967: \n968: $$\n969: \n970: **Step 3: Contraction Bound**\n971: \n972: Combining Steps 1-2:\n973: \n974: $$\n975: \\mathbb{E}[\\Delta W_2^2] \\leq -p_u \\cdot c_{\\text{geom}} \\cdot \\frac{c_{\\text{sep}}}{f_I f_J} W_2^2 + C_W\n976: \n977: $$\n978: \n979: where $C_W = O(d\\delta^2)$ accounts for jitter accumulation.\n980: \n981: Using $f_I \\geq f_{UH}$ and $f_J \\geq 1 - f_{UH} \\geq 1/2$ (for $f_{UH} \\leq 1/2$):\n982: \n983: $$\n984: \\frac{1}{f_I f_J} \\leq \\frac{2}{f_{UH}}\n985: \n986: $$\n987: \n988: Therefore:\n989: \n990: $$\n991: \\mathbb{E}[\\Delta W_2^2] \\leq -\\frac{f_{UH} p_u c_{\\text{geom}} c_{\\text{sep}}}{2} W_2^2 + C_W\n992: \n993: $$\n994: \n995: Define:\n996: \n997: $$\n998: \\kappa_W := \\frac{1}{2} f_{UH}(\\varepsilon) \\cdot p_u(\\varepsilon) \\cdot c_{\\text{geom}} \\cdot c_{\\text{sep}}(\\varepsilon)\n999: \n1000: $$\n1001: \n1002: Then:\n1003: \n1004: $$\n1005: W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2)) = W_2^2(\\mu_1, \\mu_2) + \\mathbb{E}[\\Delta W_2^2] \\leq (1 - \\kappa_W) W_2^2(\\mu_1, \\mu_2) + C_W\n1006: \n1007: $$\n1008: \n1009: **Step 4: N-Uniformity**\n1010: \n1011: All components are N-uniform:\n1012: - $f_{UH}$: Theorem 8.7.1 ([03_cloning](03_cloning), line 5521) ✓\n1013: - $p_u$: Section 8.6.1.1 (line 5521) ✓\n1014: - $c_{\\text{geom}}, c_{\\text{sep}}$: Geometric constants from packing/alignment ✓",
      "metadata": {
        "label": "proof-thm-main-contraction-full"
      },
      "section": "## 6. Main Theorem: Wasserstein-2 Contraction",
      "references": [
        "lem-expected-distance-change",
        "cor-average-cloning",
        "cor-between-group-dominance",
        "lem-variance-wasserstein-link"
      ],
      "raw_directive": "924: :::\n925: \n926: :::{prf:proof}\n927: :label: proof-thm-main-contraction-full\n928: \n929: **Step 1: Expected Change in Population Cross-Distances**\n930: \n931: By Lemma {prf:ref}`lem-expected-distance-change` and Corollary {prf:ref}`cor-average-cloning`:\n932: \n933: $$\n934: \\mathbb{E}[\\Delta D_{IJ}] \\leq -p_u(\\varepsilon) \\cdot c_{\\text{geom}} \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 + O(\\delta^2)\n935: \n936: $$\n937: \n938: **Step 2: Relating Cluster Separation to Wasserstein Distance**\n939: \n940: By Corollary {prf:ref}`cor-between-group-dominance`:\n941: \n942: $$\n943: f_I f_J \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq c_{\\text{sep}}(\\varepsilon) V_{\\text{struct}}\n944: \n945: $$\n946: \n947: By Lemma {prf:ref}`lem-variance-wasserstein-link` (Structural Variance and Wasserstein Distance Relationship), for separated swarms:\n948: \n949: $$\n950: V_{\\text{struct}} \\geq c_{\\text{link}}^{-} W_2^2(\\mu_1, \\mu_2)\n951: \n952: $$\n953: \n954: where $c_{\\text{link}}^{-} = f_{UH}^2 / c_{\\text{sep}}(\\varepsilon)$ is N-uniform.\n955: \n956: Combining these inequalities:\n957: \n958: $$\n959: f_I f_J \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq c_{\\text{sep}}(\\varepsilon) \\cdot c_{\\text{link}}^{-} W_2^2(\\mu_1, \\mu_2)\n960: \n961: $$\n962: \n963: Therefore:\n964: \n965: $$\n966: \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq \\frac{c_{\\text{sep}}(\\varepsilon) \\cdot c_{\\text{link}}^{-}}{f_I f_J} W_2^2(\\mu_1, \\mu_2)\n967: \n968: $$\n969: \n970: **Step 3: Contraction Bound**\n971: \n972: Combining Steps 1-2:\n973: \n974: $$\n975: \\mathbb{E}[\\Delta W_2^2] \\leq -p_u \\cdot c_{\\text{geom}} \\cdot \\frac{c_{\\text{sep}}}{f_I f_J} W_2^2 + C_W\n976: \n977: $$\n978: \n979: where $C_W = O(d\\delta^2)$ accounts for jitter accumulation.\n980: \n981: Using $f_I \\geq f_{UH}$ and $f_J \\geq 1 - f_{UH} \\geq 1/2$ (for $f_{UH} \\leq 1/2$):\n982: \n983: $$\n984: \\frac{1}{f_I f_J} \\leq \\frac{2}{f_{UH}}\n985: \n986: $$\n987: \n988: Therefore:\n989: \n990: $$\n991: \\mathbb{E}[\\Delta W_2^2] \\leq -\\frac{f_{UH} p_u c_{\\text{geom}} c_{\\text{sep}}}{2} W_2^2 + C_W\n992: \n993: $$\n994: \n995: Define:\n996: \n997: $$\n998: \\kappa_W := \\frac{1}{2} f_{UH}(\\varepsilon) \\cdot p_u(\\varepsilon) \\cdot c_{\\text{geom}} \\cdot c_{\\text{sep}}(\\varepsilon)\n999: \n1000: $$\n1001: \n1002: Then:\n1003: \n1004: $$\n1005: W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2)) = W_2^2(\\mu_1, \\mu_2) + \\mathbb{E}[\\Delta W_2^2] \\leq (1 - \\kappa_W) W_2^2(\\mu_1, \\mu_2) + C_W\n1006: \n1007: $$\n1008: \n1009: **Step 4: N-Uniformity**\n1010: \n1011: All components are N-uniform:\n1012: - $f_{UH}$: Theorem 8.7.1 ([03_cloning](03_cloning), line 5521) ✓\n1013: - $p_u$: Section 8.6.1.1 (line 5521) ✓\n1014: - $c_{\\text{geom}}, c_{\\text{sep}}$: Geometric constants from packing/alignment ✓\n1015: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. Main Theorem: Wasserstein-2 Contraction"
      }
    }
  ]
}