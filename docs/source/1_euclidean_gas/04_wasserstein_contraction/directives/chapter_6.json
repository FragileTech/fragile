{
  "chapter_index": 6,
  "section_id": "## 6. Main Theorem: Wasserstein-2 Contraction",
  "directive_count": 3,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-wasserstein-population-bound",
      "title": "Wasserstein Distance and Population Cross-Distances",
      "start_line": 854,
      "end_line": 887,
      "header_lines": [
        855
      ],
      "content_start": 857,
      "content_end": 886,
      "content": "857: :label: lem-wasserstein-population-bound\n858: \n859: For two swarms with partitions $(I_1, J_1)$ and $(I_2, J_2)$, the Wasserstein-2 squared distance satisfies:\n860: \n861: $$\n862: W_2^2(\\mu_1, \\mu_2) \\leq f_{I,1} f_{I,2} D_{II} + f_{I,1} f_{J,2} D_{IJ} + f_{J,1} f_{I,2} D_{JI} + f_{J,1} f_{J,2} D_{JJ}\n863: \n864: $$\n865: \n866: where $f_{I,k} = |I_k|/N$ and $D_{AB}$ are the population cross-distances from Lemma {prf:ref}`lem-cross-swarm-distance`.\n867: \n868: **Proof:**\n869: \n870: The Wasserstein-2 distance for empirical measures is:\n871: \n872: $$\n873: W_2^2(\\mu_1, \\mu_2) = \\frac{1}{N} \\min_{\\pi \\in S_N} \\sum_{i=1}^N \\|x_{1,i} - x_{2,\\pi(i)}\\|^2\n874: \n875: $$\n876: \n877: where $S_N$ is the set of permutations.\n878: \n879: Any specific matching (not necessarily optimal) provides an upper bound. Consider the **cluster-respecting matching** that pairs $(I_1, I_2)$ internally and $(J_1, J_2)$ internally.\n880: \n881: The total squared distance for this matching is:\n882: \n883: $$\n884: \\sum_{\\text{pairs}} \\|x_{1,i} - x_{2,\\pi(i)}\\|^2 = \\sum_{i \\in I_1, \\pi(i) \\in I_2} \\|x_{1,i} - x_{2,\\pi(i)}\\|^2 + \\ldots\n885: \n886: $$",
      "metadata": {
        "label": "lem-wasserstein-population-bound"
      },
      "section": "## 6. Main Theorem: Wasserstein-2 Contraction",
      "references": [
        "lem-cross-swarm-distance"
      ],
      "raw_directive": "854: ### 6.1. Preliminary: Wasserstein Distance Bound\n855: \n856: :::{prf:lemma} Wasserstein Distance and Population Cross-Distances\n857: :label: lem-wasserstein-population-bound\n858: \n859: For two swarms with partitions $(I_1, J_1)$ and $(I_2, J_2)$, the Wasserstein-2 squared distance satisfies:\n860: \n861: $$\n862: W_2^2(\\mu_1, \\mu_2) \\leq f_{I,1} f_{I,2} D_{II} + f_{I,1} f_{J,2} D_{IJ} + f_{J,1} f_{I,2} D_{JI} + f_{J,1} f_{J,2} D_{JJ}\n863: \n864: $$\n865: \n866: where $f_{I,k} = |I_k|/N$ and $D_{AB}$ are the population cross-distances from Lemma {prf:ref}`lem-cross-swarm-distance`.\n867: \n868: **Proof:**\n869: \n870: The Wasserstein-2 distance for empirical measures is:\n871: \n872: $$\n873: W_2^2(\\mu_1, \\mu_2) = \\frac{1}{N} \\min_{\\pi \\in S_N} \\sum_{i=1}^N \\|x_{1,i} - x_{2,\\pi(i)}\\|^2\n874: \n875: $$\n876: \n877: where $S_N$ is the set of permutations.\n878: \n879: Any specific matching (not necessarily optimal) provides an upper bound. Consider the **cluster-respecting matching** that pairs $(I_1, I_2)$ internally and $(J_1, J_2)$ internally.\n880: \n881: The total squared distance for this matching is:\n882: \n883: $$\n884: \\sum_{\\text{pairs}} \\|x_{1,i} - x_{2,\\pi(i)}\\|^2 = \\sum_{i \\in I_1, \\pi(i) \\in I_2} \\|x_{1,i} - x_{2,\\pi(i)}\\|^2 + \\ldots\n885: \n886: $$\n887: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-main-contraction-full",
      "title": "Wasserstein-2 Contraction (Cluster-Based)",
      "start_line": 891,
      "end_line": 922,
      "header_lines": [
        892
      ],
      "content_start": 894,
      "content_end": 921,
      "content": "894: :label: thm-main-contraction-full\n895: \n896: For two swarms $S_1, S_2$ satisfying the conditions stated in Section 1, the cloning operator satisfies:\n897: \n898: $$\n899: W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2)) \\leq (1 - \\kappa_W) W_2^2(\\mu_1, \\mu_2) + C_W\n900: \n901: $$\n902: \n903: where:\n904: \n905: **Contraction constant**:\n906: \n907: $$\n908: \\kappa_W = \\frac{1}{2} \\cdot f_{UH}(\\varepsilon) \\cdot p_u(\\varepsilon) \\cdot c_{\\text{align}}(\\varepsilon) \\cdot c_{\\text{geom}}\n909: \n910: $$\n911: \n912: **Noise constant**:\n913: \n914: $$\n915: C_W = 4d\\delta^2\n916: \n917: $$\n918: \n919: **All constants N-uniform**:\n920: - $f_{UH}(\\varepsilon)$: From Theorem 7.6.1 ([03_cloning](03_cloning), line 4572), N-uniformity in Theorem 8.7.1 (line 5521)\n921: - $p_u(\\varepsilon)$: From Lemma 8.3.2 (line 4881), N-uniformity in Section 8.6.1.1 (line 5521)",
      "metadata": {
        "label": "thm-main-contraction-full"
      },
      "section": "## 6. Main Theorem: Wasserstein-2 Contraction",
      "references": [
        "lem-cluster-alignment",
        "lem-expected-distance-change"
      ],
      "raw_directive": "891: ### 6.2. Main Contraction Theorem\n892: \n893: :::{prf:theorem} Wasserstein-2 Contraction (Cluster-Based)\n894: :label: thm-main-contraction-full\n895: \n896: For two swarms $S_1, S_2$ satisfying the conditions stated in Section 1, the cloning operator satisfies:\n897: \n898: $$\n899: W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2)) \\leq (1 - \\kappa_W) W_2^2(\\mu_1, \\mu_2) + C_W\n900: \n901: $$\n902: \n903: where:\n904: \n905: **Contraction constant**:\n906: \n907: $$\n908: \\kappa_W = \\frac{1}{2} \\cdot f_{UH}(\\varepsilon) \\cdot p_u(\\varepsilon) \\cdot c_{\\text{align}}(\\varepsilon) \\cdot c_{\\text{geom}}\n909: \n910: $$\n911: \n912: **Noise constant**:\n913: \n914: $$\n915: C_W = 4d\\delta^2\n916: \n917: $$\n918: \n919: **All constants N-uniform**:\n920: - $f_{UH}(\\varepsilon)$: From Theorem 7.6.1 ([03_cloning](03_cloning), line 4572), N-uniformity in Theorem 8.7.1 (line 5521)\n921: - $p_u(\\varepsilon)$: From Lemma 8.3.2 (line 4881), N-uniformity in Section 8.6.1.1 (line 5521)\n922: - $c_{\\text{align}}(\\varepsilon)$: From Lemma {prf:ref}`lem-cluster-alignment`, geometric (N-independent)"
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-main-contraction-full",
      "title": null,
      "start_line": 924,
      "end_line": 1015,
      "header_lines": [
        925
      ],
      "content_start": 927,
      "content_end": 1014,
      "content": "927: :label: proof-thm-main-contraction-full\n928: \n929: **Step 1: Expected Change in Population Cross-Distances**\n930: \n931: By Lemma {prf:ref}`lem-expected-distance-change` and Corollary {prf:ref}`cor-average-cloning`:\n932: \n933: $$\n934: \\mathbb{E}[\\Delta D_{IJ}] \\leq -p_u(\\varepsilon) \\cdot c_{\\text{geom}} \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 + O(\\delta^2)\n935: \n936: $$\n937: \n938: **Step 2: Relating Cluster Separation to Wasserstein Distance**\n939: \n940: By Corollary {prf:ref}`cor-between-group-dominance`:\n941: \n942: $$\n943: f_I f_J \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq c_{\\text{sep}}(\\varepsilon) V_{\\text{struct}}\n944: \n945: $$\n946: \n947: By Lemma {prf:ref}`lem-variance-wasserstein-link` (Structural Variance and Wasserstein Distance Relationship), for separated swarms:\n948: \n949: $$\n950: V_{\\text{struct}} \\geq c_{\\text{link}}^{-} W_2^2(\\mu_1, \\mu_2)\n951: \n952: $$\n953: \n954: where $c_{\\text{link}}^{-} = f_{UH}^2 / c_{\\text{sep}}(\\varepsilon)$ is N-uniform.\n955: \n956: Combining these inequalities:\n957: \n958: $$\n959: f_I f_J \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq c_{\\text{sep}}(\\varepsilon) \\cdot c_{\\text{link}}^{-} W_2^2(\\mu_1, \\mu_2)\n960: \n961: $$\n962: \n963: Therefore:\n964: \n965: $$\n966: \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq \\frac{c_{\\text{sep}}(\\varepsilon) \\cdot c_{\\text{link}}^{-}}{f_I f_J} W_2^2(\\mu_1, \\mu_2)\n967: \n968: $$\n969: \n970: **Step 3: Contraction Bound**\n971: \n972: Combining Steps 1-2:\n973: \n974: $$\n975: \\mathbb{E}[\\Delta W_2^2] \\leq -p_u \\cdot c_{\\text{geom}} \\cdot \\frac{c_{\\text{sep}}}{f_I f_J} W_2^2 + C_W\n976: \n977: $$\n978: \n979: where $C_W = O(d\\delta^2)$ accounts for jitter accumulation.\n980: \n981: Using $f_I \\geq f_{UH}$ and $f_J \\geq 1 - f_{UH} \\geq 1/2$ (for $f_{UH} \\leq 1/2$):\n982: \n983: $$\n984: \\frac{1}{f_I f_J} \\leq \\frac{2}{f_{UH}}\n985: \n986: $$\n987: \n988: Therefore:\n989: \n990: $$\n991: \\mathbb{E}[\\Delta W_2^2] \\leq -\\frac{f_{UH} p_u c_{\\text{geom}} c_{\\text{sep}}}{2} W_2^2 + C_W\n992: \n993: $$\n994: \n995: Define:\n996: \n997: $$\n998: \\kappa_W := \\frac{1}{2} f_{UH}(\\varepsilon) \\cdot p_u(\\varepsilon) \\cdot c_{\\text{geom}} \\cdot c_{\\text{sep}}(\\varepsilon)\n999: \n1000: $$\n1001: \n1002: Then:\n1003: \n1004: $$\n1005: W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2)) = W_2^2(\\mu_1, \\mu_2) + \\mathbb{E}[\\Delta W_2^2] \\leq (1 - \\kappa_W) W_2^2(\\mu_1, \\mu_2) + C_W\n1006: \n1007: $$\n1008: \n1009: **Step 4: N-Uniformity**\n1010: \n1011: All components are N-uniform:\n1012: - $f_{UH}$: Theorem 8.7.1 ([03_cloning](03_cloning), line 5521) \u2713\n1013: - $p_u$: Section 8.6.1.1 (line 5521) \u2713\n1014: - $c_{\\text{geom}}, c_{\\text{sep}}$: Geometric constants from packing/alignment \u2713",
      "metadata": {
        "label": "proof-thm-main-contraction-full"
      },
      "section": "## 6. Main Theorem: Wasserstein-2 Contraction",
      "references": [
        "lem-expected-distance-change",
        "cor-average-cloning",
        "cor-between-group-dominance",
        "lem-variance-wasserstein-link"
      ],
      "raw_directive": "924: :::\n925: \n926: :::{prf:proof}\n927: :label: proof-thm-main-contraction-full\n928: \n929: **Step 1: Expected Change in Population Cross-Distances**\n930: \n931: By Lemma {prf:ref}`lem-expected-distance-change` and Corollary {prf:ref}`cor-average-cloning`:\n932: \n933: $$\n934: \\mathbb{E}[\\Delta D_{IJ}] \\leq -p_u(\\varepsilon) \\cdot c_{\\text{geom}} \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 + O(\\delta^2)\n935: \n936: $$\n937: \n938: **Step 2: Relating Cluster Separation to Wasserstein Distance**\n939: \n940: By Corollary {prf:ref}`cor-between-group-dominance`:\n941: \n942: $$\n943: f_I f_J \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq c_{\\text{sep}}(\\varepsilon) V_{\\text{struct}}\n944: \n945: $$\n946: \n947: By Lemma {prf:ref}`lem-variance-wasserstein-link` (Structural Variance and Wasserstein Distance Relationship), for separated swarms:\n948: \n949: $$\n950: V_{\\text{struct}} \\geq c_{\\text{link}}^{-} W_2^2(\\mu_1, \\mu_2)\n951: \n952: $$\n953: \n954: where $c_{\\text{link}}^{-} = f_{UH}^2 / c_{\\text{sep}}(\\varepsilon)$ is N-uniform.\n955: \n956: Combining these inequalities:\n957: \n958: $$\n959: f_I f_J \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq c_{\\text{sep}}(\\varepsilon) \\cdot c_{\\text{link}}^{-} W_2^2(\\mu_1, \\mu_2)\n960: \n961: $$\n962: \n963: Therefore:\n964: \n965: $$\n966: \\|\\mu_x(I_1) - \\mu_x(J_1)\\|^2 \\geq \\frac{c_{\\text{sep}}(\\varepsilon) \\cdot c_{\\text{link}}^{-}}{f_I f_J} W_2^2(\\mu_1, \\mu_2)\n967: \n968: $$\n969: \n970: **Step 3: Contraction Bound**\n971: \n972: Combining Steps 1-2:\n973: \n974: $$\n975: \\mathbb{E}[\\Delta W_2^2] \\leq -p_u \\cdot c_{\\text{geom}} \\cdot \\frac{c_{\\text{sep}}}{f_I f_J} W_2^2 + C_W\n976: \n977: $$\n978: \n979: where $C_W = O(d\\delta^2)$ accounts for jitter accumulation.\n980: \n981: Using $f_I \\geq f_{UH}$ and $f_J \\geq 1 - f_{UH} \\geq 1/2$ (for $f_{UH} \\leq 1/2$):\n982: \n983: $$\n984: \\frac{1}{f_I f_J} \\leq \\frac{2}{f_{UH}}\n985: \n986: $$\n987: \n988: Therefore:\n989: \n990: $$\n991: \\mathbb{E}[\\Delta W_2^2] \\leq -\\frac{f_{UH} p_u c_{\\text{geom}} c_{\\text{sep}}}{2} W_2^2 + C_W\n992: \n993: $$\n994: \n995: Define:\n996: \n997: $$\n998: \\kappa_W := \\frac{1}{2} f_{UH}(\\varepsilon) \\cdot p_u(\\varepsilon) \\cdot c_{\\text{geom}} \\cdot c_{\\text{sep}}(\\varepsilon)\n999: \n1000: $$\n1001: \n1002: Then:\n1003: \n1004: $$\n1005: W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2)) = W_2^2(\\mu_1, \\mu_2) + \\mathbb{E}[\\Delta W_2^2] \\leq (1 - \\kappa_W) W_2^2(\\mu_1, \\mu_2) + C_W\n1006: \n1007: $$\n1008: \n1009: **Step 4: N-Uniformity**\n1010: \n1011: All components are N-uniform:\n1012: - $f_{UH}$: Theorem 8.7.1 ([03_cloning](03_cloning), line 5521) \u2713\n1013: - $p_u$: Section 8.6.1.1 (line 5521) \u2713\n1014: - $c_{\\text{geom}}, c_{\\text{sep}}$: Geometric constants from packing/alignment \u2713\n1015: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}