{
  "document_id": "04_wasserstein_contraction_ASSEMBLED",
  "stage": "directives",
  "directive_type": "corollary",
  "generated_at": "2025-11-08T17:16:20.332677+00:00",
  "count": 2,
  "items": [
    {
      "directive_type": "corollary",
      "label": "cor-quadratic-scaling-wasserstein",
      "title": "Quadratic Scaling for Separated Swarms",
      "start_line": 1084,
      "end_line": 1214,
      "header_lines": [
        1085
      ],
      "content_start": 1087,
      "content_end": 1213,
      "content": "1087: :label: cor-quadratic-scaling-wasserstein\n1088: \n1089: For two swarms $S_1, S_2$ with barycenters $\\bar{x}_1, \\bar{x}_2$ at distance $L = \\|\\bar{x}_1 - \\bar{x}_2\\|$, consider the synchronous coupling where walker $i \\in S_1$ (outlier) clones from walker $\\pi(i) \\in S_2$ (companion).\n1090: \n1091: The global barycenter is $\\bar{x} \\approx \\frac{\\bar{x}_1 + \\bar{x}_2}{2}$ (assuming equal swarm sizes).\n1092: \n1093: **Then:**\n1094: \n1095: $$\n1096: D_{ii} - D_{ji} \\approx L^2\n1097: $$\n1098: \n1099: More precisely:\n1100: \n1101: $$\n1102: D_{ii} - D_{ji} \\geq \\frac{L^2}{2} - C_{\\text{err}}\n1103: $$\n1104: \n1105: where $C_{\\text{err}} = O(L R_H + R_H^2)$ for separated swarms with $L \\gg R_H$.\n1106: \n1107: **Proof:**\n1108: \n1109: By Proposition {prf:ref}`prop-exact-distance-change`:\n1110: \n1111: $$\n1112: D_{ii} - D_{ji} = -(N-1)\\|x_{2,\\pi(i)} - x_{1,i}\\|^2 - 2N\\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle\n1113: $$\n1114: \n1115: **First term (quadratic in $L$):**\n1116: \n1117: The distance between outlier in $S_1$ and companion in $S_2$ is approximately:\n1118: \n1119: $$\n1120: \\|x_{2,\\pi(i)} - x_{1,i}\\| \\approx \\|\\bar{x}_2 - \\bar{x}_1\\| + O(R_L + R_H) = L + O(R_H)\n1121: $$\n1122: \n1123: Therefore:\n1124: \n1125: $$\n1126: \\|x_{2,\\pi(i)} - x_{1,i}\\|^2 \\geq L^2 - 2L R_H\n1127: $$\n1128: \n1129: So:\n1130: \n1131: $$\n1132: -(N-1)\\|x_{2,\\pi(i)} - x_{1,i}\\|^2 \\leq -(N-1)L^2 + 2(N-1)LR_H\n1133: $$\n1134: \n1135: **Second term (also quadratic!):**\n1136: \n1137: The outlier position relative to global barycenter:\n1138: \n1139: $$\n1140: x_{1,i} - \\bar{x} \\approx (x_{1,i} - \\bar{x}_1) + \\left(\\bar{x}_1 - \\frac{\\bar{x}_1 + \\bar{x}_2}{2}\\right) = (x_{1,i} - \\bar{x}_1) + \\frac{\\bar{x}_1 - \\bar{x}_2}{2}\n1141: $$\n1142: \n1143: The displacement from companion to outlier:\n1144: \n1145: $$\n1146: x_{2,\\pi(i)} - x_{1,i} \\approx (\\bar{x}_2 - \\bar{x}_1) + O(R_H)\n1147: $$\n1148: \n1149: **Inner product:**\n1150: \n1151: $$\n1152: \\begin{aligned}\n1153: \\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle &\\approx \\left\\langle \\bar{x}_2 - \\bar{x}_1, (x_{1,i} - \\bar{x}_1) + \\frac{\\bar{x}_1 - \\bar{x}_2}{2} \\right\\rangle \\\\\n1154: &= \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle + \\left\\langle \\bar{x}_2 - \\bar{x}_1, \\frac{\\bar{x}_1 - \\bar{x}_2}{2} \\right\\rangle \\\\\n1155: &= \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle - \\frac{L^2}{2}\n1156: \\end{aligned}\n1157: $$\n1158: \n1159: **Use Outlier Alignment:** By Lemma {prf:ref}`lem-outlier-alignment`:\n1160: \n1161: $$\n1162: \\langle x_{1,i} - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle \\geq \\eta R_H L\n1163: $$\n1164: \n1165: Therefore:\n1166: \n1167: $$\n1168: \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle = -\\langle x_{1,i} - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle \\leq -\\eta R_H L\n1169: $$\n1170: \n1171: So:\n1172: \n1173: $$\n1174: \\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle \\leq -\\eta R_H L - \\frac{L^2}{2}\n1175: $$\n1176: \n1177: Therefore:\n1178: \n1179: $$\n1180: -2N\\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle \\geq 2N\\eta R_H L + NL^2\n1181: $$\n1182: \n1183: **Combine both terms:**\n1184: \n1185: $$\n1186: D_{ii} - D_{ji} \\geq -(N-1)L^2 + 2(N-1)LR_H + 2N\\eta R_H L + NL^2\n1187: $$\n1188: \n1189: $$\n1190: = L^2[-(N-1) + N] + 2LR_H[(N-1) + N\\eta]\n1191: $$\n1192: \n1193: $$\n1194: = L^2 + 2LR_H[(N-1) + N\\eta]\n1195: $$\n1196: \n1197: For $N$ large and $L \\gg R_H$:\n1198: \n1199: $$\n1200: D_{ii} - D_{ji} \\geq L^2 + O(NLR_H)\n1201: $$\n1202: \n1203: For the Wasserstein-2 distance per pair (dividing by number of pairs), we get:\n1204: \n1205: $$\n1206: \\frac{D_{ii} - D_{ji}}{N} \\geq \\frac{L^2}{N} + O(LR_H)\n1207: $$\n1208: \n1209: For the empirical measure contraction, the relevant quantity is the total squared distance, which is $O(NL^2)$, giving:\n1210: \n1211: $$\n1212: \\frac{D_{ii} - D_{ji}}{D_{ii} + D_{jj}} \\approx \\frac{L^2}{2L^2} = \\frac{1}{2} = O(1)\n1213: $$",
      "metadata": {
        "label": "cor-quadratic-scaling-wasserstein"
      },
      "section": "## Section 4 Updates: Quadratic Scaling Fixes",
      "raw_directive": "1084: ---\n1085: \n1086: :::{prf:corollary} Quadratic Scaling for Separated Swarms\n1087: :label: cor-quadratic-scaling-wasserstein\n1088: \n1089: For two swarms $S_1, S_2$ with barycenters $\\bar{x}_1, \\bar{x}_2$ at distance $L = \\|\\bar{x}_1 - \\bar{x}_2\\|$, consider the synchronous coupling where walker $i \\in S_1$ (outlier) clones from walker $\\pi(i) \\in S_2$ (companion).\n1090: \n1091: The global barycenter is $\\bar{x} \\approx \\frac{\\bar{x}_1 + \\bar{x}_2}{2}$ (assuming equal swarm sizes).\n1092: \n1093: **Then:**\n1094: \n1095: $$\n1096: D_{ii} - D_{ji} \\approx L^2\n1097: $$\n1098: \n1099: More precisely:\n1100: \n1101: $$\n1102: D_{ii} - D_{ji} \\geq \\frac{L^2}{2} - C_{\\text{err}}\n1103: $$\n1104: \n1105: where $C_{\\text{err}} = O(L R_H + R_H^2)$ for separated swarms with $L \\gg R_H$.\n1106: \n1107: **Proof:**\n1108: \n1109: By Proposition {prf:ref}`prop-exact-distance-change`:\n1110: \n1111: $$\n1112: D_{ii} - D_{ji} = -(N-1)\\|x_{2,\\pi(i)} - x_{1,i}\\|^2 - 2N\\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle\n1113: $$\n1114: \n1115: **First term (quadratic in $L$):**\n1116: \n1117: The distance between outlier in $S_1$ and companion in $S_2$ is approximately:\n1118: \n1119: $$\n1120: \\|x_{2,\\pi(i)} - x_{1,i}\\| \\approx \\|\\bar{x}_2 - \\bar{x}_1\\| + O(R_L + R_H) = L + O(R_H)\n1121: $$\n1122: \n1123: Therefore:\n1124: \n1125: $$\n1126: \\|x_{2,\\pi(i)} - x_{1,i}\\|^2 \\geq L^2 - 2L R_H\n1127: $$\n1128: \n1129: So:\n1130: \n1131: $$\n1132: -(N-1)\\|x_{2,\\pi(i)} - x_{1,i}\\|^2 \\leq -(N-1)L^2 + 2(N-1)LR_H\n1133: $$\n1134: \n1135: **Second term (also quadratic!):**\n1136: \n1137: The outlier position relative to global barycenter:\n1138: \n1139: $$\n1140: x_{1,i} - \\bar{x} \\approx (x_{1,i} - \\bar{x}_1) + \\left(\\bar{x}_1 - \\frac{\\bar{x}_1 + \\bar{x}_2}{2}\\right) = (x_{1,i} - \\bar{x}_1) + \\frac{\\bar{x}_1 - \\bar{x}_2}{2}\n1141: $$\n1142: \n1143: The displacement from companion to outlier:\n1144: \n1145: $$\n1146: x_{2,\\pi(i)} - x_{1,i} \\approx (\\bar{x}_2 - \\bar{x}_1) + O(R_H)\n1147: $$\n1148: \n1149: **Inner product:**\n1150: \n1151: $$\n1152: \\begin{aligned}\n1153: \\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle &\\approx \\left\\langle \\bar{x}_2 - \\bar{x}_1, (x_{1,i} - \\bar{x}_1) + \\frac{\\bar{x}_1 - \\bar{x}_2}{2} \\right\\rangle \\\\\n1154: &= \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle + \\left\\langle \\bar{x}_2 - \\bar{x}_1, \\frac{\\bar{x}_1 - \\bar{x}_2}{2} \\right\\rangle \\\\\n1155: &= \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle - \\frac{L^2}{2}\n1156: \\end{aligned}\n1157: $$\n1158: \n1159: **Use Outlier Alignment:** By Lemma {prf:ref}`lem-outlier-alignment`:\n1160: \n1161: $$\n1162: \\langle x_{1,i} - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle \\geq \\eta R_H L\n1163: $$\n1164: \n1165: Therefore:\n1166: \n1167: $$\n1168: \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle = -\\langle x_{1,i} - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle \\leq -\\eta R_H L\n1169: $$\n1170: \n1171: So:\n1172: \n1173: $$\n1174: \\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle \\leq -\\eta R_H L - \\frac{L^2}{2}\n1175: $$\n1176: \n1177: Therefore:\n1178: \n1179: $$\n1180: -2N\\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle \\geq 2N\\eta R_H L + NL^2\n1181: $$\n1182: \n1183: **Combine both terms:**\n1184: \n1185: $$\n1186: D_{ii} - D_{ji} \\geq -(N-1)L^2 + 2(N-1)LR_H + 2N\\eta R_H L + NL^2\n1187: $$\n1188: \n1189: $$\n1190: = L^2[-(N-1) + N] + 2LR_H[(N-1) + N\\eta]\n1191: $$\n1192: \n1193: $$\n1194: = L^2 + 2LR_H[(N-1) + N\\eta]\n1195: $$\n1196: \n1197: For $N$ large and $L \\gg R_H$:\n1198: \n1199: $$\n1200: D_{ii} - D_{ji} \\geq L^2 + O(NLR_H)\n1201: $$\n1202: \n1203: For the Wasserstein-2 distance per pair (dividing by number of pairs), we get:\n1204: \n1205: $$\n1206: \\frac{D_{ii} - D_{ji}}{N} \\geq \\frac{L^2}{N} + O(LR_H)\n1207: $$\n1208: \n1209: For the empirical measure contraction, the relevant quantity is the total squared distance, which is $O(NL^2)$, giving:\n1210: \n1211: $$\n1212: \\frac{D_{ii} - D_{ji}}{D_{ii} + D_{jj}} \\approx \\frac{L^2}{2L^2} = \\frac{1}{2} = O(1)\n1213: $$\n1214: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction_ASSEMBLED",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## Section 4 Updates: Quadratic Scaling Fixes"
      }
    },
    {
      "directive_type": "corollary",
      "label": "cor-large-separation-contraction",
      "title": "Large Separation Single-Pair Contraction",
      "start_line": 1992,
      "end_line": 2002,
      "header_lines": [
        1993
      ],
      "content_start": 1995,
      "content_end": 2001,
      "content": "1995: :label: cor-large-separation-contraction\n1996: \n1997: For swarms with separation $L > L_0(\\delta, \\varepsilon)$ where $L_0 = \\max\\left(D_{\\min}, \\frac{2\\sqrt{d}\\delta}{\\sqrt{\\kappa_B f_{UH} q_{\\min}}}\\right)$, the single-pair contraction simplifies to:\n1998: \n1999: $$\n2000: \\mathbb{E}[D'_{i\\pi(i)} \\mid M, T] \\leq \\left(1 - \\frac{\\kappa_{\\text{pair}}}{2}\\right) D_{i\\pi(i)} + C_W\n2001: $$",
      "metadata": {
        "label": "cor-large-separation-contraction"
      },
      "section": "## 5. Unified Single-Pair Lemma",
      "raw_directive": "1992: For the main theorem, we use a simplified bound that holds asymptotically for large $L$.\n1993: \n1994: :::{prf:corollary} Large Separation Single-Pair Contraction\n1995: :label: cor-large-separation-contraction\n1996: \n1997: For swarms with separation $L > L_0(\\delta, \\varepsilon)$ where $L_0 = \\max\\left(D_{\\min}, \\frac{2\\sqrt{d}\\delta}{\\sqrt{\\kappa_B f_{UH} q_{\\min}}}\\right)$, the single-pair contraction simplifies to:\n1998: \n1999: $$\n2000: \\mathbb{E}[D'_{i\\pi(i)} \\mid M, T] \\leq \\left(1 - \\frac{\\kappa_{\\text{pair}}}{2}\\right) D_{i\\pi(i)} + C_W\n2001: $$\n2002: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "04_wasserstein_contraction_ASSEMBLED",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 5. Unified Single-Pair Lemma"
      }
    }
  ]
}