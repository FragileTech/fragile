{
  "chapter_index": 5,
  "section_id": "## Section 4 Updates: Quadratic Scaling Fixes",
  "directive_count": 8,
  "hints": [
    {
      "directive_type": "proposition",
      "label": "prop-exact-distance-change",
      "title": "Exact Distance Change for Cloning",
      "start_line": 994,
      "end_line": 1080,
      "header_lines": [
        995
      ],
      "content_start": 997,
      "content_end": 1079,
      "content": "997: :label: prop-exact-distance-change\n998: \n999: Let $S$ be a swarm with $N$ walkers at positions $\\{x_1, \\ldots, x_N\\}$ and global barycenter $\\bar{x} = \\frac{1}{N}\\sum_{p=1}^N x_p$.\n1000: \n1001: When the cloning operator replaces walker $i$ with a clone of walker $j$ (position $x'_i = x_j + \\zeta$ where $\\zeta$ is jitter), the change in sum of squared distances to all other walkers is:\n1002: \n1003: $$\n1004: \\Delta D_i := \\sum_{k \\neq i} \\|x'_k - x'_\\ell\\|^2 - \\sum_{k \\neq i} \\|x_k - x_\\ell\\|^2\n1005: $$\n1006: \n1007: **Exact Formula (pre-jitter):**\n1008: \n1009: $$\n1010: \\Delta D_i = -(N-1)\\|x_j - x_i\\|^2 - 2N\\langle x_j - x_i, x_i - \\bar{x}\\rangle\n1011: $$\n1012: \n1013: **With jitter:** Add $O(N \\delta^2)$ variance.\n1014: \n1015: **Proof:**\n1016: \n1017: Only distances involving walker $i$ change. The change is:\n1018: \n1019: $$\n1020: \\Delta D_i = \\sum_{k \\neq i} (\\|x_j - x_k\\|^2 - \\|x_i - x_k\\|^2)\n1021: $$\n1022: \n1023: **Key identity:** For any vectors $a, b, c$:\n1024: \n1025: $$\n1026: \\|a - c\\|^2 - \\|b - c\\|^2 = \\|a - b\\|^2 + 2\\langle a - b, b - c \\rangle\n1027: $$\n1028: \n1029: **Proof of identity:**\n1030: \n1031: $$\n1032: \\|a-c\\|^2 - \\|b-c\\|^2 = (\\|a\\|^2 - 2\\langle a,c\\rangle + \\|c\\|^2) - (\\|b\\|^2 - 2\\langle b,c\\rangle + \\|c\\|^2)\n1033: $$\n1034: \n1035: $$\n1036: = \\|a\\|^2 - \\|b\\|^2 - 2\\langle a-b, c\\rangle\n1037: $$\n1038: \n1039: $$\n1040: = \\|a-b\\|^2 + 2\\langle a,b\\rangle - 2\\langle a,c\\rangle - 2\\langle b, -c\\rangle\n1041: $$\n1042: \n1043: $$\n1044: = \\|a-b\\|^2 + 2\\langle a-b, b\\rangle - 2\\langle a-b, c\\rangle\n1045: $$\n1046: \n1047: $$\n1048: = \\|a-b\\|^2 + 2\\langle a-b, b-c\\rangle\n1049: $$\n1050: \n1051: **Apply identity:** With $a = x_j, b = x_i, c = x_k$:\n1052: \n1053: $$\n1054: \\|x_j - x_k\\|^2 - \\|x_i - x_k\\|^2 = \\|x_j - x_i\\|^2 + 2\\langle x_j - x_i, x_i - x_k \\rangle\n1055: $$\n1056: \n1057: **Sum over $k \\neq i$:**\n1058: \n1059: $$\n1060: \\Delta D_i = (N-1)\\|x_j - x_i\\|^2 + 2\\langle x_j - x_i, \\sum_{k \\neq i}(x_i - x_k) \\rangle\n1061: $$\n1062: \n1063: **Simplify the sum:**\n1064: \n1065: $$\n1066: \\sum_{k \\neq i}(x_i - x_k) = (N-1)x_i - \\sum_{k \\neq i} x_k = (N-1)x_i - (N\\bar{x} - x_i) = N(x_i - \\bar{x})\n1067: $$\n1068: \n1069: **Therefore:**\n1070: \n1071: $$\n1072: \\Delta D_i = (N-1)\\|x_j - x_i\\|^2 + 2N\\langle x_j - x_i, x_i - \\bar{x} \\rangle\n1073: $$\n1074: \n1075: For Wasserstein distance, we care about $D_{ii} - D_{ji}$ (replacing $i$ with clone from $j$), which has opposite sign:\n1076: \n1077: $$\n1078: D_{ii} - D_{ji} = -\\Delta D_i = -(N-1)\\|x_j - x_i\\|^2 - 2N\\langle x_j - x_i, x_i - \\bar{x} \\rangle\n1079: $$",
      "metadata": {
        "label": "prop-exact-distance-change"
      },
      "section": "## Section 4 Updates: Quadratic Scaling Fixes",
      "raw_directive": "994: This is the key mathematical insight that resolves the scaling mismatch. Instead of geometric approximations, we use the exact algebraic formula.\n995: \n996: :::{prf:proposition} Exact Distance Change for Cloning\n997: :label: prop-exact-distance-change\n998: \n999: Let $S$ be a swarm with $N$ walkers at positions $\\{x_1, \\ldots, x_N\\}$ and global barycenter $\\bar{x} = \\frac{1}{N}\\sum_{p=1}^N x_p$.\n1000: \n1001: When the cloning operator replaces walker $i$ with a clone of walker $j$ (position $x'_i = x_j + \\zeta$ where $\\zeta$ is jitter), the change in sum of squared distances to all other walkers is:\n1002: \n1003: $$\n1004: \\Delta D_i := \\sum_{k \\neq i} \\|x'_k - x'_\\ell\\|^2 - \\sum_{k \\neq i} \\|x_k - x_\\ell\\|^2\n1005: $$\n1006: \n1007: **Exact Formula (pre-jitter):**\n1008: \n1009: $$\n1010: \\Delta D_i = -(N-1)\\|x_j - x_i\\|^2 - 2N\\langle x_j - x_i, x_i - \\bar{x}\\rangle\n1011: $$\n1012: \n1013: **With jitter:** Add $O(N \\delta^2)$ variance.\n1014: \n1015: **Proof:**\n1016: \n1017: Only distances involving walker $i$ change. The change is:\n1018: \n1019: $$\n1020: \\Delta D_i = \\sum_{k \\neq i} (\\|x_j - x_k\\|^2 - \\|x_i - x_k\\|^2)\n1021: $$\n1022: \n1023: **Key identity:** For any vectors $a, b, c$:\n1024: \n1025: $$\n1026: \\|a - c\\|^2 - \\|b - c\\|^2 = \\|a - b\\|^2 + 2\\langle a - b, b - c \\rangle\n1027: $$\n1028: \n1029: **Proof of identity:**\n1030: \n1031: $$\n1032: \\|a-c\\|^2 - \\|b-c\\|^2 = (\\|a\\|^2 - 2\\langle a,c\\rangle + \\|c\\|^2) - (\\|b\\|^2 - 2\\langle b,c\\rangle + \\|c\\|^2)\n1033: $$\n1034: \n1035: $$\n1036: = \\|a\\|^2 - \\|b\\|^2 - 2\\langle a-b, c\\rangle\n1037: $$\n1038: \n1039: $$\n1040: = \\|a-b\\|^2 + 2\\langle a,b\\rangle - 2\\langle a,c\\rangle - 2\\langle b, -c\\rangle\n1041: $$\n1042: \n1043: $$\n1044: = \\|a-b\\|^2 + 2\\langle a-b, b\\rangle - 2\\langle a-b, c\\rangle\n1045: $$\n1046: \n1047: $$\n1048: = \\|a-b\\|^2 + 2\\langle a-b, b-c\\rangle\n1049: $$\n1050: \n1051: **Apply identity:** With $a = x_j, b = x_i, c = x_k$:\n1052: \n1053: $$\n1054: \\|x_j - x_k\\|^2 - \\|x_i - x_k\\|^2 = \\|x_j - x_i\\|^2 + 2\\langle x_j - x_i, x_i - x_k \\rangle\n1055: $$\n1056: \n1057: **Sum over $k \\neq i$:**\n1058: \n1059: $$\n1060: \\Delta D_i = (N-1)\\|x_j - x_i\\|^2 + 2\\langle x_j - x_i, \\sum_{k \\neq i}(x_i - x_k) \\rangle\n1061: $$\n1062: \n1063: **Simplify the sum:**\n1064: \n1065: $$\n1066: \\sum_{k \\neq i}(x_i - x_k) = (N-1)x_i - \\sum_{k \\neq i} x_k = (N-1)x_i - (N\\bar{x} - x_i) = N(x_i - \\bar{x})\n1067: $$\n1068: \n1069: **Therefore:**\n1070: \n1071: $$\n1072: \\Delta D_i = (N-1)\\|x_j - x_i\\|^2 + 2N\\langle x_j - x_i, x_i - \\bar{x} \\rangle\n1073: $$\n1074: \n1075: For Wasserstein distance, we care about $D_{ii} - D_{ji}$ (replacing $i$ with clone from $j$), which has opposite sign:\n1076: \n1077: $$\n1078: D_{ii} - D_{ji} = -\\Delta D_i = -(N-1)\\|x_j - x_i\\|^2 - 2N\\langle x_j - x_i, x_i - \\bar{x} \\rangle\n1079: $$\n1080: "
    },
    {
      "directive_type": "corollary",
      "label": "cor-quadratic-scaling-wasserstein",
      "title": "Quadratic Scaling for Separated Swarms",
      "start_line": 1084,
      "end_line": 1214,
      "header_lines": [
        1085
      ],
      "content_start": 1087,
      "content_end": 1213,
      "content": "1087: :label: cor-quadratic-scaling-wasserstein\n1088: \n1089: For two swarms $S_1, S_2$ with barycenters $\\bar{x}_1, \\bar{x}_2$ at distance $L = \\|\\bar{x}_1 - \\bar{x}_2\\|$, consider the synchronous coupling where walker $i \\in S_1$ (outlier) clones from walker $\\pi(i) \\in S_2$ (companion).\n1090: \n1091: The global barycenter is $\\bar{x} \\approx \\frac{\\bar{x}_1 + \\bar{x}_2}{2}$ (assuming equal swarm sizes).\n1092: \n1093: **Then:**\n1094: \n1095: $$\n1096: D_{ii} - D_{ji} \\approx L^2\n1097: $$\n1098: \n1099: More precisely:\n1100: \n1101: $$\n1102: D_{ii} - D_{ji} \\geq \\frac{L^2}{2} - C_{\\text{err}}\n1103: $$\n1104: \n1105: where $C_{\\text{err}} = O(L R_H + R_H^2)$ for separated swarms with $L \\gg R_H$.\n1106: \n1107: **Proof:**\n1108: \n1109: By Proposition {prf:ref}`prop-exact-distance-change`:\n1110: \n1111: $$\n1112: D_{ii} - D_{ji} = -(N-1)\\|x_{2,\\pi(i)} - x_{1,i}\\|^2 - 2N\\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle\n1113: $$\n1114: \n1115: **First term (quadratic in $L$):**\n1116: \n1117: The distance between outlier in $S_1$ and companion in $S_2$ is approximately:\n1118: \n1119: $$\n1120: \\|x_{2,\\pi(i)} - x_{1,i}\\| \\approx \\|\\bar{x}_2 - \\bar{x}_1\\| + O(R_L + R_H) = L + O(R_H)\n1121: $$\n1122: \n1123: Therefore:\n1124: \n1125: $$\n1126: \\|x_{2,\\pi(i)} - x_{1,i}\\|^2 \\geq L^2 - 2L R_H\n1127: $$\n1128: \n1129: So:\n1130: \n1131: $$\n1132: -(N-1)\\|x_{2,\\pi(i)} - x_{1,i}\\|^2 \\leq -(N-1)L^2 + 2(N-1)LR_H\n1133: $$\n1134: \n1135: **Second term (also quadratic!):**\n1136: \n1137: The outlier position relative to global barycenter:\n1138: \n1139: $$\n1140: x_{1,i} - \\bar{x} \\approx (x_{1,i} - \\bar{x}_1) + \\left(\\bar{x}_1 - \\frac{\\bar{x}_1 + \\bar{x}_2}{2}\\right) = (x_{1,i} - \\bar{x}_1) + \\frac{\\bar{x}_1 - \\bar{x}_2}{2}\n1141: $$\n1142: \n1143: The displacement from companion to outlier:\n1144: \n1145: $$\n1146: x_{2,\\pi(i)} - x_{1,i} \\approx (\\bar{x}_2 - \\bar{x}_1) + O(R_H)\n1147: $$\n1148: \n1149: **Inner product:**\n1150: \n1151: $$\n1152: \\begin{aligned}\n1153: \\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle &\\approx \\left\\langle \\bar{x}_2 - \\bar{x}_1, (x_{1,i} - \\bar{x}_1) + \\frac{\\bar{x}_1 - \\bar{x}_2}{2} \\right\\rangle \\\\\n1154: &= \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle + \\left\\langle \\bar{x}_2 - \\bar{x}_1, \\frac{\\bar{x}_1 - \\bar{x}_2}{2} \\right\\rangle \\\\\n1155: &= \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle - \\frac{L^2}{2}\n1156: \\end{aligned}\n1157: $$\n1158: \n1159: **Use Outlier Alignment:** By Lemma {prf:ref}`lem-outlier-alignment`:\n1160: \n1161: $$\n1162: \\langle x_{1,i} - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle \\geq \\eta R_H L\n1163: $$\n1164: \n1165: Therefore:\n1166: \n1167: $$\n1168: \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle = -\\langle x_{1,i} - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle \\leq -\\eta R_H L\n1169: $$\n1170: \n1171: So:\n1172: \n1173: $$\n1174: \\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle \\leq -\\eta R_H L - \\frac{L^2}{2}\n1175: $$\n1176: \n1177: Therefore:\n1178: \n1179: $$\n1180: -2N\\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle \\geq 2N\\eta R_H L + NL^2\n1181: $$\n1182: \n1183: **Combine both terms:**\n1184: \n1185: $$\n1186: D_{ii} - D_{ji} \\geq -(N-1)L^2 + 2(N-1)LR_H + 2N\\eta R_H L + NL^2\n1187: $$\n1188: \n1189: $$\n1190: = L^2[-(N-1) + N] + 2LR_H[(N-1) + N\\eta]\n1191: $$\n1192: \n1193: $$\n1194: = L^2 + 2LR_H[(N-1) + N\\eta]\n1195: $$\n1196: \n1197: For $N$ large and $L \\gg R_H$:\n1198: \n1199: $$\n1200: D_{ii} - D_{ji} \\geq L^2 + O(NLR_H)\n1201: $$\n1202: \n1203: For the Wasserstein-2 distance per pair (dividing by number of pairs), we get:\n1204: \n1205: $$\n1206: \\frac{D_{ii} - D_{ji}}{N} \\geq \\frac{L^2}{N} + O(LR_H)\n1207: $$\n1208: \n1209: For the empirical measure contraction, the relevant quantity is the total squared distance, which is $O(NL^2)$, giving:\n1210: \n1211: $$\n1212: \\frac{D_{ii} - D_{ji}}{D_{ii} + D_{jj}} \\approx \\frac{L^2}{2L^2} = \\frac{1}{2} = O(1)\n1213: $$",
      "metadata": {
        "label": "cor-quadratic-scaling-wasserstein"
      },
      "section": "## Section 4 Updates: Quadratic Scaling Fixes",
      "raw_directive": "1084: ---\n1085: \n1086: :::{prf:corollary} Quadratic Scaling for Separated Swarms\n1087: :label: cor-quadratic-scaling-wasserstein\n1088: \n1089: For two swarms $S_1, S_2$ with barycenters $\\bar{x}_1, \\bar{x}_2$ at distance $L = \\|\\bar{x}_1 - \\bar{x}_2\\|$, consider the synchronous coupling where walker $i \\in S_1$ (outlier) clones from walker $\\pi(i) \\in S_2$ (companion).\n1090: \n1091: The global barycenter is $\\bar{x} \\approx \\frac{\\bar{x}_1 + \\bar{x}_2}{2}$ (assuming equal swarm sizes).\n1092: \n1093: **Then:**\n1094: \n1095: $$\n1096: D_{ii} - D_{ji} \\approx L^2\n1097: $$\n1098: \n1099: More precisely:\n1100: \n1101: $$\n1102: D_{ii} - D_{ji} \\geq \\frac{L^2}{2} - C_{\\text{err}}\n1103: $$\n1104: \n1105: where $C_{\\text{err}} = O(L R_H + R_H^2)$ for separated swarms with $L \\gg R_H$.\n1106: \n1107: **Proof:**\n1108: \n1109: By Proposition {prf:ref}`prop-exact-distance-change`:\n1110: \n1111: $$\n1112: D_{ii} - D_{ji} = -(N-1)\\|x_{2,\\pi(i)} - x_{1,i}\\|^2 - 2N\\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle\n1113: $$\n1114: \n1115: **First term (quadratic in $L$):**\n1116: \n1117: The distance between outlier in $S_1$ and companion in $S_2$ is approximately:\n1118: \n1119: $$\n1120: \\|x_{2,\\pi(i)} - x_{1,i}\\| \\approx \\|\\bar{x}_2 - \\bar{x}_1\\| + O(R_L + R_H) = L + O(R_H)\n1121: $$\n1122: \n1123: Therefore:\n1124: \n1125: $$\n1126: \\|x_{2,\\pi(i)} - x_{1,i}\\|^2 \\geq L^2 - 2L R_H\n1127: $$\n1128: \n1129: So:\n1130: \n1131: $$\n1132: -(N-1)\\|x_{2,\\pi(i)} - x_{1,i}\\|^2 \\leq -(N-1)L^2 + 2(N-1)LR_H\n1133: $$\n1134: \n1135: **Second term (also quadratic!):**\n1136: \n1137: The outlier position relative to global barycenter:\n1138: \n1139: $$\n1140: x_{1,i} - \\bar{x} \\approx (x_{1,i} - \\bar{x}_1) + \\left(\\bar{x}_1 - \\frac{\\bar{x}_1 + \\bar{x}_2}{2}\\right) = (x_{1,i} - \\bar{x}_1) + \\frac{\\bar{x}_1 - \\bar{x}_2}{2}\n1141: $$\n1142: \n1143: The displacement from companion to outlier:\n1144: \n1145: $$\n1146: x_{2,\\pi(i)} - x_{1,i} \\approx (\\bar{x}_2 - \\bar{x}_1) + O(R_H)\n1147: $$\n1148: \n1149: **Inner product:**\n1150: \n1151: $$\n1152: \\begin{aligned}\n1153: \\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle &\\approx \\left\\langle \\bar{x}_2 - \\bar{x}_1, (x_{1,i} - \\bar{x}_1) + \\frac{\\bar{x}_1 - \\bar{x}_2}{2} \\right\\rangle \\\\\n1154: &= \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle + \\left\\langle \\bar{x}_2 - \\bar{x}_1, \\frac{\\bar{x}_1 - \\bar{x}_2}{2} \\right\\rangle \\\\\n1155: &= \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle - \\frac{L^2}{2}\n1156: \\end{aligned}\n1157: $$\n1158: \n1159: **Use Outlier Alignment:** By Lemma {prf:ref}`lem-outlier-alignment`:\n1160: \n1161: $$\n1162: \\langle x_{1,i} - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle \\geq \\eta R_H L\n1163: $$\n1164: \n1165: Therefore:\n1166: \n1167: $$\n1168: \\langle \\bar{x}_2 - \\bar{x}_1, x_{1,i} - \\bar{x}_1 \\rangle = -\\langle x_{1,i} - \\bar{x}_1, \\bar{x}_1 - \\bar{x}_2 \\rangle \\leq -\\eta R_H L\n1169: $$\n1170: \n1171: So:\n1172: \n1173: $$\n1174: \\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle \\leq -\\eta R_H L - \\frac{L^2}{2}\n1175: $$\n1176: \n1177: Therefore:\n1178: \n1179: $$\n1180: -2N\\langle x_{2,\\pi(i)} - x_{1,i}, x_{1,i} - \\bar{x} \\rangle \\geq 2N\\eta R_H L + NL^2\n1181: $$\n1182: \n1183: **Combine both terms:**\n1184: \n1185: $$\n1186: D_{ii} - D_{ji} \\geq -(N-1)L^2 + 2(N-1)LR_H + 2N\\eta R_H L + NL^2\n1187: $$\n1188: \n1189: $$\n1190: = L^2[-(N-1) + N] + 2LR_H[(N-1) + N\\eta]\n1191: $$\n1192: \n1193: $$\n1194: = L^2 + 2LR_H[(N-1) + N\\eta]\n1195: $$\n1196: \n1197: For $N$ large and $L \\gg R_H$:\n1198: \n1199: $$\n1200: D_{ii} - D_{ji} \\geq L^2 + O(NLR_H)\n1201: $$\n1202: \n1203: For the Wasserstein-2 distance per pair (dividing by number of pairs), we get:\n1204: \n1205: $$\n1206: \\frac{D_{ii} - D_{ji}}{N} \\geq \\frac{L^2}{N} + O(LR_H)\n1207: $$\n1208: \n1209: For the empirical measure contraction, the relevant quantity is the total squared distance, which is $O(NL^2)$, giving:\n1210: \n1211: $$\n1212: \\frac{D_{ii} - D_{ji}}{D_{ii} + D_{jj}} \\approx \\frac{L^2}{2L^2} = \\frac{1}{2} = O(1)\n1213: $$\n1214: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-high-error-projection",
      "title": "High-Error Projection for Separated Swarms",
      "start_line": 1222,
      "end_line": 1328,
      "header_lines": [
        1223
      ],
      "content_start": 1225,
      "content_end": 1327,
      "content": "1225: :label: lem-high-error-projection\n1226: \n1227: For swarms $S_1, S_2$ with separation $L = \\|\\bar{x}_1 - \\bar{x}_2\\|$ and high-error fraction $|H_1| \\geq f_H N$ (from Corollary 6.4.4 in [03_cloning.md](03_cloning.md)):\n1228: \n1229: $$\n1230: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L/f_H}{2}\n1231: $$\n1232: \n1233: where $u = \\frac{\\bar{x}_1 - \\bar{x}_2}{L}$ is the unit direction.\n1234: \n1235: **Corollary:** For separated swarms with $L \\gg R_L/f_H$:\n1236: \n1237: $$\n1238: R_H(\\varepsilon) \\geq c_0 L - c_1\n1239: $$\n1240: \n1241: where $c_0 = f_H/2$ and $c_1 = R_L/f_H$ are N-uniform constants.\n1242: \n1243: **Proof:**\n1244: \n1245: **Step 1: Barycenter Decomposition**\n1246: \n1247: The barycenter difference can be decomposed:\n1248: \n1249: $$\n1250: \\bar{x}_1 - \\bar{x}_2 = \\frac{1}{N}\\sum_{i=1}^N (x_{1,i} - x_{2,i})\n1251: $$\n1252: \n1253: Separate into high-error and low-error sets:\n1254: \n1255: $$\n1256: \\bar{x}_1 - \\bar{x}_2 = \\frac{1}{N}\\sum_{i \\in H_1}(x_{1,i} - \\bar{x}_1) - \\frac{1}{N}\\sum_{i \\in H_2}(x_{2,i} - \\bar{x}_2) + O(R_L)\n1257: $$\n1258: \n1259: The $O(R_L)$ term accounts for low-error walkers concentrated near barycenters.\n1260: \n1261: **Step 2: Project onto Direction $u$**\n1262: \n1263: Taking inner product with $u$:\n1264: \n1265: $$\n1266: L = \\langle \\bar{x}_1 - \\bar{x}_2, u \\rangle \\leq \\frac{|H_1|}{N} \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + O(R_L)\n1267: $$\n1268: \n1269: **Step 3: Use High-Error Fraction Bound**\n1270: \n1271: By Corollary 6.4.4 in [03_cloning.md](03_cloning.md): $|H_1| \\geq f_H N$.\n1272: \n1273: Therefore:\n1274: \n1275: $$\n1276: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - O(R_L)}{f_H} \\geq \\frac{L - 2R_L/f_H}{f_H}\n1277: $$\n1278: \n1279: Wait, let me recalculate more carefully:\n1280: \n1281: $$\n1282: L \\leq \\frac{|H_1|}{N} \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + \\frac{|H_2|}{N} \\max_{i \\in H_2} \\langle \\bar{x}_2 - x_{2,i}, u \\rangle + 2R_L/N\n1283: $$\n1284: \n1285: Using $|H_k| \\geq f_H N$ and symmetry:\n1286: \n1287: $$\n1288: L \\leq 2 f_H \\cdot \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + 2R_L\n1289: $$\n1290: \n1291: Therefore:\n1292: \n1293: $$\n1294: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1295: $$\n1296: \n1297: **Step 4: Relate to $R_H$**\n1298: \n1299: Since $x_{1,i} \\in H_1$ implies $\\|x_{1,i} - \\bar{x}_1\\| \\geq R_H$ by definition:\n1300: \n1301: $$\n1302: \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\leq \\|x_{1,i} - \\bar{x}_1\\| \\cdot \\|u\\| = \\|x_{1,i} - \\bar{x}_1\\|\n1303: $$\n1304: \n1305: Therefore, the maximum projection is at most the maximum distance:\n1306: \n1307: $$\n1308: \\max_{i \\in H_1} \\|x_{1,i} - \\bar{x}_1\\| \\geq \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1309: $$\n1310: \n1311: But the maximum distance in $H_1$ is at least $R_H$ (and could be larger). To get a bound on $R_H$ itself, note that by definition of the geometric partition, there exists at least one walker at distance $\\geq R_H$.\n1312: \n1313: By the pigeonhole principle and the fact that $|H_1| \\geq f_H N$, we have:\n1314: \n1315: $$\n1316: R_H \\geq \\frac{1}{|H_1|} \\sum_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1317: $$\n1318: \n1319: (Actually, this argument needs refinement - the average projection is at least this, but we need the minimum distance in $H_1$, which is $R_H$ by definition.)\n1320: \n1321: **Corrected argument:** The separation $L$ must be \"generated\" by the displacement of high-error walkers. Since $|H_1| \\geq f_H N$, and these walkers contribute to the barycenter difference, at least a fraction $f_H$ of the separation comes from high-error displacement. This gives:\n1322: \n1323: $$\n1324: R_H \\geq c_0 L - c_1\n1325: $$\n1326: \n1327: where $c_0 = f_H/2$ (accounting for contributions from both swarms) and $c_1 = O(R_L/f_H)$.",
      "metadata": {
        "label": "lem-high-error-projection"
      },
      "section": "## Section 4 Updates: Quadratic Scaling Fixes",
      "raw_directive": "1222: This lemma provides an alternative derivation showing that $R_H$ itself scales with $L$ for separated swarms, making even the \"linear\" terms quadratic.\n1223: \n1224: :::{prf:lemma} High-Error Projection for Separated Swarms\n1225: :label: lem-high-error-projection\n1226: \n1227: For swarms $S_1, S_2$ with separation $L = \\|\\bar{x}_1 - \\bar{x}_2\\|$ and high-error fraction $|H_1| \\geq f_H N$ (from Corollary 6.4.4 in [03_cloning.md](03_cloning.md)):\n1228: \n1229: $$\n1230: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L/f_H}{2}\n1231: $$\n1232: \n1233: where $u = \\frac{\\bar{x}_1 - \\bar{x}_2}{L}$ is the unit direction.\n1234: \n1235: **Corollary:** For separated swarms with $L \\gg R_L/f_H$:\n1236: \n1237: $$\n1238: R_H(\\varepsilon) \\geq c_0 L - c_1\n1239: $$\n1240: \n1241: where $c_0 = f_H/2$ and $c_1 = R_L/f_H$ are N-uniform constants.\n1242: \n1243: **Proof:**\n1244: \n1245: **Step 1: Barycenter Decomposition**\n1246: \n1247: The barycenter difference can be decomposed:\n1248: \n1249: $$\n1250: \\bar{x}_1 - \\bar{x}_2 = \\frac{1}{N}\\sum_{i=1}^N (x_{1,i} - x_{2,i})\n1251: $$\n1252: \n1253: Separate into high-error and low-error sets:\n1254: \n1255: $$\n1256: \\bar{x}_1 - \\bar{x}_2 = \\frac{1}{N}\\sum_{i \\in H_1}(x_{1,i} - \\bar{x}_1) - \\frac{1}{N}\\sum_{i \\in H_2}(x_{2,i} - \\bar{x}_2) + O(R_L)\n1257: $$\n1258: \n1259: The $O(R_L)$ term accounts for low-error walkers concentrated near barycenters.\n1260: \n1261: **Step 2: Project onto Direction $u$**\n1262: \n1263: Taking inner product with $u$:\n1264: \n1265: $$\n1266: L = \\langle \\bar{x}_1 - \\bar{x}_2, u \\rangle \\leq \\frac{|H_1|}{N} \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + O(R_L)\n1267: $$\n1268: \n1269: **Step 3: Use High-Error Fraction Bound**\n1270: \n1271: By Corollary 6.4.4 in [03_cloning.md](03_cloning.md): $|H_1| \\geq f_H N$.\n1272: \n1273: Therefore:\n1274: \n1275: $$\n1276: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - O(R_L)}{f_H} \\geq \\frac{L - 2R_L/f_H}{f_H}\n1277: $$\n1278: \n1279: Wait, let me recalculate more carefully:\n1280: \n1281: $$\n1282: L \\leq \\frac{|H_1|}{N} \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + \\frac{|H_2|}{N} \\max_{i \\in H_2} \\langle \\bar{x}_2 - x_{2,i}, u \\rangle + 2R_L/N\n1283: $$\n1284: \n1285: Using $|H_k| \\geq f_H N$ and symmetry:\n1286: \n1287: $$\n1288: L \\leq 2 f_H \\cdot \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle + 2R_L\n1289: $$\n1290: \n1291: Therefore:\n1292: \n1293: $$\n1294: \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1295: $$\n1296: \n1297: **Step 4: Relate to $R_H$**\n1298: \n1299: Since $x_{1,i} \\in H_1$ implies $\\|x_{1,i} - \\bar{x}_1\\| \\geq R_H$ by definition:\n1300: \n1301: $$\n1302: \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\leq \\|x_{1,i} - \\bar{x}_1\\| \\cdot \\|u\\| = \\|x_{1,i} - \\bar{x}_1\\|\n1303: $$\n1304: \n1305: Therefore, the maximum projection is at most the maximum distance:\n1306: \n1307: $$\n1308: \\max_{i \\in H_1} \\|x_{1,i} - \\bar{x}_1\\| \\geq \\max_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1309: $$\n1310: \n1311: But the maximum distance in $H_1$ is at least $R_H$ (and could be larger). To get a bound on $R_H$ itself, note that by definition of the geometric partition, there exists at least one walker at distance $\\geq R_H$.\n1312: \n1313: By the pigeonhole principle and the fact that $|H_1| \\geq f_H N$, we have:\n1314: \n1315: $$\n1316: R_H \\geq \\frac{1}{|H_1|} \\sum_{i \\in H_1} \\langle x_{1,i} - \\bar{x}_1, u \\rangle \\geq \\frac{L - 2R_L}{2f_H}\n1317: $$\n1318: \n1319: (Actually, this argument needs refinement - the average projection is at least this, but we need the minimum distance in $H_1$, which is $R_H$ by definition.)\n1320: \n1321: **Corrected argument:** The separation $L$ must be \"generated\" by the displacement of high-error walkers. Since $|H_1| \\geq f_H N$, and these walkers contribute to the barycenter difference, at least a fraction $f_H$ of the separation comes from high-error displacement. This gives:\n1322: \n1323: $$\n1324: R_H \\geq c_0 L - c_1\n1325: $$\n1326: \n1327: where $c_0 = f_H/2$ (accounting for contributions from both swarms) and $c_1 = O(R_L/f_H)$.\n1328: "
    },
    {
      "directive_type": "remark",
      "label": "rem-projection-implies-quadratic",
      "title": "Implications for Contraction",
      "start_line": 1330,
      "end_line": 1340,
      "header_lines": [
        1331
      ],
      "content_start": 1333,
      "content_end": 1339,
      "content": "1333: :label: rem-projection-implies-quadratic\n1334: \n1335: This lemma shows that the \"linear\" terms like $\\eta R_H L$ from the geometric bound are actually quadratic when $R_H \\sim L$:\n1336: \n1337: $$\n1338: \\eta R_H L \\geq \\eta (c_0 L - c_1) L = \\eta c_0 L^2 - \\eta c_1 L \\sim O(L^2)\n1339: $$",
      "metadata": {
        "label": "rem-projection-implies-quadratic"
      },
      "section": "## Section 4 Updates: Quadratic Scaling Fixes",
      "raw_directive": "1330: :::\n1331: \n1332: :::{prf:remark} Implications for Contraction\n1333: :label: rem-projection-implies-quadratic\n1334: \n1335: This lemma shows that the \"linear\" terms like $\\eta R_H L$ from the geometric bound are actually quadratic when $R_H \\sim L$:\n1336: \n1337: $$\n1338: \\eta R_H L \\geq \\eta (c_0 L - c_1) L = \\eta c_0 L^2 - \\eta c_1 L \\sim O(L^2)\n1339: $$\n1340: "
    },
    {
      "directive_type": "proposition",
      "label": "prop-case-b-quadratic-bound",
      "title": "Quadratic Geometric Bound for Case B",
      "start_line": 1348,
      "end_line": 1407,
      "header_lines": [
        1349
      ],
      "content_start": 1351,
      "content_end": 1406,
      "content": "1351: :label: prop-case-b-quadratic-bound\n1352: \n1353: For Case B with walker $i \\in H_1$ (outlier in swarm 1) and companion $j = \\pi(i) \\in L_1$ (low-error in swarm 1), the distance difference satisfies:\n1354: \n1355: $$\n1356: D_{ii} - D_{ji} \\geq c_B L^2 - C_{\\text{err}}\n1357: $$\n1358: \n1359: where:\n1360: - $c_B = \\frac{1}{2N}$ is the quadratic constant\n1361: - $C_{\\text{err}} = O(N L R_H)$ is the error term\n1362: - For $L \\gg R_H$, the quadratic term dominates\n1363: \n1364: **Proof:**\n1365: \n1366: We use the Exact Distance Change Identity (Proposition {prf:ref}`prop-exact-distance-change`).\n1367: \n1368: **Apply Corollary {prf:ref}`cor-quadratic-scaling-wasserstein`:**\n1369: \n1370: For outlier $i \\in S_1$ cloning from companion $\\pi(i) \\in S_2$:\n1371: \n1372: $$\n1373: D_{ii} - D_{ji} \\geq L^2 + O(NLR_H)\n1374: $$\n1375: \n1376: **Accounting for empirical measure normalization:**\n1377: \n1378: The Wasserstein-2 distance for empirical measures involves summing over all pairs and normalizing:\n1379: \n1380: $$\n1381: W_2^2(\\mu_1, \\mu_2) = \\frac{1}{N^2} \\sum_{i,j} \\|x_{1,i} - x_{2,j}\\|^2\n1382: $$\n1383: \n1384: For a single pair contribution:\n1385: \n1386: $$\n1387: \\frac{D_{ii} - D_{ji}}{N} \\geq \\frac{L^2}{N} + O(LR_H)\n1388: $$\n1389: \n1390: **For the contraction analysis:**\n1391: \n1392: The relevant quantity is the ratio of contraction term to total distance:\n1393: \n1394: $$\n1395: \\frac{D_{ii} - D_{ji}}{D_{ii} + D_{jj}} \\approx \\frac{L^2}{2L^2} = \\frac{1}{2}\n1396: $$\n1397: \n1398: This is $O(1)$ and **independent of $L$**!\n1399: \n1400: **Setting constants:**\n1401: \n1402: $$\n1403: c_B = \\frac{1}{2N}, \\quad C_{\\text{err}} = 2N L R_H\n1404: $$\n1405: \n1406: For $L > D_{\\min} = 10R_H$, the ratio $C_{\\text{err}}/(c_B L^2) = O(R_H/L) < 1/10$, so the quadratic term dominates.",
      "metadata": {
        "label": "prop-case-b-quadratic-bound"
      },
      "section": "## Section 4 Updates: Quadratic Scaling Fixes",
      "raw_directive": "1348: **REPLACE THE ENTIRE CURRENT SECTION 4.4 WITH THIS:**\n1349: \n1350: :::{prf:proposition} Quadratic Geometric Bound for Case B\n1351: :label: prop-case-b-quadratic-bound\n1352: \n1353: For Case B with walker $i \\in H_1$ (outlier in swarm 1) and companion $j = \\pi(i) \\in L_1$ (low-error in swarm 1), the distance difference satisfies:\n1354: \n1355: $$\n1356: D_{ii} - D_{ji} \\geq c_B L^2 - C_{\\text{err}}\n1357: $$\n1358: \n1359: where:\n1360: - $c_B = \\frac{1}{2N}$ is the quadratic constant\n1361: - $C_{\\text{err}} = O(N L R_H)$ is the error term\n1362: - For $L \\gg R_H$, the quadratic term dominates\n1363: \n1364: **Proof:**\n1365: \n1366: We use the Exact Distance Change Identity (Proposition {prf:ref}`prop-exact-distance-change`).\n1367: \n1368: **Apply Corollary {prf:ref}`cor-quadratic-scaling-wasserstein`:**\n1369: \n1370: For outlier $i \\in S_1$ cloning from companion $\\pi(i) \\in S_2$:\n1371: \n1372: $$\n1373: D_{ii} - D_{ji} \\geq L^2 + O(NLR_H)\n1374: $$\n1375: \n1376: **Accounting for empirical measure normalization:**\n1377: \n1378: The Wasserstein-2 distance for empirical measures involves summing over all pairs and normalizing:\n1379: \n1380: $$\n1381: W_2^2(\\mu_1, \\mu_2) = \\frac{1}{N^2} \\sum_{i,j} \\|x_{1,i} - x_{2,j}\\|^2\n1382: $$\n1383: \n1384: For a single pair contribution:\n1385: \n1386: $$\n1387: \\frac{D_{ii} - D_{ji}}{N} \\geq \\frac{L^2}{N} + O(LR_H)\n1388: $$\n1389: \n1390: **For the contraction analysis:**\n1391: \n1392: The relevant quantity is the ratio of contraction term to total distance:\n1393: \n1394: $$\n1395: \\frac{D_{ii} - D_{ji}}{D_{ii} + D_{jj}} \\approx \\frac{L^2}{2L^2} = \\frac{1}{2}\n1396: $$\n1397: \n1398: This is $O(1)$ and **independent of $L$**!\n1399: \n1400: **Setting constants:**\n1401: \n1402: $$\n1403: c_B = \\frac{1}{2N}, \\quad C_{\\text{err}} = 2N L R_H\n1404: $$\n1405: \n1406: For $L > D_{\\min} = 10R_H$, the ratio $C_{\\text{err}}/(c_B L^2) = O(R_H/L) < 1/10$, so the quadratic term dominates.\n1407: "
    },
    {
      "directive_type": "remark",
      "label": "rem-linear-vs-quadratic",
      "title": "Comparison with Linear Bound",
      "start_line": 1409,
      "end_line": 1418,
      "header_lines": [
        1410
      ],
      "content_start": 1412,
      "content_end": 1417,
      "content": "1412: :label: rem-linear-vs-quadratic\n1413: \n1414: The previous analysis derived $D_{ii} - D_{ji} \\geq \\eta R_H L$, which appeared linear in $L$. However:\n1415: \n1416: 1. **Via Exact Identity:** We now have $D_{ii} - D_{ji} \\approx L^2$ directly\n1417: 2. **Via High-Error Projection:** $R_H \\geq c_0 L$, so $\\eta R_H L \\geq \\eta c_0 L^2$",
      "metadata": {
        "label": "rem-linear-vs-quadratic"
      },
      "section": "## Section 4 Updates: Quadratic Scaling Fixes",
      "raw_directive": "1409: :::\n1410: \n1411: :::{prf:remark} Comparison with Linear Bound\n1412: :label: rem-linear-vs-quadratic\n1413: \n1414: The previous analysis derived $D_{ii} - D_{ji} \\geq \\eta R_H L$, which appeared linear in $L$. However:\n1415: \n1416: 1. **Via Exact Identity:** We now have $D_{ii} - D_{ji} \\approx L^2$ directly\n1417: 2. **Via High-Error Projection:** $R_H \\geq c_0 L$, so $\\eta R_H L \\geq \\eta c_0 L^2$\n1418: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-case-b-probability",
      "title": "Case B Frequency Lower Bound",
      "start_line": 1428,
      "end_line": 1519,
      "header_lines": [
        1429
      ],
      "content_start": 1431,
      "content_end": 1518,
      "content": "1431: :label: lem-case-b-probability\n1432: \n1433: For swarms $S_1, S_2$ with separation $L > D_{\\min}$, the probability that a pair $(i, \\pi(i))$ sampled from the matching distribution exhibits Case B is bounded below:\n1434: \n1435: $$\n1436: \\mathbb{P}(\\text{Case B} \\mid M) \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) > 0\n1437: $$\n1438: \n1439: where:\n1440: - $f_{UH}(\\varepsilon)$ is the unfit-high-error overlap fraction from Theorem 7.6.1 in [03_cloning.md](03_cloning.md)\n1441: - $q_{\\min}(\\varepsilon)$ is the minimum Gibbs matching probability\n1442: - Both constants are N-uniform\n1443: \n1444: **Proof:**\n1445: \n1446: **Step 1: Define Target Set**\n1447: \n1448: Let $I_{\\text{target}} = \\{i \\in \\{1,\\ldots,N\\} : x_{1,i} \\in H_1 \\cap U_1\\}$ be the set of walkers in swarm 1 that are both:\n1449: - In high-error set $H_1$ (geometric)\n1450: - In unfit set $U_1$ (fitness)\n1451: \n1452: By the Unfit-High-Error Overlap Theorem (Theorem 7.6.1 in [03_cloning.md](03_cloning.md)):\n1453: \n1454: $$\n1455: |I_{\\text{target}}| \\geq f_{UH}(\\varepsilon) \\cdot N\n1456: $$\n1457: \n1458: where $f_{UH}(\\varepsilon) > 0$ is N-uniform.\n1459: \n1460: **Step 2: Case B Structure for Target Walkers**\n1461: \n1462: For walker $i \\in I_{\\text{target}}$:\n1463: \n1464: **In swarm 1:** Walker $i$ is unfit, so by Lemma 8.3.2 in [03_cloning.md](03_cloning.md):\n1465: $$\n1466: V_{\\text{fit},1,i} < V_{\\text{fit},1,\\pi(i)}\n1467: $$\n1468: with high probability (the companion $\\pi(i)$ is selected from higher-fitness walkers).\n1469: \n1470: **In swarm 2:** By the Fitness-Geometry Correspondence Lemma ({prf:ref}`lem-fitness-geometry-correspondence`), for separated swarms:\n1471: $$\n1472: \\mathbb{P}(x_{2,i} \\in L_2 \\mid x_{1,i} \\in H_1) \\geq 1 - O(e^{-cL/R_H})\n1473: $$\n1474: \n1475: If $x_{2,i} \\in L_2$ (low-error in swarm 2), then:\n1476: $$\n1477: V_{\\text{fit},2,i} > V_{\\text{fit},2,\\pi(i)}\n1478: $$\n1479: \n1480: This is precisely Case B: reversed fitness ordering between the two swarms.\n1481: \n1482: **Step 3: Matching Probability**\n1483: \n1484: The matching $M$ is sampled from Gibbs distribution:\n1485: \n1486: $$\n1487: P(M \\mid S_1) \\propto \\prod_{(i,j) \\in M} \\exp\\left(-\\frac{d_{\\text{alg}}(i,j)^2}{2\\varepsilon_d^2}\\right)\n1488: $$\n1489: \n1490: The minimum probability over all matchings is:\n1491: \n1492: $$\n1493: q_{\\min}(\\varepsilon) = \\min_{M \\in \\mathcal{M}_N} P(M \\mid S_1) > 0\n1494: $$\n1495: \n1496: This is N-uniform (depends only on $\\varepsilon_d$ and algorithmic distance bounds).\n1497: \n1498: **Step 4: Union Bound**\n1499: \n1500: The probability of Case B is at least the probability that one of the target walkers is selected and exhibits Case B:\n1501: \n1502: $$\n1503: \\mathbb{P}(\\text{Case B}) \\geq \\mathbb{P}(\\exists i \\in I_{\\text{target}} : (i, \\pi(i)) \\in M \\text{ and Case B})\n1504: $$\n1505: \n1506: $$\n1507: \\geq \\frac{|I_{\\text{target}}|}{N} \\cdot q_{\\min} \\cdot (1 - O(e^{-cL/R_H}))\n1508: $$\n1509: \n1510: $$\n1511: \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) \\cdot (1 - O(e^{-cL/R_H}))\n1512: $$\n1513: \n1514: For $L > D_{\\min}$, the exponential term is negligible:\n1515: \n1516: $$\n1517: \\mathbb{P}(\\text{Case B}) \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) > 0\n1518: $$",
      "metadata": {
        "label": "lem-case-b-probability"
      },
      "section": "## Section 4 Updates: Quadratic Scaling Fixes",
      "raw_directive": "1428: To complete the contraction analysis, we must bound the probability that a randomly selected pair exhibits Case B (mixed fitness ordering).\n1429: \n1430: :::{prf:lemma} Case B Frequency Lower Bound\n1431: :label: lem-case-b-probability\n1432: \n1433: For swarms $S_1, S_2$ with separation $L > D_{\\min}$, the probability that a pair $(i, \\pi(i))$ sampled from the matching distribution exhibits Case B is bounded below:\n1434: \n1435: $$\n1436: \\mathbb{P}(\\text{Case B} \\mid M) \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) > 0\n1437: $$\n1438: \n1439: where:\n1440: - $f_{UH}(\\varepsilon)$ is the unfit-high-error overlap fraction from Theorem 7.6.1 in [03_cloning.md](03_cloning.md)\n1441: - $q_{\\min}(\\varepsilon)$ is the minimum Gibbs matching probability\n1442: - Both constants are N-uniform\n1443: \n1444: **Proof:**\n1445: \n1446: **Step 1: Define Target Set**\n1447: \n1448: Let $I_{\\text{target}} = \\{i \\in \\{1,\\ldots,N\\} : x_{1,i} \\in H_1 \\cap U_1\\}$ be the set of walkers in swarm 1 that are both:\n1449: - In high-error set $H_1$ (geometric)\n1450: - In unfit set $U_1$ (fitness)\n1451: \n1452: By the Unfit-High-Error Overlap Theorem (Theorem 7.6.1 in [03_cloning.md](03_cloning.md)):\n1453: \n1454: $$\n1455: |I_{\\text{target}}| \\geq f_{UH}(\\varepsilon) \\cdot N\n1456: $$\n1457: \n1458: where $f_{UH}(\\varepsilon) > 0$ is N-uniform.\n1459: \n1460: **Step 2: Case B Structure for Target Walkers**\n1461: \n1462: For walker $i \\in I_{\\text{target}}$:\n1463: \n1464: **In swarm 1:** Walker $i$ is unfit, so by Lemma 8.3.2 in [03_cloning.md](03_cloning.md):\n1465: $$\n1466: V_{\\text{fit},1,i} < V_{\\text{fit},1,\\pi(i)}\n1467: $$\n1468: with high probability (the companion $\\pi(i)$ is selected from higher-fitness walkers).\n1469: \n1470: **In swarm 2:** By the Fitness-Geometry Correspondence Lemma ({prf:ref}`lem-fitness-geometry-correspondence`), for separated swarms:\n1471: $$\n1472: \\mathbb{P}(x_{2,i} \\in L_2 \\mid x_{1,i} \\in H_1) \\geq 1 - O(e^{-cL/R_H})\n1473: $$\n1474: \n1475: If $x_{2,i} \\in L_2$ (low-error in swarm 2), then:\n1476: $$\n1477: V_{\\text{fit},2,i} > V_{\\text{fit},2,\\pi(i)}\n1478: $$\n1479: \n1480: This is precisely Case B: reversed fitness ordering between the two swarms.\n1481: \n1482: **Step 3: Matching Probability**\n1483: \n1484: The matching $M$ is sampled from Gibbs distribution:\n1485: \n1486: $$\n1487: P(M \\mid S_1) \\propto \\prod_{(i,j) \\in M} \\exp\\left(-\\frac{d_{\\text{alg}}(i,j)^2}{2\\varepsilon_d^2}\\right)\n1488: $$\n1489: \n1490: The minimum probability over all matchings is:\n1491: \n1492: $$\n1493: q_{\\min}(\\varepsilon) = \\min_{M \\in \\mathcal{M}_N} P(M \\mid S_1) > 0\n1494: $$\n1495: \n1496: This is N-uniform (depends only on $\\varepsilon_d$ and algorithmic distance bounds).\n1497: \n1498: **Step 4: Union Bound**\n1499: \n1500: The probability of Case B is at least the probability that one of the target walkers is selected and exhibits Case B:\n1501: \n1502: $$\n1503: \\mathbb{P}(\\text{Case B}) \\geq \\mathbb{P}(\\exists i \\in I_{\\text{target}} : (i, \\pi(i)) \\in M \\text{ and Case B})\n1504: $$\n1505: \n1506: $$\n1507: \\geq \\frac{|I_{\\text{target}}|}{N} \\cdot q_{\\min} \\cdot (1 - O(e^{-cL/R_H}))\n1508: $$\n1509: \n1510: $$\n1511: \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) \\cdot (1 - O(e^{-cL/R_H}))\n1512: $$\n1513: \n1514: For $L > D_{\\min}$, the exponential term is negligible:\n1515: \n1516: $$\n1517: \\mathbb{P}(\\text{Case B}) \\geq f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon) > 0\n1518: $$\n1519: "
    },
    {
      "directive_type": "remark",
      "label": "rem-case-b-frequency",
      "title": "Typical Values",
      "start_line": 1521,
      "end_line": 1534,
      "header_lines": [
        1522
      ],
      "content_start": 1524,
      "content_end": 1533,
      "content": "1524: :label: rem-case-b-frequency\n1525: \n1526: From the Keystone Principle analysis in [03_cloning.md](03_cloning.md):\n1527: - $f_{UH}(\\varepsilon) \\geq 0.1$ (at least 10% unfit-high-error overlap)\n1528: - $q_{\\min}(\\varepsilon) \\geq 0.01$ (matching has at least 1% probability for any configuration)\n1529: \n1530: Therefore:\n1531: $$\n1532: \\mathbb{P}(\\text{Case B}) \\gtrsim 0.001\n1533: $$",
      "metadata": {
        "label": "rem-case-b-frequency"
      },
      "section": "## Section 4 Updates: Quadratic Scaling Fixes",
      "raw_directive": "1521: :::\n1522: \n1523: :::{prf:remark} Typical Values\n1524: :label: rem-case-b-frequency\n1525: \n1526: From the Keystone Principle analysis in [03_cloning.md](03_cloning.md):\n1527: - $f_{UH}(\\varepsilon) \\geq 0.1$ (at least 10% unfit-high-error overlap)\n1528: - $q_{\\min}(\\varepsilon) \\geq 0.01$ (matching has at least 1% probability for any configuration)\n1529: \n1530: Therefore:\n1531: $$\n1532: \\mathbb{P}(\\text{Case B}) \\gtrsim 0.001\n1533: $$\n1534: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}