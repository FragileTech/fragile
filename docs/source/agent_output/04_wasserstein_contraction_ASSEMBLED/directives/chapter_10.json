{
  "chapter_index": 10,
  "section_id": "## 8. Main Wasserstein-2 Contraction Theorem",
  "directive_count": 7,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-main-wasserstein-contraction",
      "title": "Wasserstein-2 Contraction for Cloning Operator",
      "start_line": 2183,
      "end_line": 2214,
      "header_lines": [
        2184
      ],
      "content_start": 2186,
      "content_end": 2213,
      "content": "2186: :label: thm-main-wasserstein-contraction\n2187: \n2188: Let $\\mu_1, \\mu_2$ be two swarm distributions over $N$ walkers in state space $\\mathcal{X} = \\mathbb{R}^d$ satisfying the Fragile Gas axioms. Let $\\Psi_{\\text{clone}}$ denote the cloning operator with parameters:\n2189: - Virtual reward weights $(\\alpha, \\beta)$\n2190: - Jitter noise scale $\\delta$\n2191: - Confining potential $U: \\mathbb{R}^d \\to \\mathbb{R}$\n2192: - Environmental fitness $F: \\mathbb{R}^d \\to \\mathbb{R}$\n2193: \n2194: Suppose the swarms have separation:\n2195: $$\n2196: L := \\|\\bar{x}_1 - \\bar{x}_2\\| > L_0(\\delta, \\varepsilon)\n2197: $$\n2198: \n2199: where $L_0 = \\max\\left(D_{\\min}, \\frac{2\\sqrt{d}\\delta}{\\sqrt{\\kappa_B f_{UH} q_{\\min}}}\\right)$ is the separation threshold.\n2200: \n2201: Then the Wasserstein-2 distance contracts in expectation:\n2202: $$\n2203: W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2)) \\leq (1 - \\kappa_W) W_2^2(\\mu_1, \\mu_2) + C_W\n2204: $$\n2205: \n2206: where:\n2207: $$\n2208: \\kappa_W = \\frac{1}{2} \\cdot \\frac{p_u \\eta_{\\text{geo}}}{2} \\cdot f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon)\n2209: $$\n2210: \n2211: $$\n2212: C_W = 4d\\delta^2\n2213: $$",
      "metadata": {
        "label": "thm-main-wasserstein-contraction"
      },
      "section": "## 8. Main Wasserstein-2 Contraction Theorem",
      "raw_directive": "2183: ### 8.1. Statement of Main Result\n2184: \n2185: :::{prf:theorem} Wasserstein-2 Contraction for Cloning Operator\n2186: :label: thm-main-wasserstein-contraction\n2187: \n2188: Let $\\mu_1, \\mu_2$ be two swarm distributions over $N$ walkers in state space $\\mathcal{X} = \\mathbb{R}^d$ satisfying the Fragile Gas axioms. Let $\\Psi_{\\text{clone}}$ denote the cloning operator with parameters:\n2189: - Virtual reward weights $(\\alpha, \\beta)$\n2190: - Jitter noise scale $\\delta$\n2191: - Confining potential $U: \\mathbb{R}^d \\to \\mathbb{R}$\n2192: - Environmental fitness $F: \\mathbb{R}^d \\to \\mathbb{R}$\n2193: \n2194: Suppose the swarms have separation:\n2195: $$\n2196: L := \\|\\bar{x}_1 - \\bar{x}_2\\| > L_0(\\delta, \\varepsilon)\n2197: $$\n2198: \n2199: where $L_0 = \\max\\left(D_{\\min}, \\frac{2\\sqrt{d}\\delta}{\\sqrt{\\kappa_B f_{UH} q_{\\min}}}\\right)$ is the separation threshold.\n2200: \n2201: Then the Wasserstein-2 distance contracts in expectation:\n2202: $$\n2203: W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2)) \\leq (1 - \\kappa_W) W_2^2(\\mu_1, \\mu_2) + C_W\n2204: $$\n2205: \n2206: where:\n2207: $$\n2208: \\kappa_W = \\frac{1}{2} \\cdot \\frac{p_u \\eta_{\\text{geo}}}{2} \\cdot f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon)\n2209: $$\n2210: \n2211: $$\n2212: C_W = 4d\\delta^2\n2213: $$\n2214: "
    },
    {
      "directive_type": "definition",
      "label": "def-main-contraction-constant",
      "title": "Main Contraction Constant",
      "start_line": 2231,
      "end_line": 2283,
      "header_lines": [
        2232
      ],
      "content_start": 2234,
      "content_end": 2282,
      "content": "2234: :label: def-main-contraction-constant\n2235: \n2236: The contraction constant is:\n2237: $$\n2238: \\kappa_W := \\kappa_{\\text{pair}} = \\frac{1}{2} \\cdot \\frac{p_u \\eta_{\\text{geo}}}{2} \\cdot f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon)\n2239: $$\n2240: \n2241: where the factor of $1/2$ comes from Corollary 5.5 (large separation regime).\n2242: \n2243: **Component Definitions**:\n2244: \n2245: 1. **Minimum Survival Probability** $p_u$:\n2246:    $$\n2247:    p_u := \\exp(-\\beta \\Delta V_{\\max})\n2248:    $$\n2249:    where $\\Delta V_{\\max}$ is the maximum virtual reward difference across the swarm.\n2250:    - **Derivation**: Section 4.4, minimum Gibbs probability\n2251:    - **N-Dependence**: None (virtual rewards are bounded by axioms)\n2252:    - **Typical Value**: $e^{-10} \\approx 4.5 \\times 10^{-5}$ for $\\beta = 1$, $\\Delta V_{\\max} = 10$\n2253: \n2254: 2. **Geometric Efficiency** $\\eta_{\\text{geo}}$:\n2255:    $$\n2256:    \\eta_{\\text{geo}} := \\frac{c_0^2}{2(1 + 2c_H)^2}\n2257:    $$\n2258:    where:\n2259:    - $c_0$ is the projection constant from Lemma 4.3.7 (High-Error Projection): $R_H \\geq c_0 L - c_1$\n2260:    - $c_H$ is the high-error radius constant: $R_H \\leq c_H L$ (for large $L$)\n2261:    - **Derivation**: Lemma 4.3.7, combining projection bound with radius bound\n2262:    - **N-Dependence**: None (geometric constants)\n2263:    - **Typical Value**: For $c_0 = 0.5$, $c_H = 0.6$: $\\eta_{\\text{geo}} \\approx 0.025$\n2264: \n2265: 3. **Unfit-High-Error Overlap Fraction** $f_{UH}(\\varepsilon)$:\n2266:    $$\n2267:    f_{UH}(\\varepsilon) := \\frac{\\text{# walkers in } U_k \\cap H_k}{N}\n2268:    $$\n2269:    where $U_k$ is the set of unfit walkers (lower 50% fitness) and $H_k$ is the high-error set (pointing toward other swarm).\n2270:    - **Derivation**: Lemma 4.6, geometric separation argument\n2271:    - **Lower Bound**: $f_{UH}(\\varepsilon) \\geq \\varepsilon^2 / 4$ for geometric overlap parameter $\\varepsilon$\n2272:    - **N-Dependence**: None (fraction is $O(1)$ as $N \\to \\infty$)\n2273:    - **Typical Value**: For $\\varepsilon = 0.1$: $f_{UH} \\geq 0.0025$\n2274: \n2275: 4. **Minimum Gibbs Matching Probability** $q_{\\min}(\\varepsilon)$:\n2276:    $$\n2277:    q_{\\min}(\\varepsilon) := \\min_{i,j} \\frac{\\exp(-\\beta V_{\\text{fit},k,i}) \\exp(-\\beta V_{\\text{fit},\\ell,j})}{Z^2}\n2278:    $$\n2279:    where $Z = \\sum_{i=1}^N \\exp(-\\beta V_{\\text{fit},k,i})$ is the partition function.\n2280:    - **Derivation**: Section 1.2, Gibbs matching distribution\n2281:    - **Lower Bound**: $q_{\\min} \\geq \\frac{e^{-2\\beta V_{\\max}}}{N^2}$ but effective bound is $\\frac{e^{-2\\beta V_{\\max}}}{Z^2}$\n2282:    - **N-Dependence**: For fixed $\\beta$, $Z \\sim N$ and $q_{\\min} \\sim 1/N^2$, BUT this cancels in expectation over matching",
      "metadata": {
        "label": "def-main-contraction-constant"
      },
      "section": "## 8. Main Wasserstein-2 Contraction Theorem",
      "raw_directive": "2231: #### 8.2.1. Contraction Constant $\\kappa_W$\n2232: \n2233: :::{prf:definition} Main Contraction Constant\n2234: :label: def-main-contraction-constant\n2235: \n2236: The contraction constant is:\n2237: $$\n2238: \\kappa_W := \\kappa_{\\text{pair}} = \\frac{1}{2} \\cdot \\frac{p_u \\eta_{\\text{geo}}}{2} \\cdot f_{UH}(\\varepsilon) \\cdot q_{\\min}(\\varepsilon)\n2239: $$\n2240: \n2241: where the factor of $1/2$ comes from Corollary 5.5 (large separation regime).\n2242: \n2243: **Component Definitions**:\n2244: \n2245: 1. **Minimum Survival Probability** $p_u$:\n2246:    $$\n2247:    p_u := \\exp(-\\beta \\Delta V_{\\max})\n2248:    $$\n2249:    where $\\Delta V_{\\max}$ is the maximum virtual reward difference across the swarm.\n2250:    - **Derivation**: Section 4.4, minimum Gibbs probability\n2251:    - **N-Dependence**: None (virtual rewards are bounded by axioms)\n2252:    - **Typical Value**: $e^{-10} \\approx 4.5 \\times 10^{-5}$ for $\\beta = 1$, $\\Delta V_{\\max} = 10$\n2253: \n2254: 2. **Geometric Efficiency** $\\eta_{\\text{geo}}$:\n2255:    $$\n2256:    \\eta_{\\text{geo}} := \\frac{c_0^2}{2(1 + 2c_H)^2}\n2257:    $$\n2258:    where:\n2259:    - $c_0$ is the projection constant from Lemma 4.3.7 (High-Error Projection): $R_H \\geq c_0 L - c_1$\n2260:    - $c_H$ is the high-error radius constant: $R_H \\leq c_H L$ (for large $L$)\n2261:    - **Derivation**: Lemma 4.3.7, combining projection bound with radius bound\n2262:    - **N-Dependence**: None (geometric constants)\n2263:    - **Typical Value**: For $c_0 = 0.5$, $c_H = 0.6$: $\\eta_{\\text{geo}} \\approx 0.025$\n2264: \n2265: 3. **Unfit-High-Error Overlap Fraction** $f_{UH}(\\varepsilon)$:\n2266:    $$\n2267:    f_{UH}(\\varepsilon) := \\frac{\\text{# walkers in } U_k \\cap H_k}{N}\n2268:    $$\n2269:    where $U_k$ is the set of unfit walkers (lower 50% fitness) and $H_k$ is the high-error set (pointing toward other swarm).\n2270:    - **Derivation**: Lemma 4.6, geometric separation argument\n2271:    - **Lower Bound**: $f_{UH}(\\varepsilon) \\geq \\varepsilon^2 / 4$ for geometric overlap parameter $\\varepsilon$\n2272:    - **N-Dependence**: None (fraction is $O(1)$ as $N \\to \\infty$)\n2273:    - **Typical Value**: For $\\varepsilon = 0.1$: $f_{UH} \\geq 0.0025$\n2274: \n2275: 4. **Minimum Gibbs Matching Probability** $q_{\\min}(\\varepsilon)$:\n2276:    $$\n2277:    q_{\\min}(\\varepsilon) := \\min_{i,j} \\frac{\\exp(-\\beta V_{\\text{fit},k,i}) \\exp(-\\beta V_{\\text{fit},\\ell,j})}{Z^2}\n2278:    $$\n2279:    where $Z = \\sum_{i=1}^N \\exp(-\\beta V_{\\text{fit},k,i})$ is the partition function.\n2280:    - **Derivation**: Section 1.2, Gibbs matching distribution\n2281:    - **Lower Bound**: $q_{\\min} \\geq \\frac{e^{-2\\beta V_{\\max}}}{N^2}$ but effective bound is $\\frac{e^{-2\\beta V_{\\max}}}{Z^2}$\n2282:    - **N-Dependence**: For fixed $\\beta$, $Z \\sim N$ and $q_{\\min} \\sim 1/N^2$, BUT this cancels in expectation over matching\n2283:    - **Typical Value**: For $\\beta = 1$, $V_{\\max} = 10$: $q_{\\min} \\geq e^{-20}/Z^2$"
    },
    {
      "directive_type": "definition",
      "label": "def-noise-constant",
      "title": "Wasserstein Noise Constant",
      "start_line": 2293,
      "end_line": 2324,
      "header_lines": [
        2294
      ],
      "content_start": 2296,
      "content_end": 2323,
      "content": "2296: :label: def-noise-constant\n2297: \n2298: The noise constant is:\n2299: $$\n2300: C_W := 4d\\delta^2\n2301: $$\n2302: \n2303: where:\n2304: - $d$ is the state space dimension\n2305: - $\\delta$ is the jitter noise scale: $\\zeta_i \\sim \\mathcal{N}(0, \\delta^2 I_d)$\n2306: \n2307: **Derivation**: From the jitter step in the cloning operator:\n2308: $$\n2309: x'_{k,i} = \\begin{cases}\n2310: x_{k,i} + \\zeta_i & \\text{if } i \\text{ survives} \\\\\n2311: x_{k,j} + \\zeta_i & \\text{if } i \\text{ eliminated, replaced by } j\n2312: \\end{cases}\n2313: $$\n2314: \n2315: The jitter adds noise to both walkers in a pair:\n2316: $$\n2317: \\mathbb{E}[\\|(\\zeta_i - \\zeta_j)\\|^2] = \\mathbb{E}[\\|\\zeta_i\\|^2] + \\mathbb{E}[\\|\\zeta_j\\|^2] = 2d\\delta^2\n2318: $$\n2319: \n2320: For worst-case analysis (both walkers get independent jitter):\n2321: $$\n2322: C_W = 2 \\cdot 2d\\delta^2 = 4d\\delta^2\n2323: $$",
      "metadata": {
        "label": "def-noise-constant"
      },
      "section": "## 8. Main Wasserstein-2 Contraction Theorem",
      "raw_directive": "2293: #### 8.2.2. Noise Constant $C_W$\n2294: \n2295: :::{prf:definition} Wasserstein Noise Constant\n2296: :label: def-noise-constant\n2297: \n2298: The noise constant is:\n2299: $$\n2300: C_W := 4d\\delta^2\n2301: $$\n2302: \n2303: where:\n2304: - $d$ is the state space dimension\n2305: - $\\delta$ is the jitter noise scale: $\\zeta_i \\sim \\mathcal{N}(0, \\delta^2 I_d)$\n2306: \n2307: **Derivation**: From the jitter step in the cloning operator:\n2308: $$\n2309: x'_{k,i} = \\begin{cases}\n2310: x_{k,i} + \\zeta_i & \\text{if } i \\text{ survives} \\\\\n2311: x_{k,j} + \\zeta_i & \\text{if } i \\text{ eliminated, replaced by } j\n2312: \\end{cases}\n2313: $$\n2314: \n2315: The jitter adds noise to both walkers in a pair:\n2316: $$\n2317: \\mathbb{E}[\\|(\\zeta_i - \\zeta_j)\\|^2] = \\mathbb{E}[\\|\\zeta_i\\|^2] + \\mathbb{E}[\\|\\zeta_j\\|^2] = 2d\\delta^2\n2318: $$\n2319: \n2320: For worst-case analysis (both walkers get independent jitter):\n2321: $$\n2322: C_W = 2 \\cdot 2d\\delta^2 = 4d\\delta^2\n2323: $$\n2324: "
    },
    {
      "directive_type": "definition",
      "label": "def-separation-threshold",
      "title": "Asymptotic Separation Threshold",
      "start_line": 2330,
      "end_line": 2350,
      "header_lines": [
        2331
      ],
      "content_start": 2333,
      "content_end": 2349,
      "content": "2333: :label: def-separation-threshold\n2334: \n2335: The separation threshold $L_0(\\delta, \\varepsilon)$ is defined as:\n2336: $$\n2337: L_0 := \\max\\left(D_{\\min}, \\frac{2\\sqrt{d}\\delta}{\\sqrt{\\kappa_B f_{UH} q_{\\min}}}\\right)\n2338: $$\n2339: \n2340: where:\n2341: - $D_{\\min}$ is the minimum separation for geometric partition (from Axiom 3.3)\n2342: - The second term ensures Case A expansion is negligible: $\\varepsilon_A = 4d\\delta^2/L^2 < \\kappa_B f_{UH} q_{\\min}$\n2343: \n2344: **Physical Interpretation**: Below $L_0$, the swarms are too close for the geometric partition to be well-defined, or the noise $\\delta$ dominates over the geometric contraction. Above $L_0$, we enter the **asymptotic regime** where Wasserstein-2 contraction holds.\n2345: \n2346: **Typical Value**: For $d = 10$, $\\delta = 0.1$, $\\kappa_B = 0.01$, $f_{UH} = 0.0025$, $q_{\\min} = 0.001$:\n2347: $$\n2348: L_0 \\approx \\max\\left(D_{\\min}, \\frac{2\\sqrt{10} \\cdot 0.1}{\\sqrt{0.01 \\cdot 0.0025 \\cdot 0.001}}\\right) \\approx \\max(D_{\\min}, 126)\n2349: $$",
      "metadata": {
        "label": "def-separation-threshold"
      },
      "section": "## 8. Main Wasserstein-2 Contraction Theorem",
      "raw_directive": "2330: #### 8.2.3. Separation Threshold $L_0$\n2331: \n2332: :::{prf:definition} Asymptotic Separation Threshold\n2333: :label: def-separation-threshold\n2334: \n2335: The separation threshold $L_0(\\delta, \\varepsilon)$ is defined as:\n2336: $$\n2337: L_0 := \\max\\left(D_{\\min}, \\frac{2\\sqrt{d}\\delta}{\\sqrt{\\kappa_B f_{UH} q_{\\min}}}\\right)\n2338: $$\n2339: \n2340: where:\n2341: - $D_{\\min}$ is the minimum separation for geometric partition (from Axiom 3.3)\n2342: - The second term ensures Case A expansion is negligible: $\\varepsilon_A = 4d\\delta^2/L^2 < \\kappa_B f_{UH} q_{\\min}$\n2343: \n2344: **Physical Interpretation**: Below $L_0$, the swarms are too close for the geometric partition to be well-defined, or the noise $\\delta$ dominates over the geometric contraction. Above $L_0$, we enter the **asymptotic regime** where Wasserstein-2 contraction holds.\n2345: \n2346: **Typical Value**: For $d = 10$, $\\delta = 0.1$, $\\kappa_B = 0.01$, $f_{UH} = 0.0025$, $q_{\\min} = 0.001$:\n2347: $$\n2348: L_0 \\approx \\max\\left(D_{\\min}, \\frac{2\\sqrt{10} \\cdot 0.1}{\\sqrt{0.01 \\cdot 0.0025 \\cdot 0.001}}\\right) \\approx \\max(D_{\\min}, 126)\n2349: $$\n2350: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-178",
      "title": null,
      "start_line": 2358,
      "end_line": 2440,
      "header_lines": [],
      "content_start": 2359,
      "content_end": 2439,
      "content": "2359: \n2360: :::{prf:proof}\n2361: The proof proceeds in five steps, each corresponding to a major section:\n2362: \n2363: **Step 1: Synchronous Coupling Construction** (Section 1)\n2364: \n2365: By Proposition 1.1 and Remark 1.3, there exists a synchronous coupling of $(\\mu_1, \\mu_2)$ using:\n2366: - Shared randomness: Measurement outcomes $M$, thresholds $\\{T_i\\}$, jitter $\\{\\zeta_i\\}$\n2367: - Independent selections: Companions $\\{j_i^{(1)}\\}, \\{j_i^{(2)}\\}$ drawn from Gibbs matching\n2368: \n2369: This coupling is **sufficient** (though not necessarily optimal) for Wasserstein-2 contraction analysis.\n2370: \n2371: **Step 2: Outlier Alignment** (Section 2)\n2372: \n2373: By Lemma 2.2 (Outlier Alignment for Separated Swarms), for swarms with separation $L > D_{\\min}$:\n2374: - Each swarm has outliers pointing away from the other swarm\n2375: - These outliers have lower fitness (fitness valley between swarms)\n2376: - When cloned, they create a geometric advantage for Case B pairs\n2377: \n2378: This establishes the **geometric foundation** for contraction.\n2379: \n2380: **Step 3: Case A and Case B Analysis** (Sections 3-4)\n2381: \n2382: By Lemma 5.1 (Case A Weak Expansion):\n2383: $$\n2384: \\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case A}] \\leq D_{i\\pi(i)} (1 + \\varepsilon_A)\n2385: $$\n2386: where $\\varepsilon_A = 4d\\delta^2 / L^2 = O(\\delta^2/L^2)$.\n2387: \n2388: By Lemma 5.2 (Case B Strong Contraction):\n2389: $$\n2390: \\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case B}] \\leq D_{i\\pi(i)} (1 - \\kappa_B) + C_W\n2391: $$\n2392: where $\\kappa_B = \\frac{p_u \\eta_{\\text{geo}}}{2} = O(1)$ is independent of $L$.\n2393: \n2394: The key resolution of the scaling issue is:\n2395: - **Exact Distance Change Identity** (Proposition 4.3.6): $D_{ii} - D_{ji} = (N-1)\\|x_j - x_i\\|^2 + 2N\\langle x_j - x_i, x_i - \\bar{x}\\rangle$\n2396: - **High-Error Projection** (Lemma 4.3.7): $R_H \\geq c_0 L - c_1$\n2397: - **Combined**: $D_{ii} - D_{ji} \\sim L^2$, giving **O(1) contraction**\n2398: \n2399: **Step 4: Probability-Weighted Single-Pair Contraction** (Section 5)\n2400: \n2401: By Theorem 5.3 (Single-Pair Expected Contraction):\n2402: $$\n2403: \\mathbb{E}[D'_{i\\pi(i)} \\mid M, T] \\leq (1 - \\kappa_{\\text{pair}}) D_{i\\pi(i)} + C_W\n2404: $$\n2405: \n2406: where:\n2407: $$\n2408: \\kappa_{\\text{pair}} = \\mathbb{P}(\\text{Case B}) \\kappa_B - \\mathbb{P}(\\text{Case A}) \\varepsilon_A\n2409: $$\n2410: \n2411: By Lemma 4.6 (Case B Frequency Lower Bound):\n2412: $$\n2413: \\mathbb{P}(\\text{Case B}) \\geq f_{UH}(\\varepsilon) q_{\\min}(\\varepsilon) > 0\n2414: $$\n2415: \n2416: For $L > L_0$, by Corollary 5.5:\n2417: $$\n2418: \\kappa_{\\text{pair}} \\geq \\frac{\\kappa_B f_{UH} q_{\\min}}{2} > 0\n2419: $$\n2420: \n2421: **Step 5: Sum Over All Pairs** (Section 7)\n2422: \n2423: By the synchronous coupling, the Wasserstein-2 distance is:\n2424: $$\n2425: W_2^2(\\mu_1, \\mu_2) = \\mathbb{E}_\\pi \\left[\\frac{1}{N} \\sum_{i=1}^N \\|x_{1,i} - x_{2,\\pi(i)}\\|^2\\right]\n2426: $$\n2427: \n2428: Applying the single-pair bound to all pairs:\n2429: $$\n2430: W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2)) = \\mathbb{E}_\\pi \\left[\\frac{1}{N} \\sum_{i=1}^N \\mathbb{E}[D'_{i\\pi(i)} \\mid M, T]\\right]\n2431: $$\n2432: \n2433: $$\n2434: \\leq \\mathbb{E}_\\pi \\left[\\frac{1}{N} \\sum_{i=1}^N [(1 - \\kappa_{\\text{pair}}) D_{i\\pi(i)} + C_W]\\right]\n2435: $$\n2436: \n2437: $$\n2438: = (1 - \\kappa_{\\text{pair}}) W_2^2(\\mu_1, \\mu_2) + C_W\n2439: $$",
      "metadata": {},
      "section": "## 8. Main Wasserstein-2 Contraction Theorem",
      "raw_directive": "2358: We now assemble the complete proof by citing the key results from Sections 1-7.\n2359: \n2360: :::{prf:proof}\n2361: The proof proceeds in five steps, each corresponding to a major section:\n2362: \n2363: **Step 1: Synchronous Coupling Construction** (Section 1)\n2364: \n2365: By Proposition 1.1 and Remark 1.3, there exists a synchronous coupling of $(\\mu_1, \\mu_2)$ using:\n2366: - Shared randomness: Measurement outcomes $M$, thresholds $\\{T_i\\}$, jitter $\\{\\zeta_i\\}$\n2367: - Independent selections: Companions $\\{j_i^{(1)}\\}, \\{j_i^{(2)}\\}$ drawn from Gibbs matching\n2368: \n2369: This coupling is **sufficient** (though not necessarily optimal) for Wasserstein-2 contraction analysis.\n2370: \n2371: **Step 2: Outlier Alignment** (Section 2)\n2372: \n2373: By Lemma 2.2 (Outlier Alignment for Separated Swarms), for swarms with separation $L > D_{\\min}$:\n2374: - Each swarm has outliers pointing away from the other swarm\n2375: - These outliers have lower fitness (fitness valley between swarms)\n2376: - When cloned, they create a geometric advantage for Case B pairs\n2377: \n2378: This establishes the **geometric foundation** for contraction.\n2379: \n2380: **Step 3: Case A and Case B Analysis** (Sections 3-4)\n2381: \n2382: By Lemma 5.1 (Case A Weak Expansion):\n2383: $$\n2384: \\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case A}] \\leq D_{i\\pi(i)} (1 + \\varepsilon_A)\n2385: $$\n2386: where $\\varepsilon_A = 4d\\delta^2 / L^2 = O(\\delta^2/L^2)$.\n2387: \n2388: By Lemma 5.2 (Case B Strong Contraction):\n2389: $$\n2390: \\mathbb{E}[D'_{i\\pi(i)} \\mid \\text{Case B}] \\leq D_{i\\pi(i)} (1 - \\kappa_B) + C_W\n2391: $$\n2392: where $\\kappa_B = \\frac{p_u \\eta_{\\text{geo}}}{2} = O(1)$ is independent of $L$.\n2393: \n2394: The key resolution of the scaling issue is:\n2395: - **Exact Distance Change Identity** (Proposition 4.3.6): $D_{ii} - D_{ji} = (N-1)\\|x_j - x_i\\|^2 + 2N\\langle x_j - x_i, x_i - \\bar{x}\\rangle$\n2396: - **High-Error Projection** (Lemma 4.3.7): $R_H \\geq c_0 L - c_1$\n2397: - **Combined**: $D_{ii} - D_{ji} \\sim L^2$, giving **O(1) contraction**\n2398: \n2399: **Step 4: Probability-Weighted Single-Pair Contraction** (Section 5)\n2400: \n2401: By Theorem 5.3 (Single-Pair Expected Contraction):\n2402: $$\n2403: \\mathbb{E}[D'_{i\\pi(i)} \\mid M, T] \\leq (1 - \\kappa_{\\text{pair}}) D_{i\\pi(i)} + C_W\n2404: $$\n2405: \n2406: where:\n2407: $$\n2408: \\kappa_{\\text{pair}} = \\mathbb{P}(\\text{Case B}) \\kappa_B - \\mathbb{P}(\\text{Case A}) \\varepsilon_A\n2409: $$\n2410: \n2411: By Lemma 4.6 (Case B Frequency Lower Bound):\n2412: $$\n2413: \\mathbb{P}(\\text{Case B}) \\geq f_{UH}(\\varepsilon) q_{\\min}(\\varepsilon) > 0\n2414: $$\n2415: \n2416: For $L > L_0$, by Corollary 5.5:\n2417: $$\n2418: \\kappa_{\\text{pair}} \\geq \\frac{\\kappa_B f_{UH} q_{\\min}}{2} > 0\n2419: $$\n2420: \n2421: **Step 5: Sum Over All Pairs** (Section 7)\n2422: \n2423: By the synchronous coupling, the Wasserstein-2 distance is:\n2424: $$\n2425: W_2^2(\\mu_1, \\mu_2) = \\mathbb{E}_\\pi \\left[\\frac{1}{N} \\sum_{i=1}^N \\|x_{1,i} - x_{2,\\pi(i)}\\|^2\\right]\n2426: $$\n2427: \n2428: Applying the single-pair bound to all pairs:\n2429: $$\n2430: W_2^2(\\Psi_{\\text{clone}}(\\mu_1), \\Psi_{\\text{clone}}(\\mu_2)) = \\mathbb{E}_\\pi \\left[\\frac{1}{N} \\sum_{i=1}^N \\mathbb{E}[D'_{i\\pi(i)} \\mid M, T]\\right]\n2431: $$\n2432: \n2433: $$\n2434: \\leq \\mathbb{E}_\\pi \\left[\\frac{1}{N} \\sum_{i=1}^N [(1 - \\kappa_{\\text{pair}}) D_{i\\pi(i)} + C_W]\\right]\n2435: $$\n2436: \n2437: $$\n2438: = (1 - \\kappa_{\\text{pair}}) W_2^2(\\mu_1, \\mu_2) + C_W\n2439: $$\n2440: "
    },
    {
      "directive_type": "proposition",
      "label": "prop-n-uniformity",
      "title": "N-Uniformity of Contraction Constant",
      "start_line": 2448,
      "end_line": 2491,
      "header_lines": [
        2449
      ],
      "content_start": 2451,
      "content_end": 2490,
      "content": "2451: :label: prop-n-uniformity\n2452: \n2453: The contraction constant $\\kappa_W$ is independent of $N$ in the following sense:\n2454: \n2455: For each component:\n2456: 1. $p_u = \\exp(-\\beta \\Delta V_{\\max})$ \u2713 **N-independent** (fitness bounds from axioms)\n2457: 2. $\\eta_{\\text{geo}} = \\frac{c_0^2}{2(1 + 2c_H)^2}$ \u2713 **N-independent** (geometric constants)\n2458: 3. $f_{UH}(\\varepsilon)$ is a **fraction** \u2713 **N-independent** (ratio of walker counts)\n2459: 4. $q_{\\min}(\\varepsilon)$ appears to scale as $1/N^2$ \u2717 **BUT** see below\n2460: \n2461: **Resolution of $q_{\\min}$ N-Dependence**:\n2462: \n2463: The minimum matching probability is:\n2464: $$\n2465: q_{\\min} = \\min_{i,j} \\frac{\\exp(-\\beta V_{\\text{fit},1,i}) \\exp(-\\beta V_{\\text{fit},2,j})}{Z_1 Z_2}\n2466: $$\n2467: \n2468: where $Z_k = \\sum_{\\ell=1}^N \\exp(-\\beta V_{\\text{fit},k,\\ell}) \\sim N$ for large $N$.\n2469: \n2470: Thus, $q_{\\min} \\sim 1/N^2$, which seems to make $\\kappa_W \\sim 1/N^2$.\n2471: \n2472: **However**, in the expectation over matching:\n2473: $$\n2474: \\mathbb{E}_\\pi[\\kappa_{\\text{pair}}] = \\sum_{i=1}^N \\sum_{j=1}^N q_{ij} \\cdot \\kappa_{\\text{pair}}(i, j)\n2475: $$\n2476: \n2477: The sum has $N^2$ terms, each with weight $q_{ij} \\sim 1/N^2$, giving **cancellation**:\n2478: $$\n2479: \\sum_{i,j} q_{ij} = 1 \\quad \\text{(normalization)}\n2480: $$\n2481: \n2482: Therefore, the **effective** contraction constant is:\n2483: $$\n2484: \\kappa_W^{\\text{eff}} = \\sum_{i,j} q_{ij} \\cdot \\kappa_{\\text{pair}}(i, j)\n2485: $$\n2486: \n2487: For pairs in Case B (which occur with fraction $f_{UH}$):\n2488: $$\n2489: \\kappa_W^{\\text{eff}} \\geq f_{UH} \\cdot \\min_{\\text{Case B pairs}} \\kappa_{\\text{pair}}(i, j)\n2490: $$",
      "metadata": {
        "label": "prop-n-uniformity"
      },
      "section": "## 8. Main Wasserstein-2 Contraction Theorem",
      "raw_directive": "2448: A critical property for mean-field limit is that the contraction constant $\\kappa_W$ is **independent of the number of walkers $N$**.\n2449: \n2450: :::{prf:proposition} N-Uniformity of Contraction Constant\n2451: :label: prop-n-uniformity\n2452: \n2453: The contraction constant $\\kappa_W$ is independent of $N$ in the following sense:\n2454: \n2455: For each component:\n2456: 1. $p_u = \\exp(-\\beta \\Delta V_{\\max})$ \u2713 **N-independent** (fitness bounds from axioms)\n2457: 2. $\\eta_{\\text{geo}} = \\frac{c_0^2}{2(1 + 2c_H)^2}$ \u2713 **N-independent** (geometric constants)\n2458: 3. $f_{UH}(\\varepsilon)$ is a **fraction** \u2713 **N-independent** (ratio of walker counts)\n2459: 4. $q_{\\min}(\\varepsilon)$ appears to scale as $1/N^2$ \u2717 **BUT** see below\n2460: \n2461: **Resolution of $q_{\\min}$ N-Dependence**:\n2462: \n2463: The minimum matching probability is:\n2464: $$\n2465: q_{\\min} = \\min_{i,j} \\frac{\\exp(-\\beta V_{\\text{fit},1,i}) \\exp(-\\beta V_{\\text{fit},2,j})}{Z_1 Z_2}\n2466: $$\n2467: \n2468: where $Z_k = \\sum_{\\ell=1}^N \\exp(-\\beta V_{\\text{fit},k,\\ell}) \\sim N$ for large $N$.\n2469: \n2470: Thus, $q_{\\min} \\sim 1/N^2$, which seems to make $\\kappa_W \\sim 1/N^2$.\n2471: \n2472: **However**, in the expectation over matching:\n2473: $$\n2474: \\mathbb{E}_\\pi[\\kappa_{\\text{pair}}] = \\sum_{i=1}^N \\sum_{j=1}^N q_{ij} \\cdot \\kappa_{\\text{pair}}(i, j)\n2475: $$\n2476: \n2477: The sum has $N^2$ terms, each with weight $q_{ij} \\sim 1/N^2$, giving **cancellation**:\n2478: $$\n2479: \\sum_{i,j} q_{ij} = 1 \\quad \\text{(normalization)}\n2480: $$\n2481: \n2482: Therefore, the **effective** contraction constant is:\n2483: $$\n2484: \\kappa_W^{\\text{eff}} = \\sum_{i,j} q_{ij} \\cdot \\kappa_{\\text{pair}}(i, j)\n2485: $$\n2486: \n2487: For pairs in Case B (which occur with fraction $f_{UH}$):\n2488: $$\n2489: \\kappa_W^{\\text{eff}} \\geq f_{UH} \\cdot \\min_{\\text{Case B pairs}} \\kappa_{\\text{pair}}(i, j)\n2490: $$\n2491: "
    },
    {
      "directive_type": "assumption",
      "label": "assump-regime-validity",
      "title": "Regime of Validity for Wasserstein-2 Contraction",
      "start_line": 2527,
      "end_line": 2563,
      "header_lines": [
        2528
      ],
      "content_start": 2530,
      "content_end": 2562,
      "content": "2530: :label: assump-regime-validity\n2531: \n2532: 1. **Separation Requirement**: $L = \\|\\bar{x}_1 - \\bar{x}_2\\| > L_0(\\delta, \\varepsilon)$\n2533:    - Physical meaning: Swarms must be sufficiently separated for geometric partition to work\n2534:    - Typical value: $L_0 \\sim 100$ for $d=10$, $\\delta=0.1$\n2535: \n2536: 2. **Confining Potential** (Axiom 2.1.1):\n2537:    $$\n2538:    U(x) \\to +\\infty \\text{ as } \\|x\\| \\to \\infty\n2539:    $$\n2540:    - Ensures swarms don't escape to infinity\n2541:    - Guarantees fitness valley exists between local maxima\n2542: \n2543: 3. **Environmental Richness** (Axiom 4.1.1):\n2544:    $$\n2545:    \\exists x_{\\text{valley}} \\in [\\bar{x}_1, \\bar{x}_2]: \\quad F(x_{\\text{valley}}) < \\min(F(\\bar{x}_1), F(\\bar{x}_2)) - \\Delta_{\\text{valley}}\n2546:    $$\n2547:    - Ensures separated swarms are at distinct fitness peaks\n2548:    - Required for outlier alignment mechanism\n2549: \n2550: 4. **Bounded Virtual Rewards** (Axiom 1.2):\n2551:    $$\n2552:    \\|V_{\\text{fit},k,i} - V_{\\text{fit},k,j}\\| \\leq \\Delta V_{\\max}\n2553:    $$\n2554:    - Ensures minimum survival probability $p_u > 0$\n2555:    - Required for N-uniformity\n2556: \n2557: 5. **Small Noise Regime**: $\\delta \\ll L$\n2558:    - Ensures Case A expansion $\\varepsilon_A = O(\\delta^2/L^2)$ is negligible\n2559:    - Typical: $\\delta/L < 0.01$\n2560: \n2561: 6. **Moderate Exploitation**: $\\beta = O(1)$\n2562:    - Too small: No fitness-based selection (no cloning advantage)",
      "metadata": {
        "label": "assump-regime-validity"
      },
      "section": "## 8. Main Wasserstein-2 Contraction Theorem",
      "raw_directive": "2527: The theorem applies under the following conditions:\n2528: \n2529: :::{prf:assumption} Regime of Validity for Wasserstein-2 Contraction\n2530: :label: assump-regime-validity\n2531: \n2532: 1. **Separation Requirement**: $L = \\|\\bar{x}_1 - \\bar{x}_2\\| > L_0(\\delta, \\varepsilon)$\n2533:    - Physical meaning: Swarms must be sufficiently separated for geometric partition to work\n2534:    - Typical value: $L_0 \\sim 100$ for $d=10$, $\\delta=0.1$\n2535: \n2536: 2. **Confining Potential** (Axiom 2.1.1):\n2537:    $$\n2538:    U(x) \\to +\\infty \\text{ as } \\|x\\| \\to \\infty\n2539:    $$\n2540:    - Ensures swarms don't escape to infinity\n2541:    - Guarantees fitness valley exists between local maxima\n2542: \n2543: 3. **Environmental Richness** (Axiom 4.1.1):\n2544:    $$\n2545:    \\exists x_{\\text{valley}} \\in [\\bar{x}_1, \\bar{x}_2]: \\quad F(x_{\\text{valley}}) < \\min(F(\\bar{x}_1), F(\\bar{x}_2)) - \\Delta_{\\text{valley}}\n2546:    $$\n2547:    - Ensures separated swarms are at distinct fitness peaks\n2548:    - Required for outlier alignment mechanism\n2549: \n2550: 4. **Bounded Virtual Rewards** (Axiom 1.2):\n2551:    $$\n2552:    \\|V_{\\text{fit},k,i} - V_{\\text{fit},k,j}\\| \\leq \\Delta V_{\\max}\n2553:    $$\n2554:    - Ensures minimum survival probability $p_u > 0$\n2555:    - Required for N-uniformity\n2556: \n2557: 5. **Small Noise Regime**: $\\delta \\ll L$\n2558:    - Ensures Case A expansion $\\varepsilon_A = O(\\delta^2/L^2)$ is negligible\n2559:    - Typical: $\\delta/L < 0.01$\n2560: \n2561: 6. **Moderate Exploitation**: $\\beta = O(1)$\n2562:    - Too small: No fitness-based selection (no cloning advantage)\n2563:    - Too large: Deterministic selection (no randomness, potential stagnation)"
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}