{
  "chapter_index": 10,
  "section_id": "## 7. Foster-Lyapunov Drift for the Full Adaptive System",
  "directive_count": 3,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-fl-drift-adaptive",
      "title": "Foster-Lyapunov Drift for the \u03c1-Localized Geometric Viscous Fluid Model",
      "start_line": 1688,
      "end_line": 1726,
      "header_lines": [
        1689
      ],
      "content_start": 1691,
      "content_end": 1725,
      "content": "1691: :label: thm-fl-drift-adaptive\n1692: \n1693: For the Geometric Viscous Fluid Model with localization scale \u03c1 > 0, there exist **\u03c1-dependent critical parameters** $\\epsilon_F^*(\\rho) > 0$ and $\\nu^*(\\rho) > 0$ such that for all $0 \\le \\epsilon_F < \\epsilon_F^*(\\rho)$ and $0 \\le \\nu < \\nu^*(\\rho)$, the system satisfies a discrete-time Foster-Lyapunov drift condition:\n1694: \n1695: $$\n1696: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}}(\\rho)) V_{\\text{total}}(S_k) + C_{\\text{total}}(\\rho)\n1697: \n1698: $$\n1699: \n1700: for all $k \\ge 0$, where:\n1701: \n1702: $$\n1703: \\kappa_{\\text{total}}(\\rho) = \\kappa_{\\text{backbone}} - \\epsilon_F K_F(\\rho) > 0\n1704: \n1705: $$\n1706: \n1707: $$\n1708: C_{\\text{total}}(\\rho) = C_{\\text{backbone}} + C_{\\text{diff}}(\\rho) + \\epsilon_F K_F(\\rho) < \\infty\n1709: \n1710: $$\n1711: \n1712: **Critical Stability Threshold:**\n1713: \n1714: $$\n1715: \\epsilon_F^*(\\rho) := \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2 K_F(\\rho)}\n1716: \n1717: $$\n1718: \n1719: where $C_{\\text{diff,1}}(\\rho)$ captures the \u03c1-dependent diffusion perturbation contribution to the drift coefficient.\n1720: \n1721: **Interpretation:**\n1722: - For any fixed \u03c1 > 0, the critical threshold $\\epsilon_F^*(\\rho)$ is strictly positive\n1723: - Smaller \u03c1 (more local adaptation) \u2192 potentially larger $K_F(\\rho)$ \u2192 smaller $\\epsilon_F^*(\\rho)$ \u2192 more restrictive stability condition\n1724: - Larger \u03c1 (more global statistics) \u2192 smaller $K_F(\\rho)$ \u2192 larger $\\epsilon_F^*(\\rho)$ \u2192 as \u03c1 \u2192 \u221e, recovers the backbone threshold\n1725: - The convergence rate $\\kappa_{\\text{total}}(\\rho)$ depends on both \u03b5F and \u03c1, allowing tuning of the exploration-exploitation tradeoff",
      "metadata": {
        "label": "thm-fl-drift-adaptive"
      },
      "section": "## 7. Foster-Lyapunov Drift for the Full Adaptive System",
      "references": [],
      "raw_directive": "1688: ### 7.1. Main Theorem\n1689: \n1690: :::{prf:theorem} Foster-Lyapunov Drift for the \u03c1-Localized Geometric Viscous Fluid Model\n1691: :label: thm-fl-drift-adaptive\n1692: \n1693: For the Geometric Viscous Fluid Model with localization scale \u03c1 > 0, there exist **\u03c1-dependent critical parameters** $\\epsilon_F^*(\\rho) > 0$ and $\\nu^*(\\rho) > 0$ such that for all $0 \\le \\epsilon_F < \\epsilon_F^*(\\rho)$ and $0 \\le \\nu < \\nu^*(\\rho)$, the system satisfies a discrete-time Foster-Lyapunov drift condition:\n1694: \n1695: $$\n1696: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}}(\\rho)) V_{\\text{total}}(S_k) + C_{\\text{total}}(\\rho)\n1697: \n1698: $$\n1699: \n1700: for all $k \\ge 0$, where:\n1701: \n1702: $$\n1703: \\kappa_{\\text{total}}(\\rho) = \\kappa_{\\text{backbone}} - \\epsilon_F K_F(\\rho) > 0\n1704: \n1705: $$\n1706: \n1707: $$\n1708: C_{\\text{total}}(\\rho) = C_{\\text{backbone}} + C_{\\text{diff}}(\\rho) + \\epsilon_F K_F(\\rho) < \\infty\n1709: \n1710: $$\n1711: \n1712: **Critical Stability Threshold:**\n1713: \n1714: $$\n1715: \\epsilon_F^*(\\rho) := \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2 K_F(\\rho)}\n1716: \n1717: $$\n1718: \n1719: where $C_{\\text{diff,1}}(\\rho)$ captures the \u03c1-dependent diffusion perturbation contribution to the drift coefficient.\n1720: \n1721: **Interpretation:**\n1722: - For any fixed \u03c1 > 0, the critical threshold $\\epsilon_F^*(\\rho)$ is strictly positive\n1723: - Smaller \u03c1 (more local adaptation) \u2192 potentially larger $K_F(\\rho)$ \u2192 smaller $\\epsilon_F^*(\\rho)$ \u2192 more restrictive stability condition\n1724: - Larger \u03c1 (more global statistics) \u2192 smaller $K_F(\\rho)$ \u2192 larger $\\epsilon_F^*(\\rho)$ \u2192 as \u03c1 \u2192 \u221e, recovers the backbone threshold\n1725: - The convergence rate $\\kappa_{\\text{total}}(\\rho)$ depends on both \u03b5F and \u03c1, allowing tuning of the exploration-exploitation tradeoff\n1726: "
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-fl-drift-adaptive",
      "title": null,
      "start_line": 1730,
      "end_line": 1862,
      "header_lines": [
        1731
      ],
      "content_start": 1733,
      "content_end": 1861,
      "content": "1733: :label: proof-thm-fl-drift-adaptive\n1734: \n1735: The proof proceeds in six steps, working entirely in the continuous-time domain before discretization.\n1736: \n1737: **Step 1: Decompose the Stratonovich drift.** By Definition [](#def-strat-drift), the Stratonovich drift of $V_{\\text{total}}(S_t)$ is:\n1738: \n1739: $$\n1740: A_{\\text{full}}(S) = A_{\\text{backbone}}(S) + A_{\\text{perturb}}(S)\n1741: \n1742: $$\n1743: \n1744: where $A_{\\text{backbone}}$ is the drift of the backbone system (Section 5) and $A_{\\text{perturb}}$ is the perturbative contribution from the adaptive terms (Chapter 6).\n1745: \n1746: **Step 2: Establish the continuous-time backbone drift inequality.** The backbone system (with $\\epsilon_F = 0$, $\\nu = 0$, $\\Sigma_{\\text{reg}} = \\sigma I$) satisfies a continuous-time drift inequality. From the analysis in [04_convergence.md](../1_euclidean_gas/06_convergence.md), adapted to Stratonovich calculus, the expected drift satisfies:\n1747: \n1748: $$\n1749: \\mathbb{E}[A_{\\text{backbone}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}}\n1750: \n1751: $$\n1752: \n1753: for some $\\kappa_{\\text{backbone}} > 0$ and $C_{\\text{backbone}} < \\infty$.\n1754: \n1755: **Justification:** The backbone convergence was originally proven using discrete-time analysis. The continuous-time drift bound can be recovered by considering the infinitesimal time evolution:\n1756: \n1757: $$\n1758: \\frac{d}{dt} \\mathbb{E}[V_{\\text{total}}(S_t)] = \\mathbb{E}[A_{\\text{backbone}}(S_t)]\n1759: \n1760: $$\n1761: \n1762: The discrete-time bound $\\mathbb{E}[V'] \\le (1 - \\kappa \\Delta t) V + C \\Delta t$ implies, in the limit $\\Delta t \\to 0$, the continuous-time inequality $\\mathbb{E}[A] \\le -\\kappa V + C$.\n1763: \n1764: **Step 3: Bound the perturbative contribution (\u03c1-dependent).** By Corollary {prf:ref}`cor-total-perturbation`, the perturbative drift satisfies:\n1765: \n1766: $$\n1767: A_{\\text{perturb}}(S) \\le (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho))\n1768: \n1769: $$\n1770: \n1771: **Step 4: Combine the drift inequalities.** Adding Steps 2 and 3:\n1772: \n1773: $$\n1774: \\begin{aligned}\n1775: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] &= \\mathbb{E}[A_{\\text{backbone}}(S_t) + A_{\\text{perturb}}(S_t) \\mid S_t] \\\\\n1776: &\\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}} \\\\\n1777: &\\quad + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S_t) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)) \\\\\n1778: &= [- \\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)] V_{\\text{total}}(S_t) \\\\\n1779: &\\quad + [C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)]\n1780: \\end{aligned}\n1781: \n1782: $$\n1783: \n1784: **Step 5: Choose $\\epsilon_F$ to ensure negative drift (\u03c1-dependent threshold).** Define:\n1785: \n1786: $$\n1787: \\epsilon_F^*(\\rho) := \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2 K_F(\\rho)}\n1788: \n1789: $$\n1790: \n1791: (assuming $\\kappa_{\\text{backbone}} > C_{\\text{diff,1}}(\\rho)$, which holds for sufficiently strong backbone parameters and any finite \u03c1 > 0).\n1792: \n1793: For any $0 \\le \\epsilon_F < \\epsilon_F^*(\\rho)$, we have:\n1794: \n1795: $$\n1796: \\begin{aligned}\n1797: &-\\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho) \\\\\n1798: &< -\\kappa_{\\text{backbone}} + \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} + C_{\\text{diff,1}}(\\rho) \\\\\n1799: &= -\\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} < 0\n1800: \\end{aligned}\n1801: \n1802: $$\n1803: \n1804: Define:\n1805: \n1806: $$\n1807: \\kappa_{\\text{total}}(\\rho) := \\kappa_{\\text{backbone}} - \\epsilon_F K_F(\\rho) - C_{\\text{diff,1}}(\\rho) > 0\n1808: \n1809: $$\n1810: \n1811: $$\n1812: C_{\\text{total}}(\\rho) := C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho) < \\infty\n1813: \n1814: $$\n1815: \n1816: Then the continuous-time drift inequality for the full system is:\n1817: \n1818: $$\n1819: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{total}}(\\rho) V_{\\text{total}}(S_t) + C_{\\text{total}}(\\rho)\n1820: \n1821: $$\n1822: \n1823: **Step 6: Discretization (Justification for Adaptive System).**\n1824: \n1825: The Discretization Theorem (Theorem 1.7.2 in `04_convergence.md`) relates continuous-time drift inequalities to discrete-time Foster-Lyapunov conditions. However, that theorem was stated for the **backbone system** with constant diffusion $\\sigma I$. We must verify its hypotheses hold for the **adaptive system** with state-dependent diffusion $\\Sigma_{\\text{reg}}(x_i, S)$.\n1826: \n1827: **Key Requirements for the Discretization Theorem:**\n1828: 1. **Bounded derivatives of Lyapunov function:** $\\|\\nabla V_{\\text{total}}\\|$, $\\|\\nabla^2 V_{\\text{total}}\\|$ must be polynomially bounded\n1829: 2. **Bounded drift and diffusion:** The SDE coefficients must satisfy global Lipschitz and linear growth conditions\n1830: 3. **Regularity of integrator:** The BAOAB splitting integrator must have bounded weak error\n1831: \n1832: **Verification for the Adaptive System:**\n1833: \n1834: **Requirement 1 (Lyapunov Regularity):** The Lyapunov function $V_{\\text{total}}$ is a quadratic form in $(x, v)$ (variances and mean distances). Therefore:\n1835: - $\\nabla V_{\\text{total}}$ grows at most linearly: $\\|\\nabla V_{\\text{total}}(S)\\| \\le C_{\\nabla}(V_{\\text{total}}(S) + 1)$ (proven in Chapter 6, Lemma {prf:ref}`lem-adaptive-force-bounded`)\n1836: - $\\nabla^2 V_{\\text{total}}$ is uniformly bounded: $\\|\\nabla^2 V_{\\text{total}}\\| \\le C_{\\nabla^2} < \\infty$ (V is quadratic)\n1837: \n1838: **Requirement 2 (SDE Regularity):**\n1839: - **Drift boundedness:** By Appendix A (Theorem {prf:ref}`thm-c1-regularity`), $\\|\\mathbf{F}_{\\text{adapt}}\\| \\le \\epsilon_F F_{\\text{adapt,max}}(\\rho)$ is **N-uniform** and \u03c1-dependent. The viscous force is similarly bounded. The confining force $-\\nabla U$ has at most linear growth.\n1840: - **Diffusion boundedness:** By Theorem {prf:ref}`thm-ueph`, the regularized diffusion satisfies $c_{\\min}(\\rho) I \\preceq D_{\\text{reg}} \\preceq c_{\\max}(\\rho) I$ with **N-uniform** bounds.\n1841: - **Lipschitz continuity:** Established in Corollary {prf:ref}`cor-wellposed` (Step 1 of its proof)\n1842: \n1843: **Requirement 3 (Integrator Weak Error):** The BAOAB integrator used in `04_convergence.md` has weak error $O(\\Delta t^2)$ for SDEs with smooth coefficients (Leimkuhler-Matthews, \"Molecular Dynamics\", 2015). Since our adaptive drift and diffusion are smooth (C\u00b9 and C\u00b2 by Appendix A), the BAOAB integrator maintains its $O(\\Delta t^2)$ weak error bound.\n1844: \n1845: **Conclusion:** All hypotheses of the Discretization Theorem are satisfied by the adaptive system. The N-uniform bounds from Appendix A are crucial here - without them, the weak error analysis could fail as $N \\to \\infty$.\n1846: \n1847: Therefore, the continuous-time drift inequality implies the discrete-time Foster-Lyapunov condition:\n1848: \n1849: $$\n1850: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}} \\Delta t + O(\\Delta t^2)) V_{\\text{total}}(S_k) + (C_{\\text{total}} \\Delta t + O(\\Delta t^2))\n1851: \n1852: $$\n1853: \n1854: For sufficiently small $\\Delta t$, the $O(\\Delta t^2)$ terms can be absorbed, yielding:\n1855: \n1856: $$\n1857: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}}) V_{\\text{total}}(S_k) + C_{\\text{total}}\n1858: \n1859: $$\n1860: \n1861: where we redefine $\\kappa_{\\text{total}} := \\kappa_{\\text{total}} \\Delta t$ and $C_{\\text{total}} := C_{\\text{total}} \\Delta t$ for the discrete-time version.",
      "metadata": {
        "label": "proof-thm-fl-drift-adaptive"
      },
      "section": "## 7. Foster-Lyapunov Drift for the Full Adaptive System",
      "references": [
        "cor-total-perturbation",
        "lem-adaptive-force-bounded",
        "thm-c1-regularity",
        "thm-ueph",
        "cor-wellposed"
      ],
      "raw_directive": "1730: ### 7.2. Proof of Main Theorem\n1731: \n1732: :::{prf:proof}\n1733: :label: proof-thm-fl-drift-adaptive\n1734: \n1735: The proof proceeds in six steps, working entirely in the continuous-time domain before discretization.\n1736: \n1737: **Step 1: Decompose the Stratonovich drift.** By Definition [](#def-strat-drift), the Stratonovich drift of $V_{\\text{total}}(S_t)$ is:\n1738: \n1739: $$\n1740: A_{\\text{full}}(S) = A_{\\text{backbone}}(S) + A_{\\text{perturb}}(S)\n1741: \n1742: $$\n1743: \n1744: where $A_{\\text{backbone}}$ is the drift of the backbone system (Section 5) and $A_{\\text{perturb}}$ is the perturbative contribution from the adaptive terms (Chapter 6).\n1745: \n1746: **Step 2: Establish the continuous-time backbone drift inequality.** The backbone system (with $\\epsilon_F = 0$, $\\nu = 0$, $\\Sigma_{\\text{reg}} = \\sigma I$) satisfies a continuous-time drift inequality. From the analysis in [04_convergence.md](../1_euclidean_gas/06_convergence.md), adapted to Stratonovich calculus, the expected drift satisfies:\n1747: \n1748: $$\n1749: \\mathbb{E}[A_{\\text{backbone}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}}\n1750: \n1751: $$\n1752: \n1753: for some $\\kappa_{\\text{backbone}} > 0$ and $C_{\\text{backbone}} < \\infty$.\n1754: \n1755: **Justification:** The backbone convergence was originally proven using discrete-time analysis. The continuous-time drift bound can be recovered by considering the infinitesimal time evolution:\n1756: \n1757: $$\n1758: \\frac{d}{dt} \\mathbb{E}[V_{\\text{total}}(S_t)] = \\mathbb{E}[A_{\\text{backbone}}(S_t)]\n1759: \n1760: $$\n1761: \n1762: The discrete-time bound $\\mathbb{E}[V'] \\le (1 - \\kappa \\Delta t) V + C \\Delta t$ implies, in the limit $\\Delta t \\to 0$, the continuous-time inequality $\\mathbb{E}[A] \\le -\\kappa V + C$.\n1763: \n1764: **Step 3: Bound the perturbative contribution (\u03c1-dependent).** By Corollary {prf:ref}`cor-total-perturbation`, the perturbative drift satisfies:\n1765: \n1766: $$\n1767: A_{\\text{perturb}}(S) \\le (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho))\n1768: \n1769: $$\n1770: \n1771: **Step 4: Combine the drift inequalities.** Adding Steps 2 and 3:\n1772: \n1773: $$\n1774: \\begin{aligned}\n1775: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] &= \\mathbb{E}[A_{\\text{backbone}}(S_t) + A_{\\text{perturb}}(S_t) \\mid S_t] \\\\\n1776: &\\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}} \\\\\n1777: &\\quad + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S_t) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)) \\\\\n1778: &= [- \\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)] V_{\\text{total}}(S_t) \\\\\n1779: &\\quad + [C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)]\n1780: \\end{aligned}\n1781: \n1782: $$\n1783: \n1784: **Step 5: Choose $\\epsilon_F$ to ensure negative drift (\u03c1-dependent threshold).** Define:\n1785: \n1786: $$\n1787: \\epsilon_F^*(\\rho) := \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2 K_F(\\rho)}\n1788: \n1789: $$\n1790: \n1791: (assuming $\\kappa_{\\text{backbone}} > C_{\\text{diff,1}}(\\rho)$, which holds for sufficiently strong backbone parameters and any finite \u03c1 > 0).\n1792: \n1793: For any $0 \\le \\epsilon_F < \\epsilon_F^*(\\rho)$, we have:\n1794: \n1795: $$\n1796: \\begin{aligned}\n1797: &-\\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho) \\\\\n1798: &< -\\kappa_{\\text{backbone}} + \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} + C_{\\text{diff,1}}(\\rho) \\\\\n1799: &= -\\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} < 0\n1800: \\end{aligned}\n1801: \n1802: $$\n1803: \n1804: Define:\n1805: \n1806: $$\n1807: \\kappa_{\\text{total}}(\\rho) := \\kappa_{\\text{backbone}} - \\epsilon_F K_F(\\rho) - C_{\\text{diff,1}}(\\rho) > 0\n1808: \n1809: $$\n1810: \n1811: $$\n1812: C_{\\text{total}}(\\rho) := C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho) < \\infty\n1813: \n1814: $$\n1815: \n1816: Then the continuous-time drift inequality for the full system is:\n1817: \n1818: $$\n1819: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{total}}(\\rho) V_{\\text{total}}(S_t) + C_{\\text{total}}(\\rho)\n1820: \n1821: $$\n1822: \n1823: **Step 6: Discretization (Justification for Adaptive System).**\n1824: \n1825: The Discretization Theorem (Theorem 1.7.2 in `04_convergence.md`) relates continuous-time drift inequalities to discrete-time Foster-Lyapunov conditions. However, that theorem was stated for the **backbone system** with constant diffusion $\\sigma I$. We must verify its hypotheses hold for the **adaptive system** with state-dependent diffusion $\\Sigma_{\\text{reg}}(x_i, S)$.\n1826: \n1827: **Key Requirements for the Discretization Theorem:**\n1828: 1. **Bounded derivatives of Lyapunov function:** $\\|\\nabla V_{\\text{total}}\\|$, $\\|\\nabla^2 V_{\\text{total}}\\|$ must be polynomially bounded\n1829: 2. **Bounded drift and diffusion:** The SDE coefficients must satisfy global Lipschitz and linear growth conditions\n1830: 3. **Regularity of integrator:** The BAOAB splitting integrator must have bounded weak error\n1831: \n1832: **Verification for the Adaptive System:**\n1833: \n1834: **Requirement 1 (Lyapunov Regularity):** The Lyapunov function $V_{\\text{total}}$ is a quadratic form in $(x, v)$ (variances and mean distances). Therefore:\n1835: - $\\nabla V_{\\text{total}}$ grows at most linearly: $\\|\\nabla V_{\\text{total}}(S)\\| \\le C_{\\nabla}(V_{\\text{total}}(S) + 1)$ (proven in Chapter 6, Lemma {prf:ref}`lem-adaptive-force-bounded`)\n1836: - $\\nabla^2 V_{\\text{total}}$ is uniformly bounded: $\\|\\nabla^2 V_{\\text{total}}\\| \\le C_{\\nabla^2} < \\infty$ (V is quadratic)\n1837: \n1838: **Requirement 2 (SDE Regularity):**\n1839: - **Drift boundedness:** By Appendix A (Theorem {prf:ref}`thm-c1-regularity`), $\\|\\mathbf{F}_{\\text{adapt}}\\| \\le \\epsilon_F F_{\\text{adapt,max}}(\\rho)$ is **N-uniform** and \u03c1-dependent. The viscous force is similarly bounded. The confining force $-\\nabla U$ has at most linear growth.\n1840: - **Diffusion boundedness:** By Theorem {prf:ref}`thm-ueph`, the regularized diffusion satisfies $c_{\\min}(\\rho) I \\preceq D_{\\text{reg}} \\preceq c_{\\max}(\\rho) I$ with **N-uniform** bounds.\n1841: - **Lipschitz continuity:** Established in Corollary {prf:ref}`cor-wellposed` (Step 1 of its proof)\n1842: \n1843: **Requirement 3 (Integrator Weak Error):** The BAOAB integrator used in `04_convergence.md` has weak error $O(\\Delta t^2)$ for SDEs with smooth coefficients (Leimkuhler-Matthews, \"Molecular Dynamics\", 2015). Since our adaptive drift and diffusion are smooth (C\u00b9 and C\u00b2 by Appendix A), the BAOAB integrator maintains its $O(\\Delta t^2)$ weak error bound.\n1844: \n1845: **Conclusion:** All hypotheses of the Discretization Theorem are satisfied by the adaptive system. The N-uniform bounds from Appendix A are crucial here - without them, the weak error analysis could fail as $N \\to \\infty$.\n1846: \n1847: Therefore, the continuous-time drift inequality implies the discrete-time Foster-Lyapunov condition:\n1848: \n1849: $$\n1850: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}} \\Delta t + O(\\Delta t^2)) V_{\\text{total}}(S_k) + (C_{\\text{total}} \\Delta t + O(\\Delta t^2))\n1851: \n1852: $$\n1853: \n1854: For sufficiently small $\\Delta t$, the $O(\\Delta t^2)$ terms can be absorbed, yielding:\n1855: \n1856: $$\n1857: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}}) V_{\\text{total}}(S_k) + C_{\\text{total}}\n1858: \n1859: $$\n1860: \n1861: where we redefine $\\kappa_{\\text{total}} := \\kappa_{\\text{total}} \\Delta t$ and $C_{\\text{total}} := C_{\\text{total}} \\Delta t$ for the discrete-time version.\n1862: "
    },
    {
      "directive_type": "corollary",
      "label": "cor-exp-convergence",
      "title": "Exponential Convergence",
      "start_line": 1882,
      "end_line": 1893,
      "header_lines": [
        1883
      ],
      "content_start": 1885,
      "content_end": 1892,
      "content": "1885: :label: cor-exp-convergence\n1886: \n1887: Under the conditions of Theorem [](#thm-fl-drift-adaptive), the empirical distribution $\\mu_N(t)$ of the adaptive swarm converges exponentially fast to the unique Quasi-Stationary Distribution (QSD) $\\pi_{\\text{QSD}}$ in the Lyapunov distance:\n1888: \n1889: $$\n1890: \\mathbb{E}[V_{\\text{total}}(\\mu_N(t))] \\le (1 - \\kappa_{\\text{total}})^t V_{\\text{total}}(\\mu_N(0)) + \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}\n1891: \n1892: $$",
      "metadata": {
        "label": "cor-exp-convergence"
      },
      "section": "## 7. Foster-Lyapunov Drift for the Full Adaptive System",
      "references": [],
      "raw_directive": "1882: ### 7.3. Corollary: Exponential Convergence to the QSD\n1883: \n1884: :::{prf:corollary} Exponential Convergence\n1885: :label: cor-exp-convergence\n1886: \n1887: Under the conditions of Theorem [](#thm-fl-drift-adaptive), the empirical distribution $\\mu_N(t)$ of the adaptive swarm converges exponentially fast to the unique Quasi-Stationary Distribution (QSD) $\\pi_{\\text{QSD}}$ in the Lyapunov distance:\n1888: \n1889: $$\n1890: \\mathbb{E}[V_{\\text{total}}(\\mu_N(t))] \\le (1 - \\kappa_{\\text{total}})^t V_{\\text{total}}(\\mu_N(0)) + \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}\n1891: \n1892: $$\n1893: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}