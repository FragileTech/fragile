{
  "chapter_index": 6,
  "section_id": "## 4. Uniform Ellipticity and Well-Posedness",
  "directive_count": 10,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-ueph",
      "title": "k-Uniform Ellipticity of the Regularized Metric",
      "start_line": 650,
      "end_line": 692,
      "header_lines": [
        651
      ],
      "content_start": 653,
      "content_end": 691,
      "content": "653: :label: thm-ueph\n654: \n655: For the Geometric Viscous Fluid Model with regularization parameter $\\epsilon_\\Sigma$ satisfying:\n656: \n657: $$\n658: \\epsilon_\\Sigma > H_{\\max}(\\rho)\n659: \n660: $$\n661: \n662: where $H_{\\max}(\\rho)$ is the **k-uniform** (and thus **N-uniform**) bound on $\\|H(S)\\|$ from Appendix A, Theorem {prf:ref}`thm-c2-regularity`, the regularized metric\n663: \n664: $$\n665: G_{\\text{reg}}(S) = \\left( H(S) + \\epsilon_\\Sigma I \\right)^{-1}\n666: \n667: $$\n668: \n669: is uniformly elliptic with **k-uniform** (and thus **N-uniform**) ellipticity constants:\n670: \n671: $$\n672: c_{\\min}(\\rho) = \\frac{1}{H_{\\max}(\\rho) + \\epsilon_\\Sigma}, \\quad c_{\\max}(\\rho) = \\frac{1}{\\epsilon_\\Sigma - H_{\\max}(\\rho)}\n673: \n674: $$\n675: \n676: such that:\n677: \n678: $$\n679: c_{\\min}(\\rho) I \\preceq G_{\\text{reg}}(S) \\preceq c_{\\max}(\\rho) I\n680: \n681: $$\n682: \n683: for all $S \\in \\Sigma_N$, **all k** (alive walker counts), and **all N** (total swarm sizes).\n684: \n685: Equivalently, the eigenvalues of $G_{\\text{reg}}(S)$ satisfy:\n686: \n687: $$\n688: \\lambda_i(G_{\\text{reg}}(S)) \\in [c_{\\min}(\\rho), c_{\\max}(\\rho)] \\quad \\forall i \\in \\{1, \\ldots, d\\}, \\, \\forall S \\in \\Sigma_N, \\, \\forall k, \\, \\forall N \\in \\mathbb{N}\n689: \n690: $$\n691: ",
      "metadata": {
        "label": "thm-ueph"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "650: ### 4.1. Main Theorem: Uniform Ellipticity by Construction\n651: \n652: :::{prf:theorem} k-Uniform Ellipticity of the Regularized Metric\n653: :label: thm-ueph\n654: \n655: For the Geometric Viscous Fluid Model with regularization parameter $\\epsilon_\\Sigma$ satisfying:\n656: \n657: $$\n658: \\epsilon_\\Sigma > H_{\\max}(\\rho)\n659: \n660: $$\n661: \n662: where $H_{\\max}(\\rho)$ is the **k-uniform** (and thus **N-uniform**) bound on $\\|H(S)\\|$ from Appendix A, Theorem {prf:ref}`thm-c2-regularity`, the regularized metric\n663: \n664: $$\n665: G_{\\text{reg}}(S) = \\left( H(S) + \\epsilon_\\Sigma I \\right)^{-1}\n666: \n667: $$\n668: \n669: is uniformly elliptic with **k-uniform** (and thus **N-uniform**) ellipticity constants:\n670: \n671: $$\n672: c_{\\min}(\\rho) = \\frac{1}{H_{\\max}(\\rho) + \\epsilon_\\Sigma}, \\quad c_{\\max}(\\rho) = \\frac{1}{\\epsilon_\\Sigma - H_{\\max}(\\rho)}\n673: \n674: $$\n675: \n676: such that:\n677: \n678: $$\n679: c_{\\min}(\\rho) I \\preceq G_{\\text{reg}}(S) \\preceq c_{\\max}(\\rho) I\n680: \n681: $$\n682: \n683: for all $S \\in \\Sigma_N$, **all k** (alive walker counts), and **all N** (total swarm sizes).\n684: \n685: Equivalently, the eigenvalues of $G_{\\text{reg}}(S)$ satisfy:\n686: \n687: $$\n688: \\lambda_i(G_{\\text{reg}}(S)) \\in [c_{\\min}(\\rho), c_{\\max}(\\rho)] \\quad \\forall i \\in \\{1, \\ldots, d\\}, \\, \\forall S \\in \\Sigma_N, \\, \\forall k, \\, \\forall N \\in \\mathbb{N}\n689: \n690: $$\n691: \n692: **Critical Property:** Since $H_{\\max}(\\rho)$ is independent of k (and thus of N) by Theorem {prf:ref}`thm-c2-regularity`, the ellipticity constants depend only on \u03c1 and $\\epsilon_\\Sigma$, not on the alive walker count or swarm size. This ensures the adaptive diffusion remains well-conditioned for arbitrarily large swarms."
    },
    {
      "directive_type": "lemma",
      "label": "lem-hessian-bounded",
      "title": "N-Uniform Boundedness of the Pure Hessian",
      "start_line": 700,
      "end_line": 711,
      "header_lines": [
        701
      ],
      "content_start": 703,
      "content_end": 710,
      "content": "703: :label: lem-hessian-bounded\n704: \n705: Under the axiomatic framework of Section 3, the unregularized Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n706: \n707: $$\n708: \\|H(S)\\| \\le H_{\\max}(\\rho) < \\infty\n709: \n710: $$",
      "metadata": {
        "label": "lem-hessian-bounded"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "700: The proof proceeds in three steps: we first establish boundedness of the pure Hessian, then demonstrate why regularization is necessary, and finally prove the main theorem.\n701: \n702: :::{prf:lemma} N-Uniform Boundedness of the Pure Hessian\n703: :label: lem-hessian-bounded\n704: \n705: Under the axiomatic framework of Section 3, the unregularized Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n706: \n707: $$\n708: \\|H(S)\\| \\le H_{\\max}(\\rho) < \\infty\n709: \n710: $$\n711: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-hessian-bounded",
      "title": null,
      "start_line": 713,
      "end_line": 766,
      "header_lines": [
        714
      ],
      "content_start": 716,
      "content_end": 765,
      "content": "716: :label: proof-lem-hessian-bounded\n717: \n718: The fitness potential is constructed as:\n719: \n720: $$\n721: V_{\\text{fit}}(x) = g_A(Z_{\\text{reg}}(x))\n722: \n723: $$\n724: \n725: where $g_A: \\mathbb{R} \\to [0, A]$ is smooth and bounded, and:\n726: \n727: $$\n728: Z_{\\text{reg}}(x) = \\frac{d(x) - \\mu}{\\sigma\\'_{\\text{reg}}}\n729: \n730: $$\n731: \n732: with $\\sigma\\'_{\\text{reg}} \\ge \\sigma\\'_{\\min} > 0$ by construction.\n733: \n734: **Step 1: Gradient bounds.** By the chain rule:\n735: \n736: $$\n737: \\nabla V_{\\text{fit}}(x) = g'_A(Z) \\cdot \\nabla Z_{\\text{reg}}(x)\n738: \n739: $$\n740: \n741: Since $g_A$ is bounded and smooth, $|g'_A(Z)| \\le g'_{\\max}$ for all $Z$. The gradient of the Z-score involves derivatives of $d(x)$ and the \u03c1-localized statistics, all of which are bounded by the pipeline construction (bounded measurement function, finite patch radius). Thus:\n742: \n743: $$\n744: \\|\\nabla V_{\\text{fit}}(x)\\| \\le K_1 < \\infty\n745: \n746: $$\n747: \n748: **Step 2: Hessian bounds.** Taking another derivative:\n749: \n750: $$\n751: H(x) = \\nabla^2 V_{\\text{fit}}(x) = g''_A(Z) \\cdot (\\nabla Z) \\otimes (\\nabla Z) + g'_A(Z) \\cdot \\nabla^2 Z\n752: \n753: $$\n754: \n755: Both terms are bounded:\n756: - $|g''_A(Z)| \\le g''_{\\max}$ by smoothness of $g_A$.\n757: - $\\|\\nabla Z\\|^2 \\le K_1^2 / (g'_{\\max})^2$ from Step 1.\n758: - $\\|\\nabla^2 Z\\|$ is bounded by the twice-differentiability of $d$ and the regularization $\\sigma\\'_{\\min}$ in the denominator.\n759: \n760: Therefore:\n761: \n762: $$\n763: \\|H(S)\\| \\le H_{\\max} := g''_{\\max} K_1^2 / (g'_{\\max})^2 + g'_{\\max} K_2\n764: \n765: $$",
      "metadata": {
        "label": "proof-lem-hessian-bounded"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "713: :::\n714: \n715: :::{prf:proof}\n716: :label: proof-lem-hessian-bounded\n717: \n718: The fitness potential is constructed as:\n719: \n720: $$\n721: V_{\\text{fit}}(x) = g_A(Z_{\\text{reg}}(x))\n722: \n723: $$\n724: \n725: where $g_A: \\mathbb{R} \\to [0, A]$ is smooth and bounded, and:\n726: \n727: $$\n728: Z_{\\text{reg}}(x) = \\frac{d(x) - \\mu}{\\sigma\\'_{\\text{reg}}}\n729: \n730: $$\n731: \n732: with $\\sigma\\'_{\\text{reg}} \\ge \\sigma\\'_{\\min} > 0$ by construction.\n733: \n734: **Step 1: Gradient bounds.** By the chain rule:\n735: \n736: $$\n737: \\nabla V_{\\text{fit}}(x) = g'_A(Z) \\cdot \\nabla Z_{\\text{reg}}(x)\n738: \n739: $$\n740: \n741: Since $g_A$ is bounded and smooth, $|g'_A(Z)| \\le g'_{\\max}$ for all $Z$. The gradient of the Z-score involves derivatives of $d(x)$ and the \u03c1-localized statistics, all of which are bounded by the pipeline construction (bounded measurement function, finite patch radius). Thus:\n742: \n743: $$\n744: \\|\\nabla V_{\\text{fit}}(x)\\| \\le K_1 < \\infty\n745: \n746: $$\n747: \n748: **Step 2: Hessian bounds.** Taking another derivative:\n749: \n750: $$\n751: H(x) = \\nabla^2 V_{\\text{fit}}(x) = g''_A(Z) \\cdot (\\nabla Z) \\otimes (\\nabla Z) + g'_A(Z) \\cdot \\nabla^2 Z\n752: \n753: $$\n754: \n755: Both terms are bounded:\n756: - $|g''_A(Z)| \\le g''_{\\max}$ by smoothness of $g_A$.\n757: - $\\|\\nabla Z\\|^2 \\le K_1^2 / (g'_{\\max})^2$ from Step 1.\n758: - $\\|\\nabla^2 Z\\|$ is bounded by the twice-differentiability of $d$ and the regularization $\\sigma\\'_{\\min}$ in the denominator.\n759: \n760: Therefore:\n761: \n762: $$\n763: \\|H(S)\\| \\le H_{\\max} := g''_{\\max} K_1^2 / (g'_{\\max})^2 + g'_{\\max} K_2\n764: \n765: $$\n766: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-hessian-bounded-rigorous",
      "title": "Rigorous Boundedness of the Hessian",
      "start_line": 768,
      "end_line": 782,
      "header_lines": [
        769
      ],
      "content_start": 771,
      "content_end": 781,
      "content": "771: :label: lem-hessian-bounded-rigorous\n772: \n773: Under the fitness pipeline construction with regularized Z-score regularization, the Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n774: \n775: $$\n776: \\|H(S)\\| \\le H_{\\max} = \\frac{4 A g'_{\\max}^2 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} + \\frac{A g'_{\\max} \\|\\nabla^2 d\\|_{\\infty}}{\\sigma\\'_{\\min}} + \\frac{4 A g''_{\\max} \\|\\nabla d\\|^4_{\\infty}}{\\sigma'^4_{\\min,\\text{patch}}}\n777: \n778: $$\n779: \n780: for all swarm states $S$, where:\n781: - $\\|\\nabla d\\|_{\\infty}$ and $\\|\\nabla^2 d\\|_{\\infty}$ are uniform bounds on the measurement function derivatives",
      "metadata": {
        "label": "lem-hessian-bounded-rigorous"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "768: :::\n769: \n770: :::{prf:lemma} Rigorous Boundedness of the Hessian\n771: :label: lem-hessian-bounded-rigorous\n772: \n773: Under the fitness pipeline construction with regularized Z-score regularization, the Hessian $H(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ satisfies:\n774: \n775: $$\n776: \\|H(S)\\| \\le H_{\\max} = \\frac{4 A g'_{\\max}^2 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} + \\frac{A g'_{\\max} \\|\\nabla^2 d\\|_{\\infty}}{\\sigma\\'_{\\min}} + \\frac{4 A g''_{\\max} \\|\\nabla d\\|^4_{\\infty}}{\\sigma'^4_{\\min,\\text{patch}}}\n777: \n778: $$\n779: \n780: for all swarm states $S$, where:\n781: - $\\|\\nabla d\\|_{\\infty}$ and $\\|\\nabla^2 d\\|_{\\infty}$ are uniform bounds on the measurement function derivatives\n782: - $g'_{\\max}$ and $g''_{\\max}$ are bounds on the rescale function derivatives"
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-hessian-bounded-rigorous",
      "title": null,
      "start_line": 784,
      "end_line": 879,
      "header_lines": [
        785
      ],
      "content_start": 787,
      "content_end": 878,
      "content": "787: :label: proof-lem-hessian-bounded-rigorous\n788: \n789: We provide a complete derivation tracking all terms. Recall:\n790: \n791: $$\n792: V_{\\text{fit}}(x_i) = g_A\\left( Z_{\\text{reg}}(x_i) \\right), \\quad Z_{\\text{reg}}(x_i) = \\frac{d(x_i) - \\mu}{\\sigma\\'_{\\text{reg}}}\n793: \n794: $$\n795: \n796: where $\\sigma\\'_{\\text{reg}} = \\max\\{\\sqrt{\\sigma^2_{\\rho}}, \\sigma\\'_{\\min}\\}$.\n797: \n798: **Step 1: First derivative.** By the chain rule:\n799: \n800: $$\n801: \\nabla_{x_i} V_{\\text{fit}} = g'_A(Z) \\nabla_{x_i} Z_{\\text{reg}}\n802: \n803: $$\n804: \n805: For the Z-score:\n806: \n807: $$\n808: \\nabla_{x_i} Z_{\\text{reg}} = \\frac{1}{\\sigma\\'_{\\text{reg}}} \\left( \\nabla_{x_i} d - \\nabla_{x_i} \\mu \\right)\n809: \n810: $$\n811: \n812: The localized mean $\\mu$ depends on $x_i$ through both the indicator function $\\mathbb{1}_{\\{\\|x_j - x_i\\| \\le \\rho\\}}$ and the measurement values. For a smooth mollified indicator, we have:\n813: \n814: $$\n815: \\left\\| \\nabla_{x_i} \\mu \\right\\| \\le \\frac{2\\|d\\|_{\\infty}}{\\rho} + \\|\\nabla d\\|_{\\infty}\n816: \n817: $$\n818: \n819: Since $\\sigma\\'_{\\text{reg}} \\ge \\sigma\\'_{\\min}$ and $|g'_A(Z)| \\le g'_{\\max}$:\n820: \n821: $$\n822: \\|\\nabla_{x_i} V_{\\text{fit}}\\| \\le \\frac{g'_{\\max}}{\\sigma\\'_{\\min}} \\left( \\|\\nabla d\\|_{\\infty} + \\frac{2\\|d\\|_{\\infty}}{\\rho} + \\|\\nabla d\\|_{\\infty} \\right) =: K_1\n823: \n824: $$\n825: \n826: **Step 2: Second derivative.** Taking another derivative:\n827: \n828: $$\n829: \\nabla^2_{x_i} V_{\\text{fit}} = g''_A(Z) (\\nabla_{x_i} Z) \\otimes (\\nabla_{x_i} Z) + g'_A(Z) \\nabla^2_{x_i} Z_{\\text{reg}}\n830: \n831: $$\n832: \n833: **Term 1 (outer product):** Using the bounds from Step 1:\n834: \n835: $$\n836: \\left\\| g''_A(Z) (\\nabla_{x_i} Z) \\otimes (\\nabla_{x_i} Z) \\right\\| \\le g''_{\\max} \\|\\nabla_{x_i} Z\\|^2 \\le \\frac{g''_{\\max} \\cdot 4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}}\n837: \n838: $$\n839: \n840: **Term 2 (Hessian of Z-score):** We need $\\nabla^2_{x_i} Z_{\\text{reg}}$. This involves:\n841: \n842: $$\n843: \\nabla^2_{x_i} Z_{\\text{reg}} = \\frac{1}{\\sigma\\'_{\\text{reg}}} \\nabla^2_{x_i} (d - \\mu) - \\frac{1}{\\sigma'^2_{\\text{patch}}} (\\nabla_{x_i} \\sigma\\'_{\\text{reg}}) \\otimes \\nabla_{x_i}(d - \\mu)\n844: \n845: $$\n846: \n847: The key observation is that **$\\sigma\\'_{\\text{reg}}$ depends on $x_i$ only through the \u03c1-localized statistics**, and by the regularization:\n848: \n849: $$\n850: \\left\\| \\nabla_{x_i} \\sigma\\'_{\\text{reg}} \\right\\| \\le \\frac{\\|\\nabla d\\|_{\\infty}}{\\sigma\\'_{\\min}}\n851: \n852: $$\n853: \n854: The second derivative of the localized mean satisfies:\n855: \n856: $$\n857: \\left\\| \\nabla^2_{x_i} \\mu \\right\\| \\le \\|\\nabla^2 d\\|_{\\infty} + \\frac{4 \\|\\nabla d\\|_{\\infty}}{\\rho^2}\n858: \n859: $$\n860: \n861: Combining:\n862: \n863: $$\n864: \\left\\| \\nabla^2_{x_i} Z_{\\text{reg}} \\right\\| \\le \\frac{\\|\\nabla^2 d\\|_{\\infty} + C_{\\text{patch}}}{\\sigma\\'_{\\min}} + \\frac{4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^3_{\\min,\\text{patch}}}\n865: \n866: $$\n867: \n868: where $C_{\\text{patch}}$ depends on $\\|d\\|_{\\infty}$, $\\|\\nabla d\\|_{\\infty}$, and $\\rho$.\n869: \n870: **Step 3: Combine.** The operator norm of the full Hessian is:\n871: \n872: $$\n873: \\begin{aligned}\n874: \\|H(S)\\| &\\le \\left\\| g''_A (\\nabla Z) \\otimes (\\nabla Z) \\right\\| + \\left\\| g'_A \\nabla^2 Z \\right\\| \\\\\n875: &\\le \\frac{g''_{\\max} \\cdot 4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} + \\frac{g'_{\\max}}{\\sigma\\'_{\\min}} \\left( \\|\\nabla^2 d\\|_{\\infty} + C_{\\text{patch}} + \\frac{4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} \\right)\n876: \\end{aligned}\n877: \n878: $$",
      "metadata": {
        "label": "proof-lem-hessian-bounded-rigorous"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "784: :::\n785: \n786: :::{prf:proof}\n787: :label: proof-lem-hessian-bounded-rigorous\n788: \n789: We provide a complete derivation tracking all terms. Recall:\n790: \n791: $$\n792: V_{\\text{fit}}(x_i) = g_A\\left( Z_{\\text{reg}}(x_i) \\right), \\quad Z_{\\text{reg}}(x_i) = \\frac{d(x_i) - \\mu}{\\sigma\\'_{\\text{reg}}}\n793: \n794: $$\n795: \n796: where $\\sigma\\'_{\\text{reg}} = \\max\\{\\sqrt{\\sigma^2_{\\rho}}, \\sigma\\'_{\\min}\\}$.\n797: \n798: **Step 1: First derivative.** By the chain rule:\n799: \n800: $$\n801: \\nabla_{x_i} V_{\\text{fit}} = g'_A(Z) \\nabla_{x_i} Z_{\\text{reg}}\n802: \n803: $$\n804: \n805: For the Z-score:\n806: \n807: $$\n808: \\nabla_{x_i} Z_{\\text{reg}} = \\frac{1}{\\sigma\\'_{\\text{reg}}} \\left( \\nabla_{x_i} d - \\nabla_{x_i} \\mu \\right)\n809: \n810: $$\n811: \n812: The localized mean $\\mu$ depends on $x_i$ through both the indicator function $\\mathbb{1}_{\\{\\|x_j - x_i\\| \\le \\rho\\}}$ and the measurement values. For a smooth mollified indicator, we have:\n813: \n814: $$\n815: \\left\\| \\nabla_{x_i} \\mu \\right\\| \\le \\frac{2\\|d\\|_{\\infty}}{\\rho} + \\|\\nabla d\\|_{\\infty}\n816: \n817: $$\n818: \n819: Since $\\sigma\\'_{\\text{reg}} \\ge \\sigma\\'_{\\min}$ and $|g'_A(Z)| \\le g'_{\\max}$:\n820: \n821: $$\n822: \\|\\nabla_{x_i} V_{\\text{fit}}\\| \\le \\frac{g'_{\\max}}{\\sigma\\'_{\\min}} \\left( \\|\\nabla d\\|_{\\infty} + \\frac{2\\|d\\|_{\\infty}}{\\rho} + \\|\\nabla d\\|_{\\infty} \\right) =: K_1\n823: \n824: $$\n825: \n826: **Step 2: Second derivative.** Taking another derivative:\n827: \n828: $$\n829: \\nabla^2_{x_i} V_{\\text{fit}} = g''_A(Z) (\\nabla_{x_i} Z) \\otimes (\\nabla_{x_i} Z) + g'_A(Z) \\nabla^2_{x_i} Z_{\\text{reg}}\n830: \n831: $$\n832: \n833: **Term 1 (outer product):** Using the bounds from Step 1:\n834: \n835: $$\n836: \\left\\| g''_A(Z) (\\nabla_{x_i} Z) \\otimes (\\nabla_{x_i} Z) \\right\\| \\le g''_{\\max} \\|\\nabla_{x_i} Z\\|^2 \\le \\frac{g''_{\\max} \\cdot 4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}}\n837: \n838: $$\n839: \n840: **Term 2 (Hessian of Z-score):** We need $\\nabla^2_{x_i} Z_{\\text{reg}}$. This involves:\n841: \n842: $$\n843: \\nabla^2_{x_i} Z_{\\text{reg}} = \\frac{1}{\\sigma\\'_{\\text{reg}}} \\nabla^2_{x_i} (d - \\mu) - \\frac{1}{\\sigma'^2_{\\text{patch}}} (\\nabla_{x_i} \\sigma\\'_{\\text{reg}}) \\otimes \\nabla_{x_i}(d - \\mu)\n844: \n845: $$\n846: \n847: The key observation is that **$\\sigma\\'_{\\text{reg}}$ depends on $x_i$ only through the \u03c1-localized statistics**, and by the regularization:\n848: \n849: $$\n850: \\left\\| \\nabla_{x_i} \\sigma\\'_{\\text{reg}} \\right\\| \\le \\frac{\\|\\nabla d\\|_{\\infty}}{\\sigma\\'_{\\min}}\n851: \n852: $$\n853: \n854: The second derivative of the localized mean satisfies:\n855: \n856: $$\n857: \\left\\| \\nabla^2_{x_i} \\mu \\right\\| \\le \\|\\nabla^2 d\\|_{\\infty} + \\frac{4 \\|\\nabla d\\|_{\\infty}}{\\rho^2}\n858: \n859: $$\n860: \n861: Combining:\n862: \n863: $$\n864: \\left\\| \\nabla^2_{x_i} Z_{\\text{reg}} \\right\\| \\le \\frac{\\|\\nabla^2 d\\|_{\\infty} + C_{\\text{patch}}}{\\sigma\\'_{\\min}} + \\frac{4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^3_{\\min,\\text{patch}}}\n865: \n866: $$\n867: \n868: where $C_{\\text{patch}}$ depends on $\\|d\\|_{\\infty}$, $\\|\\nabla d\\|_{\\infty}$, and $\\rho$.\n869: \n870: **Step 3: Combine.** The operator norm of the full Hessian is:\n871: \n872: $$\n873: \\begin{aligned}\n874: \\|H(S)\\| &\\le \\left\\| g''_A (\\nabla Z) \\otimes (\\nabla Z) \\right\\| + \\left\\| g'_A \\nabla^2 Z \\right\\| \\\\\n875: &\\le \\frac{g''_{\\max} \\cdot 4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} + \\frac{g'_{\\max}}{\\sigma\\'_{\\min}} \\left( \\|\\nabla^2 d\\|_{\\infty} + C_{\\text{patch}} + \\frac{4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} \\right)\n876: \\end{aligned}\n877: \n878: $$\n879: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-hessian-explosion",
      "title": "Failure of Uniformity Without Regularization",
      "start_line": 881,
      "end_line": 892,
      "header_lines": [
        882
      ],
      "content_start": 884,
      "content_end": 891,
      "content": "884: :label: lem-hessian-explosion\n885: \n886: If the regularization $\\epsilon_\\Sigma = 0$ and the swarm variance $\\text{Var}_\\mu[d] \\to 0$, then:\n887: \n888: $$\n889: \\|H(\\mu)\\| \\to \\infty\n890: \n891: $$",
      "metadata": {
        "label": "lem-hessian-explosion"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "881: :::\n882: \n883: :::{prf:lemma} Failure of Uniformity Without Regularization\n884: :label: lem-hessian-explosion\n885: \n886: If the regularization $\\epsilon_\\Sigma = 0$ and the swarm variance $\\text{Var}_\\mu[d] \\to 0$, then:\n887: \n888: $$\n889: \\|H(\\mu)\\| \\to \\infty\n890: \n891: $$\n892: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-hessian-explosion",
      "title": null,
      "start_line": 894,
      "end_line": 921,
      "header_lines": [
        895
      ],
      "content_start": 897,
      "content_end": 920,
      "content": "897: :label: proof-lem-hessian-explosion\n898: \n899: Consider a swarm collapsing to a point where all walkers have nearly identical measurement values: $d(x_i) \\approx d_0$ for all $i$. In this regime:\n900: \n901: $$\n902: \\sigma_{\\text{patch}}^2 = \\mathbb{E}[(d - \\mu)^2] \\to 0\n903: \n904: $$\n905: \n906: **Without regularization** (i.e., if we used $\\sigma_{\\text{patch}}$ instead of $\\sigma\\'_{\\text{reg}} = \\max\\{\\sigma_{\\text{patch}}, \\sigma\\'_{\\min}\\}$), the Z-score becomes:\n907: \n908: $$\n909: Z_{\\text{reg}}(x) = \\frac{d(x) - d_0}{\\sigma_{\\text{patch}}} \\sim \\frac{O(1)}{\\sigma_{\\text{patch}}} \\to \\infty\n910: \n911: $$\n912: \n913: From the proof of Lemma [](#lem-hessian-bounded-rigorous), the Hessian contains terms inversely proportional to powers of $\\sigma_{\\text{patch}}$:\n914: \n915: $$\n916: \\|H\\| \\ge \\frac{C}{\\sigma_{\\text{patch}}^2} \\to \\infty\n917: \n918: $$\n919: \n920: as $\\sigma_{\\text{patch}} \\to 0$. This demonstrates that without the regularization $\\sigma\\'_{\\min} > 0$, the inverse $H^{-1}$ would become ill-defined, and the diffusion tensor $\\Sigma = H^{-1/2}$ would be unbounded.",
      "metadata": {
        "label": "proof-lem-hessian-explosion"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "894: :::\n895: \n896: :::{prf:proof}\n897: :label: proof-lem-hessian-explosion\n898: \n899: Consider a swarm collapsing to a point where all walkers have nearly identical measurement values: $d(x_i) \\approx d_0$ for all $i$. In this regime:\n900: \n901: $$\n902: \\sigma_{\\text{patch}}^2 = \\mathbb{E}[(d - \\mu)^2] \\to 0\n903: \n904: $$\n905: \n906: **Without regularization** (i.e., if we used $\\sigma_{\\text{patch}}$ instead of $\\sigma\\'_{\\text{reg}} = \\max\\{\\sigma_{\\text{patch}}, \\sigma\\'_{\\min}\\}$), the Z-score becomes:\n907: \n908: $$\n909: Z_{\\text{reg}}(x) = \\frac{d(x) - d_0}{\\sigma_{\\text{patch}}} \\sim \\frac{O(1)}{\\sigma_{\\text{patch}}} \\to \\infty\n910: \n911: $$\n912: \n913: From the proof of Lemma [](#lem-hessian-bounded-rigorous), the Hessian contains terms inversely proportional to powers of $\\sigma_{\\text{patch}}$:\n914: \n915: $$\n916: \\|H\\| \\ge \\frac{C}{\\sigma_{\\text{patch}}^2} \\to \\infty\n917: \n918: $$\n919: \n920: as $\\sigma_{\\text{patch}} \\to 0$. This demonstrates that without the regularization $\\sigma\\'_{\\min} > 0$, the inverse $H^{-1}$ would become ill-defined, and the diffusion tensor $\\Sigma = H^{-1/2}$ would be unbounded.\n921: "
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-ueph",
      "title": "Proof of Theorem [](#thm-ueph)",
      "start_line": 923,
      "end_line": 986,
      "header_lines": [
        924
      ],
      "content_start": 926,
      "content_end": 985,
      "content": "926: :label: proof-thm-ueph\n927: \n928: We now prove uniform ellipticity of $G_{\\text{reg}} = (H + \\epsilon_\\Sigma I)^{-1}$.\n929: \n930: **Step 1: Eigenvalue bounds for $H_{\\text{reg}} = H + \\epsilon_\\Sigma I$.**\n931: \n932: The Hessian $H$ is symmetric, so it has real eigenvalues $\\lambda_1(H), \\ldots, \\lambda_d(H)$. Let:\n933: \n934: $$\n935: \\lambda_{\\min}(H) := \\min_{i} \\lambda_i(H), \\quad \\lambda_{\\max}(H) := \\max_{i} \\lambda_i(H)\n936: \n937: $$\n938: \n939: By Lemma [](#lem-hessian-bounded-rigorous), $|\\lambda_i(H)| \\le \\|H\\| \\le H_{\\max}$ for all $i$.\n940: \n941: The eigenvalues of $H_{\\text{reg}} = H + \\epsilon_\\Sigma I$ are:\n942: \n943: $$\n944: \\lambda_i(H_{\\text{reg}}) = \\lambda_i(H) + \\epsilon_\\Sigma\n945: \n946: $$\n947: \n948: Therefore:\n949: \n950: $$\n951: \\lambda_i(H_{\\text{reg}}) \\in [\\lambda_{\\min}(H) + \\epsilon_\\Sigma, \\, \\lambda_{\\max}(H) + \\epsilon_\\Sigma] \\subseteq [\\epsilon_\\Sigma - H_{\\max}, \\, H_{\\max} + \\epsilon_\\Sigma]\n952: \n953: $$\n954: \n955: **Step 2: Critical condition for strict positivity.** For $H_{\\text{reg}}$ to be strictly positive definite for all $S$, we require:\n956: \n957: $$\n958: \\epsilon_\\Sigma - H_{\\max} > 0 \\quad \\Longleftrightarrow \\quad \\epsilon_\\Sigma > H_{\\max}\n959: \n960: $$\n961: \n962: This is the **key design constraint**: the regularization parameter must exceed the uniform bound on the Hessian spectral norm.\n963: \n964: **Step 3: Eigenvalue bounds for $G_{\\text{reg}} = H_{\\text{reg}}^{-1}$.**\n965: \n966: Assuming $\\epsilon_\\Sigma > H_{\\max}$, the eigenvalues of the inverse are:\n967: \n968: $$\n969: \\lambda_i(G_{\\text{reg}}) = \\frac{1}{\\lambda_i(H_{\\text{reg}})} \\in \\left[ \\frac{1}{H_{\\max} + \\epsilon_\\Sigma}, \\, \\frac{1}{\\epsilon_\\Sigma - H_{\\max}} \\right]\n970: \n971: $$\n972: \n973: **Step 4: Define ellipticity constants.** Let:\n974: \n975: $$\n976: c_{\\min} := \\frac{1}{H_{\\max} + \\epsilon_\\Sigma}, \\quad c_{\\max} := \\frac{1}{\\epsilon_\\Sigma - H_{\\max}}\n977: \n978: $$\n979: \n980: Then:\n981: \n982: $$\n983: c_{\\min} I \\preceq G_{\\text{reg}}(S) \\preceq c_{\\max} I\n984: \n985: $$",
      "metadata": {
        "label": "proof-thm-ueph"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "923: :::\n924: \n925: :::{prf:proof} Proof of Theorem [](#thm-ueph)\n926: :label: proof-thm-ueph\n927: \n928: We now prove uniform ellipticity of $G_{\\text{reg}} = (H + \\epsilon_\\Sigma I)^{-1}$.\n929: \n930: **Step 1: Eigenvalue bounds for $H_{\\text{reg}} = H + \\epsilon_\\Sigma I$.**\n931: \n932: The Hessian $H$ is symmetric, so it has real eigenvalues $\\lambda_1(H), \\ldots, \\lambda_d(H)$. Let:\n933: \n934: $$\n935: \\lambda_{\\min}(H) := \\min_{i} \\lambda_i(H), \\quad \\lambda_{\\max}(H) := \\max_{i} \\lambda_i(H)\n936: \n937: $$\n938: \n939: By Lemma [](#lem-hessian-bounded-rigorous), $|\\lambda_i(H)| \\le \\|H\\| \\le H_{\\max}$ for all $i$.\n940: \n941: The eigenvalues of $H_{\\text{reg}} = H + \\epsilon_\\Sigma I$ are:\n942: \n943: $$\n944: \\lambda_i(H_{\\text{reg}}) = \\lambda_i(H) + \\epsilon_\\Sigma\n945: \n946: $$\n947: \n948: Therefore:\n949: \n950: $$\n951: \\lambda_i(H_{\\text{reg}}) \\in [\\lambda_{\\min}(H) + \\epsilon_\\Sigma, \\, \\lambda_{\\max}(H) + \\epsilon_\\Sigma] \\subseteq [\\epsilon_\\Sigma - H_{\\max}, \\, H_{\\max} + \\epsilon_\\Sigma]\n952: \n953: $$\n954: \n955: **Step 2: Critical condition for strict positivity.** For $H_{\\text{reg}}$ to be strictly positive definite for all $S$, we require:\n956: \n957: $$\n958: \\epsilon_\\Sigma - H_{\\max} > 0 \\quad \\Longleftrightarrow \\quad \\epsilon_\\Sigma > H_{\\max}\n959: \n960: $$\n961: \n962: This is the **key design constraint**: the regularization parameter must exceed the uniform bound on the Hessian spectral norm.\n963: \n964: **Step 3: Eigenvalue bounds for $G_{\\text{reg}} = H_{\\text{reg}}^{-1}$.**\n965: \n966: Assuming $\\epsilon_\\Sigma > H_{\\max}$, the eigenvalues of the inverse are:\n967: \n968: $$\n969: \\lambda_i(G_{\\text{reg}}) = \\frac{1}{\\lambda_i(H_{\\text{reg}})} \\in \\left[ \\frac{1}{H_{\\max} + \\epsilon_\\Sigma}, \\, \\frac{1}{\\epsilon_\\Sigma - H_{\\max}} \\right]\n970: \n971: $$\n972: \n973: **Step 4: Define ellipticity constants.** Let:\n974: \n975: $$\n976: c_{\\min} := \\frac{1}{H_{\\max} + \\epsilon_\\Sigma}, \\quad c_{\\max} := \\frac{1}{\\epsilon_\\Sigma - H_{\\max}}\n977: \n978: $$\n979: \n980: Then:\n981: \n982: $$\n983: c_{\\min} I \\preceq G_{\\text{reg}}(S) \\preceq c_{\\max} I\n984: \n985: $$\n986: "
    },
    {
      "directive_type": "corollary",
      "label": "cor-wellposed",
      "title": "Existence and Uniqueness of Solutions",
      "start_line": 1005,
      "end_line": 1009,
      "header_lines": [
        1006
      ],
      "content_start": 1008,
      "content_end": 1008,
      "content": "1008: :label: cor-wellposed",
      "metadata": {
        "label": "cor-wellposed"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "1005: ### 4.3. Corollary: Well-Posedness of the Hybrid SDE\n1006: \n1007: :::{prf:corollary} Existence and Uniqueness of Solutions\n1008: :label: cor-wellposed\n1009: "
    },
    {
      "directive_type": "proof",
      "label": "proof-cor-wellposed",
      "title": null,
      "start_line": 1011,
      "end_line": 1070,
      "header_lines": [
        1012
      ],
      "content_start": 1014,
      "content_end": 1069,
      "content": "1014: :label: proof-cor-wellposed\n1015: \n1016: **Key Challenge:** The coefficients $\\mathbf{F}_{\\text{adapt}}(x_i, S)$, $\\mathbf{F}_{\\text{viscous}}(x_i, S)$, and $\\Sigma_{\\text{reg}}(x_i, S)$ depend on the **full swarm state** $S = (x_1, v_1, \\ldots, x_N, v_N)$, not just on the individual particle $(x_i, v_i)$. This makes our SDE a **McKean-Vlasov-type system** with particle interactions, requiring more careful analysis than standard SDEs.\n1017: \n1018: **Step 1: Lipschitz Continuity in the Product Topology.**\n1019: \n1020: We need to show that the drift and diffusion coefficients are Lipschitz continuous in the full state $S$ with respect to an appropriate metric on the product space $\\Sigma_N = (\\mathcal{X} \\times \\mathbb{R}^d)^N$.\n1021: \n1022: Define the product metric:\n1023: \n1024: $$\n1025: d_{\\Sigma_N}(S, S') := \\max_{i=1,\\ldots,N} \\left( \\|x_i - x'_i\\| + \\|v_i - v'_i\\| \\right)\n1026: \n1027: $$\n1028: \n1029: **Adaptive Force:** By Theorem {prf:ref}`thm-c1-regularity` (Appendix A), the fitness potential satisfies:\n1030: \n1031: $$\n1032: \\|\\nabla V_{\\text{fit}}[f_k, \\rho](x_i)\\| \\le F_{\\text{adapt,max}}(\\rho)\n1033: \n1034: $$\n1035: \n1036: Moreover, the proof in Appendix A establishes that $\\nabla V_{\\text{fit}}$ depends on $S$ through the localized moments $\\mu_\\rho$ and $\\sigma'_\\rho$, which are **continuous functions** of the alive walker positions $\\{x_j : j \\in A_k\\}$ (via the localization weights $w_{ij}(\\rho)$). Since these moments are weighted averages with smooth weights, they are Lipschitz in $S$:\n1037: \n1038: $$\n1039: \\|\\nabla V_{\\text{fit}}[f_k, \\rho](x_i, S) - \\nabla V_{\\text{fit}}[f_k, \\rho](x_i, S')\\| \\le L_{\\text{fit}}(\\rho) \\cdot d_{\\Sigma_N}(S, S')\n1040: \n1041: $$\n1042: \n1043: for some constant $L_{\\text{fit}}(\\rho)$ depending on the derivatives of the kernel $K_\\rho$ and the measurement function.\n1044: \n1045: **Viscous Force:** The viscous force is:\n1046: \n1047: $$\n1048: \\mathbf{F}_{\\text{viscous}}(x_i, S) = \\nu \\sum_{j \\ne i} \\frac{K(\\|x_i - x_j\\|)}{\\sum_{k \\ne i} K(\\|x_i - x_k\\|)} (v_j - v_i)\n1049: \n1050: $$\n1051: \n1052: where $K$ is a bounded, smooth kernel. The normalized weights $a_{ij} = K(\\|x_i - x_j\\|)/\\deg(i)$ are Lipschitz in $(x_i, v_i)$ and in the other particles' positions $(x_j)$, with Lipschitz constant depending on $\\nu$, the derivatives of $K$, and the lower bound $\\kappa := \\inf_i \\deg(i) > 0$ (which follows from kernel positivity and spatial confinement).\n1053: \n1054: **Diffusion Tensor:** By Theorem {prf:ref}`thm-c2-regularity` (Appendix A), the Hessian $H_i(S) = \\nabla^2 V_{\\text{fit}}[f_k, \\rho](x_i)$ satisfies:\n1055: \n1056: $$\n1057: \\|H_i(S)\\| \\le H_{\\max}(\\rho)\n1058: \n1059: $$\n1060: \n1061: and the proof establishes that $H_i(S)$ is a continuous (in fact, differentiable) function of $S$. Therefore, $\\Sigma_{\\text{reg}}(x_i, S) = (H_i(S) + \\epsilon_\\Sigma I)^{-1/2}$ is Lipschitz in $S$ by the implicit function theorem (the map $M \\mapsto (M + \\epsilon_\\Sigma I)^{-1/2}$ is smooth for $M$ bounded).\n1062: \n1063: **Step 2: Application of McKean-Vlasov Existence Theory.**\n1064: \n1065: With Lipschitz continuity established, we can apply existence and uniqueness theorems for McKean-Vlasov SDEs (e.g., Sznitman, \"Topics in propagation of chaos,\" 1991, or Carmona-Delarue, \"Probabilistic Theory of Mean Field Games,\" 2018, Theorem 5.20).\n1066: \n1067: These theorems guarantee that for Lipschitz drift and diffusion coefficients with linear growth, there exists a unique strong solution to the interacting particle system.\n1068: \n1069: **Step 3: Global Existence.**",
      "metadata": {
        "label": "proof-cor-wellposed"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "raw_directive": "1011: :::\n1012: \n1013: :::{prf:proof}\n1014: :label: proof-cor-wellposed\n1015: \n1016: **Key Challenge:** The coefficients $\\mathbf{F}_{\\text{adapt}}(x_i, S)$, $\\mathbf{F}_{\\text{viscous}}(x_i, S)$, and $\\Sigma_{\\text{reg}}(x_i, S)$ depend on the **full swarm state** $S = (x_1, v_1, \\ldots, x_N, v_N)$, not just on the individual particle $(x_i, v_i)$. This makes our SDE a **McKean-Vlasov-type system** with particle interactions, requiring more careful analysis than standard SDEs.\n1017: \n1018: **Step 1: Lipschitz Continuity in the Product Topology.**\n1019: \n1020: We need to show that the drift and diffusion coefficients are Lipschitz continuous in the full state $S$ with respect to an appropriate metric on the product space $\\Sigma_N = (\\mathcal{X} \\times \\mathbb{R}^d)^N$.\n1021: \n1022: Define the product metric:\n1023: \n1024: $$\n1025: d_{\\Sigma_N}(S, S') := \\max_{i=1,\\ldots,N} \\left( \\|x_i - x'_i\\| + \\|v_i - v'_i\\| \\right)\n1026: \n1027: $$\n1028: \n1029: **Adaptive Force:** By Theorem {prf:ref}`thm-c1-regularity` (Appendix A), the fitness potential satisfies:\n1030: \n1031: $$\n1032: \\|\\nabla V_{\\text{fit}}[f_k, \\rho](x_i)\\| \\le F_{\\text{adapt,max}}(\\rho)\n1033: \n1034: $$\n1035: \n1036: Moreover, the proof in Appendix A establishes that $\\nabla V_{\\text{fit}}$ depends on $S$ through the localized moments $\\mu_\\rho$ and $\\sigma'_\\rho$, which are **continuous functions** of the alive walker positions $\\{x_j : j \\in A_k\\}$ (via the localization weights $w_{ij}(\\rho)$). Since these moments are weighted averages with smooth weights, they are Lipschitz in $S$:\n1037: \n1038: $$\n1039: \\|\\nabla V_{\\text{fit}}[f_k, \\rho](x_i, S) - \\nabla V_{\\text{fit}}[f_k, \\rho](x_i, S')\\| \\le L_{\\text{fit}}(\\rho) \\cdot d_{\\Sigma_N}(S, S')\n1040: \n1041: $$\n1042: \n1043: for some constant $L_{\\text{fit}}(\\rho)$ depending on the derivatives of the kernel $K_\\rho$ and the measurement function.\n1044: \n1045: **Viscous Force:** The viscous force is:\n1046: \n1047: $$\n1048: \\mathbf{F}_{\\text{viscous}}(x_i, S) = \\nu \\sum_{j \\ne i} \\frac{K(\\|x_i - x_j\\|)}{\\sum_{k \\ne i} K(\\|x_i - x_k\\|)} (v_j - v_i)\n1049: \n1050: $$\n1051: \n1052: where $K$ is a bounded, smooth kernel. The normalized weights $a_{ij} = K(\\|x_i - x_j\\|)/\\deg(i)$ are Lipschitz in $(x_i, v_i)$ and in the other particles' positions $(x_j)$, with Lipschitz constant depending on $\\nu$, the derivatives of $K$, and the lower bound $\\kappa := \\inf_i \\deg(i) > 0$ (which follows from kernel positivity and spatial confinement).\n1053: \n1054: **Diffusion Tensor:** By Theorem {prf:ref}`thm-c2-regularity` (Appendix A), the Hessian $H_i(S) = \\nabla^2 V_{\\text{fit}}[f_k, \\rho](x_i)$ satisfies:\n1055: \n1056: $$\n1057: \\|H_i(S)\\| \\le H_{\\max}(\\rho)\n1058: \n1059: $$\n1060: \n1061: and the proof establishes that $H_i(S)$ is a continuous (in fact, differentiable) function of $S$. Therefore, $\\Sigma_{\\text{reg}}(x_i, S) = (H_i(S) + \\epsilon_\\Sigma I)^{-1/2}$ is Lipschitz in $S$ by the implicit function theorem (the map $M \\mapsto (M + \\epsilon_\\Sigma I)^{-1/2}$ is smooth for $M$ bounded).\n1062: \n1063: **Step 2: Application of McKean-Vlasov Existence Theory.**\n1064: \n1065: With Lipschitz continuity established, we can apply existence and uniqueness theorems for McKean-Vlasov SDEs (e.g., Sznitman, \"Topics in propagation of chaos,\" 1991, or Carmona-Delarue, \"Probabilistic Theory of Mean Field Games,\" 2018, Theorem 5.20).\n1066: \n1067: These theorems guarantee that for Lipschitz drift and diffusion coefficients with linear growth, there exists a unique strong solution to the interacting particle system.\n1068: \n1069: **Step 3: Global Existence.**\n1070: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}