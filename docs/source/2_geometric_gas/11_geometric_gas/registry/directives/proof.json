{
  "document_id": "11_geometric_gas",
  "stage": "directives",
  "directive_type": "proof",
  "generated_at": "2025-11-08T23:19:38.281181+00:00",
  "count": 15,
  "items": [
    {
      "directive_type": "proof",
      "label": "proof-lem-hessian-bounded",
      "title": null,
      "start_line": 713,
      "end_line": 766,
      "header_lines": [
        714
      ],
      "content_start": 716,
      "content_end": 765,
      "content": "716: :label: proof-lem-hessian-bounded\n717: \n718: The fitness potential is constructed as:\n719: \n720: $$\n721: V_{\\text{fit}}(x) = g_A(Z_{\\text{reg}}(x))\n722: \n723: $$\n724: \n725: where $g_A: \\mathbb{R} \\to [0, A]$ is smooth and bounded, and:\n726: \n727: $$\n728: Z_{\\text{reg}}(x) = \\frac{d(x) - \\mu}{\\sigma\\'_{\\text{reg}}}\n729: \n730: $$\n731: \n732: with $\\sigma\\'_{\\text{reg}} \\ge \\sigma\\'_{\\min} > 0$ by construction.\n733: \n734: **Step 1: Gradient bounds.** By the chain rule:\n735: \n736: $$\n737: \\nabla V_{\\text{fit}}(x) = g'_A(Z) \\cdot \\nabla Z_{\\text{reg}}(x)\n738: \n739: $$\n740: \n741: Since $g_A$ is bounded and smooth, $|g'_A(Z)| \\le g'_{\\max}$ for all $Z$. The gradient of the Z-score involves derivatives of $d(x)$ and the ρ-localized statistics, all of which are bounded by the pipeline construction (bounded measurement function, finite patch radius). Thus:\n742: \n743: $$\n744: \\|\\nabla V_{\\text{fit}}(x)\\| \\le K_1 < \\infty\n745: \n746: $$\n747: \n748: **Step 2: Hessian bounds.** Taking another derivative:\n749: \n750: $$\n751: H(x) = \\nabla^2 V_{\\text{fit}}(x) = g''_A(Z) \\cdot (\\nabla Z) \\otimes (\\nabla Z) + g'_A(Z) \\cdot \\nabla^2 Z\n752: \n753: $$\n754: \n755: Both terms are bounded:\n756: - $|g''_A(Z)| \\le g''_{\\max}$ by smoothness of $g_A$.\n757: - $\\|\\nabla Z\\|^2 \\le K_1^2 / (g'_{\\max})^2$ from Step 1.\n758: - $\\|\\nabla^2 Z\\|$ is bounded by the twice-differentiability of $d$ and the regularization $\\sigma\\'_{\\min}$ in the denominator.\n759: \n760: Therefore:\n761: \n762: $$\n763: \\|H(S)\\| \\le H_{\\max} := g''_{\\max} K_1^2 / (g'_{\\max})^2 + g'_{\\max} K_2\n764: \n765: $$",
      "metadata": {
        "label": "proof-lem-hessian-bounded"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "references": [],
      "raw_directive": "713: :::\n714: \n715: :::{prf:proof}\n716: :label: proof-lem-hessian-bounded\n717: \n718: The fitness potential is constructed as:\n719: \n720: $$\n721: V_{\\text{fit}}(x) = g_A(Z_{\\text{reg}}(x))\n722: \n723: $$\n724: \n725: where $g_A: \\mathbb{R} \\to [0, A]$ is smooth and bounded, and:\n726: \n727: $$\n728: Z_{\\text{reg}}(x) = \\frac{d(x) - \\mu}{\\sigma\\'_{\\text{reg}}}\n729: \n730: $$\n731: \n732: with $\\sigma\\'_{\\text{reg}} \\ge \\sigma\\'_{\\min} > 0$ by construction.\n733: \n734: **Step 1: Gradient bounds.** By the chain rule:\n735: \n736: $$\n737: \\nabla V_{\\text{fit}}(x) = g'_A(Z) \\cdot \\nabla Z_{\\text{reg}}(x)\n738: \n739: $$\n740: \n741: Since $g_A$ is bounded and smooth, $|g'_A(Z)| \\le g'_{\\max}$ for all $Z$. The gradient of the Z-score involves derivatives of $d(x)$ and the ρ-localized statistics, all of which are bounded by the pipeline construction (bounded measurement function, finite patch radius). Thus:\n742: \n743: $$\n744: \\|\\nabla V_{\\text{fit}}(x)\\| \\le K_1 < \\infty\n745: \n746: $$\n747: \n748: **Step 2: Hessian bounds.** Taking another derivative:\n749: \n750: $$\n751: H(x) = \\nabla^2 V_{\\text{fit}}(x) = g''_A(Z) \\cdot (\\nabla Z) \\otimes (\\nabla Z) + g'_A(Z) \\cdot \\nabla^2 Z\n752: \n753: $$\n754: \n755: Both terms are bounded:\n756: - $|g''_A(Z)| \\le g''_{\\max}$ by smoothness of $g_A$.\n757: - $\\|\\nabla Z\\|^2 \\le K_1^2 / (g'_{\\max})^2$ from Step 1.\n758: - $\\|\\nabla^2 Z\\|$ is bounded by the twice-differentiability of $d$ and the regularization $\\sigma\\'_{\\min}$ in the denominator.\n759: \n760: Therefore:\n761: \n762: $$\n763: \\|H(S)\\| \\le H_{\\max} := g''_{\\max} K_1^2 / (g'_{\\max})^2 + g'_{\\max} K_2\n764: \n765: $$\n766: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Uniform Ellipticity and Well-Posedness"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-hessian-bounded-rigorous",
      "title": null,
      "start_line": 784,
      "end_line": 879,
      "header_lines": [
        785
      ],
      "content_start": 787,
      "content_end": 878,
      "content": "787: :label: proof-lem-hessian-bounded-rigorous\n788: \n789: We provide a complete derivation tracking all terms. Recall:\n790: \n791: $$\n792: V_{\\text{fit}}(x_i) = g_A\\left( Z_{\\text{reg}}(x_i) \\right), \\quad Z_{\\text{reg}}(x_i) = \\frac{d(x_i) - \\mu}{\\sigma\\'_{\\text{reg}}}\n793: \n794: $$\n795: \n796: where $\\sigma\\'_{\\text{reg}} = \\max\\{\\sqrt{\\sigma^2_{\\rho}}, \\sigma\\'_{\\min}\\}$.\n797: \n798: **Step 1: First derivative.** By the chain rule:\n799: \n800: $$\n801: \\nabla_{x_i} V_{\\text{fit}} = g'_A(Z) \\nabla_{x_i} Z_{\\text{reg}}\n802: \n803: $$\n804: \n805: For the Z-score:\n806: \n807: $$\n808: \\nabla_{x_i} Z_{\\text{reg}} = \\frac{1}{\\sigma\\'_{\\text{reg}}} \\left( \\nabla_{x_i} d - \\nabla_{x_i} \\mu \\right)\n809: \n810: $$\n811: \n812: The localized mean $\\mu$ depends on $x_i$ through both the indicator function $\\mathbb{1}_{\\{\\|x_j - x_i\\| \\le \\rho\\}}$ and the measurement values. For a smooth mollified indicator, we have:\n813: \n814: $$\n815: \\left\\| \\nabla_{x_i} \\mu \\right\\| \\le \\frac{2\\|d\\|_{\\infty}}{\\rho} + \\|\\nabla d\\|_{\\infty}\n816: \n817: $$\n818: \n819: Since $\\sigma\\'_{\\text{reg}} \\ge \\sigma\\'_{\\min}$ and $|g'_A(Z)| \\le g'_{\\max}$:\n820: \n821: $$\n822: \\|\\nabla_{x_i} V_{\\text{fit}}\\| \\le \\frac{g'_{\\max}}{\\sigma\\'_{\\min}} \\left( \\|\\nabla d\\|_{\\infty} + \\frac{2\\|d\\|_{\\infty}}{\\rho} + \\|\\nabla d\\|_{\\infty} \\right) =: K_1\n823: \n824: $$\n825: \n826: **Step 2: Second derivative.** Taking another derivative:\n827: \n828: $$\n829: \\nabla^2_{x_i} V_{\\text{fit}} = g''_A(Z) (\\nabla_{x_i} Z) \\otimes (\\nabla_{x_i} Z) + g'_A(Z) \\nabla^2_{x_i} Z_{\\text{reg}}\n830: \n831: $$\n832: \n833: **Term 1 (outer product):** Using the bounds from Step 1:\n834: \n835: $$\n836: \\left\\| g''_A(Z) (\\nabla_{x_i} Z) \\otimes (\\nabla_{x_i} Z) \\right\\| \\le g''_{\\max} \\|\\nabla_{x_i} Z\\|^2 \\le \\frac{g''_{\\max} \\cdot 4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}}\n837: \n838: $$\n839: \n840: **Term 2 (Hessian of Z-score):** We need $\\nabla^2_{x_i} Z_{\\text{reg}}$. This involves:\n841: \n842: $$\n843: \\nabla^2_{x_i} Z_{\\text{reg}} = \\frac{1}{\\sigma\\'_{\\text{reg}}} \\nabla^2_{x_i} (d - \\mu) - \\frac{1}{\\sigma'^2_{\\text{patch}}} (\\nabla_{x_i} \\sigma\\'_{\\text{reg}}) \\otimes \\nabla_{x_i}(d - \\mu)\n844: \n845: $$\n846: \n847: The key observation is that **$\\sigma\\'_{\\text{reg}}$ depends on $x_i$ only through the ρ-localized statistics**, and by the regularization:\n848: \n849: $$\n850: \\left\\| \\nabla_{x_i} \\sigma\\'_{\\text{reg}} \\right\\| \\le \\frac{\\|\\nabla d\\|_{\\infty}}{\\sigma\\'_{\\min}}\n851: \n852: $$\n853: \n854: The second derivative of the localized mean satisfies:\n855: \n856: $$\n857: \\left\\| \\nabla^2_{x_i} \\mu \\right\\| \\le \\|\\nabla^2 d\\|_{\\infty} + \\frac{4 \\|\\nabla d\\|_{\\infty}}{\\rho^2}\n858: \n859: $$\n860: \n861: Combining:\n862: \n863: $$\n864: \\left\\| \\nabla^2_{x_i} Z_{\\text{reg}} \\right\\| \\le \\frac{\\|\\nabla^2 d\\|_{\\infty} + C_{\\text{patch}}}{\\sigma\\'_{\\min}} + \\frac{4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^3_{\\min,\\text{patch}}}\n865: \n866: $$\n867: \n868: where $C_{\\text{patch}}$ depends on $\\|d\\|_{\\infty}$, $\\|\\nabla d\\|_{\\infty}$, and $\\rho$.\n869: \n870: **Step 3: Combine.** The operator norm of the full Hessian is:\n871: \n872: $$\n873: \\begin{aligned}\n874: \\|H(S)\\| &\\le \\left\\| g''_A (\\nabla Z) \\otimes (\\nabla Z) \\right\\| + \\left\\| g'_A \\nabla^2 Z \\right\\| \\\\\n875: &\\le \\frac{g''_{\\max} \\cdot 4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} + \\frac{g'_{\\max}}{\\sigma\\'_{\\min}} \\left( \\|\\nabla^2 d\\|_{\\infty} + C_{\\text{patch}} + \\frac{4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} \\right)\n876: \\end{aligned}\n877: \n878: $$",
      "metadata": {
        "label": "proof-lem-hessian-bounded-rigorous"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "references": [],
      "raw_directive": "784: :::\n785: \n786: :::{prf:proof}\n787: :label: proof-lem-hessian-bounded-rigorous\n788: \n789: We provide a complete derivation tracking all terms. Recall:\n790: \n791: $$\n792: V_{\\text{fit}}(x_i) = g_A\\left( Z_{\\text{reg}}(x_i) \\right), \\quad Z_{\\text{reg}}(x_i) = \\frac{d(x_i) - \\mu}{\\sigma\\'_{\\text{reg}}}\n793: \n794: $$\n795: \n796: where $\\sigma\\'_{\\text{reg}} = \\max\\{\\sqrt{\\sigma^2_{\\rho}}, \\sigma\\'_{\\min}\\}$.\n797: \n798: **Step 1: First derivative.** By the chain rule:\n799: \n800: $$\n801: \\nabla_{x_i} V_{\\text{fit}} = g'_A(Z) \\nabla_{x_i} Z_{\\text{reg}}\n802: \n803: $$\n804: \n805: For the Z-score:\n806: \n807: $$\n808: \\nabla_{x_i} Z_{\\text{reg}} = \\frac{1}{\\sigma\\'_{\\text{reg}}} \\left( \\nabla_{x_i} d - \\nabla_{x_i} \\mu \\right)\n809: \n810: $$\n811: \n812: The localized mean $\\mu$ depends on $x_i$ through both the indicator function $\\mathbb{1}_{\\{\\|x_j - x_i\\| \\le \\rho\\}}$ and the measurement values. For a smooth mollified indicator, we have:\n813: \n814: $$\n815: \\left\\| \\nabla_{x_i} \\mu \\right\\| \\le \\frac{2\\|d\\|_{\\infty}}{\\rho} + \\|\\nabla d\\|_{\\infty}\n816: \n817: $$\n818: \n819: Since $\\sigma\\'_{\\text{reg}} \\ge \\sigma\\'_{\\min}$ and $|g'_A(Z)| \\le g'_{\\max}$:\n820: \n821: $$\n822: \\|\\nabla_{x_i} V_{\\text{fit}}\\| \\le \\frac{g'_{\\max}}{\\sigma\\'_{\\min}} \\left( \\|\\nabla d\\|_{\\infty} + \\frac{2\\|d\\|_{\\infty}}{\\rho} + \\|\\nabla d\\|_{\\infty} \\right) =: K_1\n823: \n824: $$\n825: \n826: **Step 2: Second derivative.** Taking another derivative:\n827: \n828: $$\n829: \\nabla^2_{x_i} V_{\\text{fit}} = g''_A(Z) (\\nabla_{x_i} Z) \\otimes (\\nabla_{x_i} Z) + g'_A(Z) \\nabla^2_{x_i} Z_{\\text{reg}}\n830: \n831: $$\n832: \n833: **Term 1 (outer product):** Using the bounds from Step 1:\n834: \n835: $$\n836: \\left\\| g''_A(Z) (\\nabla_{x_i} Z) \\otimes (\\nabla_{x_i} Z) \\right\\| \\le g''_{\\max} \\|\\nabla_{x_i} Z\\|^2 \\le \\frac{g''_{\\max} \\cdot 4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}}\n837: \n838: $$\n839: \n840: **Term 2 (Hessian of Z-score):** We need $\\nabla^2_{x_i} Z_{\\text{reg}}$. This involves:\n841: \n842: $$\n843: \\nabla^2_{x_i} Z_{\\text{reg}} = \\frac{1}{\\sigma\\'_{\\text{reg}}} \\nabla^2_{x_i} (d - \\mu) - \\frac{1}{\\sigma'^2_{\\text{patch}}} (\\nabla_{x_i} \\sigma\\'_{\\text{reg}}) \\otimes \\nabla_{x_i}(d - \\mu)\n844: \n845: $$\n846: \n847: The key observation is that **$\\sigma\\'_{\\text{reg}}$ depends on $x_i$ only through the ρ-localized statistics**, and by the regularization:\n848: \n849: $$\n850: \\left\\| \\nabla_{x_i} \\sigma\\'_{\\text{reg}} \\right\\| \\le \\frac{\\|\\nabla d\\|_{\\infty}}{\\sigma\\'_{\\min}}\n851: \n852: $$\n853: \n854: The second derivative of the localized mean satisfies:\n855: \n856: $$\n857: \\left\\| \\nabla^2_{x_i} \\mu \\right\\| \\le \\|\\nabla^2 d\\|_{\\infty} + \\frac{4 \\|\\nabla d\\|_{\\infty}}{\\rho^2}\n858: \n859: $$\n860: \n861: Combining:\n862: \n863: $$\n864: \\left\\| \\nabla^2_{x_i} Z_{\\text{reg}} \\right\\| \\le \\frac{\\|\\nabla^2 d\\|_{\\infty} + C_{\\text{patch}}}{\\sigma\\'_{\\min}} + \\frac{4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^3_{\\min,\\text{patch}}}\n865: \n866: $$\n867: \n868: where $C_{\\text{patch}}$ depends on $\\|d\\|_{\\infty}$, $\\|\\nabla d\\|_{\\infty}$, and $\\rho$.\n869: \n870: **Step 3: Combine.** The operator norm of the full Hessian is:\n871: \n872: $$\n873: \\begin{aligned}\n874: \\|H(S)\\| &\\le \\left\\| g''_A (\\nabla Z) \\otimes (\\nabla Z) \\right\\| + \\left\\| g'_A \\nabla^2 Z \\right\\| \\\\\n875: &\\le \\frac{g''_{\\max} \\cdot 4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} + \\frac{g'_{\\max}}{\\sigma\\'_{\\min}} \\left( \\|\\nabla^2 d\\|_{\\infty} + C_{\\text{patch}} + \\frac{4 \\|\\nabla d\\|^2_{\\infty}}{\\sigma'^2_{\\min,\\text{patch}}} \\right)\n876: \\end{aligned}\n877: \n878: $$\n879: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Uniform Ellipticity and Well-Posedness"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-hessian-explosion",
      "title": null,
      "start_line": 894,
      "end_line": 921,
      "header_lines": [
        895
      ],
      "content_start": 897,
      "content_end": 920,
      "content": "897: :label: proof-lem-hessian-explosion\n898: \n899: Consider a swarm collapsing to a point where all walkers have nearly identical measurement values: $d(x_i) \\approx d_0$ for all $i$. In this regime:\n900: \n901: $$\n902: \\sigma_{\\text{patch}}^2 = \\mathbb{E}[(d - \\mu)^2] \\to 0\n903: \n904: $$\n905: \n906: **Without regularization** (i.e., if we used $\\sigma_{\\text{patch}}$ instead of $\\sigma\\'_{\\text{reg}} = \\max\\{\\sigma_{\\text{patch}}, \\sigma\\'_{\\min}\\}$), the Z-score becomes:\n907: \n908: $$\n909: Z_{\\text{reg}}(x) = \\frac{d(x) - d_0}{\\sigma_{\\text{patch}}} \\sim \\frac{O(1)}{\\sigma_{\\text{patch}}} \\to \\infty\n910: \n911: $$\n912: \n913: From the proof of Lemma [](#lem-hessian-bounded-rigorous), the Hessian contains terms inversely proportional to powers of $\\sigma_{\\text{patch}}$:\n914: \n915: $$\n916: \\|H\\| \\ge \\frac{C}{\\sigma_{\\text{patch}}^2} \\to \\infty\n917: \n918: $$\n919: \n920: as $\\sigma_{\\text{patch}} \\to 0$. This demonstrates that without the regularization $\\sigma\\'_{\\min} > 0$, the inverse $H^{-1}$ would become ill-defined, and the diffusion tensor $\\Sigma = H^{-1/2}$ would be unbounded.",
      "metadata": {
        "label": "proof-lem-hessian-explosion"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "references": [],
      "raw_directive": "894: :::\n895: \n896: :::{prf:proof}\n897: :label: proof-lem-hessian-explosion\n898: \n899: Consider a swarm collapsing to a point where all walkers have nearly identical measurement values: $d(x_i) \\approx d_0$ for all $i$. In this regime:\n900: \n901: $$\n902: \\sigma_{\\text{patch}}^2 = \\mathbb{E}[(d - \\mu)^2] \\to 0\n903: \n904: $$\n905: \n906: **Without regularization** (i.e., if we used $\\sigma_{\\text{patch}}$ instead of $\\sigma\\'_{\\text{reg}} = \\max\\{\\sigma_{\\text{patch}}, \\sigma\\'_{\\min}\\}$), the Z-score becomes:\n907: \n908: $$\n909: Z_{\\text{reg}}(x) = \\frac{d(x) - d_0}{\\sigma_{\\text{patch}}} \\sim \\frac{O(1)}{\\sigma_{\\text{patch}}} \\to \\infty\n910: \n911: $$\n912: \n913: From the proof of Lemma [](#lem-hessian-bounded-rigorous), the Hessian contains terms inversely proportional to powers of $\\sigma_{\\text{patch}}$:\n914: \n915: $$\n916: \\|H\\| \\ge \\frac{C}{\\sigma_{\\text{patch}}^2} \\to \\infty\n917: \n918: $$\n919: \n920: as $\\sigma_{\\text{patch}} \\to 0$. This demonstrates that without the regularization $\\sigma\\'_{\\min} > 0$, the inverse $H^{-1}$ would become ill-defined, and the diffusion tensor $\\Sigma = H^{-1/2}$ would be unbounded.\n921: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Uniform Ellipticity and Well-Posedness"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-ueph",
      "title": "Proof of Theorem [](#thm-ueph)",
      "start_line": 923,
      "end_line": 986,
      "header_lines": [
        924
      ],
      "content_start": 926,
      "content_end": 985,
      "content": "926: :label: proof-thm-ueph\n927: \n928: We now prove uniform ellipticity of $G_{\\text{reg}} = (H + \\epsilon_\\Sigma I)^{-1}$.\n929: \n930: **Step 1: Eigenvalue bounds for $H_{\\text{reg}} = H + \\epsilon_\\Sigma I$.**\n931: \n932: The Hessian $H$ is symmetric, so it has real eigenvalues $\\lambda_1(H), \\ldots, \\lambda_d(H)$. Let:\n933: \n934: $$\n935: \\lambda_{\\min}(H) := \\min_{i} \\lambda_i(H), \\quad \\lambda_{\\max}(H) := \\max_{i} \\lambda_i(H)\n936: \n937: $$\n938: \n939: By Lemma [](#lem-hessian-bounded-rigorous), $|\\lambda_i(H)| \\le \\|H\\| \\le H_{\\max}$ for all $i$.\n940: \n941: The eigenvalues of $H_{\\text{reg}} = H + \\epsilon_\\Sigma I$ are:\n942: \n943: $$\n944: \\lambda_i(H_{\\text{reg}}) = \\lambda_i(H) + \\epsilon_\\Sigma\n945: \n946: $$\n947: \n948: Therefore:\n949: \n950: $$\n951: \\lambda_i(H_{\\text{reg}}) \\in [\\lambda_{\\min}(H) + \\epsilon_\\Sigma, \\, \\lambda_{\\max}(H) + \\epsilon_\\Sigma] \\subseteq [\\epsilon_\\Sigma - H_{\\max}, \\, H_{\\max} + \\epsilon_\\Sigma]\n952: \n953: $$\n954: \n955: **Step 2: Critical condition for strict positivity.** For $H_{\\text{reg}}$ to be strictly positive definite for all $S$, we require:\n956: \n957: $$\n958: \\epsilon_\\Sigma - H_{\\max} > 0 \\quad \\Longleftrightarrow \\quad \\epsilon_\\Sigma > H_{\\max}\n959: \n960: $$\n961: \n962: This is the **key design constraint**: the regularization parameter must exceed the uniform bound on the Hessian spectral norm.\n963: \n964: **Step 3: Eigenvalue bounds for $G_{\\text{reg}} = H_{\\text{reg}}^{-1}$.**\n965: \n966: Assuming $\\epsilon_\\Sigma > H_{\\max}$, the eigenvalues of the inverse are:\n967: \n968: $$\n969: \\lambda_i(G_{\\text{reg}}) = \\frac{1}{\\lambda_i(H_{\\text{reg}})} \\in \\left[ \\frac{1}{H_{\\max} + \\epsilon_\\Sigma}, \\, \\frac{1}{\\epsilon_\\Sigma - H_{\\max}} \\right]\n970: \n971: $$\n972: \n973: **Step 4: Define ellipticity constants.** Let:\n974: \n975: $$\n976: c_{\\min} := \\frac{1}{H_{\\max} + \\epsilon_\\Sigma}, \\quad c_{\\max} := \\frac{1}{\\epsilon_\\Sigma - H_{\\max}}\n977: \n978: $$\n979: \n980: Then:\n981: \n982: $$\n983: c_{\\min} I \\preceq G_{\\text{reg}}(S) \\preceq c_{\\max} I\n984: \n985: $$",
      "metadata": {
        "label": "proof-thm-ueph"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "references": [],
      "raw_directive": "923: :::\n924: \n925: :::{prf:proof} Proof of Theorem [](#thm-ueph)\n926: :label: proof-thm-ueph\n927: \n928: We now prove uniform ellipticity of $G_{\\text{reg}} = (H + \\epsilon_\\Sigma I)^{-1}$.\n929: \n930: **Step 1: Eigenvalue bounds for $H_{\\text{reg}} = H + \\epsilon_\\Sigma I$.**\n931: \n932: The Hessian $H$ is symmetric, so it has real eigenvalues $\\lambda_1(H), \\ldots, \\lambda_d(H)$. Let:\n933: \n934: $$\n935: \\lambda_{\\min}(H) := \\min_{i} \\lambda_i(H), \\quad \\lambda_{\\max}(H) := \\max_{i} \\lambda_i(H)\n936: \n937: $$\n938: \n939: By Lemma [](#lem-hessian-bounded-rigorous), $|\\lambda_i(H)| \\le \\|H\\| \\le H_{\\max}$ for all $i$.\n940: \n941: The eigenvalues of $H_{\\text{reg}} = H + \\epsilon_\\Sigma I$ are:\n942: \n943: $$\n944: \\lambda_i(H_{\\text{reg}}) = \\lambda_i(H) + \\epsilon_\\Sigma\n945: \n946: $$\n947: \n948: Therefore:\n949: \n950: $$\n951: \\lambda_i(H_{\\text{reg}}) \\in [\\lambda_{\\min}(H) + \\epsilon_\\Sigma, \\, \\lambda_{\\max}(H) + \\epsilon_\\Sigma] \\subseteq [\\epsilon_\\Sigma - H_{\\max}, \\, H_{\\max} + \\epsilon_\\Sigma]\n952: \n953: $$\n954: \n955: **Step 2: Critical condition for strict positivity.** For $H_{\\text{reg}}$ to be strictly positive definite for all $S$, we require:\n956: \n957: $$\n958: \\epsilon_\\Sigma - H_{\\max} > 0 \\quad \\Longleftrightarrow \\quad \\epsilon_\\Sigma > H_{\\max}\n959: \n960: $$\n961: \n962: This is the **key design constraint**: the regularization parameter must exceed the uniform bound on the Hessian spectral norm.\n963: \n964: **Step 3: Eigenvalue bounds for $G_{\\text{reg}} = H_{\\text{reg}}^{-1}$.**\n965: \n966: Assuming $\\epsilon_\\Sigma > H_{\\max}$, the eigenvalues of the inverse are:\n967: \n968: $$\n969: \\lambda_i(G_{\\text{reg}}) = \\frac{1}{\\lambda_i(H_{\\text{reg}})} \\in \\left[ \\frac{1}{H_{\\max} + \\epsilon_\\Sigma}, \\, \\frac{1}{\\epsilon_\\Sigma - H_{\\max}} \\right]\n970: \n971: $$\n972: \n973: **Step 4: Define ellipticity constants.** Let:\n974: \n975: $$\n976: c_{\\min} := \\frac{1}{H_{\\max} + \\epsilon_\\Sigma}, \\quad c_{\\max} := \\frac{1}{\\epsilon_\\Sigma - H_{\\max}}\n977: \n978: $$\n979: \n980: Then:\n981: \n982: $$\n983: c_{\\min} I \\preceq G_{\\text{reg}}(S) \\preceq c_{\\max} I\n984: \n985: $$\n986: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Uniform Ellipticity and Well-Posedness"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-cor-wellposed",
      "title": null,
      "start_line": 1011,
      "end_line": 1070,
      "header_lines": [
        1012
      ],
      "content_start": 1014,
      "content_end": 1069,
      "content": "1014: :label: proof-cor-wellposed\n1015: \n1016: **Key Challenge:** The coefficients $\\mathbf{F}_{\\text{adapt}}(x_i, S)$, $\\mathbf{F}_{\\text{viscous}}(x_i, S)$, and $\\Sigma_{\\text{reg}}(x_i, S)$ depend on the **full swarm state** $S = (x_1, v_1, \\ldots, x_N, v_N)$, not just on the individual particle $(x_i, v_i)$. This makes our SDE a **McKean-Vlasov-type system** with particle interactions, requiring more careful analysis than standard SDEs.\n1017: \n1018: **Step 1: Lipschitz Continuity in the Product Topology.**\n1019: \n1020: We need to show that the drift and diffusion coefficients are Lipschitz continuous in the full state $S$ with respect to an appropriate metric on the product space $\\Sigma_N = (\\mathcal{X} \\times \\mathbb{R}^d)^N$.\n1021: \n1022: Define the product metric:\n1023: \n1024: $$\n1025: d_{\\Sigma_N}(S, S') := \\max_{i=1,\\ldots,N} \\left( \\|x_i - x'_i\\| + \\|v_i - v'_i\\| \\right)\n1026: \n1027: $$\n1028: \n1029: **Adaptive Force:** By Theorem {prf:ref}`thm-c1-regularity` (Appendix A), the fitness potential satisfies:\n1030: \n1031: $$\n1032: \\|\\nabla V_{\\text{fit}}[f_k, \\rho](x_i)\\| \\le F_{\\text{adapt,max}}(\\rho)\n1033: \n1034: $$\n1035: \n1036: Moreover, the proof in Appendix A establishes that $\\nabla V_{\\text{fit}}$ depends on $S$ through the localized moments $\\mu_\\rho$ and $\\sigma'_\\rho$, which are **continuous functions** of the alive walker positions $\\{x_j : j \\in A_k\\}$ (via the localization weights $w_{ij}(\\rho)$). Since these moments are weighted averages with smooth weights, they are Lipschitz in $S$:\n1037: \n1038: $$\n1039: \\|\\nabla V_{\\text{fit}}[f_k, \\rho](x_i, S) - \\nabla V_{\\text{fit}}[f_k, \\rho](x_i, S')\\| \\le L_{\\text{fit}}(\\rho) \\cdot d_{\\Sigma_N}(S, S')\n1040: \n1041: $$\n1042: \n1043: for some constant $L_{\\text{fit}}(\\rho)$ depending on the derivatives of the kernel $K_\\rho$ and the measurement function.\n1044: \n1045: **Viscous Force:** The viscous force is:\n1046: \n1047: $$\n1048: \\mathbf{F}_{\\text{viscous}}(x_i, S) = \\nu \\sum_{j \\ne i} \\frac{K(\\|x_i - x_j\\|)}{\\sum_{k \\ne i} K(\\|x_i - x_k\\|)} (v_j - v_i)\n1049: \n1050: $$\n1051: \n1052: where $K$ is a bounded, smooth kernel. The normalized weights $a_{ij} = K(\\|x_i - x_j\\|)/\\deg(i)$ are Lipschitz in $(x_i, v_i)$ and in the other particles' positions $(x_j)$, with Lipschitz constant depending on $\\nu$, the derivatives of $K$, and the lower bound $\\kappa := \\inf_i \\deg(i) > 0$ (which follows from kernel positivity and spatial confinement).\n1053: \n1054: **Diffusion Tensor:** By Theorem {prf:ref}`thm-c2-regularity` (Appendix A), the Hessian $H_i(S) = \\nabla^2 V_{\\text{fit}}[f_k, \\rho](x_i)$ satisfies:\n1055: \n1056: $$\n1057: \\|H_i(S)\\| \\le H_{\\max}(\\rho)\n1058: \n1059: $$\n1060: \n1061: and the proof establishes that $H_i(S)$ is a continuous (in fact, differentiable) function of $S$. Therefore, $\\Sigma_{\\text{reg}}(x_i, S) = (H_i(S) + \\epsilon_\\Sigma I)^{-1/2}$ is Lipschitz in $S$ by the implicit function theorem (the map $M \\mapsto (M + \\epsilon_\\Sigma I)^{-1/2}$ is smooth for $M$ bounded).\n1062: \n1063: **Step 2: Application of McKean-Vlasov Existence Theory.**\n1064: \n1065: With Lipschitz continuity established, we can apply existence and uniqueness theorems for McKean-Vlasov SDEs (e.g., Sznitman, \"Topics in propagation of chaos,\" 1991, or Carmona-Delarue, \"Probabilistic Theory of Mean Field Games,\" 2018, Theorem 5.20).\n1066: \n1067: These theorems guarantee that for Lipschitz drift and diffusion coefficients with linear growth, there exists a unique strong solution to the interacting particle system.\n1068: \n1069: **Step 3: Global Existence.**",
      "metadata": {
        "label": "proof-cor-wellposed"
      },
      "section": "## 4. Uniform Ellipticity and Well-Posedness",
      "references": [
        "thm-c1-regularity",
        "thm-c2-regularity"
      ],
      "raw_directive": "1011: :::\n1012: \n1013: :::{prf:proof}\n1014: :label: proof-cor-wellposed\n1015: \n1016: **Key Challenge:** The coefficients $\\mathbf{F}_{\\text{adapt}}(x_i, S)$, $\\mathbf{F}_{\\text{viscous}}(x_i, S)$, and $\\Sigma_{\\text{reg}}(x_i, S)$ depend on the **full swarm state** $S = (x_1, v_1, \\ldots, x_N, v_N)$, not just on the individual particle $(x_i, v_i)$. This makes our SDE a **McKean-Vlasov-type system** with particle interactions, requiring more careful analysis than standard SDEs.\n1017: \n1018: **Step 1: Lipschitz Continuity in the Product Topology.**\n1019: \n1020: We need to show that the drift and diffusion coefficients are Lipschitz continuous in the full state $S$ with respect to an appropriate metric on the product space $\\Sigma_N = (\\mathcal{X} \\times \\mathbb{R}^d)^N$.\n1021: \n1022: Define the product metric:\n1023: \n1024: $$\n1025: d_{\\Sigma_N}(S, S') := \\max_{i=1,\\ldots,N} \\left( \\|x_i - x'_i\\| + \\|v_i - v'_i\\| \\right)\n1026: \n1027: $$\n1028: \n1029: **Adaptive Force:** By Theorem {prf:ref}`thm-c1-regularity` (Appendix A), the fitness potential satisfies:\n1030: \n1031: $$\n1032: \\|\\nabla V_{\\text{fit}}[f_k, \\rho](x_i)\\| \\le F_{\\text{adapt,max}}(\\rho)\n1033: \n1034: $$\n1035: \n1036: Moreover, the proof in Appendix A establishes that $\\nabla V_{\\text{fit}}$ depends on $S$ through the localized moments $\\mu_\\rho$ and $\\sigma'_\\rho$, which are **continuous functions** of the alive walker positions $\\{x_j : j \\in A_k\\}$ (via the localization weights $w_{ij}(\\rho)$). Since these moments are weighted averages with smooth weights, they are Lipschitz in $S$:\n1037: \n1038: $$\n1039: \\|\\nabla V_{\\text{fit}}[f_k, \\rho](x_i, S) - \\nabla V_{\\text{fit}}[f_k, \\rho](x_i, S')\\| \\le L_{\\text{fit}}(\\rho) \\cdot d_{\\Sigma_N}(S, S')\n1040: \n1041: $$\n1042: \n1043: for some constant $L_{\\text{fit}}(\\rho)$ depending on the derivatives of the kernel $K_\\rho$ and the measurement function.\n1044: \n1045: **Viscous Force:** The viscous force is:\n1046: \n1047: $$\n1048: \\mathbf{F}_{\\text{viscous}}(x_i, S) = \\nu \\sum_{j \\ne i} \\frac{K(\\|x_i - x_j\\|)}{\\sum_{k \\ne i} K(\\|x_i - x_k\\|)} (v_j - v_i)\n1049: \n1050: $$\n1051: \n1052: where $K$ is a bounded, smooth kernel. The normalized weights $a_{ij} = K(\\|x_i - x_j\\|)/\\deg(i)$ are Lipschitz in $(x_i, v_i)$ and in the other particles' positions $(x_j)$, with Lipschitz constant depending on $\\nu$, the derivatives of $K$, and the lower bound $\\kappa := \\inf_i \\deg(i) > 0$ (which follows from kernel positivity and spatial confinement).\n1053: \n1054: **Diffusion Tensor:** By Theorem {prf:ref}`thm-c2-regularity` (Appendix A), the Hessian $H_i(S) = \\nabla^2 V_{\\text{fit}}[f_k, \\rho](x_i)$ satisfies:\n1055: \n1056: $$\n1057: \\|H_i(S)\\| \\le H_{\\max}(\\rho)\n1058: \n1059: $$\n1060: \n1061: and the proof establishes that $H_i(S)$ is a continuous (in fact, differentiable) function of $S$. Therefore, $\\Sigma_{\\text{reg}}(x_i, S) = (H_i(S) + \\epsilon_\\Sigma I)^{-1/2}$ is Lipschitz in $S$ by the implicit function theorem (the map $M \\mapsto (M + \\epsilon_\\Sigma I)^{-1/2}$ is smooth for $M$ bounded).\n1062: \n1063: **Step 2: Application of McKean-Vlasov Existence Theory.**\n1064: \n1065: With Lipschitz continuity established, we can apply existence and uniqueness theorems for McKean-Vlasov SDEs (e.g., Sznitman, \"Topics in propagation of chaos,\" 1991, or Carmona-Delarue, \"Probabilistic Theory of Mean Field Games,\" 2018, Theorem 5.20).\n1066: \n1067: These theorems guarantee that for Lipschitz drift and diffusion coefficients with linear growth, there exists a unique strong solution to the interacting particle system.\n1068: \n1069: **Step 3: Global Existence.**\n1070: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 4. Uniform Ellipticity and Well-Posedness"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-backbone-convergence",
      "title": "Proof sketch",
      "start_line": 1137,
      "end_line": 1149,
      "header_lines": [
        1138
      ],
      "content_start": 1140,
      "content_end": 1148,
      "content": "1140: :label: proof-thm-backbone-convergence\n1141: \n1142: The full proof is provided in Theorem 1.4.2 of [04_convergence.md](../1_euclidean_gas/06_convergence.md). The argument proceeds by establishing drift inequalities for each component of $V_{\\text{total}}$ under both the cloning operator $\\Psi_{\\text{clone}}$ and the kinetic evolution $\\Psi_{\\text{kin,backbone}}$, then combining them via the Discretization Theorem (Theorem 1.7.2).\n1143: \n1144: The key mechanisms are:\n1145: 1.  **Boundary contraction** via the cloning Safe Harbor (Axiom EG-2).\n1146: 2.  **Velocity variance contraction** via friction dissipation.\n1147: 3.  **Spatial variance contraction** via hypocoercive coupling between $x$ and $v$.\n1148: 4.  **Mean distance contraction** via the globally confining potential $U$.",
      "metadata": {
        "label": "proof-thm-backbone-convergence"
      },
      "section": "## 5. The Stable Backbone System",
      "references": [],
      "raw_directive": "1137: :::\n1138: \n1139: :::{prf:proof} Proof sketch\n1140: :label: proof-thm-backbone-convergence\n1141: \n1142: The full proof is provided in Theorem 1.4.2 of [04_convergence.md](../1_euclidean_gas/06_convergence.md). The argument proceeds by establishing drift inequalities for each component of $V_{\\text{total}}$ under both the cloning operator $\\Psi_{\\text{clone}}$ and the kinetic evolution $\\Psi_{\\text{kin,backbone}}$, then combining them via the Discretization Theorem (Theorem 1.7.2).\n1143: \n1144: The key mechanisms are:\n1145: 1.  **Boundary contraction** via the cloning Safe Harbor (Axiom EG-2).\n1146: 2.  **Velocity variance contraction** via friction dissipation.\n1147: 3.  **Spatial variance contraction** via hypocoercive coupling between $x$ and $v$.\n1148: 4.  **Mean distance contraction** via the globally confining potential $U$.\n1149: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 5. The Stable Backbone System"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-strat-chain",
      "title": null,
      "start_line": 1281,
      "end_line": 1287,
      "header_lines": [
        1282
      ],
      "content_start": 1284,
      "content_end": 1286,
      "content": "1284: :label: proof-thm-strat-chain\n1285: \n1286: This follows from the standard Stratonovich chain rule (see Øksendal, \"Stochastic Differential Equations\", Chapter 3, or Kunita, \"Stochastic Flows and Stochastic Differential Equations\", Chapter 3).",
      "metadata": {
        "label": "proof-thm-strat-chain"
      },
      "section": "## 5.4. The Stratonovich Chain Rule and Drift Calculation",
      "references": [],
      "raw_directive": "1281: :::\n1282: \n1283: :::{prf:proof}\n1284: :label: proof-thm-strat-chain\n1285: \n1286: This follows from the standard Stratonovich chain rule (see Øksendal, \"Stochastic Differential Equations\", Chapter 3, or Kunita, \"Stochastic Flows and Stochastic Differential Equations\", Chapter 3).\n1287: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 8,
        "chapter_file": "chapter_8.json",
        "section_id": "## 5.4. The Stratonovich Chain Rule and Drift Calculation"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-adaptive-force-bounded",
      "title": null,
      "start_line": 1390,
      "end_line": 1454,
      "header_lines": [
        1391
      ],
      "content_start": 1393,
      "content_end": 1453,
      "content": "1393: :label: proof-lem-adaptive-force-bounded\n1394: \n1395: By the Cauchy-Schwarz inequality:\n1396: \n1397: $$\n1398: \\left| \\left\\langle \\nabla V_{\\text{total}}, \\, \\mathbf{F}_{\\text{adapt}} \\right\\rangle \\right| \\le \\|\\nabla V_{\\text{total}}\\| \\cdot \\|\\mathbf{F}_{\\text{adapt}}\\|\n1399: \n1400: $$\n1401: \n1402: **Step 1: N-Uniform Bound on $\\|\\mathbf{F}_{\\text{adapt}}\\|$.** By **Appendix A, Theorem A.1** (Theorem {prf:ref}`thm-c1-regularity`), the C¹ regularity of the ρ-localized fitness potential establishes that:\n1403: \n1404: $$\n1405: \\|\\mathbf{F}_{\\text{adapt}}(S)\\| = \\epsilon_F \\|\\nabla V_{\\text{fit}}[f_k, \\rho](S)\\| \\le \\epsilon_F F_{\\text{adapt,max}}(\\rho)\n1406: \n1407: $$\n1408: \n1409: where $F_{\\text{adapt,max}}(\\rho) = O(1/\\rho)$ is the **N-uniform** explicit bound derived in the appendix through rigorous chain rule analysis and the telescoping property of normalized localization weights.\n1410: \n1411: **Step 2: Polynomial growth of $\\|\\nabla V_{\\text{total}}\\|$.** The Lyapunov function is:\n1412: \n1413: $$\n1414: V_{\\text{total}}(S) = \\alpha_x V_{\\text{Var},x} + \\alpha_v V_{\\text{Var},v} + \\alpha_D V_{\\text{Mean},D} + \\alpha_R V_{\\text{Mean},R}\n1415: \n1416: $$\n1417: \n1418: Each component is a quadratic or linear function of the particle positions and velocities. For example:\n1419: \n1420: $$\n1421: V_{\\text{Var},x} = \\frac{1}{N} \\sum_{i=1}^N \\|x_i - \\bar{x}\\|^2\n1422: \n1423: $$\n1424: \n1425: Its gradient with respect to $x_i$ is:\n1426: \n1427: $$\n1428: \\nabla_{x_i} V_{\\text{Var},x} = \\frac{2}{N} (x_i - \\bar{x})\n1429: \n1430: $$\n1431: \n1432: Thus:\n1433: \n1434: $$\n1435: \\|\\nabla_{x_i} V_{\\text{Var},x}\\| \\le \\frac{2}{N} \\|x_i - \\bar{x}\\| \\le \\frac{2}{\\sqrt{N}} \\sqrt{V_{\\text{Var},x}}\n1436: \n1437: $$\n1438: \n1439: Summing over all particles and components:\n1440: \n1441: $$\n1442: \\|\\nabla V_{\\text{total}}\\|^2 \\le C_{\\nabla} (V_{\\text{total}} + 1)\n1443: \n1444: $$\n1445: \n1446: for some constant $C_{\\nabla}$ depending on the weights $\\alpha_x, \\alpha_v, \\alpha_D, \\alpha_R$.\n1447: \n1448: **Step 3: Combine.** Therefore:\n1449: \n1450: $$\n1451: \\left| \\left\\langle \\nabla V_{\\text{total}}, \\, \\mathbf{F}_{\\text{adapt}} \\right\\rangle \\right| \\le \\sqrt{C_{\\nabla} (V_{\\text{total}} + 1)} \\cdot \\epsilon_F F_{\\text{adapt,max}}(\\rho) \\le \\epsilon_F K_F(\\rho) (V_{\\text{total}} + 1)\n1452: \n1453: $$",
      "metadata": {
        "label": "proof-lem-adaptive-force-bounded"
      },
      "section": "## 6. Boundedness of the Adaptive Perturbations",
      "references": [
        "thm-c1-regularity"
      ],
      "raw_directive": "1390: :::\n1391: \n1392: :::{prf:proof}\n1393: :label: proof-lem-adaptive-force-bounded\n1394: \n1395: By the Cauchy-Schwarz inequality:\n1396: \n1397: $$\n1398: \\left| \\left\\langle \\nabla V_{\\text{total}}, \\, \\mathbf{F}_{\\text{adapt}} \\right\\rangle \\right| \\le \\|\\nabla V_{\\text{total}}\\| \\cdot \\|\\mathbf{F}_{\\text{adapt}}\\|\n1399: \n1400: $$\n1401: \n1402: **Step 1: N-Uniform Bound on $\\|\\mathbf{F}_{\\text{adapt}}\\|$.** By **Appendix A, Theorem A.1** (Theorem {prf:ref}`thm-c1-regularity`), the C¹ regularity of the ρ-localized fitness potential establishes that:\n1403: \n1404: $$\n1405: \\|\\mathbf{F}_{\\text{adapt}}(S)\\| = \\epsilon_F \\|\\nabla V_{\\text{fit}}[f_k, \\rho](S)\\| \\le \\epsilon_F F_{\\text{adapt,max}}(\\rho)\n1406: \n1407: $$\n1408: \n1409: where $F_{\\text{adapt,max}}(\\rho) = O(1/\\rho)$ is the **N-uniform** explicit bound derived in the appendix through rigorous chain rule analysis and the telescoping property of normalized localization weights.\n1410: \n1411: **Step 2: Polynomial growth of $\\|\\nabla V_{\\text{total}}\\|$.** The Lyapunov function is:\n1412: \n1413: $$\n1414: V_{\\text{total}}(S) = \\alpha_x V_{\\text{Var},x} + \\alpha_v V_{\\text{Var},v} + \\alpha_D V_{\\text{Mean},D} + \\alpha_R V_{\\text{Mean},R}\n1415: \n1416: $$\n1417: \n1418: Each component is a quadratic or linear function of the particle positions and velocities. For example:\n1419: \n1420: $$\n1421: V_{\\text{Var},x} = \\frac{1}{N} \\sum_{i=1}^N \\|x_i - \\bar{x}\\|^2\n1422: \n1423: $$\n1424: \n1425: Its gradient with respect to $x_i$ is:\n1426: \n1427: $$\n1428: \\nabla_{x_i} V_{\\text{Var},x} = \\frac{2}{N} (x_i - \\bar{x})\n1429: \n1430: $$\n1431: \n1432: Thus:\n1433: \n1434: $$\n1435: \\|\\nabla_{x_i} V_{\\text{Var},x}\\| \\le \\frac{2}{N} \\|x_i - \\bar{x}\\| \\le \\frac{2}{\\sqrt{N}} \\sqrt{V_{\\text{Var},x}}\n1436: \n1437: $$\n1438: \n1439: Summing over all particles and components:\n1440: \n1441: $$\n1442: \\|\\nabla V_{\\text{total}}\\|^2 \\le C_{\\nabla} (V_{\\text{total}} + 1)\n1443: \n1444: $$\n1445: \n1446: for some constant $C_{\\nabla}$ depending on the weights $\\alpha_x, \\alpha_v, \\alpha_D, \\alpha_R$.\n1447: \n1448: **Step 3: Combine.** Therefore:\n1449: \n1450: $$\n1451: \\left| \\left\\langle \\nabla V_{\\text{total}}, \\, \\mathbf{F}_{\\text{adapt}} \\right\\rangle \\right| \\le \\sqrt{C_{\\nabla} (V_{\\text{total}} + 1)} \\cdot \\epsilon_F F_{\\text{adapt,max}}(\\rho) \\le \\epsilon_F K_F(\\rho) (V_{\\text{total}} + 1)\n1452: \n1453: $$\n1454: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 6. Boundedness of the Adaptive Perturbations"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-viscous-dissipative",
      "title": null,
      "start_line": 1500,
      "end_line": 1552,
      "header_lines": [
        1501
      ],
      "content_start": 1503,
      "content_end": 1551,
      "content": "1503: :label: proof-lem-viscous-dissipative\n1504: \n1505: The velocity variance is:\n1506: \n1507: $$\n1508: V_{\\text{Var},v} = \\frac{1}{N} \\sum_{i=1}^N \\|v_i - \\bar{v}\\|^2\n1509: \n1510: $$\n1511: \n1512: From the Stratonovich chain rule (Theorem [](#thm-strat-chain)), the contribution of the normalized viscous force to the drift is:\n1513: \n1514: $$\n1515: A_{\\text{viscous}}(V_{\\text{Var},v}) = \\sum_{i=1}^N \\left\\langle \\nabla_{v_i} V_{\\text{Var},v}, \\, \\nu \\sum_{j \\neq i} \\frac{K(x_i - x_j)}{\\deg(i)} (v_j - v_i) \\right\\rangle\n1516: \n1517: $$\n1518: \n1519: Since $\\nabla_{v_i} V_{\\text{Var},v} = \\frac{2}{N}(v_i - \\bar{v})$:\n1520: \n1521: $$\n1522: \\begin{aligned}\n1523: A_{\\text{viscous}}(V_{\\text{Var},v}) &= \\frac{2\\nu}{N} \\sum_{i=1}^N \\frac{1}{\\deg(i)} \\sum_{j \\neq i} K(x_i - x_j) \\langle v_i - \\bar{v}, \\, v_j - v_i \\rangle\n1524: \\end{aligned}\n1525: \n1526: $$\n1527: \n1528: **Key observation:** We use the **antisymmetric pairing structure** of $(v_j - v_i)$.\n1529: \n1530: Define the symmetric weight matrix $W_{ij} = K(x_i - x_j)$. Since the sum over all pairs can be symmetrized:\n1531: \n1532: $$\n1533: \\begin{aligned}\n1534: A_{\\text{viscous}}(V_{\\text{Var},v}) &= \\frac{\\nu}{N} \\sum_{i < j} W_{ij} \\left[ \\frac{\\langle v_i - \\bar{v}, v_j - v_i \\rangle}{\\deg(i)} + \\frac{\\langle v_j - \\bar{v}, v_i - v_j \\rangle}{\\deg(j)} \\right]\n1535: \\end{aligned}\n1536: \n1537: $$\n1538: \n1539: Using $\\langle v_j - \\bar{v}, v_i - v_j \\rangle = -\\langle v_j - \\bar{v}, v_j - v_i \\rangle$:\n1540: \n1541: $$\n1542: = \\frac{\\nu}{N} \\sum_{i < j} W_{ij} \\left[ \\frac{1}{\\deg(i)} - \\frac{1}{\\deg(j)} \\right] \\langle v_i - \\bar{v}, v_j - v_i \\rangle\n1543: \n1544: $$\n1545: \n1546: Expanding $\\langle v_i - \\bar{v}, v_j - v_i \\rangle = -\\|v_i - \\bar{v}\\|^2 + \\langle v_i - \\bar{v}, v_j - \\bar{v} \\rangle$ and using the identity $\\|v_i - v_j\\|^2 = \\|v_i - \\bar{v}\\|^2 + \\|v_j - \\bar{v}\\|^2 - 2\\langle v_i - \\bar{v}, v_j - \\bar{v} \\rangle$, we obtain after algebraic manipulation:\n1547: \n1548: $$\n1549: A_{\\text{viscous}}(V_{\\text{Var},v}) = -\\frac{\\nu}{N} \\sum_{i < j} K(x_i - x_j) \\left[ \\frac{1}{\\deg(i)} + \\frac{1}{\\deg(j)} \\right] \\|v_i - v_j\\|^2 \\le 0\n1550: \n1551: $$",
      "metadata": {
        "label": "proof-lem-viscous-dissipative"
      },
      "section": "## 6. Boundedness of the Adaptive Perturbations",
      "references": [],
      "raw_directive": "1500: :::\n1501: \n1502: :::{prf:proof}\n1503: :label: proof-lem-viscous-dissipative\n1504: \n1505: The velocity variance is:\n1506: \n1507: $$\n1508: V_{\\text{Var},v} = \\frac{1}{N} \\sum_{i=1}^N \\|v_i - \\bar{v}\\|^2\n1509: \n1510: $$\n1511: \n1512: From the Stratonovich chain rule (Theorem [](#thm-strat-chain)), the contribution of the normalized viscous force to the drift is:\n1513: \n1514: $$\n1515: A_{\\text{viscous}}(V_{\\text{Var},v}) = \\sum_{i=1}^N \\left\\langle \\nabla_{v_i} V_{\\text{Var},v}, \\, \\nu \\sum_{j \\neq i} \\frac{K(x_i - x_j)}{\\deg(i)} (v_j - v_i) \\right\\rangle\n1516: \n1517: $$\n1518: \n1519: Since $\\nabla_{v_i} V_{\\text{Var},v} = \\frac{2}{N}(v_i - \\bar{v})$:\n1520: \n1521: $$\n1522: \\begin{aligned}\n1523: A_{\\text{viscous}}(V_{\\text{Var},v}) &= \\frac{2\\nu}{N} \\sum_{i=1}^N \\frac{1}{\\deg(i)} \\sum_{j \\neq i} K(x_i - x_j) \\langle v_i - \\bar{v}, \\, v_j - v_i \\rangle\n1524: \\end{aligned}\n1525: \n1526: $$\n1527: \n1528: **Key observation:** We use the **antisymmetric pairing structure** of $(v_j - v_i)$.\n1529: \n1530: Define the symmetric weight matrix $W_{ij} = K(x_i - x_j)$. Since the sum over all pairs can be symmetrized:\n1531: \n1532: $$\n1533: \\begin{aligned}\n1534: A_{\\text{viscous}}(V_{\\text{Var},v}) &= \\frac{\\nu}{N} \\sum_{i < j} W_{ij} \\left[ \\frac{\\langle v_i - \\bar{v}, v_j - v_i \\rangle}{\\deg(i)} + \\frac{\\langle v_j - \\bar{v}, v_i - v_j \\rangle}{\\deg(j)} \\right]\n1535: \\end{aligned}\n1536: \n1537: $$\n1538: \n1539: Using $\\langle v_j - \\bar{v}, v_i - v_j \\rangle = -\\langle v_j - \\bar{v}, v_j - v_i \\rangle$:\n1540: \n1541: $$\n1542: = \\frac{\\nu}{N} \\sum_{i < j} W_{ij} \\left[ \\frac{1}{\\deg(i)} - \\frac{1}{\\deg(j)} \\right] \\langle v_i - \\bar{v}, v_j - v_i \\rangle\n1543: \n1544: $$\n1545: \n1546: Expanding $\\langle v_i - \\bar{v}, v_j - v_i \\rangle = -\\|v_i - \\bar{v}\\|^2 + \\langle v_i - \\bar{v}, v_j - \\bar{v} \\rangle$ and using the identity $\\|v_i - v_j\\|^2 = \\|v_i - \\bar{v}\\|^2 + \\|v_j - \\bar{v}\\|^2 - 2\\langle v_i - \\bar{v}, v_j - \\bar{v} \\rangle$, we obtain after algebraic manipulation:\n1547: \n1548: $$\n1549: A_{\\text{viscous}}(V_{\\text{Var},v}) = -\\frac{\\nu}{N} \\sum_{i < j} K(x_i - x_j) \\left[ \\frac{1}{\\deg(i)} + \\frac{1}{\\deg(j)} \\right] \\|v_i - v_j\\|^2 \\le 0\n1550: \n1551: $$\n1552: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 6. Boundedness of the Adaptive Perturbations"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-diffusion-bounded",
      "title": null,
      "start_line": 1575,
      "end_line": 1639,
      "header_lines": [
        1576
      ],
      "content_start": 1578,
      "content_end": 1638,
      "content": "1578: :label: proof-lem-diffusion-bounded\n1579: \n1580: Recall from Definition [](#def-strat-drift):\n1581: \n1582: $$\n1583: A_{\\text{diff}}(S) = \\frac{1}{2} \\sum_{i=1}^N \\sum_{j=1}^d \\left[ (\\sigma_{ij}^{\\text{reg}} \\cdot \\nabla_{v_i})(\\sigma_{ij}^{\\text{reg}} \\cdot \\nabla_{v_i} V) - \\sigma^2 \\|\\nabla_{v_i} V\\|^2 \\right]\n1584: \n1585: $$\n1586: \n1587: where $\\sigma_{ij}^{\\text{reg}}$ is the $j$-th column of $\\Sigma_{\\text{reg}}(x_i, S)$.\n1588: \n1589: **Step 1: Bound the Stratonovich second-order term.** The term $(\\sigma_{ij} \\cdot \\nabla_{v_i})(\\sigma_{ij} \\cdot \\nabla_{v_i} V)$ is a directional second derivative. By the chain rule:\n1590: \n1591: $$\n1592: (\\sigma_{ij} \\cdot \\nabla_{v_i})(\\sigma_{ij} \\cdot \\nabla_{v_i} V) = \\langle \\sigma_{ij}, \\nabla^2_{v_i} V \\sigma_{ij} \\rangle + \\langle \\sigma_{ij} \\cdot \\nabla_{v_i} \\sigma_{ij}, \\nabla_{v_i} V \\rangle\n1593: \n1594: $$\n1595: \n1596: The first term is bounded using the Hessian of $V$:\n1597: \n1598: $$\n1599: \\left| \\langle \\sigma_{ij}, \\nabla^2_{v_i} V \\sigma_{ij} \\rangle \\right| \\le \\|\\sigma_{ij}\\|^2 \\|\\nabla^2_{v_i} V\\| \\le c_{\\max} \\|\\nabla^2 V\\|\n1600: \n1601: $$\n1602: \n1603: by Theorem [](#thm-ueph).\n1604: \n1605: The second term involves the derivative of the diffusion coefficient. Since $\\Sigma_{\\text{reg}}$ has bounded derivatives (it's a smooth function of the uniformly bounded $H(S)$), there exists $L_\\Sigma < \\infty$ such that:\n1606: \n1607: $$\n1608: \\left| \\langle \\sigma_{ij} \\cdot \\nabla_{v_i} \\sigma_{ij}, \\nabla_{v_i} V \\rangle \\right| \\le L_\\Sigma \\|\\nabla V\\|\n1609: \n1610: $$\n1611: \n1612: **Step 2: Bound the backbone term.** For the backbone diffusion $\\sigma I$:\n1613: \n1614: $$\n1615: \\sigma^2 \\|\\nabla_{v_i} V\\|^2 \\le \\sigma^2 \\|\\nabla V\\|^2\n1616: \n1617: $$\n1618: \n1619: **Step 3: Combine.** Since $V_{\\text{total}}$ is a quadratic-like function with bounded second derivatives:\n1620: \n1621: $$\n1622: \\|\\nabla^2 V_{\\text{total}}\\| \\le C_{\\nabla\\nabla}, \\quad \\|\\nabla V_{\\text{total}}\\| \\le C_{\\nabla} (V_{\\text{total}} + 1)^{1/2}\n1623: \n1624: $$\n1625: \n1626: Therefore:\n1627: \n1628: $$\n1629: |A_{\\text{diff}}(S)| \\le \\frac{N d}{2} \\left( c_{\\max} C_{\\nabla\\nabla} + L_\\Sigma C_{\\nabla} (V_{\\text{total}} + 1)^{1/2} + \\sigma^2 C_{\\nabla}^2 (V_{\\text{total}} + 1) \\right)\n1630: \n1631: $$\n1632: \n1633: For the perturbation analysis, we can bound this by:\n1634: \n1635: $$\n1636: |A_{\\text{diff}}(S)| \\le C_{\\text{diff,0}} + C_{\\text{diff,1}} V_{\\text{total}}\n1637: \n1638: $$",
      "metadata": {
        "label": "proof-lem-diffusion-bounded"
      },
      "section": "## 6. Boundedness of the Adaptive Perturbations",
      "references": [],
      "raw_directive": "1575: :::\n1576: \n1577: :::{prf:proof}\n1578: :label: proof-lem-diffusion-bounded\n1579: \n1580: Recall from Definition [](#def-strat-drift):\n1581: \n1582: $$\n1583: A_{\\text{diff}}(S) = \\frac{1}{2} \\sum_{i=1}^N \\sum_{j=1}^d \\left[ (\\sigma_{ij}^{\\text{reg}} \\cdot \\nabla_{v_i})(\\sigma_{ij}^{\\text{reg}} \\cdot \\nabla_{v_i} V) - \\sigma^2 \\|\\nabla_{v_i} V\\|^2 \\right]\n1584: \n1585: $$\n1586: \n1587: where $\\sigma_{ij}^{\\text{reg}}$ is the $j$-th column of $\\Sigma_{\\text{reg}}(x_i, S)$.\n1588: \n1589: **Step 1: Bound the Stratonovich second-order term.** The term $(\\sigma_{ij} \\cdot \\nabla_{v_i})(\\sigma_{ij} \\cdot \\nabla_{v_i} V)$ is a directional second derivative. By the chain rule:\n1590: \n1591: $$\n1592: (\\sigma_{ij} \\cdot \\nabla_{v_i})(\\sigma_{ij} \\cdot \\nabla_{v_i} V) = \\langle \\sigma_{ij}, \\nabla^2_{v_i} V \\sigma_{ij} \\rangle + \\langle \\sigma_{ij} \\cdot \\nabla_{v_i} \\sigma_{ij}, \\nabla_{v_i} V \\rangle\n1593: \n1594: $$\n1595: \n1596: The first term is bounded using the Hessian of $V$:\n1597: \n1598: $$\n1599: \\left| \\langle \\sigma_{ij}, \\nabla^2_{v_i} V \\sigma_{ij} \\rangle \\right| \\le \\|\\sigma_{ij}\\|^2 \\|\\nabla^2_{v_i} V\\| \\le c_{\\max} \\|\\nabla^2 V\\|\n1600: \n1601: $$\n1602: \n1603: by Theorem [](#thm-ueph).\n1604: \n1605: The second term involves the derivative of the diffusion coefficient. Since $\\Sigma_{\\text{reg}}$ has bounded derivatives (it's a smooth function of the uniformly bounded $H(S)$), there exists $L_\\Sigma < \\infty$ such that:\n1606: \n1607: $$\n1608: \\left| \\langle \\sigma_{ij} \\cdot \\nabla_{v_i} \\sigma_{ij}, \\nabla_{v_i} V \\rangle \\right| \\le L_\\Sigma \\|\\nabla V\\|\n1609: \n1610: $$\n1611: \n1612: **Step 2: Bound the backbone term.** For the backbone diffusion $\\sigma I$:\n1613: \n1614: $$\n1615: \\sigma^2 \\|\\nabla_{v_i} V\\|^2 \\le \\sigma^2 \\|\\nabla V\\|^2\n1616: \n1617: $$\n1618: \n1619: **Step 3: Combine.** Since $V_{\\text{total}}$ is a quadratic-like function with bounded second derivatives:\n1620: \n1621: $$\n1622: \\|\\nabla^2 V_{\\text{total}}\\| \\le C_{\\nabla\\nabla}, \\quad \\|\\nabla V_{\\text{total}}\\| \\le C_{\\nabla} (V_{\\text{total}} + 1)^{1/2}\n1623: \n1624: $$\n1625: \n1626: Therefore:\n1627: \n1628: $$\n1629: |A_{\\text{diff}}(S)| \\le \\frac{N d}{2} \\left( c_{\\max} C_{\\nabla\\nabla} + L_\\Sigma C_{\\nabla} (V_{\\text{total}} + 1)^{1/2} + \\sigma^2 C_{\\nabla}^2 (V_{\\text{total}} + 1) \\right)\n1630: \n1631: $$\n1632: \n1633: For the perturbation analysis, we can bound this by:\n1634: \n1635: $$\n1636: |A_{\\text{diff}}(S)| \\le C_{\\text{diff,0}} + C_{\\text{diff,1}} V_{\\text{total}}\n1637: \n1638: $$\n1639: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 9,
        "chapter_file": "chapter_9.json",
        "section_id": "## 6. Boundedness of the Adaptive Perturbations"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-fl-drift-adaptive",
      "title": null,
      "start_line": 1730,
      "end_line": 1862,
      "header_lines": [
        1731
      ],
      "content_start": 1733,
      "content_end": 1861,
      "content": "1733: :label: proof-thm-fl-drift-adaptive\n1734: \n1735: The proof proceeds in six steps, working entirely in the continuous-time domain before discretization.\n1736: \n1737: **Step 1: Decompose the Stratonovich drift.** By Definition [](#def-strat-drift), the Stratonovich drift of $V_{\\text{total}}(S_t)$ is:\n1738: \n1739: $$\n1740: A_{\\text{full}}(S) = A_{\\text{backbone}}(S) + A_{\\text{perturb}}(S)\n1741: \n1742: $$\n1743: \n1744: where $A_{\\text{backbone}}$ is the drift of the backbone system (Section 5) and $A_{\\text{perturb}}$ is the perturbative contribution from the adaptive terms (Chapter 6).\n1745: \n1746: **Step 2: Establish the continuous-time backbone drift inequality.** The backbone system (with $\\epsilon_F = 0$, $\\nu = 0$, $\\Sigma_{\\text{reg}} = \\sigma I$) satisfies a continuous-time drift inequality. From the analysis in [04_convergence.md](../1_euclidean_gas/06_convergence.md), adapted to Stratonovich calculus, the expected drift satisfies:\n1747: \n1748: $$\n1749: \\mathbb{E}[A_{\\text{backbone}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}}\n1750: \n1751: $$\n1752: \n1753: for some $\\kappa_{\\text{backbone}} > 0$ and $C_{\\text{backbone}} < \\infty$.\n1754: \n1755: **Justification:** The backbone convergence was originally proven using discrete-time analysis. The continuous-time drift bound can be recovered by considering the infinitesimal time evolution:\n1756: \n1757: $$\n1758: \\frac{d}{dt} \\mathbb{E}[V_{\\text{total}}(S_t)] = \\mathbb{E}[A_{\\text{backbone}}(S_t)]\n1759: \n1760: $$\n1761: \n1762: The discrete-time bound $\\mathbb{E}[V'] \\le (1 - \\kappa \\Delta t) V + C \\Delta t$ implies, in the limit $\\Delta t \\to 0$, the continuous-time inequality $\\mathbb{E}[A] \\le -\\kappa V + C$.\n1763: \n1764: **Step 3: Bound the perturbative contribution (ρ-dependent).** By Corollary {prf:ref}`cor-total-perturbation`, the perturbative drift satisfies:\n1765: \n1766: $$\n1767: A_{\\text{perturb}}(S) \\le (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho))\n1768: \n1769: $$\n1770: \n1771: **Step 4: Combine the drift inequalities.** Adding Steps 2 and 3:\n1772: \n1773: $$\n1774: \\begin{aligned}\n1775: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] &= \\mathbb{E}[A_{\\text{backbone}}(S_t) + A_{\\text{perturb}}(S_t) \\mid S_t] \\\\\n1776: &\\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}} \\\\\n1777: &\\quad + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S_t) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)) \\\\\n1778: &= [- \\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)] V_{\\text{total}}(S_t) \\\\\n1779: &\\quad + [C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)]\n1780: \\end{aligned}\n1781: \n1782: $$\n1783: \n1784: **Step 5: Choose $\\epsilon_F$ to ensure negative drift (ρ-dependent threshold).** Define:\n1785: \n1786: $$\n1787: \\epsilon_F^*(\\rho) := \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2 K_F(\\rho)}\n1788: \n1789: $$\n1790: \n1791: (assuming $\\kappa_{\\text{backbone}} > C_{\\text{diff,1}}(\\rho)$, which holds for sufficiently strong backbone parameters and any finite ρ > 0).\n1792: \n1793: For any $0 \\le \\epsilon_F < \\epsilon_F^*(\\rho)$, we have:\n1794: \n1795: $$\n1796: \\begin{aligned}\n1797: &-\\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho) \\\\\n1798: &< -\\kappa_{\\text{backbone}} + \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} + C_{\\text{diff,1}}(\\rho) \\\\\n1799: &= -\\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} < 0\n1800: \\end{aligned}\n1801: \n1802: $$\n1803: \n1804: Define:\n1805: \n1806: $$\n1807: \\kappa_{\\text{total}}(\\rho) := \\kappa_{\\text{backbone}} - \\epsilon_F K_F(\\rho) - C_{\\text{diff,1}}(\\rho) > 0\n1808: \n1809: $$\n1810: \n1811: $$\n1812: C_{\\text{total}}(\\rho) := C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho) < \\infty\n1813: \n1814: $$\n1815: \n1816: Then the continuous-time drift inequality for the full system is:\n1817: \n1818: $$\n1819: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{total}}(\\rho) V_{\\text{total}}(S_t) + C_{\\text{total}}(\\rho)\n1820: \n1821: $$\n1822: \n1823: **Step 6: Discretization (Justification for Adaptive System).**\n1824: \n1825: The Discretization Theorem (Theorem 1.7.2 in `04_convergence.md`) relates continuous-time drift inequalities to discrete-time Foster-Lyapunov conditions. However, that theorem was stated for the **backbone system** with constant diffusion $\\sigma I$. We must verify its hypotheses hold for the **adaptive system** with state-dependent diffusion $\\Sigma_{\\text{reg}}(x_i, S)$.\n1826: \n1827: **Key Requirements for the Discretization Theorem:**\n1828: 1. **Bounded derivatives of Lyapunov function:** $\\|\\nabla V_{\\text{total}}\\|$, $\\|\\nabla^2 V_{\\text{total}}\\|$ must be polynomially bounded\n1829: 2. **Bounded drift and diffusion:** The SDE coefficients must satisfy global Lipschitz and linear growth conditions\n1830: 3. **Regularity of integrator:** The BAOAB splitting integrator must have bounded weak error\n1831: \n1832: **Verification for the Adaptive System:**\n1833: \n1834: **Requirement 1 (Lyapunov Regularity):** The Lyapunov function $V_{\\text{total}}$ is a quadratic form in $(x, v)$ (variances and mean distances). Therefore:\n1835: - $\\nabla V_{\\text{total}}$ grows at most linearly: $\\|\\nabla V_{\\text{total}}(S)\\| \\le C_{\\nabla}(V_{\\text{total}}(S) + 1)$ (proven in Chapter 6, Lemma {prf:ref}`lem-adaptive-force-bounded`)\n1836: - $\\nabla^2 V_{\\text{total}}$ is uniformly bounded: $\\|\\nabla^2 V_{\\text{total}}\\| \\le C_{\\nabla^2} < \\infty$ (V is quadratic)\n1837: \n1838: **Requirement 2 (SDE Regularity):**\n1839: - **Drift boundedness:** By Appendix A (Theorem {prf:ref}`thm-c1-regularity`), $\\|\\mathbf{F}_{\\text{adapt}}\\| \\le \\epsilon_F F_{\\text{adapt,max}}(\\rho)$ is **N-uniform** and ρ-dependent. The viscous force is similarly bounded. The confining force $-\\nabla U$ has at most linear growth.\n1840: - **Diffusion boundedness:** By Theorem {prf:ref}`thm-ueph`, the regularized diffusion satisfies $c_{\\min}(\\rho) I \\preceq D_{\\text{reg}} \\preceq c_{\\max}(\\rho) I$ with **N-uniform** bounds.\n1841: - **Lipschitz continuity:** Established in Corollary {prf:ref}`cor-wellposed` (Step 1 of its proof)\n1842: \n1843: **Requirement 3 (Integrator Weak Error):** The BAOAB integrator used in `04_convergence.md` has weak error $O(\\Delta t^2)$ for SDEs with smooth coefficients (Leimkuhler-Matthews, \"Molecular Dynamics\", 2015). Since our adaptive drift and diffusion are smooth (C¹ and C² by Appendix A), the BAOAB integrator maintains its $O(\\Delta t^2)$ weak error bound.\n1844: \n1845: **Conclusion:** All hypotheses of the Discretization Theorem are satisfied by the adaptive system. The N-uniform bounds from Appendix A are crucial here - without them, the weak error analysis could fail as $N \\to \\infty$.\n1846: \n1847: Therefore, the continuous-time drift inequality implies the discrete-time Foster-Lyapunov condition:\n1848: \n1849: $$\n1850: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}} \\Delta t + O(\\Delta t^2)) V_{\\text{total}}(S_k) + (C_{\\text{total}} \\Delta t + O(\\Delta t^2))\n1851: \n1852: $$\n1853: \n1854: For sufficiently small $\\Delta t$, the $O(\\Delta t^2)$ terms can be absorbed, yielding:\n1855: \n1856: $$\n1857: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}}) V_{\\text{total}}(S_k) + C_{\\text{total}}\n1858: \n1859: $$\n1860: \n1861: where we redefine $\\kappa_{\\text{total}} := \\kappa_{\\text{total}} \\Delta t$ and $C_{\\text{total}} := C_{\\text{total}} \\Delta t$ for the discrete-time version.",
      "metadata": {
        "label": "proof-thm-fl-drift-adaptive"
      },
      "section": "## 7. Foster-Lyapunov Drift for the Full Adaptive System",
      "references": [
        "cor-total-perturbation",
        "lem-adaptive-force-bounded",
        "thm-c1-regularity",
        "thm-ueph",
        "cor-wellposed"
      ],
      "raw_directive": "1730: ### 7.2. Proof of Main Theorem\n1731: \n1732: :::{prf:proof}\n1733: :label: proof-thm-fl-drift-adaptive\n1734: \n1735: The proof proceeds in six steps, working entirely in the continuous-time domain before discretization.\n1736: \n1737: **Step 1: Decompose the Stratonovich drift.** By Definition [](#def-strat-drift), the Stratonovich drift of $V_{\\text{total}}(S_t)$ is:\n1738: \n1739: $$\n1740: A_{\\text{full}}(S) = A_{\\text{backbone}}(S) + A_{\\text{perturb}}(S)\n1741: \n1742: $$\n1743: \n1744: where $A_{\\text{backbone}}$ is the drift of the backbone system (Section 5) and $A_{\\text{perturb}}$ is the perturbative contribution from the adaptive terms (Chapter 6).\n1745: \n1746: **Step 2: Establish the continuous-time backbone drift inequality.** The backbone system (with $\\epsilon_F = 0$, $\\nu = 0$, $\\Sigma_{\\text{reg}} = \\sigma I$) satisfies a continuous-time drift inequality. From the analysis in [04_convergence.md](../1_euclidean_gas/06_convergence.md), adapted to Stratonovich calculus, the expected drift satisfies:\n1747: \n1748: $$\n1749: \\mathbb{E}[A_{\\text{backbone}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}}\n1750: \n1751: $$\n1752: \n1753: for some $\\kappa_{\\text{backbone}} > 0$ and $C_{\\text{backbone}} < \\infty$.\n1754: \n1755: **Justification:** The backbone convergence was originally proven using discrete-time analysis. The continuous-time drift bound can be recovered by considering the infinitesimal time evolution:\n1756: \n1757: $$\n1758: \\frac{d}{dt} \\mathbb{E}[V_{\\text{total}}(S_t)] = \\mathbb{E}[A_{\\text{backbone}}(S_t)]\n1759: \n1760: $$\n1761: \n1762: The discrete-time bound $\\mathbb{E}[V'] \\le (1 - \\kappa \\Delta t) V + C \\Delta t$ implies, in the limit $\\Delta t \\to 0$, the continuous-time inequality $\\mathbb{E}[A] \\le -\\kappa V + C$.\n1763: \n1764: **Step 3: Bound the perturbative contribution (ρ-dependent).** By Corollary {prf:ref}`cor-total-perturbation`, the perturbative drift satisfies:\n1765: \n1766: $$\n1767: A_{\\text{perturb}}(S) \\le (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho))\n1768: \n1769: $$\n1770: \n1771: **Step 4: Combine the drift inequalities.** Adding Steps 2 and 3:\n1772: \n1773: $$\n1774: \\begin{aligned}\n1775: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] &= \\mathbb{E}[A_{\\text{backbone}}(S_t) + A_{\\text{perturb}}(S_t) \\mid S_t] \\\\\n1776: &\\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}} \\\\\n1777: &\\quad + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S_t) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)) \\\\\n1778: &= [- \\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)] V_{\\text{total}}(S_t) \\\\\n1779: &\\quad + [C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)]\n1780: \\end{aligned}\n1781: \n1782: $$\n1783: \n1784: **Step 5: Choose $\\epsilon_F$ to ensure negative drift (ρ-dependent threshold).** Define:\n1785: \n1786: $$\n1787: \\epsilon_F^*(\\rho) := \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2 K_F(\\rho)}\n1788: \n1789: $$\n1790: \n1791: (assuming $\\kappa_{\\text{backbone}} > C_{\\text{diff,1}}(\\rho)$, which holds for sufficiently strong backbone parameters and any finite ρ > 0).\n1792: \n1793: For any $0 \\le \\epsilon_F < \\epsilon_F^*(\\rho)$, we have:\n1794: \n1795: $$\n1796: \\begin{aligned}\n1797: &-\\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho) \\\\\n1798: &< -\\kappa_{\\text{backbone}} + \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} + C_{\\text{diff,1}}(\\rho) \\\\\n1799: &= -\\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} < 0\n1800: \\end{aligned}\n1801: \n1802: $$\n1803: \n1804: Define:\n1805: \n1806: $$\n1807: \\kappa_{\\text{total}}(\\rho) := \\kappa_{\\text{backbone}} - \\epsilon_F K_F(\\rho) - C_{\\text{diff,1}}(\\rho) > 0\n1808: \n1809: $$\n1810: \n1811: $$\n1812: C_{\\text{total}}(\\rho) := C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho) < \\infty\n1813: \n1814: $$\n1815: \n1816: Then the continuous-time drift inequality for the full system is:\n1817: \n1818: $$\n1819: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{total}}(\\rho) V_{\\text{total}}(S_t) + C_{\\text{total}}(\\rho)\n1820: \n1821: $$\n1822: \n1823: **Step 6: Discretization (Justification for Adaptive System).**\n1824: \n1825: The Discretization Theorem (Theorem 1.7.2 in `04_convergence.md`) relates continuous-time drift inequalities to discrete-time Foster-Lyapunov conditions. However, that theorem was stated for the **backbone system** with constant diffusion $\\sigma I$. We must verify its hypotheses hold for the **adaptive system** with state-dependent diffusion $\\Sigma_{\\text{reg}}(x_i, S)$.\n1826: \n1827: **Key Requirements for the Discretization Theorem:**\n1828: 1. **Bounded derivatives of Lyapunov function:** $\\|\\nabla V_{\\text{total}}\\|$, $\\|\\nabla^2 V_{\\text{total}}\\|$ must be polynomially bounded\n1829: 2. **Bounded drift and diffusion:** The SDE coefficients must satisfy global Lipschitz and linear growth conditions\n1830: 3. **Regularity of integrator:** The BAOAB splitting integrator must have bounded weak error\n1831: \n1832: **Verification for the Adaptive System:**\n1833: \n1834: **Requirement 1 (Lyapunov Regularity):** The Lyapunov function $V_{\\text{total}}$ is a quadratic form in $(x, v)$ (variances and mean distances). Therefore:\n1835: - $\\nabla V_{\\text{total}}$ grows at most linearly: $\\|\\nabla V_{\\text{total}}(S)\\| \\le C_{\\nabla}(V_{\\text{total}}(S) + 1)$ (proven in Chapter 6, Lemma {prf:ref}`lem-adaptive-force-bounded`)\n1836: - $\\nabla^2 V_{\\text{total}}$ is uniformly bounded: $\\|\\nabla^2 V_{\\text{total}}\\| \\le C_{\\nabla^2} < \\infty$ (V is quadratic)\n1837: \n1838: **Requirement 2 (SDE Regularity):**\n1839: - **Drift boundedness:** By Appendix A (Theorem {prf:ref}`thm-c1-regularity`), $\\|\\mathbf{F}_{\\text{adapt}}\\| \\le \\epsilon_F F_{\\text{adapt,max}}(\\rho)$ is **N-uniform** and ρ-dependent. The viscous force is similarly bounded. The confining force $-\\nabla U$ has at most linear growth.\n1840: - **Diffusion boundedness:** By Theorem {prf:ref}`thm-ueph`, the regularized diffusion satisfies $c_{\\min}(\\rho) I \\preceq D_{\\text{reg}} \\preceq c_{\\max}(\\rho) I$ with **N-uniform** bounds.\n1841: - **Lipschitz continuity:** Established in Corollary {prf:ref}`cor-wellposed` (Step 1 of its proof)\n1842: \n1843: **Requirement 3 (Integrator Weak Error):** The BAOAB integrator used in `04_convergence.md` has weak error $O(\\Delta t^2)$ for SDEs with smooth coefficients (Leimkuhler-Matthews, \"Molecular Dynamics\", 2015). Since our adaptive drift and diffusion are smooth (C¹ and C² by Appendix A), the BAOAB integrator maintains its $O(\\Delta t^2)$ weak error bound.\n1844: \n1845: **Conclusion:** All hypotheses of the Discretization Theorem are satisfied by the adaptive system. The N-uniform bounds from Appendix A are crucial here - without them, the weak error analysis could fail as $N \\to \\infty$.\n1846: \n1847: Therefore, the continuous-time drift inequality implies the discrete-time Foster-Lyapunov condition:\n1848: \n1849: $$\n1850: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}} \\Delta t + O(\\Delta t^2)) V_{\\text{total}}(S_k) + (C_{\\text{total}} \\Delta t + O(\\Delta t^2))\n1851: \n1852: $$\n1853: \n1854: For sufficiently small $\\Delta t$, the $O(\\Delta t^2)$ terms can be absorbed, yielding:\n1855: \n1856: $$\n1857: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}}) V_{\\text{total}}(S_k) + C_{\\text{total}}\n1858: \n1859: $$\n1860: \n1861: where we redefine $\\kappa_{\\text{total}} := \\kappa_{\\text{total}} \\Delta t$ and $C_{\\text{total}} := C_{\\text{total}} \\Delta t$ for the discrete-time version.\n1862: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 10,
        "chapter_file": "chapter_10.json",
        "section_id": "## 7. Foster-Lyapunov Drift for the Full Adaptive System"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-cor-entropy-convergence-lsi",
      "title": null,
      "start_line": 2250,
      "end_line": 2268,
      "header_lines": [
        2251
      ],
      "content_start": 2253,
      "content_end": 2267,
      "content": "2253: :label: proof-cor-entropy-convergence-lsi\n2254: \n2255: The LSI, combined with the entropy dissipation identity:\n2256: \n2257: $$\n2258: \\frac{d}{dt} \\text{Ent}_{\\nu_N^{\\text{QSD}}}(\\mu_t) = -\\mathcal{I}[\\mu_t]\n2259: \n2260: $$\n2261: \n2262: where $\\mathcal{I}[\\mu] := \\int \\Gamma_N(\\sqrt{h}) \\, d\\nu$ is the Fisher information and $h = d\\mu/d\\nu$, yields:\n2263: \n2264: $$\n2265: \\frac{d}{dt} \\text{Ent} \\le -\\frac{1}{C_{\\text{LSI}}} \\text{Ent}\n2266: \n2267: $$",
      "metadata": {
        "label": "proof-cor-entropy-convergence-lsi"
      },
      "section": "## 8. The Logarithmic Sobolev Inequality: A Conjectured Strengthening",
      "references": [],
      "raw_directive": "2250: :::\n2251: \n2252: :::{prf:proof}\n2253: :label: proof-cor-entropy-convergence-lsi\n2254: \n2255: The LSI, combined with the entropy dissipation identity:\n2256: \n2257: $$\n2258: \\frac{d}{dt} \\text{Ent}_{\\nu_N^{\\text{QSD}}}(\\mu_t) = -\\mathcal{I}[\\mu_t]\n2259: \n2260: $$\n2261: \n2262: where $\\mathcal{I}[\\mu] := \\int \\Gamma_N(\\sqrt{h}) \\, d\\nu$ is the Fisher information and $h = d\\mu/d\\nu$, yields:\n2263: \n2264: $$\n2265: \\frac{d}{dt} \\text{Ent} \\le -\\frac{1}{C_{\\text{LSI}}} \\text{Ent}\n2266: \n2267: $$\n2268: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 11,
        "chapter_file": "chapter_11.json",
        "section_id": "## 8. The Logarithmic Sobolev Inequality: A Conjectured Strengthening"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-qsd-existence",
      "title": "Proof sketch",
      "start_line": 2361,
      "end_line": 2370,
      "header_lines": [
        2362
      ],
      "content_start": 2364,
      "content_end": 2369,
      "content": "2364: :label: proof-thm-qsd-existence\n2365: \n2366: The Foster-Lyapunov drift condition (Theorem [](#thm-fl-drift-adaptive)) implies:\n2367: 1. **Petite set property:** The swarm is irreducible and aperiodic by the same arguments as in [04_convergence.md](../1_euclidean_gas/06_convergence.md) (positive diffusion, global potential, cloning operator mixing).\n2368: 2. **Geometric ergodicity:** By the standard Foster-Lyapunov theorem (Meyn & Tweedie, Chapter 15), the drift condition implies the existence of a unique invariant measure $\\pi_{\\text{QSD}}$ and exponential convergence in the Lyapunov norm.\n2369: 3. **Total variation convergence:** By the relationship between Lyapunov convergence and total variation (Theorem 16.0.1 in Meyn & Tweedie), geometric ergodicity in the Lyapunov norm implies exponential convergence in total variation.",
      "metadata": {
        "label": "proof-thm-qsd-existence"
      },
      "section": "## 9. Main Convergence Theorems and Physical Interpretation",
      "references": [],
      "raw_directive": "2361: :::\n2362: \n2363: :::{prf:proof} Proof sketch\n2364: :label: proof-thm-qsd-existence\n2365: \n2366: The Foster-Lyapunov drift condition (Theorem [](#thm-fl-drift-adaptive)) implies:\n2367: 1. **Petite set property:** The swarm is irreducible and aperiodic by the same arguments as in [04_convergence.md](../1_euclidean_gas/06_convergence.md) (positive diffusion, global potential, cloning operator mixing).\n2368: 2. **Geometric ergodicity:** By the standard Foster-Lyapunov theorem (Meyn & Tweedie, Chapter 15), the drift condition implies the existence of a unique invariant measure $\\pi_{\\text{QSD}}$ and exponential convergence in the Lyapunov norm.\n2369: 3. **Total variation convergence:** By the relationship between Lyapunov convergence and total variation (Theorem 16.0.1 in Meyn & Tweedie), geometric ergodicity in the Lyapunov norm implies exponential convergence in total variation.\n2370: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 9. Main Convergence Theorems and Physical Interpretation"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-macro-transport",
      "title": null,
      "start_line": 2640,
      "end_line": 2713,
      "header_lines": [
        2641
      ],
      "content_start": 2643,
      "content_end": 2712,
      "content": "2643: :label: proof-lem-macro-transport\n2644: \n2645: This proof follows the classical hypocoercivity approach of Villani (2009) adapted to the QSD setting. The key steps are:\n2646: \n2647: **Preliminary Lemmas**:\n2648: \n2649: *Lemma A (Position Poincaré)*: Under Assumptions A1 (uniform convexity) and A3 (bounded perturbation), the position marginal $\\rho_x$ satisfies a Poincaré inequality:\n2650: \n2651: $$\n2652: \\|a\\|^2_{L^2(\\rho_x)} \\le \\frac{1}{\\kappa_x} \\|\\nabla_x a\\|^2_{L^2(\\rho_x)}\n2653: \n2654: $$\n2655: \n2656: for all mean-zero $a \\in H^1(\\rho_x)$, where $\\kappa_x \\ge \\kappa_{\\text{conf}} e^{-2 C_{\\text{pert}}}$ by the Holley-Stroock perturbation theorem.\n2657: \n2658: *Lemma B (Velocity Covariance)*: Under Assumption A2 (centered velocities), the conditional velocity covariance satisfies:\n2659: \n2660: $$\n2661: \\Sigma_v(x) := \\int v v^\\top \\rho_{\\text{QSD}}(v | x) \\, dv \\succeq c_v I\n2662: \n2663: $$\n2664: \n2665: where $c_v = \\frac{\\sigma^2}{2\\gamma}$ (derived via Lyapunov equation for the Ornstein-Uhlenbeck velocity process).\n2666: \n2667: *Lemma C (Orthogonality)*: Under Assumption A2, for any function $a(x)$ depending only on position:\n2668: \n2669: $$\n2670: \\Pi[v \\cdot \\nabla_x a] = 0\n2671: \n2672: $$\n2673: \n2674: **Main Proof**:\n2675: \n2676: **Step 1**: Apply position Poincaré to the centered macroscopic part $a(x) := \\Pi h(x) - 1$. By normalization $\\int h \\rho_{\\text{QSD}} = 1$, we have $\\int a \\rho_x = 0$, so:\n2677: \n2678: $$\n2679: \\|\\Pi h - 1\\|^2_{L^2(\\rho_x)} \\le \\frac{1}{\\kappa_x} \\|\\nabla_x (\\Pi h)\\|^2_{L^2(\\rho_x)}\n2680: \n2681: $$\n2682: \n2683: **Step 2**: Express position gradient via transport energy. Using the velocity covariance lower bound:\n2684: \n2685: $$\n2686: \\|\\nabla_x (\\Pi h)\\|^2_{L^2(\\rho_x)} \\le \\frac{1}{c_v} \\|v \\cdot \\nabla_x (\\Pi h)\\|^2_{L^2(\\rho_{\\text{QSD}})}\n2687: \n2688: $$\n2689: \n2690: **Step 3**: Combine Steps 1-2 to obtain macroscopic coercivity:\n2691: \n2692: $$\n2693: \\|\\Pi h - 1\\|^2_{L^2(\\rho_x)} \\le \\frac{1}{\\kappa_x c_v} \\|v \\cdot \\nabla_x (\\Pi h)\\|^2_{L^2(\\rho_{\\text{QSD}})}\n2694: \n2695: $$\n2696: \n2697: **Step 4**: Apply absorption technique. By Lemma C, $v \\cdot \\nabla_x (\\Pi h)$ is purely microscopic ($\\Pi[v \\cdot \\nabla_x (\\Pi h)] = 0$), so by Cauchy-Schwarz:\n2698: \n2699: $$\n2700: \\|v \\cdot \\nabla_x (\\Pi h)\\|_{L^2} \\ge \\frac{|\\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2}|}{\\|(I - \\Pi) h\\|_{L^2}}\n2701: \n2702: $$\n2703: \n2704: Using Young's inequality $ab \\le \\frac{a^2}{2\\epsilon} + \\frac{\\epsilon b^2}{2}$ with optimal choice $\\epsilon = 1$ yields the absorption form:\n2705: \n2706: $$\n2707: \\|\\Pi h - 1\\|^2_{L^2(\\rho_x)} \\le \\frac{2}{\\sqrt{\\kappa_x c_v}} |\\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2}| + \\frac{1}{\\kappa_x c_v} \\|(I - \\Pi) h\\|^2_{L^2}\n2708: \n2709: $$\n2710: \n2711: with $C_1 = \\frac{2}{\\sqrt{\\kappa_x c_v}}$ and $C_{\\text{aux}} = \\frac{1}{\\kappa_x c_v}$.\n2712: ",
      "metadata": {
        "label": "proof-lem-macro-transport"
      },
      "section": "## 9. Main Convergence Theorems and Physical Interpretation",
      "references": [],
      "raw_directive": "2640: :::\n2641: \n2642: :::{prf:proof}\n2643: :label: proof-lem-macro-transport\n2644: \n2645: This proof follows the classical hypocoercivity approach of Villani (2009) adapted to the QSD setting. The key steps are:\n2646: \n2647: **Preliminary Lemmas**:\n2648: \n2649: *Lemma A (Position Poincaré)*: Under Assumptions A1 (uniform convexity) and A3 (bounded perturbation), the position marginal $\\rho_x$ satisfies a Poincaré inequality:\n2650: \n2651: $$\n2652: \\|a\\|^2_{L^2(\\rho_x)} \\le \\frac{1}{\\kappa_x} \\|\\nabla_x a\\|^2_{L^2(\\rho_x)}\n2653: \n2654: $$\n2655: \n2656: for all mean-zero $a \\in H^1(\\rho_x)$, where $\\kappa_x \\ge \\kappa_{\\text{conf}} e^{-2 C_{\\text{pert}}}$ by the Holley-Stroock perturbation theorem.\n2657: \n2658: *Lemma B (Velocity Covariance)*: Under Assumption A2 (centered velocities), the conditional velocity covariance satisfies:\n2659: \n2660: $$\n2661: \\Sigma_v(x) := \\int v v^\\top \\rho_{\\text{QSD}}(v | x) \\, dv \\succeq c_v I\n2662: \n2663: $$\n2664: \n2665: where $c_v = \\frac{\\sigma^2}{2\\gamma}$ (derived via Lyapunov equation for the Ornstein-Uhlenbeck velocity process).\n2666: \n2667: *Lemma C (Orthogonality)*: Under Assumption A2, for any function $a(x)$ depending only on position:\n2668: \n2669: $$\n2670: \\Pi[v \\cdot \\nabla_x a] = 0\n2671: \n2672: $$\n2673: \n2674: **Main Proof**:\n2675: \n2676: **Step 1**: Apply position Poincaré to the centered macroscopic part $a(x) := \\Pi h(x) - 1$. By normalization $\\int h \\rho_{\\text{QSD}} = 1$, we have $\\int a \\rho_x = 0$, so:\n2677: \n2678: $$\n2679: \\|\\Pi h - 1\\|^2_{L^2(\\rho_x)} \\le \\frac{1}{\\kappa_x} \\|\\nabla_x (\\Pi h)\\|^2_{L^2(\\rho_x)}\n2680: \n2681: $$\n2682: \n2683: **Step 2**: Express position gradient via transport energy. Using the velocity covariance lower bound:\n2684: \n2685: $$\n2686: \\|\\nabla_x (\\Pi h)\\|^2_{L^2(\\rho_x)} \\le \\frac{1}{c_v} \\|v \\cdot \\nabla_x (\\Pi h)\\|^2_{L^2(\\rho_{\\text{QSD}})}\n2687: \n2688: $$\n2689: \n2690: **Step 3**: Combine Steps 1-2 to obtain macroscopic coercivity:\n2691: \n2692: $$\n2693: \\|\\Pi h - 1\\|^2_{L^2(\\rho_x)} \\le \\frac{1}{\\kappa_x c_v} \\|v \\cdot \\nabla_x (\\Pi h)\\|^2_{L^2(\\rho_{\\text{QSD}})}\n2694: \n2695: $$\n2696: \n2697: **Step 4**: Apply absorption technique. By Lemma C, $v \\cdot \\nabla_x (\\Pi h)$ is purely microscopic ($\\Pi[v \\cdot \\nabla_x (\\Pi h)] = 0$), so by Cauchy-Schwarz:\n2698: \n2699: $$\n2700: \\|v \\cdot \\nabla_x (\\Pi h)\\|_{L^2} \\ge \\frac{|\\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2}|}{\\|(I - \\Pi) h\\|_{L^2}}\n2701: \n2702: $$\n2703: \n2704: Using Young's inequality $ab \\le \\frac{a^2}{2\\epsilon} + \\frac{\\epsilon b^2}{2}$ with optimal choice $\\epsilon = 1$ yields the absorption form:\n2705: \n2706: $$\n2707: \\|\\Pi h - 1\\|^2_{L^2(\\rho_x)} \\le \\frac{2}{\\sqrt{\\kappa_x c_v}} |\\langle (I - \\Pi) h, v \\cdot \\nabla_x (\\Pi h) \\rangle_{L^2}| + \\frac{1}{\\kappa_x c_v} \\|(I - \\Pi) h\\|^2_{L^2}\n2708: \n2709: $$\n2710: \n2711: with $C_1 = \\frac{2}{\\sqrt{\\kappa_x c_v}}$ and $C_{\\text{aux}} = \\frac{1}{\\kappa_x c_v}$.\n2712: \n2713: **References**: Villani (2009, Memoirs AMS), Hérau-Nier (2004, ARMA), Bakry-Gentil-Ledoux (2014), Holley-Stroock (1987). ∎",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 12,
        "chapter_file": "chapter_12.json",
        "section_id": "## 9. Main Convergence Theorems and Physical Interpretation"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-variance-to-gap-adaptive",
      "title": null,
      "start_line": 3651,
      "end_line": 3719,
      "header_lines": [
        3652
      ],
      "content_start": 3654,
      "content_end": 3718,
      "content": "3654: :label: proof-lem-variance-to-gap-adaptive\n3655: \n3656: **Strategy**: We define the support radius $R := \\sup_{x \\in \\text{supp}(X)} |x - \\mu|$ and show that the variance definition implies $\\sigma^2 \\le R^2$, from which the result follows by taking square roots.\n3657: \n3658: **Step 1: Define the support radius**\n3659: \n3660: Let\n3661: \n3662: $$\n3663: R := \\sup_{x \\in \\text{supp}(X)} |x - \\mu| \\in [0, \\infty]\n3664: \n3665: $$\n3666: \n3667: This supremum always exists in the extended real numbers. Since $\\sigma^2 > 0$, the support must contain at least two distinct points (otherwise variance would be zero), so $R$ is well-defined.\n3668: \n3669: **Interpretation**: For bounded support ($R < \\infty$), the continuous function $x \\mapsto |x - \\mu|$ attains its supremum on the compact support by the extreme value theorem, so $\\max = \\sup$. For unbounded support ($R = \\infty$), the inequality $R \\ge \\sigma$ is trivially satisfied.\n3670: \n3671: **Step 2: Bound variance by squared radius**\n3672: \n3673: By definition of $R$ as the supremum over the support:\n3674: \n3675: $$\n3676: |x - \\mu| \\le R \\quad \\text{for all } x \\in \\text{supp}(X)\n3677: \n3678: $$\n3679: \n3680: Since $X$ takes values only in its support (with probability 1), we have almost surely:\n3681: \n3682: $$\n3683: |X - \\mu| \\le R\n3684: \n3685: $$\n3686: \n3687: Squaring both sides:\n3688: \n3689: $$\n3690: (X - \\mu)^2 \\le R^2 \\quad \\text{almost surely}\n3691: \n3692: $$\n3693: \n3694: Taking expectations and using monotonicity of expectation:\n3695: \n3696: $$\n3697: \\mathbb{E}[(X - \\mu)^2] \\le \\mathbb{E}[R^2] = R^2\n3698: \n3699: $$\n3700: \n3701: By definition of variance, $\\sigma^2 = \\mathbb{E}[(X - \\mu)^2]$, so:\n3702: \n3703: $$\n3704: \\sigma^2 \\le R^2\n3705: \n3706: $$\n3707: \n3708: If $R = \\infty$, then $R^2 = \\infty$ and the inequality holds trivially.\n3709: \n3710: **Step 3: Conclude $\\sigma \\le R$**\n3711: \n3712: From $\\sigma^2 \\le R^2$ with $\\sigma, R \\ge 0$, we apply the monotonicity of the square root function:\n3713: \n3714: $$\n3715: \\sigma \\le R = \\sup_{x \\in \\text{supp}(X)} |x - \\mu|\n3716: \n3717: $$\n3718: ",
      "metadata": {
        "label": "proof-lem-variance-to-gap-adaptive"
      },
      "section": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model",
      "references": [],
      "raw_directive": "3651: :::\n3652: \n3653: :::{prf:proof}\n3654: :label: proof-lem-variance-to-gap-adaptive\n3655: \n3656: **Strategy**: We define the support radius $R := \\sup_{x \\in \\text{supp}(X)} |x - \\mu|$ and show that the variance definition implies $\\sigma^2 \\le R^2$, from which the result follows by taking square roots.\n3657: \n3658: **Step 1: Define the support radius**\n3659: \n3660: Let\n3661: \n3662: $$\n3663: R := \\sup_{x \\in \\text{supp}(X)} |x - \\mu| \\in [0, \\infty]\n3664: \n3665: $$\n3666: \n3667: This supremum always exists in the extended real numbers. Since $\\sigma^2 > 0$, the support must contain at least two distinct points (otherwise variance would be zero), so $R$ is well-defined.\n3668: \n3669: **Interpretation**: For bounded support ($R < \\infty$), the continuous function $x \\mapsto |x - \\mu|$ attains its supremum on the compact support by the extreme value theorem, so $\\max = \\sup$. For unbounded support ($R = \\infty$), the inequality $R \\ge \\sigma$ is trivially satisfied.\n3670: \n3671: **Step 2: Bound variance by squared radius**\n3672: \n3673: By definition of $R$ as the supremum over the support:\n3674: \n3675: $$\n3676: |x - \\mu| \\le R \\quad \\text{for all } x \\in \\text{supp}(X)\n3677: \n3678: $$\n3679: \n3680: Since $X$ takes values only in its support (with probability 1), we have almost surely:\n3681: \n3682: $$\n3683: |X - \\mu| \\le R\n3684: \n3685: $$\n3686: \n3687: Squaring both sides:\n3688: \n3689: $$\n3690: (X - \\mu)^2 \\le R^2 \\quad \\text{almost surely}\n3691: \n3692: $$\n3693: \n3694: Taking expectations and using monotonicity of expectation:\n3695: \n3696: $$\n3697: \\mathbb{E}[(X - \\mu)^2] \\le \\mathbb{E}[R^2] = R^2\n3698: \n3699: $$\n3700: \n3701: By definition of variance, $\\sigma^2 = \\mathbb{E}[(X - \\mu)^2]$, so:\n3702: \n3703: $$\n3704: \\sigma^2 \\le R^2\n3705: \n3706: $$\n3707: \n3708: If $R = \\infty$, then $R^2 = \\infty$ and the inequality holds trivially.\n3709: \n3710: **Step 3: Conclude $\\sigma \\le R$**\n3711: \n3712: From $\\sigma^2 \\le R^2$ with $\\sigma, R \\ge 0$, we apply the monotonicity of the square root function:\n3713: \n3714: $$\n3715: \\sigma \\le R = \\sup_{x \\in \\text{supp}(X)} |x - \\mu|\n3716: \n3717: $$\n3718: \n3719: For bounded support, this supremum is attained by Step 1, yielding the statement of the lemma. ∎",
      "_registry_context": {
        "stage": "directives",
        "document_id": "11_geometric_gas",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix B: Verification of the Keystone Principle for the Adaptive Model"
      }
    }
  ]
}