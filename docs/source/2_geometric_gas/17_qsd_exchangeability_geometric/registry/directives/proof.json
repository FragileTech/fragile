{
  "document_id": "17_qsd_exchangeability_geometric",
  "stage": "directives",
  "directive_type": "proof",
  "generated_at": "2025-11-09T21:44:26.243531+00:00",
  "count": 3,
  "items": [
    {
      "directive_type": "proof",
      "label": "proof-lem-conditional-multivariate-gaussian-geometric",
      "title": null,
      "start_line": 59,
      "end_line": 99,
      "header_lines": [
        60
      ],
      "content_start": 61,
      "content_end": 98,
      "content": "61: :::{prf:proof}\n62: :label: proof-lem-conditional-multivariate-gaussian-geometric\n63: Consider the velocity dynamics with positions fixed at $\\mathbf{x}$. In vector form with $\\mathbf{V} = (v_1, \\ldots, v_N) \\in \\mathbb{R}^{3N}$:\n64: \n65: $$\n66: d\\mathbf{V} = -A(\\mathbf{x}) \\mathbf{V} \\, dt + B(\\mathbf{x}) d\\mathbf{W}\n67: $$\n68: \n69: **Structure of $A(\\mathbf{x})$:**\n70: The drift matrix has the form:\n71: \n72: $$\n73: A(\\mathbf{x}) = \\gamma I_{3N} + \\nu \\mathcal{L}_{\\text{norm}}(\\mathbf{x}) \\otimes I_3\n74: $$\n75: \n76: where:\n77: - $\\gamma I_{3N}$ is friction (scalar times identity)\n78: - $\\mathcal{L}_{\\text{norm}}(\\mathbf{x})$ is the normalized graph Laplacian: $\\mathcal{L}_{\\text{norm},ij} = \\delta_{ij} - K(x_i-x_j)/\\deg(i)$ for $i \\neq j$\n79: - $\\otimes I_3$ indicates the Laplacian acts on particle indices, with each velocity component treated identically\n80: \n81: **Structure of $B(\\mathbf{x})$:**\n82: The noise matrix is block diagonal:\n83: \n84: $$\n85: B(\\mathbf{x}) = \\begin{pmatrix}\n86: \\Sigma_{\\text{reg}}(x_1, \\mathbf{x}) & 0 & \\cdots & 0 \\\\\n87: 0 & \\Sigma_{\\text{reg}}(x_2, \\mathbf{x}) & \\cdots & 0 \\\\\n88: \\vdots & \\vdots & \\ddots & \\vdots \\\\\n89: 0 & 0 & \\cdots & \\Sigma_{\\text{reg}}(x_N, \\mathbf{x})\n90: \\end{pmatrix}\n91: $$\n92: \n93: **Stationary distribution:**\n94: This is a linear SDE with constant coefficients (for fixed $\\mathbf{x}$). The stationary distribution is Gaussian $\\mathcal{N}(0, \\Sigma_{\\mathbf{v}}(\\mathbf{x}))$ where the covariance solves the continuous Lyapunov equation (standard result from stochastic analysis):\n95: \n96: $$\n97: A(\\mathbf{x}) \\Sigma_{\\mathbf{v}}(\\mathbf{x}) + \\Sigma_{\\mathbf{v}}(\\mathbf{x}) A(\\mathbf{x})^T = B(\\mathbf{x}) B(\\mathbf{x})^T\n98: $$",
      "metadata": {
        "label": "proof-lem-conditional-multivariate-gaussian-geometric"
      },
      "section": "## 2. Conditional Velocity Distribution with Viscous Coupling",
      "references": [],
      "raw_directive": "59: :::\n60: \n61: :::{prf:proof}\n62: :label: proof-lem-conditional-multivariate-gaussian-geometric\n63: Consider the velocity dynamics with positions fixed at $\\mathbf{x}$. In vector form with $\\mathbf{V} = (v_1, \\ldots, v_N) \\in \\mathbb{R}^{3N}$:\n64: \n65: $$\n66: d\\mathbf{V} = -A(\\mathbf{x}) \\mathbf{V} \\, dt + B(\\mathbf{x}) d\\mathbf{W}\n67: $$\n68: \n69: **Structure of $A(\\mathbf{x})$:**\n70: The drift matrix has the form:\n71: \n72: $$\n73: A(\\mathbf{x}) = \\gamma I_{3N} + \\nu \\mathcal{L}_{\\text{norm}}(\\mathbf{x}) \\otimes I_3\n74: $$\n75: \n76: where:\n77: - $\\gamma I_{3N}$ is friction (scalar times identity)\n78: - $\\mathcal{L}_{\\text{norm}}(\\mathbf{x})$ is the normalized graph Laplacian: $\\mathcal{L}_{\\text{norm},ij} = \\delta_{ij} - K(x_i-x_j)/\\deg(i)$ for $i \\neq j$\n79: - $\\otimes I_3$ indicates the Laplacian acts on particle indices, with each velocity component treated identically\n80: \n81: **Structure of $B(\\mathbf{x})$:**\n82: The noise matrix is block diagonal:\n83: \n84: $$\n85: B(\\mathbf{x}) = \\begin{pmatrix}\n86: \\Sigma_{\\text{reg}}(x_1, \\mathbf{x}) & 0 & \\cdots & 0 \\\\\n87: 0 & \\Sigma_{\\text{reg}}(x_2, \\mathbf{x}) & \\cdots & 0 \\\\\n88: \\vdots & \\vdots & \\ddots & \\vdots \\\\\n89: 0 & 0 & \\cdots & \\Sigma_{\\text{reg}}(x_N, \\mathbf{x})\n90: \\end{pmatrix}\n91: $$\n92: \n93: **Stationary distribution:**\n94: This is a linear SDE with constant coefficients (for fixed $\\mathbf{x}$). The stationary distribution is Gaussian $\\mathcal{N}(0, \\Sigma_{\\mathbf{v}}(\\mathbf{x}))$ where the covariance solves the continuous Lyapunov equation (standard result from stochastic analysis):\n95: \n96: $$\n97: A(\\mathbf{x}) \\Sigma_{\\mathbf{v}}(\\mathbf{x}) + \\Sigma_{\\mathbf{v}}(\\mathbf{x}) A(\\mathbf{x})^T = B(\\mathbf{x}) B(\\mathbf{x})^T\n98: $$\n99: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "17_qsd_exchangeability_geometric",
        "chapter_index": 2,
        "chapter_file": "chapter_2.json",
        "section_id": "## 2. Conditional Velocity Distribution with Viscous Coupling"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-eigenvalue-bound-geometric",
      "title": null,
      "start_line": 123,
      "end_line": 179,
      "header_lines": [
        124
      ],
      "content_start": 125,
      "content_end": 178,
      "content": "125: :::{prf:proof}\n126: :label: proof-lem-eigenvalue-bound-geometric\n127: We bound $\\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x}))$ using properties of the Lyapunov equation and a comparison argument.\n128: \n129: **Step 1 (Lyapunov equation structure):**\n130: Recall that $\\Sigma_{\\mathbf{v}}(\\mathbf{x})$ solves:\n131: \n132: $$\n133: A(\\mathbf{x}) \\Sigma_{\\mathbf{v}}(\\mathbf{x}) + \\Sigma_{\\mathbf{v}}(\\mathbf{x}) A(\\mathbf{x})^T = B(\\mathbf{x}) B(\\mathbf{x})^T\n134: $$\n135: \n136: where:\n137: - $A(\\mathbf{x}) = \\gamma I_{3N} + \\nu \\mathcal{L}_{\\text{norm}}(\\mathbf{x}) \\otimes I_3$\n138: - $B(\\mathbf{x})B(\\mathbf{x})^T = \\text{diag}(\\Sigma_{\\text{reg}}^2(x_1, \\mathbf{x}), \\ldots, \\Sigma_{\\text{reg}}^2(x_N, \\mathbf{x}))$\n139: \n140: **Step 2 (Positive definiteness of $A$):**\n141: The matrix $A(\\mathbf{x})$ is positive definite because:\n142: - $\\gamma I_{3N}$ is positive definite with eigenvalues $\\gamma > 0$\n143: - $\\mathcal{L}_{\\text{norm}}(\\mathbf{x})$ is a normalized graph Laplacian with eigenvalues in $[0, 2]$\n144: - Therefore $A$ has eigenvalues in $[\\gamma, \\gamma + 2\\nu]$, all strictly positive\n145: \n146: **Step 3 (Comparison with uncoupled system):**\n147: Consider the uncoupled system ($\\nu = 0$), where $A_0 = \\gamma I_{3N}$ and the Lyapunov equation becomes:\n148: \n149: $$\n150: \\gamma \\Sigma_0 + \\Sigma_0 \\gamma = BB^T \\implies \\Sigma_0 = \\frac{1}{2\\gamma} BB^T\n151: $$\n152: \n153: This is block diagonal: $\\Sigma_0 = \\text{diag}(\\Sigma_{\\text{reg}}^2(x_1, \\mathbf{x})/(2\\gamma), \\ldots)$.\n154: \n155: The largest eigenvalue is:\n156: \n157: $$\n158: \\lambda_{\\max}(\\Sigma_0) = \\max_i \\lambda_{\\max}(\\Sigma_{\\text{reg}}^2(x_i, \\mathbf{x}))/(2\\gamma) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma}\n159: $$\n160: \n161: by the uniform ellipticity bound from Theorem {prf:ref}`thm-ueph` in [11_geometric_gas.md](11_geometric_gas.md).\n162: \n163: **Step 4 (Monotonicity in $\\nu$ - Lyapunov Comparison Theorem):**\n164: \n165: **Key Claim:** Adding viscous coupling ($\\nu > 0$) **decreases** all eigenvalues of $\\Sigma_{\\mathbf{v}}$ because it increases the damping in $A$.\n166: \n167: **Proof of claim:** The normalized graph Laplacian $\\mathcal{L}_{\\text{norm}}$ is positive semidefinite. Adding $\\nu \\mathcal{L}_{\\text{norm}} \\otimes I_3$ to $\\gamma I_{3N}$ increases the effective damping for all modes.\n168: \n169: **Lyapunov Comparison Theorem** (Horn & Johnson, *Matrix Analysis*, Thm 6.3.8): If $A_1$, $A_2$ are stable matrices (eigenvalues with positive real part) with $A_1 \\succeq A_2$ in the Loewner order (positive definite ordering), and $\\Sigma_1$, $\\Sigma_2$ solve $A_i \\Sigma_i + \\Sigma_i A_i^T = C$ for the same $C$, then $\\Sigma_1 \\preceq \\Sigma_2$.\n170: \n171: Applying this with $A_1 = \\gamma I + \\nu \\mathcal{L}_{\\text{norm}} \\otimes I_3$ and $A_2 = \\gamma I$:\n172: - $A_1 \\succeq A_2$ (adding positive semidefinite matrix)\n173: - Both are stable\n174: - Therefore $\\Sigma_{\\mathbf{v}} \\preceq \\Sigma_0$, which implies:\n175: \n176: $$\n177: \\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x})) \\leq \\lambda_{\\max}(\\Sigma_0) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma}\n178: $$",
      "metadata": {
        "label": "proof-lem-eigenvalue-bound-geometric"
      },
      "section": "## 3. N-Uniform Eigenvalue Bound via Lyapunov Comparison",
      "references": [
        "thm-ueph"
      ],
      "raw_directive": "123: :::\n124: \n125: :::{prf:proof}\n126: :label: proof-lem-eigenvalue-bound-geometric\n127: We bound $\\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x}))$ using properties of the Lyapunov equation and a comparison argument.\n128: \n129: **Step 1 (Lyapunov equation structure):**\n130: Recall that $\\Sigma_{\\mathbf{v}}(\\mathbf{x})$ solves:\n131: \n132: $$\n133: A(\\mathbf{x}) \\Sigma_{\\mathbf{v}}(\\mathbf{x}) + \\Sigma_{\\mathbf{v}}(\\mathbf{x}) A(\\mathbf{x})^T = B(\\mathbf{x}) B(\\mathbf{x})^T\n134: $$\n135: \n136: where:\n137: - $A(\\mathbf{x}) = \\gamma I_{3N} + \\nu \\mathcal{L}_{\\text{norm}}(\\mathbf{x}) \\otimes I_3$\n138: - $B(\\mathbf{x})B(\\mathbf{x})^T = \\text{diag}(\\Sigma_{\\text{reg}}^2(x_1, \\mathbf{x}), \\ldots, \\Sigma_{\\text{reg}}^2(x_N, \\mathbf{x}))$\n139: \n140: **Step 2 (Positive definiteness of $A$):**\n141: The matrix $A(\\mathbf{x})$ is positive definite because:\n142: - $\\gamma I_{3N}$ is positive definite with eigenvalues $\\gamma > 0$\n143: - $\\mathcal{L}_{\\text{norm}}(\\mathbf{x})$ is a normalized graph Laplacian with eigenvalues in $[0, 2]$\n144: - Therefore $A$ has eigenvalues in $[\\gamma, \\gamma + 2\\nu]$, all strictly positive\n145: \n146: **Step 3 (Comparison with uncoupled system):**\n147: Consider the uncoupled system ($\\nu = 0$), where $A_0 = \\gamma I_{3N}$ and the Lyapunov equation becomes:\n148: \n149: $$\n150: \\gamma \\Sigma_0 + \\Sigma_0 \\gamma = BB^T \\implies \\Sigma_0 = \\frac{1}{2\\gamma} BB^T\n151: $$\n152: \n153: This is block diagonal: $\\Sigma_0 = \\text{diag}(\\Sigma_{\\text{reg}}^2(x_1, \\mathbf{x})/(2\\gamma), \\ldots)$.\n154: \n155: The largest eigenvalue is:\n156: \n157: $$\n158: \\lambda_{\\max}(\\Sigma_0) = \\max_i \\lambda_{\\max}(\\Sigma_{\\text{reg}}^2(x_i, \\mathbf{x}))/(2\\gamma) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma}\n159: $$\n160: \n161: by the uniform ellipticity bound from Theorem {prf:ref}`thm-ueph` in [11_geometric_gas.md](11_geometric_gas.md).\n162: \n163: **Step 4 (Monotonicity in $\\nu$ - Lyapunov Comparison Theorem):**\n164: \n165: **Key Claim:** Adding viscous coupling ($\\nu > 0$) **decreases** all eigenvalues of $\\Sigma_{\\mathbf{v}}$ because it increases the damping in $A$.\n166: \n167: **Proof of claim:** The normalized graph Laplacian $\\mathcal{L}_{\\text{norm}}$ is positive semidefinite. Adding $\\nu \\mathcal{L}_{\\text{norm}} \\otimes I_3$ to $\\gamma I_{3N}$ increases the effective damping for all modes.\n168: \n169: **Lyapunov Comparison Theorem** (Horn & Johnson, *Matrix Analysis*, Thm 6.3.8): If $A_1$, $A_2$ are stable matrices (eigenvalues with positive real part) with $A_1 \\succeq A_2$ in the Loewner order (positive definite ordering), and $\\Sigma_1$, $\\Sigma_2$ solve $A_i \\Sigma_i + \\Sigma_i A_i^T = C$ for the same $C$, then $\\Sigma_1 \\preceq \\Sigma_2$.\n170: \n171: Applying this with $A_1 = \\gamma I + \\nu \\mathcal{L}_{\\text{norm}} \\otimes I_3$ and $A_2 = \\gamma I$:\n172: - $A_1 \\succeq A_2$ (adding positive semidefinite matrix)\n173: - Both are stable\n174: - Therefore $\\Sigma_{\\mathbf{v}} \\preceq \\Sigma_0$, which implies:\n175: \n176: $$\n177: \\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x})) \\leq \\lambda_{\\max}(\\Sigma_0) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma}\n178: $$\n179: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "17_qsd_exchangeability_geometric",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. N-Uniform Eigenvalue Bound via Lyapunov Comparison"
      }
    },
    {
      "directive_type": "proof",
      "label": "proof-thm-poincare-geometric",
      "title": null,
      "start_line": 209,
      "end_line": 241,
      "header_lines": [
        210
      ],
      "content_start": 211,
      "content_end": 240,
      "content": "211: :::{prf:proof}\n212: :label: proof-thm-poincare-geometric\n213: **Step 1 (Conditional Poincaré for multivariate Gaussian):**\n214: For any fixed $\\mathbf{x}$, the conditional distribution $\\pi_N(\\mathbf{v}|\\mathbf{x}) = \\mathcal{N}(0, \\Sigma_{\\mathbf{v}}(\\mathbf{x}))$ is a multivariate Gaussian. By Bakry-Émery (1985), it satisfies a Poincaré inequality:\n215: \n216: $$\n217: \\text{Var}_{\\pi_N(\\mathbf{v}|\\mathbf{x})}(g) \\leq \\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x})) \\int |\\nabla_{\\mathbf{v}} g|^2 d\\pi_N(\\mathbf{v}|\\mathbf{x})\n218: $$\n219: \n220: where $\\nabla_{\\mathbf{v}} = (\\nabla_{v_1}, \\ldots, \\nabla_{v_N})$ and $|\\nabla_{\\mathbf{v}} g|^2 = \\sum_{i=1}^N |\\nabla_{v_i} g|^2$.\n221: \n222: **Step 2 (Apply N-uniform bound):**\n223: By Lemma {prf:ref}`lem-eigenvalue-bound-geometric`, $\\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x})) \\leq c_{\\max}^2(\\rho)/(2\\gamma)$ uniformly in $\\mathbf{x}$, $N$, and $\\nu$. Therefore:\n224: \n225: $$\n226: \\text{Var}_{\\pi_N(\\mathbf{v}|\\mathbf{x})}(g) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma} \\sum_{i=1}^N \\int |\\nabla_{v_i} g|^2 d\\pi_N(\\mathbf{v}|\\mathbf{x})\n227: $$\n228: \n229: **Step 3 (Extend to marginal via Holley-Stroock):**\n230: The marginal velocity distribution $\\pi_N^{\\text{vel}}(\\mathbf{v}) = \\int \\pi_N(\\mathbf{x}, \\mathbf{v}) d\\mathbf{x}$ is a mixture of these conditional Gaussians (mixing over $\\mathbf{x}$). By Holley-Stroock (1987), the Poincaré constant for a mixture is bounded by the supremum of the Poincaré constants of the components:\n231: \n232: $$\n233: C_P(\\pi_N^{\\text{vel}}) \\leq \\sup_{\\mathbf{x}} C_P(\\pi_N(\\mathbf{v}|\\mathbf{x})) = \\sup_{\\mathbf{x}} \\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x})) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma}\n234: $$\n235: \n236: Therefore, for functions of velocity only:\n237: \n238: $$\n239: \\text{Var}_{\\pi_N^{\\text{vel}}}(g) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma} \\sum_{i=1}^N \\int |\\nabla_{v_i} g|^2 d\\pi_N^{\\text{vel}}\n240: $$",
      "metadata": {
        "label": "proof-thm-poincare-geometric"
      },
      "section": "## 4. N-Uniform Poincaré Inequality for Geometric Gas",
      "references": [
        "lem-eigenvalue-bound-geometric"
      ],
      "raw_directive": "209: :::\n210: \n211: :::{prf:proof}\n212: :label: proof-thm-poincare-geometric\n213: **Step 1 (Conditional Poincaré for multivariate Gaussian):**\n214: For any fixed $\\mathbf{x}$, the conditional distribution $\\pi_N(\\mathbf{v}|\\mathbf{x}) = \\mathcal{N}(0, \\Sigma_{\\mathbf{v}}(\\mathbf{x}))$ is a multivariate Gaussian. By Bakry-Émery (1985), it satisfies a Poincaré inequality:\n215: \n216: $$\n217: \\text{Var}_{\\pi_N(\\mathbf{v}|\\mathbf{x})}(g) \\leq \\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x})) \\int |\\nabla_{\\mathbf{v}} g|^2 d\\pi_N(\\mathbf{v}|\\mathbf{x})\n218: $$\n219: \n220: where $\\nabla_{\\mathbf{v}} = (\\nabla_{v_1}, \\ldots, \\nabla_{v_N})$ and $|\\nabla_{\\mathbf{v}} g|^2 = \\sum_{i=1}^N |\\nabla_{v_i} g|^2$.\n221: \n222: **Step 2 (Apply N-uniform bound):**\n223: By Lemma {prf:ref}`lem-eigenvalue-bound-geometric`, $\\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x})) \\leq c_{\\max}^2(\\rho)/(2\\gamma)$ uniformly in $\\mathbf{x}$, $N$, and $\\nu$. Therefore:\n224: \n225: $$\n226: \\text{Var}_{\\pi_N(\\mathbf{v}|\\mathbf{x})}(g) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma} \\sum_{i=1}^N \\int |\\nabla_{v_i} g|^2 d\\pi_N(\\mathbf{v}|\\mathbf{x})\n227: $$\n228: \n229: **Step 3 (Extend to marginal via Holley-Stroock):**\n230: The marginal velocity distribution $\\pi_N^{\\text{vel}}(\\mathbf{v}) = \\int \\pi_N(\\mathbf{x}, \\mathbf{v}) d\\mathbf{x}$ is a mixture of these conditional Gaussians (mixing over $\\mathbf{x}$). By Holley-Stroock (1987), the Poincaré constant for a mixture is bounded by the supremum of the Poincaré constants of the components:\n231: \n232: $$\n233: C_P(\\pi_N^{\\text{vel}}) \\leq \\sup_{\\mathbf{x}} C_P(\\pi_N(\\mathbf{v}|\\mathbf{x})) = \\sup_{\\mathbf{x}} \\lambda_{\\max}(\\Sigma_{\\mathbf{v}}(\\mathbf{x})) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma}\n234: $$\n235: \n236: Therefore, for functions of velocity only:\n237: \n238: $$\n239: \\text{Var}_{\\pi_N^{\\text{vel}}}(g) \\leq \\frac{c_{\\max}^2(\\rho)}{2\\gamma} \\sum_{i=1}^N \\int |\\nabla_{v_i} g|^2 d\\pi_N^{\\text{vel}}\n240: $$\n241: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "17_qsd_exchangeability_geometric",
        "chapter_index": 4,
        "chapter_file": "chapter_4.json",
        "section_id": "## 4. N-Uniform Poincaré Inequality for Geometric Gas"
      }
    }
  ]
}