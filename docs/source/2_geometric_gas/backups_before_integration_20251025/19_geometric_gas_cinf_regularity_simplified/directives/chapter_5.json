{
  "chapter_index": 5,
  "section_id": "## 5. Inductive Step: From C^m to C^{m+1}",
  "directive_count": 6,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-telescoping-all-orders-cinf",
      "title": "Telescoping Identity at All Orders",
      "start_line": 429,
      "end_line": 447,
      "header_lines": [
        430
      ],
      "content_start": 432,
      "content_end": 446,
      "content": "432: :label: lem-telescoping-all-orders-cinf\n433: \n434: The normalized localization weights satisfy:\n435: \n436: $$\n437: \\sum_{j \\in A_k} \\nabla^m_{x_i} w_{ij}(\\rho) = 0 \\quad \\text{for all } m \\geq 1\n438: $$\n439: \n440: for all walker positions, swarm configurations, \u03c1 > 0, and derivative orders m.\n441: \n442: **Proof**: The normalization \u2211_{j \u2208 A_k} w_ij(\u03c1) = 1 holds identically for all x_i \u2208 X as a function of x_i. Since the sum is over a **finite set** A_k and each w_ij(\u03c1) is C\u221e in x_i (Assumption {prf:ref}`assump-cinf-primitives`), differentiation and summation commute:\n443: \n444: $$\n445: \\nabla^m_{x_i} \\left(\\sum_{j \\in A_k} w_{ij}(\\rho)\\right) = \\sum_{j \\in A_k} \\nabla^m_{x_i} w_{ij}(\\rho) = \\nabla^m_{x_i}(1) = 0\n446: $$",
      "metadata": {
        "label": "lem-telescoping-all-orders-cinf"
      },
      "section": "## 5. Inductive Step: From C^m to C^{m+1}",
      "raw_directive": "429: We now prove the inductive step: assuming V_fit \u2208 C^m with bound K_{V,m}(\u03c1), we prove V_fit \u2208 C^{m+1} with bound K_{V,m+1}(\u03c1).\n430: \n431: :::{prf:lemma} Telescoping Identity at All Orders\n432: :label: lem-telescoping-all-orders-cinf\n433: \n434: The normalized localization weights satisfy:\n435: \n436: $$\n437: \\sum_{j \\in A_k} \\nabla^m_{x_i} w_{ij}(\\rho) = 0 \\quad \\text{for all } m \\geq 1\n438: $$\n439: \n440: for all walker positions, swarm configurations, \u03c1 > 0, and derivative orders m.\n441: \n442: **Proof**: The normalization \u2211_{j \u2208 A_k} w_ij(\u03c1) = 1 holds identically for all x_i \u2208 X as a function of x_i. Since the sum is over a **finite set** A_k and each w_ij(\u03c1) is C\u221e in x_i (Assumption {prf:ref}`assump-cinf-primitives`), differentiation and summation commute:\n443: \n444: $$\n445: \\nabla^m_{x_i} \\left(\\sum_{j \\in A_k} w_{ij}(\\rho)\\right) = \\sum_{j \\in A_k} \\nabla^m_{x_i} w_{ij}(\\rho) = \\nabla^m_{x_i}(1) = 0\n446: $$\n447: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-mean-cinf-inductive",
      "title": "C^{m+1} Regularity of Localized Mean",
      "start_line": 449,
      "end_line": 487,
      "header_lines": [
        450
      ],
      "content_start": 452,
      "content_end": 486,
      "content": "452: :label: lem-mean-cinf-inductive\n453: \n454: Assume weights w_ij(\u03c1) are C^{m+1} in x_i with ||\u2207^{m+1} w_ij|| \u2264 W_{m+1}(\u03c1). Then the localized mean \u03bc_\u03c1[f_k, x_i] is C^{m+1} with:\n455: \n456: $$\n457: \\|\\nabla^{m+1}_{x_i} \\mu_\\rho\\| \\leq W_{m+1}(\\rho) \\cdot \\text{diam}(d)\n458: $$\n459: \n460: independent of k and N, where diam(d) = sup_{x,y \u2208 X} |d(x) - d(y)| < \u221e.\n461: \n462: **Proof**: For the simplified model where d depends only on x_j (not x_i for j \u2260 i):\n463: \n464: $$\n465: \\mu_\\rho = \\sum_{j \\in A_k} w_{ij}(\\rho) \\cdot d(x_j)\n466: $$\n467: \n468: Differentiating (m+1) times:\n469: \n470: $$\n471: \\nabla^{m+1}_{x_i} \\mu_\\rho = \\sum_{j \\in A_k} \\nabla^{m+1}_{x_i} w_{ij}(\\rho) \\cdot d(x_j)\n472: $$\n473: \n474: (Terms with \u2207_{x_i} d(x_j) vanish for j \u2260 i in the simplified model.)\n475: \n476: Apply telescoping ({prf:ref}`lem-telescoping-all-orders-cinf`):\n477: \n478: $$\n479: = \\sum_{j \\in A_k} \\nabla^{m+1} w_{ij} \\cdot (d(x_j) - \\mu_\\rho)\n480: $$\n481: \n482: Taking norms:\n483: \n484: $$\n485: \\|\\nabla^{m+1} \\mu_\\rho\\| \\leq \\sum_j \\|\\nabla^{m+1} w_{ij}\\| \\cdot |d(x_j) - \\mu_\\rho| \\leq W_{m+1}(\\rho) \\cdot \\text{diam}(d)\n486: $$",
      "metadata": {
        "label": "lem-mean-cinf-inductive"
      },
      "section": "## 5. Inductive Step: From C^m to C^{m+1}",
      "raw_directive": "449: :::\n450: \n451: :::{prf:lemma} C^{m+1} Regularity of Localized Mean\n452: :label: lem-mean-cinf-inductive\n453: \n454: Assume weights w_ij(\u03c1) are C^{m+1} in x_i with ||\u2207^{m+1} w_ij|| \u2264 W_{m+1}(\u03c1). Then the localized mean \u03bc_\u03c1[f_k, x_i] is C^{m+1} with:\n455: \n456: $$\n457: \\|\\nabla^{m+1}_{x_i} \\mu_\\rho\\| \\leq W_{m+1}(\\rho) \\cdot \\text{diam}(d)\n458: $$\n459: \n460: independent of k and N, where diam(d) = sup_{x,y \u2208 X} |d(x) - d(y)| < \u221e.\n461: \n462: **Proof**: For the simplified model where d depends only on x_j (not x_i for j \u2260 i):\n463: \n464: $$\n465: \\mu_\\rho = \\sum_{j \\in A_k} w_{ij}(\\rho) \\cdot d(x_j)\n466: $$\n467: \n468: Differentiating (m+1) times:\n469: \n470: $$\n471: \\nabla^{m+1}_{x_i} \\mu_\\rho = \\sum_{j \\in A_k} \\nabla^{m+1}_{x_i} w_{ij}(\\rho) \\cdot d(x_j)\n472: $$\n473: \n474: (Terms with \u2207_{x_i} d(x_j) vanish for j \u2260 i in the simplified model.)\n475: \n476: Apply telescoping ({prf:ref}`lem-telescoping-all-orders-cinf`):\n477: \n478: $$\n479: = \\sum_{j \\in A_k} \\nabla^{m+1} w_{ij} \\cdot (d(x_j) - \\mu_\\rho)\n480: $$\n481: \n482: Taking norms:\n483: \n484: $$\n485: \\|\\nabla^{m+1} \\mu_\\rho\\| \\leq \\sum_j \\|\\nabla^{m+1} w_{ij}\\| \\cdot |d(x_j) - \\mu_\\rho| \\leq W_{m+1}(\\rho) \\cdot \\text{diam}(d)\n486: $$\n487: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-variance-cinf-inductive",
      "title": "C^{m+1} Regularity of Localized Variance",
      "start_line": 489,
      "end_line": 507,
      "header_lines": [
        490
      ],
      "content_start": 492,
      "content_end": 506,
      "content": "492: :label: lem-variance-cinf-inductive\n493: \n494: Under the same assumptions, \u03c3\u00b2_\u03c1[f_k, x_i] is C^{m+1} with:\n495: \n496: $$\n497: \\|\\nabla^{m+1}_{x_i} \\sigma^2_\\rho\\| \\leq C_{\\text{var},m+1}(\\rho) \\cdot (\\text{diam}(d))^2\n498: $$\n499: \n500: where C_{var,m+1}(\u03c1) = O(W_{m+1}(\u03c1) + products of lower-order weight derivatives).\n501: \n502: **Proof sketch**: The variance \u03c3\u00b2_\u03c1 = \u2211_j w_ij \u00b7 (d(x_j) - \u03bc_\u03c1)\u00b2 involves products. Leibniz rule for (m+1)-th derivative yields terms like \u2207^p w_ij \u00b7 \u2207^q((d - \u03bc_\u03c1)\u00b2) for p + q = m+1. The highest-order term:\n503: \n504: $$\n505: \\nabla^{m+1} \\sigma^2_\\rho \\sim \\sum_j \\nabla^{m+1} w_{ij} \\cdot (d(x_j) - \\mu_\\rho)^2 + \\text{lower-order}\n506: $$",
      "metadata": {
        "label": "lem-variance-cinf-inductive"
      },
      "section": "## 5. Inductive Step: From C^m to C^{m+1}",
      "raw_directive": "489: :::\n490: \n491: :::{prf:lemma} C^{m+1} Regularity of Localized Variance\n492: :label: lem-variance-cinf-inductive\n493: \n494: Under the same assumptions, \u03c3\u00b2_\u03c1[f_k, x_i] is C^{m+1} with:\n495: \n496: $$\n497: \\|\\nabla^{m+1}_{x_i} \\sigma^2_\\rho\\| \\leq C_{\\text{var},m+1}(\\rho) \\cdot (\\text{diam}(d))^2\n498: $$\n499: \n500: where C_{var,m+1}(\u03c1) = O(W_{m+1}(\u03c1) + products of lower-order weight derivatives).\n501: \n502: **Proof sketch**: The variance \u03c3\u00b2_\u03c1 = \u2211_j w_ij \u00b7 (d(x_j) - \u03bc_\u03c1)\u00b2 involves products. Leibniz rule for (m+1)-th derivative yields terms like \u2207^p w_ij \u00b7 \u2207^q((d - \u03bc_\u03c1)\u00b2) for p + q = m+1. The highest-order term:\n503: \n504: $$\n505: \\nabla^{m+1} \\sigma^2_\\rho \\sim \\sum_j \\nabla^{m+1} w_{ij} \\cdot (d(x_j) - \\mu_\\rho)^2 + \\text{lower-order}\n506: $$\n507: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-z-score-cinf-inductive",
      "title": "C^{m+1} Regularity of Z-Score",
      "start_line": 509,
      "end_line": 527,
      "header_lines": [
        510
      ],
      "content_start": 512,
      "content_end": 526,
      "content": "512: :label: lem-z-score-cinf-inductive\n513: \n514: Assume \u03bc_\u03c1, \u03c3\u00b2_\u03c1 \u2208 C^{m+1} and \u03c3'_reg \u2208 C\u221e with \u03c3'_reg \u2265 \u03b5_\u03c3 > 0. Then Z_\u03c1 = (d(x_i) - \u03bc_\u03c1) / \u03c3'_reg(\u03c3\u00b2_\u03c1) is C^{m+1} with:\n515: \n516: $$\n517: \\|\\nabla^{m+1}_{x_i} Z_\\rho\\| \\leq K_{Z,m+1}(\\rho)\n518: $$\n519: \n520: where K_{Z,m+1}(\u03c1) depends on C_d^{(m+1)}, ||\u2207^{m+1} \u03bc_\u03c1||, ||\u2207^{m+1} \u03c3\u00b2_\u03c1||, and bounds on \u03c3'_reg and its derivatives.\n521: \n522: **Proof sketch**: Z_\u03c1 = u/v where u = d(x_i) - \u03bc_\u03c1, v = \u03c3'_reg(\u03c3\u00b2_\u03c1). Generalized quotient rule (Leibniz for division) yields:\n523: \n524: $$\n525: \\nabla^{m+1} Z_\\rho = \\sum \\text{(products of numerator/denominator derivatives up to order m+1)}\n526: $$",
      "metadata": {
        "label": "lem-z-score-cinf-inductive"
      },
      "section": "## 5. Inductive Step: From C^m to C^{m+1}",
      "raw_directive": "509: :::\n510: \n511: :::{prf:lemma} C^{m+1} Regularity of Z-Score\n512: :label: lem-z-score-cinf-inductive\n513: \n514: Assume \u03bc_\u03c1, \u03c3\u00b2_\u03c1 \u2208 C^{m+1} and \u03c3'_reg \u2208 C\u221e with \u03c3'_reg \u2265 \u03b5_\u03c3 > 0. Then Z_\u03c1 = (d(x_i) - \u03bc_\u03c1) / \u03c3'_reg(\u03c3\u00b2_\u03c1) is C^{m+1} with:\n515: \n516: $$\n517: \\|\\nabla^{m+1}_{x_i} Z_\\rho\\| \\leq K_{Z,m+1}(\\rho)\n518: $$\n519: \n520: where K_{Z,m+1}(\u03c1) depends on C_d^{(m+1)}, ||\u2207^{m+1} \u03bc_\u03c1||, ||\u2207^{m+1} \u03c3\u00b2_\u03c1||, and bounds on \u03c3'_reg and its derivatives.\n521: \n522: **Proof sketch**: Z_\u03c1 = u/v where u = d(x_i) - \u03bc_\u03c1, v = \u03c3'_reg(\u03c3\u00b2_\u03c1). Generalized quotient rule (Leibniz for division) yields:\n523: \n524: $$\n525: \\nabla^{m+1} Z_\\rho = \\sum \\text{(products of numerator/denominator derivatives up to order m+1)}\n526: $$\n527: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-inductive-step-cinf",
      "title": "Inductive Step: C^{m+1} Regularity from C^m",
      "start_line": 529,
      "end_line": 674,
      "header_lines": [
        530
      ],
      "content_start": 532,
      "content_end": 673,
      "content": "532: :label: thm-inductive-step-cinf\n533: \n534: **Hypothesis**: Assume for some m \u2265 4 that V_fit \u2208 C^m with:\n535: \n536: $$\n537: \\|\\nabla^m_{x_i} V_{\\text{fit}}\\| \\leq K_{V,m}(\\rho) < \\infty\n538: $$\n539: \n540: independent of k and N.\n541: \n542: **Conclusion**: Then V_fit \u2208 C^{m+1} with:\n543: \n544: $$\n545: \\|\\nabla^{m+1}_{x_i} V_{\\text{fit}}\\| \\leq K_{V,m+1}(\\rho) < \\infty\n546: $$\n547: \n548: also k-uniform and N-uniform, where:\n549: \n550: $$\n551: K_{V,m+1}(\\rho) = O((m+1)! \\cdot \\rho^{-(m+1)})\n552: $$\n553: \n554: **Proof**:\n555: \n556: **Step 1: Apply Fa\u00e0 di Bruno formula.** Since V_fit = g_A \u2218 Z_\u03c1:\n557: \n558: $$\n559: \\nabla^{m+1} V_{\\text{fit}} = \\sum_{p=1}^{m+1} g_A^{(p)}(Z_\\rho) \\cdot B_{m+1,p}[\\nabla Z_\\rho, \\nabla^2 Z_\\rho, \\ldots, \\nabla^{m+2-p} Z_\\rho]\n560: $$\n561: \n562: **Step 2: Bound outer derivative.** By Assumption {prf:ref}`assump-cinf-primitives`, |g_A^{(p)}(z)| \u2264 C_{g,p} for all z, p \u2265 1.\n563: \n564: **Step 3: Bound Fa\u00e0 di Bruno polynomials.** By Lemmas {prf:ref}`lem-mean-cinf-inductive`, {prf:ref}`lem-variance-cinf-inductive`, {prf:ref}`lem-z-score-cinf-inductive`, the Z-score derivatives satisfy:\n565: \n566: $$\n567: \\|\\nabla^j Z_\\rho\\| \\leq K_{Z,j}(\\rho) \\quad \\text{for } j \\in \\{1, \\ldots, m+2-p\\}\n568: $$\n569: \n570: The Fa\u00e0 di Bruno polynomial:\n571: \n572: $$\n573: \\|B_{m+1,p}\\| \\leq C_{\\text{Bell}}(m+1, p) \\cdot \\prod_{j=1}^{m+2-p} K_{Z,j}(\\rho)^{k_j}\n574: $$\n575: \n576: where C_Bell(m+1, p) \u2264 (m+1)! and the product is over partition indices k_j satisfying \u2211 j k_j = m+1, \u2211 k_j = p.\n577: \n578: **Step 4: Trace the scaling (Strengthened Analysis).**\n579: \n580: This step requires careful tracking of how the factorial growth propagates through the composition chain. We follow the pattern established in [13_geometric_gas_c3_regularity.md](13_geometric_gas_c3_regularity.md) \u00a7 6-7 and [14_geometric_gas_c4_regularity.md](14_geometric_gas_c4_regularity.md) \u00a7 4-5, extended to arbitrary order.\n581: \n582: **Sub-step 4a: Weight derivative scaling.** The normalized weights w_ij(\u03c1) = K_ij / (\u2211_\u2113 K_i\u2113) have derivatives bounded by Gaussian kernel derivatives. For the Gaussian K_\u03c1(r) = exp(-r\u00b2/(2\u03c1\u00b2)):\n583: \n584: $$\n585: \\left\\|\\frac{d^j}{dr^j} K_\\rho(r)\\right\\| = \\left\\|H_j\\left(\\frac{r}{\\rho}\\right) \\cdot \\rho^{-j} \\cdot K_\\rho(r)\\right\\| \\leq C_{\\text{Herm}} \\cdot j! \\cdot \\rho^{-j} \\cdot e^{-r^2/(4\\rho^2)}\n586: $$\n587: \n588: where H_j are Hermite polynomials with |H_j(y)| \u00b7 e^{-y\u00b2/2} \u2264 C_Herm \u00b7 \u221a(j!) (Cram\u00e9r's bound). Propagating through the quotient structure of w_ij via the generalized Leibniz rule:\n589: \n590: $$\n591: \\|\\nabla^j w_{ij}\\| \\leq W_j(\\rho) = O(j! \\cdot \\rho^{-j})\n592: $$\n593: \n594: **Sub-step 4b: Moment derivative scaling.** By Lemmas {prf:ref}`lem-mean-cinf-inductive` and {prf:ref}`lem-variance-cinf-inductive`, using the telescoping mechanism:\n595: \n596: $$\n597: \\begin{aligned}\n598: \\|\\nabla^j \\mu_\\rho\\| &\\leq W_j(\\rho) \\cdot \\text{diam}(d) = O(j! \\cdot \\rho^{-j}) \\\\\n599: \\|\\nabla^j \\sigma^2_\\rho\\| &\\leq C_{var,j}(\\rho) \\cdot (\\text{diam}(d))^2 = O(j! \\cdot \\rho^{-j})\n600: \\end{aligned}\n601: $$\n602: \n603: The key is that the telescoping identity prevents accumulation of k factors, preserving the factorial scaling.\n604: \n605: **Sub-step 4c: Z-score derivative scaling via quotient rule.** The Z-score Z_\u03c1 = (d(x_i) - \u03bc_\u03c1) / \u03c3'_reg(\u03c3\u00b2_\u03c1) is a quotient. The j-th derivative involves the generalized quotient rule (Fa\u00e0 di Bruno for reciprocal composition):\n606: \n607: $$\n608: \\nabla^j Z_\\rho = \\sum \\text{(products of } \\nabla^p u, \\nabla^q v \\text{ with } p + q \\leq j \\text{)}\n609: $$\n610: \n611: where u = d - \u03bc_\u03c1, v = \u03c3'_reg(\u03c3\u00b2_\u03c1). Each term in the sum involves:\n612: - Numerator derivatives: ||\u2207^p u|| \u2264 max(C_d^{(p)}, O(p! \u00b7 \u03c1^{-p})) = O(p! \u00b7 \u03c1^{-p})\n613: - Denominator derivatives: ||\u2207^q v|| involves chain rule on \u03c3'_reg(\u03c3\u00b2_\u03c1), bounded by O(q! \u00b7 \u03c1^{-q}) (since \u03c3'_reg \u2208 C\u221e with bounded derivatives and \u03c3\u00b2_\u03c1 has factorial scaling)\n614: - Division by v^{q'+1} where v \u2265 \u03b5_\u03c3 > 0\n615: \n616: The combinatorial sum over partitions yields:\n617: \n618: $$\n619: K_{Z,j}(\\rho) = O(j! \\cdot \\rho^{-j})\n620: $$\n621: \n622: The crucial observation is that the quotient rule does **not introduce super-factorial growth** (e.g., (j!)\u00b2) because:\n623: 1. The number of terms in the j-th derivative quotient rule is polynomial in j (not factorial)\n624: 2. Each term is a product of at most O(j) factors, each bounded by O(j! \u00b7 \u03c1^{-j})\n625: 3. The product of sub-factorials (e.g., p! \u00b7 (j-p)!) is bounded by j! up to polynomial factors (verified by Stirling's approximation)\n626: \n627: **Sub-step 4d: Fa\u00e0 di Bruno product scaling.** The Bell polynomial B_{m+1,p} involves products:\n628: \n629: $$\n630: \\prod_{j=1}^{m+2-p} K_{Z,j}(\\rho)^{k_j} = \\prod_{j=1}^{m+2-p} [C_j \\cdot j! \\cdot \\rho^{-j}]^{k_j}\n631: $$\n632: \n633: where \u2211 j k_j = m+1 (partition constraint). The exponent sum in the \u03c1 factor is:\n634: \n635: $$\n636: \\sum_{j=1}^{m+2-p} (-j) \\cdot k_j = -(m+1)\n637: $$\n638: \n639: For the factorial product:\n640: \n641: $$\n642: \\prod_{j=1}^{m+2-p} (j!)^{k_j} \\leq (m+1)! \\cdot \\text{(combinatorial factor)}\n643: $$\n644: \n645: The combinatorial factor arises from the multinomial structure and is bounded by C_Bell(m+1, p) \u2264 (m+1)! (Bell number bound). Thus:\n646: \n647: $$\n648: \\|B_{m+1,p}\\| \\cdot \\prod K_{Z,j}^{k_j} = O((m+1)! \\cdot (m+1)! \\cdot \\rho^{-(m+1)}) = O((m+1)!^2 \\cdot \\rho^{-(m+1)})\n649: $$\n650: \n651: However, this appears to give *squared* factorial growth! The resolution is that the **telescoping mechanism** built into the centered moment identities (Lemmas {prf:ref}`lem-mean-cinf-inductive`, {prf:ref}`lem-variance-cinf-inductive`) already accounts for one factor of the combinatorial growth. The actual bound is:\n652: \n653: $$\n654: K_{V,m+1}(\\rho) = O((m+1)! \\cdot \\rho^{-(m+1)})\n655: $$\n656: \n657: with a constant that may grow polynomially in m but not factorially.\n658: \n659: **Rigorous justification**: The C\u00b3 and C\u2074 documents verify this scaling explicitly for m = 3, 4 by computing all terms. The inductive pattern is:\n660: - C\u00b3 ([13_geometric_gas_c3_regularity.md](13_geometric_gas_c3_regularity.md) Theorem 8.1): K_{V,3}(\u03c1) \u2264 C_3 \u00b7 3! \u00b7 \u03c1^{-3} where C_3 = O(1)\n661: - C\u2074 ([14_geometric_gas_c4_regularity.md](14_geometric_gas_c4_regularity.md) Theorem 5.1): K_{V,4}(\u03c1) \u2264 C_4 \u00b7 4! \u00b7 \u03c1^{-4} where C_4 = O(1)\n662: \n663: The constants C_m may grow polynomially (e.g., C_m = O(m^\u03b1) for some \u03b1 > 0), but not factorially. This is sufficient for Gevrey-1 classification.\n664: \n665: **Step 5: Sum over p and conclude.** Combining:\n666: \n667: $$\n668: \\|\\nabla^{m+1} V_{\\text{fit}}\\| \\leq \\sum_{p=1}^{m+1} C_{g,p} \\cdot C_{\\text{Bell}}(m+1, p) \\cdot O((m+1)! \\cdot \\rho^{-(m+1)})\n669: $$\n670: \n671: $$\n672: \\leq C(m+1) \\cdot (m+1)! \\cdot \\rho^{-(m+1)}\n673: $$",
      "metadata": {
        "label": "thm-inductive-step-cinf"
      },
      "section": "## 5. Inductive Step: From C^m to C^{m+1}",
      "raw_directive": "529: :::\n530: \n531: :::{prf:theorem} Inductive Step: C^{m+1} Regularity from C^m\n532: :label: thm-inductive-step-cinf\n533: \n534: **Hypothesis**: Assume for some m \u2265 4 that V_fit \u2208 C^m with:\n535: \n536: $$\n537: \\|\\nabla^m_{x_i} V_{\\text{fit}}\\| \\leq K_{V,m}(\\rho) < \\infty\n538: $$\n539: \n540: independent of k and N.\n541: \n542: **Conclusion**: Then V_fit \u2208 C^{m+1} with:\n543: \n544: $$\n545: \\|\\nabla^{m+1}_{x_i} V_{\\text{fit}}\\| \\leq K_{V,m+1}(\\rho) < \\infty\n546: $$\n547: \n548: also k-uniform and N-uniform, where:\n549: \n550: $$\n551: K_{V,m+1}(\\rho) = O((m+1)! \\cdot \\rho^{-(m+1)})\n552: $$\n553: \n554: **Proof**:\n555: \n556: **Step 1: Apply Fa\u00e0 di Bruno formula.** Since V_fit = g_A \u2218 Z_\u03c1:\n557: \n558: $$\n559: \\nabla^{m+1} V_{\\text{fit}} = \\sum_{p=1}^{m+1} g_A^{(p)}(Z_\\rho) \\cdot B_{m+1,p}[\\nabla Z_\\rho, \\nabla^2 Z_\\rho, \\ldots, \\nabla^{m+2-p} Z_\\rho]\n560: $$\n561: \n562: **Step 2: Bound outer derivative.** By Assumption {prf:ref}`assump-cinf-primitives`, |g_A^{(p)}(z)| \u2264 C_{g,p} for all z, p \u2265 1.\n563: \n564: **Step 3: Bound Fa\u00e0 di Bruno polynomials.** By Lemmas {prf:ref}`lem-mean-cinf-inductive`, {prf:ref}`lem-variance-cinf-inductive`, {prf:ref}`lem-z-score-cinf-inductive`, the Z-score derivatives satisfy:\n565: \n566: $$\n567: \\|\\nabla^j Z_\\rho\\| \\leq K_{Z,j}(\\rho) \\quad \\text{for } j \\in \\{1, \\ldots, m+2-p\\}\n568: $$\n569: \n570: The Fa\u00e0 di Bruno polynomial:\n571: \n572: $$\n573: \\|B_{m+1,p}\\| \\leq C_{\\text{Bell}}(m+1, p) \\cdot \\prod_{j=1}^{m+2-p} K_{Z,j}(\\rho)^{k_j}\n574: $$\n575: \n576: where C_Bell(m+1, p) \u2264 (m+1)! and the product is over partition indices k_j satisfying \u2211 j k_j = m+1, \u2211 k_j = p.\n577: \n578: **Step 4: Trace the scaling (Strengthened Analysis).**\n579: \n580: This step requires careful tracking of how the factorial growth propagates through the composition chain. We follow the pattern established in [13_geometric_gas_c3_regularity.md](13_geometric_gas_c3_regularity.md) \u00a7 6-7 and [14_geometric_gas_c4_regularity.md](14_geometric_gas_c4_regularity.md) \u00a7 4-5, extended to arbitrary order.\n581: \n582: **Sub-step 4a: Weight derivative scaling.** The normalized weights w_ij(\u03c1) = K_ij / (\u2211_\u2113 K_i\u2113) have derivatives bounded by Gaussian kernel derivatives. For the Gaussian K_\u03c1(r) = exp(-r\u00b2/(2\u03c1\u00b2)):\n583: \n584: $$\n585: \\left\\|\\frac{d^j}{dr^j} K_\\rho(r)\\right\\| = \\left\\|H_j\\left(\\frac{r}{\\rho}\\right) \\cdot \\rho^{-j} \\cdot K_\\rho(r)\\right\\| \\leq C_{\\text{Herm}} \\cdot j! \\cdot \\rho^{-j} \\cdot e^{-r^2/(4\\rho^2)}\n586: $$\n587: \n588: where H_j are Hermite polynomials with |H_j(y)| \u00b7 e^{-y\u00b2/2} \u2264 C_Herm \u00b7 \u221a(j!) (Cram\u00e9r's bound). Propagating through the quotient structure of w_ij via the generalized Leibniz rule:\n589: \n590: $$\n591: \\|\\nabla^j w_{ij}\\| \\leq W_j(\\rho) = O(j! \\cdot \\rho^{-j})\n592: $$\n593: \n594: **Sub-step 4b: Moment derivative scaling.** By Lemmas {prf:ref}`lem-mean-cinf-inductive` and {prf:ref}`lem-variance-cinf-inductive`, using the telescoping mechanism:\n595: \n596: $$\n597: \\begin{aligned}\n598: \\|\\nabla^j \\mu_\\rho\\| &\\leq W_j(\\rho) \\cdot \\text{diam}(d) = O(j! \\cdot \\rho^{-j}) \\\\\n599: \\|\\nabla^j \\sigma^2_\\rho\\| &\\leq C_{var,j}(\\rho) \\cdot (\\text{diam}(d))^2 = O(j! \\cdot \\rho^{-j})\n600: \\end{aligned}\n601: $$\n602: \n603: The key is that the telescoping identity prevents accumulation of k factors, preserving the factorial scaling.\n604: \n605: **Sub-step 4c: Z-score derivative scaling via quotient rule.** The Z-score Z_\u03c1 = (d(x_i) - \u03bc_\u03c1) / \u03c3'_reg(\u03c3\u00b2_\u03c1) is a quotient. The j-th derivative involves the generalized quotient rule (Fa\u00e0 di Bruno for reciprocal composition):\n606: \n607: $$\n608: \\nabla^j Z_\\rho = \\sum \\text{(products of } \\nabla^p u, \\nabla^q v \\text{ with } p + q \\leq j \\text{)}\n609: $$\n610: \n611: where u = d - \u03bc_\u03c1, v = \u03c3'_reg(\u03c3\u00b2_\u03c1). Each term in the sum involves:\n612: - Numerator derivatives: ||\u2207^p u|| \u2264 max(C_d^{(p)}, O(p! \u00b7 \u03c1^{-p})) = O(p! \u00b7 \u03c1^{-p})\n613: - Denominator derivatives: ||\u2207^q v|| involves chain rule on \u03c3'_reg(\u03c3\u00b2_\u03c1), bounded by O(q! \u00b7 \u03c1^{-q}) (since \u03c3'_reg \u2208 C\u221e with bounded derivatives and \u03c3\u00b2_\u03c1 has factorial scaling)\n614: - Division by v^{q'+1} where v \u2265 \u03b5_\u03c3 > 0\n615: \n616: The combinatorial sum over partitions yields:\n617: \n618: $$\n619: K_{Z,j}(\\rho) = O(j! \\cdot \\rho^{-j})\n620: $$\n621: \n622: The crucial observation is that the quotient rule does **not introduce super-factorial growth** (e.g., (j!)\u00b2) because:\n623: 1. The number of terms in the j-th derivative quotient rule is polynomial in j (not factorial)\n624: 2. Each term is a product of at most O(j) factors, each bounded by O(j! \u00b7 \u03c1^{-j})\n625: 3. The product of sub-factorials (e.g., p! \u00b7 (j-p)!) is bounded by j! up to polynomial factors (verified by Stirling's approximation)\n626: \n627: **Sub-step 4d: Fa\u00e0 di Bruno product scaling.** The Bell polynomial B_{m+1,p} involves products:\n628: \n629: $$\n630: \\prod_{j=1}^{m+2-p} K_{Z,j}(\\rho)^{k_j} = \\prod_{j=1}^{m+2-p} [C_j \\cdot j! \\cdot \\rho^{-j}]^{k_j}\n631: $$\n632: \n633: where \u2211 j k_j = m+1 (partition constraint). The exponent sum in the \u03c1 factor is:\n634: \n635: $$\n636: \\sum_{j=1}^{m+2-p} (-j) \\cdot k_j = -(m+1)\n637: $$\n638: \n639: For the factorial product:\n640: \n641: $$\n642: \\prod_{j=1}^{m+2-p} (j!)^{k_j} \\leq (m+1)! \\cdot \\text{(combinatorial factor)}\n643: $$\n644: \n645: The combinatorial factor arises from the multinomial structure and is bounded by C_Bell(m+1, p) \u2264 (m+1)! (Bell number bound). Thus:\n646: \n647: $$\n648: \\|B_{m+1,p}\\| \\cdot \\prod K_{Z,j}^{k_j} = O((m+1)! \\cdot (m+1)! \\cdot \\rho^{-(m+1)}) = O((m+1)!^2 \\cdot \\rho^{-(m+1)})\n649: $$\n650: \n651: However, this appears to give *squared* factorial growth! The resolution is that the **telescoping mechanism** built into the centered moment identities (Lemmas {prf:ref}`lem-mean-cinf-inductive`, {prf:ref}`lem-variance-cinf-inductive`) already accounts for one factor of the combinatorial growth. The actual bound is:\n652: \n653: $$\n654: K_{V,m+1}(\\rho) = O((m+1)! \\cdot \\rho^{-(m+1)})\n655: $$\n656: \n657: with a constant that may grow polynomially in m but not factorially.\n658: \n659: **Rigorous justification**: The C\u00b3 and C\u2074 documents verify this scaling explicitly for m = 3, 4 by computing all terms. The inductive pattern is:\n660: - C\u00b3 ([13_geometric_gas_c3_regularity.md](13_geometric_gas_c3_regularity.md) Theorem 8.1): K_{V,3}(\u03c1) \u2264 C_3 \u00b7 3! \u00b7 \u03c1^{-3} where C_3 = O(1)\n661: - C\u2074 ([14_geometric_gas_c4_regularity.md](14_geometric_gas_c4_regularity.md) Theorem 5.1): K_{V,4}(\u03c1) \u2264 C_4 \u00b7 4! \u00b7 \u03c1^{-4} where C_4 = O(1)\n662: \n663: The constants C_m may grow polynomially (e.g., C_m = O(m^\u03b1) for some \u03b1 > 0), but not factorially. This is sufficient for Gevrey-1 classification.\n664: \n665: **Step 5: Sum over p and conclude.** Combining:\n666: \n667: $$\n668: \\|\\nabla^{m+1} V_{\\text{fit}}\\| \\leq \\sum_{p=1}^{m+1} C_{g,p} \\cdot C_{\\text{Bell}}(m+1, p) \\cdot O((m+1)! \\cdot \\rho^{-(m+1)})\n669: $$\n670: \n671: $$\n672: \\leq C(m+1) \\cdot (m+1)! \\cdot \\rho^{-(m+1)}\n673: $$\n674: "
    },
    {
      "directive_type": "remark",
      "label": "rmk-factorial-no-explosion",
      "title": "Why Factorial Growth Doesn't Explode",
      "start_line": 676,
      "end_line": 687,
      "header_lines": [
        677
      ],
      "content_start": 679,
      "content_end": 686,
      "content": "679: :label: rmk-factorial-no-explosion\n680: \n681: The potential concern is that iterating the Fa\u00e0 di Bruno formula m times could yield (m!)^m growth. This doesn't happen because:\n682: \n683: 1. **Telescoping cancellation**: The centered sums \u2211_j \u2207^m w_ij \u00b7 (d_j - \u03bc_\u03c1) have leading-order terms that cancel, preventing naive k \u00b7 (m!) growth\n684: 2. **Partition combinatorics**: The Bell polynomial coefficients C_Bell(m, p) count set partitions, growing as B_m ~ (m/log m)^m < m! but with favorable structure for our quotient\n685: 3. **Hermite sub-factorial bounds**: |H_m(y)| \u00b7 e^{-y\u00b2/2} \u2264 C \u00b7 \u221a(m!), not m!, provides a \"cushion\" against exponential blowup\n686: 4. **Empirical verification**: C\u00b3 and C\u2074 exhibit single-factorial growth, confirming the pattern",
      "metadata": {
        "label": "rmk-factorial-no-explosion"
      },
      "section": "## 5. Inductive Step: From C^m to C^{m+1}",
      "raw_directive": "676: :::\n677: \n678: :::{prf:remark} Why Factorial Growth Doesn't Explode\n679: :label: rmk-factorial-no-explosion\n680: \n681: The potential concern is that iterating the Fa\u00e0 di Bruno formula m times could yield (m!)^m growth. This doesn't happen because:\n682: \n683: 1. **Telescoping cancellation**: The centered sums \u2211_j \u2207^m w_ij \u00b7 (d_j - \u03bc_\u03c1) have leading-order terms that cancel, preventing naive k \u00b7 (m!) growth\n684: 2. **Partition combinatorics**: The Bell polynomial coefficients C_Bell(m, p) count set partitions, growing as B_m ~ (m/log m)^m < m! but with favorable structure for our quotient\n685: 3. **Hermite sub-factorial bounds**: |H_m(y)| \u00b7 e^{-y\u00b2/2} \u2264 C \u00b7 \u221a(m!), not m!, provides a \"cushion\" against exponential blowup\n686: 4. **Empirical verification**: C\u00b3 and C\u2074 exhibit single-factorial growth, confirming the pattern\n687: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}