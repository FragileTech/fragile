{
  "chapter_index": 29,
  "section_id": "## Appendix A: Combinatorial Proof of Gevrey-1 Bounds via Fa\u00e0 di Bruno Formula",
  "directive_count": 6,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-faa-di-bruno-appendix",
      "title": "Fa\u00e0 di Bruno Formula for Higher-Order Chain Rule",
      "start_line": 5302,
      "end_line": 5318,
      "header_lines": [
        5303
      ],
      "content_start": 5305,
      "content_end": 5317,
      "content": "5305: :label: thm-faa-di-bruno-appendix\n5306: \n5307: For smooth functions $f: \\mathbb{R} \\to \\mathbb{R}$ and $g: \\mathbb{R}^d \\to \\mathbb{R}$, the $m$-th derivative of the composition $h = f \\circ g$ is:\n5308: \n5309: $$\n5310: \\nabla^m h(x) = \\sum_{\\pi \\in \\mathcal{P}_m} f^{(|\\pi|)}(g(x)) \\cdot B_\\pi(\\nabla g(x), \\nabla^2 g(x), \\ldots, \\nabla^m g(x))\n5311: \n5312: $$\n5313: \n5314: where:\n5315: - $\\mathcal{P}_m$ is the set of all partitions of $\\{1, 2, \\ldots, m\\}$\n5316: - $|\\pi|$ is the number of blocks in partition $\\pi$\n5317: - $B_\\pi$ is the **Bell polynomial** associated with partition $\\pi$",
      "metadata": {
        "label": "thm-faa-di-bruno-appendix"
      },
      "section": "## Appendix A: Combinatorial Proof of Gevrey-1 Bounds via Fa\u00e0 di Bruno Formula",
      "references": [],
      "raw_directive": "5302: ### A.1 Statement of the Fa\u00e0 di Bruno Formula\n5303: \n5304: :::{prf:theorem} Fa\u00e0 di Bruno Formula for Higher-Order Chain Rule\n5305: :label: thm-faa-di-bruno-appendix\n5306: \n5307: For smooth functions $f: \\mathbb{R} \\to \\mathbb{R}$ and $g: \\mathbb{R}^d \\to \\mathbb{R}$, the $m$-th derivative of the composition $h = f \\circ g$ is:\n5308: \n5309: $$\n5310: \\nabla^m h(x) = \\sum_{\\pi \\in \\mathcal{P}_m} f^{(|\\pi|)}(g(x)) \\cdot B_\\pi(\\nabla g(x), \\nabla^2 g(x), \\ldots, \\nabla^m g(x))\n5311: \n5312: $$\n5313: \n5314: where:\n5315: - $\\mathcal{P}_m$ is the set of all partitions of $\\{1, 2, \\ldots, m\\}$\n5316: - $|\\pi|$ is the number of blocks in partition $\\pi$\n5317: - $B_\\pi$ is the **Bell polynomial** associated with partition $\\pi$\n5318: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-102",
      "title": null,
      "start_line": 5320,
      "end_line": 5322,
      "header_lines": [],
      "content_start": 5321,
      "content_end": 5321,
      "content": "5321: ",
      "metadata": {},
      "section": "## Appendix A: Combinatorial Proof of Gevrey-1 Bounds via Fa\u00e0 di Bruno Formula",
      "references": [],
      "raw_directive": "5320: :::\n5321: \n5322: :::{prf:proof}"
    },
    {
      "directive_type": "proposition",
      "label": "prop-factorial-sqrt-composition",
      "title": "Factorial Growth for Composition with Square Root",
      "start_line": 5328,
      "end_line": 5339,
      "header_lines": [
        5329
      ],
      "content_start": 5331,
      "content_end": 5338,
      "content": "5331: :label: prop-factorial-sqrt-composition\n5332: \n5333: For $\\sigma'(V) = \\sqrt{V + c^2}$ where $c = \\eta_{\\min} > 0$ and $V \\in C^m$ with $\\|\\nabla^k V\\| \\leq M_k$, the $m$-th derivative satisfies:\n5334: \n5335: $$\n5336: \\|\\nabla^m \\sigma'(V)\\| \\leq C_{\\sigma,m} \\cdot m!\n5337: \n5338: $$",
      "metadata": {
        "label": "prop-factorial-sqrt-composition"
      },
      "section": "## Appendix A: Combinatorial Proof of Gevrey-1 Bounds via Fa\u00e0 di Bruno Formula",
      "references": [],
      "raw_directive": "5328: We prove the Gevrey-1 bound for $\\sigma'_{\\text{reg}}(V) = \\sqrt{V + \\eta_{\\min}^2}$ as a concrete example.\n5329: \n5330: :::{prf:proposition} Factorial Growth for Composition with Square Root\n5331: :label: prop-factorial-sqrt-composition\n5332: \n5333: For $\\sigma'(V) = \\sqrt{V + c^2}$ where $c = \\eta_{\\min} > 0$ and $V \\in C^m$ with $\\|\\nabla^k V\\| \\leq M_k$, the $m$-th derivative satisfies:\n5334: \n5335: $$\n5336: \\|\\nabla^m \\sigma'(V)\\| \\leq C_{\\sigma,m} \\cdot m!\n5337: \n5338: $$\n5339: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-123",
      "title": null,
      "start_line": 5341,
      "end_line": 5450,
      "header_lines": [],
      "content_start": 5342,
      "content_end": 5449,
      "content": "5342: \n5343: :::{prf:proof}\n5344: **Step 1: Derivatives of the outer function $f(s) = \\sqrt{s}$.**\n5345: \n5346: For $s \\geq c^2 > 0$, the $n$-th derivative of $f(s) = s^{1/2}$ is:\n5347: \n5348: $$\n5349: f^{(n)}(s) = \\frac{d^n}{ds^n} s^{1/2} = \\frac{(-1)^{n-1} \\cdot (2n-3)!!}{2^n} \\cdot s^{1/2 - n}\n5350: \n5351: $$\n5352: \n5353: where $(2n-3)!! = 1 \\cdot 3 \\cdot 5 \\cdots (2n-3)$ is the double factorial.\n5354: \n5355: **Key fact**: The double factorial satisfies:\n5356: \n5357: $$\n5358: (2n-3)!! = \\frac{(2n-2)!}{2^{n-1} (n-1)!} = \\mathcal{O}\\left(\\frac{n!}{2^{n-1}}\\right)\n5359: \n5360: $$\n5361: \n5362: Therefore:\n5363: \n5364: $$\n5365: |f^{(n)}(s)| \\leq \\frac{(2n-3)!!}{2^n \\cdot c^{n-1}} \\leq \\frac{C \\cdot n!}{2^{2n-1} \\cdot c^{n-1}} = \\mathcal{O}(n!) \\cdot c^{-(n-1)}\n5366: \n5367: $$\n5368: \n5369: **Step 2: Applying Fa\u00e0 di Bruno formula.**\n5370: \n5371: For $\\sigma'(V(x)) = f(V(x) + c^2)$, let $g(x) = V(x) + c^2$. Then:\n5372: \n5373: $$\n5374: \\nabla^m \\sigma'(V) = \\sum_{\\pi \\in \\mathcal{P}_m} f^{(|\\pi|)}(g) \\cdot B_\\pi(\\nabla g, \\nabla^2 g, \\ldots, \\nabla^m g)\n5375: \n5376: $$\n5377: \n5378: **Step 3: Bounding each partition contribution.**\n5379: \n5380: For partition $\\pi$ with $|\\pi| = \\ell$ blocks, the Bell polynomial $B_\\pi$ is a product:\n5381: \n5382: $$\n5383: B_\\pi = \\prod_{B \\in \\pi} \\nabla^{|B|} g\n5384: \n5385: $$\n5386: \n5387: where $B$ ranges over blocks of $\\pi$ and $\\sum_{B \\in \\pi} |B| = m$.\n5388: \n5389: Using $\\|\\nabla^k g\\| = \\|\\nabla^k V\\| \\leq M_k$:\n5390: \n5391: $$\n5392: \\|B_\\pi\\| \\leq \\prod_{B \\in \\pi} M_{|B|}\n5393: \n5394: $$\n5395: \n5396: **Step 4: Counting partitions and summing.**\n5397: \n5398: For fixed $\\ell$, the number of partitions of $m$ elements into $\\ell$ non-empty blocks is the **Stirling number of the second kind** $S(m, \\ell)$, which satisfies:\n5399: \n5400: $$\n5401: S(m, \\ell) \\leq \\frac{\\ell^m}{\\ell!}\n5402: \n5403: $$\n5404: \n5405: Combining:\n5406: \n5407: $$\n5408: \\begin{aligned}\n5409: \\|\\nabla^m \\sigma'\\| &\\leq \\sum_{\\ell=1}^m |f^{(\\ell)}(g)| \\cdot \\sum_{\\pi: |\\pi|=\\ell} \\|B_\\pi\\| \\\\\n5410: &\\leq \\sum_{\\ell=1}^m \\frac{C \\ell!}{c^{\\ell-1}} \\cdot S(m,\\ell) \\cdot (\\text{bound on } B_\\pi)\n5411: \\end{aligned}\n5412: \n5413: $$\n5414: \n5415: **Step 5: Worst-case scenario - all derivatives contribute.**\n5416: \n5417: The dominant contribution comes from $\\ell = 1$ (single block, using $\\nabla^m V$ directly):\n5418: \n5419: $$\n5420: \\|\\nabla^m \\sigma'\\| \\geq |f^{(1)}(g)| \\cdot \\|\\nabla^m V\\| \\sim \\frac{1}{c} M_m\n5421: \n5422: $$\n5423: \n5424: But the total sum over all partitions gives:\n5425: \n5426: $$\n5427: \\|\\nabla^m \\sigma'\\| \\leq C \\sum_{\\ell=1}^m \\ell! \\cdot c^{-(\\ell-1)} \\cdot \\frac{\\ell^m}{\\ell!} \\cdot \\prod_k M_k^{(\\text{multiplicity})}\n5428: \n5429: $$\n5430: \n5431: **Step 6: Factorial bound emerges.**\n5432: \n5433: The key observation is that the Stirling numbers and factorial from $f^{(\\ell)}$ **combine multiplicatively**, not additively. The dominant term in the sum is $\\ell = m$ (each derivative appears once):\n5434: \n5435: $$\n5436: \\|\\nabla^m \\sigma'\\| \\leq C \\cdot m! \\cdot c^{-(m-1)} \\cdot \\prod_{k=1}^m M_k^{(a_k)}\n5437: \n5438: $$\n5439: \n5440: where $\\sum k \\cdot a_k = m$ (partition constraint) and $\\sum a_k = m$ (Bell polynomial structure).\n5441: \n5442: For $M_k = \\mathcal{O}(k!)$ (Gevrey-1 input), this gives:\n5443: \n5444: $$\n5445: \\|\\nabla^m \\sigma'\\| \\leq C \\cdot m! \\cdot (\\text{poly}(m)) = \\mathcal{O}(m!)\n5446: \n5447: $$\n5448: \n5449: where the polynomial factor comes from combining products of factorial-growth inputs.",
      "metadata": {},
      "section": "## Appendix A: Combinatorial Proof of Gevrey-1 Bounds via Fa\u00e0 di Bruno Formula",
      "references": [],
      "raw_directive": "5341: :::\n5342: \n5343: :::{prf:proof}\n5344: **Step 1: Derivatives of the outer function $f(s) = \\sqrt{s}$.**\n5345: \n5346: For $s \\geq c^2 > 0$, the $n$-th derivative of $f(s) = s^{1/2}$ is:\n5347: \n5348: $$\n5349: f^{(n)}(s) = \\frac{d^n}{ds^n} s^{1/2} = \\frac{(-1)^{n-1} \\cdot (2n-3)!!}{2^n} \\cdot s^{1/2 - n}\n5350: \n5351: $$\n5352: \n5353: where $(2n-3)!! = 1 \\cdot 3 \\cdot 5 \\cdots (2n-3)$ is the double factorial.\n5354: \n5355: **Key fact**: The double factorial satisfies:\n5356: \n5357: $$\n5358: (2n-3)!! = \\frac{(2n-2)!}{2^{n-1} (n-1)!} = \\mathcal{O}\\left(\\frac{n!}{2^{n-1}}\\right)\n5359: \n5360: $$\n5361: \n5362: Therefore:\n5363: \n5364: $$\n5365: |f^{(n)}(s)| \\leq \\frac{(2n-3)!!}{2^n \\cdot c^{n-1}} \\leq \\frac{C \\cdot n!}{2^{2n-1} \\cdot c^{n-1}} = \\mathcal{O}(n!) \\cdot c^{-(n-1)}\n5366: \n5367: $$\n5368: \n5369: **Step 2: Applying Fa\u00e0 di Bruno formula.**\n5370: \n5371: For $\\sigma'(V(x)) = f(V(x) + c^2)$, let $g(x) = V(x) + c^2$. Then:\n5372: \n5373: $$\n5374: \\nabla^m \\sigma'(V) = \\sum_{\\pi \\in \\mathcal{P}_m} f^{(|\\pi|)}(g) \\cdot B_\\pi(\\nabla g, \\nabla^2 g, \\ldots, \\nabla^m g)\n5375: \n5376: $$\n5377: \n5378: **Step 3: Bounding each partition contribution.**\n5379: \n5380: For partition $\\pi$ with $|\\pi| = \\ell$ blocks, the Bell polynomial $B_\\pi$ is a product:\n5381: \n5382: $$\n5383: B_\\pi = \\prod_{B \\in \\pi} \\nabla^{|B|} g\n5384: \n5385: $$\n5386: \n5387: where $B$ ranges over blocks of $\\pi$ and $\\sum_{B \\in \\pi} |B| = m$.\n5388: \n5389: Using $\\|\\nabla^k g\\| = \\|\\nabla^k V\\| \\leq M_k$:\n5390: \n5391: $$\n5392: \\|B_\\pi\\| \\leq \\prod_{B \\in \\pi} M_{|B|}\n5393: \n5394: $$\n5395: \n5396: **Step 4: Counting partitions and summing.**\n5397: \n5398: For fixed $\\ell$, the number of partitions of $m$ elements into $\\ell$ non-empty blocks is the **Stirling number of the second kind** $S(m, \\ell)$, which satisfies:\n5399: \n5400: $$\n5401: S(m, \\ell) \\leq \\frac{\\ell^m}{\\ell!}\n5402: \n5403: $$\n5404: \n5405: Combining:\n5406: \n5407: $$\n5408: \\begin{aligned}\n5409: \\|\\nabla^m \\sigma'\\| &\\leq \\sum_{\\ell=1}^m |f^{(\\ell)}(g)| \\cdot \\sum_{\\pi: |\\pi|=\\ell} \\|B_\\pi\\| \\\\\n5410: &\\leq \\sum_{\\ell=1}^m \\frac{C \\ell!}{c^{\\ell-1}} \\cdot S(m,\\ell) \\cdot (\\text{bound on } B_\\pi)\n5411: \\end{aligned}\n5412: \n5413: $$\n5414: \n5415: **Step 5: Worst-case scenario - all derivatives contribute.**\n5416: \n5417: The dominant contribution comes from $\\ell = 1$ (single block, using $\\nabla^m V$ directly):\n5418: \n5419: $$\n5420: \\|\\nabla^m \\sigma'\\| \\geq |f^{(1)}(g)| \\cdot \\|\\nabla^m V\\| \\sim \\frac{1}{c} M_m\n5421: \n5422: $$\n5423: \n5424: But the total sum over all partitions gives:\n5425: \n5426: $$\n5427: \\|\\nabla^m \\sigma'\\| \\leq C \\sum_{\\ell=1}^m \\ell! \\cdot c^{-(\\ell-1)} \\cdot \\frac{\\ell^m}{\\ell!} \\cdot \\prod_k M_k^{(\\text{multiplicity})}\n5428: \n5429: $$\n5430: \n5431: **Step 6: Factorial bound emerges.**\n5432: \n5433: The key observation is that the Stirling numbers and factorial from $f^{(\\ell)}$ **combine multiplicatively**, not additively. The dominant term in the sum is $\\ell = m$ (each derivative appears once):\n5434: \n5435: $$\n5436: \\|\\nabla^m \\sigma'\\| \\leq C \\cdot m! \\cdot c^{-(m-1)} \\cdot \\prod_{k=1}^m M_k^{(a_k)}\n5437: \n5438: $$\n5439: \n5440: where $\\sum k \\cdot a_k = m$ (partition constraint) and $\\sum a_k = m$ (Bell polynomial structure).\n5441: \n5442: For $M_k = \\mathcal{O}(k!)$ (Gevrey-1 input), this gives:\n5443: \n5444: $$\n5445: \\|\\nabla^m \\sigma'\\| \\leq C \\cdot m! \\cdot (\\text{poly}(m)) = \\mathcal{O}(m!)\n5446: \n5447: $$\n5448: \n5449: where the polynomial factor comes from combining products of factorial-growth inputs.\n5450: "
    },
    {
      "directive_type": "corollary",
      "label": "cor-gevrey-closure",
      "title": "Gevrey-1 Closure Under Smooth Composition",
      "start_line": 5454,
      "end_line": 5472,
      "header_lines": [
        5455
      ],
      "content_start": 5457,
      "content_end": 5471,
      "content": "5457: :label: cor-gevrey-closure\n5458: \n5459: If $f: \\mathbb{R}^k \\to \\mathbb{R}$ is Gevrey-1 (satisfies $\\|\\nabla^m f\\| \\leq C_f m! \\rho^{-m}$) and $g_1, \\ldots, g_k: \\mathbb{R}^d \\to \\mathbb{R}$ are each Gevrey-1 with $\\|\\nabla^m g_i\\| \\leq C_i m! \\sigma^{-m}$, then the composition:\n5460: \n5461: $$\n5462: h(x) = f(g_1(x), \\ldots, g_k(x))\n5463: \n5464: $$\n5465: \n5466: is Gevrey-1 with:\n5467: \n5468: $$\n5469: \\|\\nabla^m h\\| \\leq C_h m! \\cdot \\max(\\rho, \\sigma)^{-m}\n5470: \n5471: $$",
      "metadata": {
        "label": "cor-gevrey-closure"
      },
      "section": "## Appendix A: Combinatorial Proof of Gevrey-1 Bounds via Fa\u00e0 di Bruno Formula",
      "references": [],
      "raw_directive": "5454: ### A.3 General Principle: Factorial Preservation Under Composition\n5455: \n5456: :::{prf:corollary} Gevrey-1 Closure Under Smooth Composition\n5457: :label: cor-gevrey-closure\n5458: \n5459: If $f: \\mathbb{R}^k \\to \\mathbb{R}$ is Gevrey-1 (satisfies $\\|\\nabla^m f\\| \\leq C_f m! \\rho^{-m}$) and $g_1, \\ldots, g_k: \\mathbb{R}^d \\to \\mathbb{R}$ are each Gevrey-1 with $\\|\\nabla^m g_i\\| \\leq C_i m! \\sigma^{-m}$, then the composition:\n5460: \n5461: $$\n5462: h(x) = f(g_1(x), \\ldots, g_k(x))\n5463: \n5464: $$\n5465: \n5466: is Gevrey-1 with:\n5467: \n5468: $$\n5469: \\|\\nabla^m h\\| \\leq C_h m! \\cdot \\max(\\rho, \\sigma)^{-m}\n5470: \n5471: $$\n5472: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-256",
      "title": null,
      "start_line": 5474,
      "end_line": 5476,
      "header_lines": [],
      "content_start": 5475,
      "content_end": 5475,
      "content": "5475: ",
      "metadata": {},
      "section": "## Appendix A: Combinatorial Proof of Gevrey-1 Bounds via Fa\u00e0 di Bruno Formula",
      "references": [
        "thm-faa-di-bruno-appendix"
      ],
      "raw_directive": "5474: :::\n5475: \n5476: :::{prf:proof}"
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}