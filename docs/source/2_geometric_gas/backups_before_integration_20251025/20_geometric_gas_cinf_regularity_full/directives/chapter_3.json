{
  "chapter_index": 3,
  "section_id": "## 2. Companion Selection Mechanisms: Framework Context",
  "directive_count": 13,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-velocity-squashing-compact-domain-full",
      "title": "Velocity Squashing Ensures Compact Phase Space",
      "start_line": 618,
      "end_line": 637,
      "header_lines": [
        619
      ],
      "content_start": 621,
      "content_end": 636,
      "content": "621: :label: lem-velocity-squashing-compact-domain-full\n622: \n623: The Geometric Gas algorithmic velocity is defined via a smooth squashing map (see {prf:ref}`doc-02-euclidean-gas` \u00a74.2):\n624: \n625: $$\n626: v_{\\text{alg}} = \\psi(v) = V_{\\max} \\cdot \\tanh(v / V_{\\max})\n627: $$\n628: \n629: where v is the dynamical velocity evolved by the kinetic operator.\n630: \n631: **Properties**:\n632: 1. **Boundedness**: \u2016\u03c8(v)\u2016 < V_max for all v \u2208 \u211d^d (compact image V = B(0, V_max))\n633: 2. **Smoothness**: \u03c8 \u2208 C^\u221e with \u2016\u2207^m \u03c8\u2016 \u2264 C_\u03c8,m V_max^{1-m} (Gevrey-1)\n634: 3. **Near-identity**: \u03c8(v) \u2248 v for \u2016v\u2016 \u226a V_max (non-intrusive)\n635: \n636: **Consequence**: The phase space \ud835\udcb3 \u00d7 V is compact (\ud835\udcb3 is assumed compact, V is bounded by squashing).",
      "metadata": {
        "label": "lem-velocity-squashing-compact-domain-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [
        "doc-02-euclidean-gas"
      ],
      "raw_directive": "618: Each step depends only on previous steps. The assumption \u03c1_max is **explicit** and **validated for consistency**.\n619: \n620: :::{prf:lemma} Velocity Squashing Ensures Compact Phase Space\n621: :label: lem-velocity-squashing-compact-domain-full\n622: \n623: The Geometric Gas algorithmic velocity is defined via a smooth squashing map (see {prf:ref}`doc-02-euclidean-gas` \u00a74.2):\n624: \n625: $$\n626: v_{\\text{alg}} = \\psi(v) = V_{\\max} \\cdot \\tanh(v / V_{\\max})\n627: $$\n628: \n629: where v is the dynamical velocity evolved by the kinetic operator.\n630: \n631: **Properties**:\n632: 1. **Boundedness**: \u2016\u03c8(v)\u2016 < V_max for all v \u2208 \u211d^d (compact image V = B(0, V_max))\n633: 2. **Smoothness**: \u03c8 \u2208 C^\u221e with \u2016\u2207^m \u03c8\u2016 \u2264 C_\u03c8,m V_max^{1-m} (Gevrey-1)\n634: 3. **Near-identity**: \u03c8(v) \u2248 v for \u2016v\u2016 \u226a V_max (non-intrusive)\n635: \n636: **Consequence**: The phase space \ud835\udcb3 \u00d7 V is compact (\ud835\udcb3 is assumed compact, V is bounded by squashing).\n637: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-fokker-planck-density-bound-conservative-full",
      "title": "Fokker-Planck Density Bound from Lipschitz Drift (Conservative Case)",
      "start_line": 639,
      "end_line": 665,
      "header_lines": [
        640
      ],
      "content_start": 642,
      "content_end": 664,
      "content": "642: :label: lem-fokker-planck-density-bound-conservative-full\n643: \n644: Consider the **conservative** Fokker-Planck equation on compact phase space \ud835\udcb3 \u00d7 V:\n645: \n646: $$\n647: \\frac{\\partial \\rho}{\\partial t} = -\\psi(v) \\cdot \\nabla_x \\rho + \\nabla_v \\cdot \\left(\\gamma v \\rho + \\nabla_x V_{\\text{fit}} \\cdot \\rho\\right) + \\gamma T \\Delta_v \\rho\n648: $$\n649: \n650: **Note**: This PDE does NOT include cloning source/sink terms. It describes the conservative Langevin dynamics.\n651: \n652: Assume:\n653: - V_fit has Lipschitz gradient: \u2016\u2207_x V_fit\u2016 \u2264 L_V (from C\u00b3 regularity, doc-13)\n654: - Velocity domain is compact: \u2016v\u2016 \u2264 V_max (from Lemma {prf:ref}`lem-velocity-squashing-compact-domain-full`)\n655: - Spatial domain \ud835\udcb3 is compact\n656: - Kinetic diffusion \u03b3T > 0 (non-degenerate)\n657: \n658: Then the invariant measure \u03c1_\u221e (if it exists) satisfies:\n659: \n660: $$\n661: \\rho_{\\infty}(x,v) \\leq C_{\\text{FK}}(\\gamma, T, L_V, V_{\\max}, \\text{Vol}(\\mathcal{X})) < \\infty\n662: $$\n663: \n664: where C_FK is uniform over the compact domain.",
      "metadata": {
        "label": "lem-fokker-planck-density-bound-conservative-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [
        "lem-velocity-squashing-compact-domain-full"
      ],
      "raw_directive": "639: :::\n640: \n641: :::{prf:lemma} Fokker-Planck Density Bound from Lipschitz Drift (Conservative Case)\n642: :label: lem-fokker-planck-density-bound-conservative-full\n643: \n644: Consider the **conservative** Fokker-Planck equation on compact phase space \ud835\udcb3 \u00d7 V:\n645: \n646: $$\n647: \\frac{\\partial \\rho}{\\partial t} = -\\psi(v) \\cdot \\nabla_x \\rho + \\nabla_v \\cdot \\left(\\gamma v \\rho + \\nabla_x V_{\\text{fit}} \\cdot \\rho\\right) + \\gamma T \\Delta_v \\rho\n648: $$\n649: \n650: **Note**: This PDE does NOT include cloning source/sink terms. It describes the conservative Langevin dynamics.\n651: \n652: Assume:\n653: - V_fit has Lipschitz gradient: \u2016\u2207_x V_fit\u2016 \u2264 L_V (from C\u00b3 regularity, doc-13)\n654: - Velocity domain is compact: \u2016v\u2016 \u2264 V_max (from Lemma {prf:ref}`lem-velocity-squashing-compact-domain-full`)\n655: - Spatial domain \ud835\udcb3 is compact\n656: - Kinetic diffusion \u03b3T > 0 (non-degenerate)\n657: \n658: Then the invariant measure \u03c1_\u221e (if it exists) satisfies:\n659: \n660: $$\n661: \\rho_{\\infty}(x,v) \\leq C_{\\text{FK}}(\\gamma, T, L_V, V_{\\max}, \\text{Vol}(\\mathcal{X})) < \\infty\n662: $$\n663: \n664: where C_FK is uniform over the compact domain.\n665: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-285",
      "title": null,
      "start_line": 667,
      "end_line": 683,
      "header_lines": [],
      "content_start": 668,
      "content_end": 682,
      "content": "668: \n669: :::{prf:proof}\n670: **Proof sketch** (conservative case):\n671: \n672: The generator for the conservative Langevin dynamics is:\n673: \n674: $$\n675: \\mathcal{L} f = -\\psi(v) \\cdot \\nabla_x f + \\gamma v \\cdot \\nabla_v f + \\nabla_x V_{\\text{fit}} \\cdot \\nabla_v f + \\gamma T \\Delta_v f\n676: $$\n677: \n678: **Key steps**:\n679: 1. Lipschitz drift + non-degenerate diffusion \u2192 semigroup maps L^\u221e to L^\u221e\n680: 2. Compactness of \ud835\udcb3 \u00d7 V \u2192 V_fit and kinetic energy uniformly bounded\n681: 3. Invariant density satisfies: \u03c1_\u221e(x,v) \u2264 C exp((V_fit(x) + \u00bd\u2016v\u2016\u00b2)/(\u03b3T))\n682: 4. Since both terms in exponent are bounded \u2192 \u03c1_\u221e \u2264 C_FK < \u221e",
      "metadata": {},
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [],
      "raw_directive": "667: :::\n668: \n669: :::{prf:proof}\n670: **Proof sketch** (conservative case):\n671: \n672: The generator for the conservative Langevin dynamics is:\n673: \n674: $$\n675: \\mathcal{L} f = -\\psi(v) \\cdot \\nabla_x f + \\gamma v \\cdot \\nabla_v f + \\nabla_x V_{\\text{fit}} \\cdot \\nabla_v f + \\gamma T \\Delta_v f\n676: $$\n677: \n678: **Key steps**:\n679: 1. Lipschitz drift + non-degenerate diffusion \u2192 semigroup maps L^\u221e to L^\u221e\n680: 2. Compactness of \ud835\udcb3 \u00d7 V \u2192 V_fit and kinetic energy uniformly bounded\n681: 3. Invariant density satisfies: \u03c1_\u221e(x,v) \u2264 C exp((V_fit(x) + \u00bd\u2016v\u2016\u00b2)/(\u03b3T))\n682: 4. Since both terms in exponent are bounded \u2192 \u03c1_\u221e \u2264 C_FK < \u221e\n683: "
    },
    {
      "directive_type": "lemma",
      "label": "verif-c3-independence-revised",
      "title": "QSD Density Bound with Cloning (Conditional Statement)",
      "start_line": 685,
      "end_line": 736,
      "header_lines": [
        686,
        709
      ],
      "content_start": 688,
      "content_end": 735,
      "content": "688: :label: lem-qsd-density-bound-with-cloning-full\n689: \n690: The Geometric Gas dynamics include cloning (birth-death process conditioned on alive set non-empty). The QSD satisfies:\n691: \n692: **Conditional result**: If the QSD \u03c0_QSD exists and is unique (established via Keystone Principle ergodicity), then under the following:\n693: \n694: 1. The **conservative** Fokker-Planck invariant measure has density bound \u03c1_FK \u2264 C_FK (Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full`)\n695: 2. The cloning rate \u03bb_clone is finite\n696: 3. The domain \ud835\udcb3 \u00d7 V is compact (velocity squashing)\n697: \n698: The QSD density satisfies:\n699: \n700: $$\n701: \\rho_{\\text{QSD}}(x,v) \\leq C_{\\text{QSD}} \\cdot C_{\\text{FK}}\n702: $$\n703: \n704: where C_QSD depends on \u03bb_clone and domain volume, but is **finite**.\n705: \n706: **Rigorous proof**: A complete proof requires analyzing the generator of the conditioned process (QSD generator = Fokker-Planck generator + cloning source/sink + ground state projection). This is subject of ongoing research in QSD theory for interacting particle systems (see Champagnat-Villemonais 2017, *Exponential convergence to quasi-stationary distribution*; Cloez-Thai 2018, *Quantitative results for QSD convergence*).\n707: \n708: **For this document**: We state \u03c1_max as an explicit assumption (Assumption {prf:ref}`assump-uniform-density-full`) below and validate consistency.\n709: \n710: :::{prf:verification} Independence of C\u00b3 Regularity Analysis\n711: :label: verif-c3-independence-revised\n712: \n713: To ensure the logical chain is non-circular, we verify that the C\u00b3 regularity proof in {prf:ref}`doc-13-geometric-gas-c3-regularity` uses only:\n714: \n715: **Allowed inputs**:\n716: 1. **Companion availability** (Lemma {prf:ref}`lem-companion-availability-enforcement`) - derived below from Keystone + volume\n717: 2. **Bounded measurements**: d_alg \u2264 diam(\ud835\udcb3 \u00d7 V) < \u221e (from compact domain)\n718: 3. **Regularization**: \u03b5_d > 0 eliminates singularities\n719: 4. **Rescale function**: g_A \u2208 C\u00b3 with bounded derivatives\n720: 5. **Density bound**: \u03c1_max (now EXPLICITLY ASSUMED, see below)\n721: \n722: **Critically, doc-13 does NOT assume**:\n723: - \u2717 C^\u221e regularity\n724: - \u2717 k-uniform bounds at all orders\n725: - \u2717 Anything from this document (doc-20)\n726: \n727: **Verification method**: Direct inspection of doc-13 confirms only the above five inputs are used.\n728: \n729: **Conclusion**: The logical chain is:\n730: 1. **Companion availability** \u2190 Keystone + volume (\u00a72.4 below, NO density assumption)\n731: 2. **C\u00b3 regularity** \u2190 Companion availability + **\u03c1_max assumption** + elementary bounds\n732: 3. **Lipschitz gradient L_V** \u2190 C\u00b3\n733: 4. **Fokker-Planck bound C_FK** \u2190 L_V + compact domain + velocity squashing\n734: 5. **Consistency check** \u2190 C_FK(L_V(\u03c1_max)) should have fixed point \u03c1_max*\n735: 6. **C^\u221e regularity** \u2190 \u03c1_max* + C\u00b3 + advanced machinery (this document)",
      "metadata": {
        "label": "verif-c3-independence-revised"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [
        "lem-fokker-planck-density-bound-conservative-full",
        "assump-uniform-density-full",
        "doc-13-geometric-gas-c3-regularity",
        "lem-companion-availability-enforcement"
      ],
      "raw_directive": "685: :::\n686: \n687: :::{prf:lemma} QSD Density Bound with Cloning (Conditional Statement)\n688: :label: lem-qsd-density-bound-with-cloning-full\n689: \n690: The Geometric Gas dynamics include cloning (birth-death process conditioned on alive set non-empty). The QSD satisfies:\n691: \n692: **Conditional result**: If the QSD \u03c0_QSD exists and is unique (established via Keystone Principle ergodicity), then under the following:\n693: \n694: 1. The **conservative** Fokker-Planck invariant measure has density bound \u03c1_FK \u2264 C_FK (Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full`)\n695: 2. The cloning rate \u03bb_clone is finite\n696: 3. The domain \ud835\udcb3 \u00d7 V is compact (velocity squashing)\n697: \n698: The QSD density satisfies:\n699: \n700: $$\n701: \\rho_{\\text{QSD}}(x,v) \\leq C_{\\text{QSD}} \\cdot C_{\\text{FK}}\n702: $$\n703: \n704: where C_QSD depends on \u03bb_clone and domain volume, but is **finite**.\n705: \n706: **Rigorous proof**: A complete proof requires analyzing the generator of the conditioned process (QSD generator = Fokker-Planck generator + cloning source/sink + ground state projection). This is subject of ongoing research in QSD theory for interacting particle systems (see Champagnat-Villemonais 2017, *Exponential convergence to quasi-stationary distribution*; Cloez-Thai 2018, *Quantitative results for QSD convergence*).\n707: \n708: **For this document**: We state \u03c1_max as an explicit assumption (Assumption {prf:ref}`assump-uniform-density-full`) below and validate consistency.\n709: \n710: :::{prf:verification} Independence of C\u00b3 Regularity Analysis\n711: :label: verif-c3-independence-revised\n712: \n713: To ensure the logical chain is non-circular, we verify that the C\u00b3 regularity proof in {prf:ref}`doc-13-geometric-gas-c3-regularity` uses only:\n714: \n715: **Allowed inputs**:\n716: 1. **Companion availability** (Lemma {prf:ref}`lem-companion-availability-enforcement`) - derived below from Keystone + volume\n717: 2. **Bounded measurements**: d_alg \u2264 diam(\ud835\udcb3 \u00d7 V) < \u221e (from compact domain)\n718: 3. **Regularization**: \u03b5_d > 0 eliminates singularities\n719: 4. **Rescale function**: g_A \u2208 C\u00b3 with bounded derivatives\n720: 5. **Density bound**: \u03c1_max (now EXPLICITLY ASSUMED, see below)\n721: \n722: **Critically, doc-13 does NOT assume**:\n723: - \u2717 C^\u221e regularity\n724: - \u2717 k-uniform bounds at all orders\n725: - \u2717 Anything from this document (doc-20)\n726: \n727: **Verification method**: Direct inspection of doc-13 confirms only the above five inputs are used.\n728: \n729: **Conclusion**: The logical chain is:\n730: 1. **Companion availability** \u2190 Keystone + volume (\u00a72.4 below, NO density assumption)\n731: 2. **C\u00b3 regularity** \u2190 Companion availability + **\u03c1_max assumption** + elementary bounds\n732: 3. **Lipschitz gradient L_V** \u2190 C\u00b3\n733: 4. **Fokker-Planck bound C_FK** \u2190 L_V + compact domain + velocity squashing\n734: 5. **Consistency check** \u2190 C_FK(L_V(\u03c1_max)) should have fixed point \u03c1_max*\n735: 6. **C^\u221e regularity** \u2190 \u03c1_max* + C\u00b3 + advanced machinery (this document)\n736: "
    },
    {
      "directive_type": "verification",
      "label": "verif-density-bound-consistency-full",
      "title": "A Posteriori Consistency of Density Assumption",
      "start_line": 738,
      "end_line": 765,
      "header_lines": [
        739
      ],
      "content_start": 741,
      "content_end": 764,
      "content": "741: :label: verif-density-bound-consistency-full\n742: \n743: We verify that the assumed density bound \u03c1_max is **self-consistent** with the derived C\u00b3 regularity.\n744: \n745: **Logical structure**:\n746: 1. **Assume** \u03c1_max (Assumption {prf:ref}`assump-uniform-density-full` below)\n747: 2. **Derive** C\u00b3 regularity using \u03c1_max (doc-13, companion availability, bounded sums)\n748: 3. **Extract** Lipschitz constant L_V from C\u00b3 bounds (doc-13 Theorem 8.1)\n749: 4. **Compute** Fokker-Planck bound C_FK(L_V, \u03b3, T, V_max) (Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full`)\n750: 5. **Check** whether C_FK is compatible with assumed \u03c1_max\n751: \n752: **Consistency condition**:\n753: \n754: $$\n755: C_{\\text{FK}}(L_V(\\rho_{\\max}), \\gamma, T, V_{\\max}) \\leq C_{\\text{QSD}} \\cdot \\rho_{\\max}\n756: $$\n757: \n758: **Interpretation**: If this inequality holds for a chosen value of \u03c1_max, the assumption set is **consistent**. The fixed point \u03c1_max* satisfying:\n759: \n760: $$\n761: \\rho_{\\max}^* = C_{\\text{QSD}} \\cdot C_{\\text{FK}}(L_V(\\rho_{\\max}^*), \\gamma, T, V_{\\max})\n762: $$\n763: \n764: provides a self-consistent density bound.",
      "metadata": {
        "label": "verif-density-bound-consistency-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [
        "assump-uniform-density-full",
        "lem-fokker-planck-density-bound-conservative-full"
      ],
      "raw_directive": "738: :::\n739: \n740: :::{prf:verification} A Posteriori Consistency of Density Assumption\n741: :label: verif-density-bound-consistency-full\n742: \n743: We verify that the assumed density bound \u03c1_max is **self-consistent** with the derived C\u00b3 regularity.\n744: \n745: **Logical structure**:\n746: 1. **Assume** \u03c1_max (Assumption {prf:ref}`assump-uniform-density-full` below)\n747: 2. **Derive** C\u00b3 regularity using \u03c1_max (doc-13, companion availability, bounded sums)\n748: 3. **Extract** Lipschitz constant L_V from C\u00b3 bounds (doc-13 Theorem 8.1)\n749: 4. **Compute** Fokker-Planck bound C_FK(L_V, \u03b3, T, V_max) (Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full`)\n750: 5. **Check** whether C_FK is compatible with assumed \u03c1_max\n751: \n752: **Consistency condition**:\n753: \n754: $$\n755: C_{\\text{FK}}(L_V(\\rho_{\\max}), \\gamma, T, V_{\\max}) \\leq C_{\\text{QSD}} \\cdot \\rho_{\\max}\n756: $$\n757: \n758: **Interpretation**: If this inequality holds for a chosen value of \u03c1_max, the assumption set is **consistent**. The fixed point \u03c1_max* satisfying:\n759: \n760: $$\n761: \\rho_{\\max}^* = C_{\\text{QSD}} \\cdot C_{\\text{FK}}(L_V(\\rho_{\\max}^*), \\gamma, T, V_{\\max})\n762: $$\n763: \n764: provides a self-consistent density bound.\n765: "
    },
    {
      "directive_type": "remark",
      "label": "rem-keystone-condition-contraction-full",
      "title": "Keystone Parameter Condition for Contraction",
      "start_line": 767,
      "end_line": 806,
      "header_lines": [
        768
      ],
      "content_start": 770,
      "content_end": 805,
      "content": "770: :label: rem-keystone-condition-contraction-full\n771: \n772: The fixed-point iteration $\\rho_{\\max}^{(n+1)} = T(\\rho_{\\max}^{(n)})$ where $T(\\rho) = C_{\\text{QSD}} \\cdot C_{\\text{FK}}(L_V(\\rho), \\gamma, T, V_{\\max})$ is a contraction if:\n773: \n774: $$\n775: \\frac{dT}{d\\rho} = C_{\\text{QSD}} \\cdot \\frac{\\partial C_{\\text{FK}}}{\\partial L_V} \\cdot \\frac{dL_V}{d\\rho} < 1\n776: \n777: $$\n778: \n779: **Explicit Keystone condition**: From Fokker-Planck theory (Bogachev-Krylov-R\u00f6ckner, 2001), the density bound satisfies:\n780: \n781: $$\n782: C_{\\text{FK}}(L_V, \\gamma, T, V_{\\max}) \\leq \\frac{C_0}{\\text{Vol}(\\mathcal{X} \\times V)} \\cdot \\exp\\left(\\frac{A_{\\text{fit}} \\cdot L_{\\phi}}{\\gamma T}\\right)\n783: \n784: $$\n785: \n786: where:\n787: - $A_{\\text{fit}}$: Fitness amplitude (maximum $|\\nabla V_{\\text{fit}}|$)\n788: - $L_{\\phi}$: Lipschitz constant of projection map $\\phi: \\mathcal{Y} \\to \\mathcal{X}$ (equals 1 for Euclidean phase space)\n789: - $\\gamma T$: Kinetic diffusion coefficient\n790: \n791: For the fixed point to exist, the **Keystone parameter regime** ({prf:ref}`doc-03-cloning`, Theorem 3.5) requires:\n792: \n793: $$\n794: \\frac{A_{\\text{fit}} \\cdot L_{\\phi}}{\\gamma T} < C_{\\text{contract}}\n795: \n796: $$\n797: \n798: where $C_{\\text{contract}}$ is a critical threshold (typically $C_{\\text{contract}} \\approx 1$-$2$ depending on domain geometry).\n799: \n800: **Verification for Geometric Gas**:\n801: - $A_{\\text{fit}} = \\mathcal{O}(A)$ (rescale function amplitude)\n802: - $L_{\\phi} = 1$ (Euclidean phase space)\n803: - Keystone regime: $\\gamma T \\gg A$ (high kinetic diffusion relative to fitness amplitude)\n804: \n805: Therefore: $A/(\u03b3T) \\ll 1$, ensuring contraction and fixed-point existence.",
      "metadata": {
        "label": "rem-keystone-condition-contraction-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [
        "doc-03-cloning"
      ],
      "raw_directive": "767: :::\n768: \n769: :::{prf:remark} Keystone Parameter Condition for Contraction\n770: :label: rem-keystone-condition-contraction-full\n771: \n772: The fixed-point iteration $\\rho_{\\max}^{(n+1)} = T(\\rho_{\\max}^{(n)})$ where $T(\\rho) = C_{\\text{QSD}} \\cdot C_{\\text{FK}}(L_V(\\rho), \\gamma, T, V_{\\max})$ is a contraction if:\n773: \n774: $$\n775: \\frac{dT}{d\\rho} = C_{\\text{QSD}} \\cdot \\frac{\\partial C_{\\text{FK}}}{\\partial L_V} \\cdot \\frac{dL_V}{d\\rho} < 1\n776: \n777: $$\n778: \n779: **Explicit Keystone condition**: From Fokker-Planck theory (Bogachev-Krylov-R\u00f6ckner, 2001), the density bound satisfies:\n780: \n781: $$\n782: C_{\\text{FK}}(L_V, \\gamma, T, V_{\\max}) \\leq \\frac{C_0}{\\text{Vol}(\\mathcal{X} \\times V)} \\cdot \\exp\\left(\\frac{A_{\\text{fit}} \\cdot L_{\\phi}}{\\gamma T}\\right)\n783: \n784: $$\n785: \n786: where:\n787: - $A_{\\text{fit}}$: Fitness amplitude (maximum $|\\nabla V_{\\text{fit}}|$)\n788: - $L_{\\phi}$: Lipschitz constant of projection map $\\phi: \\mathcal{Y} \\to \\mathcal{X}$ (equals 1 for Euclidean phase space)\n789: - $\\gamma T$: Kinetic diffusion coefficient\n790: \n791: For the fixed point to exist, the **Keystone parameter regime** ({prf:ref}`doc-03-cloning`, Theorem 3.5) requires:\n792: \n793: $$\n794: \\frac{A_{\\text{fit}} \\cdot L_{\\phi}}{\\gamma T} < C_{\\text{contract}}\n795: \n796: $$\n797: \n798: where $C_{\\text{contract}}$ is a critical threshold (typically $C_{\\text{contract}} \\approx 1$-$2$ depending on domain geometry).\n799: \n800: **Verification for Geometric Gas**:\n801: - $A_{\\text{fit}} = \\mathcal{O}(A)$ (rescale function amplitude)\n802: - $L_{\\phi} = 1$ (Euclidean phase space)\n803: - Keystone regime: $\\gamma T \\gg A$ (high kinetic diffusion relative to fitness amplitude)\n804: \n805: Therefore: $A/(\u03b3T) \\ll 1$, ensuring contraction and fixed-point existence.\n806: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-companion-availability-enforcement",
      "title": "Partition Function Lower Bound from Compactness",
      "start_line": 814,
      "end_line": 830,
      "header_lines": [
        815
      ],
      "content_start": 817,
      "content_end": 829,
      "content": "817: :label: lem-companion-availability-enforcement\n818: \n819: For any walker $i \\in \\mathcal{A}$ in the alive set with $k \\geq 2$, the softmax partition function satisfies:\n820: \n821: $$\n822: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n823: \n824: $$\n825: \n826: where $D_{\\max} = \\text{diam}(\\mathcal{X} \\times V)$ is the phase-space diameter (finite by compactness).\n827: \n828: **Key properties**:\n829: 1. **Non-vanishing**: $Z_{\\min} > 0$ is strictly positive for all $i \\in \\mathcal{A}$",
      "metadata": {
        "label": "lem-companion-availability-enforcement"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [],
      "raw_directive": "814: With the approach to the density bound clarified (explicit assumption with a posteriori validation, \u00a72.3.5 above), we now state the three framework assumptions:\n815: \n816: :::{prf:lemma} Partition Function Lower Bound from Compactness\n817: :label: lem-companion-availability-enforcement\n818: \n819: For any walker $i \\in \\mathcal{A}$ in the alive set with $k \\geq 2$, the softmax partition function satisfies:\n820: \n821: $$\n822: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n823: \n824: $$\n825: \n826: where $D_{\\max} = \\text{diam}(\\mathcal{X} \\times V)$ is the phase-space diameter (finite by compactness).\n827: \n828: **Key properties**:\n829: 1. **Non-vanishing**: $Z_{\\min} > 0$ is strictly positive for all $i \\in \\mathcal{A}$\n830: 2. **k-uniform**: The bound depends only on domain diameter $D_{\\max}$ and parameter $\\varepsilon_c$, **not on the number of walkers** $k$ or $N$"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-450",
      "title": null,
      "start_line": 832,
      "end_line": 887,
      "header_lines": [],
      "content_start": 833,
      "content_end": 886,
      "content": "833: \n834: :::{prf:proof}\n835: **Direct proof from compactness and minimum walker requirement.**\n836: \n837: The proof uses ONLY primitive assumptions:\n838: 1. **Bounded domain**: $\\mathcal{X} \\times V$ is compact, so $D_{\\max} := \\text{diam}(\\mathcal{X} \\times V) < \\infty$\n839: 2. **Minimum walkers**: Cloning enforces $k \\geq k_{\\min} \\geq 2$ (at least 2 alive walkers)\n840: 3. **Self-exclusion**: By definition, walker $i$ cannot choose itself as companion\n841: \n842: **Step 1: Partition function structure.**\n843: \n844: The softmax partition function is:\n845: \n846: $$\n847: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right)\n848: \n849: $$\n850: \n851: Since $k \\geq 2$, the set $\\mathcal{A} \\setminus \\{i\\}$ contains **at least one walker** $\\ell \\neq i$. Therefore, the sum has at least $k-1 \\geq 1$ term.\n852: \n853: **Step 2: Lower bound for each term.**\n854: \n855: For any walker $\\ell \\in \\mathcal{A} \\setminus \\{i\\}$:\n856: \n857: $$\n858: \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right)\n859: \n860: $$\n861: \n862: since $d_{\\text{alg}}(i,\\ell) \\leq D_{\\max}$ by compactness (worst case: $\\ell$ is at maximum distance from $i$).\n863: \n864: **Step 3: Combine to obtain lower bound.**\n865: \n866: Since $Z_i$ is a sum of at least one term, each at least $\\exp(-D_{\\max}^2/(2\\varepsilon_c^2))$:\n867: \n868: $$\n869: Z_i \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n870: \n871: $$\n872: \n873: **Step 4: k-uniformity verification.**\n874: \n875: The bound $Z_{\\min}$ depends only on:\n876: - **Domain diameter** $D_{\\max}$ (geometric property of $\\mathcal{X} \\times V$)\n877: - **Companion scale** $\\varepsilon_c$ (algorithmic parameter)\n878: \n879: It does **not** depend on:\n880: - \u2717 Number of alive walkers $k$\n881: - \u2717 Total walker count $N$\n882: - \u2717 Walker positions $\\{(x_j, v_j)\\}_{j \\in \\mathcal{A}}$\n883: - \u2717 Fitness potential regularity\n884: - \u2717 Density bounds\n885: \n886: **Conclusion**: The partition function lower bound $Z_i \\geq Z_{\\min} > 0$ holds **for all walkers** $i \\in \\mathcal{A}$ and **all swarm configurations** with $k \\geq 2$. This is a **primitive geometric bound** requiring no regularity or density assumptions.",
      "metadata": {},
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [],
      "raw_directive": "832: :::\n833: \n834: :::{prf:proof}\n835: **Direct proof from compactness and minimum walker requirement.**\n836: \n837: The proof uses ONLY primitive assumptions:\n838: 1. **Bounded domain**: $\\mathcal{X} \\times V$ is compact, so $D_{\\max} := \\text{diam}(\\mathcal{X} \\times V) < \\infty$\n839: 2. **Minimum walkers**: Cloning enforces $k \\geq k_{\\min} \\geq 2$ (at least 2 alive walkers)\n840: 3. **Self-exclusion**: By definition, walker $i$ cannot choose itself as companion\n841: \n842: **Step 1: Partition function structure.**\n843: \n844: The softmax partition function is:\n845: \n846: $$\n847: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right)\n848: \n849: $$\n850: \n851: Since $k \\geq 2$, the set $\\mathcal{A} \\setminus \\{i\\}$ contains **at least one walker** $\\ell \\neq i$. Therefore, the sum has at least $k-1 \\geq 1$ term.\n852: \n853: **Step 2: Lower bound for each term.**\n854: \n855: For any walker $\\ell \\in \\mathcal{A} \\setminus \\{i\\}$:\n856: \n857: $$\n858: \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right)\n859: \n860: $$\n861: \n862: since $d_{\\text{alg}}(i,\\ell) \\leq D_{\\max}$ by compactness (worst case: $\\ell$ is at maximum distance from $i$).\n863: \n864: **Step 3: Combine to obtain lower bound.**\n865: \n866: Since $Z_i$ is a sum of at least one term, each at least $\\exp(-D_{\\max}^2/(2\\varepsilon_c^2))$:\n867: \n868: $$\n869: Z_i \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n870: \n871: $$\n872: \n873: **Step 4: k-uniformity verification.**\n874: \n875: The bound $Z_{\\min}$ depends only on:\n876: - **Domain diameter** $D_{\\max}$ (geometric property of $\\mathcal{X} \\times V$)\n877: - **Companion scale** $\\varepsilon_c$ (algorithmic parameter)\n878: \n879: It does **not** depend on:\n880: - \u2717 Number of alive walkers $k$\n881: - \u2717 Total walker count $N$\n882: - \u2717 Walker positions $\\{(x_j, v_j)\\}_{j \\in \\mathcal{A}}$\n883: - \u2717 Fitness potential regularity\n884: - \u2717 Density bounds\n885: \n886: **Conclusion**: The partition function lower bound $Z_i \\geq Z_{\\min} > 0$ holds **for all walkers** $i \\in \\mathcal{A}$ and **all swarm configurations** with $k \\geq 2$. This is a **primitive geometric bound** requiring no regularity or density assumptions.\n887: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-deterministic-packing-from-keystone-full",
      "title": "Deterministic Local Packing Bound from Keystone Ergodicity",
      "start_line": 889,
      "end_line": 916,
      "header_lines": [
        890
      ],
      "content_start": 892,
      "content_end": 915,
      "content": "892: :label: lem-deterministic-packing-from-keystone-full\n893: \n894: Under the Keystone Principle ({prf:ref}`doc-03-cloning`, Theorem 3.5) with kinetic diffusion (temperature $T > 0$, friction $\\gamma > 0$), the quasi-stationary distribution (QSD) satisfies a **deterministic uniform local packing bound**:\n895: \n896: For all swarm configurations $(x, v) \\in \\text{supp}(\\pi_{\\text{QSD}})$ in the support of the QSD, all walkers $i \\in \\mathcal{A}$, and all radii $r > 0$:\n897: \n898: $$\n899: \\#\\left\\{j \\in \\mathcal{A} : d_{\\text{alg}}(i,j) \\leq r\\right\\} \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(0, r))\n900: $$\n901: \n902: where:\n903: - $\\rho_{\\max} = C_{\\text{erg}}(\\gamma, T, A_{\\text{fit}}, \\text{Vol}(\\mathcal{X} \\times V))$ is a **deterministic constant** depending only on kinetic parameters and domain volume\n904: - $\\text{Vol}(B(0, r))$ is the phase-space volume of a ball of radius $r$ in the algorithmic metric\n905: - The bound holds **for all configurations**, not just with high probability\n906: \n907: **Key Properties**:\n908: 1. **Deterministic**: No probabilistic qualifier; holds on the entire QSD support\n909: 2. **k-uniform**: $\\rho_{\\max}$ is independent of the number of alive walkers $k$ or total swarm size $N$\n910: 3. **Universal**: Applies to all swarm configurations that have non-zero probability under the QSD\n911: \n912: **Physical Mechanism**: The deterministic packing bound arises from three synergistic mechanisms:\n913: 1. **Kinetic diffusion** ($T > 0$): Continuously injects random momentum, preventing walkers from remaining arbitrarily close\n914: 2. **Cloning diversity enforcement**: Preferentially removes walkers with low algorithmic diversity (those too close to companions)\n915: 3. **Keystone ergodicity**: Ensures pathological clustering states have measure zero in the QSD",
      "metadata": {
        "label": "lem-deterministic-packing-from-keystone-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [
        "doc-03-cloning",
        "lem-sum-to-integral-bound-full"
      ],
      "raw_directive": "889: :::\n890: \n891: :::{prf:lemma} Deterministic Local Packing Bound from Keystone Ergodicity\n892: :label: lem-deterministic-packing-from-keystone-full\n893: \n894: Under the Keystone Principle ({prf:ref}`doc-03-cloning`, Theorem 3.5) with kinetic diffusion (temperature $T > 0$, friction $\\gamma > 0$), the quasi-stationary distribution (QSD) satisfies a **deterministic uniform local packing bound**:\n895: \n896: For all swarm configurations $(x, v) \\in \\text{supp}(\\pi_{\\text{QSD}})$ in the support of the QSD, all walkers $i \\in \\mathcal{A}$, and all radii $r > 0$:\n897: \n898: $$\n899: \\#\\left\\{j \\in \\mathcal{A} : d_{\\text{alg}}(i,j) \\leq r\\right\\} \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(0, r))\n900: $$\n901: \n902: where:\n903: - $\\rho_{\\max} = C_{\\text{erg}}(\\gamma, T, A_{\\text{fit}}, \\text{Vol}(\\mathcal{X} \\times V))$ is a **deterministic constant** depending only on kinetic parameters and domain volume\n904: - $\\text{Vol}(B(0, r))$ is the phase-space volume of a ball of radius $r$ in the algorithmic metric\n905: - The bound holds **for all configurations**, not just with high probability\n906: \n907: **Key Properties**:\n908: 1. **Deterministic**: No probabilistic qualifier; holds on the entire QSD support\n909: 2. **k-uniform**: $\\rho_{\\max}$ is independent of the number of alive walkers $k$ or total swarm size $N$\n910: 3. **Universal**: Applies to all swarm configurations that have non-zero probability under the QSD\n911: \n912: **Physical Mechanism**: The deterministic packing bound arises from three synergistic mechanisms:\n913: 1. **Kinetic diffusion** ($T > 0$): Continuously injects random momentum, preventing walkers from remaining arbitrarily close\n914: 2. **Cloning diversity enforcement**: Preferentially removes walkers with low algorithmic diversity (those too close to companions)\n915: 3. **Keystone ergodicity**: Ensures pathological clustering states have measure zero in the QSD\n916: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-536",
      "title": null,
      "start_line": 918,
      "end_line": 977,
      "header_lines": [],
      "content_start": 919,
      "content_end": 976,
      "content": "919: \n920: :::{prf:proof}\n921: **Proof Strategy**: We establish the deterministic packing bound by showing that configurations violating it have zero measure in the QSD.\n922: \n923: **Step 1: Ergodic QSD Characterization**\n924: \n925: By the Keystone Principle ({prf:ref}`doc-03-cloning`, Theorem 3.5), the Geometric Gas dynamics admit a unique QSD $\\pi_{\\text{QSD}}$ that is:\n926: 1. **Ergodic**: Irreducible and aperiodic on the conditioned state space\n927: 2. **Exponentially converging**: $\\|\\mu_t - \\pi_{\\text{QSD}}\\|_{\\text{TV}} \\leq C e^{-\\lambda t}$ for any initial distribution\n928: 3. **Fitness-weighted**: Higher fitness regions have higher probability, but all regions are explored\n929: \n930: **Step 2: Kinetic Diffusion Lower Bound on Separation**\n931: \n932: The kinetic operator with diffusion $D = T/\\gamma$ satisfies a **Gaussian concentration bound** (standard result from Fokker-Planck theory): For walkers $i, j$ at time $t$, the relative separation $R_{ij}(t) = \\|x_i(t) - x_j(t)\\|$ satisfies:\n933: \n934: $$\n935: \\mathbb{P}_{\\text{QSD}}\\left(R_{ij} < \\varepsilon\\right) \\leq C_{\\text{diff}} \\cdot \\frac{\\varepsilon^d}{\\text{Vol}(\\mathcal{X})}\n936: $$\n937: \n938: This ensures no delta-function clustering occurs in the QSD.\n939: \n940: **Step 3: Cloning Diversity Enhancement**\n941: \n942: The cloning operator amplifies kinetic separation. By {prf:ref}`doc-03-cloning`, Lemma 5.1.2 (Diversity Maintenance), walkers with low algorithmic diversity have death rate:\n943: \n944: $$\n945: \\lambda_{\\text{death}}(i) \\geq \\lambda_0 \\cdot \\exp\\left(-\\frac{d_{\\text{alg}}(i, c(i))}{\\varepsilon_{\\text{pair}}}\\right)\n946: $$\n947: \n948: For clustered configurations where $m$ walkers satisfy $d_{\\text{alg}}(i,j) < r_{\\text{small}}$, the **total death rate** is exponentially enhanced: $\\Lambda_{\\text{cluster}} \\geq m \\cdot \\lambda_0 \\cdot e^{-r_{\\text{small}}/\\varepsilon_{\\text{pair}}} \\gg \\lambda_0$. This rapidly removes clustered states from the QSD.\n949: \n950: **Step 4: Uniform Density via Ergodic Theorem**\n951: \n952: By ergodicity, the QSD is the unique stationary measure. The density $\\rho_{\\text{phase}}^{\\text{QSD}}$ satisfies a **Fokker-Planck-Kolmogorov equation** with cloning source/sink terms. Standard elliptic regularity theory (Bogachev-Krylov-R\u00f6ckner, 2001) combined with:\n953: - Compactness of $\\mathcal{X} \\times V$ (velocity squashing, Lemma {prf:ref}`lem-velocity-squashing-compact-domain-full`)\n954: - Non-degenerate diffusion ($T > 0$)\n955: - Bounded drift ($\\|\\nabla V_{\\text{fit}}\\| \\leq L_V$ from C\u00b3 regularity, {prf:ref}`doc-13-geometric-gas-c3-regularity`)\n956: \n957: implies:\n958: \n959: $$\n960: \\rho_{\\text{phase}}^{\\text{QSD}}(x,v) \\leq \\rho_{\\max} := C_{\\text{FK}}(\\gamma, T, L_V, V_{\\max}, \\text{Vol}(\\mathcal{X}))\n961: $$\n962: \n963: **Step 5: Deterministic Packing Bound**\n964: \n965: Combining Steps 2-4, for any configuration $(x,v)$ in the **support** of $\\pi_{\\text{QSD}}$:\n966: 1. Kinetic diffusion ensures no delta-function clustering (Step 2)\n967: 2. Cloning removes near-clustered states exponentially fast (Step 3)\n968: 3. Ergodicity ensures only \"typical\" configurations (satisfying density bound) have positive measure (Step 4)\n969: \n970: Therefore, **on the QSD support**, the local density is bounded by $\\rho_{\\max}$, which implies:\n971: \n972: $$\n973: \\#\\{j : d_{\\text{alg}}(i,j) \\leq r\\} \\leq \\int_{B(x_i, r)} \\rho_{\\text{phase}}^{\\text{QSD}}(y,u) \\, dy \\, du \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(0, r))\n974: $$\n975: \n976: **Crucial Point**: Configurations violating this bound have **measure zero** in $\\pi_{\\text{QSD}}$ (by Steps 2-3, they are unstable and removed). Therefore, we can work with the bound deterministically on the QSD support.",
      "metadata": {},
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [
        "doc-03-cloning",
        "lem-velocity-squashing-compact-domain-full",
        "doc-13-geometric-gas-c3-regularity"
      ],
      "raw_directive": "918: :::\n919: \n920: :::{prf:proof}\n921: **Proof Strategy**: We establish the deterministic packing bound by showing that configurations violating it have zero measure in the QSD.\n922: \n923: **Step 1: Ergodic QSD Characterization**\n924: \n925: By the Keystone Principle ({prf:ref}`doc-03-cloning`, Theorem 3.5), the Geometric Gas dynamics admit a unique QSD $\\pi_{\\text{QSD}}$ that is:\n926: 1. **Ergodic**: Irreducible and aperiodic on the conditioned state space\n927: 2. **Exponentially converging**: $\\|\\mu_t - \\pi_{\\text{QSD}}\\|_{\\text{TV}} \\leq C e^{-\\lambda t}$ for any initial distribution\n928: 3. **Fitness-weighted**: Higher fitness regions have higher probability, but all regions are explored\n929: \n930: **Step 2: Kinetic Diffusion Lower Bound on Separation**\n931: \n932: The kinetic operator with diffusion $D = T/\\gamma$ satisfies a **Gaussian concentration bound** (standard result from Fokker-Planck theory): For walkers $i, j$ at time $t$, the relative separation $R_{ij}(t) = \\|x_i(t) - x_j(t)\\|$ satisfies:\n933: \n934: $$\n935: \\mathbb{P}_{\\text{QSD}}\\left(R_{ij} < \\varepsilon\\right) \\leq C_{\\text{diff}} \\cdot \\frac{\\varepsilon^d}{\\text{Vol}(\\mathcal{X})}\n936: $$\n937: \n938: This ensures no delta-function clustering occurs in the QSD.\n939: \n940: **Step 3: Cloning Diversity Enhancement**\n941: \n942: The cloning operator amplifies kinetic separation. By {prf:ref}`doc-03-cloning`, Lemma 5.1.2 (Diversity Maintenance), walkers with low algorithmic diversity have death rate:\n943: \n944: $$\n945: \\lambda_{\\text{death}}(i) \\geq \\lambda_0 \\cdot \\exp\\left(-\\frac{d_{\\text{alg}}(i, c(i))}{\\varepsilon_{\\text{pair}}}\\right)\n946: $$\n947: \n948: For clustered configurations where $m$ walkers satisfy $d_{\\text{alg}}(i,j) < r_{\\text{small}}$, the **total death rate** is exponentially enhanced: $\\Lambda_{\\text{cluster}} \\geq m \\cdot \\lambda_0 \\cdot e^{-r_{\\text{small}}/\\varepsilon_{\\text{pair}}} \\gg \\lambda_0$. This rapidly removes clustered states from the QSD.\n949: \n950: **Step 4: Uniform Density via Ergodic Theorem**\n951: \n952: By ergodicity, the QSD is the unique stationary measure. The density $\\rho_{\\text{phase}}^{\\text{QSD}}$ satisfies a **Fokker-Planck-Kolmogorov equation** with cloning source/sink terms. Standard elliptic regularity theory (Bogachev-Krylov-R\u00f6ckner, 2001) combined with:\n953: - Compactness of $\\mathcal{X} \\times V$ (velocity squashing, Lemma {prf:ref}`lem-velocity-squashing-compact-domain-full`)\n954: - Non-degenerate diffusion ($T > 0$)\n955: - Bounded drift ($\\|\\nabla V_{\\text{fit}}\\| \\leq L_V$ from C\u00b3 regularity, {prf:ref}`doc-13-geometric-gas-c3-regularity`)\n956: \n957: implies:\n958: \n959: $$\n960: \\rho_{\\text{phase}}^{\\text{QSD}}(x,v) \\leq \\rho_{\\max} := C_{\\text{FK}}(\\gamma, T, L_V, V_{\\max}, \\text{Vol}(\\mathcal{X}))\n961: $$\n962: \n963: **Step 5: Deterministic Packing Bound**\n964: \n965: Combining Steps 2-4, for any configuration $(x,v)$ in the **support** of $\\pi_{\\text{QSD}}$:\n966: 1. Kinetic diffusion ensures no delta-function clustering (Step 2)\n967: 2. Cloning removes near-clustered states exponentially fast (Step 3)\n968: 3. Ergodicity ensures only \"typical\" configurations (satisfying density bound) have positive measure (Step 4)\n969: \n970: Therefore, **on the QSD support**, the local density is bounded by $\\rho_{\\max}$, which implies:\n971: \n972: $$\n973: \\#\\{j : d_{\\text{alg}}(i,j) \\leq r\\} \\leq \\int_{B(x_i, r)} \\rho_{\\text{phase}}^{\\text{QSD}}(y,u) \\, dy \\, du \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(0, r))\n974: $$\n975: \n976: **Crucial Point**: Configurations violating this bound have **measure zero** in $\\pi_{\\text{QSD}}$ (by Steps 2-3, they are unstable and removed). Therefore, we can work with the bound deterministically on the QSD support.\n977: "
    },
    {
      "directive_type": "assumption",
      "label": "assump-uniform-density-full",
      "title": "Uniform Density Bound",
      "start_line": 979,
      "end_line": 1001,
      "header_lines": [
        980
      ],
      "content_start": 982,
      "content_end": 1000,
      "content": "982: :label: assump-uniform-density-full\n983: \n984: The phase-space density of alive walkers in the quasi-stationary distribution is uniformly bounded:\n985: \n986: $$\n987: \\rho_{\\text{phase}}^{\\text{QSD}}(x,v) \\leq \\rho_{\\max} < \\infty\n988: \n989: $$\n990: \n991: where $\\mathcal{X}$ is the spatial domain and $V$ is the velocity domain (bounded by velocity squashing).\n992: \n993: **Status**: This follows from Lemma {prf:ref}`lem-deterministic-packing-from-keystone-full`, which derives $\\rho_{\\max}$ from Keystone ergodicity, kinetic diffusion, and C\u00b3 regularity. The bound is **deterministic** (holds on the entire QSD support, not just with high probability) and **k-uniform** (independent of swarm size).\n994: \n995: **Consequence for walker distributions**: By Lemma {prf:ref}`lem-deterministic-packing-from-keystone-full`, the deterministic local packing bound ensures that for **all configurations** in $\\text{supp}(\\pi_{\\text{QSD}})$:\n996: \n997: $$\n998: \\#\\{j \\in \\mathcal{A} : d_{\\text{alg}}(i,j) \\leq r\\} \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(0, r)) = \\mathcal{O}(r^{2d})\n999: \n1000: $$",
      "metadata": {
        "label": "assump-uniform-density-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [
        "lem-deterministic-packing-from-keystone-full",
        "lem-sum-to-integral-bound-full"
      ],
      "raw_directive": "979: :::\n980: \n981: :::{prf:assumption} Uniform Density Bound\n982: :label: assump-uniform-density-full\n983: \n984: The phase-space density of alive walkers in the quasi-stationary distribution is uniformly bounded:\n985: \n986: $$\n987: \\rho_{\\text{phase}}^{\\text{QSD}}(x,v) \\leq \\rho_{\\max} < \\infty\n988: \n989: $$\n990: \n991: where $\\mathcal{X}$ is the spatial domain and $V$ is the velocity domain (bounded by velocity squashing).\n992: \n993: **Status**: This follows from Lemma {prf:ref}`lem-deterministic-packing-from-keystone-full`, which derives $\\rho_{\\max}$ from Keystone ergodicity, kinetic diffusion, and C\u00b3 regularity. The bound is **deterministic** (holds on the entire QSD support, not just with high probability) and **k-uniform** (independent of swarm size).\n994: \n995: **Consequence for walker distributions**: By Lemma {prf:ref}`lem-deterministic-packing-from-keystone-full`, the deterministic local packing bound ensures that for **all configurations** in $\\text{supp}(\\pi_{\\text{QSD}})$:\n996: \n997: $$\n998: \\#\\{j \\in \\mathcal{A} : d_{\\text{alg}}(i,j) \\leq r\\} \\leq \\rho_{\\max} \\cdot \\text{Vol}(B(0, r)) = \\mathcal{O}(r^{2d})\n999: \n1000: $$\n1001: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-sum-to-integral-bound-full",
      "title": "Sum-to-Integral Bound with Exponential Weights",
      "start_line": 1009,
      "end_line": 1031,
      "header_lines": [
        1010
      ],
      "content_start": 1012,
      "content_end": 1030,
      "content": "1012: :label: lem-sum-to-integral-bound-full\n1013: \n1014: Under {prf:ref}`assump-uniform-density-full`, for any walker $i \\in \\mathcal{A}$ and any function $f : \\mathcal{X} \\times \\mathbb{R}^d \\to \\mathbb{R}$ with $|f| \\leq M$:\n1015: \n1016: $$\n1017: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1018: \\leq \\rho_{\\max} \\cdot M \\cdot \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,y)}{2\\varepsilon_c^2}\\right) dy\\,du\n1019: \n1020: $$\n1021: \n1022: **Key consequence for Gaussian integrals**: When $f \\equiv 1$:\n1023: \n1024: $$\n1025: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1026: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n1027: \n1028: $$\n1029: \n1030: where $C_{\\lambda} = (1 + \\lambda_{\\text{alg}})^{d/2}$ accounts for the velocity component in $d_{\\text{alg}}$.",
      "metadata": {
        "label": "lem-sum-to-integral-bound-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [
        "assump-uniform-density-full"
      ],
      "raw_directive": "1009: The following lemma makes the sum-to-integral approximation **explicit**.\n1010: \n1011: :::{prf:lemma} Sum-to-Integral Bound with Exponential Weights\n1012: :label: lem-sum-to-integral-bound-full\n1013: \n1014: Under {prf:ref}`assump-uniform-density-full`, for any walker $i \\in \\mathcal{A}$ and any function $f : \\mathcal{X} \\times \\mathbb{R}^d \\to \\mathbb{R}$ with $|f| \\leq M$:\n1015: \n1016: $$\n1017: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1018: \\leq \\rho_{\\max} \\cdot M \\cdot \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,y)}{2\\varepsilon_c^2}\\right) dy\\,du\n1019: \n1020: $$\n1021: \n1022: **Key consequence for Gaussian integrals**: When $f \\equiv 1$:\n1023: \n1024: $$\n1025: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1026: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n1027: \n1028: $$\n1029: \n1030: where $C_{\\lambda} = (1 + \\lambda_{\\text{alg}})^{d/2}$ accounts for the velocity component in $d_{\\text{alg}}$.\n1031: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-651",
      "title": null,
      "start_line": 1033,
      "end_line": 1094,
      "header_lines": [],
      "content_start": 1034,
      "content_end": 1093,
      "content": "1034: \n1035: :::{prf:proof}\n1036: **Proof using deterministic packing bound.**\n1037: \n1038: By Lemma {prf:ref}`lem-deterministic-packing-from-keystone-full`, on the support of the QSD, the local density is bounded by $\\rho_{\\max}$ **deterministically** (no probabilistic qualifier). This immediately provides the sum-to-integral bound.\n1039: \n1040: **Step 1: Deterministic upper bound via integral.**\n1041: \n1042: For any non-negative weight function $w(y, u)$ and $|f| \\leq M$, on configurations in $\\text{supp}(\\pi_{\\text{QSD}})$:\n1043: \n1044: $$\n1045: \\begin{aligned}\n1046: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\, w(x_j, v_j)\n1047: &\\leq M \\sum_{j \\in \\mathcal{A}} w(x_j, v_j) \\\\\n1048: &\\leq M \\cdot \\rho_{\\max} \\int_{\\mathcal{X} \\times \\mathbb{R}^d} w(y, u) \\, dy \\, du\n1049: \\end{aligned}\n1050: \n1051: $$\n1052: \n1053: where the second inequality uses the deterministic packing bound from Lemma {prf:ref}`lem-deterministic-packing-from-keystone-full`.\n1054: \n1055: **Justification**: For any measurable set $S \\subset \\mathcal{X} \\times \\mathbb{R}^d$, the deterministic packing bound gives:\n1056: \n1057: $$\n1058: \\#\\{j \\in \\mathcal{A} : (x_j, v_j) \\in S\\} \\leq \\rho_{\\max} \\cdot \\text{Vol}(S)\n1059: \n1060: $$\n1061: \n1062: Partitioning the sum by level sets of $w$ and applying this bound yields the integral upper bound.\n1063: \n1064: **Step 2: Gaussian weight evaluation.**\n1065: \n1066: For the exponential weight $w(y,u) = \\exp(-d_{\\text{alg}}^2(i,(y,u))/(2\\varepsilon_c^2))$:\n1067: \n1068: $$\n1069: \\begin{aligned}\n1070: \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{\\|y - x_i\\|^2 + \\lambda_{\\text{alg}} \\|u - v_i\\|^2 + \\varepsilon_d^2}{2\\varepsilon_c^2}\\right) dy\\,du\n1071: &\\leq \\exp\\left(-\\frac{\\varepsilon_d^2}{2\\varepsilon_c^2}\\right) \\int_{\\mathbb{R}^{2d}} \\exp\\left(-\\frac{\\|y\\|^2 + \\lambda_{\\text{alg}} \\|u\\|^2}{2\\varepsilon_c^2}\\right) dy\\,du \\\\\n1072: &= (2\\pi\\varepsilon_c^2)^d \\cdot \\lambda_{\\text{alg}}^{-d/2} \\cdot \\exp\\left(-\\frac{\\varepsilon_d^2}{2\\varepsilon_c^2}\\right)\n1073: \\end{aligned}\n1074: \n1075: $$\n1076: \n1077: (using Gaussian integral formula in $2d$ dimensions with rescaling).\n1078: \n1079: **Step 3: Deterministic k-uniformity.**\n1080: \n1081: The bound:\n1082: \n1083: $$\n1084: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1085: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n1086: \n1087: $$\n1088: \n1089: holds **deterministically** (on the entire QSD support) and depends only on:\n1090: - $\\rho_{\\max}$ (from Keystone ergodicity, Lemma {prf:ref}`lem-deterministic-packing-from-keystone-full`)\n1091: - $\\varepsilon_c$ (algorithmic parameter)\n1092: - $d$ (dimension)\n1093: - $\\lambda_{\\text{alg}}$ (distance metric parameter)",
      "metadata": {},
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "references": [
        "lem-deterministic-packing-from-keystone-full"
      ],
      "raw_directive": "1033: :::\n1034: \n1035: :::{prf:proof}\n1036: **Proof using deterministic packing bound.**\n1037: \n1038: By Lemma {prf:ref}`lem-deterministic-packing-from-keystone-full`, on the support of the QSD, the local density is bounded by $\\rho_{\\max}$ **deterministically** (no probabilistic qualifier). This immediately provides the sum-to-integral bound.\n1039: \n1040: **Step 1: Deterministic upper bound via integral.**\n1041: \n1042: For any non-negative weight function $w(y, u)$ and $|f| \\leq M$, on configurations in $\\text{supp}(\\pi_{\\text{QSD}})$:\n1043: \n1044: $$\n1045: \\begin{aligned}\n1046: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\, w(x_j, v_j)\n1047: &\\leq M \\sum_{j \\in \\mathcal{A}} w(x_j, v_j) \\\\\n1048: &\\leq M \\cdot \\rho_{\\max} \\int_{\\mathcal{X} \\times \\mathbb{R}^d} w(y, u) \\, dy \\, du\n1049: \\end{aligned}\n1050: \n1051: $$\n1052: \n1053: where the second inequality uses the deterministic packing bound from Lemma {prf:ref}`lem-deterministic-packing-from-keystone-full`.\n1054: \n1055: **Justification**: For any measurable set $S \\subset \\mathcal{X} \\times \\mathbb{R}^d$, the deterministic packing bound gives:\n1056: \n1057: $$\n1058: \\#\\{j \\in \\mathcal{A} : (x_j, v_j) \\in S\\} \\leq \\rho_{\\max} \\cdot \\text{Vol}(S)\n1059: \n1060: $$\n1061: \n1062: Partitioning the sum by level sets of $w$ and applying this bound yields the integral upper bound.\n1063: \n1064: **Step 2: Gaussian weight evaluation.**\n1065: \n1066: For the exponential weight $w(y,u) = \\exp(-d_{\\text{alg}}^2(i,(y,u))/(2\\varepsilon_c^2))$:\n1067: \n1068: $$\n1069: \\begin{aligned}\n1070: \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{\\|y - x_i\\|^2 + \\lambda_{\\text{alg}} \\|u - v_i\\|^2 + \\varepsilon_d^2}{2\\varepsilon_c^2}\\right) dy\\,du\n1071: &\\leq \\exp\\left(-\\frac{\\varepsilon_d^2}{2\\varepsilon_c^2}\\right) \\int_{\\mathbb{R}^{2d}} \\exp\\left(-\\frac{\\|y\\|^2 + \\lambda_{\\text{alg}} \\|u\\|^2}{2\\varepsilon_c^2}\\right) dy\\,du \\\\\n1072: &= (2\\pi\\varepsilon_c^2)^d \\cdot \\lambda_{\\text{alg}}^{-d/2} \\cdot \\exp\\left(-\\frac{\\varepsilon_d^2}{2\\varepsilon_c^2}\\right)\n1073: \\end{aligned}\n1074: \n1075: $$\n1076: \n1077: (using Gaussian integral formula in $2d$ dimensions with rescaling).\n1078: \n1079: **Step 3: Deterministic k-uniformity.**\n1080: \n1081: The bound:\n1082: \n1083: $$\n1084: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1085: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n1086: \n1087: $$\n1088: \n1089: holds **deterministically** (on the entire QSD support) and depends only on:\n1090: - $\\rho_{\\max}$ (from Keystone ergodicity, Lemma {prf:ref}`lem-deterministic-packing-from-keystone-full`)\n1091: - $\\varepsilon_c$ (algorithmic parameter)\n1092: - $d$ (dimension)\n1093: - $\\lambda_{\\text{alg}}$ (distance metric parameter)\n1094: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}