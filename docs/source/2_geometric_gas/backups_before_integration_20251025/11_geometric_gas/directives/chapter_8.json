{
  "chapter_index": 8,
  "section_id": "## 5.4. The Stratonovich Chain Rule and Drift Calculation",
  "directive_count": 3,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-strat-chain",
      "title": "Stratonovich Chain Rule for Lyapunov Functions",
      "start_line": 1108,
      "end_line": 1142,
      "header_lines": [
        1109
      ],
      "content_start": 1111,
      "content_end": 1141,
      "content": "1111: :label: thm-strat-chain\n1112: \n1113: Let $V: \\Sigma_N \\to \\mathbb{R}$ be a $C^2$ function of the swarm state $S = \\{(x_1, v_1), \\ldots, (x_N, v_N)\\}$, and suppose $S_t$ evolves according to the Stratonovich SDE:\n1114: \n1115: $$\n1116: \\begin{aligned}\n1117: dx_i &= v_i \\, dt \\\\\n1118: dv_i &= b_i(S) \\, dt + \\Sigma_{\\text{reg}}(x_i, S) \\circ dW_i\n1119: \\end{aligned}\n1120: $$\n1121: \n1122: where $b_i(S)$ is the total drift (including all forces and friction).\n1123: \n1124: Then the evolution of $V(S_t)$ is governed by:\n1125: \n1126: $$\n1127: dV = A(S_t) \\, dt + B(S_t) \\circ dW_t\n1128: $$\n1129: \n1130: where the **Stratonovich drift** is:\n1131: \n1132: $$\n1133: A(S_t) = \\sum_{i=1}^N \\left[ \\langle \\nabla_{x_i} V, v_i \\rangle + \\langle \\nabla_{v_i} V, b_i(S) \\rangle \\right] + \\frac{1}{2} \\sum_{i=1}^N \\sum_{j=1}^d \\left( \\sigma_{ij} \\cdot \\nabla_{v_i} \\right) \\left( \\sigma_{ij} \\cdot \\nabla_{v_i} V \\right)\n1134: $$\n1135: \n1136: where $\\sigma_{ij}$ is the $j$-th column of $\\Sigma_{\\text{reg}}(x_i, S)$, and the operator $(\\sigma_{ij} \\cdot \\nabla_{v_i})$ denotes the directional derivative in the direction $\\sigma_{ij}$.\n1137: \n1138: The stochastic term is:\n1139: \n1140: $$\n1141: B(S_t) \\circ dW_t = \\sum_{i=1}^N \\sum_{j=1}^d \\langle \\nabla_{v_i} V, \\sigma_{ij}(S) \\rangle \\circ dW_i^{(j)}",
      "metadata": {
        "label": "thm-strat-chain"
      },
      "section": "## 5.4. The Stratonovich Chain Rule and Drift Calculation",
      "raw_directive": "1108: :::\n1109: \n1110: :::{prf:theorem} Stratonovich Chain Rule for Lyapunov Functions\n1111: :label: thm-strat-chain\n1112: \n1113: Let $V: \\Sigma_N \\to \\mathbb{R}$ be a $C^2$ function of the swarm state $S = \\{(x_1, v_1), \\ldots, (x_N, v_N)\\}$, and suppose $S_t$ evolves according to the Stratonovich SDE:\n1114: \n1115: $$\n1116: \\begin{aligned}\n1117: dx_i &= v_i \\, dt \\\\\n1118: dv_i &= b_i(S) \\, dt + \\Sigma_{\\text{reg}}(x_i, S) \\circ dW_i\n1119: \\end{aligned}\n1120: $$\n1121: \n1122: where $b_i(S)$ is the total drift (including all forces and friction).\n1123: \n1124: Then the evolution of $V(S_t)$ is governed by:\n1125: \n1126: $$\n1127: dV = A(S_t) \\, dt + B(S_t) \\circ dW_t\n1128: $$\n1129: \n1130: where the **Stratonovich drift** is:\n1131: \n1132: $$\n1133: A(S_t) = \\sum_{i=1}^N \\left[ \\langle \\nabla_{x_i} V, v_i \\rangle + \\langle \\nabla_{v_i} V, b_i(S) \\rangle \\right] + \\frac{1}{2} \\sum_{i=1}^N \\sum_{j=1}^d \\left( \\sigma_{ij} \\cdot \\nabla_{v_i} \\right) \\left( \\sigma_{ij} \\cdot \\nabla_{v_i} V \\right)\n1134: $$\n1135: \n1136: where $\\sigma_{ij}$ is the $j$-th column of $\\Sigma_{\\text{reg}}(x_i, S)$, and the operator $(\\sigma_{ij} \\cdot \\nabla_{v_i})$ denotes the directional derivative in the direction $\\sigma_{ij}$.\n1137: \n1138: The stochastic term is:\n1139: \n1140: $$\n1141: B(S_t) \\circ dW_t = \\sum_{i=1}^N \\sum_{j=1}^d \\langle \\nabla_{v_i} V, \\sigma_{ij}(S) \\rangle \\circ dW_i^{(j)}\n1142: $$"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-47",
      "title": null,
      "start_line": 1144,
      "end_line": 1148,
      "header_lines": [],
      "content_start": 1145,
      "content_end": 1147,
      "content": "1145: \n1146: :::{prf:proof}\n1147: This follows from the standard Stratonovich chain rule (see \u00d8ksendal, \"Stochastic Differential Equations\", Chapter 3, or Kunita, \"Stochastic Flows and Stochastic Differential Equations\", Chapter 3).",
      "metadata": {},
      "section": "## 5.4. The Stratonovich Chain Rule and Drift Calculation",
      "raw_directive": "1144: :::\n1145: \n1146: :::{prf:proof}\n1147: This follows from the standard Stratonovich chain rule (see \u00d8ksendal, \"Stochastic Differential Equations\", Chapter 3, or Kunita, \"Stochastic Flows and Stochastic Differential Equations\", Chapter 3).\n1148: "
    },
    {
      "directive_type": "definition",
      "label": "def-strat-drift",
      "title": "Stratonovich Drift for the Hybrid System",
      "start_line": 1150,
      "end_line": 1187,
      "header_lines": [
        1151
      ],
      "content_start": 1153,
      "content_end": 1186,
      "content": "1153: :label: def-strat-drift\n1154: \n1155: For the Hybrid SDE with drift:\n1156: \n1157: $$\n1158: b_i(S) = -\\nabla U(x_i) + \\epsilon_F \\nabla_{x_i} V_{\\text{fit}}(S) + \\mathbf{F}_{\\text{viscous}}(x_i, S) - \\gamma v_i\n1159: $$\n1160: \n1161: we define:\n1162: \n1163: **Backbone drift:**\n1164: \n1165: $$\n1166: A_{\\text{backbone}}(S) = \\sum_{i=1}^N \\left[ \\langle \\nabla_{x_i} V, v_i \\rangle + \\langle \\nabla_{v_i} V, -\\nabla U(x_i) - \\gamma v_i \\rangle \\right] + \\frac{1}{2} \\sigma^2 \\sum_{i=1}^N \\|\\nabla_{v_i} V\\|^2\n1167: $$\n1168: \n1169: (This corresponds to $\\epsilon_F = 0$, $\\nu = 0$, $\\Sigma_{\\text{reg}} = \\sigma I$.)\n1170: \n1171: **Adaptive perturbation drift:**\n1172: \n1173: $$\n1174: A_{\\text{perturb}}(S) = \\sum_{i=1}^N \\langle \\nabla_{v_i} V, \\epsilon_F \\nabla_{x_i} V_{\\text{fit}}(S) + \\mathbf{F}_{\\text{viscous}}(x_i, S) \\rangle + A_{\\text{diff}}(S)\n1175: $$\n1176: \n1177: where $A_{\\text{diff}}(S)$ is the additional drift from the state-dependent diffusion:\n1178: \n1179: $$\n1180: A_{\\text{diff}}(S) = \\frac{1}{2} \\sum_{i=1}^N \\sum_{j=1}^d \\left[ (\\sigma_{ij}^{\\text{reg}} \\cdot \\nabla_{v_i})(\\sigma_{ij}^{\\text{reg}} \\cdot \\nabla_{v_i} V) - \\sigma^2 \\|\\nabla_{v_i} V\\|^2 \\right]\n1181: $$\n1182: \n1183: The total Stratonovich drift is:\n1184: \n1185: $$\n1186: A_{\\text{full}}(S) = A_{\\text{backbone}}(S) + A_{\\text{perturb}}(S)",
      "metadata": {
        "label": "def-strat-drift"
      },
      "section": "## 5.4. The Stratonovich Chain Rule and Drift Calculation",
      "raw_directive": "1150: :::\n1151: \n1152: :::{prf:definition} Stratonovich Drift for the Hybrid System\n1153: :label: def-strat-drift\n1154: \n1155: For the Hybrid SDE with drift:\n1156: \n1157: $$\n1158: b_i(S) = -\\nabla U(x_i) + \\epsilon_F \\nabla_{x_i} V_{\\text{fit}}(S) + \\mathbf{F}_{\\text{viscous}}(x_i, S) - \\gamma v_i\n1159: $$\n1160: \n1161: we define:\n1162: \n1163: **Backbone drift:**\n1164: \n1165: $$\n1166: A_{\\text{backbone}}(S) = \\sum_{i=1}^N \\left[ \\langle \\nabla_{x_i} V, v_i \\rangle + \\langle \\nabla_{v_i} V, -\\nabla U(x_i) - \\gamma v_i \\rangle \\right] + \\frac{1}{2} \\sigma^2 \\sum_{i=1}^N \\|\\nabla_{v_i} V\\|^2\n1167: $$\n1168: \n1169: (This corresponds to $\\epsilon_F = 0$, $\\nu = 0$, $\\Sigma_{\\text{reg}} = \\sigma I$.)\n1170: \n1171: **Adaptive perturbation drift:**\n1172: \n1173: $$\n1174: A_{\\text{perturb}}(S) = \\sum_{i=1}^N \\langle \\nabla_{v_i} V, \\epsilon_F \\nabla_{x_i} V_{\\text{fit}}(S) + \\mathbf{F}_{\\text{viscous}}(x_i, S) \\rangle + A_{\\text{diff}}(S)\n1175: $$\n1176: \n1177: where $A_{\\text{diff}}(S)$ is the additional drift from the state-dependent diffusion:\n1178: \n1179: $$\n1180: A_{\\text{diff}}(S) = \\frac{1}{2} \\sum_{i=1}^N \\sum_{j=1}^d \\left[ (\\sigma_{ij}^{\\text{reg}} \\cdot \\nabla_{v_i})(\\sigma_{ij}^{\\text{reg}} \\cdot \\nabla_{v_i} V) - \\sigma^2 \\|\\nabla_{v_i} V\\|^2 \\right]\n1181: $$\n1182: \n1183: The total Stratonovich drift is:\n1184: \n1185: $$\n1186: A_{\\text{full}}(S) = A_{\\text{backbone}}(S) + A_{\\text{perturb}}(S)\n1187: $$"
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}