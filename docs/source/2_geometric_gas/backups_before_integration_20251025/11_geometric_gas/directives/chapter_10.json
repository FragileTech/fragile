{
  "chapter_index": 10,
  "section_id": "## 7. Foster-Lyapunov Drift for the Full Adaptive System",
  "directive_count": 3,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-fl-drift-adaptive",
      "title": "Foster-Lyapunov Drift for the \u03c1-Localized Geometric Viscous Fluid Model",
      "start_line": 1506,
      "end_line": 1540,
      "header_lines": [
        1507
      ],
      "content_start": 1509,
      "content_end": 1539,
      "content": "1509: :label: thm-fl-drift-adaptive\n1510: \n1511: For the Geometric Viscous Fluid Model with localization scale \u03c1 > 0, there exist **\u03c1-dependent critical parameters** $\\epsilon_F^*(\\rho) > 0$ and $\\nu^*(\\rho) > 0$ such that for all $0 \\le \\epsilon_F < \\epsilon_F^*(\\rho)$ and $0 \\le \\nu < \\nu^*(\\rho)$, the system satisfies a discrete-time Foster-Lyapunov drift condition:\n1512: \n1513: $$\n1514: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}}(\\rho)) V_{\\text{total}}(S_k) + C_{\\text{total}}(\\rho)\n1515: $$\n1516: \n1517: for all $k \\ge 0$, where:\n1518: \n1519: $$\n1520: \\kappa_{\\text{total}}(\\rho) = \\kappa_{\\text{backbone}} - \\epsilon_F K_F(\\rho) > 0\n1521: $$\n1522: \n1523: $$\n1524: C_{\\text{total}}(\\rho) = C_{\\text{backbone}} + C_{\\text{diff}}(\\rho) + \\epsilon_F K_F(\\rho) < \\infty\n1525: $$\n1526: \n1527: **Critical Stability Threshold:**\n1528: \n1529: $$\n1530: \\epsilon_F^*(\\rho) := \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2 K_F(\\rho)}\n1531: $$\n1532: \n1533: where $C_{\\text{diff,1}}(\\rho)$ captures the \u03c1-dependent diffusion perturbation contribution to the drift coefficient.\n1534: \n1535: **Interpretation:**\n1536: - For any fixed \u03c1 > 0, the critical threshold $\\epsilon_F^*(\\rho)$ is strictly positive\n1537: - Smaller \u03c1 (more local adaptation) \u2192 potentially larger $K_F(\\rho)$ \u2192 smaller $\\epsilon_F^*(\\rho)$ \u2192 more restrictive stability condition\n1538: - Larger \u03c1 (more global statistics) \u2192 smaller $K_F(\\rho)$ \u2192 larger $\\epsilon_F^*(\\rho)$ \u2192 as \u03c1 \u2192 \u221e, recovers the backbone threshold\n1539: - The convergence rate $\\kappa_{\\text{total}}(\\rho)$ depends on both \u03b5F and \u03c1, allowing tuning of the exploration-exploitation tradeoff",
      "metadata": {
        "label": "thm-fl-drift-adaptive"
      },
      "section": "## 7. Foster-Lyapunov Drift for the Full Adaptive System",
      "references": [],
      "raw_directive": "1506: ### 7.1. Main Theorem\n1507: \n1508: :::{prf:theorem} Foster-Lyapunov Drift for the \u03c1-Localized Geometric Viscous Fluid Model\n1509: :label: thm-fl-drift-adaptive\n1510: \n1511: For the Geometric Viscous Fluid Model with localization scale \u03c1 > 0, there exist **\u03c1-dependent critical parameters** $\\epsilon_F^*(\\rho) > 0$ and $\\nu^*(\\rho) > 0$ such that for all $0 \\le \\epsilon_F < \\epsilon_F^*(\\rho)$ and $0 \\le \\nu < \\nu^*(\\rho)$, the system satisfies a discrete-time Foster-Lyapunov drift condition:\n1512: \n1513: $$\n1514: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}}(\\rho)) V_{\\text{total}}(S_k) + C_{\\text{total}}(\\rho)\n1515: $$\n1516: \n1517: for all $k \\ge 0$, where:\n1518: \n1519: $$\n1520: \\kappa_{\\text{total}}(\\rho) = \\kappa_{\\text{backbone}} - \\epsilon_F K_F(\\rho) > 0\n1521: $$\n1522: \n1523: $$\n1524: C_{\\text{total}}(\\rho) = C_{\\text{backbone}} + C_{\\text{diff}}(\\rho) + \\epsilon_F K_F(\\rho) < \\infty\n1525: $$\n1526: \n1527: **Critical Stability Threshold:**\n1528: \n1529: $$\n1530: \\epsilon_F^*(\\rho) := \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2 K_F(\\rho)}\n1531: $$\n1532: \n1533: where $C_{\\text{diff,1}}(\\rho)$ captures the \u03c1-dependent diffusion perturbation contribution to the drift coefficient.\n1534: \n1535: **Interpretation:**\n1536: - For any fixed \u03c1 > 0, the critical threshold $\\epsilon_F^*(\\rho)$ is strictly positive\n1537: - Smaller \u03c1 (more local adaptation) \u2192 potentially larger $K_F(\\rho)$ \u2192 smaller $\\epsilon_F^*(\\rho)$ \u2192 more restrictive stability condition\n1538: - Larger \u03c1 (more global statistics) \u2192 smaller $K_F(\\rho)$ \u2192 larger $\\epsilon_F^*(\\rho)$ \u2192 as \u03c1 \u2192 \u221e, recovers the backbone threshold\n1539: - The convergence rate $\\kappa_{\\text{total}}(\\rho)$ depends on both \u03b5F and \u03c1, allowing tuning of the exploration-exploitation tradeoff\n1540: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-43",
      "title": null,
      "start_line": 1544,
      "end_line": 1662,
      "header_lines": [],
      "content_start": 1545,
      "content_end": 1661,
      "content": "1545: \n1546: :::{prf:proof}\n1547: The proof proceeds in six steps, working entirely in the continuous-time domain before discretization.\n1548: \n1549: **Step 1: Decompose the Stratonovich drift.** By Definition [](#def-strat-drift), the Stratonovich drift of $V_{\\text{total}}(S_t)$ is:\n1550: \n1551: $$\n1552: A_{\\text{full}}(S) = A_{\\text{backbone}}(S) + A_{\\text{perturb}}(S)\n1553: $$\n1554: \n1555: where $A_{\\text{backbone}}$ is the drift of the backbone system (Section 5) and $A_{\\text{perturb}}$ is the perturbative contribution from the adaptive terms (Chapter 6).\n1556: \n1557: **Step 2: Establish the continuous-time backbone drift inequality.** The backbone system (with $\\epsilon_F = 0$, $\\nu = 0$, $\\Sigma_{\\text{reg}} = \\sigma I$) satisfies a continuous-time drift inequality. From the analysis in [04_convergence.md](../1_euclidean_gas/06_convergence.md), adapted to Stratonovich calculus, the expected drift satisfies:\n1558: \n1559: $$\n1560: \\mathbb{E}[A_{\\text{backbone}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}}\n1561: $$\n1562: \n1563: for some $\\kappa_{\\text{backbone}} > 0$ and $C_{\\text{backbone}} < \\infty$.\n1564: \n1565: **Justification:** The backbone convergence was originally proven using discrete-time analysis. The continuous-time drift bound can be recovered by considering the infinitesimal time evolution:\n1566: \n1567: $$\n1568: \\frac{d}{dt} \\mathbb{E}[V_{\\text{total}}(S_t)] = \\mathbb{E}[A_{\\text{backbone}}(S_t)]\n1569: $$\n1570: \n1571: The discrete-time bound $\\mathbb{E}[V'] \\le (1 - \\kappa \\Delta t) V + C \\Delta t$ implies, in the limit $\\Delta t \\to 0$, the continuous-time inequality $\\mathbb{E}[A] \\le -\\kappa V + C$.\n1572: \n1573: **Step 3: Bound the perturbative contribution (\u03c1-dependent).** By Corollary {prf:ref}`cor-total-perturbation`, the perturbative drift satisfies:\n1574: \n1575: $$\n1576: A_{\\text{perturb}}(S) \\le (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho))\n1577: $$\n1578: \n1579: **Step 4: Combine the drift inequalities.** Adding Steps 2 and 3:\n1580: \n1581: $$\n1582: \\begin{aligned}\n1583: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] &= \\mathbb{E}[A_{\\text{backbone}}(S_t) + A_{\\text{perturb}}(S_t) \\mid S_t] \\\\\n1584: &\\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}} \\\\\n1585: &\\quad + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S_t) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)) \\\\\n1586: &= [- \\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)] V_{\\text{total}}(S_t) \\\\\n1587: &\\quad + [C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)]\n1588: \\end{aligned}\n1589: $$\n1590: \n1591: **Step 5: Choose $\\epsilon_F$ to ensure negative drift (\u03c1-dependent threshold).** Define:\n1592: \n1593: $$\n1594: \\epsilon_F^*(\\rho) := \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2 K_F(\\rho)}\n1595: $$\n1596: \n1597: (assuming $\\kappa_{\\text{backbone}} > C_{\\text{diff,1}}(\\rho)$, which holds for sufficiently strong backbone parameters and any finite \u03c1 > 0).\n1598: \n1599: For any $0 \\le \\epsilon_F < \\epsilon_F^*(\\rho)$, we have:\n1600: \n1601: $$\n1602: \\begin{aligned}\n1603: &-\\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho) \\\\\n1604: &< -\\kappa_{\\text{backbone}} + \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} + C_{\\text{diff,1}}(\\rho) \\\\\n1605: &= -\\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} < 0\n1606: \\end{aligned}\n1607: $$\n1608: \n1609: Define:\n1610: \n1611: $$\n1612: \\kappa_{\\text{total}}(\\rho) := \\kappa_{\\text{backbone}} - \\epsilon_F K_F(\\rho) - C_{\\text{diff,1}}(\\rho) > 0\n1613: $$\n1614: \n1615: $$\n1616: C_{\\text{total}}(\\rho) := C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho) < \\infty\n1617: $$\n1618: \n1619: Then the continuous-time drift inequality for the full system is:\n1620: \n1621: $$\n1622: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{total}}(\\rho) V_{\\text{total}}(S_t) + C_{\\text{total}}(\\rho)\n1623: $$\n1624: \n1625: **Step 6: Discretization (Justification for Adaptive System).**\n1626: \n1627: The Discretization Theorem (Theorem 1.7.2 in `04_convergence.md`) relates continuous-time drift inequalities to discrete-time Foster-Lyapunov conditions. However, that theorem was stated for the **backbone system** with constant diffusion $\\sigma I$. We must verify its hypotheses hold for the **adaptive system** with state-dependent diffusion $\\Sigma_{\\text{reg}}(x_i, S)$.\n1628: \n1629: **Key Requirements for the Discretization Theorem:**\n1630: 1. **Bounded derivatives of Lyapunov function:** $\\|\\nabla V_{\\text{total}}\\|$, $\\|\\nabla^2 V_{\\text{total}}\\|$ must be polynomially bounded\n1631: 2. **Bounded drift and diffusion:** The SDE coefficients must satisfy global Lipschitz and linear growth conditions\n1632: 3. **Regularity of integrator:** The BAOAB splitting integrator must have bounded weak error\n1633: \n1634: **Verification for the Adaptive System:**\n1635: \n1636: **Requirement 1 (Lyapunov Regularity):** The Lyapunov function $V_{\\text{total}}$ is a quadratic form in $(x, v)$ (variances and mean distances). Therefore:\n1637: - $\\nabla V_{\\text{total}}$ grows at most linearly: $\\|\\nabla V_{\\text{total}}(S)\\| \\le C_{\\nabla}(V_{\\text{total}}(S) + 1)$ (proven in Chapter 6, Lemma {prf:ref}`lem-adaptive-force-bounded`)\n1638: - $\\nabla^2 V_{\\text{total}}$ is uniformly bounded: $\\|\\nabla^2 V_{\\text{total}}\\| \\le C_{\\nabla^2} < \\infty$ (V is quadratic)\n1639: \n1640: **Requirement 2 (SDE Regularity):**\n1641: - **Drift boundedness:** By Appendix A (Theorem {prf:ref}`thm-c1-regularity`), $\\|\\mathbf{F}_{\\text{adapt}}\\| \\le \\epsilon_F F_{\\text{adapt,max}}(\\rho)$ is **N-uniform** and \u03c1-dependent. The viscous force is similarly bounded. The confining force $-\\nabla U$ has at most linear growth.\n1642: - **Diffusion boundedness:** By Theorem {prf:ref}`thm-ueph`, the regularized diffusion satisfies $c_{\\min}(\\rho) I \\preceq D_{\\text{reg}} \\preceq c_{\\max}(\\rho) I$ with **N-uniform** bounds.\n1643: - **Lipschitz continuity:** Established in Corollary {prf:ref}`cor-wellposed` (Step 1 of its proof)\n1644: \n1645: **Requirement 3 (Integrator Weak Error):** The BAOAB integrator used in `04_convergence.md` has weak error $O(\\Delta t^2)$ for SDEs with smooth coefficients (Leimkuhler-Matthews, \"Molecular Dynamics\", 2015). Since our adaptive drift and diffusion are smooth (C\u00b9 and C\u00b2 by Appendix A), the BAOAB integrator maintains its $O(\\Delta t^2)$ weak error bound.\n1646: \n1647: **Conclusion:** All hypotheses of the Discretization Theorem are satisfied by the adaptive system. The N-uniform bounds from Appendix A are crucial here - without them, the weak error analysis could fail as $N \\to \\infty$.\n1648: \n1649: Therefore, the continuous-time drift inequality implies the discrete-time Foster-Lyapunov condition:\n1650: \n1651: $$\n1652: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}} \\Delta t + O(\\Delta t^2)) V_{\\text{total}}(S_k) + (C_{\\text{total}} \\Delta t + O(\\Delta t^2))\n1653: $$\n1654: \n1655: For sufficiently small $\\Delta t$, the $O(\\Delta t^2)$ terms can be absorbed, yielding:\n1656: \n1657: $$\n1658: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}}) V_{\\text{total}}(S_k) + C_{\\text{total}}\n1659: $$\n1660: \n1661: where we redefine $\\kappa_{\\text{total}} := \\kappa_{\\text{total}} \\Delta t$ and $C_{\\text{total}} := C_{\\text{total}} \\Delta t$ for the discrete-time version.",
      "metadata": {},
      "section": "## 7. Foster-Lyapunov Drift for the Full Adaptive System",
      "references": [
        "cor-total-perturbation",
        "lem-adaptive-force-bounded",
        "thm-c1-regularity",
        "thm-ueph",
        "cor-wellposed"
      ],
      "raw_directive": "1544: ### 7.2. Proof of Main Theorem\n1545: \n1546: :::{prf:proof}\n1547: The proof proceeds in six steps, working entirely in the continuous-time domain before discretization.\n1548: \n1549: **Step 1: Decompose the Stratonovich drift.** By Definition [](#def-strat-drift), the Stratonovich drift of $V_{\\text{total}}(S_t)$ is:\n1550: \n1551: $$\n1552: A_{\\text{full}}(S) = A_{\\text{backbone}}(S) + A_{\\text{perturb}}(S)\n1553: $$\n1554: \n1555: where $A_{\\text{backbone}}$ is the drift of the backbone system (Section 5) and $A_{\\text{perturb}}$ is the perturbative contribution from the adaptive terms (Chapter 6).\n1556: \n1557: **Step 2: Establish the continuous-time backbone drift inequality.** The backbone system (with $\\epsilon_F = 0$, $\\nu = 0$, $\\Sigma_{\\text{reg}} = \\sigma I$) satisfies a continuous-time drift inequality. From the analysis in [04_convergence.md](../1_euclidean_gas/06_convergence.md), adapted to Stratonovich calculus, the expected drift satisfies:\n1558: \n1559: $$\n1560: \\mathbb{E}[A_{\\text{backbone}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}}\n1561: $$\n1562: \n1563: for some $\\kappa_{\\text{backbone}} > 0$ and $C_{\\text{backbone}} < \\infty$.\n1564: \n1565: **Justification:** The backbone convergence was originally proven using discrete-time analysis. The continuous-time drift bound can be recovered by considering the infinitesimal time evolution:\n1566: \n1567: $$\n1568: \\frac{d}{dt} \\mathbb{E}[V_{\\text{total}}(S_t)] = \\mathbb{E}[A_{\\text{backbone}}(S_t)]\n1569: $$\n1570: \n1571: The discrete-time bound $\\mathbb{E}[V'] \\le (1 - \\kappa \\Delta t) V + C \\Delta t$ implies, in the limit $\\Delta t \\to 0$, the continuous-time inequality $\\mathbb{E}[A] \\le -\\kappa V + C$.\n1572: \n1573: **Step 3: Bound the perturbative contribution (\u03c1-dependent).** By Corollary {prf:ref}`cor-total-perturbation`, the perturbative drift satisfies:\n1574: \n1575: $$\n1576: A_{\\text{perturb}}(S) \\le (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho))\n1577: $$\n1578: \n1579: **Step 4: Combine the drift inequalities.** Adding Steps 2 and 3:\n1580: \n1581: $$\n1582: \\begin{aligned}\n1583: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] &= \\mathbb{E}[A_{\\text{backbone}}(S_t) + A_{\\text{perturb}}(S_t) \\mid S_t] \\\\\n1584: &\\le -\\kappa_{\\text{backbone}} V_{\\text{total}}(S_t) + C_{\\text{backbone}} \\\\\n1585: &\\quad + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)) V_{\\text{total}}(S_t) + (\\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)) \\\\\n1586: &= [- \\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho)] V_{\\text{total}}(S_t) \\\\\n1587: &\\quad + [C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho)]\n1588: \\end{aligned}\n1589: $$\n1590: \n1591: **Step 5: Choose $\\epsilon_F$ to ensure negative drift (\u03c1-dependent threshold).** Define:\n1592: \n1593: $$\n1594: \\epsilon_F^*(\\rho) := \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2 K_F(\\rho)}\n1595: $$\n1596: \n1597: (assuming $\\kappa_{\\text{backbone}} > C_{\\text{diff,1}}(\\rho)$, which holds for sufficiently strong backbone parameters and any finite \u03c1 > 0).\n1598: \n1599: For any $0 \\le \\epsilon_F < \\epsilon_F^*(\\rho)$, we have:\n1600: \n1601: $$\n1602: \\begin{aligned}\n1603: &-\\kappa_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,1}}(\\rho) \\\\\n1604: &< -\\kappa_{\\text{backbone}} + \\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} + C_{\\text{diff,1}}(\\rho) \\\\\n1605: &= -\\frac{\\kappa_{\\text{backbone}} - C_{\\text{diff,1}}(\\rho)}{2} < 0\n1606: \\end{aligned}\n1607: $$\n1608: \n1609: Define:\n1610: \n1611: $$\n1612: \\kappa_{\\text{total}}(\\rho) := \\kappa_{\\text{backbone}} - \\epsilon_F K_F(\\rho) - C_{\\text{diff,1}}(\\rho) > 0\n1613: $$\n1614: \n1615: $$\n1616: C_{\\text{total}}(\\rho) := C_{\\text{backbone}} + \\epsilon_F K_F(\\rho) + C_{\\text{diff,0}}(\\rho) < \\infty\n1617: $$\n1618: \n1619: Then the continuous-time drift inequality for the full system is:\n1620: \n1621: $$\n1622: \\mathbb{E}[A_{\\text{full}}(S_t) \\mid S_t] \\le -\\kappa_{\\text{total}}(\\rho) V_{\\text{total}}(S_t) + C_{\\text{total}}(\\rho)\n1623: $$\n1624: \n1625: **Step 6: Discretization (Justification for Adaptive System).**\n1626: \n1627: The Discretization Theorem (Theorem 1.7.2 in `04_convergence.md`) relates continuous-time drift inequalities to discrete-time Foster-Lyapunov conditions. However, that theorem was stated for the **backbone system** with constant diffusion $\\sigma I$. We must verify its hypotheses hold for the **adaptive system** with state-dependent diffusion $\\Sigma_{\\text{reg}}(x_i, S)$.\n1628: \n1629: **Key Requirements for the Discretization Theorem:**\n1630: 1. **Bounded derivatives of Lyapunov function:** $\\|\\nabla V_{\\text{total}}\\|$, $\\|\\nabla^2 V_{\\text{total}}\\|$ must be polynomially bounded\n1631: 2. **Bounded drift and diffusion:** The SDE coefficients must satisfy global Lipschitz and linear growth conditions\n1632: 3. **Regularity of integrator:** The BAOAB splitting integrator must have bounded weak error\n1633: \n1634: **Verification for the Adaptive System:**\n1635: \n1636: **Requirement 1 (Lyapunov Regularity):** The Lyapunov function $V_{\\text{total}}$ is a quadratic form in $(x, v)$ (variances and mean distances). Therefore:\n1637: - $\\nabla V_{\\text{total}}$ grows at most linearly: $\\|\\nabla V_{\\text{total}}(S)\\| \\le C_{\\nabla}(V_{\\text{total}}(S) + 1)$ (proven in Chapter 6, Lemma {prf:ref}`lem-adaptive-force-bounded`)\n1638: - $\\nabla^2 V_{\\text{total}}$ is uniformly bounded: $\\|\\nabla^2 V_{\\text{total}}\\| \\le C_{\\nabla^2} < \\infty$ (V is quadratic)\n1639: \n1640: **Requirement 2 (SDE Regularity):**\n1641: - **Drift boundedness:** By Appendix A (Theorem {prf:ref}`thm-c1-regularity`), $\\|\\mathbf{F}_{\\text{adapt}}\\| \\le \\epsilon_F F_{\\text{adapt,max}}(\\rho)$ is **N-uniform** and \u03c1-dependent. The viscous force is similarly bounded. The confining force $-\\nabla U$ has at most linear growth.\n1642: - **Diffusion boundedness:** By Theorem {prf:ref}`thm-ueph`, the regularized diffusion satisfies $c_{\\min}(\\rho) I \\preceq D_{\\text{reg}} \\preceq c_{\\max}(\\rho) I$ with **N-uniform** bounds.\n1643: - **Lipschitz continuity:** Established in Corollary {prf:ref}`cor-wellposed` (Step 1 of its proof)\n1644: \n1645: **Requirement 3 (Integrator Weak Error):** The BAOAB integrator used in `04_convergence.md` has weak error $O(\\Delta t^2)$ for SDEs with smooth coefficients (Leimkuhler-Matthews, \"Molecular Dynamics\", 2015). Since our adaptive drift and diffusion are smooth (C\u00b9 and C\u00b2 by Appendix A), the BAOAB integrator maintains its $O(\\Delta t^2)$ weak error bound.\n1646: \n1647: **Conclusion:** All hypotheses of the Discretization Theorem are satisfied by the adaptive system. The N-uniform bounds from Appendix A are crucial here - without them, the weak error analysis could fail as $N \\to \\infty$.\n1648: \n1649: Therefore, the continuous-time drift inequality implies the discrete-time Foster-Lyapunov condition:\n1650: \n1651: $$\n1652: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}} \\Delta t + O(\\Delta t^2)) V_{\\text{total}}(S_k) + (C_{\\text{total}} \\Delta t + O(\\Delta t^2))\n1653: $$\n1654: \n1655: For sufficiently small $\\Delta t$, the $O(\\Delta t^2)$ terms can be absorbed, yielding:\n1656: \n1657: $$\n1658: \\mathbb{E}[V_{\\text{total}}(S_{k+1}) \\mid S_k] \\le (1 - \\kappa_{\\text{total}}) V_{\\text{total}}(S_k) + C_{\\text{total}}\n1659: $$\n1660: \n1661: where we redefine $\\kappa_{\\text{total}} := \\kappa_{\\text{total}} \\Delta t$ and $C_{\\text{total}} := C_{\\text{total}} \\Delta t$ for the discrete-time version.\n1662: "
    },
    {
      "directive_type": "corollary",
      "label": "cor-exp-convergence",
      "title": "Exponential Convergence",
      "start_line": 1682,
      "end_line": 1692,
      "header_lines": [
        1683
      ],
      "content_start": 1685,
      "content_end": 1691,
      "content": "1685: :label: cor-exp-convergence\n1686: \n1687: Under the conditions of Theorem [](#thm-fl-drift-adaptive), the empirical distribution $\\mu_N(t)$ of the adaptive swarm converges exponentially fast to the unique Quasi-Stationary Distribution (QSD) $\\pi_{\\text{QSD}}$ in the Lyapunov distance:\n1688: \n1689: $$\n1690: \\mathbb{E}[V_{\\text{total}}(\\mu_N(t))] \\le (1 - \\kappa_{\\text{total}})^t V_{\\text{total}}(\\mu_N(0)) + \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}\n1691: $$",
      "metadata": {
        "label": "cor-exp-convergence"
      },
      "section": "## 7. Foster-Lyapunov Drift for the Full Adaptive System",
      "references": [],
      "raw_directive": "1682: ### 7.3. Corollary: Exponential Convergence to the QSD\n1683: \n1684: :::{prf:corollary} Exponential Convergence\n1685: :label: cor-exp-convergence\n1686: \n1687: Under the conditions of Theorem [](#thm-fl-drift-adaptive), the empirical distribution $\\mu_N(t)$ of the adaptive swarm converges exponentially fast to the unique Quasi-Stationary Distribution (QSD) $\\pi_{\\text{QSD}}$ in the Lyapunov distance:\n1688: \n1689: $$\n1690: \\mathbb{E}[V_{\\text{total}}(\\mu_N(t))] \\le (1 - \\kappa_{\\text{total}})^t V_{\\text{total}}(\\mu_N(0)) + \\frac{C_{\\text{total}}}{\\kappa_{\\text{total}}}\n1691: $$\n1692: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}