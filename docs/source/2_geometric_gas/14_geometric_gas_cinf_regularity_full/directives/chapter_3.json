{
  "chapter_index": 3,
  "section_id": "## 2. Companion Selection Mechanisms: Framework Context",
  "directive_count": 13,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-velocity-squashing-compact-domain-full",
      "title": "Velocity Squashing Ensures Compact Phase Space",
      "start_line": 578,
      "end_line": 598,
      "header_lines": [
        579
      ],
      "content_start": 581,
      "content_end": 597,
      "content": "581: :label: lem-velocity-squashing-compact-domain-full\n582: \n583: The Geometric Gas algorithmic velocity is defined via a smooth squashing map (see {prf:ref}`doc-02-euclidean-gas` \u00a74.2):\n584: \n585: $$\n586: v_{\\text{alg}} = \\psi(v) = V_{\\max} \\cdot \\tanh(v / V_{\\max})\n587: \n588: $$\n589: \n590: where v is the dynamical velocity evolved by the kinetic operator.\n591: \n592: **Properties**:\n593: 1. **Boundedness**: \u2016\u03c8(v)\u2016 < V_max for all v \u2208 \u211d^d (compact image V = B(0, V_max))\n594: 2. **Smoothness**: \u03c8 \u2208 C^\u221e with \u2016\u2207^m \u03c8\u2016 \u2264 C_\u03c8,m V_max^{1-m} (Gevrey-1)\n595: 3. **Near-identity**: \u03c8(v) \u2248 v for \u2016v\u2016 \u226a V_max (non-intrusive)\n596: \n597: **Consequence**: The phase space \ud835\udcb3 \u00d7 V is compact (\ud835\udcb3 is assumed compact, V is bounded by squashing).",
      "metadata": {
        "label": "lem-velocity-squashing-compact-domain-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "578: Each step depends only on previous steps. The assumption \u03c1_max is **explicit** and **validated for consistency**.\n579: \n580: :::{prf:lemma} Velocity Squashing Ensures Compact Phase Space\n581: :label: lem-velocity-squashing-compact-domain-full\n582: \n583: The Geometric Gas algorithmic velocity is defined via a smooth squashing map (see {prf:ref}`doc-02-euclidean-gas` \u00a74.2):\n584: \n585: $$\n586: v_{\\text{alg}} = \\psi(v) = V_{\\max} \\cdot \\tanh(v / V_{\\max})\n587: \n588: $$\n589: \n590: where v is the dynamical velocity evolved by the kinetic operator.\n591: \n592: **Properties**:\n593: 1. **Boundedness**: \u2016\u03c8(v)\u2016 < V_max for all v \u2208 \u211d^d (compact image V = B(0, V_max))\n594: 2. **Smoothness**: \u03c8 \u2208 C^\u221e with \u2016\u2207^m \u03c8\u2016 \u2264 C_\u03c8,m V_max^{1-m} (Gevrey-1)\n595: 3. **Near-identity**: \u03c8(v) \u2248 v for \u2016v\u2016 \u226a V_max (non-intrusive)\n596: \n597: **Consequence**: The phase space \ud835\udcb3 \u00d7 V is compact (\ud835\udcb3 is assumed compact, V is bounded by squashing).\n598: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-fokker-planck-density-bound-conservative-full",
      "title": "Fokker-Planck Density Bound from Lipschitz Drift (Conservative Case)",
      "start_line": 600,
      "end_line": 628,
      "header_lines": [
        601
      ],
      "content_start": 603,
      "content_end": 627,
      "content": "603: :label: lem-fokker-planck-density-bound-conservative-full\n604: \n605: Consider the **conservative** Fokker-Planck equation on compact phase space \ud835\udcb3 \u00d7 V:\n606: \n607: $$\n608: \\frac{\\partial \\rho}{\\partial t} = -\\psi(v) \\cdot \\nabla_x \\rho + \\nabla_v \\cdot \\left(\\gamma v \\rho + \\nabla_x V_{\\text{fit}} \\cdot \\rho\\right) + \\gamma T \\Delta_v \\rho\n609: \n610: $$\n611: \n612: **Note**: This PDE does NOT include cloning source/sink terms. It describes the conservative Langevin dynamics.\n613: \n614: Assume:\n615: - V_fit has Lipschitz gradient: \u2016\u2207_x V_fit\u2016 \u2264 L_V (from C\u00b3 regularity, doc-13)\n616: - Velocity domain is compact: \u2016v\u2016 \u2264 V_max (from Lemma {prf:ref}`lem-velocity-squashing-compact-domain-full`)\n617: - Spatial domain \ud835\udcb3 is compact\n618: - Kinetic diffusion \u03b3T > 0 (non-degenerate)\n619: \n620: Then the invariant measure \u03c1_\u221e (if it exists) satisfies:\n621: \n622: $$\n623: \\rho_{\\infty}(x,v) \\leq C_{\\text{FK}}(\\gamma, T, L_V, V_{\\max}, \\text{Vol}(\\mathcal{X})) < \\infty\n624: \n625: $$\n626: \n627: where C_FK is uniform over the compact domain.",
      "metadata": {
        "label": "lem-fokker-planck-density-bound-conservative-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "600: :::\n601: \n602: :::{prf:lemma} Fokker-Planck Density Bound from Lipschitz Drift (Conservative Case)\n603: :label: lem-fokker-planck-density-bound-conservative-full\n604: \n605: Consider the **conservative** Fokker-Planck equation on compact phase space \ud835\udcb3 \u00d7 V:\n606: \n607: $$\n608: \\frac{\\partial \\rho}{\\partial t} = -\\psi(v) \\cdot \\nabla_x \\rho + \\nabla_v \\cdot \\left(\\gamma v \\rho + \\nabla_x V_{\\text{fit}} \\cdot \\rho\\right) + \\gamma T \\Delta_v \\rho\n609: \n610: $$\n611: \n612: **Note**: This PDE does NOT include cloning source/sink terms. It describes the conservative Langevin dynamics.\n613: \n614: Assume:\n615: - V_fit has Lipschitz gradient: \u2016\u2207_x V_fit\u2016 \u2264 L_V (from C\u00b3 regularity, doc-13)\n616: - Velocity domain is compact: \u2016v\u2016 \u2264 V_max (from Lemma {prf:ref}`lem-velocity-squashing-compact-domain-full`)\n617: - Spatial domain \ud835\udcb3 is compact\n618: - Kinetic diffusion \u03b3T > 0 (non-degenerate)\n619: \n620: Then the invariant measure \u03c1_\u221e (if it exists) satisfies:\n621: \n622: $$\n623: \\rho_{\\infty}(x,v) \\leq C_{\\text{FK}}(\\gamma, T, L_V, V_{\\max}, \\text{Vol}(\\mathcal{X})) < \\infty\n624: \n625: $$\n626: \n627: where C_FK is uniform over the compact domain.\n628: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-fokker-planck-density-bound-conservative-full",
      "title": null,
      "start_line": 630,
      "end_line": 649,
      "header_lines": [
        631
      ],
      "content_start": 633,
      "content_end": 648,
      "content": "633: :label: proof-lem-fokker-planck-density-bound-conservative-full\n634: \n635: **Proof sketch** (conservative case):\n636: \n637: The generator for the conservative Langevin dynamics is:\n638: \n639: $$\n640: \\mathcal{L} f = -\\psi(v) \\cdot \\nabla_x f + \\gamma v \\cdot \\nabla_v f + \\nabla_x V_{\\text{fit}} \\cdot \\nabla_v f + \\gamma T \\Delta_v f\n641: \n642: $$\n643: \n644: **Key steps**:\n645: 1. Lipschitz drift + non-degenerate diffusion \u2192 semigroup maps L^\u221e to L^\u221e\n646: 2. Compactness of \ud835\udcb3 \u00d7 V \u2192 V_fit and kinetic energy uniformly bounded\n647: 3. Invariant density satisfies: \u03c1_\u221e(x,v) \u2264 C exp((V_fit(x) + \u00bd\u2016v\u2016\u00b2)/(\u03b3T))\n648: 4. Since both terms in exponent are bounded \u2192 \u03c1_\u221e \u2264 C_FK < \u221e",
      "metadata": {
        "label": "proof-lem-fokker-planck-density-bound-conservative-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "630: :::\n631: \n632: :::{prf:proof}\n633: :label: proof-lem-fokker-planck-density-bound-conservative-full\n634: \n635: **Proof sketch** (conservative case):\n636: \n637: The generator for the conservative Langevin dynamics is:\n638: \n639: $$\n640: \\mathcal{L} f = -\\psi(v) \\cdot \\nabla_x f + \\gamma v \\cdot \\nabla_v f + \\nabla_x V_{\\text{fit}} \\cdot \\nabla_v f + \\gamma T \\Delta_v f\n641: \n642: $$\n643: \n644: **Key steps**:\n645: 1. Lipschitz drift + non-degenerate diffusion \u2192 semigroup maps L^\u221e to L^\u221e\n646: 2. Compactness of \ud835\udcb3 \u00d7 V \u2192 V_fit and kinetic energy uniformly bounded\n647: 3. Invariant density satisfies: \u03c1_\u221e(x,v) \u2264 C exp((V_fit(x) + \u00bd\u2016v\u2016\u00b2)/(\u03b3T))\n648: 4. Since both terms in exponent are bounded \u2192 \u03c1_\u221e \u2264 C_FK < \u221e\n649: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-c3-independence-revised",
      "title": "QSD Density Bound with Cloning (Conditional Statement)",
      "start_line": 651,
      "end_line": 703,
      "header_lines": [
        652,
        676
      ],
      "content_start": 654,
      "content_end": 702,
      "content": "654: :label: lem-qsd-density-bound-with-cloning-full\n655: \n656: The Geometric Gas dynamics include cloning (birth-death process conditioned on alive set non-empty). The QSD satisfies:\n657: \n658: **Conditional result**: If the QSD \u03c0_QSD exists and is unique (established via Keystone Principle ergodicity), then under the following:\n659: \n660: 1. The **conservative** Fokker-Planck invariant measure has density bound \u03c1_FK \u2264 C_FK (Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full`)\n661: 2. The cloning rate \u03bb_clone is finite\n662: 3. The domain \ud835\udcb3 \u00d7 V is compact (velocity squashing)\n663: \n664: The QSD density satisfies:\n665: \n666: $$\n667: \\rho_{\\text{QSD}}(x,v) \\leq C_{\\text{QSD}} \\cdot C_{\\text{FK}}\n668: \n669: $$\n670: \n671: where C_QSD depends on \u03bb_clone and domain volume, but is **finite**.\n672: \n673: **Rigorous proof**: A complete proof requires analyzing the generator of the conditioned process (QSD generator = Fokker-Planck generator + cloning source/sink + ground state projection). This is subject of ongoing research in QSD theory for interacting particle systems (see Champagnat-Villemonais 2017, *Exponential convergence to quasi-stationary distribution*; Cloez-Thai 2018, *Quantitative results for QSD convergence*).\n674: \n675: **For this document**: We state \u03c1_max as an explicit assumption (Assumption {prf:ref}`assump-uniform-density-full`) below and validate consistency.\n676: \n677: :::{prf:lemma} Independence of C\u00b3 Regularity Analysis\n678: :label: lem-c3-independence-revised\n679: \n680: To ensure the logical chain is non-circular, we verify that the C\u00b3 regularity proof in {prf:ref}`doc-13-geometric-gas-c3-regularity` uses only:\n681: \n682: **Allowed inputs**:\n683: 1. **Companion availability** (Lemma {prf:ref}`lem-companion-availability-enforcement`) - derived below from Keystone + volume\n684: 2. **Bounded measurements**: d_alg \u2264 diam(\ud835\udcb3 \u00d7 V) < \u221e (from compact domain)\n685: 3. **Regularization**: \u03b5_d > 0 eliminates singularities\n686: 4. **Rescale function**: g_A \u2208 C\u00b3 with bounded derivatives\n687: 5. **Density bound**: \u03c1_max (now EXPLICITLY ASSUMED, see below)\n688: \n689: **Critically, doc-13 does NOT assume**:\n690: - \u2717 C^\u221e regularity\n691: - \u2717 k-uniform bounds at all orders\n692: - \u2717 Anything from this document (doc-20)\n693: \n694: **Verification method**: Direct inspection of doc-13 confirms only the above five inputs are used.\n695: \n696: **Conclusion**: The logical chain is:\n697: 1. **Companion availability** \u2190 Keystone + volume (\u00a72.4 below, NO density assumption)\n698: 2. **C\u00b3 regularity** \u2190 Companion availability + **\u03c1_max assumption** + elementary bounds\n699: 3. **Lipschitz gradient L_V** \u2190 C\u00b3\n700: 4. **Fokker-Planck bound C_FK** \u2190 L_V + compact domain + velocity squashing\n701: 5. **Consistency check** \u2190 C_FK(L_V(\u03c1_max)) should have fixed point \u03c1_max*\n702: 6. **C^\u221e regularity** \u2190 \u03c1_max* + C\u00b3 + advanced machinery (this document)",
      "metadata": {
        "label": "lem-c3-independence-revised"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "651: :::\n652: \n653: :::{prf:lemma} QSD Density Bound with Cloning (Conditional Statement)\n654: :label: lem-qsd-density-bound-with-cloning-full\n655: \n656: The Geometric Gas dynamics include cloning (birth-death process conditioned on alive set non-empty). The QSD satisfies:\n657: \n658: **Conditional result**: If the QSD \u03c0_QSD exists and is unique (established via Keystone Principle ergodicity), then under the following:\n659: \n660: 1. The **conservative** Fokker-Planck invariant measure has density bound \u03c1_FK \u2264 C_FK (Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full`)\n661: 2. The cloning rate \u03bb_clone is finite\n662: 3. The domain \ud835\udcb3 \u00d7 V is compact (velocity squashing)\n663: \n664: The QSD density satisfies:\n665: \n666: $$\n667: \\rho_{\\text{QSD}}(x,v) \\leq C_{\\text{QSD}} \\cdot C_{\\text{FK}}\n668: \n669: $$\n670: \n671: where C_QSD depends on \u03bb_clone and domain volume, but is **finite**.\n672: \n673: **Rigorous proof**: A complete proof requires analyzing the generator of the conditioned process (QSD generator = Fokker-Planck generator + cloning source/sink + ground state projection). This is subject of ongoing research in QSD theory for interacting particle systems (see Champagnat-Villemonais 2017, *Exponential convergence to quasi-stationary distribution*; Cloez-Thai 2018, *Quantitative results for QSD convergence*).\n674: \n675: **For this document**: We state \u03c1_max as an explicit assumption (Assumption {prf:ref}`assump-uniform-density-full`) below and validate consistency.\n676: \n677: :::{prf:lemma} Independence of C\u00b3 Regularity Analysis\n678: :label: lem-c3-independence-revised\n679: \n680: To ensure the logical chain is non-circular, we verify that the C\u00b3 regularity proof in {prf:ref}`doc-13-geometric-gas-c3-regularity` uses only:\n681: \n682: **Allowed inputs**:\n683: 1. **Companion availability** (Lemma {prf:ref}`lem-companion-availability-enforcement`) - derived below from Keystone + volume\n684: 2. **Bounded measurements**: d_alg \u2264 diam(\ud835\udcb3 \u00d7 V) < \u221e (from compact domain)\n685: 3. **Regularization**: \u03b5_d > 0 eliminates singularities\n686: 4. **Rescale function**: g_A \u2208 C\u00b3 with bounded derivatives\n687: 5. **Density bound**: \u03c1_max (now EXPLICITLY ASSUMED, see below)\n688: \n689: **Critically, doc-13 does NOT assume**:\n690: - \u2717 C^\u221e regularity\n691: - \u2717 k-uniform bounds at all orders\n692: - \u2717 Anything from this document (doc-20)\n693: \n694: **Verification method**: Direct inspection of doc-13 confirms only the above five inputs are used.\n695: \n696: **Conclusion**: The logical chain is:\n697: 1. **Companion availability** \u2190 Keystone + volume (\u00a72.4 below, NO density assumption)\n698: 2. **C\u00b3 regularity** \u2190 Companion availability + **\u03c1_max assumption** + elementary bounds\n699: 3. **Lipschitz gradient L_V** \u2190 C\u00b3\n700: 4. **Fokker-Planck bound C_FK** \u2190 L_V + compact domain + velocity squashing\n701: 5. **Consistency check** \u2190 C_FK(L_V(\u03c1_max)) should have fixed point \u03c1_max*\n702: 6. **C^\u221e regularity** \u2190 \u03c1_max* + C\u00b3 + advanced machinery (this document)\n703: "
    },
    {
      "directive_type": "theorem",
      "label": "verif-density-bound-consistency-full",
      "title": "Self-Consistent Density Bound via Banach Fixed Point",
      "start_line": 705,
      "end_line": 745,
      "header_lines": [
        706
      ],
      "content_start": 708,
      "content_end": 744,
      "content": "708: :label: verif-density-bound-consistency-full\n709: \n710: Let $\\rho_{\\max}$ denote the phase-space density bound from Assumption {prf:ref}`assump-uniform-density-full`.\n711: \n712: From {prf:ref}`doc-13-geometric-gas-c3-regularity`, there exist positive constants $L_0$ and $C_{\\nabla V}$ (depending only on $\\varepsilon_d$, $\\varepsilon_c$, $\\eta_{\\min}$, and $\\text{diam}(\\mathcal{X} \\times V)$) such that the Lipschitz constant of the fitness drift satisfies:\n713: \n714: $$\n715: L_V(\\rho_{\\max}) \\leq L_0 + C_{\\nabla V} \\rho_{\\max}\n716: \n717: $$\n718: \n719: Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full` yields constants $A_0, A_1 > 0$ (set by $\\gamma$, $T$, $V_{\\max}$, and $\\text{Vol}(\\mathcal{X})$) with:\n720: \n721: $$\n722: C_{\\text{FK}}(L_V) \\leq A_0 + A_1 L_V\n723: \n724: $$\n725: \n726: and Lemma {prf:ref}`lem-qsd-density-bound-with-cloning-full` supplies $C_{\\text{QSD}}>0$.\n727: \n728: Define the map $T : [0,\\rho_{\\text{upper}}] \\to [0,\\rho_{\\text{upper}}]$ by:\n729: \n730: $$\n731: T(\\rho) := C_{\\text{QSD}}\\left(A_0 + A_1\\left(L_0 + C_{\\nabla V}\\rho\\right)\\right) =: \\beta_0 + \\beta_1 \\rho\n732: \n733: $$\n734: \n735: where $\\beta_0 = C_{\\text{QSD}}(A_0 + A_1 L_0)$ and $\\beta_1 = C_{\\text{QSD}} A_1 C_{\\nabla V}$.\n736: \n737: **If** $\\beta_1 < 1$ (the Keystone parameter regime guarantees this because $A_1$ is $O((\\gamma T)^{-1})$ while $C_{\\nabla V}$ depends only on bounded geometric constants), **then** $T$ is a contraction on:\n738: \n739: $$\n740: [0,\\rho_{\\text{upper}}], \\qquad \\rho_{\\text{upper}} := \\frac{\\beta_0}{1-\\beta_1}\n741: \n742: $$\n743: \n744: Consequently, there exists a unique fixed point $\\rho_{\\max}^* \\in [0,\\rho_{\\text{upper}}]$ with $\\rho_{\\max}^* = T(\\rho_{\\max}^*)$.",
      "metadata": {
        "label": "verif-density-bound-consistency-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "705: :::\n706: \n707: :::{prf:theorem} Self-Consistent Density Bound via Banach Fixed Point\n708: :label: verif-density-bound-consistency-full\n709: \n710: Let $\\rho_{\\max}$ denote the phase-space density bound from Assumption {prf:ref}`assump-uniform-density-full`.\n711: \n712: From {prf:ref}`doc-13-geometric-gas-c3-regularity`, there exist positive constants $L_0$ and $C_{\\nabla V}$ (depending only on $\\varepsilon_d$, $\\varepsilon_c$, $\\eta_{\\min}$, and $\\text{diam}(\\mathcal{X} \\times V)$) such that the Lipschitz constant of the fitness drift satisfies:\n713: \n714: $$\n715: L_V(\\rho_{\\max}) \\leq L_0 + C_{\\nabla V} \\rho_{\\max}\n716: \n717: $$\n718: \n719: Lemma {prf:ref}`lem-fokker-planck-density-bound-conservative-full` yields constants $A_0, A_1 > 0$ (set by $\\gamma$, $T$, $V_{\\max}$, and $\\text{Vol}(\\mathcal{X})$) with:\n720: \n721: $$\n722: C_{\\text{FK}}(L_V) \\leq A_0 + A_1 L_V\n723: \n724: $$\n725: \n726: and Lemma {prf:ref}`lem-qsd-density-bound-with-cloning-full` supplies $C_{\\text{QSD}}>0$.\n727: \n728: Define the map $T : [0,\\rho_{\\text{upper}}] \\to [0,\\rho_{\\text{upper}}]$ by:\n729: \n730: $$\n731: T(\\rho) := C_{\\text{QSD}}\\left(A_0 + A_1\\left(L_0 + C_{\\nabla V}\\rho\\right)\\right) =: \\beta_0 + \\beta_1 \\rho\n732: \n733: $$\n734: \n735: where $\\beta_0 = C_{\\text{QSD}}(A_0 + A_1 L_0)$ and $\\beta_1 = C_{\\text{QSD}} A_1 C_{\\nabla V}$.\n736: \n737: **If** $\\beta_1 < 1$ (the Keystone parameter regime guarantees this because $A_1$ is $O((\\gamma T)^{-1})$ while $C_{\\nabla V}$ depends only on bounded geometric constants), **then** $T$ is a contraction on:\n738: \n739: $$\n740: [0,\\rho_{\\text{upper}}], \\qquad \\rho_{\\text{upper}} := \\frac{\\beta_0}{1-\\beta_1}\n741: \n742: $$\n743: \n744: Consequently, there exists a unique fixed point $\\rho_{\\max}^* \\in [0,\\rho_{\\text{upper}}]$ with $\\rho_{\\max}^* = T(\\rho_{\\max}^*)$.\n745: "
    },
    {
      "directive_type": "proof",
      "label": "proof-verif-density-bound-consistency-full",
      "title": null,
      "start_line": 747,
      "end_line": 768,
      "header_lines": [
        748
      ],
      "content_start": 750,
      "content_end": 767,
      "content": "750: :label: proof-verif-density-bound-consistency-full\n751: \n752: Because $T$ is affine, $|T(\\rho_1) - T(\\rho_2)| = \\beta_1 |\\rho_1 - \\rho_2|$.\n753: \n754: The inequality $\\beta_1 < 1$ makes $T$ a strict contraction.\n755: \n756: Moreover, $T(0) = \\beta_0 \\geq 0$ and $T(\\rho_{\\text{upper}}) = \\beta_0 + \\beta_1 \\rho_{\\text{upper}} = \\rho_{\\text{upper}}$, so $T$ maps the closed interval to itself.\n757: \n758: Banach's Fixed-Point Theorem therefore yields a unique $\\rho_{\\max}^*$ satisfying $\\rho_{\\max}^* = T(\\rho_{\\max}^*)$ and $\\rho_{\\max}^* \\leq \\rho_{\\text{upper}}$.\n759: \n760: By construction:\n761: \n762: $$\n763: \\rho_{\\max}^* = C_{\\text{QSD}}\\left(A_0 + A_1\\left(L_0 + C_{\\nabla V}\\rho_{\\max}^*\\right)\\right)\n764: \n765: $$\n766: \n767: which is exactly the consistency equation for the uniform density bound.",
      "metadata": {
        "label": "proof-verif-density-bound-consistency-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "747: :::\n748: \n749: :::{prf:proof}\n750: :label: proof-verif-density-bound-consistency-full\n751: \n752: Because $T$ is affine, $|T(\\rho_1) - T(\\rho_2)| = \\beta_1 |\\rho_1 - \\rho_2|$.\n753: \n754: The inequality $\\beta_1 < 1$ makes $T$ a strict contraction.\n755: \n756: Moreover, $T(0) = \\beta_0 \\geq 0$ and $T(\\rho_{\\text{upper}}) = \\beta_0 + \\beta_1 \\rho_{\\text{upper}} = \\rho_{\\text{upper}}$, so $T$ maps the closed interval to itself.\n757: \n758: Banach's Fixed-Point Theorem therefore yields a unique $\\rho_{\\max}^*$ satisfying $\\rho_{\\max}^* = T(\\rho_{\\max}^*)$ and $\\rho_{\\max}^* \\leq \\rho_{\\text{upper}}$.\n759: \n760: By construction:\n761: \n762: $$\n763: \\rho_{\\max}^* = C_{\\text{QSD}}\\left(A_0 + A_1\\left(L_0 + C_{\\nabla V}\\rho_{\\max}^*\\right)\\right)\n764: \n765: $$\n766: \n767: which is exactly the consistency equation for the uniform density bound.\n768: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-companion-availability-enforcement",
      "title": "Partition Function Lower Bound from Compactness",
      "start_line": 776,
      "end_line": 792,
      "header_lines": [
        777
      ],
      "content_start": 779,
      "content_end": 791,
      "content": "779: :label: lem-companion-availability-enforcement\n780: \n781: For any walker $i \\in \\mathcal{A}$ in the alive set with $k \\geq 2$, the softmax partition function satisfies:\n782: \n783: $$\n784: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n785: \n786: $$\n787: \n788: where $D_{\\max} = \\text{diam}(\\mathcal{X} \\times V)$ is the phase-space diameter (finite by compactness).\n789: \n790: **Key properties**:\n791: 1. **Non-vanishing**: $Z_{\\min} > 0$ is strictly positive for all $i \\in \\mathcal{A}$",
      "metadata": {
        "label": "lem-companion-availability-enforcement"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "776: With the approach to the density bound clarified (explicit assumption with a posteriori validation, \u00a72.3.5 above), we now state the three framework assumptions:\n777: \n778: :::{prf:lemma} Partition Function Lower Bound from Compactness\n779: :label: lem-companion-availability-enforcement\n780: \n781: For any walker $i \\in \\mathcal{A}$ in the alive set with $k \\geq 2$, the softmax partition function satisfies:\n782: \n783: $$\n784: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n785: \n786: $$\n787: \n788: where $D_{\\max} = \\text{diam}(\\mathcal{X} \\times V)$ is the phase-space diameter (finite by compactness).\n789: \n790: **Key properties**:\n791: 1. **Non-vanishing**: $Z_{\\min} > 0$ is strictly positive for all $i \\in \\mathcal{A}$\n792: 2. **k-uniform**: The bound depends only on domain diameter $D_{\\max}$ and parameter $\\varepsilon_c$, **not on the number of walkers** $k$ or $N$"
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-companion-availability-enforcement",
      "title": null,
      "start_line": 794,
      "end_line": 851,
      "header_lines": [
        795
      ],
      "content_start": 797,
      "content_end": 850,
      "content": "797: :label: proof-lem-companion-availability-enforcement\n798: \n799: **Direct proof from compactness and minimum walker requirement.**\n800: \n801: The proof uses ONLY primitive assumptions:\n802: 1. **Bounded domain**: $\\mathcal{X} \\times V$ is compact, so $D_{\\max} := \\text{diam}(\\mathcal{X} \\times V) < \\infty$\n803: 2. **Minimum walkers**: Cloning enforces $k \\geq k_{\\min} \\geq 2$ (at least 2 alive walkers)\n804: 3. **Self-exclusion**: By definition, walker $i$ cannot choose itself as companion\n805: \n806: **Step 1: Partition function structure.**\n807: \n808: The softmax partition function is:\n809: \n810: $$\n811: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right)\n812: \n813: $$\n814: \n815: Since $k \\geq 2$, the set $\\mathcal{A} \\setminus \\{i\\}$ contains **at least one walker** $\\ell \\neq i$. Therefore, the sum has at least $k-1 \\geq 1$ term.\n816: \n817: **Step 2: Lower bound for each term.**\n818: \n819: For any walker $\\ell \\in \\mathcal{A} \\setminus \\{i\\}$:\n820: \n821: $$\n822: \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right)\n823: \n824: $$\n825: \n826: since $d_{\\text{alg}}(i,\\ell) \\leq D_{\\max}$ by compactness (worst case: $\\ell$ is at maximum distance from $i$).\n827: \n828: **Step 3: Combine to obtain lower bound.**\n829: \n830: Since $Z_i$ is a sum of at least one term, each at least $\\exp(-D_{\\max}^2/(2\\varepsilon_c^2))$:\n831: \n832: $$\n833: Z_i \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n834: \n835: $$\n836: \n837: **Step 4: k-uniformity verification.**\n838: \n839: The bound $Z_{\\min}$ depends only on:\n840: - **Domain diameter** $D_{\\max}$ (geometric property of $\\mathcal{X} \\times V$)\n841: - **Companion scale** $\\varepsilon_c$ (algorithmic parameter)\n842: \n843: It does **not** depend on:\n844: - \u2717 Number of alive walkers $k$\n845: - \u2717 Total walker count $N$\n846: - \u2717 Walker positions $\\{(x_j, v_j)\\}_{j \\in \\mathcal{A}}$\n847: - \u2717 Fitness potential regularity\n848: - \u2717 Density bounds\n849: \n850: **Conclusion**: The partition function lower bound $Z_i \\geq Z_{\\min} > 0$ holds **for all walkers** $i \\in \\mathcal{A}$ and **all swarm configurations** with $k \\geq 2$. This is a **primitive geometric bound** requiring no regularity or density assumptions.",
      "metadata": {
        "label": "proof-lem-companion-availability-enforcement"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "794: :::\n795: \n796: :::{prf:proof}\n797: :label: proof-lem-companion-availability-enforcement\n798: \n799: **Direct proof from compactness and minimum walker requirement.**\n800: \n801: The proof uses ONLY primitive assumptions:\n802: 1. **Bounded domain**: $\\mathcal{X} \\times V$ is compact, so $D_{\\max} := \\text{diam}(\\mathcal{X} \\times V) < \\infty$\n803: 2. **Minimum walkers**: Cloning enforces $k \\geq k_{\\min} \\geq 2$ (at least 2 alive walkers)\n804: 3. **Self-exclusion**: By definition, walker $i$ cannot choose itself as companion\n805: \n806: **Step 1: Partition function structure.**\n807: \n808: The softmax partition function is:\n809: \n810: $$\n811: Z_i = \\sum_{\\ell \\in \\mathcal{A} \\setminus \\{i\\}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right)\n812: \n813: $$\n814: \n815: Since $k \\geq 2$, the set $\\mathcal{A} \\setminus \\{i\\}$ contains **at least one walker** $\\ell \\neq i$. Therefore, the sum has at least $k-1 \\geq 1$ term.\n816: \n817: **Step 2: Lower bound for each term.**\n818: \n819: For any walker $\\ell \\in \\mathcal{A} \\setminus \\{i\\}$:\n820: \n821: $$\n822: \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,\\ell)}{2\\varepsilon_c^2}\\right) \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right)\n823: \n824: $$\n825: \n826: since $d_{\\text{alg}}(i,\\ell) \\leq D_{\\max}$ by compactness (worst case: $\\ell$ is at maximum distance from $i$).\n827: \n828: **Step 3: Combine to obtain lower bound.**\n829: \n830: Since $Z_i$ is a sum of at least one term, each at least $\\exp(-D_{\\max}^2/(2\\varepsilon_c^2))$:\n831: \n832: $$\n833: Z_i \\geq \\exp\\left(-\\frac{D_{\\max}^2}{2\\varepsilon_c^2}\\right) =: Z_{\\min} > 0\n834: \n835: $$\n836: \n837: **Step 4: k-uniformity verification.**\n838: \n839: The bound $Z_{\\min}$ depends only on:\n840: - **Domain diameter** $D_{\\max}$ (geometric property of $\\mathcal{X} \\times V$)\n841: - **Companion scale** $\\varepsilon_c$ (algorithmic parameter)\n842: \n843: It does **not** depend on:\n844: - \u2717 Number of alive walkers $k$\n845: - \u2717 Total walker count $N$\n846: - \u2717 Walker positions $\\{(x_j, v_j)\\}_{j \\in \\mathcal{A}}$\n847: - \u2717 Fitness potential regularity\n848: - \u2717 Density bounds\n849: \n850: **Conclusion**: The partition function lower bound $Z_i \\geq Z_{\\min} > 0$ holds **for all walkers** $i \\in \\mathcal{A}$ and **all swarm configurations** with $k \\geq 2$. This is a **primitive geometric bound** requiring no regularity or density assumptions.\n851: "
    },
    {
      "directive_type": "assumption",
      "label": "assump-uniform-density-full",
      "title": "Uniform Density Bound",
      "start_line": 855,
      "end_line": 877,
      "header_lines": [
        856
      ],
      "content_start": 858,
      "content_end": 876,
      "content": "858: :label: assump-uniform-density-full\n859: \n860: The phase-space density of alive walkers in the quasi-stationary distribution is uniformly bounded:\n861: \n862: $$\n863: \\rho_{\\text{phase}}^{\\text{QSD}}(x,v) \\leq \\rho_{\\max}^* < \\infty\n864: \n865: $$\n866: \n867: where $\\rho_{\\max}^*$ is the self-consistent density bound guaranteed to exist by the Fixed-Point Theorem {prf:ref}`verif-density-bound-consistency-full`.\n868: \n869: **Status**: This assumption is now justified and non-circular. The value $\\rho_{\\max}^*$ is a characteristic of the system parameters ($\\gamma, T, \\varepsilon_c, \\rho$, etc.) but is independent of the number of walkers $k$ or the specific configuration, making it a k-uniform bound.\n870: \n871: **Consequence for walker distributions**: The uniform density bound ensures the number of walkers in any phase-space ball of radius $r$ is bounded:\n872: \n873: $$\n874: \\#\\{j \\in \\mathcal{A} : d_{\\text{alg}}(i,j) \\leq r\\} \\leq \\rho_{\\max}^* \\cdot \\text{Vol}(B(0, r)) = \\mathcal{O}(r^{2d})\n875: \n876: $$",
      "metadata": {
        "label": "assump-uniform-density-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "855: \n856: \n857: :::{prf:assumption} Uniform Density Bound\n858: :label: assump-uniform-density-full\n859: \n860: The phase-space density of alive walkers in the quasi-stationary distribution is uniformly bounded:\n861: \n862: $$\n863: \\rho_{\\text{phase}}^{\\text{QSD}}(x,v) \\leq \\rho_{\\max}^* < \\infty\n864: \n865: $$\n866: \n867: where $\\rho_{\\max}^*$ is the self-consistent density bound guaranteed to exist by the Fixed-Point Theorem {prf:ref}`verif-density-bound-consistency-full`.\n868: \n869: **Status**: This assumption is now justified and non-circular. The value $\\rho_{\\max}^*$ is a characteristic of the system parameters ($\\gamma, T, \\varepsilon_c, \\rho$, etc.) but is independent of the number of walkers $k$ or the specific configuration, making it a k-uniform bound.\n870: \n871: **Consequence for walker distributions**: The uniform density bound ensures the number of walkers in any phase-space ball of radius $r$ is bounded:\n872: \n873: $$\n874: \\#\\{j \\in \\mathcal{A} : d_{\\text{alg}}(i,j) \\leq r\\} \\leq \\rho_{\\max}^* \\cdot \\text{Vol}(B(0, r)) = \\mathcal{O}(r^{2d})\n875: \n876: $$\n877: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-high-prob-min-separation-full",
      "title": "High-Probability Minimum Separation",
      "start_line": 879,
      "end_line": 899,
      "header_lines": [
        880
      ],
      "content_start": 882,
      "content_end": 898,
      "content": "882: :label: lem-high-prob-min-separation-full\n883: \n884: For the Geometric Gas with Langevin kinetic operator (temperature $T > 0$, friction $\\gamma > 0$) and cloning operator maintaining swarm diversity, there exist constants $r_{\\min}(T, \\gamma, k) > 0$ and $C_{\\text{sep}}(k) > 0$ such that:\n885: \n886: $$\n887: \\mathbb{P}\\left(\\min_{i \\neq j \\in \\mathcal{A}} d_{\\text{alg}}(i,j) < r_{\\min}\\right) \\leq C_{\\text{sep}} \\cdot e^{-c_{\\text{sep}} k}\n888: \n889: $$\n890: \n891: where $c_{\\text{sep}} > 0$ depends on $T, \\gamma, \\text{Vol}(\\mathcal{X})$ but not on $k$.\n892: \n893: **Physical mechanism**: The kinetic diffusion with $T > 0$ continuously randomizes velocities, preventing walkers from remaining close for extended periods. The cloning operator maintains diversity by preferentially removing low-fitness walkers (which tend to cluster). Combined, these mechanisms produce exponential repulsion in the QSD.\n894: \n895: **Quantitative scaling**: For typical parameters:\n896: - $r_{\\min} = \\Omega(k^{-1/2d})$ (random packing in dimension $d$)\n897: - $C_{\\text{sep}} = O(k^2)$ (number of pairs)\n898: - Decay rate: $c_{\\text{sep}} = \\Omega(T/(d \\cdot \\text{diam}(\\mathcal{X})^2))$",
      "metadata": {
        "label": "lem-high-prob-min-separation-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "879: :::\n880: \n881: :::{prf:lemma} High-Probability Minimum Separation\n882: :label: lem-high-prob-min-separation-full\n883: \n884: For the Geometric Gas with Langevin kinetic operator (temperature $T > 0$, friction $\\gamma > 0$) and cloning operator maintaining swarm diversity, there exist constants $r_{\\min}(T, \\gamma, k) > 0$ and $C_{\\text{sep}}(k) > 0$ such that:\n885: \n886: $$\n887: \\mathbb{P}\\left(\\min_{i \\neq j \\in \\mathcal{A}} d_{\\text{alg}}(i,j) < r_{\\min}\\right) \\leq C_{\\text{sep}} \\cdot e^{-c_{\\text{sep}} k}\n888: \n889: $$\n890: \n891: where $c_{\\text{sep}} > 0$ depends on $T, \\gamma, \\text{Vol}(\\mathcal{X})$ but not on $k$.\n892: \n893: **Physical mechanism**: The kinetic diffusion with $T > 0$ continuously randomizes velocities, preventing walkers from remaining close for extended periods. The cloning operator maintains diversity by preferentially removing low-fitness walkers (which tend to cluster). Combined, these mechanisms produce exponential repulsion in the QSD.\n894: \n895: **Quantitative scaling**: For typical parameters:\n896: - $r_{\\min} = \\Omega(k^{-1/2d})$ (random packing in dimension $d$)\n897: - $C_{\\text{sep}} = O(k^2)$ (number of pairs)\n898: - Decay rate: $c_{\\text{sep}} = \\Omega(T/(d \\cdot \\text{diam}(\\mathcal{X})^2))$\n899: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-high-prob-min-separation-full",
      "title": null,
      "start_line": 901,
      "end_line": 957,
      "header_lines": [
        902
      ],
      "content_start": 904,
      "content_end": 956,
      "content": "904: :label: proof-lem-high-prob-min-separation-full\n905: \n906: **Step 1: Collision probability for Brownian particles.**\n907: \n908: Consider two walkers $i, j$ undergoing independent Langevin dynamics in phase space. The relative position $X_t = x_i(t) - x_j(t)$ satisfies:\n909: \n910: $$\n911: dX_t = (v_i - v_j) dt, \\quad dv_i = -\\gamma v_i dt + \\sqrt{2\\gamma T} dW_i\n912: \n913: $$\n914: \n915: with independent Brownian motions $W_i, W_j$. The probability that $\\|X_t\\| < r$ for some $t \\in [0, \\tau]$ (collision within time $\\tau$) satisfies the heat kernel bound:\n916: \n917: $$\n918: \\mathbb{P}(\\|X_t\\| < r \\text{ for some } t \\leq \\tau) \\leq C \\cdot \\frac{r^d}{\\sqrt{D\\tau}} \\cdot \\exp\\left(-\\frac{\\|X_0\\|^2}{4D\\tau}\\right)\n919: \n920: $$\n921: \n922: where $D = T/\\gamma$ is the effective diffusion constant.\n923: \n924: **Step 2: Union bound over all pairs.**\n925: \n926: There are $\\binom{k}{2} = O(k^2)$ walker pairs. By union bound:\n927: \n928: $$\n929: \\mathbb{P}(\\exists \\, i \\neq j : d_{\\text{alg}}(i,j) < r_{\\min}) \\leq k^2 \\cdot \\mathbb{P}(\\text{single pair collision})\n930: \n931: $$\n932: \n933: Setting $r_{\\min} = \\varepsilon_d$ (the distance regularization scale) and using QSD stationarity (typical separation $\\sim k^{-1/2d}$ from random packing):\n934: \n935: $$\n936: \\mathbb{P}(\\text{collision}) \\leq C k^2 \\cdot e^{-c k^{1/d}}\n937: \n938: $$\n939: \n940: For $d \\geq 2$, this is super-polynomial in $k$.\n941: \n942: **Step 3: Cloning enhances separation.**\n943: \n944: The cloning operator preferentially removes low-fitness walkers, which tend to be closer to existing walkers (lower algorithmic diversity). This **enhances** the minimum separation beyond what pure Langevin dynamics provides. By {prf:ref}`doc-03-cloning` Theorem 5.2 (Diversity Maintenance Principle), cloning ensures:\n945: \n946: $$\n947: \\mathbb{E}[\\min_{i \\neq j} d_{\\text{alg}}(i,j)] \\geq C_{\\text{clone}} \\cdot \\varepsilon_c\n948: \n949: $$\n950: \n951: Combined with diffusion, this yields exponential concentration:\n952: \n953: $$\n954: \\mathbb{P}(\\min d_{\\text{alg}} < r_{\\min}) \\leq C_{\\text{sep}} e^{-c_{\\text{sep}} k}\n955: \n956: $$",
      "metadata": {
        "label": "proof-lem-high-prob-min-separation-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "901: :::\n902: \n903: :::{prf:proof}\n904: :label: proof-lem-high-prob-min-separation-full\n905: \n906: **Step 1: Collision probability for Brownian particles.**\n907: \n908: Consider two walkers $i, j$ undergoing independent Langevin dynamics in phase space. The relative position $X_t = x_i(t) - x_j(t)$ satisfies:\n909: \n910: $$\n911: dX_t = (v_i - v_j) dt, \\quad dv_i = -\\gamma v_i dt + \\sqrt{2\\gamma T} dW_i\n912: \n913: $$\n914: \n915: with independent Brownian motions $W_i, W_j$. The probability that $\\|X_t\\| < r$ for some $t \\in [0, \\tau]$ (collision within time $\\tau$) satisfies the heat kernel bound:\n916: \n917: $$\n918: \\mathbb{P}(\\|X_t\\| < r \\text{ for some } t \\leq \\tau) \\leq C \\cdot \\frac{r^d}{\\sqrt{D\\tau}} \\cdot \\exp\\left(-\\frac{\\|X_0\\|^2}{4D\\tau}\\right)\n919: \n920: $$\n921: \n922: where $D = T/\\gamma$ is the effective diffusion constant.\n923: \n924: **Step 2: Union bound over all pairs.**\n925: \n926: There are $\\binom{k}{2} = O(k^2)$ walker pairs. By union bound:\n927: \n928: $$\n929: \\mathbb{P}(\\exists \\, i \\neq j : d_{\\text{alg}}(i,j) < r_{\\min}) \\leq k^2 \\cdot \\mathbb{P}(\\text{single pair collision})\n930: \n931: $$\n932: \n933: Setting $r_{\\min} = \\varepsilon_d$ (the distance regularization scale) and using QSD stationarity (typical separation $\\sim k^{-1/2d}$ from random packing):\n934: \n935: $$\n936: \\mathbb{P}(\\text{collision}) \\leq C k^2 \\cdot e^{-c k^{1/d}}\n937: \n938: $$\n939: \n940: For $d \\geq 2$, this is super-polynomial in $k$.\n941: \n942: **Step 3: Cloning enhances separation.**\n943: \n944: The cloning operator preferentially removes low-fitness walkers, which tend to be closer to existing walkers (lower algorithmic diversity). This **enhances** the minimum separation beyond what pure Langevin dynamics provides. By {prf:ref}`doc-03-cloning` Theorem 5.2 (Diversity Maintenance Principle), cloning ensures:\n945: \n946: $$\n947: \\mathbb{E}[\\min_{i \\neq j} d_{\\text{alg}}(i,j)] \\geq C_{\\text{clone}} \\cdot \\varepsilon_c\n948: \n949: $$\n950: \n951: Combined with diffusion, this yields exponential concentration:\n952: \n953: $$\n954: \\mathbb{P}(\\min d_{\\text{alg}} < r_{\\min}) \\leq C_{\\text{sep}} e^{-c_{\\text{sep}} k}\n955: \n956: $$\n957: "
    },
    {
      "directive_type": "lemma",
      "label": "lem-sum-to-integral-bound-full",
      "title": "Sum-to-Integral Bound with Exponential Weights",
      "start_line": 971,
      "end_line": 993,
      "header_lines": [
        972
      ],
      "content_start": 974,
      "content_end": 992,
      "content": "974: :label: lem-sum-to-integral-bound-full\n975: \n976: Under {prf:ref}`assump-uniform-density-full`, for any walker $i \\in \\mathcal{A}$ and any function $f : \\mathcal{X} \\times \\mathbb{R}^d \\to \\mathbb{R}$ with $|f| \\leq M$:\n977: \n978: $$\n979: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n980: \\leq \\rho_{\\max} \\cdot M \\cdot \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,y)}{2\\varepsilon_c^2}\\right) dy\\,du\n981: \n982: $$\n983: \n984: **Key consequence for Gaussian integrals**: When $f \\equiv 1$:\n985: \n986: $$\n987: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n988: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n989: \n990: $$\n991: \n992: where $C_{\\lambda} = (1 + \\lambda_{\\text{alg}})^{d/2}$ accounts for the velocity component in $d_{\\text{alg}}$.",
      "metadata": {
        "label": "lem-sum-to-integral-bound-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "971: The following lemma makes the sum-to-integral approximation **explicit**.\n972: \n973: :::{prf:lemma} Sum-to-Integral Bound with Exponential Weights\n974: :label: lem-sum-to-integral-bound-full\n975: \n976: Under {prf:ref}`assump-uniform-density-full`, for any walker $i \\in \\mathcal{A}$ and any function $f : \\mathcal{X} \\times \\mathbb{R}^d \\to \\mathbb{R}$ with $|f| \\leq M$:\n977: \n978: $$\n979: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n980: \\leq \\rho_{\\max} \\cdot M \\cdot \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,y)}{2\\varepsilon_c^2}\\right) dy\\,du\n981: \n982: $$\n983: \n984: **Key consequence for Gaussian integrals**: When $f \\equiv 1$:\n985: \n986: $$\n987: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n988: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n989: \n990: $$\n991: \n992: where $C_{\\lambda} = (1 + \\lambda_{\\text{alg}})^{d/2}$ accounts for the velocity component in $d_{\\text{alg}}$.\n993: "
    },
    {
      "directive_type": "proof",
      "label": "proof-lem-sum-to-integral-bound-full",
      "title": null,
      "start_line": 995,
      "end_line": 1070,
      "header_lines": [
        996
      ],
      "content_start": 998,
      "content_end": 1069,
      "content": "998: :label: proof-lem-sum-to-integral-bound-full\n999: \n1000: **Step 1: High-probability packing bound.**\n1001: \n1002: By {prf:ref}`lem-high-prob-min-separation-full`, with probability $\\geq 1 - \\delta$ (where $\\delta = C_{\\text{sep}} e^{-c_{\\text{sep}} k}$), all walker pairs satisfy $d_{\\text{alg}}(i,j) \\geq r_{\\min}$. On this high-probability set, we have a **packing bound**: for any measurable set $S \\subset \\mathcal{X} \\times \\mathbb{R}^d$,\n1003: \n1004: $$\n1005: \\#\\{j \\in \\mathcal{A} : (x_j, v_j) \\in S\\} \\leq \\frac{\\text{Vol}(S)}{V_{\\text{excl}}(r_{\\min})}\n1006: \n1007: $$\n1008: \n1009: where $V_{\\text{excl}}(r_{\\min}) = C_{\\text{vol}} r_{\\min}^{2d}$ is the volume of an exclusion ball.\n1010: \n1011: By {prf:ref}`assump-uniform-density-full`, the QSD density satisfies $\\rho_{\\text{phase}}^{\\text{QSD}}(x,v) \\leq \\rho_{\\max}$. The packing and density bounds together give:\n1012: \n1013: $$\n1014: \\mathbb{E}[\\#\\{j \\in \\mathcal{A} : (x_j, v_j) \\in S\\}] \\leq \\rho_{\\max} \\cdot \\text{Vol}(S) + \\delta \\cdot k\n1015: \n1016: $$\n1017: \n1018: For $k$ sufficiently large (e.g., $k \\geq 20$), the error term $\\delta \\cdot k = k \\cdot C_{\\text{sep}} e^{-c_{\\text{sep}} k} = o(1)$ is negligible. Therefore:\n1019: \n1020: $$\n1021: \\#\\{j \\in \\mathcal{A} : (x_j, v_j) \\in S\\} \\leq \\rho_{\\max} \\cdot \\text{Vol}(S) \\cdot (1 + o(1))\n1022: \n1023: $$\n1024: \n1025: with probability $1 - o(e^{-k})$. **For the remainder of the proof, we work on the high-probability set where minimum separation holds.**\n1026: \n1027: **Step 2: Upper bound via integral.**\n1028: \n1029: For any non-negative weight function $w(y, u)$ and $|f| \\leq M$:\n1030: \n1031: $$\n1032: \\begin{aligned}\n1033: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\, w(x_j, v_j)\n1034: &\\leq M \\sum_{j \\in \\mathcal{A}} w(x_j, v_j) \\\\\n1035: &\\leq M \\cdot \\rho_{\\max} \\int_{\\mathcal{X} \\times \\mathbb{R}^d} w(y, u) \\, dy \\, du\n1036: \\end{aligned}\n1037: \n1038: $$\n1039: \n1040: **Step 3: Gaussian weight evaluation.**\n1041: \n1042: For the exponential weight $w(y,u) = \\exp(-d_{\\text{alg}}^2(i,(y,u))/(2\\varepsilon_c^2))$:\n1043: \n1044: $$\n1045: \\begin{aligned}\n1046: \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{\\|y - x_i\\|^2 + \\lambda_{\\text{alg}} \\|u - v_i\\|^2 + \\varepsilon_d^2}{2\\varepsilon_c^2}\\right) dy\\,du\n1047: &\\leq \\exp\\left(-\\frac{\\varepsilon_d^2}{2\\varepsilon_c^2}\\right) \\int_{\\mathbb{R}^{2d}} \\exp\\left(-\\frac{\\|y\\|^2 + \\lambda_{\\text{alg}} \\|u\\|^2}{2\\varepsilon_c^2}\\right) dy\\,du \\\\\n1048: &= (2\\pi\\varepsilon_c^2)^d \\cdot \\lambda_{\\text{alg}}^{-d/2} \\cdot \\exp\\left(-\\frac{\\varepsilon_d^2}{2\\varepsilon_c^2}\\right)\n1049: \\end{aligned}\n1050: \n1051: $$\n1052: \n1053: (using Gaussian integral formula in $2d$ dimensions with rescaling).\n1054: \n1055: **Step 4: k-uniformity.**\n1056: \n1057: The bound:\n1058: \n1059: $$\n1060: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1061: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n1062: \n1063: $$\n1064: \n1065: depends only on:\n1066: - $\\rho_{\\max}$ (framework assumption)\n1067: - $\\varepsilon_c$ (algorithmic parameter)\n1068: - $d$ (dimension)\n1069: - $\\lambda_{\\text{alg}}$ (distance metric parameter)",
      "metadata": {
        "label": "proof-lem-sum-to-integral-bound-full"
      },
      "section": "## 2. Companion Selection Mechanisms: Framework Context",
      "raw_directive": "995: :::\n996: \n997: :::{prf:proof}\n998: :label: proof-lem-sum-to-integral-bound-full\n999: \n1000: **Step 1: High-probability packing bound.**\n1001: \n1002: By {prf:ref}`lem-high-prob-min-separation-full`, with probability $\\geq 1 - \\delta$ (where $\\delta = C_{\\text{sep}} e^{-c_{\\text{sep}} k}$), all walker pairs satisfy $d_{\\text{alg}}(i,j) \\geq r_{\\min}$. On this high-probability set, we have a **packing bound**: for any measurable set $S \\subset \\mathcal{X} \\times \\mathbb{R}^d$,\n1003: \n1004: $$\n1005: \\#\\{j \\in \\mathcal{A} : (x_j, v_j) \\in S\\} \\leq \\frac{\\text{Vol}(S)}{V_{\\text{excl}}(r_{\\min})}\n1006: \n1007: $$\n1008: \n1009: where $V_{\\text{excl}}(r_{\\min}) = C_{\\text{vol}} r_{\\min}^{2d}$ is the volume of an exclusion ball.\n1010: \n1011: By {prf:ref}`assump-uniform-density-full`, the QSD density satisfies $\\rho_{\\text{phase}}^{\\text{QSD}}(x,v) \\leq \\rho_{\\max}$. The packing and density bounds together give:\n1012: \n1013: $$\n1014: \\mathbb{E}[\\#\\{j \\in \\mathcal{A} : (x_j, v_j) \\in S\\}] \\leq \\rho_{\\max} \\cdot \\text{Vol}(S) + \\delta \\cdot k\n1015: \n1016: $$\n1017: \n1018: For $k$ sufficiently large (e.g., $k \\geq 20$), the error term $\\delta \\cdot k = k \\cdot C_{\\text{sep}} e^{-c_{\\text{sep}} k} = o(1)$ is negligible. Therefore:\n1019: \n1020: $$\n1021: \\#\\{j \\in \\mathcal{A} : (x_j, v_j) \\in S\\} \\leq \\rho_{\\max} \\cdot \\text{Vol}(S) \\cdot (1 + o(1))\n1022: \n1023: $$\n1024: \n1025: with probability $1 - o(e^{-k})$. **For the remainder of the proof, we work on the high-probability set where minimum separation holds.**\n1026: \n1027: **Step 2: Upper bound via integral.**\n1028: \n1029: For any non-negative weight function $w(y, u)$ and $|f| \\leq M$:\n1030: \n1031: $$\n1032: \\begin{aligned}\n1033: \\sum_{j \\in \\mathcal{A}} f(x_j, v_j) \\, w(x_j, v_j)\n1034: &\\leq M \\sum_{j \\in \\mathcal{A}} w(x_j, v_j) \\\\\n1035: &\\leq M \\cdot \\rho_{\\max} \\int_{\\mathcal{X} \\times \\mathbb{R}^d} w(y, u) \\, dy \\, du\n1036: \\end{aligned}\n1037: \n1038: $$\n1039: \n1040: **Step 3: Gaussian weight evaluation.**\n1041: \n1042: For the exponential weight $w(y,u) = \\exp(-d_{\\text{alg}}^2(i,(y,u))/(2\\varepsilon_c^2))$:\n1043: \n1044: $$\n1045: \\begin{aligned}\n1046: \\int_{\\mathcal{X} \\times \\mathbb{R}^d} \\exp\\left(-\\frac{\\|y - x_i\\|^2 + \\lambda_{\\text{alg}} \\|u - v_i\\|^2 + \\varepsilon_d^2}{2\\varepsilon_c^2}\\right) dy\\,du\n1047: &\\leq \\exp\\left(-\\frac{\\varepsilon_d^2}{2\\varepsilon_c^2}\\right) \\int_{\\mathbb{R}^{2d}} \\exp\\left(-\\frac{\\|y\\|^2 + \\lambda_{\\text{alg}} \\|u\\|^2}{2\\varepsilon_c^2}\\right) dy\\,du \\\\\n1048: &= (2\\pi\\varepsilon_c^2)^d \\cdot \\lambda_{\\text{alg}}^{-d/2} \\cdot \\exp\\left(-\\frac{\\varepsilon_d^2}{2\\varepsilon_c^2}\\right)\n1049: \\end{aligned}\n1050: \n1051: $$\n1052: \n1053: (using Gaussian integral formula in $2d$ dimensions with rescaling).\n1054: \n1055: **Step 4: k-uniformity.**\n1056: \n1057: The bound:\n1058: \n1059: $$\n1060: \\sum_{j \\in \\mathcal{A}} \\exp\\left(-\\frac{d_{\\text{alg}}^2(i,j)}{2\\varepsilon_c^2}\\right)\n1061: \\leq \\rho_{\\max} \\cdot (2\\pi\\varepsilon_c^2)^d \\cdot C_{\\lambda}\n1062: \n1063: $$\n1064: \n1065: depends only on:\n1066: - $\\rho_{\\max}$ (framework assumption)\n1067: - $\\varepsilon_c$ (algorithmic parameter)\n1068: - $d$ (dimension)\n1069: - $\\lambda_{\\text{alg}}$ (distance metric parameter)\n1070: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}