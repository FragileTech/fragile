{
  "chapter_index": 5,
  "section_id": "## 5. Anisotropic Kinetic Operator Analysis",
  "directive_count": 16,
  "hints": [
    {
      "directive_type": "lemma",
      "label": "lem-ito-correction-bound",
      "title": "It\u00f4 Correction Term Bound",
      "start_line": 943,
      "end_line": 965,
      "header_lines": [
        944
      ],
      "content_start": 946,
      "content_end": 964,
      "content": "946: :label: lem-ito-correction-bound\n947: \n948: For the kinetic SDE with adaptive diffusion (Definition [](#def-d-kinetic-operator-adaptive)), the It\u00f4 correction term in the drift is:\n949: \n950: $$\n951: b_{\\text{correction}}(x, v, S) = \\frac{1}{2}\\sum_{j=1}^d \\left( D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S) \\right) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\n952: $$\n953: \n954: where $\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ is the $j$-th column of $\\Sigma_{\\text{reg}}$ and $D_x$ is the Jacobian with respect to $x$.\n955: \n956: This term satisfies the bound:\n957: \n958: $$\n959: \\|b_{\\text{correction}}(x, v, S)\\| \\le C_{\\text{It\u00f4}} := \\frac{1}{2} d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n960: $$\n961: \n962: where:\n963: - $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is the supremum of the operator norm of the Jacobian of $\\Sigma_{\\text{reg}}$ over the state space\n964: - $c_{\\max}^{1/2} = 1/\\sqrt{\\epsilon_\\Sigma}$ is the upper bound on $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}}$",
      "metadata": {
        "label": "lem-ito-correction-bound"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "943: Before proving the drift inequalities, we must analyze the **It\u00f4 correction term** that arises from the state-dependent diffusion tensor.\n944: \n945: :::{prf:lemma} It\u00f4 Correction Term Bound\n946: :label: lem-ito-correction-bound\n947: \n948: For the kinetic SDE with adaptive diffusion (Definition [](#def-d-kinetic-operator-adaptive)), the It\u00f4 correction term in the drift is:\n949: \n950: $$\n951: b_{\\text{correction}}(x, v, S) = \\frac{1}{2}\\sum_{j=1}^d \\left( D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S) \\right) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\n952: $$\n953: \n954: where $\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ is the $j$-th column of $\\Sigma_{\\text{reg}}$ and $D_x$ is the Jacobian with respect to $x$.\n955: \n956: This term satisfies the bound:\n957: \n958: $$\n959: \\|b_{\\text{correction}}(x, v, S)\\| \\le C_{\\text{It\u00f4}} := \\frac{1}{2} d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n960: $$\n961: \n962: where:\n963: - $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is the supremum of the operator norm of the Jacobian of $\\Sigma_{\\text{reg}}$ over the state space\n964: - $c_{\\max}^{1/2} = 1/\\sqrt{\\epsilon_\\Sigma}$ is the upper bound on $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}}$\n965: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-31",
      "title": null,
      "start_line": 967,
      "end_line": 1009,
      "header_lines": [],
      "content_start": 968,
      "content_end": 1008,
      "content": "968: \n969: :::{prf:proof}\n970: **Step 1: Structure of the correction term**\n971: \n972: By definition of the Stratonovich-to-It\u00f4 conversion for the SDE $dv = \\ldots + \\Sigma_{\\text{reg}}(x,S) \\circ dW$, the correction is:\n973: \n974: $$\n975: b_{\\text{correction}} = \\frac{1}{2}\\sum_{j=1}^d (D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}) \\Sigma_{\\text{reg}}^{(\\cdot,j)}\n976: $$\n977: \n978: **Step 2: Bound on each term**\n979: \n980: For each $j \\in \\{1,\\ldots,d\\}$:\n981: \n982: $$\n983: \\|(D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\| \\le \\|D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|_{\\text{op}} \\cdot \\|\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|\n984: $$\n985: \n986: The Jacobian operator norm is bounded by $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$, and the column norm is bounded by $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}} \\le c_{\\max}^{1/2}$ (from uniform ellipticity).\n987: \n988: **Step 3: Sum over dimensions**\n989: \n990: $$\n991: \\|b_{\\text{correction}}\\| \\le \\sum_{j=1}^d \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2} \\le d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n992: $$\n993: \n994: Multiplying by $1/2$ gives the claimed bound.\n995: \n996: **Step 4: N-uniformity**\n997: \n998: The diffusion tensor $\\Sigma_{\\text{reg}}(x_i, S)$ depends on:\n999: 1. The walker's own position $x_i$\n1000: 2. The Hessian $H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$\n1001: \n1002: For typical fitness potentials (e.g., $V_{\\text{fit}}(S) = \\frac{1}{N}\\sum_{i,j} V_{\\text{pair}}(x_i, x_j)$), the Hessian has the structure:\n1003: \n1004: $$\n1005: H_i(S) = \\frac{1}{N} \\sum_{j \\neq i} \\nabla^2 V_{\\text{pair}}(x_i, x_j)\n1006: $$\n1007: \n1008: The gradient of $\\Sigma_{\\text{reg}}$ with respect to $x_i$ involves third derivatives of $V_{\\text{pair}}$, averaged over $N$ pairs. The $1/N$ normalization in $V_{\\text{fit}}$ ensures that $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is **independent of $N$**.",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "967: :::\n968: \n969: :::{prf:proof}\n970: **Step 1: Structure of the correction term**\n971: \n972: By definition of the Stratonovich-to-It\u00f4 conversion for the SDE $dv = \\ldots + \\Sigma_{\\text{reg}}(x,S) \\circ dW$, the correction is:\n973: \n974: $$\n975: b_{\\text{correction}} = \\frac{1}{2}\\sum_{j=1}^d (D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}) \\Sigma_{\\text{reg}}^{(\\cdot,j)}\n976: $$\n977: \n978: **Step 2: Bound on each term**\n979: \n980: For each $j \\in \\{1,\\ldots,d\\}$:\n981: \n982: $$\n983: \\|(D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\| \\le \\|D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|_{\\text{op}} \\cdot \\|\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|\n984: $$\n985: \n986: The Jacobian operator norm is bounded by $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$, and the column norm is bounded by $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}} \\le c_{\\max}^{1/2}$ (from uniform ellipticity).\n987: \n988: **Step 3: Sum over dimensions**\n989: \n990: $$\n991: \\|b_{\\text{correction}}\\| \\le \\sum_{j=1}^d \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2} \\le d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n992: $$\n993: \n994: Multiplying by $1/2$ gives the claimed bound.\n995: \n996: **Step 4: N-uniformity**\n997: \n998: The diffusion tensor $\\Sigma_{\\text{reg}}(x_i, S)$ depends on:\n999: 1. The walker's own position $x_i$\n1000: 2. The Hessian $H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$\n1001: \n1002: For typical fitness potentials (e.g., $V_{\\text{fit}}(S) = \\frac{1}{N}\\sum_{i,j} V_{\\text{pair}}(x_i, x_j)$), the Hessian has the structure:\n1003: \n1004: $$\n1005: H_i(S) = \\frac{1}{N} \\sum_{j \\neq i} \\nabla^2 V_{\\text{pair}}(x_i, x_j)\n1006: $$\n1007: \n1008: The gradient of $\\Sigma_{\\text{reg}}$ with respect to $x_i$ involves third derivatives of $V_{\\text{pair}}$, averaged over $N$ pairs. The $1/N$ normalization in $V_{\\text{fit}}$ ensures that $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is **independent of $N$**.\n1009: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-velocity-variance-anisotropic",
      "title": "Velocity Variance Contraction (Anisotropic)",
      "start_line": 1028,
      "end_line": 1049,
      "header_lines": [
        1029
      ],
      "content_start": 1031,
      "content_end": 1048,
      "content": "1031: :label: thm-velocity-variance-anisotropic\n1032: \n1033: For the kinetic operator with adaptive diffusion, the velocity variance difference satisfies:\n1034: \n1035: $$\n1036: \\mathbb{E}[V_{\\text{Var},v}(S'_1, S'_2) \\mid S_1, S_2] \\le V_{\\text{Var},v}(S_1, S_2) + \\tau \\left[ -2\\gamma V_{\\text{Var},v}(S_1, S_2) + C'_v \\right]\n1037: $$\n1038: \n1039: where:\n1040: - $\\gamma > 0$ is the friction coefficient\n1041: - $C'_v = O(c_{\\max} d)$ depends on the upper diffusion bound (independent of $N$)\n1042: - Both constants are **N-uniform** (independent of swarm size and current state)\n1043: \n1044: Rearranging:\n1045: \n1046: $$\n1047: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\le -\\kappa'_v \\tau V_{\\text{Var},v} + C'_v \\tau\n1048: $$",
      "metadata": {
        "label": "thm-velocity-variance-anisotropic"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1028: The first result is straightforward: friction dissipates velocity variance even with anisotropic noise.\n1029: \n1030: :::{prf:theorem} Velocity Variance Contraction (Anisotropic)\n1031: :label: thm-velocity-variance-anisotropic\n1032: \n1033: For the kinetic operator with adaptive diffusion, the velocity variance difference satisfies:\n1034: \n1035: $$\n1036: \\mathbb{E}[V_{\\text{Var},v}(S'_1, S'_2) \\mid S_1, S_2] \\le V_{\\text{Var},v}(S_1, S_2) + \\tau \\left[ -2\\gamma V_{\\text{Var},v}(S_1, S_2) + C'_v \\right]\n1037: $$\n1038: \n1039: where:\n1040: - $\\gamma > 0$ is the friction coefficient\n1041: - $C'_v = O(c_{\\max} d)$ depends on the upper diffusion bound (independent of $N$)\n1042: - Both constants are **N-uniform** (independent of swarm size and current state)\n1043: \n1044: Rearranging:\n1045: \n1046: $$\n1047: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\le -\\kappa'_v \\tau V_{\\text{Var},v} + C'_v \\tau\n1048: $$\n1049: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-115",
      "title": null,
      "start_line": 1051,
      "end_line": 1200,
      "header_lines": [],
      "content_start": 1052,
      "content_end": 1199,
      "content": "1052: \n1053: :::{prf:proof}\n1054: We analyze the generator $\\mathcal{L}$ acting on the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$ where:\n1055: \n1056: $$\n1057: V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i: s_{k,i}=1} \\|v_{k,i} - \\bar{v}_k\\|^2\n1058: $$\n1059: \n1060: (normalized by total swarm size $N$, consistent with position variance)\n1061: \n1062: **Step 1: Generator for a Single Swarm**\n1063: \n1064: For swarm $S_k$ evolving under the kinetic SDE (Stratonovich form):\n1065: \n1066: $$\n1067: \\begin{aligned}\n1068: dx_{k,i} &= v_{k,i} \\, dt \\\\\n1069: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n1070: \\end{aligned}\n1071: $$\n1072: \n1073: The infinitesimal generator acts on the variance as:\n1074: \n1075: $$\n1076: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|v_{k,i} - \\bar{v}_k\\|^2 \\right]\n1077: $$\n1078: \n1079: where $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers and $N$ is the total (fixed) swarm size.\n1080: \n1081: **Step 2: Apply Generator to Centered Velocities**\n1082: \n1083: For each walker $i \\in A_k$, let $\\tilde{v}_{k,i} = v_{k,i} - \\bar{v}_k$. The generator acting on $f_i = \\|\\tilde{v}_{k,i}\\|^2$ with the **It\u00f4 drift** (including the correction term from Lemma [](#lem-ito-correction-bound)) is:\n1084: \n1085: $$\n1086: \\mathcal{L} f_i = 2 \\langle \\tilde{v}_{k,i}, [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\rangle + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k))\n1087: $$\n1088: \n1089: where we used $\\nabla f_i = 2\\tilde{v}_{k,i}$ and $\\nabla^2 f_i = 2I_d$.\n1090: \n1091: **Step 3: Analyze Drift Term**\n1092: \n1093: $$\n1094: \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\langle v_{k,i} - \\bar{v}_k, v_{k,i} \\rangle = -\\gamma \\|v_{k,i}\\|^2 + \\gamma \\langle \\bar{v}_k, v_{k,i} \\rangle\n1095: $$\n1096: \n1097: When we sum over all walkers: $\\sum_{i \\in A_k} \\langle \\bar{v}_k, v_{k,i} \\rangle = N_k \\|\\bar{v}_k\\|^2$ (by definition of $\\bar{v}_k$).\n1098: \n1099: Also: $\\sum_{i \\in A_k} \\|v_{k,i}\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i} + \\bar{v}_k\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 + N_k \\|\\bar{v}_k\\|^2$.\n1100: \n1101: Therefore:\n1102: \n1103: $$\n1104: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 = -\\gamma N \\cdot V_{\\text{Var},v}(S_k)\n1105: $$\n1106: \n1107: where we used the definition $V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2$.\n1108: \n1109: The force term $\\sum_i \\langle \\tilde{v}_{k,i}, F(x_{k,i}) \\rangle$ is bounded by Cauchy-Schwarz: $|\\langle \\tilde{v}, F \\rangle| \\le \\|F\\|_{\\infty} \\sqrt{N \\cdot V_{\\text{Var},v}}$, which can be absorbed into the friction by Young's inequality for sufficiently large $\\gamma$.\n1110: \n1111: **It\u00f4 correction contribution**: By Lemma [](#lem-ito-correction-bound), $\\|b_{\\text{correction}}\\| \\le C_{\\text{It\u00f4}}$, so:\n1112: \n1113: $$\n1114: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k) \\rangle \\le N_k \\sqrt{V_{\\text{Var},v}} \\cdot C_{\\text{It\u00f4}}\n1115: $$\n1116: \n1117: This is bounded by $N C_{\\text{It\u00f4}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}$ (by Young's inequality with $\\epsilon = 1/(4\\gamma)$), which contributes to the additive constant and slightly modifies the friction rate.\n1118: \n1119: **Step 4: Analyze Diffusion Term (KEY: N-uniformity)**\n1120: \n1121: $$\n1122: \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) \\le \\sum_{i \\in A_k} c_{\\max} d = N_k \\cdot c_{\\max} d\n1123: $$\n1124: \n1125: **Step 5: Combine and Normalize**\n1126: \n1127: $$\n1128: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 \\right]\n1129: $$\n1130: \n1131: $$\n1132: = \\frac{1}{N} \\sum_{i \\in A_k} \\mathcal{L}[\\|\\tilde{v}_{k,i}\\|^2]\n1133: $$\n1134: \n1135: $$\n1136: = \\frac{1}{N} \\sum_{i \\in A_k} \\left[ -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}}) \\right]\n1137: $$\n1138: \n1139: From Step 3, $\\sum_{i \\in A_k} -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 = -2\\gamma N \\cdot V_{\\text{Var},v}(S_k)$, so:\n1140: \n1141: $$\n1142: = \\frac{1}{N} \\cdot (-2\\gamma N \\cdot V_{\\text{Var},v}(S_k)) + \\frac{1}{N} \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1143: $$\n1144: \n1145: $$\n1146: = -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1147: $$\n1148: \n1149: $$\n1150: \\le -2\\gamma V_{\\text{Var},v}(S_k) + c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1151: $$\n1152: \n1153: since $N_k \\le N$.\n1154: \n1155: **CRITICAL OBSERVATION**: With normalization by the total swarm size $N$, the diffusion term is bounded by $\\frac{N_k}{N} c_{\\max} d \\le c_{\\max} d$, which is **independent of both $N$ and $N_k$**. This establishes N-uniformity without requiring exact cancellation.\n1156: \n1157: **Step 6: Assemble Full Drift (Including It\u00f4 Correction)**\n1158: \n1159: Combining Steps 3-5, the full drift for $V_{\\text{Var},v}(S_k)$ is:\n1160: \n1161: $$\n1162: \\mathcal{L} V_{\\text{Var},v}(S_k) \\le -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + NC_{\\text{It\u00f4}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}(S_k) + O(\\|F\\|_\\infty)\n1163: $$\n1164: \n1165: Collecting the $V_{\\text{Var},v}$ terms:\n1166: \n1167: $$\n1168: \\le -(2\\gamma - \\frac{1}{4\\gamma}) V_{\\text{Var},v}(S_k) + c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)\n1169: $$\n1170: \n1171: For $\\gamma \\ge 1/2$, we have $2\\gamma - 1/(4\\gamma) \\ge \\gamma$. Define the effective friction rate:\n1172: \n1173: $$\n1174: \\kappa'_v := 2\\gamma - \\frac{1}{4\\gamma} \\ge \\gamma \\quad \\text{(for $\\gamma \\ge 1/2$)}\n1175: $$\n1176: \n1177: **Step 7: Coupled Sum**\n1178: \n1179: For the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$:\n1180: \n1181: $$\n1182: \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) \\le -\\kappa'_v V_{\\text{Var},v}(S_1, S_2) + 2[c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)]\n1183: $$\n1184: \n1185: **Step 8: Discrete-Time Conversion**\n1186: \n1187: By the discretization theorem (Theorem 1.7.2 from `../1_euclidean_gas/06_convergence.md`):\n1188: \n1189: $$\n1190: \\mathbb{E}[V_{\\text{Var},v}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{Var},v}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) + O(\\tau^2)\n1191: $$\n1192: \n1193: Setting $C'_v = 2[c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)]$ (independent of $N$ since $C_{\\text{It\u00f4}}$ is N-uniform):\n1194: \n1195: $$\n1196: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\le -\\kappa'_v \\tau V_{\\text{Var},v} + C'_v \\tau\n1197: $$\n1198: \n1199: where $\\kappa'_v = 2\\gamma - 1/(4\\gamma) \\ge \\gamma$ for $\\gamma \\ge 1/2$.",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1051: :::\n1052: \n1053: :::{prf:proof}\n1054: We analyze the generator $\\mathcal{L}$ acting on the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$ where:\n1055: \n1056: $$\n1057: V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i: s_{k,i}=1} \\|v_{k,i} - \\bar{v}_k\\|^2\n1058: $$\n1059: \n1060: (normalized by total swarm size $N$, consistent with position variance)\n1061: \n1062: **Step 1: Generator for a Single Swarm**\n1063: \n1064: For swarm $S_k$ evolving under the kinetic SDE (Stratonovich form):\n1065: \n1066: $$\n1067: \\begin{aligned}\n1068: dx_{k,i} &= v_{k,i} \\, dt \\\\\n1069: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n1070: \\end{aligned}\n1071: $$\n1072: \n1073: The infinitesimal generator acts on the variance as:\n1074: \n1075: $$\n1076: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|v_{k,i} - \\bar{v}_k\\|^2 \\right]\n1077: $$\n1078: \n1079: where $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers and $N$ is the total (fixed) swarm size.\n1080: \n1081: **Step 2: Apply Generator to Centered Velocities**\n1082: \n1083: For each walker $i \\in A_k$, let $\\tilde{v}_{k,i} = v_{k,i} - \\bar{v}_k$. The generator acting on $f_i = \\|\\tilde{v}_{k,i}\\|^2$ with the **It\u00f4 drift** (including the correction term from Lemma [](#lem-ito-correction-bound)) is:\n1084: \n1085: $$\n1086: \\mathcal{L} f_i = 2 \\langle \\tilde{v}_{k,i}, [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\rangle + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k))\n1087: $$\n1088: \n1089: where we used $\\nabla f_i = 2\\tilde{v}_{k,i}$ and $\\nabla^2 f_i = 2I_d$.\n1090: \n1091: **Step 3: Analyze Drift Term**\n1092: \n1093: $$\n1094: \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\langle v_{k,i} - \\bar{v}_k, v_{k,i} \\rangle = -\\gamma \\|v_{k,i}\\|^2 + \\gamma \\langle \\bar{v}_k, v_{k,i} \\rangle\n1095: $$\n1096: \n1097: When we sum over all walkers: $\\sum_{i \\in A_k} \\langle \\bar{v}_k, v_{k,i} \\rangle = N_k \\|\\bar{v}_k\\|^2$ (by definition of $\\bar{v}_k$).\n1098: \n1099: Also: $\\sum_{i \\in A_k} \\|v_{k,i}\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i} + \\bar{v}_k\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 + N_k \\|\\bar{v}_k\\|^2$.\n1100: \n1101: Therefore:\n1102: \n1103: $$\n1104: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 = -\\gamma N \\cdot V_{\\text{Var},v}(S_k)\n1105: $$\n1106: \n1107: where we used the definition $V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2$.\n1108: \n1109: The force term $\\sum_i \\langle \\tilde{v}_{k,i}, F(x_{k,i}) \\rangle$ is bounded by Cauchy-Schwarz: $|\\langle \\tilde{v}, F \\rangle| \\le \\|F\\|_{\\infty} \\sqrt{N \\cdot V_{\\text{Var},v}}$, which can be absorbed into the friction by Young's inequality for sufficiently large $\\gamma$.\n1110: \n1111: **It\u00f4 correction contribution**: By Lemma [](#lem-ito-correction-bound), $\\|b_{\\text{correction}}\\| \\le C_{\\text{It\u00f4}}$, so:\n1112: \n1113: $$\n1114: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k) \\rangle \\le N_k \\sqrt{V_{\\text{Var},v}} \\cdot C_{\\text{It\u00f4}}\n1115: $$\n1116: \n1117: This is bounded by $N C_{\\text{It\u00f4}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}$ (by Young's inequality with $\\epsilon = 1/(4\\gamma)$), which contributes to the additive constant and slightly modifies the friction rate.\n1118: \n1119: **Step 4: Analyze Diffusion Term (KEY: N-uniformity)**\n1120: \n1121: $$\n1122: \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) \\le \\sum_{i \\in A_k} c_{\\max} d = N_k \\cdot c_{\\max} d\n1123: $$\n1124: \n1125: **Step 5: Combine and Normalize**\n1126: \n1127: $$\n1128: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 \\right]\n1129: $$\n1130: \n1131: $$\n1132: = \\frac{1}{N} \\sum_{i \\in A_k} \\mathcal{L}[\\|\\tilde{v}_{k,i}\\|^2]\n1133: $$\n1134: \n1135: $$\n1136: = \\frac{1}{N} \\sum_{i \\in A_k} \\left[ -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}}) \\right]\n1137: $$\n1138: \n1139: From Step 3, $\\sum_{i \\in A_k} -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 = -2\\gamma N \\cdot V_{\\text{Var},v}(S_k)$, so:\n1140: \n1141: $$\n1142: = \\frac{1}{N} \\cdot (-2\\gamma N \\cdot V_{\\text{Var},v}(S_k)) + \\frac{1}{N} \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1143: $$\n1144: \n1145: $$\n1146: = -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1147: $$\n1148: \n1149: $$\n1150: \\le -2\\gamma V_{\\text{Var},v}(S_k) + c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1151: $$\n1152: \n1153: since $N_k \\le N$.\n1154: \n1155: **CRITICAL OBSERVATION**: With normalization by the total swarm size $N$, the diffusion term is bounded by $\\frac{N_k}{N} c_{\\max} d \\le c_{\\max} d$, which is **independent of both $N$ and $N_k$**. This establishes N-uniformity without requiring exact cancellation.\n1156: \n1157: **Step 6: Assemble Full Drift (Including It\u00f4 Correction)**\n1158: \n1159: Combining Steps 3-5, the full drift for $V_{\\text{Var},v}(S_k)$ is:\n1160: \n1161: $$\n1162: \\mathcal{L} V_{\\text{Var},v}(S_k) \\le -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + NC_{\\text{It\u00f4}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}(S_k) + O(\\|F\\|_\\infty)\n1163: $$\n1164: \n1165: Collecting the $V_{\\text{Var},v}$ terms:\n1166: \n1167: $$\n1168: \\le -(2\\gamma - \\frac{1}{4\\gamma}) V_{\\text{Var},v}(S_k) + c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)\n1169: $$\n1170: \n1171: For $\\gamma \\ge 1/2$, we have $2\\gamma - 1/(4\\gamma) \\ge \\gamma$. Define the effective friction rate:\n1172: \n1173: $$\n1174: \\kappa'_v := 2\\gamma - \\frac{1}{4\\gamma} \\ge \\gamma \\quad \\text{(for $\\gamma \\ge 1/2$)}\n1175: $$\n1176: \n1177: **Step 7: Coupled Sum**\n1178: \n1179: For the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$:\n1180: \n1181: $$\n1182: \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) \\le -\\kappa'_v V_{\\text{Var},v}(S_1, S_2) + 2[c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)]\n1183: $$\n1184: \n1185: **Step 8: Discrete-Time Conversion**\n1186: \n1187: By the discretization theorem (Theorem 1.7.2 from `../1_euclidean_gas/06_convergence.md`):\n1188: \n1189: $$\n1190: \\mathbb{E}[V_{\\text{Var},v}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{Var},v}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) + O(\\tau^2)\n1191: $$\n1192: \n1193: Setting $C'_v = 2[c_{\\max} d + NC_{\\text{It\u00f4}}^2 + O(\\|F\\|_\\infty)]$ (independent of $N$ since $C_{\\text{It\u00f4}}$ is N-uniform):\n1194: \n1195: $$\n1196: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\le -\\kappa'_v \\tau V_{\\text{Var},v} + C'_v \\tau\n1197: $$\n1198: \n1199: where $\\kappa'_v = 2\\gamma - 1/(4\\gamma) \\ge \\gamma$ for $\\gamma \\ge 1/2$.\n1200: "
    },
    {
      "directive_type": "definition",
      "label": "def-d-hypocoercive-norm",
      "title": "Hypocoercive Norm (from `../1_euclidean_gas/06_convergence.md`)",
      "start_line": 1220,
      "end_line": 1236,
      "header_lines": [
        1221
      ],
      "content_start": 1223,
      "content_end": 1235,
      "content": "1223: :label: def-d-hypocoercive-norm\n1224: \n1225: For phase-space differences $(\\Delta x, \\Delta v) \\in \\mathbb{R}^{2d}$, the **hypocoercive norm squared** is:\n1226: \n1227: $$\n1228: \\|(\\Delta x, \\Delta v)\\|_h^2 = \\|\\Delta x\\|^2 + \\lambda_v \\|\\Delta v\\|^2 + b \\langle \\Delta x, \\Delta v \\rangle\n1229: $$\n1230: \n1231: where:\n1232: - $\\lambda_v > 0$: Velocity weight (typically $\\lambda_v \\sim 1/\\gamma$)\n1233: - $b \\in \\mathbb{R}$: Coupling coefficient (chosen for optimal contraction)\n1234: \n1235: **Positive definiteness**: Requires $\\lambda_v > b^2/4$.",
      "metadata": {
        "label": "def-d-hypocoercive-norm"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1220: #### 3.2.1. The Hypocoercive Norm (Review)\n1221: \n1222: :::{prf:definition} Hypocoercive Norm (from `../1_euclidean_gas/06_convergence.md`)\n1223: :label: def-d-hypocoercive-norm\n1224: \n1225: For phase-space differences $(\\Delta x, \\Delta v) \\in \\mathbb{R}^{2d}$, the **hypocoercive norm squared** is:\n1226: \n1227: $$\n1228: \\|(\\Delta x, \\Delta v)\\|_h^2 = \\|\\Delta x\\|^2 + \\lambda_v \\|\\Delta v\\|^2 + b \\langle \\Delta x, \\Delta v \\rangle\n1229: $$\n1230: \n1231: where:\n1232: - $\\lambda_v > 0$: Velocity weight (typically $\\lambda_v \\sim 1/\\gamma$)\n1233: - $b \\in \\mathbb{R}$: Coupling coefficient (chosen for optimal contraction)\n1234: \n1235: **Positive definiteness**: Requires $\\lambda_v > b^2/4$.\n1236: "
    },
    {
      "directive_type": "remark",
      "label": "rem-coupling-essential",
      "title": "Why Coupling is Essential",
      "start_line": 1238,
      "end_line": 1248,
      "header_lines": [
        1239
      ],
      "content_start": 1241,
      "content_end": 1247,
      "content": "1241: :label: rem-coupling-essential\n1242: \n1243: The cross term $b \\langle \\Delta x, \\Delta v \\rangle$ is **crucial for hypocoercivity**:\n1244: \n1245: - **Without coupling** ($b = 0$): Position and velocity errors are independent. Since noise acts only on $v$, the position error $\\|\\Delta x\\|^2$ has **no direct dissipation**.\n1246: \n1247: - **With coupling** ($b \\neq 0$): The position error is \"rotated\" into the velocity space via the coupling. The velocity noise then dissipates the rotated error, which propagates back to positions via $\\dot{x} = v$.",
      "metadata": {
        "label": "rem-coupling-essential"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1238: :::\n1239: \n1240: :::{prf:remark} Why Coupling is Essential\n1241: :label: rem-coupling-essential\n1242: \n1243: The cross term $b \\langle \\Delta x, \\Delta v \\rangle$ is **crucial for hypocoercivity**:\n1244: \n1245: - **Without coupling** ($b = 0$): Position and velocity errors are independent. Since noise acts only on $v$, the position error $\\|\\Delta x\\|^2$ has **no direct dissipation**.\n1246: \n1247: - **With coupling** ($b \\neq 0$): The position error is \"rotated\" into the velocity space via the coupling. The velocity noise then dissipates the rotated error, which propagates back to positions via $\\dot{x} = v$.\n1248: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-location-error-anisotropic",
      "title": "Location Error Contraction (Anisotropic)",
      "start_line": 1280,
      "end_line": 1293,
      "header_lines": [
        1281
      ],
      "content_start": 1283,
      "content_end": 1292,
      "content": "1283: :label: thm-location-error-anisotropic\n1284: \n1285: The location error $V_{\\text{loc}}(S_1, S_2) = \\|(\\Delta \\mu_x, \\Delta \\mu_v)\\|_h^2$ satisfies:\n1286: \n1287: $$\n1288: \\mathbb{E}[\\Delta V_{\\text{loc}}] \\le -\\kappa_{\\text{loc}} \\tau V_{\\text{loc}} + C_{\\text{loc}} \\tau\n1289: $$\n1290: \n1291: where:\n1292: - $\\kappa_{\\text{loc}} = O(\\min\\{\\gamma, c_{\\min}\\}) > 0$ is the hypocoercive contraction rate",
      "metadata": {
        "label": "thm-location-error-anisotropic"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1280: #### 3.2.3. Location Error Drift (Anisotropic Case)\n1281: \n1282: :::{prf:theorem} Location Error Contraction (Anisotropic)\n1283: :label: thm-location-error-anisotropic\n1284: \n1285: The location error $V_{\\text{loc}}(S_1, S_2) = \\|(\\Delta \\mu_x, \\Delta \\mu_v)\\|_h^2$ satisfies:\n1286: \n1287: $$\n1288: \\mathbb{E}[\\Delta V_{\\text{loc}}] \\le -\\kappa_{\\text{loc}} \\tau V_{\\text{loc}} + C_{\\text{loc}} \\tau\n1289: $$\n1290: \n1291: where:\n1292: - $\\kappa_{\\text{loc}} = O(\\min\\{\\gamma, c_{\\min}\\}) > 0$ is the hypocoercive contraction rate\n1293: - $C_{\\text{loc}} = O(c_{\\max}^2 + n_{\\text{status}})$ is the expansion from noise and status changes"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-359",
      "title": null,
      "start_line": 1295,
      "end_line": 1550,
      "header_lines": [],
      "content_start": 1296,
      "content_end": 1549,
      "content": "1296: \n1297: :::{prf:proof}\n1298: This proof provides a complete, self-contained drift matrix analysis for the anisotropic case.\n1299: \n1300: **Preliminaries: The Infinitesimal Generator**\n1301: \n1302: For the coupled $2N$-particle kinetic process, the infinitesimal generator is:\n1303: \n1304: $$\n1305: \\mathcal{L} = \\sum_{k=1,2} \\sum_{i \\in A_k} \\left[ v_{k,i} \\cdot \\nabla_{x_{k,i}} + [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\cdot \\nabla_{v_{k,i}} + \\frac{1}{2} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k) \\nabla^2_{v_{k,i}}) \\right]\n1306: $$\n1307: \n1308: where:\n1309: - $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers in swarm $k$\n1310: - $D_{\\text{reg}}(x_{k,i}, S_k) = \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\Sigma_{\\text{reg}}(x_{k,i}, S_k)^T$ is the diffusion matrix\n1311: - $b_{\\text{correction}}$ is the It\u00f4 correction term from Lemma [](#lem-ito-correction-bound)\n1312: - $\\nabla_{x_{k,i}}, \\nabla_{v_{k,i}}$ are gradients with respect to walker $i$ in swarm $k$\n1313: - $\\nabla^2_{v_{k,i}}$ is the Hessian with respect to velocity (note: no diffusion in position)\n1314: \n1315: We apply this generator to the location error $V_{\\text{loc}}(S_1, S_2) = z^T Q z$ where $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T$ is the barycenter difference.\n1316: \n1317: **Step 1: State Vector and Dynamics**\n1318: \n1319: Define the barycenter difference vector $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T \\in \\mathbb{R}^{2d}$ where:\n1320: \n1321: $$\n1322: \\Delta \\mu_x = \\bar{x}_1 - \\bar{x}_2, \\quad \\Delta \\mu_v = \\bar{v}_1 - \\bar{v}_2\n1323: $$\n1324: \n1325: For swarm $k$, the barycenters evolve as (Stratonovich form):\n1326: \n1327: $$\n1328: d\\bar{x}_k = \\bar{v}_k \\, dt\n1329: $$\n1330: \n1331: $$\n1332: d\\bar{v}_k = \\left[ \\bar{F}_k - \\gamma \\bar{v}_k + \\bar{b}_{\\text{correction},k} \\right] dt + \\frac{1}{N_k} \\sum_{i \\in A_k} \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n1333: $$\n1334: \n1335: where $\\bar{F}_k = \\frac{1}{N_k} \\sum_{i \\in A_k} F(x_{k,i})$ is the average force and $\\bar{b}_{\\text{correction},k} = \\frac{1}{N_k} \\sum_{i \\in A_k} b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)$ is the average It\u00f4 correction.\n1336: \n1337: Taking differences:\n1338: \n1339: $$\n1340: \\frac{d}{dt} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} + \\text{(noise difference)}\n1341: $$\n1342: \n1343: where $\\Delta \\bar{b}_{\\text{correction}} = \\bar{b}_{\\text{correction},1} - \\bar{b}_{\\text{correction},2}$ is bounded by $2C_{\\text{It\u00f4}}$ (Lemma [](#lem-ito-correction-bound)).\n1344: \n1345: Define the drift matrix:\n1346: \n1347: $$\n1348: M = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix}\n1349: $$\n1350: \n1351: **Step 2: Hypocoercive Quadratic Form**\n1352: \n1353: The location error is $V_{\\text{loc}} = z^T Q z$ with the hypocoercive weight matrix:\n1354: \n1355: $$\n1356: Q = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix}\n1357: $$\n1358: \n1359: where $\\lambda_v > 0$ weights velocity error and $b \\in \\mathbb{R}$ couples position and velocity errors.\n1360: \n1361: **Positive definiteness**: Requires $\\lambda_v > b^2/4$ (Sylvester's criterion).\n1362: \n1363: **Step 3: Generator Applied to Quadratic Form**\n1364: \n1365: The infinitesimal generator acting on $V_{\\text{loc}}(z) = z^T Q z$ is:\n1366: \n1367: $$\n1368: \\mathcal{L} V_{\\text{loc}} = 2 z^T Q \\left[ M z + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} \\right] + \\text{Tr}\\left( \\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}} \\right)\n1369: $$\n1370: \n1371: where $\\bar{D}_{\\text{noise}}$ is the covariance of the noise difference (computed below) and $\\Delta \\bar{b}_{\\text{correction}}$ is the difference in average It\u00f4 corrections.\n1372: \n1373: **Step 3a: Drift Term (Deterministic)**\n1374: \n1375: The drift from $M$ is:\n1376: \n1377: $$\n1378: z^T (M^T Q + Q M) z\n1379: $$\n1380: \n1381: Compute the drift matrix $\\mathcal{D} = M^T Q + Q M$:\n1382: \n1383: $$\n1384: M^T Q = \\begin{bmatrix} 0 & 0 \\\\ I_d & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ I_d - \\frac{b\\gamma}{2}I_d & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1385: $$\n1386: \n1387: $$\n1388: Q M = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} = \\begin{bmatrix} 0 & I_d - \\frac{b\\gamma}{2}I_d \\\\ 0 & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1389: $$\n1390: \n1391: $$\n1392: \\mathcal{D} = M^T Q + Q M = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ (1 - \\frac{b\\gamma}{2})I_d & (b - 2\\gamma\\lambda_v)I_d \\end{bmatrix}\n1393: $$\n1394: \n1395: **Step 3b: Force and It\u00f4 Correction Contribution**\n1396: \n1397: $$\n1398: 2 z^T Q \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} = 2 (\\Delta \\mu_x, \\Delta \\mu_v) \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix}\n1399: $$\n1400: \n1401: $$\n1402: = b \\langle \\Delta \\mu_x, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle + 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle\n1403: $$\n1404: \n1405: By Lipschitz continuity of $F(x) = -\\nabla U(x)$ (from coercivity Axiom 1.3.1):\n1406: \n1407: $$\n1408: \\|\\Delta \\bar{F}\\| \\le L_F \\|\\Delta \\mu_x\\| + O(1/\\sqrt{N})\n1409: $$\n1410: \n1411: By Lemma [](#lem-ito-correction-bound):\n1412: \n1413: $$\n1414: \\|\\Delta \\bar{b}_{\\text{correction}}\\| \\le 2C_{\\text{It\u00f4}}\n1415: $$\n1416: \n1417: Using Cauchy-Schwarz and Young's inequality $2ab \\le \\epsilon a^2 + b^2/\\epsilon$:\n1418: \n1419: $$\n1420: b \\langle \\Delta \\mu_x, \\Delta \\bar{F} \\rangle \\le |b| L_F \\|\\Delta \\mu_x\\|^2 + O(1/\\sqrt{N})\n1421: $$\n1422: \n1423: $$\n1424: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} \\rangle \\le 2\\lambda_v L_F \\|\\Delta \\mu_x\\| \\|\\Delta \\mu_v\\| \\le \\lambda_v L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2)\n1425: $$\n1426: \n1427: **It\u00f4 correction terms**: Similarly,\n1428: \n1429: $$\n1430: b \\langle \\Delta \\mu_x, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le |b| C_{\\text{It\u00f4}} \\|\\Delta \\mu_x\\|\n1431: $$\n1432: \n1433: $$\n1434: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le 2\\lambda_v C_{\\text{It\u00f4}} \\|\\Delta \\mu_v\\|\n1435: $$\n1436: \n1437: These contribute $O(C_{\\text{It\u00f4}})$ to the additive constant after Young's inequality.\n1438: \n1439: **Step 3c: Noise Contribution (ANISOTROPIC CASE - KEY)**\n1440: \n1441: The noise difference has covariance (per unit time):\n1442: \n1443: $$\n1444: \\bar{D}_{\\text{noise}} = \\text{blockdiag}\\left( 0_d, \\frac{1}{N_1} \\sum_{i \\in A_1} D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_{j \\in A_2} D_{\\text{reg}}(x_{2,j}, S_2) \\right)\n1445: $$\n1446: \n1447: The contribution to the generator is:\n1448: \n1449: $$\n1450: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) = \\text{Tr}(\\bar{D}_{\\text{noise}} \\cdot 2Q)\n1451: $$\n1452: \n1453: Since noise acts only on velocities:\n1454: \n1455: $$\n1456: = 2 \\text{Tr}\\left( \\left[ \\frac{1}{N_1} \\sum_i D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_j D_{\\text{reg}}(x_{2,j}, S_2) \\right] \\lambda_v I_d \\right)\n1457: $$\n1458: \n1459: $$\n1460: = 2\\lambda_v \\left[ \\frac{1}{N_1} \\sum_i \\text{Tr}(D_{\\text{reg}}(x_{1,i}, S_1)) + \\frac{1}{N_2} \\sum_j \\text{Tr}(D_{\\text{reg}}(x_{2,j}, S_2)) \\right]\n1461: $$\n1462: \n1463: By uniform ellipticity $c_{\\min} I \\preceq D_{\\text{reg}} \\preceq c_{\\max} I$:\n1464: \n1465: $$\n1466: c_{\\min} d \\le \\text{Tr}(D_{\\text{reg}}(x,S)) \\le c_{\\max} d\n1467: $$\n1468: \n1469: Therefore:\n1470: \n1471: $$\n1472: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) \\le 2\\lambda_v \\cdot 2 c_{\\max} d = 4\\lambda_v c_{\\max} d\n1473: $$\n1474: \n1475: **CRITICAL**: This bound is **independent of $N$** because the $1/N_k$ factor in $\\bar{D}_{\\text{noise}}$ cancels the sum over $N_k$ walkers.\n1476: \n1477: **Step 4: Combined Drift Inequality**\n1478: \n1479: $$\n1480: \\mathcal{L} V_{\\text{loc}} \\le z^T \\mathcal{D} z + (|b| + \\lambda_v) L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2) + 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N})\n1481: $$\n1482: \n1483: **Step 5: Optimal Parameter Choice**\n1484: \n1485: Following the hypocoercivity analysis from `../1_euclidean_gas/06_convergence.md` (Lemma 2.5.1), choose:\n1486: \n1487: $$\n1488: \\lambda_v = \\frac{1}{\\gamma}, \\quad b = \\frac{2}{\\sqrt{\\gamma}}\n1489: $$\n1490: \n1491: This gives near-critical damping. With these values:\n1492: \n1493: $$\n1494: \\mathcal{D} = \\begin{bmatrix} 0 & (1 - \\frac{1}{\\sqrt{\\gamma}})I_d \\\\ (1 - \\frac{1}{\\sqrt{\\gamma}})I_d & (\\frac{2}{\\sqrt{\\gamma}} - \\frac{2}{\\gamma})I_d \\end{bmatrix}\n1495: $$\n1496: \n1497: **Step 6: Eigenvalue Analysis of Effective Drift Matrix**\n1498: \n1499: Define the **effective drift matrix** including force perturbation:\n1500: \n1501: $$\n1502: \\mathcal{D}_{\\text{eff}} = \\mathcal{D} + (|b| + \\lambda_v) L_F \\cdot I_{2d}\n1503: $$\n1504: \n1505: The eigenvalues of $\\mathcal{D}$ (in the limit $\\gamma \\to \\infty$ for simplicity) are approximately:\n1506: \n1507: $$\n1508: \\lambda_{\\pm} \\approx -\\frac{\\gamma}{2} \\pm i\\omega\n1509: $$\n1510: \n1511: where $\\omega$ is the oscillation frequency. The **real part** is negative: $\\text{Re}(\\lambda) \\approx -\\gamma/2$.\n1512: \n1513: Adding the force perturbation shifts eigenvalues by at most $O(L_F)$. For sufficiently large $\\gamma > L_F$:\n1514: \n1515: $$\n1516: \\text{Re}(\\lambda_{\\text{min}}(\\mathcal{D}_{\\text{eff}})) \\le -\\frac{\\gamma}{4} < 0\n1517: $$\n1518: \n1519: This gives the contraction rate:\n1520: \n1521: $$\n1522: z^T \\mathcal{D}_{\\text{eff}} z \\le -\\kappa_{\\text{hypo}} \\|z\\|^2\n1523: $$\n1524: \n1525: where $\\kappa_{\\text{hypo}} = O(\\min\\{\\gamma, c_{\\min}\\})$.\n1526: \n1527: **WHY $c_{\\min}$ APPEARS**: The noise term contributes $4\\lambda_v c_{\\max} d$ to the expansion. For the Lyapunov function to decay, the contraction $-\\kappa_{\\text{hypo}} V_{\\text{loc}}$ must dominate. The effective contraction is:\n1528: \n1529: $$\n1530: \\kappa_{\\text{loc}} = \\kappa_{\\text{hypo}} - \\frac{4\\lambda_v c_{\\max} d}{V_{\\text{loc}}}\n1531: $$\n1532: \n1533: For large $V_{\\text{loc}}$, this is positive. For bounded $V_{\\text{loc}}$, we need $\\kappa_{\\text{hypo}} \\ge c_{\\text{threshold}}$ to ensure net contraction. By analyzing the full dynamics, this threshold is $O(c_{\\min})$ (the minimum noise strength required for hypocoercive coupling).\n1534: \n1535: **Step 7: Discrete-Time Result**\n1536: \n1537: By the It\u00f4-to-discretization theorem:\n1538: \n1539: $$\n1540: \\mathbb{E}[V_{\\text{loc}}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{loc}}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{loc}}(S_1, S_2) + O(\\tau^2)\n1541: $$\n1542: \n1543: $$\n1544: \\le (1 - \\kappa_{\\text{loc}} \\tau) V_{\\text{loc}}(S_1, S_2) + C_{\\text{loc}} \\tau\n1545: $$\n1546: \n1547: where:\n1548: - $\\kappa_{\\text{loc}} = O(\\min\\{\\gamma, c_{\\min}\\})$\n1549: - $C_{\\text{loc}} = 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N}) = O(c_{\\max})$ (N-uniform)",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1295: :::\n1296: \n1297: :::{prf:proof}\n1298: This proof provides a complete, self-contained drift matrix analysis for the anisotropic case.\n1299: \n1300: **Preliminaries: The Infinitesimal Generator**\n1301: \n1302: For the coupled $2N$-particle kinetic process, the infinitesimal generator is:\n1303: \n1304: $$\n1305: \\mathcal{L} = \\sum_{k=1,2} \\sum_{i \\in A_k} \\left[ v_{k,i} \\cdot \\nabla_{x_{k,i}} + [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\cdot \\nabla_{v_{k,i}} + \\frac{1}{2} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k) \\nabla^2_{v_{k,i}}) \\right]\n1306: $$\n1307: \n1308: where:\n1309: - $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers in swarm $k$\n1310: - $D_{\\text{reg}}(x_{k,i}, S_k) = \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\Sigma_{\\text{reg}}(x_{k,i}, S_k)^T$ is the diffusion matrix\n1311: - $b_{\\text{correction}}$ is the It\u00f4 correction term from Lemma [](#lem-ito-correction-bound)\n1312: - $\\nabla_{x_{k,i}}, \\nabla_{v_{k,i}}$ are gradients with respect to walker $i$ in swarm $k$\n1313: - $\\nabla^2_{v_{k,i}}$ is the Hessian with respect to velocity (note: no diffusion in position)\n1314: \n1315: We apply this generator to the location error $V_{\\text{loc}}(S_1, S_2) = z^T Q z$ where $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T$ is the barycenter difference.\n1316: \n1317: **Step 1: State Vector and Dynamics**\n1318: \n1319: Define the barycenter difference vector $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T \\in \\mathbb{R}^{2d}$ where:\n1320: \n1321: $$\n1322: \\Delta \\mu_x = \\bar{x}_1 - \\bar{x}_2, \\quad \\Delta \\mu_v = \\bar{v}_1 - \\bar{v}_2\n1323: $$\n1324: \n1325: For swarm $k$, the barycenters evolve as (Stratonovich form):\n1326: \n1327: $$\n1328: d\\bar{x}_k = \\bar{v}_k \\, dt\n1329: $$\n1330: \n1331: $$\n1332: d\\bar{v}_k = \\left[ \\bar{F}_k - \\gamma \\bar{v}_k + \\bar{b}_{\\text{correction},k} \\right] dt + \\frac{1}{N_k} \\sum_{i \\in A_k} \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n1333: $$\n1334: \n1335: where $\\bar{F}_k = \\frac{1}{N_k} \\sum_{i \\in A_k} F(x_{k,i})$ is the average force and $\\bar{b}_{\\text{correction},k} = \\frac{1}{N_k} \\sum_{i \\in A_k} b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)$ is the average It\u00f4 correction.\n1336: \n1337: Taking differences:\n1338: \n1339: $$\n1340: \\frac{d}{dt} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} + \\text{(noise difference)}\n1341: $$\n1342: \n1343: where $\\Delta \\bar{b}_{\\text{correction}} = \\bar{b}_{\\text{correction},1} - \\bar{b}_{\\text{correction},2}$ is bounded by $2C_{\\text{It\u00f4}}$ (Lemma [](#lem-ito-correction-bound)).\n1344: \n1345: Define the drift matrix:\n1346: \n1347: $$\n1348: M = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix}\n1349: $$\n1350: \n1351: **Step 2: Hypocoercive Quadratic Form**\n1352: \n1353: The location error is $V_{\\text{loc}} = z^T Q z$ with the hypocoercive weight matrix:\n1354: \n1355: $$\n1356: Q = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix}\n1357: $$\n1358: \n1359: where $\\lambda_v > 0$ weights velocity error and $b \\in \\mathbb{R}$ couples position and velocity errors.\n1360: \n1361: **Positive definiteness**: Requires $\\lambda_v > b^2/4$ (Sylvester's criterion).\n1362: \n1363: **Step 3: Generator Applied to Quadratic Form**\n1364: \n1365: The infinitesimal generator acting on $V_{\\text{loc}}(z) = z^T Q z$ is:\n1366: \n1367: $$\n1368: \\mathcal{L} V_{\\text{loc}} = 2 z^T Q \\left[ M z + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} \\right] + \\text{Tr}\\left( \\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}} \\right)\n1369: $$\n1370: \n1371: where $\\bar{D}_{\\text{noise}}$ is the covariance of the noise difference (computed below) and $\\Delta \\bar{b}_{\\text{correction}}$ is the difference in average It\u00f4 corrections.\n1372: \n1373: **Step 3a: Drift Term (Deterministic)**\n1374: \n1375: The drift from $M$ is:\n1376: \n1377: $$\n1378: z^T (M^T Q + Q M) z\n1379: $$\n1380: \n1381: Compute the drift matrix $\\mathcal{D} = M^T Q + Q M$:\n1382: \n1383: $$\n1384: M^T Q = \\begin{bmatrix} 0 & 0 \\\\ I_d & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ I_d - \\frac{b\\gamma}{2}I_d & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1385: $$\n1386: \n1387: $$\n1388: Q M = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} = \\begin{bmatrix} 0 & I_d - \\frac{b\\gamma}{2}I_d \\\\ 0 & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1389: $$\n1390: \n1391: $$\n1392: \\mathcal{D} = M^T Q + Q M = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ (1 - \\frac{b\\gamma}{2})I_d & (b - 2\\gamma\\lambda_v)I_d \\end{bmatrix}\n1393: $$\n1394: \n1395: **Step 3b: Force and It\u00f4 Correction Contribution**\n1396: \n1397: $$\n1398: 2 z^T Q \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} = 2 (\\Delta \\mu_x, \\Delta \\mu_v) \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix}\n1399: $$\n1400: \n1401: $$\n1402: = b \\langle \\Delta \\mu_x, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle + 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle\n1403: $$\n1404: \n1405: By Lipschitz continuity of $F(x) = -\\nabla U(x)$ (from coercivity Axiom 1.3.1):\n1406: \n1407: $$\n1408: \\|\\Delta \\bar{F}\\| \\le L_F \\|\\Delta \\mu_x\\| + O(1/\\sqrt{N})\n1409: $$\n1410: \n1411: By Lemma [](#lem-ito-correction-bound):\n1412: \n1413: $$\n1414: \\|\\Delta \\bar{b}_{\\text{correction}}\\| \\le 2C_{\\text{It\u00f4}}\n1415: $$\n1416: \n1417: Using Cauchy-Schwarz and Young's inequality $2ab \\le \\epsilon a^2 + b^2/\\epsilon$:\n1418: \n1419: $$\n1420: b \\langle \\Delta \\mu_x, \\Delta \\bar{F} \\rangle \\le |b| L_F \\|\\Delta \\mu_x\\|^2 + O(1/\\sqrt{N})\n1421: $$\n1422: \n1423: $$\n1424: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} \\rangle \\le 2\\lambda_v L_F \\|\\Delta \\mu_x\\| \\|\\Delta \\mu_v\\| \\le \\lambda_v L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2)\n1425: $$\n1426: \n1427: **It\u00f4 correction terms**: Similarly,\n1428: \n1429: $$\n1430: b \\langle \\Delta \\mu_x, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le |b| C_{\\text{It\u00f4}} \\|\\Delta \\mu_x\\|\n1431: $$\n1432: \n1433: $$\n1434: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le 2\\lambda_v C_{\\text{It\u00f4}} \\|\\Delta \\mu_v\\|\n1435: $$\n1436: \n1437: These contribute $O(C_{\\text{It\u00f4}})$ to the additive constant after Young's inequality.\n1438: \n1439: **Step 3c: Noise Contribution (ANISOTROPIC CASE - KEY)**\n1440: \n1441: The noise difference has covariance (per unit time):\n1442: \n1443: $$\n1444: \\bar{D}_{\\text{noise}} = \\text{blockdiag}\\left( 0_d, \\frac{1}{N_1} \\sum_{i \\in A_1} D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_{j \\in A_2} D_{\\text{reg}}(x_{2,j}, S_2) \\right)\n1445: $$\n1446: \n1447: The contribution to the generator is:\n1448: \n1449: $$\n1450: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) = \\text{Tr}(\\bar{D}_{\\text{noise}} \\cdot 2Q)\n1451: $$\n1452: \n1453: Since noise acts only on velocities:\n1454: \n1455: $$\n1456: = 2 \\text{Tr}\\left( \\left[ \\frac{1}{N_1} \\sum_i D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_j D_{\\text{reg}}(x_{2,j}, S_2) \\right] \\lambda_v I_d \\right)\n1457: $$\n1458: \n1459: $$\n1460: = 2\\lambda_v \\left[ \\frac{1}{N_1} \\sum_i \\text{Tr}(D_{\\text{reg}}(x_{1,i}, S_1)) + \\frac{1}{N_2} \\sum_j \\text{Tr}(D_{\\text{reg}}(x_{2,j}, S_2)) \\right]\n1461: $$\n1462: \n1463: By uniform ellipticity $c_{\\min} I \\preceq D_{\\text{reg}} \\preceq c_{\\max} I$:\n1464: \n1465: $$\n1466: c_{\\min} d \\le \\text{Tr}(D_{\\text{reg}}(x,S)) \\le c_{\\max} d\n1467: $$\n1468: \n1469: Therefore:\n1470: \n1471: $$\n1472: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) \\le 2\\lambda_v \\cdot 2 c_{\\max} d = 4\\lambda_v c_{\\max} d\n1473: $$\n1474: \n1475: **CRITICAL**: This bound is **independent of $N$** because the $1/N_k$ factor in $\\bar{D}_{\\text{noise}}$ cancels the sum over $N_k$ walkers.\n1476: \n1477: **Step 4: Combined Drift Inequality**\n1478: \n1479: $$\n1480: \\mathcal{L} V_{\\text{loc}} \\le z^T \\mathcal{D} z + (|b| + \\lambda_v) L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2) + 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N})\n1481: $$\n1482: \n1483: **Step 5: Optimal Parameter Choice**\n1484: \n1485: Following the hypocoercivity analysis from `../1_euclidean_gas/06_convergence.md` (Lemma 2.5.1), choose:\n1486: \n1487: $$\n1488: \\lambda_v = \\frac{1}{\\gamma}, \\quad b = \\frac{2}{\\sqrt{\\gamma}}\n1489: $$\n1490: \n1491: This gives near-critical damping. With these values:\n1492: \n1493: $$\n1494: \\mathcal{D} = \\begin{bmatrix} 0 & (1 - \\frac{1}{\\sqrt{\\gamma}})I_d \\\\ (1 - \\frac{1}{\\sqrt{\\gamma}})I_d & (\\frac{2}{\\sqrt{\\gamma}} - \\frac{2}{\\gamma})I_d \\end{bmatrix}\n1495: $$\n1496: \n1497: **Step 6: Eigenvalue Analysis of Effective Drift Matrix**\n1498: \n1499: Define the **effective drift matrix** including force perturbation:\n1500: \n1501: $$\n1502: \\mathcal{D}_{\\text{eff}} = \\mathcal{D} + (|b| + \\lambda_v) L_F \\cdot I_{2d}\n1503: $$\n1504: \n1505: The eigenvalues of $\\mathcal{D}$ (in the limit $\\gamma \\to \\infty$ for simplicity) are approximately:\n1506: \n1507: $$\n1508: \\lambda_{\\pm} \\approx -\\frac{\\gamma}{2} \\pm i\\omega\n1509: $$\n1510: \n1511: where $\\omega$ is the oscillation frequency. The **real part** is negative: $\\text{Re}(\\lambda) \\approx -\\gamma/2$.\n1512: \n1513: Adding the force perturbation shifts eigenvalues by at most $O(L_F)$. For sufficiently large $\\gamma > L_F$:\n1514: \n1515: $$\n1516: \\text{Re}(\\lambda_{\\text{min}}(\\mathcal{D}_{\\text{eff}})) \\le -\\frac{\\gamma}{4} < 0\n1517: $$\n1518: \n1519: This gives the contraction rate:\n1520: \n1521: $$\n1522: z^T \\mathcal{D}_{\\text{eff}} z \\le -\\kappa_{\\text{hypo}} \\|z\\|^2\n1523: $$\n1524: \n1525: where $\\kappa_{\\text{hypo}} = O(\\min\\{\\gamma, c_{\\min}\\})$.\n1526: \n1527: **WHY $c_{\\min}$ APPEARS**: The noise term contributes $4\\lambda_v c_{\\max} d$ to the expansion. For the Lyapunov function to decay, the contraction $-\\kappa_{\\text{hypo}} V_{\\text{loc}}$ must dominate. The effective contraction is:\n1528: \n1529: $$\n1530: \\kappa_{\\text{loc}} = \\kappa_{\\text{hypo}} - \\frac{4\\lambda_v c_{\\max} d}{V_{\\text{loc}}}\n1531: $$\n1532: \n1533: For large $V_{\\text{loc}}$, this is positive. For bounded $V_{\\text{loc}}$, we need $\\kappa_{\\text{hypo}} \\ge c_{\\text{threshold}}$ to ensure net contraction. By analyzing the full dynamics, this threshold is $O(c_{\\min})$ (the minimum noise strength required for hypocoercive coupling).\n1534: \n1535: **Step 7: Discrete-Time Result**\n1536: \n1537: By the It\u00f4-to-discretization theorem:\n1538: \n1539: $$\n1540: \\mathbb{E}[V_{\\text{loc}}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{loc}}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{loc}}(S_1, S_2) + O(\\tau^2)\n1541: $$\n1542: \n1543: $$\n1544: \\le (1 - \\kappa_{\\text{loc}} \\tau) V_{\\text{loc}}(S_1, S_2) + C_{\\text{loc}} \\tau\n1545: $$\n1546: \n1547: where:\n1548: - $\\kappa_{\\text{loc}} = O(\\min\\{\\gamma, c_{\\min}\\})$\n1549: - $C_{\\text{loc}} = 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N}) = O(c_{\\max})$ (N-uniform)\n1550: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-structural-error-anisotropic",
      "title": "Structural Error Contraction (Anisotropic)",
      "start_line": 1568,
      "end_line": 1580,
      "header_lines": [
        1569
      ],
      "content_start": 1571,
      "content_end": 1579,
      "content": "1571: :label: thm-structural-error-anisotropic\n1572: \n1573: The structural error $V_{\\text{struct}}(S_1, S_2) = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ (Wasserstein distance between centered measures) satisfies:\n1574: \n1575: $$\n1576: \\mathbb{E}[\\Delta V_{\\text{struct}}] \\le -\\kappa_{\\text{struct}} \\tau V_{\\text{struct}} + C_{\\text{struct}} \\tau\n1577: $$\n1578: \n1579: where:",
      "metadata": {
        "label": "thm-structural-error-anisotropic"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1568: #### 3.2.4. Structural Error Drift (Anisotropic Case)\n1569: \n1570: :::{prf:theorem} Structural Error Contraction (Anisotropic)\n1571: :label: thm-structural-error-anisotropic\n1572: \n1573: The structural error $V_{\\text{struct}}(S_1, S_2) = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2)$ (Wasserstein distance between centered measures) satisfies:\n1574: \n1575: $$\n1576: \\mathbb{E}[\\Delta V_{\\text{struct}}] \\le -\\kappa_{\\text{struct}} \\tau V_{\\text{struct}} + C_{\\text{struct}} \\tau\n1577: $$\n1578: \n1579: where:\n1580: - $\\kappa_{\\text{struct}} = O(\\min\\{\\gamma, c_{\\min}\\}) > 0$"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-646",
      "title": null,
      "start_line": 1582,
      "end_line": 1664,
      "header_lines": [
        1659
      ],
      "content_start": 1583,
      "content_end": 1663,
      "content": "1583: \n1584: :::{prf:proof}\n1585: This proof adapts the synchronous coupling argument from `../1_euclidean_gas/06_convergence.md` (Lemma 2.6.1) to handle different noise tensors.\n1586: \n1587: **Step 1: Synchronous Coupling Setup**\n1588: \n1589: For discrete empirical measures, the optimal transport plan is the **synchronous coupling**: match particles by index.\n1590: \n1591: $$\n1592: \\pi^N = \\frac{1}{N} \\sum_{i=1}^N \\delta_{(z_{1,i}, z_{2,i})}\n1593: $$\n1594: \n1595: where $z_{k,i} = (x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})$ are centered coordinates.\n1596: \n1597: The Wasserstein distance is:\n1598: \n1599: $$\n1600: V_{\\text{struct}} = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2) = \\frac{1}{N} \\sum_{i=1}^N \\|z_{1,i} - z_{2,i}\\|_h^2\n1601: $$\n1602: \n1603: **Step 2: Single-Pair Dynamics**\n1604: \n1605: Each particle pair evolves under (Stratonovich form):\n1606: \n1607: $$\n1608: \\begin{aligned}\n1609: dx_{k,i} &= v_{k,i} \\, dt \\\\\n1610: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_i\n1611: \\end{aligned}\n1612: $$\n1613: \n1614: **Challenge**: The noise tensors $\\Sigma_{\\text{reg}}(x_{1,i}, S_1)$ and $\\Sigma_{\\text{reg}}(x_{2,i}, S_2)$ are **different** because the two swarms are in different states.\n1615: \n1616: **Solution**: Use **midpoint coupling**. Evolve both particles with the **average** noise tensor:\n1617: \n1618: $$\n1619: \\Sigma_{\\text{mid},i} = \\frac{1}{2} \\left[ \\Sigma_{\\text{reg}}(x_{1,i}, S_1) + \\Sigma_{\\text{reg}}(x_{2,i}, S_2) \\right]\n1620: $$\n1621: \n1622: **Step 3: Coupling Error Analysis (Rigorous Bound)**\n1623: \n1624: The **coupling error** is the difference between the true dynamics and the midpoint dynamics.\n1625: \n1626: **Step 3a: Define the error process**\n1627: \n1628: For the true SDE of particle difference (Stratonovich):\n1629: \n1630: $$\n1631: d(z_{1,i} - z_{2,i}) = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + [\\Sigma_{\\text{reg}}(x_{1,i}, S_1) - \\Sigma_{\\text{reg}}(x_{2,i}, S_2)] \\circ dW_i\n1632: $$\n1633: \n1634: where $M$ is the drift matrix and $\\Delta F_i = F(x_{1,i}) - F(x_{2,i})$.\n1635: \n1636: Under **midpoint coupling** with shared noise $dW_i$:\n1637: \n1638: $$\n1639: d(z_{1,i} - z_{2,i})_{\\text{mid}} = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + \\Sigma_{\\text{mid},i} \\circ dW_i\n1640: $$\n1641: \n1642: The **coupling error process** is:\n1643: \n1644: $$\n1645: \\text{Error}_i(t) = \\int_0^t \\left[ \\frac{\\Sigma_{\\text{reg}}(x_{1,i}(s), S_1) - \\Sigma_{\\text{reg}}(x_{2,i}(s), S_2)}{2} \\right] \\circ dW_i(s)\n1646: $$\n1647: \n1648: where we used $\\Sigma_{\\text{mid}} = (\\Sigma_1 + \\Sigma_2)/2$.\n1649: \n1650: **Step 3b: Stratonovich Isometry for Variance Bound**\n1651: \n1652: We apply the fundamental isometry property of Stratonovich stochastic integrals. For any adapted matrix-valued process $\\sigma(s)$:\n1653: \n1654: $$\n1655: \\mathbb{E}\\left[\\left\\|\\int_0^t \\sigma(s) \\circ dW_s\\right\\|^2\\right] = \\mathbb{E}\\left[\\int_0^t \\|\\sigma(s)\\|_F^2 ds\\right]\n1656: $$\n1657: \n1658: where $\\|\\cdot\\|_F$ is the Frobenius norm. This is a standard result in stochastic calculus (see Karatzas & Shreve, Brownian Motion and Stochastic Calculus, Theorem 3.3.16).\n1659: \n1660: :::{admonition} Why Stratonovich?\n1661: :class: note\n1662: \n1663: This isometry is **identical** to the It\u00f4 case, but Stratonovich integrals have a key advantage for physics: **geometric invariance under coordinate transformations**. When we later map this result to curved space (Section 8), the Stratonovich formulation ensures the convergence rate remains coordinate-independent.",
      "metadata": {
        "class": "note"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1582: :::\n1583: \n1584: :::{prf:proof}\n1585: This proof adapts the synchronous coupling argument from `../1_euclidean_gas/06_convergence.md` (Lemma 2.6.1) to handle different noise tensors.\n1586: \n1587: **Step 1: Synchronous Coupling Setup**\n1588: \n1589: For discrete empirical measures, the optimal transport plan is the **synchronous coupling**: match particles by index.\n1590: \n1591: $$\n1592: \\pi^N = \\frac{1}{N} \\sum_{i=1}^N \\delta_{(z_{1,i}, z_{2,i})}\n1593: $$\n1594: \n1595: where $z_{k,i} = (x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})$ are centered coordinates.\n1596: \n1597: The Wasserstein distance is:\n1598: \n1599: $$\n1600: V_{\\text{struct}} = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2) = \\frac{1}{N} \\sum_{i=1}^N \\|z_{1,i} - z_{2,i}\\|_h^2\n1601: $$\n1602: \n1603: **Step 2: Single-Pair Dynamics**\n1604: \n1605: Each particle pair evolves under (Stratonovich form):\n1606: \n1607: $$\n1608: \\begin{aligned}\n1609: dx_{k,i} &= v_{k,i} \\, dt \\\\\n1610: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_i\n1611: \\end{aligned}\n1612: $$\n1613: \n1614: **Challenge**: The noise tensors $\\Sigma_{\\text{reg}}(x_{1,i}, S_1)$ and $\\Sigma_{\\text{reg}}(x_{2,i}, S_2)$ are **different** because the two swarms are in different states.\n1615: \n1616: **Solution**: Use **midpoint coupling**. Evolve both particles with the **average** noise tensor:\n1617: \n1618: $$\n1619: \\Sigma_{\\text{mid},i} = \\frac{1}{2} \\left[ \\Sigma_{\\text{reg}}(x_{1,i}, S_1) + \\Sigma_{\\text{reg}}(x_{2,i}, S_2) \\right]\n1620: $$\n1621: \n1622: **Step 3: Coupling Error Analysis (Rigorous Bound)**\n1623: \n1624: The **coupling error** is the difference between the true dynamics and the midpoint dynamics.\n1625: \n1626: **Step 3a: Define the error process**\n1627: \n1628: For the true SDE of particle difference (Stratonovich):\n1629: \n1630: $$\n1631: d(z_{1,i} - z_{2,i}) = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + [\\Sigma_{\\text{reg}}(x_{1,i}, S_1) - \\Sigma_{\\text{reg}}(x_{2,i}, S_2)] \\circ dW_i\n1632: $$\n1633: \n1634: where $M$ is the drift matrix and $\\Delta F_i = F(x_{1,i}) - F(x_{2,i})$.\n1635: \n1636: Under **midpoint coupling** with shared noise $dW_i$:\n1637: \n1638: $$\n1639: d(z_{1,i} - z_{2,i})_{\\text{mid}} = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + \\Sigma_{\\text{mid},i} \\circ dW_i\n1640: $$\n1641: \n1642: The **coupling error process** is:\n1643: \n1644: $$\n1645: \\text{Error}_i(t) = \\int_0^t \\left[ \\frac{\\Sigma_{\\text{reg}}(x_{1,i}(s), S_1) - \\Sigma_{\\text{reg}}(x_{2,i}(s), S_2)}{2} \\right] \\circ dW_i(s)\n1646: $$\n1647: \n1648: where we used $\\Sigma_{\\text{mid}} = (\\Sigma_1 + \\Sigma_2)/2$.\n1649: \n1650: **Step 3b: Stratonovich Isometry for Variance Bound**\n1651: \n1652: We apply the fundamental isometry property of Stratonovich stochastic integrals. For any adapted matrix-valued process $\\sigma(s)$:\n1653: \n1654: $$\n1655: \\mathbb{E}\\left[\\left\\|\\int_0^t \\sigma(s) \\circ dW_s\\right\\|^2\\right] = \\mathbb{E}\\left[\\int_0^t \\|\\sigma(s)\\|_F^2 ds\\right]\n1656: $$\n1657: \n1658: where $\\|\\cdot\\|_F$ is the Frobenius norm. This is a standard result in stochastic calculus (see Karatzas & Shreve, Brownian Motion and Stochastic Calculus, Theorem 3.3.16).\n1659: \n1660: :::{admonition} Why Stratonovich?\n1661: :class: note\n1662: \n1663: This isometry is **identical** to the It\u00f4 case, but Stratonovich integrals have a key advantage for physics: **geometric invariance under coordinate transformations**. When we later map this result to curved space (Section 8), the Stratonovich formulation ensures the convergence rate remains coordinate-independent.\n1664: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-hypocoercive-main",
      "title": "Hypocoercive Contraction for Geometric Gas",
      "start_line": 1789,
      "end_line": 1802,
      "header_lines": [
        1790
      ],
      "content_start": 1792,
      "content_end": 1801,
      "content": "1792: :label: thm-hypocoercive-main\n1793: \n1794: The inter-swarm Wasserstein distance $V_W(S_1, S_2) = V_{\\text{loc}} + V_{\\text{struct}}$ satisfies:\n1795: \n1796: $$\n1797: \\mathbb{E}[\\Delta V_W] \\le -\\kappa'_W \\tau V_W + C'_W \\tau\n1798: $$\n1799: \n1800: where:\n1801: - $\\kappa'_W = \\min\\{\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}}\\} = O(\\min\\{\\gamma, c_{\\min}\\}) > 0$",
      "metadata": {
        "label": "thm-hypocoercive-main"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1789: #### 3.2.5. Main Hypocoercive Theorem (Assembly)\n1790: \n1791: :::{prf:theorem} Hypocoercive Contraction for Geometric Gas\n1792: :label: thm-hypocoercive-main\n1793: \n1794: The inter-swarm Wasserstein distance $V_W(S_1, S_2) = V_{\\text{loc}} + V_{\\text{struct}}$ satisfies:\n1795: \n1796: $$\n1797: \\mathbb{E}[\\Delta V_W] \\le -\\kappa'_W \\tau V_W + C'_W \\tau\n1798: $$\n1799: \n1800: where:\n1801: - $\\kappa'_W = \\min\\{\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}}\\} = O(\\min\\{\\gamma, c_{\\min}\\}) > 0$\n1802: - $C'_W = C_{\\text{loc}} + C_{\\text{struct}} = O(c_{\\max}^2)$"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-868",
      "title": null,
      "start_line": 1804,
      "end_line": 1808,
      "header_lines": [],
      "content_start": 1805,
      "content_end": 1807,
      "content": "1805: \n1806: :::{prf:proof}\n1807: Direct from Theorems [](#thm-location-error-anisotropic) and [](#thm-structural-error-anisotropic). Since both components contract at rates $\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}} = O(\\min\\{\\gamma, c_{\\min}\\})$, their sum contracts at rate $\\min\\{\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}}\\}$.",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1804: :::\n1805: \n1806: :::{prf:proof}\n1807: Direct from Theorems [](#thm-location-error-anisotropic) and [](#thm-structural-error-anisotropic). Since both components contract at rates $\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}} = O(\\min\\{\\gamma, c_{\\min}\\})$, their sum contracts at rate $\\min\\{\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}}\\}$.\n1808: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-position-variance-expansion",
      "title": "Position Variance Expansion",
      "start_line": 1825,
      "end_line": 1835,
      "header_lines": [
        1826
      ],
      "content_start": 1828,
      "content_end": 1834,
      "content": "1828: :label: thm-position-variance-expansion\n1829: \n1830: The position variance difference satisfies:\n1831: \n1832: $$\n1833: \\mathbb{E}[\\Delta V_{\\text{Var},x}] \\le C'_x \\tau\n1834: $$",
      "metadata": {
        "label": "thm-position-variance-expansion"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1825: ### 5.4. Position Variance Expansion (Bounded)\n1826: \n1827: :::{prf:theorem} Position Variance Expansion\n1828: :label: thm-position-variance-expansion\n1829: \n1830: The position variance difference satisfies:\n1831: \n1832: $$\n1833: \\mathbb{E}[\\Delta V_{\\text{Var},x}] \\le C'_x \\tau\n1834: $$\n1835: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-901",
      "title": null,
      "start_line": 1837,
      "end_line": 1861,
      "header_lines": [],
      "content_start": 1838,
      "content_end": 1860,
      "content": "1838: \n1839: :::{prf:proof}\n1840: **Step 1**: Position evolves as $dx = v \\, dt$ (no noise, no force).\n1841: \n1842: **Step 2**: The generator acting on $V_{\\text{Var},x} = |V_{\\text{Var},x}(S_1) - V_{\\text{Var},x}(S_2)|$ is:\n1843: \n1844: $$\n1845: \\mathcal{L} V_{\\text{Var},x} = 2 \\langle x - \\bar{x}, v - \\bar{v} \\rangle\n1846: $$\n1847: \n1848: **Step 3**: By Cauchy-Schwarz and the velocity bound $\\|v\\| \\le V_{\\max}$:\n1849: \n1850: $$\n1851: |\\mathcal{L} V_{\\text{Var},x}| \\le 2 V_{\\max} \\sqrt{V_{\\text{Var},x}}\n1852: $$\n1853: \n1854: **Step 4**: Using Young's inequality, this is bounded by a constant independent of $V_{\\text{Var},x}$:\n1855: \n1856: $$\n1857: \\mathcal{L} V_{\\text{Var},x} \\le C'_x\n1858: $$\n1859: \n1860: **Step 5**: Discrete-time result follows from integration.",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1837: :::\n1838: \n1839: :::{prf:proof}\n1840: **Step 1**: Position evolves as $dx = v \\, dt$ (no noise, no force).\n1841: \n1842: **Step 2**: The generator acting on $V_{\\text{Var},x} = |V_{\\text{Var},x}(S_1) - V_{\\text{Var},x}(S_2)|$ is:\n1843: \n1844: $$\n1845: \\mathcal{L} V_{\\text{Var},x} = 2 \\langle x - \\bar{x}, v - \\bar{v} \\rangle\n1846: $$\n1847: \n1848: **Step 3**: By Cauchy-Schwarz and the velocity bound $\\|v\\| \\le V_{\\max}$:\n1849: \n1850: $$\n1851: |\\mathcal{L} V_{\\text{Var},x}| \\le 2 V_{\\max} \\sqrt{V_{\\text{Var},x}}\n1852: $$\n1853: \n1854: **Step 4**: Using Young's inequality, this is bounded by a constant independent of $V_{\\text{Var},x}$:\n1855: \n1856: $$\n1857: \\mathcal{L} V_{\\text{Var},x} \\le C'_x\n1858: $$\n1859: \n1860: **Step 5**: Discrete-time result follows from integration.\n1861: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-boundary-contraction",
      "title": "Boundary Potential Contraction",
      "start_line": 1865,
      "end_line": 1875,
      "header_lines": [
        1866
      ],
      "content_start": 1868,
      "content_end": 1874,
      "content": "1868: :label: thm-boundary-contraction\n1869: \n1870: The boundary potential satisfies:\n1871: \n1872: $$\n1873: \\mathbb{E}[\\Delta W_b] \\le -\\kappa'_b \\tau W_b + C'_b \\tau\n1874: $$",
      "metadata": {
        "label": "thm-boundary-contraction"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1865: ### 5.5. Boundary Potential Contraction\n1866: \n1867: :::{prf:theorem} Boundary Potential Contraction\n1868: :label: thm-boundary-contraction\n1869: \n1870: The boundary potential satisfies:\n1871: \n1872: $$\n1873: \\mathbb{E}[\\Delta W_b] \\le -\\kappa'_b \\tau W_b + C'_b \\tau\n1874: $$\n1875: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-941",
      "title": null,
      "start_line": 1877,
      "end_line": 1899,
      "header_lines": [],
      "content_start": 1878,
      "content_end": 1898,
      "content": "1878: \n1879: :::{prf:proof}\n1880: **Step 1**: The confining force $F(x) = -\\nabla U(x)$ points inward near the boundary with strength $\\langle x, \\nabla U(x) \\rangle \\ge \\alpha_U \\|x\\|^2 - R_U$ (Axiom 1.3.1).\n1881: \n1882: **Step 2**: The generator acting on $W_b = \\sum_k \\frac{1}{N_k} \\sum_i w_b(x_{k,i})$ includes the force term:\n1883: \n1884: $$\n1885: \\mathcal{L} w_b(x) = \\langle \\nabla w_b(x), v \\rangle + \\langle \\nabla w_b(x), F(x) \\rangle + \\text{diffusion}\n1886: $$\n1887: \n1888: **Step 3**: Near the boundary, $\\nabla w_b$ points outward and $F$ points inward, giving:\n1889: \n1890: $$\n1891: \\langle \\nabla w_b(x), F(x) \\rangle \\le -\\alpha_U w_b(x)\n1892: $$\n1893: \n1894: **Step 4**: The velocity and diffusion terms contribute bounded constants. The force dominates:\n1895: \n1896: $$\n1897: \\mathcal{L} W_b \\le -\\kappa'_b W_b + C'_b\n1898: $$",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "raw_directive": "1877: :::\n1878: \n1879: :::{prf:proof}\n1880: **Step 1**: The confining force $F(x) = -\\nabla U(x)$ points inward near the boundary with strength $\\langle x, \\nabla U(x) \\rangle \\ge \\alpha_U \\|x\\|^2 - R_U$ (Axiom 1.3.1).\n1881: \n1882: **Step 2**: The generator acting on $W_b = \\sum_k \\frac{1}{N_k} \\sum_i w_b(x_{k,i})$ includes the force term:\n1883: \n1884: $$\n1885: \\mathcal{L} w_b(x) = \\langle \\nabla w_b(x), v \\rangle + \\langle \\nabla w_b(x), F(x) \\rangle + \\text{diffusion}\n1886: $$\n1887: \n1888: **Step 3**: Near the boundary, $\\nabla w_b$ points outward and $F$ points inward, giving:\n1889: \n1890: $$\n1891: \\langle \\nabla w_b(x), F(x) \\rangle \\le -\\alpha_U w_b(x)\n1892: $$\n1893: \n1894: **Step 4**: The velocity and diffusion terms contribute bounded constants. The force dominates:\n1895: \n1896: $$\n1897: \\mathcal{L} W_b \\le -\\kappa'_b W_b + C'_b\n1898: $$\n1899: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}