{
  "chapter_index": 3,
  "section_id": "## 3. The Emergent Geometry Framework",
  "directive_count": 11,
  "hints": [
    {
      "directive_type": "definition",
      "label": "def-d-adaptive-diffusion",
      "title": "Adaptive Diffusion Tensor (from `11_geometric_gas.md`)",
      "start_line": 303,
      "end_line": 323,
      "header_lines": [
        304
      ],
      "content_start": 306,
      "content_end": 322,
      "content": "306: :label: def-d-adaptive-diffusion\n307: \n308: For a swarm state $S = \\{(x_i, v_i, s_i)\\}_{i=1}^N$, the **adaptive diffusion tensor** for walker $i$ is:\n309: \n310: $$\n311: \\Sigma_{\\text{reg}}(x_i, S) = \\left( H_i(S) + \\epsilon_\\Sigma I \\right)^{-1/2}\n312: $$\n313: \n314: where:\n315: - $H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ is the Hessian of the fitness potential with respect to walker $i$'s position\n316: - $\\epsilon_\\Sigma > 0$ is the **regularization parameter**\n317: - The matrix square root is the unique symmetric positive definite square root\n318: \n319: The induced **diffusion matrix** (covariance of the noise) is:\n320: \n321: $$\n322: D_{\\text{reg}}(x_i, S) = \\Sigma_{\\text{reg}}(x_i, S) \\Sigma_{\\text{reg}}(x_i, S)^T = \\left( H_i(S) + \\epsilon_\\Sigma I \\right)^{-1}",
      "metadata": {
        "label": "def-d-adaptive-diffusion"
      },
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "303: The Geometric Gas introduces geometry through its noise structure.\n304: \n305: :::{prf:definition} Adaptive Diffusion Tensor (from `11_geometric_gas.md`)\n306: :label: def-d-adaptive-diffusion\n307: \n308: For a swarm state $S = \\{(x_i, v_i, s_i)\\}_{i=1}^N$, the **adaptive diffusion tensor** for walker $i$ is:\n309: \n310: $$\n311: \\Sigma_{\\text{reg}}(x_i, S) = \\left( H_i(S) + \\epsilon_\\Sigma I \\right)^{-1/2}\n312: $$\n313: \n314: where:\n315: - $H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$ is the Hessian of the fitness potential with respect to walker $i$'s position\n316: - $\\epsilon_\\Sigma > 0$ is the **regularization parameter**\n317: - The matrix square root is the unique symmetric positive definite square root\n318: \n319: The induced **diffusion matrix** (covariance of the noise) is:\n320: \n321: $$\n322: D_{\\text{reg}}(x_i, S) = \\Sigma_{\\text{reg}}(x_i, S) \\Sigma_{\\text{reg}}(x_i, S)^T = \\left( H_i(S) + \\epsilon_\\Sigma I \\right)^{-1}\n323: $$"
    },
    {
      "directive_type": "remark",
      "label": "unlabeled-remark-27",
      "title": "Why This is a Riemannian Metric",
      "start_line": 325,
      "end_line": 335,
      "header_lines": [
        326
      ],
      "content_start": 328,
      "content_end": 334,
      "content": "328: :class: note\n329: \n330: The regularized Hessian $g(x_i, S) = H_i(S) + \\epsilon_\\Sigma I$ defines a Riemannian metric on the state space. In differential geometry, this is precisely the metric induced by a potential function (the fitness). In information geometry, this is analogous to the **Fisher information metric**.\n331: \n332: **Geometric interpretation** (using the standard convention $D = g^{-1}$):\n333: - **Flat directions** (small Hessian eigenvalues): Small metric eigenvalues \u2192 **large diffusion** \u2192 more exploration\n334: - **Curved directions** (large Hessian eigenvalues): Large metric eigenvalues \u2192 **small diffusion** \u2192 more exploitation",
      "metadata": {
        "class": "note"
      },
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "325: :::\n326: \n327: :::{prf:remark} Why This is a Riemannian Metric\n328: :class: note\n329: \n330: The regularized Hessian $g(x_i, S) = H_i(S) + \\epsilon_\\Sigma I$ defines a Riemannian metric on the state space. In differential geometry, this is precisely the metric induced by a potential function (the fitness). In information geometry, this is analogous to the **Fisher information metric**.\n331: \n332: **Geometric interpretation** (using the standard convention $D = g^{-1}$):\n333: - **Flat directions** (small Hessian eigenvalues): Small metric eigenvalues \u2192 **large diffusion** \u2192 more exploration\n334: - **Curved directions** (large Hessian eigenvalues): Large metric eigenvalues \u2192 **small diffusion** \u2192 more exploitation\n335: "
    },
    {
      "directive_type": "assumption",
      "label": "assump-spectral-floor",
      "title": "Spectral Floor (Standing Assumption)",
      "start_line": 341,
      "end_line": 351,
      "header_lines": [
        342
      ],
      "content_start": 344,
      "content_end": 350,
      "content": "344: :label: assump-spectral-floor\n345: \n346: There exists $\\Lambda_- \\ge 0$ such that for all swarm states $S$ and walkers $i$:\n347: \n348: $$\n349: \\lambda_{\\min}(H(x_i, S)) \\ge -\\Lambda_-\n350: $$",
      "metadata": {
        "label": "assump-spectral-floor"
      },
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "341: The regularization $\\epsilon_\\Sigma I$ ensures the diffusion is well-behaved.\n342: \n343: :::{prf:assumption} Spectral Floor (Standing Assumption)\n344: :label: assump-spectral-floor\n345: \n346: There exists $\\Lambda_- \\ge 0$ such that for all swarm states $S$ and walkers $i$:\n347: \n348: $$\n349: \\lambda_{\\min}(H(x_i, S)) \\ge -\\Lambda_-\n350: $$\n351: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-uniform-ellipticity",
      "title": "Uniform Ellipticity by Construction (from `11_geometric_gas.md`)",
      "start_line": 353,
      "end_line": 391,
      "header_lines": [
        354
      ],
      "content_start": 356,
      "content_end": 390,
      "content": "356: :label: thm-uniform-ellipticity\n357: \n358: For all swarm states $S$ and all walkers $i$, the diffusion matrix satisfies:\n359: \n360: $$\n361: c_{\\min} I \\preceq D_{\\text{reg}}(x_i, S) \\preceq c_{\\max} I\n362: $$\n363: \n364: where:\n365: \n366: $$\n367: c_{\\min} = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad c_{\\max} = \\frac{1}{\\epsilon_\\Sigma - \\Lambda_-}\n368: $$\n369: \n370: and $\\lambda_{\\max}(H)$ is the maximum eigenvalue of the unregularized Hessian over the compact state space $\\mathcal{X}_{\\text{valid}}$.\n371: \n372: **Simplified form when $H \\succeq 0$ (positive semi-definite)**:\n373: \n374: When the Hessian is guaranteed to be positive semi-definite (i.e., $\\Lambda_- = 0$), the bounds simplify to:\n375: \n376: $$\n377: c_{\\min} = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad c_{\\max} = \\frac{1}{\\epsilon_\\Sigma}\n378: $$\n379: \n380: **Equivalently (in terms of diffusion tensor $\\Sigma_{\\text{reg}}$)**:\n381: \n382: $$\n383: \\frac{1}{\\sqrt{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}} I \\preceq \\Sigma_{\\text{reg}}(x_i, S) \\preceq \\frac{1}{\\sqrt{\\epsilon_\\Sigma - \\Lambda_-}} I\n384: $$\n385: \n386: **Proof**: If $A = H + \\epsilon_\\Sigma I$ is SPD, the eigenvalues of $D = A^{-1}$ are $\\{1/(\\lambda_i(H) + \\epsilon_\\Sigma)\\}$. Therefore:\n387: \n388: $$\n389: \\lambda_{\\min}(D) = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad \\lambda_{\\max}(D) = \\frac{1}{\\lambda_{\\min}(H) + \\epsilon_\\Sigma} \\le \\frac{1}{\\epsilon_\\Sigma - \\Lambda_-}\n390: $$",
      "metadata": {
        "label": "thm-uniform-ellipticity"
      },
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "353: :::\n354: \n355: :::{prf:theorem} Uniform Ellipticity by Construction (from `11_geometric_gas.md`)\n356: :label: thm-uniform-ellipticity\n357: \n358: For all swarm states $S$ and all walkers $i$, the diffusion matrix satisfies:\n359: \n360: $$\n361: c_{\\min} I \\preceq D_{\\text{reg}}(x_i, S) \\preceq c_{\\max} I\n362: $$\n363: \n364: where:\n365: \n366: $$\n367: c_{\\min} = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad c_{\\max} = \\frac{1}{\\epsilon_\\Sigma - \\Lambda_-}\n368: $$\n369: \n370: and $\\lambda_{\\max}(H)$ is the maximum eigenvalue of the unregularized Hessian over the compact state space $\\mathcal{X}_{\\text{valid}}$.\n371: \n372: **Simplified form when $H \\succeq 0$ (positive semi-definite)**:\n373: \n374: When the Hessian is guaranteed to be positive semi-definite (i.e., $\\Lambda_- = 0$), the bounds simplify to:\n375: \n376: $$\n377: c_{\\min} = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad c_{\\max} = \\frac{1}{\\epsilon_\\Sigma}\n378: $$\n379: \n380: **Equivalently (in terms of diffusion tensor $\\Sigma_{\\text{reg}}$)**:\n381: \n382: $$\n383: \\frac{1}{\\sqrt{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}} I \\preceq \\Sigma_{\\text{reg}}(x_i, S) \\preceq \\frac{1}{\\sqrt{\\epsilon_\\Sigma - \\Lambda_-}} I\n384: $$\n385: \n386: **Proof**: If $A = H + \\epsilon_\\Sigma I$ is SPD, the eigenvalues of $D = A^{-1}$ are $\\{1/(\\lambda_i(H) + \\epsilon_\\Sigma)\\}$. Therefore:\n387: \n388: $$\n389: \\lambda_{\\min}(D) = \\frac{1}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}, \\quad \\lambda_{\\max}(D) = \\frac{1}{\\lambda_{\\min}(H) + \\epsilon_\\Sigma} \\le \\frac{1}{\\epsilon_\\Sigma - \\Lambda_-}\n390: $$\n391: "
    },
    {
      "directive_type": "proposition",
      "label": "prop-lipschitz-diffusion",
      "title": "Lipschitz Continuity of Adaptive Diffusion",
      "start_line": 411,
      "end_line": 424,
      "header_lines": [
        412
      ],
      "content_start": 414,
      "content_end": 423,
      "content": "414: :label: prop-lipschitz-diffusion\n415: \n416: The adaptive diffusion tensor is Lipschitz continuous:\n417: \n418: $$\n419: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F \\le L_\\Sigma \\cdot d_{\\text{state}}((x_1, S_1), (x_2, S_2))\n420: $$\n421: \n422: where $\\|\\cdot\\|_F$ is the Frobenius norm, $d_{\\text{state}}$ is an appropriate state-space metric, and $L_\\Sigma$ depends on:\n423: - The Lipschitz constant of the fitness Hessian $\\nabla^2 V_{\\text{fit}}$",
      "metadata": {
        "label": "prop-lipschitz-diffusion"
      },
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "411: The diffusion tensor varies smoothly with the state.\n412: \n413: :::{prf:proposition} Lipschitz Continuity of Adaptive Diffusion\n414: :label: prop-lipschitz-diffusion\n415: \n416: The adaptive diffusion tensor is Lipschitz continuous:\n417: \n418: $$\n419: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F \\le L_\\Sigma \\cdot d_{\\text{state}}((x_1, S_1), (x_2, S_2))\n420: $$\n421: \n422: where $\\|\\cdot\\|_F$ is the Frobenius norm, $d_{\\text{state}}$ is an appropriate state-space metric, and $L_\\Sigma$ depends on:\n423: - The Lipschitz constant of the fitness Hessian $\\nabla^2 V_{\\text{fit}}$\n424: - The regularization $\\epsilon_\\Sigma$"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-128",
      "title": null,
      "start_line": 426,
      "end_line": 510,
      "header_lines": [],
      "content_start": 427,
      "content_end": 509,
      "content": "427: \n428: :::{prf:proof}\n429: We prove Lipschitz continuity with an N-uniform constant $L_\\Sigma$.\n430: \n431: **Step 1: Structure of the fitness potential**\n432: \n433: For typical fitness potentials (e.g., kernel density estimates, pair potentials), the fitness has the structure:\n434: \n435: $$\n436: V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{i,j} \\phi(x_i, x_j)\n437: $$\n438: \n439: where $\\phi: \\mathcal{X} \\times \\mathcal{X} \\to \\mathbb{R}$ is a smooth, bounded interaction kernel. The Hessian with respect to walker $i$'s position is:\n440: \n441: $$\n442: H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{j=1}^N \\nabla^2_{x_i} \\phi(x_i, x_j)\n443: $$\n444: \n445: The $1/N$ normalization is critical for N-uniformity.\n446: \n447: **Step 2: Lipschitz continuity of the Hessian**\n448: \n449: Since $\\phi$ is smooth with bounded third derivatives (Assumption on $V_{\\text{fit}}$), the Hessian is Lipschitz:\n450: \n451: $$\n452: \\|H_i(S_1) - H_i(S_2)\\|_F \\le \\frac{1}{N} \\sum_{j=1}^N \\|\\nabla^2_{x_i} \\phi(x_{1,i}, x_{1,j}) - \\nabla^2_{x_i} \\phi(x_{2,i}, x_{2,j})\\|_F\n453: $$\n454: \n455: $$\n456: \\le \\frac{1}{N} \\sum_{j=1}^N L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n457: $$\n458: \n459: $$\n460: \\le L_{\\phi}^{(3)} \\cdot \\frac{1}{N} \\sum_{j=1}^N (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n461: $$\n462: \n463: $$\n464: = L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|)\n465: $$\n466: \n467: Define the state-space metric:\n468: \n469: $$\n470: d_{\\text{state}}((x_i, S_1), (x_i, S_2)) = \\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|\n471: $$\n472: \n473: Then $\\|H_i(S_1) - H_i(S_2)\\|_F \\le L_H \\cdot d_{\\text{state}}$ where $L_H = L_{\\phi}^{(3)}$ is **independent of $N$**.\n474: \n475: **Step 3: Lipschitz continuity of the matrix square root**\n476: \n477: The map $f(A) = (A + \\epsilon_\\Sigma I)^{-1/2}$ is Lipschitz on the set of symmetric matrices with eigenvalues in $[\\epsilon_\\Sigma - \\Lambda_-, H_{\\max} + \\epsilon_\\Sigma]$.\n478: \n479: For symmetric matrices $A, B$ in this set, by standard matrix perturbation theory (Bhatia, Matrix Analysis, Theorem VII.1.8):\n480: \n481: $$\n482: \\|f(A) - f(B)\\|_F \\le K_{\\text{sqrt}}(\\epsilon_\\Sigma, H_{\\max}) \\|A - B\\|_F\n483: $$\n484: \n485: where $K_{\\text{sqrt}}$ depends only on the ellipticity bounds, not on $N$.\n486: \n487: **Step 4: Composition**\n488: \n489: By the chain rule for Lipschitz functions:\n490: \n491: $$\n492: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F = \\|f(H_i(S_1)) - f(H_i(S_2))\\|_F\n493: $$\n494: \n495: $$\n496: \\le K_{\\text{sqrt}} \\|H_i(S_1) - H_i(S_2)\\|_F\n497: $$\n498: \n499: $$\n500: \\le K_{\\text{sqrt}} \\cdot L_H \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n501: $$\n502: \n503: Setting $L_\\Sigma = K_{\\text{sqrt}} \\cdot L_H$, we have:\n504: \n505: $$\n506: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F \\le L_\\Sigma \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n507: $$\n508: \n509: where $L_\\Sigma$ is **independent of $N$** by construction.",
      "metadata": {},
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "426: :::\n427: \n428: :::{prf:proof}\n429: We prove Lipschitz continuity with an N-uniform constant $L_\\Sigma$.\n430: \n431: **Step 1: Structure of the fitness potential**\n432: \n433: For typical fitness potentials (e.g., kernel density estimates, pair potentials), the fitness has the structure:\n434: \n435: $$\n436: V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{i,j} \\phi(x_i, x_j)\n437: $$\n438: \n439: where $\\phi: \\mathcal{X} \\times \\mathcal{X} \\to \\mathbb{R}$ is a smooth, bounded interaction kernel. The Hessian with respect to walker $i$'s position is:\n440: \n441: $$\n442: H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{j=1}^N \\nabla^2_{x_i} \\phi(x_i, x_j)\n443: $$\n444: \n445: The $1/N$ normalization is critical for N-uniformity.\n446: \n447: **Step 2: Lipschitz continuity of the Hessian**\n448: \n449: Since $\\phi$ is smooth with bounded third derivatives (Assumption on $V_{\\text{fit}}$), the Hessian is Lipschitz:\n450: \n451: $$\n452: \\|H_i(S_1) - H_i(S_2)\\|_F \\le \\frac{1}{N} \\sum_{j=1}^N \\|\\nabla^2_{x_i} \\phi(x_{1,i}, x_{1,j}) - \\nabla^2_{x_i} \\phi(x_{2,i}, x_{2,j})\\|_F\n453: $$\n454: \n455: $$\n456: \\le \\frac{1}{N} \\sum_{j=1}^N L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n457: $$\n458: \n459: $$\n460: \\le L_{\\phi}^{(3)} \\cdot \\frac{1}{N} \\sum_{j=1}^N (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n461: $$\n462: \n463: $$\n464: = L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|)\n465: $$\n466: \n467: Define the state-space metric:\n468: \n469: $$\n470: d_{\\text{state}}((x_i, S_1), (x_i, S_2)) = \\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|\n471: $$\n472: \n473: Then $\\|H_i(S_1) - H_i(S_2)\\|_F \\le L_H \\cdot d_{\\text{state}}$ where $L_H = L_{\\phi}^{(3)}$ is **independent of $N$**.\n474: \n475: **Step 3: Lipschitz continuity of the matrix square root**\n476: \n477: The map $f(A) = (A + \\epsilon_\\Sigma I)^{-1/2}$ is Lipschitz on the set of symmetric matrices with eigenvalues in $[\\epsilon_\\Sigma - \\Lambda_-, H_{\\max} + \\epsilon_\\Sigma]$.\n478: \n479: For symmetric matrices $A, B$ in this set, by standard matrix perturbation theory (Bhatia, Matrix Analysis, Theorem VII.1.8):\n480: \n481: $$\n482: \\|f(A) - f(B)\\|_F \\le K_{\\text{sqrt}}(\\epsilon_\\Sigma, H_{\\max}) \\|A - B\\|_F\n483: $$\n484: \n485: where $K_{\\text{sqrt}}$ depends only on the ellipticity bounds, not on $N$.\n486: \n487: **Step 4: Composition**\n488: \n489: By the chain rule for Lipschitz functions:\n490: \n491: $$\n492: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F = \\|f(H_i(S_1)) - f(H_i(S_2))\\|_F\n493: $$\n494: \n495: $$\n496: \\le K_{\\text{sqrt}} \\|H_i(S_1) - H_i(S_2)\\|_F\n497: $$\n498: \n499: $$\n500: \\le K_{\\text{sqrt}} \\cdot L_H \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n501: $$\n502: \n503: Setting $L_\\Sigma = K_{\\text{sqrt}} \\cdot L_H$, we have:\n504: \n505: $$\n506: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F \\le L_\\Sigma \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n507: $$\n508: \n509: where $L_\\Sigma$ is **independent of $N$** by construction.\n510: "
    },
    {
      "directive_type": "definition",
      "label": "def-d-kinetic-operator-adaptive",
      "title": "Kinetic Operator with Adaptive Diffusion",
      "start_line": 516,
      "end_line": 555,
      "header_lines": [
        517
      ],
      "content_start": 519,
      "content_end": 554,
      "content": "519: :label: def-d-kinetic-operator-adaptive\n520: \n521: The kinetic operator $\\Psi_{\\text{kin}}$ evolves the swarm for time $\\tau$ according to:\n522: \n523: $$\n524: \\begin{aligned}\n525: dx_i &= v_i \\, dt \\\\\n526: dv_i &= \\left[ F(x_i) - \\gamma v_i \\right] dt + \\Sigma_{\\text{reg}}(x_i, S) \\circ dW_i\n527: \\end{aligned}\n528: $$\n529: \n530: where:\n531: - $F(x) = -\\nabla U(x)$ is the force from the confining potential (Axiom 1.3.1 from `../1_euclidean_gas/06_convergence.md`)\n532: - $\\gamma > 0$ is the friction coefficient\n533: - $W_i$ are independent standard Brownian motions\n534: - $\\circ$ denotes the **Stratonovich product** (not It\u00f4)\n535: \n536: **Why Stratonovich**: The Stratonovich formulation is essential for manifold/geometric settings because:\n537: 1. **Chain rule works**: Stratonovich SDEs transform naturally under coordinate changes\n538: 2. **Geometric invariance**: The diffusion $(H + \\epsilon_\\Sigma I)^{-1/2}$ represents intrinsic geometry\n539: 3. **No spurious drift**: It\u00f4 would add correction terms $\\frac{1}{2}\\sum_j (D_x\\Sigma_{\\text{reg}}^{(\\cdot,j)})\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ that obscure the physics\n540: \n541: **Generator and Discretization Convention**: We present the SDE in Stratonovich form for geometric clarity. However:\n542: - **For proofs**: The infinitesimal generator $\\mathcal{L}$ uses the **It\u00f4 form** with It\u00f4 drift:\n543: \n544: $$\n545: b_{\\text{It\\hat{o}}}(x,v,S) = [F(x) - \\gamma v] + \\frac{1}{2}\\sum_{j=1}^d (D_x\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S))\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\n546: $$\n547: \n548:   where $\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ is the $j$-th column and $D_x$ is the Jacobian w.r.t. $x$.\n549: \n550: - **For discretization**: To properly simulate this SDE, we use either:\n551:   - **Heun's method** (stochastic midpoint) for the Stratonovich form, or\n552:   - **Euler-Maruyama** on the It\u00f4 form (with the corrected drift above)\n553: \n554: Note: Direct application of Euler-Maruyama to the Stratonovich form is inconsistent and should be avoided.",
      "metadata": {
        "label": "def-d-kinetic-operator-adaptive"
      },
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "516: The kinetic operator evolves walkers according to underdamped Langevin dynamics with the adaptive diffusion.\n517: \n518: :::{prf:definition} Kinetic Operator with Adaptive Diffusion\n519: :label: def-d-kinetic-operator-adaptive\n520: \n521: The kinetic operator $\\Psi_{\\text{kin}}$ evolves the swarm for time $\\tau$ according to:\n522: \n523: $$\n524: \\begin{aligned}\n525: dx_i &= v_i \\, dt \\\\\n526: dv_i &= \\left[ F(x_i) - \\gamma v_i \\right] dt + \\Sigma_{\\text{reg}}(x_i, S) \\circ dW_i\n527: \\end{aligned}\n528: $$\n529: \n530: where:\n531: - $F(x) = -\\nabla U(x)$ is the force from the confining potential (Axiom 1.3.1 from `../1_euclidean_gas/06_convergence.md`)\n532: - $\\gamma > 0$ is the friction coefficient\n533: - $W_i$ are independent standard Brownian motions\n534: - $\\circ$ denotes the **Stratonovich product** (not It\u00f4)\n535: \n536: **Why Stratonovich**: The Stratonovich formulation is essential for manifold/geometric settings because:\n537: 1. **Chain rule works**: Stratonovich SDEs transform naturally under coordinate changes\n538: 2. **Geometric invariance**: The diffusion $(H + \\epsilon_\\Sigma I)^{-1/2}$ represents intrinsic geometry\n539: 3. **No spurious drift**: It\u00f4 would add correction terms $\\frac{1}{2}\\sum_j (D_x\\Sigma_{\\text{reg}}^{(\\cdot,j)})\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ that obscure the physics\n540: \n541: **Generator and Discretization Convention**: We present the SDE in Stratonovich form for geometric clarity. However:\n542: - **For proofs**: The infinitesimal generator $\\mathcal{L}$ uses the **It\u00f4 form** with It\u00f4 drift:\n543: \n544: $$\n545: b_{\\text{It\\hat{o}}}(x,v,S) = [F(x) - \\gamma v] + \\frac{1}{2}\\sum_{j=1}^d (D_x\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S))\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\n546: $$\n547: \n548:   where $\\Sigma_{\\text{reg}}^{(\\cdot,j)}$ is the $j$-th column and $D_x$ is the Jacobian w.r.t. $x$.\n549: \n550: - **For discretization**: To properly simulate this SDE, we use either:\n551:   - **Heun's method** (stochastic midpoint) for the Stratonovich form, or\n552:   - **Euler-Maruyama** on the It\u00f4 form (with the corrected drift above)\n553: \n554: Note: Direct application of Euler-Maruyama to the Stratonovich form is inconsistent and should be avoided.\n555: "
    },
    {
      "directive_type": "remark",
      "label": "rem-comparison-isotropic",
      "title": "Comparison to Isotropic Case",
      "start_line": 557,
      "end_line": 569,
      "header_lines": [
        558
      ],
      "content_start": 560,
      "content_end": 568,
      "content": "560: :label: rem-comparison-isotropic\n561: \n562: The **isotropic Euclidean Gas** (`../1_euclidean_gas/06_convergence.md`) uses $\\Sigma = \\sigma_v I$. The convergence proof relies heavily on this simplification:\n563: - Noise contribution to Lyapunov drift: $\\text{Tr}(\\sigma_v^2 I \\cdot \\nabla^2 V) = \\sigma_v^2 \\text{Tr}(\\nabla^2 V)$ is **constant**\n564: - Synchronous coupling: Both swarms use **identical** noise tensor $\\sigma_v I$\n565: \n566: The **Geometric Gas** uses $\\Sigma = \\Sigma_{\\text{reg}}(x_i, S)$. The challenges:\n567: - Noise contribution: $\\text{Tr}(D_{\\text{reg}}(x_i, S) \\cdot \\nabla^2 V)$ is **state-dependent**\n568: - Synchronous coupling: Must handle **different** noise tensors $\\Sigma_{\\text{reg}}(x_{1,i}, S_1) \\neq \\Sigma_{\\text{reg}}(x_{2,i}, S_2)$",
      "metadata": {
        "label": "rem-comparison-isotropic"
      },
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "557: :::\n558: \n559: :::{prf:remark} Comparison to Isotropic Case\n560: :label: rem-comparison-isotropic\n561: \n562: The **isotropic Euclidean Gas** (`../1_euclidean_gas/06_convergence.md`) uses $\\Sigma = \\sigma_v I$. The convergence proof relies heavily on this simplification:\n563: - Noise contribution to Lyapunov drift: $\\text{Tr}(\\sigma_v^2 I \\cdot \\nabla^2 V) = \\sigma_v^2 \\text{Tr}(\\nabla^2 V)$ is **constant**\n564: - Synchronous coupling: Both swarms use **identical** noise tensor $\\sigma_v I$\n565: \n566: The **Geometric Gas** uses $\\Sigma = \\Sigma_{\\text{reg}}(x_i, S)$. The challenges:\n567: - Noise contribution: $\\text{Tr}(D_{\\text{reg}}(x_i, S) \\cdot \\nabla^2 V)$ is **state-dependent**\n568: - Synchronous coupling: Must handle **different** noise tensors $\\Sigma_{\\text{reg}}(x_{1,i}, S_1) \\neq \\Sigma_{\\text{reg}}(x_{2,i}, S_2)$\n569: "
    },
    {
      "directive_type": "observation",
      "label": "rem-observation-two-formulations",
      "title": "Two Equivalent Formulations",
      "start_line": 590,
      "end_line": 620,
      "header_lines": [
        591
      ],
      "content_start": 593,
      "content_end": 619,
      "content": "593: :label: rem-observation-two-formulations\n594: \n595: **Perspective 1: Flat Algorithmic Space (This Document)**\n596: - **State space**: Flat Euclidean $\\mathbb{R}^d \\times \\mathbb{R}^d$ (positions and velocities)\n597: - **Diffusion**: Anisotropic, state-dependent: $D(x, S) = (H(x, S) + \\epsilon_\\Sigma I)^{-1}$\n598: - **Metric**: Standard Euclidean inner product\n599: - **SDE** (Stratonovich):\n600: \n601: \n602: $$\n603: dv = [F(x) - \\gamma v] dt + \\Sigma_{\\text{reg}}(x, S) \\circ dW\n604: $$\n605: \n606:   where $\\Sigma_{\\text{reg}} = D^{1/2}$ is anisotropic\n607: \n608: **Perspective 2: Emergent Riemannian Manifold**\n609: - **State space**: Riemannian manifold $(\\mathcal{X}, g)$ with metric $g(x, S) = H(x, S) + \\epsilon_\\Sigma I$\n610: - **Diffusion**: Isotropic in the Riemannian metric (constant diffusion coefficient)\n611: - **Metric**: Riemannian metric $g = D^{-1}$ induced by regularized Hessian\n612: - **SDE** (in local coordinates, Stratonovich):\n613: \n614: \n615: $$\n616: dv = [\\tilde{F}_g(x) - \\gamma v] dt + \\sigma \\sqrt{g^{-1}(x, S)} \\circ dW\n617: $$\n618: \n619:   where $\\tilde{F}_g$ includes Christoffel symbol corrections",
      "metadata": {
        "label": "rem-observation-two-formulations"
      },
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "590: The Geometric Gas can be analyzed from two complementary viewpoints:\n591: \n592: :::{prf:observation} Two Equivalent Formulations\n593: :label: rem-observation-two-formulations\n594: \n595: **Perspective 1: Flat Algorithmic Space (This Document)**\n596: - **State space**: Flat Euclidean $\\mathbb{R}^d \\times \\mathbb{R}^d$ (positions and velocities)\n597: - **Diffusion**: Anisotropic, state-dependent: $D(x, S) = (H(x, S) + \\epsilon_\\Sigma I)^{-1}$\n598: - **Metric**: Standard Euclidean inner product\n599: - **SDE** (Stratonovich):\n600: \n601: \n602: $$\n603: dv = [F(x) - \\gamma v] dt + \\Sigma_{\\text{reg}}(x, S) \\circ dW\n604: $$\n605: \n606:   where $\\Sigma_{\\text{reg}} = D^{1/2}$ is anisotropic\n607: \n608: **Perspective 2: Emergent Riemannian Manifold**\n609: - **State space**: Riemannian manifold $(\\mathcal{X}, g)$ with metric $g(x, S) = H(x, S) + \\epsilon_\\Sigma I$\n610: - **Diffusion**: Isotropic in the Riemannian metric (constant diffusion coefficient)\n611: - **Metric**: Riemannian metric $g = D^{-1}$ induced by regularized Hessian\n612: - **SDE** (in local coordinates, Stratonovich):\n613: \n614: \n615: $$\n616: dv = [\\tilde{F}_g(x) - \\gamma v] dt + \\sigma \\sqrt{g^{-1}(x, S)} \\circ dW\n617: $$\n618: \n619:   where $\\tilde{F}_g$ includes Christoffel symbol corrections\n620: "
    },
    {
      "directive_type": "theorem",
      "label": "thm-coordinate-invariance",
      "title": "Invariance Under Coordinate Changes (Refined)",
      "start_line": 640,
      "end_line": 668,
      "header_lines": [
        641
      ],
      "content_start": 643,
      "content_end": 667,
      "content": "643: :label: thm-coordinate-invariance\n644: \n645: Let $\\Psi: (\\mathbb{R}^d, D_{\\text{flat}}) \\to (M, g)$ be a $C^2$ diffeomorphism relating flat space with anisotropic diffusion to a Riemannian manifold. If the Jacobian $d\\Psi$ and its inverse have bounded operator norms:\n646: \n647: $$\n648: \\|d\\Psi\\|_{\\text{op}}, \\|(d\\Psi)^{-1}\\|_{\\text{op}} \\le K\n649: $$\n650: \n651: and the push-forward relation holds:\n652: \n653: $$\n654: D_{\\text{flat}}(x) = (d\\Psi_x^{-1})^T g(\\Psi(x))^{-1} (d\\Psi_x^{-1})\n655: $$\n656: \n657: then:\n658: \n659: 1. **TV distances match exactly**: $\\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\mathcal{L}^{\\text{curved}}(Y_t) - \\pi^{\\text{curved}}\\|_{\\text{TV}}$\n660: \n661: 2. **Lyapunov drift inequalities are preserved up to condition-number factors**: If $\\mathbb{E}[\\Delta V_{\\text{flat}}(X)] \\le -\\kappa V_{\\text{flat}}(X) + C$, then with $V_{\\text{curved}} = V_{\\text{flat}} \\circ \\Psi^{-1}$:\n662: \n663: $$\n664: \\mathbb{E}[\\Delta V_{\\text{curved}}(Y)] \\le -\\kappa' V_{\\text{curved}}(Y) + C'\n665: $$\n666: \n667: where $\\kappa' \\asymp \\kappa/\\text{cond}(d\\Psi)^2$ and $C' \\asymp C \\cdot \\text{cond}(d\\Psi)^2$.",
      "metadata": {
        "label": "thm-coordinate-invariance"
      },
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "640: #### 3.6.3. Invariance of Convergence Constants\n641: \n642: :::{prf:theorem} Invariance Under Coordinate Changes (Refined)\n643: :label: thm-coordinate-invariance\n644: \n645: Let $\\Psi: (\\mathbb{R}^d, D_{\\text{flat}}) \\to (M, g)$ be a $C^2$ diffeomorphism relating flat space with anisotropic diffusion to a Riemannian manifold. If the Jacobian $d\\Psi$ and its inverse have bounded operator norms:\n646: \n647: $$\n648: \\|d\\Psi\\|_{\\text{op}}, \\|(d\\Psi)^{-1}\\|_{\\text{op}} \\le K\n649: $$\n650: \n651: and the push-forward relation holds:\n652: \n653: $$\n654: D_{\\text{flat}}(x) = (d\\Psi_x^{-1})^T g(\\Psi(x))^{-1} (d\\Psi_x^{-1})\n655: $$\n656: \n657: then:\n658: \n659: 1. **TV distances match exactly**: $\\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\mathcal{L}^{\\text{curved}}(Y_t) - \\pi^{\\text{curved}}\\|_{\\text{TV}}$\n660: \n661: 2. **Lyapunov drift inequalities are preserved up to condition-number factors**: If $\\mathbb{E}[\\Delta V_{\\text{flat}}(X)] \\le -\\kappa V_{\\text{flat}}(X) + C$, then with $V_{\\text{curved}} = V_{\\text{flat}} \\circ \\Psi^{-1}$:\n662: \n663: $$\n664: \\mathbb{E}[\\Delta V_{\\text{curved}}(Y)] \\le -\\kappa' V_{\\text{curved}}(Y) + C'\n665: $$\n666: \n667: where $\\kappa' \\asymp \\kappa/\\text{cond}(d\\Psi)^2$ and $C' \\asymp C \\cdot \\text{cond}(d\\Psi)^2$.\n668: "
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-372",
      "title": null,
      "start_line": 670,
      "end_line": 714,
      "header_lines": [],
      "content_start": 671,
      "content_end": 713,
      "content": "671: \n672: :::{prf:proof}\n673: **Key insight**: Convergence of a Markov process is an **intrinsic property** of the process itself, independent of the coordinate system used to describe it.\n674: \n675: **Step 1: Push-forward measure**\n676: \n677: The law of the process in flat coordinates, $\\mathcal{L}^{\\text{flat}}(X_t)$, is related to the law in manifold coordinates, $\\mathcal{L}^{\\text{curved}}(Y_t)$, by:\n678: \n679: $$\n680: \\mathcal{L}^{\\text{curved}}(Y_t) = \\Psi_* \\mathcal{L}^{\\text{flat}}(X_t)\n681: $$\n682: \n683: where $Y_t = \\Psi(X_t)$ and $\\Psi_*$ denotes push-forward.\n684: \n685: **Step 2: Total variation distance is preserved**\n686: \n687: For any measurable sets $A_{\\text{flat}} \\subset \\mathbb{R}^d$ and $A_{\\text{curved}} = \\Psi(A_{\\text{flat}}) \\subset M$:\n688: \n689: $$\n690: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\Psi_* \\mathcal{L}^{\\text{flat}}(X_t) - \\Psi_* \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\mathcal{L}^{\\text{curved}}(Y_t) - \\pi^{\\text{curved}}\\|_{\\text{TV}}\n691: $$\n692: \n693: where $\\pi^{\\text{curved}} = \\Psi_* \\pi^{\\text{flat}}$ is the push-forward stationary measure.\n694: \n695: **Step 3: TV convergence is exactly preserved**\n696: \n697: From geometric ergodicity in flat coordinates:\n698: \n699: $$\n700: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} \\le C_\\pi (1 - \\kappa_{\\text{total}})^t\n701: $$\n702: \n703: Since the left-hand side equals the total variation distance in curved coordinates (Step 2), TV convergence is preserved exactly.\n704: \n705: **Step 4: Lyapunov functions transform with condition-number factors**\n706: \n707: If $V_{\\text{flat}}(x)$ is a Lyapunov function satisfying $\\mathbb{E}[\\Delta V_{\\text{flat}}] \\le -\\kappa V_{\\text{flat}} + C$, then $V_{\\text{curved}}(y) = V_{\\text{flat}}(\\Psi^{-1}(y))$ satisfies the drift inequality in curved coordinates, but:\n708: \n709: - The generator involves $\\nabla V_{\\text{curved}} = (d\\Psi^{-1})^T \\nabla V_{\\text{flat}}$ and $\\nabla^2 V_{\\text{curved}}$ (chain rule)\n710: - These scale by $\\|d\\Psi\\|_{\\text{op}}$ and $\\|(d\\Psi)^{-1}\\|_{\\text{op}}$, introducing condition-number factors\n711: - Hence $\\kappa'$ and $C'$ scale with $\\text{cond}(d\\Psi)^2 = \\|d\\Psi\\|_{\\text{op}} \\cdot \\|(d\\Psi)^{-1}\\|_{\\text{op}}$\n712: \n713: **Conclusion**: Geometric ergodicity (qualitative property) is coordinate-invariant, but Lyapunov constants (quantitative) may change unless $\\Psi$ is an isometry.",
      "metadata": {},
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "670: :::\n671: \n672: :::{prf:proof}\n673: **Key insight**: Convergence of a Markov process is an **intrinsic property** of the process itself, independent of the coordinate system used to describe it.\n674: \n675: **Step 1: Push-forward measure**\n676: \n677: The law of the process in flat coordinates, $\\mathcal{L}^{\\text{flat}}(X_t)$, is related to the law in manifold coordinates, $\\mathcal{L}^{\\text{curved}}(Y_t)$, by:\n678: \n679: $$\n680: \\mathcal{L}^{\\text{curved}}(Y_t) = \\Psi_* \\mathcal{L}^{\\text{flat}}(X_t)\n681: $$\n682: \n683: where $Y_t = \\Psi(X_t)$ and $\\Psi_*$ denotes push-forward.\n684: \n685: **Step 2: Total variation distance is preserved**\n686: \n687: For any measurable sets $A_{\\text{flat}} \\subset \\mathbb{R}^d$ and $A_{\\text{curved}} = \\Psi(A_{\\text{flat}}) \\subset M$:\n688: \n689: $$\n690: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\Psi_* \\mathcal{L}^{\\text{flat}}(X_t) - \\Psi_* \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\mathcal{L}^{\\text{curved}}(Y_t) - \\pi^{\\text{curved}}\\|_{\\text{TV}}\n691: $$\n692: \n693: where $\\pi^{\\text{curved}} = \\Psi_* \\pi^{\\text{flat}}$ is the push-forward stationary measure.\n694: \n695: **Step 3: TV convergence is exactly preserved**\n696: \n697: From geometric ergodicity in flat coordinates:\n698: \n699: $$\n700: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} \\le C_\\pi (1 - \\kappa_{\\text{total}})^t\n701: $$\n702: \n703: Since the left-hand side equals the total variation distance in curved coordinates (Step 2), TV convergence is preserved exactly.\n704: \n705: **Step 4: Lyapunov functions transform with condition-number factors**\n706: \n707: If $V_{\\text{flat}}(x)$ is a Lyapunov function satisfying $\\mathbb{E}[\\Delta V_{\\text{flat}}] \\le -\\kappa V_{\\text{flat}} + C$, then $V_{\\text{curved}}(y) = V_{\\text{flat}}(\\Psi^{-1}(y))$ satisfies the drift inequality in curved coordinates, but:\n708: \n709: - The generator involves $\\nabla V_{\\text{curved}} = (d\\Psi^{-1})^T \\nabla V_{\\text{flat}}$ and $\\nabla^2 V_{\\text{curved}}$ (chain rule)\n710: - These scale by $\\|d\\Psi\\|_{\\text{op}}$ and $\\|(d\\Psi)^{-1}\\|_{\\text{op}}$, introducing condition-number factors\n711: - Hence $\\kappa'$ and $C'$ scale with $\\text{cond}(d\\Psi)^2 = \\|d\\Psi\\|_{\\text{op}} \\cdot \\|(d\\Psi)^{-1}\\|_{\\text{op}}$\n712: \n713: **Conclusion**: Geometric ergodicity (qualitative property) is coordinate-invariant, but Lyapunov constants (quantitative) may change unless $\\Psi$ is an isometry.\n714: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}