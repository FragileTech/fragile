{
  "chapter_index": 6,
  "section_id": "## 6. Operator Composition and Foster-Lyapunov Condition",
  "directive_count": 2,
  "hints": [
    {
      "directive_type": "theorem",
      "label": "thm-foster-lyapunov-adaptive",
      "title": "Foster-Lyapunov Condition for Geometric Gas",
      "start_line": 1935,
      "end_line": 1948,
      "header_lines": [
        1936
      ],
      "content_start": 1938,
      "content_end": 1947,
      "content": "1938: :label: thm-foster-lyapunov-adaptive\n1939: \n1940: There exist coupling constants $c_V, c_B > 0$ such that the total Lyapunov function $V_{\\text{total}} = c_V V_{\\text{inter}} + c_B W_b$ satisfies:\n1941: \n1942: $$\n1943: \\mathbb{E}[V_{\\text{total}}(S''_1, S''_2) \\mid S_1, S_2] \\le (1 - \\kappa_{\\text{total}}) V_{\\text{total}}(S_1, S_2) + C_{\\text{total}}\n1944: $$\n1945: \n1946: where $S' = \\Psi_{\\text{clone}}(S)$, $S'' = \\Psi_{\\text{kin}}(S')$, and:\n1947: - $\\kappa_{\\text{total}} = O(\\min\\{\\gamma \\tau, \\kappa_x, c_{\\min}\\}) > 0$",
      "metadata": {
        "label": "thm-foster-lyapunov-adaptive"
      },
      "section": "## 6. Operator Composition and Foster-Lyapunov Condition",
      "raw_directive": "1935: ### 6.2. Synergistic Composition\n1936: \n1937: :::{prf:theorem} Foster-Lyapunov Condition for Geometric Gas\n1938: :label: thm-foster-lyapunov-adaptive\n1939: \n1940: There exist coupling constants $c_V, c_B > 0$ such that the total Lyapunov function $V_{\\text{total}} = c_V V_{\\text{inter}} + c_B W_b$ satisfies:\n1941: \n1942: $$\n1943: \\mathbb{E}[V_{\\text{total}}(S''_1, S''_2) \\mid S_1, S_2] \\le (1 - \\kappa_{\\text{total}}) V_{\\text{total}}(S_1, S_2) + C_{\\text{total}}\n1944: $$\n1945: \n1946: where $S' = \\Psi_{\\text{clone}}(S)$, $S'' = \\Psi_{\\text{kin}}(S')$, and:\n1947: - $\\kappa_{\\text{total}} = O(\\min\\{\\gamma \\tau, \\kappa_x, c_{\\min}\\}) > 0$\n1948: - $C_{\\text{total}} < \\infty$"
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-33",
      "title": null,
      "start_line": 1950,
      "end_line": 2131,
      "header_lines": [
        2114
      ],
      "content_start": 1951,
      "content_end": 2130,
      "content": "1951: \n1952: :::{prf:proof}\n1953: This proof uses exact iterated expectations without first-order approximations.\n1954: \n1955: **Step 1: Notation and Tower Property**\n1956: \n1957: Let $S$ denote the initial coupled state $(S_1, S_2)$. The full update is:\n1958: \n1959: $$\n1960: S \\xrightarrow{\\Psi_{\\text{clone}}} S' \\xrightarrow{\\Psi_{\\text{kin}}} S''\n1961: $$\n1962: \n1963: By the tower property of conditional expectation:\n1964: \n1965: $$\n1966: \\mathbb{E}[V_{\\text{total}}(S'') \\mid S] = \\mathbb{E}[\\mathbb{E}[V_{\\text{total}}(S'') \\mid S'] \\mid S]\n1967: $$\n1968: \n1969: **Step 2: Kinetic Drift Inequalities (Inner Conditional Expectation)**\n1970: \n1971: From Chapter 3, for each component:\n1972: \n1973: $$\n1974: \\begin{aligned}\n1975: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S'] &\\le (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S') + C'_v \\tau \\\\\n1976: \\mathbb{E}[V_W(S'') \\mid S'] &\\le (1 - \\kappa'_W \\tau) V_W(S') + C'_W \\tau \\\\\n1977: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S'] &\\le V_{\\text{Var},x}(S') + C'_x \\tau \\\\\n1978: \\mathbb{E}[W_b(S'') \\mid S'] &\\le (1 - \\kappa'_b \\tau) W_b(S') + C'_b \\tau\n1979: \\end{aligned}\n1980: $$\n1981: \n1982: where $\\kappa'_W = O(\\min\\{\\gamma, c_{\\min}\\})$ and all constants are N-uniform.\n1983: \n1984: **Step 3: Cloning Drift Inequalities**\n1985: \n1986: From `../1_euclidean_gas/03_cloning.md`:\n1987: \n1988: $$\n1989: \\begin{aligned}\n1990: \\mathbb{E}[V_{\\text{Var},x}(S') \\mid S] &\\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + C_x \\\\\n1991: \\mathbb{E}[V_{\\text{Var},v}(S') \\mid S] &\\le V_{\\text{Var},v}(S) + C_v \\\\\n1992: \\mathbb{E}[V_W(S') \\mid S] &\\le V_W(S) + C_W \\\\\n1993: \\mathbb{E}[W_b(S') \\mid S] &\\le (1 - \\kappa_b) W_b(S) + C_b\n1994: \\end{aligned}\n1995: $$\n1996: \n1997: where $\\kappa_x, \\kappa_b > 0$ and all constants are N-uniform.\n1998: \n1999: **Step 4: Compose via Tower Property (Component-by-Component)**\n2000: \n2001: **For $V_{\\text{Var},v}$:**\n2002: \n2003: $$\n2004: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S] = \\mathbb{E}[\\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S'] \\mid S]\n2005: $$\n2006: \n2007: $$\n2008: \\le \\mathbb{E}[(1 - 2\\gamma \\tau) V_{\\text{Var},v}(S') + C'_v \\tau \\mid S]\n2009: $$\n2010: \n2011: $$\n2012: = (1 - 2\\gamma \\tau) \\mathbb{E}[V_{\\text{Var},v}(S') \\mid S] + C'_v \\tau\n2013: $$\n2014: \n2015: $$\n2016: \\le (1 - 2\\gamma \\tau) [V_{\\text{Var},v}(S) + C_v] + C'_v \\tau\n2017: $$\n2018: \n2019: $$\n2020: = (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S) + [(1 - 2\\gamma \\tau) C_v + C'_v \\tau]\n2021: $$\n2022: \n2023: **For $V_W$:**\n2024: \n2025: $$\n2026: \\mathbb{E}[V_W(S'') \\mid S] \\le (1 - \\kappa'_W \\tau) \\mathbb{E}[V_W(S') \\mid S] + C'_W \\tau\n2027: $$\n2028: \n2029: $$\n2030: \\le (1 - \\kappa'_W \\tau) [V_W(S) + C_W] + C'_W \\tau\n2031: $$\n2032: \n2033: $$\n2034: = (1 - \\kappa'_W \\tau) V_W(S) + [(1 - \\kappa'_W \\tau) C_W + C'_W \\tau]\n2035: $$\n2036: \n2037: **For $V_{\\text{Var},x}$:**\n2038: \n2039: $$\n2040: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S] \\le \\mathbb{E}[V_{\\text{Var},x}(S') + C'_x \\tau \\mid S]\n2041: $$\n2042: \n2043: $$\n2044: = \\mathbb{E}[V_{\\text{Var},x}(S') \\mid S] + C'_x \\tau\n2045: $$\n2046: \n2047: $$\n2048: \\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + C_x + C'_x \\tau\n2049: $$\n2050: \n2051: **For $W_b$:**\n2052: \n2053: $$\n2054: \\mathbb{E}[W_b(S'') \\mid S] \\le (1 - \\kappa'_b \\tau) \\mathbb{E}[W_b(S') \\mid S] + C'_b \\tau\n2055: $$\n2056: \n2057: $$\n2058: \\le (1 - \\kappa'_b \\tau) [(1 - \\kappa_b) W_b(S) + C_b] + C'_b \\tau\n2059: $$\n2060: \n2061: $$\n2062: = (1 - \\kappa'_b \\tau)(1 - \\kappa_b) W_b(S) + [(1 - \\kappa'_b \\tau) C_b + C'_b \\tau]\n2063: $$\n2064: \n2065: $$\n2066: = [1 - (\\kappa'_b \\tau + \\kappa_b) + \\kappa'_b \\tau \\kappa_b] W_b(S) + C_b^{\\text{total}}\n2067: $$\n2068: \n2069: **Step 5: Construct Total Lyapunov Function**\n2070: \n2071: Define $V_{\\text{inter}} = V_W + V_{\\text{Var},x} + V_{\\text{Var},v}$ and $V_{\\text{total}} = c_V V_{\\text{inter}} + c_B W_b$ with coupling constants $c_V, c_B > 0$ to be chosen.\n2072: \n2073: From Step 4:\n2074: \n2075: $$\n2076: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S] \\le (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S) + \\bar{C}_v\n2077: $$\n2078: \n2079: $$\n2080: \\mathbb{E}[V_W(S'') \\mid S] \\le (1 - \\kappa'_W \\tau) V_W(S) + \\bar{C}_W\n2081: $$\n2082: \n2083: $$\n2084: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S] \\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + \\bar{C}_x\n2085: $$\n2086: \n2087: where $\\bar{C}_v, \\bar{C}_W, \\bar{C}_x < \\infty$ are the combined constants.\n2088: \n2089: **Step 6: Determine Effective Rates**\n2090: \n2091: For $V_{\\text{inter}}$, the **worst-case** (smallest) contraction rate among the three components determines convergence. However, we must account for the fact that cloning does not contract $V_W$ or $V_{\\text{Var},v}$ (only expands by bounded $C$), while kinetics do contract these.\n2092: \n2093: The effective rate for $V_{\\text{inter}}$ is determined by balancing:\n2094: - Kinetic contraction of $V_W, V_{\\text{Var},v}$: rates $\\kappa'_W \\tau, 2\\gamma\\tau$\n2095: - Cloning contraction of $V_{\\text{Var},x}$: rate $\\kappa_x$\n2096: \n2097: Choose coupling constants such that:\n2098: \n2099: $$\n2100: c_V = 1, \\quad c_B \\ge \\max\\left\\{ \\frac{C_x + C'_x \\tau}{\\kappa_b}, \\frac{\\bar{C}_v + \\bar{C}_W}{\\kappa'_b \\tau} \\right\\}\n2101: $$\n2102: \n2103: This ensures the boundary contraction dominates its expansion constants.\n2104: \n2105: **Step 7: Second-Order Term Analysis**\n2106: \n2107: The composition of boundary contraction rates yields (from Step 4):\n2108: \n2109: $$\n2110: 1 - (\\kappa'_b \\tau + \\kappa_b) + \\kappa_b \\kappa'_b \\tau = 1 - \\kappa_b - \\kappa'_b \\tau (1 - \\kappa_b)\n2111: $$\n2112: \n2113: The **second-order term** $\\kappa_b \\kappa'_b \\tau$ has a **positive** contribution to the coefficient (reduces the total contraction rate). However, this is actually **expected and correct** for composition of contractive operators:\n2114: \n2115: :::{admonition} Why the Second-Order Term Matters\n2116: :class: note\n2117: \n2118: When two contractive operators are composed, the total contraction is:\n2119: \n2120: $$\n2121: (1 - \\kappa_1)(1 - \\kappa_2) = 1 - \\kappa_1 - \\kappa_2 + \\kappa_1 \\kappa_2\n2122: $$\n2123: \n2124: The cross term $\\kappa_1 \\kappa_2 > 0$ represents **diminishing returns**: contracting an already-contracted state provides less absolute improvement.\n2125: \n2126: **Key insight**: Despite this diminishing return, the effective rate is still:\n2127: \n2128: $$\n2129: \\kappa_{\\text{eff}} = \\kappa_1 + \\kappa_2 - \\kappa_1 \\kappa_2 = \\kappa_1 + \\kappa_2 (1 - \\kappa_1)\n2130: $$",
      "metadata": {
        "class": "note"
      },
      "section": "## 6. Operator Composition and Foster-Lyapunov Condition",
      "raw_directive": "1950: :::\n1951: \n1952: :::{prf:proof}\n1953: This proof uses exact iterated expectations without first-order approximations.\n1954: \n1955: **Step 1: Notation and Tower Property**\n1956: \n1957: Let $S$ denote the initial coupled state $(S_1, S_2)$. The full update is:\n1958: \n1959: $$\n1960: S \\xrightarrow{\\Psi_{\\text{clone}}} S' \\xrightarrow{\\Psi_{\\text{kin}}} S''\n1961: $$\n1962: \n1963: By the tower property of conditional expectation:\n1964: \n1965: $$\n1966: \\mathbb{E}[V_{\\text{total}}(S'') \\mid S] = \\mathbb{E}[\\mathbb{E}[V_{\\text{total}}(S'') \\mid S'] \\mid S]\n1967: $$\n1968: \n1969: **Step 2: Kinetic Drift Inequalities (Inner Conditional Expectation)**\n1970: \n1971: From Chapter 3, for each component:\n1972: \n1973: $$\n1974: \\begin{aligned}\n1975: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S'] &\\le (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S') + C'_v \\tau \\\\\n1976: \\mathbb{E}[V_W(S'') \\mid S'] &\\le (1 - \\kappa'_W \\tau) V_W(S') + C'_W \\tau \\\\\n1977: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S'] &\\le V_{\\text{Var},x}(S') + C'_x \\tau \\\\\n1978: \\mathbb{E}[W_b(S'') \\mid S'] &\\le (1 - \\kappa'_b \\tau) W_b(S') + C'_b \\tau\n1979: \\end{aligned}\n1980: $$\n1981: \n1982: where $\\kappa'_W = O(\\min\\{\\gamma, c_{\\min}\\})$ and all constants are N-uniform.\n1983: \n1984: **Step 3: Cloning Drift Inequalities**\n1985: \n1986: From `../1_euclidean_gas/03_cloning.md`:\n1987: \n1988: $$\n1989: \\begin{aligned}\n1990: \\mathbb{E}[V_{\\text{Var},x}(S') \\mid S] &\\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + C_x \\\\\n1991: \\mathbb{E}[V_{\\text{Var},v}(S') \\mid S] &\\le V_{\\text{Var},v}(S) + C_v \\\\\n1992: \\mathbb{E}[V_W(S') \\mid S] &\\le V_W(S) + C_W \\\\\n1993: \\mathbb{E}[W_b(S') \\mid S] &\\le (1 - \\kappa_b) W_b(S) + C_b\n1994: \\end{aligned}\n1995: $$\n1996: \n1997: where $\\kappa_x, \\kappa_b > 0$ and all constants are N-uniform.\n1998: \n1999: **Step 4: Compose via Tower Property (Component-by-Component)**\n2000: \n2001: **For $V_{\\text{Var},v}$:**\n2002: \n2003: $$\n2004: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S] = \\mathbb{E}[\\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S'] \\mid S]\n2005: $$\n2006: \n2007: $$\n2008: \\le \\mathbb{E}[(1 - 2\\gamma \\tau) V_{\\text{Var},v}(S') + C'_v \\tau \\mid S]\n2009: $$\n2010: \n2011: $$\n2012: = (1 - 2\\gamma \\tau) \\mathbb{E}[V_{\\text{Var},v}(S') \\mid S] + C'_v \\tau\n2013: $$\n2014: \n2015: $$\n2016: \\le (1 - 2\\gamma \\tau) [V_{\\text{Var},v}(S) + C_v] + C'_v \\tau\n2017: $$\n2018: \n2019: $$\n2020: = (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S) + [(1 - 2\\gamma \\tau) C_v + C'_v \\tau]\n2021: $$\n2022: \n2023: **For $V_W$:**\n2024: \n2025: $$\n2026: \\mathbb{E}[V_W(S'') \\mid S] \\le (1 - \\kappa'_W \\tau) \\mathbb{E}[V_W(S') \\mid S] + C'_W \\tau\n2027: $$\n2028: \n2029: $$\n2030: \\le (1 - \\kappa'_W \\tau) [V_W(S) + C_W] + C'_W \\tau\n2031: $$\n2032: \n2033: $$\n2034: = (1 - \\kappa'_W \\tau) V_W(S) + [(1 - \\kappa'_W \\tau) C_W + C'_W \\tau]\n2035: $$\n2036: \n2037: **For $V_{\\text{Var},x}$:**\n2038: \n2039: $$\n2040: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S] \\le \\mathbb{E}[V_{\\text{Var},x}(S') + C'_x \\tau \\mid S]\n2041: $$\n2042: \n2043: $$\n2044: = \\mathbb{E}[V_{\\text{Var},x}(S') \\mid S] + C'_x \\tau\n2045: $$\n2046: \n2047: $$\n2048: \\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + C_x + C'_x \\tau\n2049: $$\n2050: \n2051: **For $W_b$:**\n2052: \n2053: $$\n2054: \\mathbb{E}[W_b(S'') \\mid S] \\le (1 - \\kappa'_b \\tau) \\mathbb{E}[W_b(S') \\mid S] + C'_b \\tau\n2055: $$\n2056: \n2057: $$\n2058: \\le (1 - \\kappa'_b \\tau) [(1 - \\kappa_b) W_b(S) + C_b] + C'_b \\tau\n2059: $$\n2060: \n2061: $$\n2062: = (1 - \\kappa'_b \\tau)(1 - \\kappa_b) W_b(S) + [(1 - \\kappa'_b \\tau) C_b + C'_b \\tau]\n2063: $$\n2064: \n2065: $$\n2066: = [1 - (\\kappa'_b \\tau + \\kappa_b) + \\kappa'_b \\tau \\kappa_b] W_b(S) + C_b^{\\text{total}}\n2067: $$\n2068: \n2069: **Step 5: Construct Total Lyapunov Function**\n2070: \n2071: Define $V_{\\text{inter}} = V_W + V_{\\text{Var},x} + V_{\\text{Var},v}$ and $V_{\\text{total}} = c_V V_{\\text{inter}} + c_B W_b$ with coupling constants $c_V, c_B > 0$ to be chosen.\n2072: \n2073: From Step 4:\n2074: \n2075: $$\n2076: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S] \\le (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S) + \\bar{C}_v\n2077: $$\n2078: \n2079: $$\n2080: \\mathbb{E}[V_W(S'') \\mid S] \\le (1 - \\kappa'_W \\tau) V_W(S) + \\bar{C}_W\n2081: $$\n2082: \n2083: $$\n2084: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S] \\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + \\bar{C}_x\n2085: $$\n2086: \n2087: where $\\bar{C}_v, \\bar{C}_W, \\bar{C}_x < \\infty$ are the combined constants.\n2088: \n2089: **Step 6: Determine Effective Rates**\n2090: \n2091: For $V_{\\text{inter}}$, the **worst-case** (smallest) contraction rate among the three components determines convergence. However, we must account for the fact that cloning does not contract $V_W$ or $V_{\\text{Var},v}$ (only expands by bounded $C$), while kinetics do contract these.\n2092: \n2093: The effective rate for $V_{\\text{inter}}$ is determined by balancing:\n2094: - Kinetic contraction of $V_W, V_{\\text{Var},v}$: rates $\\kappa'_W \\tau, 2\\gamma\\tau$\n2095: - Cloning contraction of $V_{\\text{Var},x}$: rate $\\kappa_x$\n2096: \n2097: Choose coupling constants such that:\n2098: \n2099: $$\n2100: c_V = 1, \\quad c_B \\ge \\max\\left\\{ \\frac{C_x + C'_x \\tau}{\\kappa_b}, \\frac{\\bar{C}_v + \\bar{C}_W}{\\kappa'_b \\tau} \\right\\}\n2101: $$\n2102: \n2103: This ensures the boundary contraction dominates its expansion constants.\n2104: \n2105: **Step 7: Second-Order Term Analysis**\n2106: \n2107: The composition of boundary contraction rates yields (from Step 4):\n2108: \n2109: $$\n2110: 1 - (\\kappa'_b \\tau + \\kappa_b) + \\kappa_b \\kappa'_b \\tau = 1 - \\kappa_b - \\kappa'_b \\tau (1 - \\kappa_b)\n2111: $$\n2112: \n2113: The **second-order term** $\\kappa_b \\kappa'_b \\tau$ has a **positive** contribution to the coefficient (reduces the total contraction rate). However, this is actually **expected and correct** for composition of contractive operators:\n2114: \n2115: :::{admonition} Why the Second-Order Term Matters\n2116: :class: note\n2117: \n2118: When two contractive operators are composed, the total contraction is:\n2119: \n2120: $$\n2121: (1 - \\kappa_1)(1 - \\kappa_2) = 1 - \\kappa_1 - \\kappa_2 + \\kappa_1 \\kappa_2\n2122: $$\n2123: \n2124: The cross term $\\kappa_1 \\kappa_2 > 0$ represents **diminishing returns**: contracting an already-contracted state provides less absolute improvement.\n2125: \n2126: **Key insight**: Despite this diminishing return, the effective rate is still:\n2127: \n2128: $$\n2129: \\kappa_{\\text{eff}} = \\kappa_1 + \\kappa_2 - \\kappa_1 \\kappa_2 = \\kappa_1 + \\kappa_2 (1 - \\kappa_1)\n2130: $$\n2131: "
    }
  ],
  "validation": {
    "ok": true,
    "errors": []
  }
}