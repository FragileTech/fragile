{
  "document_id": "18_emergent_geometry",
  "stage": "directives",
  "directive_type": "proof",
  "generated_at": "2025-11-10T13:57:32.853961+00:00",
  "count": 20,
  "items": [
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-128",
      "title": null,
      "start_line": 426,
      "end_line": 510,
      "header_lines": [],
      "content_start": 427,
      "content_end": 509,
      "content": "427: \n428: :::{prf:proof}\n429: We prove Lipschitz continuity with an N-uniform constant $L_\\Sigma$.\n430: \n431: **Step 1: Structure of the fitness potential**\n432: \n433: For typical fitness potentials (e.g., kernel density estimates, pair potentials), the fitness has the structure:\n434: \n435: $$\n436: V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{i,j} \\phi(x_i, x_j)\n437: $$\n438: \n439: where $\\phi: \\mathcal{X} \\times \\mathcal{X} \\to \\mathbb{R}$ is a smooth, bounded interaction kernel. The Hessian with respect to walker $i$'s position is:\n440: \n441: $$\n442: H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{j=1}^N \\nabla^2_{x_i} \\phi(x_i, x_j)\n443: $$\n444: \n445: The $1/N$ normalization is critical for N-uniformity.\n446: \n447: **Step 2: Lipschitz continuity of the Hessian**\n448: \n449: Since $\\phi$ is smooth with bounded third derivatives (Assumption on $V_{\\text{fit}}$), the Hessian is Lipschitz:\n450: \n451: $$\n452: \\|H_i(S_1) - H_i(S_2)\\|_F \\le \\frac{1}{N} \\sum_{j=1}^N \\|\\nabla^2_{x_i} \\phi(x_{1,i}, x_{1,j}) - \\nabla^2_{x_i} \\phi(x_{2,i}, x_{2,j})\\|_F\n453: $$\n454: \n455: $$\n456: \\le \\frac{1}{N} \\sum_{j=1}^N L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n457: $$\n458: \n459: $$\n460: \\le L_{\\phi}^{(3)} \\cdot \\frac{1}{N} \\sum_{j=1}^N (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n461: $$\n462: \n463: $$\n464: = L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|)\n465: $$\n466: \n467: Define the state-space metric:\n468: \n469: $$\n470: d_{\\text{state}}((x_i, S_1), (x_i, S_2)) = \\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|\n471: $$\n472: \n473: Then $\\|H_i(S_1) - H_i(S_2)\\|_F \\le L_H \\cdot d_{\\text{state}}$ where $L_H = L_{\\phi}^{(3)}$ is **independent of $N$**.\n474: \n475: **Step 3: Lipschitz continuity of the matrix square root**\n476: \n477: The map $f(A) = (A + \\epsilon_\\Sigma I)^{-1/2}$ is Lipschitz on the set of symmetric matrices with eigenvalues in $[\\epsilon_\\Sigma - \\Lambda_-, H_{\\max} + \\epsilon_\\Sigma]$.\n478: \n479: For symmetric matrices $A, B$ in this set, by standard matrix perturbation theory (Bhatia, Matrix Analysis, Theorem VII.1.8):\n480: \n481: $$\n482: \\|f(A) - f(B)\\|_F \\le K_{\\text{sqrt}}(\\epsilon_\\Sigma, H_{\\max}) \\|A - B\\|_F\n483: $$\n484: \n485: where $K_{\\text{sqrt}}$ depends only on the ellipticity bounds, not on $N$.\n486: \n487: **Step 4: Composition**\n488: \n489: By the chain rule for Lipschitz functions:\n490: \n491: $$\n492: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F = \\|f(H_i(S_1)) - f(H_i(S_2))\\|_F\n493: $$\n494: \n495: $$\n496: \\le K_{\\text{sqrt}} \\|H_i(S_1) - H_i(S_2)\\|_F\n497: $$\n498: \n499: $$\n500: \\le K_{\\text{sqrt}} \\cdot L_H \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n501: $$\n502: \n503: Setting $L_\\Sigma = K_{\\text{sqrt}} \\cdot L_H$, we have:\n504: \n505: $$\n506: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F \\le L_\\Sigma \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n507: $$\n508: \n509: where $L_\\Sigma$ is **independent of $N$** by construction.",
      "metadata": {},
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "426: :::\n427: \n428: :::{prf:proof}\n429: We prove Lipschitz continuity with an N-uniform constant $L_\\Sigma$.\n430: \n431: **Step 1: Structure of the fitness potential**\n432: \n433: For typical fitness potentials (e.g., kernel density estimates, pair potentials), the fitness has the structure:\n434: \n435: $$\n436: V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{i,j} \\phi(x_i, x_j)\n437: $$\n438: \n439: where $\\phi: \\mathcal{X} \\times \\mathcal{X} \\to \\mathbb{R}$ is a smooth, bounded interaction kernel. The Hessian with respect to walker $i$'s position is:\n440: \n441: $$\n442: H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S) = \\frac{1}{N} \\sum_{j=1}^N \\nabla^2_{x_i} \\phi(x_i, x_j)\n443: $$\n444: \n445: The $1/N$ normalization is critical for N-uniformity.\n446: \n447: **Step 2: Lipschitz continuity of the Hessian**\n448: \n449: Since $\\phi$ is smooth with bounded third derivatives (Assumption on $V_{\\text{fit}}$), the Hessian is Lipschitz:\n450: \n451: $$\n452: \\|H_i(S_1) - H_i(S_2)\\|_F \\le \\frac{1}{N} \\sum_{j=1}^N \\|\\nabla^2_{x_i} \\phi(x_{1,i}, x_{1,j}) - \\nabla^2_{x_i} \\phi(x_{2,i}, x_{2,j})\\|_F\n453: $$\n454: \n455: $$\n456: \\le \\frac{1}{N} \\sum_{j=1}^N L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n457: $$\n458: \n459: $$\n460: \\le L_{\\phi}^{(3)} \\cdot \\frac{1}{N} \\sum_{j=1}^N (\\|x_{1,i} - x_{2,i}\\| + \\|x_{1,j} - x_{2,j}\\|)\n461: $$\n462: \n463: $$\n464: = L_{\\phi}^{(3)} (\\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|)\n465: $$\n466: \n467: Define the state-space metric:\n468: \n469: $$\n470: d_{\\text{state}}((x_i, S_1), (x_i, S_2)) = \\|x_{1,i} - x_{2,i}\\| + \\frac{1}{N}\\sum_{j=1}^N \\|x_{1,j} - x_{2,j}\\|\n471: $$\n472: \n473: Then $\\|H_i(S_1) - H_i(S_2)\\|_F \\le L_H \\cdot d_{\\text{state}}$ where $L_H = L_{\\phi}^{(3)}$ is **independent of $N$**.\n474: \n475: **Step 3: Lipschitz continuity of the matrix square root**\n476: \n477: The map $f(A) = (A + \\epsilon_\\Sigma I)^{-1/2}$ is Lipschitz on the set of symmetric matrices with eigenvalues in $[\\epsilon_\\Sigma - \\Lambda_-, H_{\\max} + \\epsilon_\\Sigma]$.\n478: \n479: For symmetric matrices $A, B$ in this set, by standard matrix perturbation theory (Bhatia, Matrix Analysis, Theorem VII.1.8):\n480: \n481: $$\n482: \\|f(A) - f(B)\\|_F \\le K_{\\text{sqrt}}(\\epsilon_\\Sigma, H_{\\max}) \\|A - B\\|_F\n483: $$\n484: \n485: where $K_{\\text{sqrt}}$ depends only on the ellipticity bounds, not on $N$.\n486: \n487: **Step 4: Composition**\n488: \n489: By the chain rule for Lipschitz functions:\n490: \n491: $$\n492: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F = \\|f(H_i(S_1)) - f(H_i(S_2))\\|_F\n493: $$\n494: \n495: $$\n496: \\le K_{\\text{sqrt}} \\|H_i(S_1) - H_i(S_2)\\|_F\n497: $$\n498: \n499: $$\n500: \\le K_{\\text{sqrt}} \\cdot L_H \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n501: $$\n502: \n503: Setting $L_\\Sigma = K_{\\text{sqrt}} \\cdot L_H$, we have:\n504: \n505: $$\n506: \\|\\Sigma_{\\text{reg}}(x_1, S_1) - \\Sigma_{\\text{reg}}(x_2, S_2)\\|_F \\le L_\\Sigma \\cdot d_{\\text{state}}((x_i, S_1), (x_i, S_2))\n507: $$\n508: \n509: where $L_\\Sigma$ is **independent of $N$** by construction.\n510: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. The Emergent Geometry Framework"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-372",
      "title": null,
      "start_line": 670,
      "end_line": 714,
      "header_lines": [],
      "content_start": 671,
      "content_end": 713,
      "content": "671: \n672: :::{prf:proof}\n673: **Key insight**: Convergence of a Markov process is an **intrinsic property** of the process itself, independent of the coordinate system used to describe it.\n674: \n675: **Step 1: Push-forward measure**\n676: \n677: The law of the process in flat coordinates, $\\mathcal{L}^{\\text{flat}}(X_t)$, is related to the law in manifold coordinates, $\\mathcal{L}^{\\text{curved}}(Y_t)$, by:\n678: \n679: $$\n680: \\mathcal{L}^{\\text{curved}}(Y_t) = \\Psi_* \\mathcal{L}^{\\text{flat}}(X_t)\n681: $$\n682: \n683: where $Y_t = \\Psi(X_t)$ and $\\Psi_*$ denotes push-forward.\n684: \n685: **Step 2: Total variation distance is preserved**\n686: \n687: For any measurable sets $A_{\\text{flat}} \\subset \\mathbb{R}^d$ and $A_{\\text{curved}} = \\Psi(A_{\\text{flat}}) \\subset M$:\n688: \n689: $$\n690: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\Psi_* \\mathcal{L}^{\\text{flat}}(X_t) - \\Psi_* \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\mathcal{L}^{\\text{curved}}(Y_t) - \\pi^{\\text{curved}}\\|_{\\text{TV}}\n691: $$\n692: \n693: where $\\pi^{\\text{curved}} = \\Psi_* \\pi^{\\text{flat}}$ is the push-forward stationary measure.\n694: \n695: **Step 3: TV convergence is exactly preserved**\n696: \n697: From geometric ergodicity in flat coordinates:\n698: \n699: $$\n700: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} \\le C_\\pi (1 - \\kappa_{\\text{total}})^t\n701: $$\n702: \n703: Since the left-hand side equals the total variation distance in curved coordinates (Step 2), TV convergence is preserved exactly.\n704: \n705: **Step 4: Lyapunov functions transform with condition-number factors**\n706: \n707: If $V_{\\text{flat}}(x)$ is a Lyapunov function satisfying $\\mathbb{E}[\\Delta V_{\\text{flat}}] \\le -\\kappa V_{\\text{flat}} + C$, then $V_{\\text{curved}}(y) = V_{\\text{flat}}(\\Psi^{-1}(y))$ satisfies the drift inequality in curved coordinates, but:\n708: \n709: - The generator involves $\\nabla V_{\\text{curved}} = (d\\Psi^{-1})^T \\nabla V_{\\text{flat}}$ and $\\nabla^2 V_{\\text{curved}}$ (chain rule)\n710: - These scale by $\\|d\\Psi\\|_{\\text{op}}$ and $\\|(d\\Psi)^{-1}\\|_{\\text{op}}$, introducing condition-number factors\n711: - Hence $\\kappa'$ and $C'$ scale with $\\text{cond}(d\\Psi)^2 = \\|d\\Psi\\|_{\\text{op}} \\cdot \\|(d\\Psi)^{-1}\\|_{\\text{op}}$\n712: \n713: **Conclusion**: Geometric ergodicity (qualitative property) is coordinate-invariant, but Lyapunov constants (quantitative) may change unless $\\Psi$ is an isometry.",
      "metadata": {},
      "section": "## 3. The Emergent Geometry Framework",
      "references": [],
      "raw_directive": "670: :::\n671: \n672: :::{prf:proof}\n673: **Key insight**: Convergence of a Markov process is an **intrinsic property** of the process itself, independent of the coordinate system used to describe it.\n674: \n675: **Step 1: Push-forward measure**\n676: \n677: The law of the process in flat coordinates, $\\mathcal{L}^{\\text{flat}}(X_t)$, is related to the law in manifold coordinates, $\\mathcal{L}^{\\text{curved}}(Y_t)$, by:\n678: \n679: $$\n680: \\mathcal{L}^{\\text{curved}}(Y_t) = \\Psi_* \\mathcal{L}^{\\text{flat}}(X_t)\n681: $$\n682: \n683: where $Y_t = \\Psi(X_t)$ and $\\Psi_*$ denotes push-forward.\n684: \n685: **Step 2: Total variation distance is preserved**\n686: \n687: For any measurable sets $A_{\\text{flat}} \\subset \\mathbb{R}^d$ and $A_{\\text{curved}} = \\Psi(A_{\\text{flat}}) \\subset M$:\n688: \n689: $$\n690: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\Psi_* \\mathcal{L}^{\\text{flat}}(X_t) - \\Psi_* \\pi^{\\text{flat}}\\|_{\\text{TV}} = \\|\\mathcal{L}^{\\text{curved}}(Y_t) - \\pi^{\\text{curved}}\\|_{\\text{TV}}\n691: $$\n692: \n693: where $\\pi^{\\text{curved}} = \\Psi_* \\pi^{\\text{flat}}$ is the push-forward stationary measure.\n694: \n695: **Step 3: TV convergence is exactly preserved**\n696: \n697: From geometric ergodicity in flat coordinates:\n698: \n699: $$\n700: \\|\\mathcal{L}^{\\text{flat}}(X_t) - \\pi^{\\text{flat}}\\|_{\\text{TV}} \\le C_\\pi (1 - \\kappa_{\\text{total}})^t\n701: $$\n702: \n703: Since the left-hand side equals the total variation distance in curved coordinates (Step 2), TV convergence is preserved exactly.\n704: \n705: **Step 4: Lyapunov functions transform with condition-number factors**\n706: \n707: If $V_{\\text{flat}}(x)$ is a Lyapunov function satisfying $\\mathbb{E}[\\Delta V_{\\text{flat}}] \\le -\\kappa V_{\\text{flat}} + C$, then $V_{\\text{curved}}(y) = V_{\\text{flat}}(\\Psi^{-1}(y))$ satisfies the drift inequality in curved coordinates, but:\n708: \n709: - The generator involves $\\nabla V_{\\text{curved}} = (d\\Psi^{-1})^T \\nabla V_{\\text{flat}}$ and $\\nabla^2 V_{\\text{curved}}$ (chain rule)\n710: - These scale by $\\|d\\Psi\\|_{\\text{op}}$ and $\\|(d\\Psi)^{-1}\\|_{\\text{op}}$, introducing condition-number factors\n711: - Hence $\\kappa'$ and $C'$ scale with $\\text{cond}(d\\Psi)^2 = \\|d\\Psi\\|_{\\text{op}} \\cdot \\|(d\\Psi)^{-1}\\|_{\\text{op}}$\n712: \n713: **Conclusion**: Geometric ergodicity (qualitative property) is coordinate-invariant, but Lyapunov constants (quantitative) may change unless $\\Psi$ is an isometry.\n714: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 3,
        "chapter_file": "chapter_3.json",
        "section_id": "## 3. The Emergent Geometry Framework"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-31",
      "title": null,
      "start_line": 967,
      "end_line": 1009,
      "header_lines": [],
      "content_start": 968,
      "content_end": 1008,
      "content": "968: \n969: :::{prf:proof}\n970: **Step 1: Structure of the correction term**\n971: \n972: By definition of the Stratonovich-to-Itô conversion for the SDE $dv = \\ldots + \\Sigma_{\\text{reg}}(x,S) \\circ dW$, the correction is:\n973: \n974: $$\n975: b_{\\text{correction}} = \\frac{1}{2}\\sum_{j=1}^d (D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}) \\Sigma_{\\text{reg}}^{(\\cdot,j)}\n976: $$\n977: \n978: **Step 2: Bound on each term**\n979: \n980: For each $j \\in \\{1,\\ldots,d\\}$:\n981: \n982: $$\n983: \\|(D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\| \\le \\|D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|_{\\text{op}} \\cdot \\|\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|\n984: $$\n985: \n986: The Jacobian operator norm is bounded by $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$, and the column norm is bounded by $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}} \\le c_{\\max}^{1/2}$ (from uniform ellipticity).\n987: \n988: **Step 3: Sum over dimensions**\n989: \n990: $$\n991: \\|b_{\\text{correction}}\\| \\le \\sum_{j=1}^d \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2} \\le d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n992: $$\n993: \n994: Multiplying by $1/2$ gives the claimed bound.\n995: \n996: **Step 4: N-uniformity**\n997: \n998: The diffusion tensor $\\Sigma_{\\text{reg}}(x_i, S)$ depends on:\n999: 1. The walker's own position $x_i$\n1000: 2. The Hessian $H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$\n1001: \n1002: For typical fitness potentials (e.g., $V_{\\text{fit}}(S) = \\frac{1}{N}\\sum_{i,j} V_{\\text{pair}}(x_i, x_j)$), the Hessian has the structure:\n1003: \n1004: $$\n1005: H_i(S) = \\frac{1}{N} \\sum_{j \\neq i} \\nabla^2 V_{\\text{pair}}(x_i, x_j)\n1006: $$\n1007: \n1008: The gradient of $\\Sigma_{\\text{reg}}$ with respect to $x_i$ involves third derivatives of $V_{\\text{pair}}$, averaged over $N$ pairs. The $1/N$ normalization in $V_{\\text{fit}}$ ensures that $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is **independent of $N$**.",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "references": [],
      "raw_directive": "967: :::\n968: \n969: :::{prf:proof}\n970: **Step 1: Structure of the correction term**\n971: \n972: By definition of the Stratonovich-to-Itô conversion for the SDE $dv = \\ldots + \\Sigma_{\\text{reg}}(x,S) \\circ dW$, the correction is:\n973: \n974: $$\n975: b_{\\text{correction}} = \\frac{1}{2}\\sum_{j=1}^d (D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}) \\Sigma_{\\text{reg}}^{(\\cdot,j)}\n976: $$\n977: \n978: **Step 2: Bound on each term**\n979: \n980: For each $j \\in \\{1,\\ldots,d\\}$:\n981: \n982: $$\n983: \\|(D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)) \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\| \\le \\|D_x \\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|_{\\text{op}} \\cdot \\|\\Sigma_{\\text{reg}}^{(\\cdot,j)}(x,S)\\|\n984: $$\n985: \n986: The Jacobian operator norm is bounded by $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$, and the column norm is bounded by $\\|\\Sigma_{\\text{reg}}\\|_{\\text{op}} \\le c_{\\max}^{1/2}$ (from uniform ellipticity).\n987: \n988: **Step 3: Sum over dimensions**\n989: \n990: $$\n991: \\|b_{\\text{correction}}\\| \\le \\sum_{j=1}^d \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2} \\le d \\cdot \\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty \\cdot c_{\\max}^{1/2}\n992: $$\n993: \n994: Multiplying by $1/2$ gives the claimed bound.\n995: \n996: **Step 4: N-uniformity**\n997: \n998: The diffusion tensor $\\Sigma_{\\text{reg}}(x_i, S)$ depends on:\n999: 1. The walker's own position $x_i$\n1000: 2. The Hessian $H_i(S) = \\nabla^2_{x_i} V_{\\text{fit}}(S)$\n1001: \n1002: For typical fitness potentials (e.g., $V_{\\text{fit}}(S) = \\frac{1}{N}\\sum_{i,j} V_{\\text{pair}}(x_i, x_j)$), the Hessian has the structure:\n1003: \n1004: $$\n1005: H_i(S) = \\frac{1}{N} \\sum_{j \\neq i} \\nabla^2 V_{\\text{pair}}(x_i, x_j)\n1006: $$\n1007: \n1008: The gradient of $\\Sigma_{\\text{reg}}$ with respect to $x_i$ involves third derivatives of $V_{\\text{pair}}$, averaged over $N$ pairs. The $1/N$ normalization in $V_{\\text{fit}}$ ensures that $\\|\\nabla_x \\Sigma_{\\text{reg}}\\|_\\infty$ is **independent of $N$**.\n1009: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Anisotropic Kinetic Operator Analysis"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-115",
      "title": null,
      "start_line": 1051,
      "end_line": 1200,
      "header_lines": [],
      "content_start": 1052,
      "content_end": 1199,
      "content": "1052: \n1053: :::{prf:proof}\n1054: We analyze the generator $\\mathcal{L}$ acting on the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$ where:\n1055: \n1056: $$\n1057: V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i: s_{k,i}=1} \\|v_{k,i} - \\bar{v}_k\\|^2\n1058: $$\n1059: \n1060: (normalized by total swarm size $N$, consistent with position variance)\n1061: \n1062: **Step 1: Generator for a Single Swarm**\n1063: \n1064: For swarm $S_k$ evolving under the kinetic SDE (Stratonovich form):\n1065: \n1066: $$\n1067: \\begin{aligned}\n1068: dx_{k,i} &= v_{k,i} \\, dt \\\\\n1069: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n1070: \\end{aligned}\n1071: $$\n1072: \n1073: The infinitesimal generator acts on the variance as:\n1074: \n1075: $$\n1076: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|v_{k,i} - \\bar{v}_k\\|^2 \\right]\n1077: $$\n1078: \n1079: where $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers and $N$ is the total (fixed) swarm size.\n1080: \n1081: **Step 2: Apply Generator to Centered Velocities**\n1082: \n1083: For each walker $i \\in A_k$, let $\\tilde{v}_{k,i} = v_{k,i} - \\bar{v}_k$. The generator acting on $f_i = \\|\\tilde{v}_{k,i}\\|^2$ with the **Itô drift** (including the correction term from Lemma [](#lem-ito-correction-bound)) is:\n1084: \n1085: $$\n1086: \\mathcal{L} f_i = 2 \\langle \\tilde{v}_{k,i}, [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\rangle + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k))\n1087: $$\n1088: \n1089: where we used $\\nabla f_i = 2\\tilde{v}_{k,i}$ and $\\nabla^2 f_i = 2I_d$.\n1090: \n1091: **Step 3: Analyze Drift Term**\n1092: \n1093: $$\n1094: \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\langle v_{k,i} - \\bar{v}_k, v_{k,i} \\rangle = -\\gamma \\|v_{k,i}\\|^2 + \\gamma \\langle \\bar{v}_k, v_{k,i} \\rangle\n1095: $$\n1096: \n1097: When we sum over all walkers: $\\sum_{i \\in A_k} \\langle \\bar{v}_k, v_{k,i} \\rangle = N_k \\|\\bar{v}_k\\|^2$ (by definition of $\\bar{v}_k$).\n1098: \n1099: Also: $\\sum_{i \\in A_k} \\|v_{k,i}\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i} + \\bar{v}_k\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 + N_k \\|\\bar{v}_k\\|^2$.\n1100: \n1101: Therefore:\n1102: \n1103: $$\n1104: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 = -\\gamma N \\cdot V_{\\text{Var},v}(S_k)\n1105: $$\n1106: \n1107: where we used the definition $V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2$.\n1108: \n1109: The force term $\\sum_i \\langle \\tilde{v}_{k,i}, F(x_{k,i}) \\rangle$ is bounded by Cauchy-Schwarz: $|\\langle \\tilde{v}, F \\rangle| \\le \\|F\\|_{\\infty} \\sqrt{N \\cdot V_{\\text{Var},v}}$, which can be absorbed into the friction by Young's inequality for sufficiently large $\\gamma$.\n1110: \n1111: **Itô correction contribution**: By Lemma [](#lem-ito-correction-bound), $\\|b_{\\text{correction}}\\| \\le C_{\\text{Itô}}$, so:\n1112: \n1113: $$\n1114: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k) \\rangle \\le N_k \\sqrt{V_{\\text{Var},v}} \\cdot C_{\\text{Itô}}\n1115: $$\n1116: \n1117: This is bounded by $N C_{\\text{Itô}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}$ (by Young's inequality with $\\epsilon = 1/(4\\gamma)$), which contributes to the additive constant and slightly modifies the friction rate.\n1118: \n1119: **Step 4: Analyze Diffusion Term (KEY: N-uniformity)**\n1120: \n1121: $$\n1122: \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) \\le \\sum_{i \\in A_k} c_{\\max} d = N_k \\cdot c_{\\max} d\n1123: $$\n1124: \n1125: **Step 5: Combine and Normalize**\n1126: \n1127: $$\n1128: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 \\right]\n1129: $$\n1130: \n1131: $$\n1132: = \\frac{1}{N} \\sum_{i \\in A_k} \\mathcal{L}[\\|\\tilde{v}_{k,i}\\|^2]\n1133: $$\n1134: \n1135: $$\n1136: = \\frac{1}{N} \\sum_{i \\in A_k} \\left[ -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}}) \\right]\n1137: $$\n1138: \n1139: From Step 3, $\\sum_{i \\in A_k} -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 = -2\\gamma N \\cdot V_{\\text{Var},v}(S_k)$, so:\n1140: \n1141: $$\n1142: = \\frac{1}{N} \\cdot (-2\\gamma N \\cdot V_{\\text{Var},v}(S_k)) + \\frac{1}{N} \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1143: $$\n1144: \n1145: $$\n1146: = -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1147: $$\n1148: \n1149: $$\n1150: \\le -2\\gamma V_{\\text{Var},v}(S_k) + c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1151: $$\n1152: \n1153: since $N_k \\le N$.\n1154: \n1155: **CRITICAL OBSERVATION**: With normalization by the total swarm size $N$, the diffusion term is bounded by $\\frac{N_k}{N} c_{\\max} d \\le c_{\\max} d$, which is **independent of both $N$ and $N_k$**. This establishes N-uniformity without requiring exact cancellation.\n1156: \n1157: **Step 6: Assemble Full Drift (Including Itô Correction)**\n1158: \n1159: Combining Steps 3-5, the full drift for $V_{\\text{Var},v}(S_k)$ is:\n1160: \n1161: $$\n1162: \\mathcal{L} V_{\\text{Var},v}(S_k) \\le -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + NC_{\\text{Itô}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}(S_k) + O(\\|F\\|_\\infty)\n1163: $$\n1164: \n1165: Collecting the $V_{\\text{Var},v}$ terms:\n1166: \n1167: $$\n1168: \\le -(2\\gamma - \\frac{1}{4\\gamma}) V_{\\text{Var},v}(S_k) + c_{\\max} d + NC_{\\text{Itô}}^2 + O(\\|F\\|_\\infty)\n1169: $$\n1170: \n1171: For $\\gamma \\ge 1/2$, we have $2\\gamma - 1/(4\\gamma) \\ge \\gamma$. Define the effective friction rate:\n1172: \n1173: $$\n1174: \\kappa'_v := 2\\gamma - \\frac{1}{4\\gamma} \\ge \\gamma \\quad \\text{(for $\\gamma \\ge 1/2$)}\n1175: $$\n1176: \n1177: **Step 7: Coupled Sum**\n1178: \n1179: For the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$:\n1180: \n1181: $$\n1182: \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) \\le -\\kappa'_v V_{\\text{Var},v}(S_1, S_2) + 2[c_{\\max} d + NC_{\\text{Itô}}^2 + O(\\|F\\|_\\infty)]\n1183: $$\n1184: \n1185: **Step 8: Discrete-Time Conversion**\n1186: \n1187: By the discretization theorem (Theorem 1.7.2 from `../1_euclidean_gas/06_convergence.md`):\n1188: \n1189: $$\n1190: \\mathbb{E}[V_{\\text{Var},v}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{Var},v}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) + O(\\tau^2)\n1191: $$\n1192: \n1193: Setting $C'_v = 2[c_{\\max} d + NC_{\\text{Itô}}^2 + O(\\|F\\|_\\infty)]$ (independent of $N$ since $C_{\\text{Itô}}$ is N-uniform):\n1194: \n1195: $$\n1196: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\le -\\kappa'_v \\tau V_{\\text{Var},v} + C'_v \\tau\n1197: $$\n1198: \n1199: where $\\kappa'_v = 2\\gamma - 1/(4\\gamma) \\ge \\gamma$ for $\\gamma \\ge 1/2$.",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "references": [],
      "raw_directive": "1051: :::\n1052: \n1053: :::{prf:proof}\n1054: We analyze the generator $\\mathcal{L}$ acting on the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$ where:\n1055: \n1056: $$\n1057: V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i: s_{k,i}=1} \\|v_{k,i} - \\bar{v}_k\\|^2\n1058: $$\n1059: \n1060: (normalized by total swarm size $N$, consistent with position variance)\n1061: \n1062: **Step 1: Generator for a Single Swarm**\n1063: \n1064: For swarm $S_k$ evolving under the kinetic SDE (Stratonovich form):\n1065: \n1066: $$\n1067: \\begin{aligned}\n1068: dx_{k,i} &= v_{k,i} \\, dt \\\\\n1069: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n1070: \\end{aligned}\n1071: $$\n1072: \n1073: The infinitesimal generator acts on the variance as:\n1074: \n1075: $$\n1076: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|v_{k,i} - \\bar{v}_k\\|^2 \\right]\n1077: $$\n1078: \n1079: where $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers and $N$ is the total (fixed) swarm size.\n1080: \n1081: **Step 2: Apply Generator to Centered Velocities**\n1082: \n1083: For each walker $i \\in A_k$, let $\\tilde{v}_{k,i} = v_{k,i} - \\bar{v}_k$. The generator acting on $f_i = \\|\\tilde{v}_{k,i}\\|^2$ with the **Itô drift** (including the correction term from Lemma [](#lem-ito-correction-bound)) is:\n1084: \n1085: $$\n1086: \\mathcal{L} f_i = 2 \\langle \\tilde{v}_{k,i}, [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\rangle + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k))\n1087: $$\n1088: \n1089: where we used $\\nabla f_i = 2\\tilde{v}_{k,i}$ and $\\nabla^2 f_i = 2I_d$.\n1090: \n1091: **Step 3: Analyze Drift Term**\n1092: \n1093: $$\n1094: \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\langle v_{k,i} - \\bar{v}_k, v_{k,i} \\rangle = -\\gamma \\|v_{k,i}\\|^2 + \\gamma \\langle \\bar{v}_k, v_{k,i} \\rangle\n1095: $$\n1096: \n1097: When we sum over all walkers: $\\sum_{i \\in A_k} \\langle \\bar{v}_k, v_{k,i} \\rangle = N_k \\|\\bar{v}_k\\|^2$ (by definition of $\\bar{v}_k$).\n1098: \n1099: Also: $\\sum_{i \\in A_k} \\|v_{k,i}\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i} + \\bar{v}_k\\|^2 = \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 + N_k \\|\\bar{v}_k\\|^2$.\n1100: \n1101: Therefore:\n1102: \n1103: $$\n1104: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, -\\gamma v_{k,i} \\rangle = -\\gamma \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 = -\\gamma N \\cdot V_{\\text{Var},v}(S_k)\n1105: $$\n1106: \n1107: where we used the definition $V_{\\text{Var},v}(S_k) = \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2$.\n1108: \n1109: The force term $\\sum_i \\langle \\tilde{v}_{k,i}, F(x_{k,i}) \\rangle$ is bounded by Cauchy-Schwarz: $|\\langle \\tilde{v}, F \\rangle| \\le \\|F\\|_{\\infty} \\sqrt{N \\cdot V_{\\text{Var},v}}$, which can be absorbed into the friction by Young's inequality for sufficiently large $\\gamma$.\n1110: \n1111: **Itô correction contribution**: By Lemma [](#lem-ito-correction-bound), $\\|b_{\\text{correction}}\\| \\le C_{\\text{Itô}}$, so:\n1112: \n1113: $$\n1114: \\sum_{i \\in A_k} \\langle \\tilde{v}_{k,i}, b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k) \\rangle \\le N_k \\sqrt{V_{\\text{Var},v}} \\cdot C_{\\text{Itô}}\n1115: $$\n1116: \n1117: This is bounded by $N C_{\\text{Itô}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}$ (by Young's inequality with $\\epsilon = 1/(4\\gamma)$), which contributes to the additive constant and slightly modifies the friction rate.\n1118: \n1119: **Step 4: Analyze Diffusion Term (KEY: N-uniformity)**\n1120: \n1121: $$\n1122: \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) \\le \\sum_{i \\in A_k} c_{\\max} d = N_k \\cdot c_{\\max} d\n1123: $$\n1124: \n1125: **Step 5: Combine and Normalize**\n1126: \n1127: $$\n1128: \\mathcal{L} V_{\\text{Var},v}(S_k) = \\mathcal{L} \\left[ \\frac{1}{N} \\sum_{i \\in A_k} \\|\\tilde{v}_{k,i}\\|^2 \\right]\n1129: $$\n1130: \n1131: $$\n1132: = \\frac{1}{N} \\sum_{i \\in A_k} \\mathcal{L}[\\|\\tilde{v}_{k,i}\\|^2]\n1133: $$\n1134: \n1135: $$\n1136: = \\frac{1}{N} \\sum_{i \\in A_k} \\left[ -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 + \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}}) \\right]\n1137: $$\n1138: \n1139: From Step 3, $\\sum_{i \\in A_k} -2\\gamma \\|\\tilde{v}_{k,i}\\|^2 = -2\\gamma N \\cdot V_{\\text{Var},v}(S_k)$, so:\n1140: \n1141: $$\n1142: = \\frac{1}{N} \\cdot (-2\\gamma N \\cdot V_{\\text{Var},v}(S_k)) + \\frac{1}{N} \\sum_{i \\in A_k} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k)) + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1143: $$\n1144: \n1145: $$\n1146: = -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1147: $$\n1148: \n1149: $$\n1150: \\le -2\\gamma V_{\\text{Var},v}(S_k) + c_{\\max} d + O(\\|F\\|_\\infty \\sqrt{V_{\\text{Var},v}})\n1151: $$\n1152: \n1153: since $N_k \\le N$.\n1154: \n1155: **CRITICAL OBSERVATION**: With normalization by the total swarm size $N$, the diffusion term is bounded by $\\frac{N_k}{N} c_{\\max} d \\le c_{\\max} d$, which is **independent of both $N$ and $N_k$**. This establishes N-uniformity without requiring exact cancellation.\n1156: \n1157: **Step 6: Assemble Full Drift (Including Itô Correction)**\n1158: \n1159: Combining Steps 3-5, the full drift for $V_{\\text{Var},v}(S_k)$ is:\n1160: \n1161: $$\n1162: \\mathcal{L} V_{\\text{Var},v}(S_k) \\le -2\\gamma V_{\\text{Var},v}(S_k) + \\frac{N_k}{N} c_{\\max} d + NC_{\\text{Itô}}^2 + \\frac{1}{4\\gamma} N \\cdot V_{\\text{Var},v}(S_k) + O(\\|F\\|_\\infty)\n1163: $$\n1164: \n1165: Collecting the $V_{\\text{Var},v}$ terms:\n1166: \n1167: $$\n1168: \\le -(2\\gamma - \\frac{1}{4\\gamma}) V_{\\text{Var},v}(S_k) + c_{\\max} d + NC_{\\text{Itô}}^2 + O(\\|F\\|_\\infty)\n1169: $$\n1170: \n1171: For $\\gamma \\ge 1/2$, we have $2\\gamma - 1/(4\\gamma) \\ge \\gamma$. Define the effective friction rate:\n1172: \n1173: $$\n1174: \\kappa'_v := 2\\gamma - \\frac{1}{4\\gamma} \\ge \\gamma \\quad \\text{(for $\\gamma \\ge 1/2$)}\n1175: $$\n1176: \n1177: **Step 7: Coupled Sum**\n1178: \n1179: For the coupled Lyapunov function $V_{\\text{Var},v}(S_1, S_2) = V_{\\text{Var},v}(S_1) + V_{\\text{Var},v}(S_2)$:\n1180: \n1181: $$\n1182: \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) \\le -\\kappa'_v V_{\\text{Var},v}(S_1, S_2) + 2[c_{\\max} d + NC_{\\text{Itô}}^2 + O(\\|F\\|_\\infty)]\n1183: $$\n1184: \n1185: **Step 8: Discrete-Time Conversion**\n1186: \n1187: By the discretization theorem (Theorem 1.7.2 from `../1_euclidean_gas/06_convergence.md`):\n1188: \n1189: $$\n1190: \\mathbb{E}[V_{\\text{Var},v}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{Var},v}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{Var},v}(S_1, S_2) + O(\\tau^2)\n1191: $$\n1192: \n1193: Setting $C'_v = 2[c_{\\max} d + NC_{\\text{Itô}}^2 + O(\\|F\\|_\\infty)]$ (independent of $N$ since $C_{\\text{Itô}}$ is N-uniform):\n1194: \n1195: $$\n1196: \\mathbb{E}[\\Delta V_{\\text{Var},v}] \\le -\\kappa'_v \\tau V_{\\text{Var},v} + C'_v \\tau\n1197: $$\n1198: \n1199: where $\\kappa'_v = 2\\gamma - 1/(4\\gamma) \\ge \\gamma$ for $\\gamma \\ge 1/2$.\n1200: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Anisotropic Kinetic Operator Analysis"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-359",
      "title": null,
      "start_line": 1295,
      "end_line": 1550,
      "header_lines": [],
      "content_start": 1296,
      "content_end": 1549,
      "content": "1296: \n1297: :::{prf:proof}\n1298: This proof provides a complete, self-contained drift matrix analysis for the anisotropic case.\n1299: \n1300: **Preliminaries: The Infinitesimal Generator**\n1301: \n1302: For the coupled $2N$-particle kinetic process, the infinitesimal generator is:\n1303: \n1304: $$\n1305: \\mathcal{L} = \\sum_{k=1,2} \\sum_{i \\in A_k} \\left[ v_{k,i} \\cdot \\nabla_{x_{k,i}} + [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\cdot \\nabla_{v_{k,i}} + \\frac{1}{2} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k) \\nabla^2_{v_{k,i}}) \\right]\n1306: $$\n1307: \n1308: where:\n1309: - $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers in swarm $k$\n1310: - $D_{\\text{reg}}(x_{k,i}, S_k) = \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\Sigma_{\\text{reg}}(x_{k,i}, S_k)^T$ is the diffusion matrix\n1311: - $b_{\\text{correction}}$ is the Itô correction term from Lemma [](#lem-ito-correction-bound)\n1312: - $\\nabla_{x_{k,i}}, \\nabla_{v_{k,i}}$ are gradients with respect to walker $i$ in swarm $k$\n1313: - $\\nabla^2_{v_{k,i}}$ is the Hessian with respect to velocity (note: no diffusion in position)\n1314: \n1315: We apply this generator to the location error $V_{\\text{loc}}(S_1, S_2) = z^T Q z$ where $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T$ is the barycenter difference.\n1316: \n1317: **Step 1: State Vector and Dynamics**\n1318: \n1319: Define the barycenter difference vector $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T \\in \\mathbb{R}^{2d}$ where:\n1320: \n1321: $$\n1322: \\Delta \\mu_x = \\bar{x}_1 - \\bar{x}_2, \\quad \\Delta \\mu_v = \\bar{v}_1 - \\bar{v}_2\n1323: $$\n1324: \n1325: For swarm $k$, the barycenters evolve as (Stratonovich form):\n1326: \n1327: $$\n1328: d\\bar{x}_k = \\bar{v}_k \\, dt\n1329: $$\n1330: \n1331: $$\n1332: d\\bar{v}_k = \\left[ \\bar{F}_k - \\gamma \\bar{v}_k + \\bar{b}_{\\text{correction},k} \\right] dt + \\frac{1}{N_k} \\sum_{i \\in A_k} \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n1333: $$\n1334: \n1335: where $\\bar{F}_k = \\frac{1}{N_k} \\sum_{i \\in A_k} F(x_{k,i})$ is the average force and $\\bar{b}_{\\text{correction},k} = \\frac{1}{N_k} \\sum_{i \\in A_k} b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)$ is the average Itô correction.\n1336: \n1337: Taking differences:\n1338: \n1339: $$\n1340: \\frac{d}{dt} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} + \\text{(noise difference)}\n1341: $$\n1342: \n1343: where $\\Delta \\bar{b}_{\\text{correction}} = \\bar{b}_{\\text{correction},1} - \\bar{b}_{\\text{correction},2}$ is bounded by $2C_{\\text{Itô}}$ (Lemma [](#lem-ito-correction-bound)).\n1344: \n1345: Define the drift matrix:\n1346: \n1347: $$\n1348: M = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix}\n1349: $$\n1350: \n1351: **Step 2: Hypocoercive Quadratic Form**\n1352: \n1353: The location error is $V_{\\text{loc}} = z^T Q z$ with the hypocoercive weight matrix:\n1354: \n1355: $$\n1356: Q = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix}\n1357: $$\n1358: \n1359: where $\\lambda_v > 0$ weights velocity error and $b \\in \\mathbb{R}$ couples position and velocity errors.\n1360: \n1361: **Positive definiteness**: Requires $\\lambda_v > b^2/4$ (Sylvester's criterion).\n1362: \n1363: **Step 3: Generator Applied to Quadratic Form**\n1364: \n1365: The infinitesimal generator acting on $V_{\\text{loc}}(z) = z^T Q z$ is:\n1366: \n1367: $$\n1368: \\mathcal{L} V_{\\text{loc}} = 2 z^T Q \\left[ M z + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} \\right] + \\text{Tr}\\left( \\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}} \\right)\n1369: $$\n1370: \n1371: where $\\bar{D}_{\\text{noise}}$ is the covariance of the noise difference (computed below) and $\\Delta \\bar{b}_{\\text{correction}}$ is the difference in average Itô corrections.\n1372: \n1373: **Step 3a: Drift Term (Deterministic)**\n1374: \n1375: The drift from $M$ is:\n1376: \n1377: $$\n1378: z^T (M^T Q + Q M) z\n1379: $$\n1380: \n1381: Compute the drift matrix $\\mathcal{D} = M^T Q + Q M$:\n1382: \n1383: $$\n1384: M^T Q = \\begin{bmatrix} 0 & 0 \\\\ I_d & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ I_d - \\frac{b\\gamma}{2}I_d & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1385: $$\n1386: \n1387: $$\n1388: Q M = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} = \\begin{bmatrix} 0 & I_d - \\frac{b\\gamma}{2}I_d \\\\ 0 & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1389: $$\n1390: \n1391: $$\n1392: \\mathcal{D} = M^T Q + Q M = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ (1 - \\frac{b\\gamma}{2})I_d & (b - 2\\gamma\\lambda_v)I_d \\end{bmatrix}\n1393: $$\n1394: \n1395: **Step 3b: Force and Itô Correction Contribution**\n1396: \n1397: $$\n1398: 2 z^T Q \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} = 2 (\\Delta \\mu_x, \\Delta \\mu_v) \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix}\n1399: $$\n1400: \n1401: $$\n1402: = b \\langle \\Delta \\mu_x, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle + 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle\n1403: $$\n1404: \n1405: By Lipschitz continuity of $F(x) = -\\nabla U(x)$ (from coercivity Axiom 1.3.1):\n1406: \n1407: $$\n1408: \\|\\Delta \\bar{F}\\| \\le L_F \\|\\Delta \\mu_x\\| + O(1/\\sqrt{N})\n1409: $$\n1410: \n1411: By Lemma [](#lem-ito-correction-bound):\n1412: \n1413: $$\n1414: \\|\\Delta \\bar{b}_{\\text{correction}}\\| \\le 2C_{\\text{Itô}}\n1415: $$\n1416: \n1417: Using Cauchy-Schwarz and Young's inequality $2ab \\le \\epsilon a^2 + b^2/\\epsilon$:\n1418: \n1419: $$\n1420: b \\langle \\Delta \\mu_x, \\Delta \\bar{F} \\rangle \\le |b| L_F \\|\\Delta \\mu_x\\|^2 + O(1/\\sqrt{N})\n1421: $$\n1422: \n1423: $$\n1424: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} \\rangle \\le 2\\lambda_v L_F \\|\\Delta \\mu_x\\| \\|\\Delta \\mu_v\\| \\le \\lambda_v L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2)\n1425: $$\n1426: \n1427: **Itô correction terms**: Similarly,\n1428: \n1429: $$\n1430: b \\langle \\Delta \\mu_x, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le |b| C_{\\text{Itô}} \\|\\Delta \\mu_x\\|\n1431: $$\n1432: \n1433: $$\n1434: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le 2\\lambda_v C_{\\text{Itô}} \\|\\Delta \\mu_v\\|\n1435: $$\n1436: \n1437: These contribute $O(C_{\\text{Itô}})$ to the additive constant after Young's inequality.\n1438: \n1439: **Step 3c: Noise Contribution (ANISOTROPIC CASE - KEY)**\n1440: \n1441: The noise difference has covariance (per unit time):\n1442: \n1443: $$\n1444: \\bar{D}_{\\text{noise}} = \\text{blockdiag}\\left( 0_d, \\frac{1}{N_1} \\sum_{i \\in A_1} D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_{j \\in A_2} D_{\\text{reg}}(x_{2,j}, S_2) \\right)\n1445: $$\n1446: \n1447: The contribution to the generator is:\n1448: \n1449: $$\n1450: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) = \\text{Tr}(\\bar{D}_{\\text{noise}} \\cdot 2Q)\n1451: $$\n1452: \n1453: Since noise acts only on velocities:\n1454: \n1455: $$\n1456: = 2 \\text{Tr}\\left( \\left[ \\frac{1}{N_1} \\sum_i D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_j D_{\\text{reg}}(x_{2,j}, S_2) \\right] \\lambda_v I_d \\right)\n1457: $$\n1458: \n1459: $$\n1460: = 2\\lambda_v \\left[ \\frac{1}{N_1} \\sum_i \\text{Tr}(D_{\\text{reg}}(x_{1,i}, S_1)) + \\frac{1}{N_2} \\sum_j \\text{Tr}(D_{\\text{reg}}(x_{2,j}, S_2)) \\right]\n1461: $$\n1462: \n1463: By uniform ellipticity $c_{\\min} I \\preceq D_{\\text{reg}} \\preceq c_{\\max} I$:\n1464: \n1465: $$\n1466: c_{\\min} d \\le \\text{Tr}(D_{\\text{reg}}(x,S)) \\le c_{\\max} d\n1467: $$\n1468: \n1469: Therefore:\n1470: \n1471: $$\n1472: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) \\le 2\\lambda_v \\cdot 2 c_{\\max} d = 4\\lambda_v c_{\\max} d\n1473: $$\n1474: \n1475: **CRITICAL**: This bound is **independent of $N$** because the $1/N_k$ factor in $\\bar{D}_{\\text{noise}}$ cancels the sum over $N_k$ walkers.\n1476: \n1477: **Step 4: Combined Drift Inequality**\n1478: \n1479: $$\n1480: \\mathcal{L} V_{\\text{loc}} \\le z^T \\mathcal{D} z + (|b| + \\lambda_v) L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2) + 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N})\n1481: $$\n1482: \n1483: **Step 5: Optimal Parameter Choice**\n1484: \n1485: Following the hypocoercivity analysis from `../1_euclidean_gas/06_convergence.md` (Lemma 2.5.1), choose:\n1486: \n1487: $$\n1488: \\lambda_v = \\frac{1}{\\gamma}, \\quad b = \\frac{2}{\\sqrt{\\gamma}}\n1489: $$\n1490: \n1491: This gives near-critical damping. With these values:\n1492: \n1493: $$\n1494: \\mathcal{D} = \\begin{bmatrix} 0 & (1 - \\frac{1}{\\sqrt{\\gamma}})I_d \\\\ (1 - \\frac{1}{\\sqrt{\\gamma}})I_d & (\\frac{2}{\\sqrt{\\gamma}} - \\frac{2}{\\gamma})I_d \\end{bmatrix}\n1495: $$\n1496: \n1497: **Step 6: Eigenvalue Analysis of Effective Drift Matrix**\n1498: \n1499: Define the **effective drift matrix** including force perturbation:\n1500: \n1501: $$\n1502: \\mathcal{D}_{\\text{eff}} = \\mathcal{D} + (|b| + \\lambda_v) L_F \\cdot I_{2d}\n1503: $$\n1504: \n1505: The eigenvalues of $\\mathcal{D}$ (in the limit $\\gamma \\to \\infty$ for simplicity) are approximately:\n1506: \n1507: $$\n1508: \\lambda_{\\pm} \\approx -\\frac{\\gamma}{2} \\pm i\\omega\n1509: $$\n1510: \n1511: where $\\omega$ is the oscillation frequency. The **real part** is negative: $\\text{Re}(\\lambda) \\approx -\\gamma/2$.\n1512: \n1513: Adding the force perturbation shifts eigenvalues by at most $O(L_F)$. For sufficiently large $\\gamma > L_F$:\n1514: \n1515: $$\n1516: \\text{Re}(\\lambda_{\\text{min}}(\\mathcal{D}_{\\text{eff}})) \\le -\\frac{\\gamma}{4} < 0\n1517: $$\n1518: \n1519: This gives the contraction rate:\n1520: \n1521: $$\n1522: z^T \\mathcal{D}_{\\text{eff}} z \\le -\\kappa_{\\text{hypo}} \\|z\\|^2\n1523: $$\n1524: \n1525: where $\\kappa_{\\text{hypo}} = O(\\min\\{\\gamma, c_{\\min}\\})$.\n1526: \n1527: **WHY $c_{\\min}$ APPEARS**: The noise term contributes $4\\lambda_v c_{\\max} d$ to the expansion. For the Lyapunov function to decay, the contraction $-\\kappa_{\\text{hypo}} V_{\\text{loc}}$ must dominate. The effective contraction is:\n1528: \n1529: $$\n1530: \\kappa_{\\text{loc}} = \\kappa_{\\text{hypo}} - \\frac{4\\lambda_v c_{\\max} d}{V_{\\text{loc}}}\n1531: $$\n1532: \n1533: For large $V_{\\text{loc}}$, this is positive. For bounded $V_{\\text{loc}}$, we need $\\kappa_{\\text{hypo}} \\ge c_{\\text{threshold}}$ to ensure net contraction. By analyzing the full dynamics, this threshold is $O(c_{\\min})$ (the minimum noise strength required for hypocoercive coupling).\n1534: \n1535: **Step 7: Discrete-Time Result**\n1536: \n1537: By the Itô-to-discretization theorem:\n1538: \n1539: $$\n1540: \\mathbb{E}[V_{\\text{loc}}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{loc}}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{loc}}(S_1, S_2) + O(\\tau^2)\n1541: $$\n1542: \n1543: $$\n1544: \\le (1 - \\kappa_{\\text{loc}} \\tau) V_{\\text{loc}}(S_1, S_2) + C_{\\text{loc}} \\tau\n1545: $$\n1546: \n1547: where:\n1548: - $\\kappa_{\\text{loc}} = O(\\min\\{\\gamma, c_{\\min}\\})$\n1549: - $C_{\\text{loc}} = 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N}) = O(c_{\\max})$ (N-uniform)",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "references": [],
      "raw_directive": "1295: :::\n1296: \n1297: :::{prf:proof}\n1298: This proof provides a complete, self-contained drift matrix analysis for the anisotropic case.\n1299: \n1300: **Preliminaries: The Infinitesimal Generator**\n1301: \n1302: For the coupled $2N$-particle kinetic process, the infinitesimal generator is:\n1303: \n1304: $$\n1305: \\mathcal{L} = \\sum_{k=1,2} \\sum_{i \\in A_k} \\left[ v_{k,i} \\cdot \\nabla_{x_{k,i}} + [F(x_{k,i}) - \\gamma v_{k,i} + b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)] \\cdot \\nabla_{v_{k,i}} + \\frac{1}{2} \\text{Tr}(D_{\\text{reg}}(x_{k,i}, S_k) \\nabla^2_{v_{k,i}}) \\right]\n1306: $$\n1307: \n1308: where:\n1309: - $A_k = \\{i : s_{k,i} = 1\\}$ is the set of alive walkers in swarm $k$\n1310: - $D_{\\text{reg}}(x_{k,i}, S_k) = \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\Sigma_{\\text{reg}}(x_{k,i}, S_k)^T$ is the diffusion matrix\n1311: - $b_{\\text{correction}}$ is the Itô correction term from Lemma [](#lem-ito-correction-bound)\n1312: - $\\nabla_{x_{k,i}}, \\nabla_{v_{k,i}}$ are gradients with respect to walker $i$ in swarm $k$\n1313: - $\\nabla^2_{v_{k,i}}$ is the Hessian with respect to velocity (note: no diffusion in position)\n1314: \n1315: We apply this generator to the location error $V_{\\text{loc}}(S_1, S_2) = z^T Q z$ where $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T$ is the barycenter difference.\n1316: \n1317: **Step 1: State Vector and Dynamics**\n1318: \n1319: Define the barycenter difference vector $z = (\\Delta \\mu_x, \\Delta \\mu_v)^T \\in \\mathbb{R}^{2d}$ where:\n1320: \n1321: $$\n1322: \\Delta \\mu_x = \\bar{x}_1 - \\bar{x}_2, \\quad \\Delta \\mu_v = \\bar{v}_1 - \\bar{v}_2\n1323: $$\n1324: \n1325: For swarm $k$, the barycenters evolve as (Stratonovich form):\n1326: \n1327: $$\n1328: d\\bar{x}_k = \\bar{v}_k \\, dt\n1329: $$\n1330: \n1331: $$\n1332: d\\bar{v}_k = \\left[ \\bar{F}_k - \\gamma \\bar{v}_k + \\bar{b}_{\\text{correction},k} \\right] dt + \\frac{1}{N_k} \\sum_{i \\in A_k} \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_{k,i}\n1333: $$\n1334: \n1335: where $\\bar{F}_k = \\frac{1}{N_k} \\sum_{i \\in A_k} F(x_{k,i})$ is the average force and $\\bar{b}_{\\text{correction},k} = \\frac{1}{N_k} \\sum_{i \\in A_k} b_{\\text{correction}}(x_{k,i}, v_{k,i}, S_k)$ is the average Itô correction.\n1336: \n1337: Taking differences:\n1338: \n1339: $$\n1340: \\frac{d}{dt} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} \\Delta \\mu_x \\\\ \\Delta \\mu_v \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} + \\text{(noise difference)}\n1341: $$\n1342: \n1343: where $\\Delta \\bar{b}_{\\text{correction}} = \\bar{b}_{\\text{correction},1} - \\bar{b}_{\\text{correction},2}$ is bounded by $2C_{\\text{Itô}}$ (Lemma [](#lem-ito-correction-bound)).\n1344: \n1345: Define the drift matrix:\n1346: \n1347: $$\n1348: M = \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix}\n1349: $$\n1350: \n1351: **Step 2: Hypocoercive Quadratic Form**\n1352: \n1353: The location error is $V_{\\text{loc}} = z^T Q z$ with the hypocoercive weight matrix:\n1354: \n1355: $$\n1356: Q = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix}\n1357: $$\n1358: \n1359: where $\\lambda_v > 0$ weights velocity error and $b \\in \\mathbb{R}$ couples position and velocity errors.\n1360: \n1361: **Positive definiteness**: Requires $\\lambda_v > b^2/4$ (Sylvester's criterion).\n1362: \n1363: **Step 3: Generator Applied to Quadratic Form**\n1364: \n1365: The infinitesimal generator acting on $V_{\\text{loc}}(z) = z^T Q z$ is:\n1366: \n1367: $$\n1368: \\mathcal{L} V_{\\text{loc}} = 2 z^T Q \\left[ M z + \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} \\right] + \\text{Tr}\\left( \\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}} \\right)\n1369: $$\n1370: \n1371: where $\\bar{D}_{\\text{noise}}$ is the covariance of the noise difference (computed below) and $\\Delta \\bar{b}_{\\text{correction}}$ is the difference in average Itô corrections.\n1372: \n1373: **Step 3a: Drift Term (Deterministic)**\n1374: \n1375: The drift from $M$ is:\n1376: \n1377: $$\n1378: z^T (M^T Q + Q M) z\n1379: $$\n1380: \n1381: Compute the drift matrix $\\mathcal{D} = M^T Q + Q M$:\n1382: \n1383: $$\n1384: M^T Q = \\begin{bmatrix} 0 & 0 \\\\ I_d & -\\gamma I_d \\end{bmatrix} \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ I_d - \\frac{b\\gamma}{2}I_d & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1385: $$\n1386: \n1387: $$\n1388: Q M = \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 & I_d \\\\ 0 & -\\gamma I_d \\end{bmatrix} = \\begin{bmatrix} 0 & I_d - \\frac{b\\gamma}{2}I_d \\\\ 0 & \\frac{b}{2}I_d - \\gamma \\lambda_v I_d \\end{bmatrix}\n1389: $$\n1390: \n1391: $$\n1392: \\mathcal{D} = M^T Q + Q M = \\begin{bmatrix} 0 & (1 - \\frac{b\\gamma}{2})I_d \\\\ (1 - \\frac{b\\gamma}{2})I_d & (b - 2\\gamma\\lambda_v)I_d \\end{bmatrix}\n1393: $$\n1394: \n1395: **Step 3b: Force and Itô Correction Contribution**\n1396: \n1397: $$\n1398: 2 z^T Q \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix} = 2 (\\Delta \\mu_x, \\Delta \\mu_v) \\begin{bmatrix} I_d & \\frac{b}{2}I_d \\\\ \\frac{b}{2}I_d & \\lambda_v I_d \\end{bmatrix} \\begin{bmatrix} 0 \\\\ \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\end{bmatrix}\n1399: $$\n1400: \n1401: $$\n1402: = b \\langle \\Delta \\mu_x, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle + 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} + \\Delta \\bar{b}_{\\text{correction}} \\rangle\n1403: $$\n1404: \n1405: By Lipschitz continuity of $F(x) = -\\nabla U(x)$ (from coercivity Axiom 1.3.1):\n1406: \n1407: $$\n1408: \\|\\Delta \\bar{F}\\| \\le L_F \\|\\Delta \\mu_x\\| + O(1/\\sqrt{N})\n1409: $$\n1410: \n1411: By Lemma [](#lem-ito-correction-bound):\n1412: \n1413: $$\n1414: \\|\\Delta \\bar{b}_{\\text{correction}}\\| \\le 2C_{\\text{Itô}}\n1415: $$\n1416: \n1417: Using Cauchy-Schwarz and Young's inequality $2ab \\le \\epsilon a^2 + b^2/\\epsilon$:\n1418: \n1419: $$\n1420: b \\langle \\Delta \\mu_x, \\Delta \\bar{F} \\rangle \\le |b| L_F \\|\\Delta \\mu_x\\|^2 + O(1/\\sqrt{N})\n1421: $$\n1422: \n1423: $$\n1424: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{F} \\rangle \\le 2\\lambda_v L_F \\|\\Delta \\mu_x\\| \\|\\Delta \\mu_v\\| \\le \\lambda_v L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2)\n1425: $$\n1426: \n1427: **Itô correction terms**: Similarly,\n1428: \n1429: $$\n1430: b \\langle \\Delta \\mu_x, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le |b| C_{\\text{Itô}} \\|\\Delta \\mu_x\\|\n1431: $$\n1432: \n1433: $$\n1434: 2\\lambda_v \\langle \\Delta \\mu_v, \\Delta \\bar{b}_{\\text{correction}} \\rangle \\le 2\\lambda_v C_{\\text{Itô}} \\|\\Delta \\mu_v\\|\n1435: $$\n1436: \n1437: These contribute $O(C_{\\text{Itô}})$ to the additive constant after Young's inequality.\n1438: \n1439: **Step 3c: Noise Contribution (ANISOTROPIC CASE - KEY)**\n1440: \n1441: The noise difference has covariance (per unit time):\n1442: \n1443: $$\n1444: \\bar{D}_{\\text{noise}} = \\text{blockdiag}\\left( 0_d, \\frac{1}{N_1} \\sum_{i \\in A_1} D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_{j \\in A_2} D_{\\text{reg}}(x_{2,j}, S_2) \\right)\n1445: $$\n1446: \n1447: The contribution to the generator is:\n1448: \n1449: $$\n1450: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) = \\text{Tr}(\\bar{D}_{\\text{noise}} \\cdot 2Q)\n1451: $$\n1452: \n1453: Since noise acts only on velocities:\n1454: \n1455: $$\n1456: = 2 \\text{Tr}\\left( \\left[ \\frac{1}{N_1} \\sum_i D_{\\text{reg}}(x_{1,i}, S_1) + \\frac{1}{N_2} \\sum_j D_{\\text{reg}}(x_{2,j}, S_2) \\right] \\lambda_v I_d \\right)\n1457: $$\n1458: \n1459: $$\n1460: = 2\\lambda_v \\left[ \\frac{1}{N_1} \\sum_i \\text{Tr}(D_{\\text{reg}}(x_{1,i}, S_1)) + \\frac{1}{N_2} \\sum_j \\text{Tr}(D_{\\text{reg}}(x_{2,j}, S_2)) \\right]\n1461: $$\n1462: \n1463: By uniform ellipticity $c_{\\min} I \\preceq D_{\\text{reg}} \\preceq c_{\\max} I$:\n1464: \n1465: $$\n1466: c_{\\min} d \\le \\text{Tr}(D_{\\text{reg}}(x,S)) \\le c_{\\max} d\n1467: $$\n1468: \n1469: Therefore:\n1470: \n1471: $$\n1472: \\text{Tr}(\\bar{D}_{\\text{noise}} \\nabla^2 V_{\\text{loc}}) \\le 2\\lambda_v \\cdot 2 c_{\\max} d = 4\\lambda_v c_{\\max} d\n1473: $$\n1474: \n1475: **CRITICAL**: This bound is **independent of $N$** because the $1/N_k$ factor in $\\bar{D}_{\\text{noise}}$ cancels the sum over $N_k$ walkers.\n1476: \n1477: **Step 4: Combined Drift Inequality**\n1478: \n1479: $$\n1480: \\mathcal{L} V_{\\text{loc}} \\le z^T \\mathcal{D} z + (|b| + \\lambda_v) L_F (\\|\\Delta \\mu_x\\|^2 + \\|\\Delta \\mu_v\\|^2) + 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N})\n1481: $$\n1482: \n1483: **Step 5: Optimal Parameter Choice**\n1484: \n1485: Following the hypocoercivity analysis from `../1_euclidean_gas/06_convergence.md` (Lemma 2.5.1), choose:\n1486: \n1487: $$\n1488: \\lambda_v = \\frac{1}{\\gamma}, \\quad b = \\frac{2}{\\sqrt{\\gamma}}\n1489: $$\n1490: \n1491: This gives near-critical damping. With these values:\n1492: \n1493: $$\n1494: \\mathcal{D} = \\begin{bmatrix} 0 & (1 - \\frac{1}{\\sqrt{\\gamma}})I_d \\\\ (1 - \\frac{1}{\\sqrt{\\gamma}})I_d & (\\frac{2}{\\sqrt{\\gamma}} - \\frac{2}{\\gamma})I_d \\end{bmatrix}\n1495: $$\n1496: \n1497: **Step 6: Eigenvalue Analysis of Effective Drift Matrix**\n1498: \n1499: Define the **effective drift matrix** including force perturbation:\n1500: \n1501: $$\n1502: \\mathcal{D}_{\\text{eff}} = \\mathcal{D} + (|b| + \\lambda_v) L_F \\cdot I_{2d}\n1503: $$\n1504: \n1505: The eigenvalues of $\\mathcal{D}$ (in the limit $\\gamma \\to \\infty$ for simplicity) are approximately:\n1506: \n1507: $$\n1508: \\lambda_{\\pm} \\approx -\\frac{\\gamma}{2} \\pm i\\omega\n1509: $$\n1510: \n1511: where $\\omega$ is the oscillation frequency. The **real part** is negative: $\\text{Re}(\\lambda) \\approx -\\gamma/2$.\n1512: \n1513: Adding the force perturbation shifts eigenvalues by at most $O(L_F)$. For sufficiently large $\\gamma > L_F$:\n1514: \n1515: $$\n1516: \\text{Re}(\\lambda_{\\text{min}}(\\mathcal{D}_{\\text{eff}})) \\le -\\frac{\\gamma}{4} < 0\n1517: $$\n1518: \n1519: This gives the contraction rate:\n1520: \n1521: $$\n1522: z^T \\mathcal{D}_{\\text{eff}} z \\le -\\kappa_{\\text{hypo}} \\|z\\|^2\n1523: $$\n1524: \n1525: where $\\kappa_{\\text{hypo}} = O(\\min\\{\\gamma, c_{\\min}\\})$.\n1526: \n1527: **WHY $c_{\\min}$ APPEARS**: The noise term contributes $4\\lambda_v c_{\\max} d$ to the expansion. For the Lyapunov function to decay, the contraction $-\\kappa_{\\text{hypo}} V_{\\text{loc}}$ must dominate. The effective contraction is:\n1528: \n1529: $$\n1530: \\kappa_{\\text{loc}} = \\kappa_{\\text{hypo}} - \\frac{4\\lambda_v c_{\\max} d}{V_{\\text{loc}}}\n1531: $$\n1532: \n1533: For large $V_{\\text{loc}}$, this is positive. For bounded $V_{\\text{loc}}$, we need $\\kappa_{\\text{hypo}} \\ge c_{\\text{threshold}}$ to ensure net contraction. By analyzing the full dynamics, this threshold is $O(c_{\\min})$ (the minimum noise strength required for hypocoercive coupling).\n1534: \n1535: **Step 7: Discrete-Time Result**\n1536: \n1537: By the Itô-to-discretization theorem:\n1538: \n1539: $$\n1540: \\mathbb{E}[V_{\\text{loc}}(S_1^{(\\tau)}, S_2^{(\\tau)}) \\mid S_1, S_2] \\le V_{\\text{loc}}(S_1, S_2) + \\tau \\mathcal{L} V_{\\text{loc}}(S_1, S_2) + O(\\tau^2)\n1541: $$\n1542: \n1543: $$\n1544: \\le (1 - \\kappa_{\\text{loc}} \\tau) V_{\\text{loc}}(S_1, S_2) + C_{\\text{loc}} \\tau\n1545: $$\n1546: \n1547: where:\n1548: - $\\kappa_{\\text{loc}} = O(\\min\\{\\gamma, c_{\\min}\\})$\n1549: - $C_{\\text{loc}} = 4\\lambda_v c_{\\max} d + O(1/\\sqrt{N}) = O(c_{\\max})$ (N-uniform)\n1550: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Anisotropic Kinetic Operator Analysis"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-646",
      "title": null,
      "start_line": 1582,
      "end_line": 1664,
      "header_lines": [
        1659
      ],
      "content_start": 1583,
      "content_end": 1663,
      "content": "1583: \n1584: :::{prf:proof}\n1585: This proof adapts the synchronous coupling argument from `../1_euclidean_gas/06_convergence.md` (Lemma 2.6.1) to handle different noise tensors.\n1586: \n1587: **Step 1: Synchronous Coupling Setup**\n1588: \n1589: For discrete empirical measures, the optimal transport plan is the **synchronous coupling**: match particles by index.\n1590: \n1591: $$\n1592: \\pi^N = \\frac{1}{N} \\sum_{i=1}^N \\delta_{(z_{1,i}, z_{2,i})}\n1593: $$\n1594: \n1595: where $z_{k,i} = (x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})$ are centered coordinates.\n1596: \n1597: The Wasserstein distance is:\n1598: \n1599: $$\n1600: V_{\\text{struct}} = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2) = \\frac{1}{N} \\sum_{i=1}^N \\|z_{1,i} - z_{2,i}\\|_h^2\n1601: $$\n1602: \n1603: **Step 2: Single-Pair Dynamics**\n1604: \n1605: Each particle pair evolves under (Stratonovich form):\n1606: \n1607: $$\n1608: \\begin{aligned}\n1609: dx_{k,i} &= v_{k,i} \\, dt \\\\\n1610: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_i\n1611: \\end{aligned}\n1612: $$\n1613: \n1614: **Challenge**: The noise tensors $\\Sigma_{\\text{reg}}(x_{1,i}, S_1)$ and $\\Sigma_{\\text{reg}}(x_{2,i}, S_2)$ are **different** because the two swarms are in different states.\n1615: \n1616: **Solution**: Use **midpoint coupling**. Evolve both particles with the **average** noise tensor:\n1617: \n1618: $$\n1619: \\Sigma_{\\text{mid},i} = \\frac{1}{2} \\left[ \\Sigma_{\\text{reg}}(x_{1,i}, S_1) + \\Sigma_{\\text{reg}}(x_{2,i}, S_2) \\right]\n1620: $$\n1621: \n1622: **Step 3: Coupling Error Analysis (Rigorous Bound)**\n1623: \n1624: The **coupling error** is the difference between the true dynamics and the midpoint dynamics.\n1625: \n1626: **Step 3a: Define the error process**\n1627: \n1628: For the true SDE of particle difference (Stratonovich):\n1629: \n1630: $$\n1631: d(z_{1,i} - z_{2,i}) = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + [\\Sigma_{\\text{reg}}(x_{1,i}, S_1) - \\Sigma_{\\text{reg}}(x_{2,i}, S_2)] \\circ dW_i\n1632: $$\n1633: \n1634: where $M$ is the drift matrix and $\\Delta F_i = F(x_{1,i}) - F(x_{2,i})$.\n1635: \n1636: Under **midpoint coupling** with shared noise $dW_i$:\n1637: \n1638: $$\n1639: d(z_{1,i} - z_{2,i})_{\\text{mid}} = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + \\Sigma_{\\text{mid},i} \\circ dW_i\n1640: $$\n1641: \n1642: The **coupling error process** is:\n1643: \n1644: $$\n1645: \\text{Error}_i(t) = \\int_0^t \\left[ \\frac{\\Sigma_{\\text{reg}}(x_{1,i}(s), S_1) - \\Sigma_{\\text{reg}}(x_{2,i}(s), S_2)}{2} \\right] \\circ dW_i(s)\n1646: $$\n1647: \n1648: where we used $\\Sigma_{\\text{mid}} = (\\Sigma_1 + \\Sigma_2)/2$.\n1649: \n1650: **Step 3b: Stratonovich Isometry for Variance Bound**\n1651: \n1652: We apply the fundamental isometry property of Stratonovich stochastic integrals. For any adapted matrix-valued process $\\sigma(s)$:\n1653: \n1654: $$\n1655: \\mathbb{E}\\left[\\left\\|\\int_0^t \\sigma(s) \\circ dW_s\\right\\|^2\\right] = \\mathbb{E}\\left[\\int_0^t \\|\\sigma(s)\\|_F^2 ds\\right]\n1656: $$\n1657: \n1658: where $\\|\\cdot\\|_F$ is the Frobenius norm. This is a standard result in stochastic calculus (see Karatzas & Shreve, Brownian Motion and Stochastic Calculus, Theorem 3.3.16).\n1659: \n1660: :::{admonition} Why Stratonovich?\n1661: :class: note\n1662: \n1663: This isometry is **identical** to the Itô case, but Stratonovich integrals have a key advantage for physics: **geometric invariance under coordinate transformations**. When we later map this result to curved space (Section 8), the Stratonovich formulation ensures the convergence rate remains coordinate-independent.",
      "metadata": {
        "class": "note"
      },
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "references": [],
      "raw_directive": "1582: :::\n1583: \n1584: :::{prf:proof}\n1585: This proof adapts the synchronous coupling argument from `../1_euclidean_gas/06_convergence.md` (Lemma 2.6.1) to handle different noise tensors.\n1586: \n1587: **Step 1: Synchronous Coupling Setup**\n1588: \n1589: For discrete empirical measures, the optimal transport plan is the **synchronous coupling**: match particles by index.\n1590: \n1591: $$\n1592: \\pi^N = \\frac{1}{N} \\sum_{i=1}^N \\delta_{(z_{1,i}, z_{2,i})}\n1593: $$\n1594: \n1595: where $z_{k,i} = (x_{k,i} - \\mu_{x,k}, v_{k,i} - \\mu_{v,k})$ are centered coordinates.\n1596: \n1597: The Wasserstein distance is:\n1598: \n1599: $$\n1600: V_{\\text{struct}} = W_h^2(\\tilde{\\mu}_1, \\tilde{\\mu}_2) = \\frac{1}{N} \\sum_{i=1}^N \\|z_{1,i} - z_{2,i}\\|_h^2\n1601: $$\n1602: \n1603: **Step 2: Single-Pair Dynamics**\n1604: \n1605: Each particle pair evolves under (Stratonovich form):\n1606: \n1607: $$\n1608: \\begin{aligned}\n1609: dx_{k,i} &= v_{k,i} \\, dt \\\\\n1610: dv_{k,i} &= [F(x_{k,i}) - \\gamma v_{k,i}] dt + \\Sigma_{\\text{reg}}(x_{k,i}, S_k) \\circ dW_i\n1611: \\end{aligned}\n1612: $$\n1613: \n1614: **Challenge**: The noise tensors $\\Sigma_{\\text{reg}}(x_{1,i}, S_1)$ and $\\Sigma_{\\text{reg}}(x_{2,i}, S_2)$ are **different** because the two swarms are in different states.\n1615: \n1616: **Solution**: Use **midpoint coupling**. Evolve both particles with the **average** noise tensor:\n1617: \n1618: $$\n1619: \\Sigma_{\\text{mid},i} = \\frac{1}{2} \\left[ \\Sigma_{\\text{reg}}(x_{1,i}, S_1) + \\Sigma_{\\text{reg}}(x_{2,i}, S_2) \\right]\n1620: $$\n1621: \n1622: **Step 3: Coupling Error Analysis (Rigorous Bound)**\n1623: \n1624: The **coupling error** is the difference between the true dynamics and the midpoint dynamics.\n1625: \n1626: **Step 3a: Define the error process**\n1627: \n1628: For the true SDE of particle difference (Stratonovich):\n1629: \n1630: $$\n1631: d(z_{1,i} - z_{2,i}) = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + [\\Sigma_{\\text{reg}}(x_{1,i}, S_1) - \\Sigma_{\\text{reg}}(x_{2,i}, S_2)] \\circ dW_i\n1632: $$\n1633: \n1634: where $M$ is the drift matrix and $\\Delta F_i = F(x_{1,i}) - F(x_{2,i})$.\n1635: \n1636: Under **midpoint coupling** with shared noise $dW_i$:\n1637: \n1638: $$\n1639: d(z_{1,i} - z_{2,i})_{\\text{mid}} = [M(z_{1,i} - z_{2,i}) + (\\Delta F_i)] dt + \\Sigma_{\\text{mid},i} \\circ dW_i\n1640: $$\n1641: \n1642: The **coupling error process** is:\n1643: \n1644: $$\n1645: \\text{Error}_i(t) = \\int_0^t \\left[ \\frac{\\Sigma_{\\text{reg}}(x_{1,i}(s), S_1) - \\Sigma_{\\text{reg}}(x_{2,i}(s), S_2)}{2} \\right] \\circ dW_i(s)\n1646: $$\n1647: \n1648: where we used $\\Sigma_{\\text{mid}} = (\\Sigma_1 + \\Sigma_2)/2$.\n1649: \n1650: **Step 3b: Stratonovich Isometry for Variance Bound**\n1651: \n1652: We apply the fundamental isometry property of Stratonovich stochastic integrals. For any adapted matrix-valued process $\\sigma(s)$:\n1653: \n1654: $$\n1655: \\mathbb{E}\\left[\\left\\|\\int_0^t \\sigma(s) \\circ dW_s\\right\\|^2\\right] = \\mathbb{E}\\left[\\int_0^t \\|\\sigma(s)\\|_F^2 ds\\right]\n1656: $$\n1657: \n1658: where $\\|\\cdot\\|_F$ is the Frobenius norm. This is a standard result in stochastic calculus (see Karatzas & Shreve, Brownian Motion and Stochastic Calculus, Theorem 3.3.16).\n1659: \n1660: :::{admonition} Why Stratonovich?\n1661: :class: note\n1662: \n1663: This isometry is **identical** to the Itô case, but Stratonovich integrals have a key advantage for physics: **geometric invariance under coordinate transformations**. When we later map this result to curved space (Section 8), the Stratonovich formulation ensures the convergence rate remains coordinate-independent.\n1664: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Anisotropic Kinetic Operator Analysis"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-868",
      "title": null,
      "start_line": 1804,
      "end_line": 1808,
      "header_lines": [],
      "content_start": 1805,
      "content_end": 1807,
      "content": "1805: \n1806: :::{prf:proof}\n1807: Direct from Theorems [](#thm-location-error-anisotropic) and [](#thm-structural-error-anisotropic). Since both components contract at rates $\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}} = O(\\min\\{\\gamma, c_{\\min}\\})$, their sum contracts at rate $\\min\\{\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}}\\}$.",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "references": [],
      "raw_directive": "1804: :::\n1805: \n1806: :::{prf:proof}\n1807: Direct from Theorems [](#thm-location-error-anisotropic) and [](#thm-structural-error-anisotropic). Since both components contract at rates $\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}} = O(\\min\\{\\gamma, c_{\\min}\\})$, their sum contracts at rate $\\min\\{\\kappa_{\\text{loc}}, \\kappa_{\\text{struct}}\\}$.\n1808: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Anisotropic Kinetic Operator Analysis"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-901",
      "title": null,
      "start_line": 1837,
      "end_line": 1861,
      "header_lines": [],
      "content_start": 1838,
      "content_end": 1860,
      "content": "1838: \n1839: :::{prf:proof}\n1840: **Step 1**: Position evolves as $dx = v \\, dt$ (no noise, no force).\n1841: \n1842: **Step 2**: The generator acting on $V_{\\text{Var},x} = |V_{\\text{Var},x}(S_1) - V_{\\text{Var},x}(S_2)|$ is:\n1843: \n1844: $$\n1845: \\mathcal{L} V_{\\text{Var},x} = 2 \\langle x - \\bar{x}, v - \\bar{v} \\rangle\n1846: $$\n1847: \n1848: **Step 3**: By Cauchy-Schwarz and the velocity bound $\\|v\\| \\le V_{\\max}$:\n1849: \n1850: $$\n1851: |\\mathcal{L} V_{\\text{Var},x}| \\le 2 V_{\\max} \\sqrt{V_{\\text{Var},x}}\n1852: $$\n1853: \n1854: **Step 4**: Using Young's inequality, this is bounded by a constant independent of $V_{\\text{Var},x}$:\n1855: \n1856: $$\n1857: \\mathcal{L} V_{\\text{Var},x} \\le C'_x\n1858: $$\n1859: \n1860: **Step 5**: Discrete-time result follows from integration.",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "references": [],
      "raw_directive": "1837: :::\n1838: \n1839: :::{prf:proof}\n1840: **Step 1**: Position evolves as $dx = v \\, dt$ (no noise, no force).\n1841: \n1842: **Step 2**: The generator acting on $V_{\\text{Var},x} = |V_{\\text{Var},x}(S_1) - V_{\\text{Var},x}(S_2)|$ is:\n1843: \n1844: $$\n1845: \\mathcal{L} V_{\\text{Var},x} = 2 \\langle x - \\bar{x}, v - \\bar{v} \\rangle\n1846: $$\n1847: \n1848: **Step 3**: By Cauchy-Schwarz and the velocity bound $\\|v\\| \\le V_{\\max}$:\n1849: \n1850: $$\n1851: |\\mathcal{L} V_{\\text{Var},x}| \\le 2 V_{\\max} \\sqrt{V_{\\text{Var},x}}\n1852: $$\n1853: \n1854: **Step 4**: Using Young's inequality, this is bounded by a constant independent of $V_{\\text{Var},x}$:\n1855: \n1856: $$\n1857: \\mathcal{L} V_{\\text{Var},x} \\le C'_x\n1858: $$\n1859: \n1860: **Step 5**: Discrete-time result follows from integration.\n1861: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Anisotropic Kinetic Operator Analysis"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-941",
      "title": null,
      "start_line": 1877,
      "end_line": 1899,
      "header_lines": [],
      "content_start": 1878,
      "content_end": 1898,
      "content": "1878: \n1879: :::{prf:proof}\n1880: **Step 1**: The confining force $F(x) = -\\nabla U(x)$ points inward near the boundary with strength $\\langle x, \\nabla U(x) \\rangle \\ge \\alpha_U \\|x\\|^2 - R_U$ (Axiom 1.3.1).\n1881: \n1882: **Step 2**: The generator acting on $W_b = \\sum_k \\frac{1}{N_k} \\sum_i w_b(x_{k,i})$ includes the force term:\n1883: \n1884: $$\n1885: \\mathcal{L} w_b(x) = \\langle \\nabla w_b(x), v \\rangle + \\langle \\nabla w_b(x), F(x) \\rangle + \\text{diffusion}\n1886: $$\n1887: \n1888: **Step 3**: Near the boundary, $\\nabla w_b$ points outward and $F$ points inward, giving:\n1889: \n1890: $$\n1891: \\langle \\nabla w_b(x), F(x) \\rangle \\le -\\alpha_U w_b(x)\n1892: $$\n1893: \n1894: **Step 4**: The velocity and diffusion terms contribute bounded constants. The force dominates:\n1895: \n1896: $$\n1897: \\mathcal{L} W_b \\le -\\kappa'_b W_b + C'_b\n1898: $$",
      "metadata": {},
      "section": "## 5. Anisotropic Kinetic Operator Analysis",
      "references": [],
      "raw_directive": "1877: :::\n1878: \n1879: :::{prf:proof}\n1880: **Step 1**: The confining force $F(x) = -\\nabla U(x)$ points inward near the boundary with strength $\\langle x, \\nabla U(x) \\rangle \\ge \\alpha_U \\|x\\|^2 - R_U$ (Axiom 1.3.1).\n1881: \n1882: **Step 2**: The generator acting on $W_b = \\sum_k \\frac{1}{N_k} \\sum_i w_b(x_{k,i})$ includes the force term:\n1883: \n1884: $$\n1885: \\mathcal{L} w_b(x) = \\langle \\nabla w_b(x), v \\rangle + \\langle \\nabla w_b(x), F(x) \\rangle + \\text{diffusion}\n1886: $$\n1887: \n1888: **Step 3**: Near the boundary, $\\nabla w_b$ points outward and $F$ points inward, giving:\n1889: \n1890: $$\n1891: \\langle \\nabla w_b(x), F(x) \\rangle \\le -\\alpha_U w_b(x)\n1892: $$\n1893: \n1894: **Step 4**: The velocity and diffusion terms contribute bounded constants. The force dominates:\n1895: \n1896: $$\n1897: \\mathcal{L} W_b \\le -\\kappa'_b W_b + C'_b\n1898: $$\n1899: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 5,
        "chapter_file": "chapter_5.json",
        "section_id": "## 5. Anisotropic Kinetic Operator Analysis"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-33",
      "title": null,
      "start_line": 1950,
      "end_line": 2131,
      "header_lines": [
        2114
      ],
      "content_start": 1951,
      "content_end": 2130,
      "content": "1951: \n1952: :::{prf:proof}\n1953: This proof uses exact iterated expectations without first-order approximations.\n1954: \n1955: **Step 1: Notation and Tower Property**\n1956: \n1957: Let $S$ denote the initial coupled state $(S_1, S_2)$. The full update is:\n1958: \n1959: $$\n1960: S \\xrightarrow{\\Psi_{\\text{clone}}} S' \\xrightarrow{\\Psi_{\\text{kin}}} S''\n1961: $$\n1962: \n1963: By the tower property of conditional expectation:\n1964: \n1965: $$\n1966: \\mathbb{E}[V_{\\text{total}}(S'') \\mid S] = \\mathbb{E}[\\mathbb{E}[V_{\\text{total}}(S'') \\mid S'] \\mid S]\n1967: $$\n1968: \n1969: **Step 2: Kinetic Drift Inequalities (Inner Conditional Expectation)**\n1970: \n1971: From Chapter 3, for each component:\n1972: \n1973: $$\n1974: \\begin{aligned}\n1975: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S'] &\\le (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S') + C'_v \\tau \\\\\n1976: \\mathbb{E}[V_W(S'') \\mid S'] &\\le (1 - \\kappa'_W \\tau) V_W(S') + C'_W \\tau \\\\\n1977: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S'] &\\le V_{\\text{Var},x}(S') + C'_x \\tau \\\\\n1978: \\mathbb{E}[W_b(S'') \\mid S'] &\\le (1 - \\kappa'_b \\tau) W_b(S') + C'_b \\tau\n1979: \\end{aligned}\n1980: $$\n1981: \n1982: where $\\kappa'_W = O(\\min\\{\\gamma, c_{\\min}\\})$ and all constants are N-uniform.\n1983: \n1984: **Step 3: Cloning Drift Inequalities**\n1985: \n1986: From `../1_euclidean_gas/03_cloning.md`:\n1987: \n1988: $$\n1989: \\begin{aligned}\n1990: \\mathbb{E}[V_{\\text{Var},x}(S') \\mid S] &\\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + C_x \\\\\n1991: \\mathbb{E}[V_{\\text{Var},v}(S') \\mid S] &\\le V_{\\text{Var},v}(S) + C_v \\\\\n1992: \\mathbb{E}[V_W(S') \\mid S] &\\le V_W(S) + C_W \\\\\n1993: \\mathbb{E}[W_b(S') \\mid S] &\\le (1 - \\kappa_b) W_b(S) + C_b\n1994: \\end{aligned}\n1995: $$\n1996: \n1997: where $\\kappa_x, \\kappa_b > 0$ and all constants are N-uniform.\n1998: \n1999: **Step 4: Compose via Tower Property (Component-by-Component)**\n2000: \n2001: **For $V_{\\text{Var},v}$:**\n2002: \n2003: $$\n2004: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S] = \\mathbb{E}[\\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S'] \\mid S]\n2005: $$\n2006: \n2007: $$\n2008: \\le \\mathbb{E}[(1 - 2\\gamma \\tau) V_{\\text{Var},v}(S') + C'_v \\tau \\mid S]\n2009: $$\n2010: \n2011: $$\n2012: = (1 - 2\\gamma \\tau) \\mathbb{E}[V_{\\text{Var},v}(S') \\mid S] + C'_v \\tau\n2013: $$\n2014: \n2015: $$\n2016: \\le (1 - 2\\gamma \\tau) [V_{\\text{Var},v}(S) + C_v] + C'_v \\tau\n2017: $$\n2018: \n2019: $$\n2020: = (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S) + [(1 - 2\\gamma \\tau) C_v + C'_v \\tau]\n2021: $$\n2022: \n2023: **For $V_W$:**\n2024: \n2025: $$\n2026: \\mathbb{E}[V_W(S'') \\mid S] \\le (1 - \\kappa'_W \\tau) \\mathbb{E}[V_W(S') \\mid S] + C'_W \\tau\n2027: $$\n2028: \n2029: $$\n2030: \\le (1 - \\kappa'_W \\tau) [V_W(S) + C_W] + C'_W \\tau\n2031: $$\n2032: \n2033: $$\n2034: = (1 - \\kappa'_W \\tau) V_W(S) + [(1 - \\kappa'_W \\tau) C_W + C'_W \\tau]\n2035: $$\n2036: \n2037: **For $V_{\\text{Var},x}$:**\n2038: \n2039: $$\n2040: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S] \\le \\mathbb{E}[V_{\\text{Var},x}(S') + C'_x \\tau \\mid S]\n2041: $$\n2042: \n2043: $$\n2044: = \\mathbb{E}[V_{\\text{Var},x}(S') \\mid S] + C'_x \\tau\n2045: $$\n2046: \n2047: $$\n2048: \\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + C_x + C'_x \\tau\n2049: $$\n2050: \n2051: **For $W_b$:**\n2052: \n2053: $$\n2054: \\mathbb{E}[W_b(S'') \\mid S] \\le (1 - \\kappa'_b \\tau) \\mathbb{E}[W_b(S') \\mid S] + C'_b \\tau\n2055: $$\n2056: \n2057: $$\n2058: \\le (1 - \\kappa'_b \\tau) [(1 - \\kappa_b) W_b(S) + C_b] + C'_b \\tau\n2059: $$\n2060: \n2061: $$\n2062: = (1 - \\kappa'_b \\tau)(1 - \\kappa_b) W_b(S) + [(1 - \\kappa'_b \\tau) C_b + C'_b \\tau]\n2063: $$\n2064: \n2065: $$\n2066: = [1 - (\\kappa'_b \\tau + \\kappa_b) + \\kappa'_b \\tau \\kappa_b] W_b(S) + C_b^{\\text{total}}\n2067: $$\n2068: \n2069: **Step 5: Construct Total Lyapunov Function**\n2070: \n2071: Define $V_{\\text{inter}} = V_W + V_{\\text{Var},x} + V_{\\text{Var},v}$ and $V_{\\text{total}} = c_V V_{\\text{inter}} + c_B W_b$ with coupling constants $c_V, c_B > 0$ to be chosen.\n2072: \n2073: From Step 4:\n2074: \n2075: $$\n2076: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S] \\le (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S) + \\bar{C}_v\n2077: $$\n2078: \n2079: $$\n2080: \\mathbb{E}[V_W(S'') \\mid S] \\le (1 - \\kappa'_W \\tau) V_W(S) + \\bar{C}_W\n2081: $$\n2082: \n2083: $$\n2084: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S] \\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + \\bar{C}_x\n2085: $$\n2086: \n2087: where $\\bar{C}_v, \\bar{C}_W, \\bar{C}_x < \\infty$ are the combined constants.\n2088: \n2089: **Step 6: Determine Effective Rates**\n2090: \n2091: For $V_{\\text{inter}}$, the **worst-case** (smallest) contraction rate among the three components determines convergence. However, we must account for the fact that cloning does not contract $V_W$ or $V_{\\text{Var},v}$ (only expands by bounded $C$), while kinetics do contract these.\n2092: \n2093: The effective rate for $V_{\\text{inter}}$ is determined by balancing:\n2094: - Kinetic contraction of $V_W, V_{\\text{Var},v}$: rates $\\kappa'_W \\tau, 2\\gamma\\tau$\n2095: - Cloning contraction of $V_{\\text{Var},x}$: rate $\\kappa_x$\n2096: \n2097: Choose coupling constants such that:\n2098: \n2099: $$\n2100: c_V = 1, \\quad c_B \\ge \\max\\left\\{ \\frac{C_x + C'_x \\tau}{\\kappa_b}, \\frac{\\bar{C}_v + \\bar{C}_W}{\\kappa'_b \\tau} \\right\\}\n2101: $$\n2102: \n2103: This ensures the boundary contraction dominates its expansion constants.\n2104: \n2105: **Step 7: Second-Order Term Analysis**\n2106: \n2107: The composition of boundary contraction rates yields (from Step 4):\n2108: \n2109: $$\n2110: 1 - (\\kappa'_b \\tau + \\kappa_b) + \\kappa_b \\kappa'_b \\tau = 1 - \\kappa_b - \\kappa'_b \\tau (1 - \\kappa_b)\n2111: $$\n2112: \n2113: The **second-order term** $\\kappa_b \\kappa'_b \\tau$ has a **positive** contribution to the coefficient (reduces the total contraction rate). However, this is actually **expected and correct** for composition of contractive operators:\n2114: \n2115: :::{admonition} Why the Second-Order Term Matters\n2116: :class: note\n2117: \n2118: When two contractive operators are composed, the total contraction is:\n2119: \n2120: $$\n2121: (1 - \\kappa_1)(1 - \\kappa_2) = 1 - \\kappa_1 - \\kappa_2 + \\kappa_1 \\kappa_2\n2122: $$\n2123: \n2124: The cross term $\\kappa_1 \\kappa_2 > 0$ represents **diminishing returns**: contracting an already-contracted state provides less absolute improvement.\n2125: \n2126: **Key insight**: Despite this diminishing return, the effective rate is still:\n2127: \n2128: $$\n2129: \\kappa_{\\text{eff}} = \\kappa_1 + \\kappa_2 - \\kappa_1 \\kappa_2 = \\kappa_1 + \\kappa_2 (1 - \\kappa_1)\n2130: $$",
      "metadata": {
        "class": "note"
      },
      "section": "## 6. Operator Composition and Foster-Lyapunov Condition",
      "references": [],
      "raw_directive": "1950: :::\n1951: \n1952: :::{prf:proof}\n1953: This proof uses exact iterated expectations without first-order approximations.\n1954: \n1955: **Step 1: Notation and Tower Property**\n1956: \n1957: Let $S$ denote the initial coupled state $(S_1, S_2)$. The full update is:\n1958: \n1959: $$\n1960: S \\xrightarrow{\\Psi_{\\text{clone}}} S' \\xrightarrow{\\Psi_{\\text{kin}}} S''\n1961: $$\n1962: \n1963: By the tower property of conditional expectation:\n1964: \n1965: $$\n1966: \\mathbb{E}[V_{\\text{total}}(S'') \\mid S] = \\mathbb{E}[\\mathbb{E}[V_{\\text{total}}(S'') \\mid S'] \\mid S]\n1967: $$\n1968: \n1969: **Step 2: Kinetic Drift Inequalities (Inner Conditional Expectation)**\n1970: \n1971: From Chapter 3, for each component:\n1972: \n1973: $$\n1974: \\begin{aligned}\n1975: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S'] &\\le (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S') + C'_v \\tau \\\\\n1976: \\mathbb{E}[V_W(S'') \\mid S'] &\\le (1 - \\kappa'_W \\tau) V_W(S') + C'_W \\tau \\\\\n1977: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S'] &\\le V_{\\text{Var},x}(S') + C'_x \\tau \\\\\n1978: \\mathbb{E}[W_b(S'') \\mid S'] &\\le (1 - \\kappa'_b \\tau) W_b(S') + C'_b \\tau\n1979: \\end{aligned}\n1980: $$\n1981: \n1982: where $\\kappa'_W = O(\\min\\{\\gamma, c_{\\min}\\})$ and all constants are N-uniform.\n1983: \n1984: **Step 3: Cloning Drift Inequalities**\n1985: \n1986: From `../1_euclidean_gas/03_cloning.md`:\n1987: \n1988: $$\n1989: \\begin{aligned}\n1990: \\mathbb{E}[V_{\\text{Var},x}(S') \\mid S] &\\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + C_x \\\\\n1991: \\mathbb{E}[V_{\\text{Var},v}(S') \\mid S] &\\le V_{\\text{Var},v}(S) + C_v \\\\\n1992: \\mathbb{E}[V_W(S') \\mid S] &\\le V_W(S) + C_W \\\\\n1993: \\mathbb{E}[W_b(S') \\mid S] &\\le (1 - \\kappa_b) W_b(S) + C_b\n1994: \\end{aligned}\n1995: $$\n1996: \n1997: where $\\kappa_x, \\kappa_b > 0$ and all constants are N-uniform.\n1998: \n1999: **Step 4: Compose via Tower Property (Component-by-Component)**\n2000: \n2001: **For $V_{\\text{Var},v}$:**\n2002: \n2003: $$\n2004: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S] = \\mathbb{E}[\\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S'] \\mid S]\n2005: $$\n2006: \n2007: $$\n2008: \\le \\mathbb{E}[(1 - 2\\gamma \\tau) V_{\\text{Var},v}(S') + C'_v \\tau \\mid S]\n2009: $$\n2010: \n2011: $$\n2012: = (1 - 2\\gamma \\tau) \\mathbb{E}[V_{\\text{Var},v}(S') \\mid S] + C'_v \\tau\n2013: $$\n2014: \n2015: $$\n2016: \\le (1 - 2\\gamma \\tau) [V_{\\text{Var},v}(S) + C_v] + C'_v \\tau\n2017: $$\n2018: \n2019: $$\n2020: = (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S) + [(1 - 2\\gamma \\tau) C_v + C'_v \\tau]\n2021: $$\n2022: \n2023: **For $V_W$:**\n2024: \n2025: $$\n2026: \\mathbb{E}[V_W(S'') \\mid S] \\le (1 - \\kappa'_W \\tau) \\mathbb{E}[V_W(S') \\mid S] + C'_W \\tau\n2027: $$\n2028: \n2029: $$\n2030: \\le (1 - \\kappa'_W \\tau) [V_W(S) + C_W] + C'_W \\tau\n2031: $$\n2032: \n2033: $$\n2034: = (1 - \\kappa'_W \\tau) V_W(S) + [(1 - \\kappa'_W \\tau) C_W + C'_W \\tau]\n2035: $$\n2036: \n2037: **For $V_{\\text{Var},x}$:**\n2038: \n2039: $$\n2040: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S] \\le \\mathbb{E}[V_{\\text{Var},x}(S') + C'_x \\tau \\mid S]\n2041: $$\n2042: \n2043: $$\n2044: = \\mathbb{E}[V_{\\text{Var},x}(S') \\mid S] + C'_x \\tau\n2045: $$\n2046: \n2047: $$\n2048: \\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + C_x + C'_x \\tau\n2049: $$\n2050: \n2051: **For $W_b$:**\n2052: \n2053: $$\n2054: \\mathbb{E}[W_b(S'') \\mid S] \\le (1 - \\kappa'_b \\tau) \\mathbb{E}[W_b(S') \\mid S] + C'_b \\tau\n2055: $$\n2056: \n2057: $$\n2058: \\le (1 - \\kappa'_b \\tau) [(1 - \\kappa_b) W_b(S) + C_b] + C'_b \\tau\n2059: $$\n2060: \n2061: $$\n2062: = (1 - \\kappa'_b \\tau)(1 - \\kappa_b) W_b(S) + [(1 - \\kappa'_b \\tau) C_b + C'_b \\tau]\n2063: $$\n2064: \n2065: $$\n2066: = [1 - (\\kappa'_b \\tau + \\kappa_b) + \\kappa'_b \\tau \\kappa_b] W_b(S) + C_b^{\\text{total}}\n2067: $$\n2068: \n2069: **Step 5: Construct Total Lyapunov Function**\n2070: \n2071: Define $V_{\\text{inter}} = V_W + V_{\\text{Var},x} + V_{\\text{Var},v}$ and $V_{\\text{total}} = c_V V_{\\text{inter}} + c_B W_b$ with coupling constants $c_V, c_B > 0$ to be chosen.\n2072: \n2073: From Step 4:\n2074: \n2075: $$\n2076: \\mathbb{E}[V_{\\text{Var},v}(S'') \\mid S] \\le (1 - 2\\gamma \\tau) V_{\\text{Var},v}(S) + \\bar{C}_v\n2077: $$\n2078: \n2079: $$\n2080: \\mathbb{E}[V_W(S'') \\mid S] \\le (1 - \\kappa'_W \\tau) V_W(S) + \\bar{C}_W\n2081: $$\n2082: \n2083: $$\n2084: \\mathbb{E}[V_{\\text{Var},x}(S'') \\mid S] \\le (1 - \\kappa_x) V_{\\text{Var},x}(S) + \\bar{C}_x\n2085: $$\n2086: \n2087: where $\\bar{C}_v, \\bar{C}_W, \\bar{C}_x < \\infty$ are the combined constants.\n2088: \n2089: **Step 6: Determine Effective Rates**\n2090: \n2091: For $V_{\\text{inter}}$, the **worst-case** (smallest) contraction rate among the three components determines convergence. However, we must account for the fact that cloning does not contract $V_W$ or $V_{\\text{Var},v}$ (only expands by bounded $C$), while kinetics do contract these.\n2092: \n2093: The effective rate for $V_{\\text{inter}}$ is determined by balancing:\n2094: - Kinetic contraction of $V_W, V_{\\text{Var},v}$: rates $\\kappa'_W \\tau, 2\\gamma\\tau$\n2095: - Cloning contraction of $V_{\\text{Var},x}$: rate $\\kappa_x$\n2096: \n2097: Choose coupling constants such that:\n2098: \n2099: $$\n2100: c_V = 1, \\quad c_B \\ge \\max\\left\\{ \\frac{C_x + C'_x \\tau}{\\kappa_b}, \\frac{\\bar{C}_v + \\bar{C}_W}{\\kappa'_b \\tau} \\right\\}\n2101: $$\n2102: \n2103: This ensures the boundary contraction dominates its expansion constants.\n2104: \n2105: **Step 7: Second-Order Term Analysis**\n2106: \n2107: The composition of boundary contraction rates yields (from Step 4):\n2108: \n2109: $$\n2110: 1 - (\\kappa'_b \\tau + \\kappa_b) + \\kappa_b \\kappa'_b \\tau = 1 - \\kappa_b - \\kappa'_b \\tau (1 - \\kappa_b)\n2111: $$\n2112: \n2113: The **second-order term** $\\kappa_b \\kappa'_b \\tau$ has a **positive** contribution to the coefficient (reduces the total contraction rate). However, this is actually **expected and correct** for composition of contractive operators:\n2114: \n2115: :::{admonition} Why the Second-Order Term Matters\n2116: :class: note\n2117: \n2118: When two contractive operators are composed, the total contraction is:\n2119: \n2120: $$\n2121: (1 - \\kappa_1)(1 - \\kappa_2) = 1 - \\kappa_1 - \\kappa_2 + \\kappa_1 \\kappa_2\n2122: $$\n2123: \n2124: The cross term $\\kappa_1 \\kappa_2 > 0$ represents **diminishing returns**: contracting an already-contracted state provides less absolute improvement.\n2125: \n2126: **Key insight**: Despite this diminishing return, the effective rate is still:\n2127: \n2128: $$\n2129: \\kappa_{\\text{eff}} = \\kappa_1 + \\kappa_2 - \\kappa_1 \\kappa_2 = \\kappa_1 + \\kappa_2 (1 - \\kappa_1)\n2130: $$\n2131: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 6,
        "chapter_file": "chapter_6.json",
        "section_id": "## 6. Operator Composition and Foster-Lyapunov Condition"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-47",
      "title": null,
      "start_line": 2245,
      "end_line": 2288,
      "header_lines": [],
      "content_start": 2246,
      "content_end": 2287,
      "content": "2246: \n2247: :::{prf:proof}\n2248: This follows directly from the operator composition proof (Theorem [](#thm-foster-lyapunov-adaptive), Step 7).\n2249: \n2250: **Step 1: Kinetic contraction rates** (from Chapter 3):\n2251: - Velocity: $\\kappa'_v = 2\\gamma$ (Theorem [](#thm-velocity-variance-anisotropic))\n2252: - Wasserstein: $\\kappa'_W = O(\\min\\{\\gamma, c_{\\min}\\})$ (Theorem [](#thm-hypocoercive-main))\n2253: - Boundary: $\\kappa'_b = O(\\alpha_U)$ (Theorem [](#thm-boundary-contraction))\n2254: \n2255: **Step 2: Combined kinetic rate**:\n2256: \n2257: The inter-swarm component $V_{\\text{inter}} = V_W + V_{\\text{Var},x} + V_{\\text{Var},v}$ has net kinetic contraction:\n2258: \n2259: $$\n2260: \\kappa_{\\text{kin}} = \\min\\{2\\gamma, \\kappa'_W\\} = \\min\\left\\{2\\gamma, O(\\min\\{\\gamma, c_{\\min}\\})\\right\\} = O(\\min\\{\\gamma, c_{\\min}\\})\n2261: $$\n2262: \n2263: Multiplying by timestep $\\tau$: kinetic contribution is $O(\\min\\{\\gamma, c_{\\min}\\}) \\tau$.\n2264: \n2265: **Step 3: Cloning contraction rates**:\n2266: - Position variance: $\\kappa_x$ (dominates kinetic expansion $C'_x$)\n2267: - Boundary: $\\kappa_b$ (compounds with kinetic boundary rate)\n2268: \n2269: **Step 4: Foster-Lyapunov composition**:\n2270: \n2271: From the proof of Theorem [](#thm-foster-lyapunov-adaptive), Step 7:\n2272: \n2273: $$\n2274: \\kappa_{\\text{total}} = \\min\\{\\kappa_x, \\, \\kappa'_W \\tau, \\, 2\\gamma\\tau, \\, \\kappa_b + \\kappa'_b \\tau\\}\n2275: $$\n2276: \n2277: Since $\\kappa'_W = O(\\min\\{\\gamma, c_{\\min}\\})$ and $2\\gamma > \\gamma$:\n2278: \n2279: $$\n2280: \\min\\{\\kappa'_W \\tau, 2\\gamma\\tau\\} = O(\\min\\{\\gamma, c_{\\min}\\}) \\tau\n2281: $$\n2282: \n2283: Substituting $c_{\\min} = \\epsilon_\\Sigma / (\\lambda_{\\max}(H) + \\epsilon_\\Sigma)$ and $\\kappa'_b = O(\\alpha_U)$:\n2284: \n2285: $$\n2286: \\kappa_{\\text{total}} = \\min\\left\\{ \\kappa_x, \\quad \\min\\left\\{\\gamma, \\frac{\\epsilon_\\Sigma}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}\\right\\} \\tau, \\quad \\kappa_b + O(\\alpha_U) \\tau \\right\\}\n2287: $$",
      "metadata": {},
      "section": "## 7. Explicit Convergence Constants and Algorithmic Parameter Dependence",
      "references": [],
      "raw_directive": "2245: :::\n2246: \n2247: :::{prf:proof}\n2248: This follows directly from the operator composition proof (Theorem [](#thm-foster-lyapunov-adaptive), Step 7).\n2249: \n2250: **Step 1: Kinetic contraction rates** (from Chapter 3):\n2251: - Velocity: $\\kappa'_v = 2\\gamma$ (Theorem [](#thm-velocity-variance-anisotropic))\n2252: - Wasserstein: $\\kappa'_W = O(\\min\\{\\gamma, c_{\\min}\\})$ (Theorem [](#thm-hypocoercive-main))\n2253: - Boundary: $\\kappa'_b = O(\\alpha_U)$ (Theorem [](#thm-boundary-contraction))\n2254: \n2255: **Step 2: Combined kinetic rate**:\n2256: \n2257: The inter-swarm component $V_{\\text{inter}} = V_W + V_{\\text{Var},x} + V_{\\text{Var},v}$ has net kinetic contraction:\n2258: \n2259: $$\n2260: \\kappa_{\\text{kin}} = \\min\\{2\\gamma, \\kappa'_W\\} = \\min\\left\\{2\\gamma, O(\\min\\{\\gamma, c_{\\min}\\})\\right\\} = O(\\min\\{\\gamma, c_{\\min}\\})\n2261: $$\n2262: \n2263: Multiplying by timestep $\\tau$: kinetic contribution is $O(\\min\\{\\gamma, c_{\\min}\\}) \\tau$.\n2264: \n2265: **Step 3: Cloning contraction rates**:\n2266: - Position variance: $\\kappa_x$ (dominates kinetic expansion $C'_x$)\n2267: - Boundary: $\\kappa_b$ (compounds with kinetic boundary rate)\n2268: \n2269: **Step 4: Foster-Lyapunov composition**:\n2270: \n2271: From the proof of Theorem [](#thm-foster-lyapunov-adaptive), Step 7:\n2272: \n2273: $$\n2274: \\kappa_{\\text{total}} = \\min\\{\\kappa_x, \\, \\kappa'_W \\tau, \\, 2\\gamma\\tau, \\, \\kappa_b + \\kappa'_b \\tau\\}\n2275: $$\n2276: \n2277: Since $\\kappa'_W = O(\\min\\{\\gamma, c_{\\min}\\})$ and $2\\gamma > \\gamma$:\n2278: \n2279: $$\n2280: \\min\\{\\kappa'_W \\tau, 2\\gamma\\tau\\} = O(\\min\\{\\gamma, c_{\\min}\\}) \\tau\n2281: $$\n2282: \n2283: Substituting $c_{\\min} = \\epsilon_\\Sigma / (\\lambda_{\\max}(H) + \\epsilon_\\Sigma)$ and $\\kappa'_b = O(\\alpha_U)$:\n2284: \n2285: $$\n2286: \\kappa_{\\text{total}} = \\min\\left\\{ \\kappa_x, \\quad \\min\\left\\{\\gamma, \\frac{\\epsilon_\\Sigma}{\\lambda_{\\max}(H) + \\epsilon_\\Sigma}\\right\\} \\tau, \\quad \\kappa_b + O(\\alpha_U) \\tau \\right\\}\n2287: $$\n2288: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. Explicit Convergence Constants and Algorithmic Parameter Dependence"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-117",
      "title": null,
      "start_line": 2315,
      "end_line": 2391,
      "header_lines": [],
      "content_start": 2316,
      "content_end": 2390,
      "content": "2316: \n2317: :::{prf:proof}\n2318: From the operator composition proof (Theorem [](#thm-foster-lyapunov-adaptive), Step 8):\n2319: \n2320: $$\n2321: C_{\\text{total}} = c_V (\\bar{C}_v + \\bar{C}_W + \\bar{C}_x) + c_B C_b^{\\text{total}}\n2322: $$\n2323: \n2324: **Step 1: Kinetic expansion constants** (from Chapter 3):\n2325: \n2326: **Velocity variance** (Theorem [](#thm-velocity-variance-anisotropic), Step 8):\n2327: \n2328: $$\n2329: C'_v = 2[c_{\\max} d + NC_{\\text{Itô}}^2 + O(\\|F\\|_\\infty)] = \\frac{2d}{\\epsilon_\\Sigma} + 2NC_{\\text{Itô}}^2 + O(\\|F\\|_\\infty)\n2330: $$\n2331: \n2332: (using $c_{\\max} = 1/\\epsilon_\\Sigma$ from Theorem [](#thm-uniform-ellipticity) and including the Itô correction term from Lemma [](#lem-ito-correction-bound)).\n2333: \n2334: **Wasserstein distance** (Theorem [](#thm-location-error-anisotropic), Step 7):\n2335: \n2336: $$\n2337: C'_W = 4\\lambda_v c_{\\max} d = \\frac{4d}{\\gamma} \\cdot \\frac{1}{\\epsilon_\\Sigma} = \\frac{4d}{\\gamma \\epsilon_\\Sigma}\n2338: $$\n2339: \n2340: (using $\\lambda_v = 1/\\gamma$ from optimal hypocoercive parameters).\n2341: \n2342: **Position variance** (Theorem [](#thm-position-variance-expansion)):\n2343: \n2344: $$\n2345: C'_x = O(V_{\\max}^2)\n2346: $$\n2347: \n2348: **Boundary potential** (Theorem [](#thm-boundary-contraction)):\n2349: \n2350: $$\n2351: C'_b = O\\left(\\frac{\\|F\\|_\\infty^2}{\\alpha_U}\\right)\n2352: $$\n2353: \n2354: **Step 2: Cloning expansion constants** (from `../1_euclidean_gas/03_cloning.md`):\n2355: \n2356: $$\n2357: C_v, \\, C_W, \\, C_x, \\, C_b = O(1) \\text{ (problem-dependent, N-uniform)}\n2358: $$\n2359: \n2360: **Step 3: Combined constants**:\n2361: \n2362: From the operator composition (Theorem [](#thm-foster-lyapunov-adaptive), Step 4):\n2363: \n2364: $$\n2365: \\bar{C}_v = (1 - 2\\gamma\\tau) C_v + C'_v \\tau \\approx C_v + C'_v \\tau\n2366: $$\n2367: \n2368: $$\n2369: \\bar{C}_W = (1 - \\kappa'_W \\tau) C_W + C'_W \\tau \\approx C_W + C'_W \\tau\n2370: $$\n2371: \n2372: $$\n2373: \\bar{C}_x = C_x + C'_x \\tau\n2374: $$\n2375: \n2376: $$\n2377: C_b^{\\text{total}} = (1 - \\kappa'_b \\tau) C_b + C'_b \\tau \\approx C_b + C'_b \\tau\n2378: $$\n2379: \n2380: For small $\\tau$, the $(1 - \\kappa \\tau)$ factors are $\\approx 1$. The dominant terms are:\n2381: \n2382: $$\n2383: C_{\\text{total}} \\approx c_V [C'_v \\tau + C'_W \\tau + C'_x \\tau + C_v + C_W + C_x] + c_B [C_b + C'_b \\tau]\n2384: $$\n2385: \n2386: Absorbing $\\tau$ into the $O(\\cdot)$ notation and substituting explicit expressions:\n2387: \n2388: $$\n2389: C_{\\text{total}} = c_V \\left[ \\frac{2d}{\\epsilon_\\Sigma} + \\frac{4d}{\\gamma \\epsilon_\\Sigma} + O(V_{\\max}^2) + O(\\|F\\|_\\infty) + C_v + C_W + C_x \\right] + c_B \\left[ C_b + O\\left(\\frac{\\|F\\|_\\infty^2}{\\alpha_U}\\right) \\right]\n2390: $$",
      "metadata": {},
      "section": "## 7. Explicit Convergence Constants and Algorithmic Parameter Dependence",
      "references": [],
      "raw_directive": "2315: :::\n2316: \n2317: :::{prf:proof}\n2318: From the operator composition proof (Theorem [](#thm-foster-lyapunov-adaptive), Step 8):\n2319: \n2320: $$\n2321: C_{\\text{total}} = c_V (\\bar{C}_v + \\bar{C}_W + \\bar{C}_x) + c_B C_b^{\\text{total}}\n2322: $$\n2323: \n2324: **Step 1: Kinetic expansion constants** (from Chapter 3):\n2325: \n2326: **Velocity variance** (Theorem [](#thm-velocity-variance-anisotropic), Step 8):\n2327: \n2328: $$\n2329: C'_v = 2[c_{\\max} d + NC_{\\text{Itô}}^2 + O(\\|F\\|_\\infty)] = \\frac{2d}{\\epsilon_\\Sigma} + 2NC_{\\text{Itô}}^2 + O(\\|F\\|_\\infty)\n2330: $$\n2331: \n2332: (using $c_{\\max} = 1/\\epsilon_\\Sigma$ from Theorem [](#thm-uniform-ellipticity) and including the Itô correction term from Lemma [](#lem-ito-correction-bound)).\n2333: \n2334: **Wasserstein distance** (Theorem [](#thm-location-error-anisotropic), Step 7):\n2335: \n2336: $$\n2337: C'_W = 4\\lambda_v c_{\\max} d = \\frac{4d}{\\gamma} \\cdot \\frac{1}{\\epsilon_\\Sigma} = \\frac{4d}{\\gamma \\epsilon_\\Sigma}\n2338: $$\n2339: \n2340: (using $\\lambda_v = 1/\\gamma$ from optimal hypocoercive parameters).\n2341: \n2342: **Position variance** (Theorem [](#thm-position-variance-expansion)):\n2343: \n2344: $$\n2345: C'_x = O(V_{\\max}^2)\n2346: $$\n2347: \n2348: **Boundary potential** (Theorem [](#thm-boundary-contraction)):\n2349: \n2350: $$\n2351: C'_b = O\\left(\\frac{\\|F\\|_\\infty^2}{\\alpha_U}\\right)\n2352: $$\n2353: \n2354: **Step 2: Cloning expansion constants** (from `../1_euclidean_gas/03_cloning.md`):\n2355: \n2356: $$\n2357: C_v, \\, C_W, \\, C_x, \\, C_b = O(1) \\text{ (problem-dependent, N-uniform)}\n2358: $$\n2359: \n2360: **Step 3: Combined constants**:\n2361: \n2362: From the operator composition (Theorem [](#thm-foster-lyapunov-adaptive), Step 4):\n2363: \n2364: $$\n2365: \\bar{C}_v = (1 - 2\\gamma\\tau) C_v + C'_v \\tau \\approx C_v + C'_v \\tau\n2366: $$\n2367: \n2368: $$\n2369: \\bar{C}_W = (1 - \\kappa'_W \\tau) C_W + C'_W \\tau \\approx C_W + C'_W \\tau\n2370: $$\n2371: \n2372: $$\n2373: \\bar{C}_x = C_x + C'_x \\tau\n2374: $$\n2375: \n2376: $$\n2377: C_b^{\\text{total}} = (1 - \\kappa'_b \\tau) C_b + C'_b \\tau \\approx C_b + C'_b \\tau\n2378: $$\n2379: \n2380: For small $\\tau$, the $(1 - \\kappa \\tau)$ factors are $\\approx 1$. The dominant terms are:\n2381: \n2382: $$\n2383: C_{\\text{total}} \\approx c_V [C'_v \\tau + C'_W \\tau + C'_x \\tau + C_v + C_W + C_x] + c_B [C_b + C'_b \\tau]\n2384: $$\n2385: \n2386: Absorbing $\\tau$ into the $O(\\cdot)$ notation and substituting explicit expressions:\n2387: \n2388: $$\n2389: C_{\\text{total}} = c_V \\left[ \\frac{2d}{\\epsilon_\\Sigma} + \\frac{4d}{\\gamma \\epsilon_\\Sigma} + O(V_{\\max}^2) + O(\\|F\\|_\\infty) + C_v + C_W + C_x \\right] + c_B \\left[ C_b + O\\left(\\frac{\\|F\\|_\\infty^2}{\\alpha_U}\\right) \\right]\n2390: $$\n2391: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. Explicit Convergence Constants and Algorithmic Parameter Dependence"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-265",
      "title": null,
      "start_line": 2463,
      "end_line": 2493,
      "header_lines": [],
      "content_start": 2464,
      "content_end": 2492,
      "content": "2464: \n2465: :::{prf:proof}\n2466: This follows directly from the definition of mixing time for geometrically ergodic Markov chains. From Theorem [](#thm-main-convergence), Part 2:\n2467: \n2468: $$\n2469: \\|\\mathcal{L}(S_t \\mid S_0) - \\pi_{\\text{QSD}}\\|_{\\text{TV}} \\le C_\\pi (1 + V_{\\text{total}}(S_0, S_0)) (1 - \\kappa_{\\text{total}})^t\n2470: $$\n2471: \n2472: Setting the right-hand side equal to $\\epsilon$ and solving for $t$:\n2473: \n2474: $$\n2475: C_\\pi (1 + V_{\\text{total}}(S_0, S_0)) (1 - \\kappa_{\\text{total}})^t = \\epsilon\n2476: $$\n2477: \n2478: $$\n2479: (1 - \\kappa_{\\text{total}})^t = \\frac{\\epsilon}{C_\\pi (1 + V_{\\text{total}}(S_0, S_0))}\n2480: $$\n2481: \n2482: $$\n2483: t \\log(1 - \\kappa_{\\text{total}}) = \\log\\left( \\frac{\\epsilon}{C_\\pi (1 + V_{\\text{total}}(S_0, S_0))} \\right)\n2484: $$\n2485: \n2486: For small $\\kappa_{\\text{total}}$: $\\log(1 - \\kappa_{\\text{total}}) \\approx -\\kappa_{\\text{total}}$. Thus:\n2487: \n2488: $$\n2489: t \\approx \\frac{1}{\\kappa_{\\text{total}}} \\log\\left( \\frac{C_\\pi (1 + V_{\\text{total}}(S_0, S_0))}{\\epsilon} \\right)\n2490: $$\n2491: \n2492: The number of iterations is $n_{\\text{iter}} = \\lceil t/\\tau \\rceil$.",
      "metadata": {},
      "section": "## 7. Explicit Convergence Constants and Algorithmic Parameter Dependence",
      "references": [],
      "raw_directive": "2463: :::\n2464: \n2465: :::{prf:proof}\n2466: This follows directly from the definition of mixing time for geometrically ergodic Markov chains. From Theorem [](#thm-main-convergence), Part 2:\n2467: \n2468: $$\n2469: \\|\\mathcal{L}(S_t \\mid S_0) - \\pi_{\\text{QSD}}\\|_{\\text{TV}} \\le C_\\pi (1 + V_{\\text{total}}(S_0, S_0)) (1 - \\kappa_{\\text{total}})^t\n2470: $$\n2471: \n2472: Setting the right-hand side equal to $\\epsilon$ and solving for $t$:\n2473: \n2474: $$\n2475: C_\\pi (1 + V_{\\text{total}}(S_0, S_0)) (1 - \\kappa_{\\text{total}})^t = \\epsilon\n2476: $$\n2477: \n2478: $$\n2479: (1 - \\kappa_{\\text{total}})^t = \\frac{\\epsilon}{C_\\pi (1 + V_{\\text{total}}(S_0, S_0))}\n2480: $$\n2481: \n2482: $$\n2483: t \\log(1 - \\kappa_{\\text{total}}) = \\log\\left( \\frac{\\epsilon}{C_\\pi (1 + V_{\\text{total}}(S_0, S_0))} \\right)\n2484: $$\n2485: \n2486: For small $\\kappa_{\\text{total}}$: $\\log(1 - \\kappa_{\\text{total}}) \\approx -\\kappa_{\\text{total}}$. Thus:\n2487: \n2488: $$\n2489: t \\approx \\frac{1}{\\kappa_{\\text{total}}} \\log\\left( \\frac{C_\\pi (1 + V_{\\text{total}}(S_0, S_0))}{\\epsilon} \\right)\n2490: $$\n2491: \n2492: The number of iterations is $n_{\\text{iter}} = \\lceil t/\\tau \\rceil$.\n2493: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 7,
        "chapter_file": "chapter_7.json",
        "section_id": "## 7. Explicit Convergence Constants and Algorithmic Parameter Dependence"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-112",
      "title": null,
      "start_line": 2851,
      "end_line": 2977,
      "header_lines": [],
      "content_start": 2852,
      "content_end": 2976,
      "content": "2852: \n2853: :::{prf:proof}\n2854: We compute the Hessian by applying the chain rule twice. We first establish a technical lemma for the gradient of the localization weights.\n2855: \n2856: **Lemma: Gradient of Normalized Localization Weights.**\n2857: \n2858: For the normalized Gaussian weights:\n2859: \n2860: $$\n2861: w_{ij}(\\rho) = \\frac{K_\\rho(x, x_j)}{\\sum_{\\ell \\in A_k} K_\\rho(x, x_\\ell)} = \\frac{\\exp\\left(-\\frac{\\|x - x_j\\|^2}{2\\rho^2}\\right)}{\\sum_{\\ell \\in A_k} \\exp\\left(-\\frac{\\|x - x_\\ell\\|^2}{2\\rho^2}\\right)}\n2862: $$\n2863: \n2864: **Gradient derivation:** Using the quotient rule:\n2865: \n2866: $$\n2867: \\nabla_x w_{ij} = \\frac{\\nabla_x K_\\rho(x, x_j) \\cdot \\sum_\\ell K_\\rho(x, x_\\ell) - K_\\rho(x, x_j) \\cdot \\sum_\\ell \\nabla_x K_\\rho(x, x_\\ell)}{\\left(\\sum_\\ell K_\\rho(x, x_\\ell)\\right)^2}\n2868: $$\n2869: \n2870: For the Gaussian kernel, $\\nabla_x K_\\rho(x, x_j) = -\\frac{1}{\\rho^2} K_\\rho(x, x_j) (x - x_j)$. Therefore:\n2871: \n2872: $$\n2873: \\nabla_x w_{ij} = \\frac{-\\frac{1}{\\rho^2} K_\\rho(x, x_j) (x - x_j) \\sum_\\ell K_\\rho(x, x_\\ell) - K_\\rho(x, x_j) \\sum_\\ell \\left(-\\frac{1}{\\rho^2} K_\\rho(x, x_\\ell) (x - x_\\ell)\\right)}{\\left(\\sum_\\ell K_\\rho(x, x_\\ell)\\right)^2}\n2874: $$\n2875: \n2876: Simplifying using $w_{ij} = K_\\rho(x, x_j) / \\sum_\\ell K_\\rho(x, x_\\ell)$:\n2877: \n2878: $$\n2879: \\nabla_x w_{ij} = -\\frac{w_{ij}}{\\rho^2} (x - x_j) + \\frac{w_{ij}}{\\rho^2} \\sum_{\\ell \\in A_k} w_{i\\ell} (x - x_\\ell)\n2880: $$\n2881: \n2882: $$\n2883: = \\frac{1}{\\rho^2} w_{ij} \\left( \\sum_{\\ell \\in A_k} w_{i\\ell} (x - x_\\ell) - (x - x_j) \\right)\n2884: $$\n2885: \n2886: $$\n2887: = \\frac{1}{\\rho^2} \\left( w_{ij} \\sum_{\\ell \\in A_k} w_{i\\ell} (x - x_\\ell) - w_{ij} (x - x_j) \\right)\n2888: $$\n2889: \n2890: which can be rewritten as the formula used in the main proof. $\\square$\n2891: \n2892: **Step 1: First Derivative (Gradient).**\n2893: \n2894: By the chain rule for $V_{\\text{fit}}(x) = g_A(Z_\\rho(x))$:\n2895: \n2896: $$\n2897: \\nabla_x V_{\\text{fit}} = g'_A(Z) \\, \\nabla_x Z_\\rho\n2898: $$\n2899: \n2900: For the Z-score $Z_\\rho = \\frac{d(x) - \\mu_\\rho}{\\sigma'_\\rho}$, we have:\n2901: \n2902: $$\n2903: \\nabla_x Z_\\rho = \\frac{1}{\\sigma'_\\rho} \\left( \\nabla_x d - \\nabla_x \\mu_\\rho \\right) - \\frac{d(x) - \\mu_\\rho}{\\sigma'^2_\\rho} \\nabla_x \\sigma'_\\rho\n2904: $$\n2905: \n2906: **Moment Gradients.** The localized mean depends on $x$ through the weights:\n2907: \n2908: $$\n2909: \\mu_\\rho = \\sum_{j \\in A_k} w_{ij}(\\rho) d_j\n2910: $$\n2911: \n2912: $$\n2913: \\nabla_x \\mu_\\rho = \\sum_{j \\in A_k} (\\nabla_x w_{ij}) d_j\n2914: $$\n2915: \n2916: For the normalized Gaussian weights $w_{ij} = K_\\rho(x, x_j) / \\sum_\\ell K_\\rho(x, x_\\ell)$:\n2917: \n2918: $$\n2919: \\nabla_x w_{ij} = \\frac{1}{\\rho^2} \\left( w_{ij} (x - x_j) - \\sum_{\\ell \\in A_k} w_{i\\ell} w_{ij} (x - x_\\ell) \\right)\n2920: $$\n2921: \n2922: **Critical Telescoping Property:** The normalization constraint $\\sum_j w_{ij} = 1$ implies:\n2923: \n2924: $$\n2925: \\sum_{j \\in A_k} \\nabla_x w_{ij} = 0\n2926: $$\n2927: \n2928: This telescoping property ensures that the gradient of the mean is bounded **independently of $k$** (and thus $N$).\n2929: \n2930: **Step 2: Second Derivative (Hessian).**\n2931: \n2932: Taking another derivative of $\\nabla_x V_{\\text{fit}} = g'_A(Z) \\nabla_x Z$:\n2933: \n2934: $$\n2935: \\nabla^2_x V_{\\text{fit}} = g''_A(Z) \\, (\\nabla_x Z) \\otimes (\\nabla_x Z) + g'_A(Z) \\, \\nabla^2_x Z\n2936: $$\n2937: \n2938: **Term 1 (Outer Product):** The first term is a rank-1 matrix:\n2939: \n2940: $$\n2941: \\left[g''_A(Z) \\, \\nabla_x Z \\otimes \\nabla_x Z\\right]_{ab} = g''_A(Z) \\, \\frac{\\partial Z}{\\partial x_a} \\frac{\\partial Z}{\\partial x_b}\n2942: $$\n2943: \n2944: For the Z-score, to leading order (ignoring moment correction terms):\n2945: \n2946: $$\n2947: \\nabla_x Z \\approx \\frac{1}{\\sigma'_\\rho} \\nabla_x d\n2948: $$\n2949: \n2950: Thus:\n2951: \n2952: $$\n2953: g''_A(Z) \\, \\nabla_x Z \\otimes \\nabla_x Z \\approx \\frac{g''_A(Z)}{\\sigma'^2_\\rho} \\, \\nabla_x d \\otimes \\nabla_x d\n2954: $$\n2955: \n2956: **Term 2 (Hessian of Z-Score):** The second term involves:\n2957: \n2958: $$\n2959: \\nabla^2_x Z = \\frac{1}{\\sigma'_\\rho} (\\nabla^2_x d - \\nabla^2_x \\mu_\\rho) + \\text{(variance correction terms)}\n2960: $$\n2961: \n2962: The moment Hessian $\\nabla^2_x \\mu_\\rho$ involves second derivatives of the weights $w_{ij}$. By the same telescoping argument, these terms remain bounded.\n2963: \n2964: **Step 3: Explicit Bound.**\n2965: \n2966: Combining both terms and using the bounds:\n2967: - $|g'_A(Z)| \\le g'_{\\max}$, $|g''_A(Z)| \\le g''_{\\max}$ (smoothness of rescale function)\n2968: - $\\|\\nabla_x d\\|_\\infty \\le d'_{\\max}$, $\\|\\nabla^2_x d\\|_\\infty \\le d''_{\\max}$ (regularity of measurement)\n2969: - $\\sigma'_\\rho \\ge \\kappa_{\\text{var,min}}$ (regularization floor)\n2970: - $\\|\\nabla_x \\mu_\\rho\\|, \\|\\nabla^2_x \\mu_\\rho\\| = O(1/\\rho)$ (localization scale dependence)\n2971: \n2972: We obtain the **N-uniform bound**:\n2973: \n2974: $$\n2975: \\|H(x, S)\\| \\le H_{\\max}(\\rho) = \\frac{g''_{\\max} (d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}} + \\frac{g'_{\\max} d''_{\\max}}{\\kappa_{\\text{var,min}}} + O(1/\\rho)\n2976: $$",
      "metadata": {},
      "section": "## 11. Explicit Derivation of the Emergent Metric from Algorithmic Parameters",
      "references": [],
      "raw_directive": "2851: :::\n2852: \n2853: :::{prf:proof}\n2854: We compute the Hessian by applying the chain rule twice. We first establish a technical lemma for the gradient of the localization weights.\n2855: \n2856: **Lemma: Gradient of Normalized Localization Weights.**\n2857: \n2858: For the normalized Gaussian weights:\n2859: \n2860: $$\n2861: w_{ij}(\\rho) = \\frac{K_\\rho(x, x_j)}{\\sum_{\\ell \\in A_k} K_\\rho(x, x_\\ell)} = \\frac{\\exp\\left(-\\frac{\\|x - x_j\\|^2}{2\\rho^2}\\right)}{\\sum_{\\ell \\in A_k} \\exp\\left(-\\frac{\\|x - x_\\ell\\|^2}{2\\rho^2}\\right)}\n2862: $$\n2863: \n2864: **Gradient derivation:** Using the quotient rule:\n2865: \n2866: $$\n2867: \\nabla_x w_{ij} = \\frac{\\nabla_x K_\\rho(x, x_j) \\cdot \\sum_\\ell K_\\rho(x, x_\\ell) - K_\\rho(x, x_j) \\cdot \\sum_\\ell \\nabla_x K_\\rho(x, x_\\ell)}{\\left(\\sum_\\ell K_\\rho(x, x_\\ell)\\right)^2}\n2868: $$\n2869: \n2870: For the Gaussian kernel, $\\nabla_x K_\\rho(x, x_j) = -\\frac{1}{\\rho^2} K_\\rho(x, x_j) (x - x_j)$. Therefore:\n2871: \n2872: $$\n2873: \\nabla_x w_{ij} = \\frac{-\\frac{1}{\\rho^2} K_\\rho(x, x_j) (x - x_j) \\sum_\\ell K_\\rho(x, x_\\ell) - K_\\rho(x, x_j) \\sum_\\ell \\left(-\\frac{1}{\\rho^2} K_\\rho(x, x_\\ell) (x - x_\\ell)\\right)}{\\left(\\sum_\\ell K_\\rho(x, x_\\ell)\\right)^2}\n2874: $$\n2875: \n2876: Simplifying using $w_{ij} = K_\\rho(x, x_j) / \\sum_\\ell K_\\rho(x, x_\\ell)$:\n2877: \n2878: $$\n2879: \\nabla_x w_{ij} = -\\frac{w_{ij}}{\\rho^2} (x - x_j) + \\frac{w_{ij}}{\\rho^2} \\sum_{\\ell \\in A_k} w_{i\\ell} (x - x_\\ell)\n2880: $$\n2881: \n2882: $$\n2883: = \\frac{1}{\\rho^2} w_{ij} \\left( \\sum_{\\ell \\in A_k} w_{i\\ell} (x - x_\\ell) - (x - x_j) \\right)\n2884: $$\n2885: \n2886: $$\n2887: = \\frac{1}{\\rho^2} \\left( w_{ij} \\sum_{\\ell \\in A_k} w_{i\\ell} (x - x_\\ell) - w_{ij} (x - x_j) \\right)\n2888: $$\n2889: \n2890: which can be rewritten as the formula used in the main proof. $\\square$\n2891: \n2892: **Step 1: First Derivative (Gradient).**\n2893: \n2894: By the chain rule for $V_{\\text{fit}}(x) = g_A(Z_\\rho(x))$:\n2895: \n2896: $$\n2897: \\nabla_x V_{\\text{fit}} = g'_A(Z) \\, \\nabla_x Z_\\rho\n2898: $$\n2899: \n2900: For the Z-score $Z_\\rho = \\frac{d(x) - \\mu_\\rho}{\\sigma'_\\rho}$, we have:\n2901: \n2902: $$\n2903: \\nabla_x Z_\\rho = \\frac{1}{\\sigma'_\\rho} \\left( \\nabla_x d - \\nabla_x \\mu_\\rho \\right) - \\frac{d(x) - \\mu_\\rho}{\\sigma'^2_\\rho} \\nabla_x \\sigma'_\\rho\n2904: $$\n2905: \n2906: **Moment Gradients.** The localized mean depends on $x$ through the weights:\n2907: \n2908: $$\n2909: \\mu_\\rho = \\sum_{j \\in A_k} w_{ij}(\\rho) d_j\n2910: $$\n2911: \n2912: $$\n2913: \\nabla_x \\mu_\\rho = \\sum_{j \\in A_k} (\\nabla_x w_{ij}) d_j\n2914: $$\n2915: \n2916: For the normalized Gaussian weights $w_{ij} = K_\\rho(x, x_j) / \\sum_\\ell K_\\rho(x, x_\\ell)$:\n2917: \n2918: $$\n2919: \\nabla_x w_{ij} = \\frac{1}{\\rho^2} \\left( w_{ij} (x - x_j) - \\sum_{\\ell \\in A_k} w_{i\\ell} w_{ij} (x - x_\\ell) \\right)\n2920: $$\n2921: \n2922: **Critical Telescoping Property:** The normalization constraint $\\sum_j w_{ij} = 1$ implies:\n2923: \n2924: $$\n2925: \\sum_{j \\in A_k} \\nabla_x w_{ij} = 0\n2926: $$\n2927: \n2928: This telescoping property ensures that the gradient of the mean is bounded **independently of $k$** (and thus $N$).\n2929: \n2930: **Step 2: Second Derivative (Hessian).**\n2931: \n2932: Taking another derivative of $\\nabla_x V_{\\text{fit}} = g'_A(Z) \\nabla_x Z$:\n2933: \n2934: $$\n2935: \\nabla^2_x V_{\\text{fit}} = g''_A(Z) \\, (\\nabla_x Z) \\otimes (\\nabla_x Z) + g'_A(Z) \\, \\nabla^2_x Z\n2936: $$\n2937: \n2938: **Term 1 (Outer Product):** The first term is a rank-1 matrix:\n2939: \n2940: $$\n2941: \\left[g''_A(Z) \\, \\nabla_x Z \\otimes \\nabla_x Z\\right]_{ab} = g''_A(Z) \\, \\frac{\\partial Z}{\\partial x_a} \\frac{\\partial Z}{\\partial x_b}\n2942: $$\n2943: \n2944: For the Z-score, to leading order (ignoring moment correction terms):\n2945: \n2946: $$\n2947: \\nabla_x Z \\approx \\frac{1}{\\sigma'_\\rho} \\nabla_x d\n2948: $$\n2949: \n2950: Thus:\n2951: \n2952: $$\n2953: g''_A(Z) \\, \\nabla_x Z \\otimes \\nabla_x Z \\approx \\frac{g''_A(Z)}{\\sigma'^2_\\rho} \\, \\nabla_x d \\otimes \\nabla_x d\n2954: $$\n2955: \n2956: **Term 2 (Hessian of Z-Score):** The second term involves:\n2957: \n2958: $$\n2959: \\nabla^2_x Z = \\frac{1}{\\sigma'_\\rho} (\\nabla^2_x d - \\nabla^2_x \\mu_\\rho) + \\text{(variance correction terms)}\n2960: $$\n2961: \n2962: The moment Hessian $\\nabla^2_x \\mu_\\rho$ involves second derivatives of the weights $w_{ij}$. By the same telescoping argument, these terms remain bounded.\n2963: \n2964: **Step 3: Explicit Bound.**\n2965: \n2966: Combining both terms and using the bounds:\n2967: - $|g'_A(Z)| \\le g'_{\\max}$, $|g''_A(Z)| \\le g''_{\\max}$ (smoothness of rescale function)\n2968: - $\\|\\nabla_x d\\|_\\infty \\le d'_{\\max}$, $\\|\\nabla^2_x d\\|_\\infty \\le d''_{\\max}$ (regularity of measurement)\n2969: - $\\sigma'_\\rho \\ge \\kappa_{\\text{var,min}}$ (regularization floor)\n2970: - $\\|\\nabla_x \\mu_\\rho\\|, \\|\\nabla^2_x \\mu_\\rho\\| = O(1/\\rho)$ (localization scale dependence)\n2971: \n2972: We obtain the **N-uniform bound**:\n2973: \n2974: $$\n2975: \\|H(x, S)\\| \\le H_{\\max}(\\rho) = \\frac{g''_{\\max} (d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}} + \\frac{g'_{\\max} d''_{\\max}}{\\kappa_{\\text{var,min}}} + O(1/\\rho)\n2976: $$\n2977: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 11,
        "chapter_file": "chapter_11.json",
        "section_id": "## 11. Explicit Derivation of the Emergent Metric from Algorithmic Parameters"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-325",
      "title": null,
      "start_line": 3064,
      "end_line": 3196,
      "header_lines": [],
      "content_start": 3065,
      "content_end": 3195,
      "content": "3065: \n3066: :::{prf:proof}\n3067: **Step 1: Eigenvalue Bounds for $g(x, S)$.**\n3068: \n3069: Let $\\lambda_1, \\ldots, \\lambda_d$ be the eigenvalues of $H(x, S)$. Then the eigenvalues of $g(x, S) = H(x, S) + \\epsilon_\\Sigma I$ are:\n3070: \n3071: $$\n3072: \\lambda_i(g) = \\lambda_i(H) + \\epsilon_\\Sigma, \\quad i = 1, \\ldots, d\n3073: $$\n3074: \n3075: **Lower Bound:** By definition of the spectral floor:\n3076: \n3077: $$\n3078: \\lambda_i(H) \\ge -\\Lambda_-(\\rho) \\quad \\Rightarrow \\quad \\lambda_i(g) \\ge \\epsilon_\\Sigma - \\Lambda_-(\\rho) = c_{\\min}(\\rho)\n3079: $$\n3080: \n3081: If $\\epsilon_\\Sigma > \\Lambda_-(\\rho)$, then $c_{\\min}(\\rho) > 0$ and $g \\succ 0$ (positive definite).\n3082: \n3083: **Upper Bound:** By the Hessian bound from {prf:ref}`thm-explicit-hessian`:\n3084: \n3085: $$\n3086: \\lambda_i(H) \\le \\|H\\| \\le H_{\\max}(\\rho) \\quad \\Rightarrow \\quad \\lambda_i(g) \\le H_{\\max}(\\rho) + \\epsilon_\\Sigma = c_{\\max}\n3087: $$\n3088: \n3089: Therefore $c_{\\min}(\\rho) I \\preceq g(x, S) \\preceq c_{\\max} I$ in the Loewner ordering.\n3090: \n3091: **Step 2: Inverse and Square Root Bounds.**\n3092: \n3093: For a positive definite matrix $A$ with $c_1 I \\preceq A \\preceq c_2 I$, we have:\n3094: \n3095: $$\n3096: \\frac{1}{c_2} I \\preceq A^{-1} \\preceq \\frac{1}{c_1} I\n3097: $$\n3098: \n3099: Applying this to $D_{\\text{reg}} = g^{-1}$ gives the inverse bounds.\n3100: \n3101: For the square root $\\Sigma_{\\text{reg}} = D_{\\text{reg}}^{1/2} = g^{-1/2}$, the eigenvalues are $1/\\sqrt{\\lambda_i(g)}$, giving:\n3102: \n3103: $$\n3104: \\frac{1}{\\sqrt{c_{\\max}}} I \\preceq \\Sigma_{\\text{reg}} \\preceq \\frac{1}{\\sqrt{c_{\\min}(\\rho)}} I\n3105: $$\n3106: \n3107: **Step 3: Explicit Formulas for the Bounds.**\n3108: \n3109: **Part A: Spectral Ceiling $H_{\\max}(\\rho)$.**\n3110: \n3111: From {prf:ref}`thm-explicit-hessian`, we have:\n3112: \n3113: $$\n3114: H_{\\max}(\\rho) = \\frac{g''_{\\max} (d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}} + \\frac{g'_{\\max} d''_{\\max}}{\\kappa_{\\text{var,min}}} + O(1/\\rho)\n3115: $$\n3116: \n3117: where:\n3118: - $g''_{\\max} = \\sup_{z \\in \\mathbb{R}} |g''_A(z)|$ is the maximum second derivative of the rescale function\n3119: - $d'_{\\max} = \\sup_{x \\in \\mathcal{X}} \\|\\nabla_x d(x)\\|$ is the Lipschitz constant of the measurement function\n3120: - $d''_{\\max} = \\sup_{x \\in \\mathcal{X}} \\|\\nabla^2_x d(x)\\|_{\\text{op}}$ is the operator norm of the measurement Hessian\n3121: - The $O(1/\\rho)$ term captures moment correction contributions\n3122: \n3123: **Part B: Spectral Floor $\\Lambda_-(\\rho)$.**\n3124: \n3125: The spectral floor $\\Lambda_-(\\rho)$ bounds the maximum magnitude of negative eigenvalues of $H(x, S)$. From the Hessian decomposition:\n3126: \n3127: $$\n3128: H(x, S) = g''_A(Z) \\, \\nabla_x Z \\otimes \\nabla_x Z + g'_A(Z) \\, \\nabla^2_x Z\n3129: $$\n3130: \n3131: **Case 1: Convex Rescale Function ($g''_A \\ge 0$) and Convex Measurement ($\\nabla^2 d \\succeq 0$).**\n3132: \n3133: If both $g''_A(z) \\ge 0$ for all $z$ and $\\nabla^2_x d(x) \\succeq 0$ for all $x$ (positive semi-definite), then both terms in $H$ are positive semi-definite:\n3134: - The outer product $\\nabla_x Z \\otimes \\nabla_x Z \\succeq 0$ (rank-1 positive semi-definite)\n3135: - The scaled Hessian term $g'_A(Z) \\nabla^2_x Z \\succeq 0$ (since $g'_A > 0$ by monotonicity)\n3136: \n3137: Therefore $H \\succeq 0$ and $\\Lambda_-(\\rho) = 0$.\n3138: \n3139: **Case 2: General Case (Allowing Indefinite Hessians).**\n3140: \n3141: When the measurement Hessian $\\nabla^2_x d$ can have negative eigenvalues, or when $g''_A$ can be negative, we must bound the most negative eigenvalue:\n3142: \n3143: $$\n3144: \\Lambda_-(\\rho) = \\sup_{x, S} \\max\\{0, -\\lambda_{\\min}(H(x, S))\\}\n3145: $$\n3146: \n3147: For a symmetric matrix $M = A + B$, we have $\\lambda_{\\min}(M) \\ge \\lambda_{\\min}(A) + \\lambda_{\\min}(B)$. Therefore:\n3148: \n3149: $$\n3150: \\lambda_{\\min}(H) \\ge \\lambda_{\\min}(g''_A(Z) \\, \\nabla Z \\otimes \\nabla Z) + \\lambda_{\\min}(g'_A(Z) \\, \\nabla^2 Z)\n3151: $$\n3152: \n3153: **Term 1 (Outer Product):** The minimum eigenvalue of the rank-1 matrix $g''_A \\nabla Z \\otimes \\nabla Z$ is:\n3154: - If $g''_A(Z) \\ge 0$: $\\lambda_{\\min} = 0$ (has $d-1$ zero eigenvalues)\n3155: - If $g''_A(Z) < 0$: $\\lambda_{\\min} = g''_A(Z) \\|\\nabla Z\\|^2 \\ge -|g''_{\\max}| \\frac{(d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}}$\n3156: \n3157: **Term 2 (Scaled Hessian):** For the second term:\n3158: \n3159: $$\n3160: \\lambda_{\\min}(g'_A(Z) \\nabla^2 Z) = g'_A(Z) \\lambda_{\\min}(\\nabla^2 Z)\n3161: $$\n3162: \n3163: If $\\lambda_{\\min}(\\nabla^2 Z) < 0$ (indefinite), then using $g'_A(Z) \\le g'_{\\max}$ and defining:\n3164: \n3165: $$\n3166: d''_{\\min} = \\inf_{x \\in \\mathcal{X}} \\lambda_{\\min}(\\nabla^2_x d(x))\n3167: $$\n3168: \n3169: we have:\n3170: \n3171: $$\n3172: \\lambda_{\\min}(g'_A(Z) \\nabla^2 Z) \\ge g'_{\\min} \\cdot \\frac{d''_{\\min}}{\\kappa_{\\text{var,min}}}\n3173: $$\n3174: \n3175: where $g'_{\\min} = \\inf_{z} g'_A(z) > 0$ by monotonicity.\n3176: \n3177: **Combined Bound:**\n3178: \n3179: $$\n3180: -\\lambda_{\\min}(H) \\le \\max\\left\\{0, |g''_{\\max}| \\frac{(d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}} - g'_{\\min} \\frac{d''_{\\min}}{\\kappa_{\\text{var,min}}}\\right\\} + O(1/\\rho)\n3181: $$\n3182: \n3183: Therefore, the **explicit spectral floor bound** is:\n3184: \n3185: $$\n3186: \\Lambda_-(\\rho) = \\max\\left\\{0, |g''_{\\max}| \\frac{(d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}} - g'_{\\min} \\frac{d''_{\\min}}{\\kappa_{\\text{var,min}}}\\right\\} + C_{\\text{moment}}(\\rho)\n3187: $$\n3188: \n3189: where $C_{\\text{moment}}(\\rho) = O(1/\\rho)$ captures the moment correction terms and $d''_{\\min} = \\min\\{0, \\inf_x \\lambda_{\\min}(\\nabla^2 d(x))\\}$ is non-positive when the measurement can be concave.\n3190: \n3191: **Sufficient Condition for Positive Definiteness:** The regularization must satisfy:\n3192: \n3193: $$\n3194: \\epsilon_\\Sigma > \\Lambda_-(\\rho) = \\max\\left\\{0, |g''_{\\max}| \\frac{(d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}} - g'_{\\min} \\frac{d''_{\\min}}{\\kappa_{\\text{var,min}}}\\right\\} + C_{\\text{moment}}(\\rho)\n3195: $$",
      "metadata": {},
      "section": "## 11. Explicit Derivation of the Emergent Metric from Algorithmic Parameters",
      "references": [
        "thm-explicit-hessian"
      ],
      "raw_directive": "3064: :::\n3065: \n3066: :::{prf:proof}\n3067: **Step 1: Eigenvalue Bounds for $g(x, S)$.**\n3068: \n3069: Let $\\lambda_1, \\ldots, \\lambda_d$ be the eigenvalues of $H(x, S)$. Then the eigenvalues of $g(x, S) = H(x, S) + \\epsilon_\\Sigma I$ are:\n3070: \n3071: $$\n3072: \\lambda_i(g) = \\lambda_i(H) + \\epsilon_\\Sigma, \\quad i = 1, \\ldots, d\n3073: $$\n3074: \n3075: **Lower Bound:** By definition of the spectral floor:\n3076: \n3077: $$\n3078: \\lambda_i(H) \\ge -\\Lambda_-(\\rho) \\quad \\Rightarrow \\quad \\lambda_i(g) \\ge \\epsilon_\\Sigma - \\Lambda_-(\\rho) = c_{\\min}(\\rho)\n3079: $$\n3080: \n3081: If $\\epsilon_\\Sigma > \\Lambda_-(\\rho)$, then $c_{\\min}(\\rho) > 0$ and $g \\succ 0$ (positive definite).\n3082: \n3083: **Upper Bound:** By the Hessian bound from {prf:ref}`thm-explicit-hessian`:\n3084: \n3085: $$\n3086: \\lambda_i(H) \\le \\|H\\| \\le H_{\\max}(\\rho) \\quad \\Rightarrow \\quad \\lambda_i(g) \\le H_{\\max}(\\rho) + \\epsilon_\\Sigma = c_{\\max}\n3087: $$\n3088: \n3089: Therefore $c_{\\min}(\\rho) I \\preceq g(x, S) \\preceq c_{\\max} I$ in the Loewner ordering.\n3090: \n3091: **Step 2: Inverse and Square Root Bounds.**\n3092: \n3093: For a positive definite matrix $A$ with $c_1 I \\preceq A \\preceq c_2 I$, we have:\n3094: \n3095: $$\n3096: \\frac{1}{c_2} I \\preceq A^{-1} \\preceq \\frac{1}{c_1} I\n3097: $$\n3098: \n3099: Applying this to $D_{\\text{reg}} = g^{-1}$ gives the inverse bounds.\n3100: \n3101: For the square root $\\Sigma_{\\text{reg}} = D_{\\text{reg}}^{1/2} = g^{-1/2}$, the eigenvalues are $1/\\sqrt{\\lambda_i(g)}$, giving:\n3102: \n3103: $$\n3104: \\frac{1}{\\sqrt{c_{\\max}}} I \\preceq \\Sigma_{\\text{reg}} \\preceq \\frac{1}{\\sqrt{c_{\\min}(\\rho)}} I\n3105: $$\n3106: \n3107: **Step 3: Explicit Formulas for the Bounds.**\n3108: \n3109: **Part A: Spectral Ceiling $H_{\\max}(\\rho)$.**\n3110: \n3111: From {prf:ref}`thm-explicit-hessian`, we have:\n3112: \n3113: $$\n3114: H_{\\max}(\\rho) = \\frac{g''_{\\max} (d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}} + \\frac{g'_{\\max} d''_{\\max}}{\\kappa_{\\text{var,min}}} + O(1/\\rho)\n3115: $$\n3116: \n3117: where:\n3118: - $g''_{\\max} = \\sup_{z \\in \\mathbb{R}} |g''_A(z)|$ is the maximum second derivative of the rescale function\n3119: - $d'_{\\max} = \\sup_{x \\in \\mathcal{X}} \\|\\nabla_x d(x)\\|$ is the Lipschitz constant of the measurement function\n3120: - $d''_{\\max} = \\sup_{x \\in \\mathcal{X}} \\|\\nabla^2_x d(x)\\|_{\\text{op}}$ is the operator norm of the measurement Hessian\n3121: - The $O(1/\\rho)$ term captures moment correction contributions\n3122: \n3123: **Part B: Spectral Floor $\\Lambda_-(\\rho)$.**\n3124: \n3125: The spectral floor $\\Lambda_-(\\rho)$ bounds the maximum magnitude of negative eigenvalues of $H(x, S)$. From the Hessian decomposition:\n3126: \n3127: $$\n3128: H(x, S) = g''_A(Z) \\, \\nabla_x Z \\otimes \\nabla_x Z + g'_A(Z) \\, \\nabla^2_x Z\n3129: $$\n3130: \n3131: **Case 1: Convex Rescale Function ($g''_A \\ge 0$) and Convex Measurement ($\\nabla^2 d \\succeq 0$).**\n3132: \n3133: If both $g''_A(z) \\ge 0$ for all $z$ and $\\nabla^2_x d(x) \\succeq 0$ for all $x$ (positive semi-definite), then both terms in $H$ are positive semi-definite:\n3134: - The outer product $\\nabla_x Z \\otimes \\nabla_x Z \\succeq 0$ (rank-1 positive semi-definite)\n3135: - The scaled Hessian term $g'_A(Z) \\nabla^2_x Z \\succeq 0$ (since $g'_A > 0$ by monotonicity)\n3136: \n3137: Therefore $H \\succeq 0$ and $\\Lambda_-(\\rho) = 0$.\n3138: \n3139: **Case 2: General Case (Allowing Indefinite Hessians).**\n3140: \n3141: When the measurement Hessian $\\nabla^2_x d$ can have negative eigenvalues, or when $g''_A$ can be negative, we must bound the most negative eigenvalue:\n3142: \n3143: $$\n3144: \\Lambda_-(\\rho) = \\sup_{x, S} \\max\\{0, -\\lambda_{\\min}(H(x, S))\\}\n3145: $$\n3146: \n3147: For a symmetric matrix $M = A + B$, we have $\\lambda_{\\min}(M) \\ge \\lambda_{\\min}(A) + \\lambda_{\\min}(B)$. Therefore:\n3148: \n3149: $$\n3150: \\lambda_{\\min}(H) \\ge \\lambda_{\\min}(g''_A(Z) \\, \\nabla Z \\otimes \\nabla Z) + \\lambda_{\\min}(g'_A(Z) \\, \\nabla^2 Z)\n3151: $$\n3152: \n3153: **Term 1 (Outer Product):** The minimum eigenvalue of the rank-1 matrix $g''_A \\nabla Z \\otimes \\nabla Z$ is:\n3154: - If $g''_A(Z) \\ge 0$: $\\lambda_{\\min} = 0$ (has $d-1$ zero eigenvalues)\n3155: - If $g''_A(Z) < 0$: $\\lambda_{\\min} = g''_A(Z) \\|\\nabla Z\\|^2 \\ge -|g''_{\\max}| \\frac{(d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}}$\n3156: \n3157: **Term 2 (Scaled Hessian):** For the second term:\n3158: \n3159: $$\n3160: \\lambda_{\\min}(g'_A(Z) \\nabla^2 Z) = g'_A(Z) \\lambda_{\\min}(\\nabla^2 Z)\n3161: $$\n3162: \n3163: If $\\lambda_{\\min}(\\nabla^2 Z) < 0$ (indefinite), then using $g'_A(Z) \\le g'_{\\max}$ and defining:\n3164: \n3165: $$\n3166: d''_{\\min} = \\inf_{x \\in \\mathcal{X}} \\lambda_{\\min}(\\nabla^2_x d(x))\n3167: $$\n3168: \n3169: we have:\n3170: \n3171: $$\n3172: \\lambda_{\\min}(g'_A(Z) \\nabla^2 Z) \\ge g'_{\\min} \\cdot \\frac{d''_{\\min}}{\\kappa_{\\text{var,min}}}\n3173: $$\n3174: \n3175: where $g'_{\\min} = \\inf_{z} g'_A(z) > 0$ by monotonicity.\n3176: \n3177: **Combined Bound:**\n3178: \n3179: $$\n3180: -\\lambda_{\\min}(H) \\le \\max\\left\\{0, |g''_{\\max}| \\frac{(d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}} - g'_{\\min} \\frac{d''_{\\min}}{\\kappa_{\\text{var,min}}}\\right\\} + O(1/\\rho)\n3181: $$\n3182: \n3183: Therefore, the **explicit spectral floor bound** is:\n3184: \n3185: $$\n3186: \\Lambda_-(\\rho) = \\max\\left\\{0, |g''_{\\max}| \\frac{(d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}} - g'_{\\min} \\frac{d''_{\\min}}{\\kappa_{\\text{var,min}}}\\right\\} + C_{\\text{moment}}(\\rho)\n3187: $$\n3188: \n3189: where $C_{\\text{moment}}(\\rho) = O(1/\\rho)$ captures the moment correction terms and $d''_{\\min} = \\min\\{0, \\inf_x \\lambda_{\\min}(\\nabla^2 d(x))\\}$ is non-positive when the measurement can be concave.\n3190: \n3191: **Sufficient Condition for Positive Definiteness:** The regularization must satisfy:\n3192: \n3193: $$\n3194: \\epsilon_\\Sigma > \\Lambda_-(\\rho) = \\max\\left\\{0, |g''_{\\max}| \\frac{(d'_{\\max})^2}{\\kappa^2_{\\text{var,min}}} - g'_{\\min} \\frac{d''_{\\min}}{\\kappa_{\\text{var,min}}}\\right\\} + C_{\\text{moment}}(\\rho)\n3195: $$\n3196: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 11,
        "chapter_file": "chapter_11.json",
        "section_id": "## 11. Explicit Derivation of the Emergent Metric from Algorithmic Parameters"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-558",
      "title": null,
      "start_line": 3297,
      "end_line": 3329,
      "header_lines": [],
      "content_start": 3298,
      "content_end": 3328,
      "content": "3298: \n3299: :::{prf:proof}\n3300: **Part 1: Distance Formula.**\n3301: \n3302: By definition, the Riemannian distance is the infimum of lengths:\n3303: \n3304: $$\n3305: d_g(x_1, x_2) = \\inf_\\gamma \\int_0^1 \\sqrt{\\dot{\\gamma}^T g(\\gamma(t), S) \\dot{\\gamma}} \\, dt\n3306: $$\n3307: \n3308: In a region where $V_{\\text{fit}}$ is high and flat (low curvature), $H$ has small eigenvalues, so $g = H + \\epsilon_\\Sigma I \\approx \\epsilon_\\Sigma I$ (nearly Euclidean). In a region of low fitness and high curvature, $H$ has large eigenvalues, so $g$ is \"stretched\" (larger metric eigenvalues → longer distances).\n3309: \n3310: Therefore, paths through high-fitness regions incur smaller length than paths through low-fitness regions, even if the Euclidean distances are equal.\n3311: \n3312: **Part 2: Geodesic Deviation.**\n3313: \n3314: The geodesic equation involves the Christoffel symbols $\\Gamma^a_{bc}$, which depend on $\\partial g/\\partial x$. Since:\n3315: \n3316: $$\n3317: \\frac{\\partial g_{ab}}{\\partial x^c} = \\frac{\\partial}{\\partial x^c} \\left[\\nabla^2 V_{\\text{fit}}\\right]_{ab} = \\left[\\nabla^3 V_{\\text{fit}}\\right]_{abc}\n3318: $$\n3319: \n3320: the geodesic curvature is proportional to the **third derivatives of the fitness potential**. Regions of high curvature (large $\\|\\nabla^3 V_{\\text{fit}}\\|$) exert a \"repulsive force\" on geodesics, causing them to deviate.\n3321: \n3322: **Part 3: Natural Gradient Connection.**\n3323: \n3324: The natural gradient is defined as:\n3325: \n3326: $$\n3327: \\nabla^{\\text{nat}} V_{\\text{fit}} = g^{-1} \\nabla V_{\\text{fit}} = D_{\\text{reg}} \\nabla V_{\\text{fit}}\n3328: $$",
      "metadata": {},
      "section": "## 11. Explicit Derivation of the Emergent Metric from Algorithmic Parameters",
      "references": [],
      "raw_directive": "3297: :::\n3298: \n3299: :::{prf:proof}\n3300: **Part 1: Distance Formula.**\n3301: \n3302: By definition, the Riemannian distance is the infimum of lengths:\n3303: \n3304: $$\n3305: d_g(x_1, x_2) = \\inf_\\gamma \\int_0^1 \\sqrt{\\dot{\\gamma}^T g(\\gamma(t), S) \\dot{\\gamma}} \\, dt\n3306: $$\n3307: \n3308: In a region where $V_{\\text{fit}}$ is high and flat (low curvature), $H$ has small eigenvalues, so $g = H + \\epsilon_\\Sigma I \\approx \\epsilon_\\Sigma I$ (nearly Euclidean). In a region of low fitness and high curvature, $H$ has large eigenvalues, so $g$ is \"stretched\" (larger metric eigenvalues → longer distances).\n3309: \n3310: Therefore, paths through high-fitness regions incur smaller length than paths through low-fitness regions, even if the Euclidean distances are equal.\n3311: \n3312: **Part 2: Geodesic Deviation.**\n3313: \n3314: The geodesic equation involves the Christoffel symbols $\\Gamma^a_{bc}$, which depend on $\\partial g/\\partial x$. Since:\n3315: \n3316: $$\n3317: \\frac{\\partial g_{ab}}{\\partial x^c} = \\frac{\\partial}{\\partial x^c} \\left[\\nabla^2 V_{\\text{fit}}\\right]_{ab} = \\left[\\nabla^3 V_{\\text{fit}}\\right]_{abc}\n3318: $$\n3319: \n3320: the geodesic curvature is proportional to the **third derivatives of the fitness potential**. Regions of high curvature (large $\\|\\nabla^3 V_{\\text{fit}}\\|$) exert a \"repulsive force\" on geodesics, causing them to deviate.\n3321: \n3322: **Part 3: Natural Gradient Connection.**\n3323: \n3324: The natural gradient is defined as:\n3325: \n3326: $$\n3327: \\nabla^{\\text{nat}} V_{\\text{fit}} = g^{-1} \\nabla V_{\\text{fit}} = D_{\\text{reg}} \\nabla V_{\\text{fit}}\n3328: $$\n3329: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 11,
        "chapter_file": "chapter_11.json",
        "section_id": "## 11. Explicit Derivation of the Emergent Metric from Algorithmic Parameters"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-23",
      "title": null,
      "start_line": 3849,
      "end_line": 3976,
      "header_lines": [],
      "content_start": 3850,
      "content_end": 3975,
      "content": "3850: \n3851: :::{prf:proof}\n3852: **Strategy**: We show that at stationarity, the detailed balance condition for the cloning operator implies this flux balance through the Riemannian volume measure.\n3853: \n3854: **Part 1: Stationary Master Equation**\n3855: \n3856: At the QSD, the probability flux into and out of any configuration must balance. For the cloning operator, this reads:\n3857: \n3858: $$\n3859: \\sum_{X'} T_{\\text{clone}}(X \\to X') \\pi_{\\text{QSD}}(X) = \\sum_{X'} T_{\\text{clone}}(X' \\to X) \\pi_{\\text{QSD}}(X')\n3860: $$\n3861: \n3862: Focus on transitions where walker $i$ is replaced. The incoming flux (walker $i$ is created by some $j$ cloning from $k$) equals the outgoing flux (walker $i$ clones and is replaced).\n3863: \n3864: **Part 2: Spatial Marginal and Factorization**\n3865: \n3866: From Theorem {prf:ref}`thm-qsd-spatial-riemannian-volume` in Appendix A.1, the spatial marginal of QSD is:\n3867: \n3868: $$\n3869: \\rho_{\\text{spatial}}(x) \\propto \\sqrt{\\det g(x)} \\exp(-U_{\\text{eff}}(x)/T)\n3870: $$\n3871: \n3872: In the mean-field limit $N \\to \\infty$, the QSD factorizes as:\n3873: \n3874: $$\n3875: \\pi_{\\text{QSD}}(X) \\approx \\prod_{i=1}^N \\rho_1(x_i, v_i)\n3876: $$\n3877: \n3878: where $\\rho_1(x, v) \\propto \\sqrt{\\det g(x)} \\exp(-H_{\\text{eff}}(x,v)/T)$ is the single-particle density.\n3879: \n3880: **Part 3: Explicit Form of Single-Particle Density**\n3881: \n3882: From Part 2, the single-particle density at walker $i$'s state $(x_i, v_i)$ is:\n3883: \n3884: $$\n3885: \\rho_1(x_i, v_i) = C \\cdot \\sqrt{\\det g(x_i)} \\cdot \\exp(-H_{\\text{eff}}(x_i, v_i)/T)\n3886: $$\n3887: \n3888: where $C$ is a normalization constant. The key point: the **geometric factor $\\sqrt{\\det g(x_i)}$ is already present** in the stationary density.\n3889: \n3890: **Part 4: Cloning Flux Computation with Geometric Factors**\n3891: \n3892: The **outgoing flux** from walker $i$ (rate at which walker $i$ is replaced by cloning):\n3893: \n3894: $$\n3895: \\Gamma_{\\text{out}}(i) = p_i(S) \\cdot \\rho_1(x_i, v_i) = p_i(S) \\cdot C \\cdot \\sqrt{\\det g(x_i)} \\cdot e^{-H_{\\text{eff}}(x_i, v_i)/T}\n3896: $$\n3897: \n3898: where $p_i(S) = \\mathbb{E}_{c \\sim P_{\\text{comp}}}[\\text{clip}(S_i(c)/p_{\\max})]$ is the total cloning probability for walker $i$.\n3899: \n3900: The **incoming flux** to position $x_i$ (rate at which other walkers clone to create a new walker near $x_i$):\n3901: \n3902: $$\n3903: \\begin{align}\n3904: \\Gamma_{\\text{in}}(i) &= \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot \\rho_1(x_j, v_j) \\cdot K_{\\text{clone}}(x_j \\to x_i) \\\\\n3905: &\\approx \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot \\rho_1(x_j, v_j)\n3906: \\end{align}\n3907: $$\n3908: \n3909: where the second line uses the **local cloning approximation**: $K_{\\text{clone}}(x_j \\to x_i) \\approx \\delta(x_i - x_j)$ in the continuum limit (see justification below).\n3910: \n3911: **Crucially**, $\\rho_1(x_j, v_j)$ includes the factor $\\sqrt{\\det g(x_j)}$ from Part 3:\n3912: \n3913: $$\n3914: \\Gamma_{\\text{in}}(i) \\approx \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot C \\cdot \\sqrt{\\det g(x_j)} \\cdot e^{-H_{\\text{eff}}(x_j, v_j)/T}\n3915: $$\n3916: \n3917: **Justification of local cloning**: The cloning kernel $K_{\\text{clone}}(x_j \\to x_i) \\propto \\exp(-\\|x_i - x_j\\|^2/2\\sigma_{\\text{clone}}^2)$ has width $\\sigma_{\\text{clone}}$ much smaller than the typical distance over which $g(x)$ varies. In the continuum limit $N \\to \\infty$ with inter-particle spacing $O(N^{-1/d})$, the kernel converges weakly to $\\delta(x_i - x_j)$, making cloning effectively local.\n3918: \n3919: **Part 5: Stationarity and Geometric Balance**\n3920: \n3921: At stationarity, $\\Gamma_{\\text{in}}(i) = \\Gamma_{\\text{out}}(i)$. Using the explicit forms from Part 4:\n3922: \n3923: $$\n3924: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot C \\cdot \\sqrt{\\det g(x_j)} \\cdot e^{-H_{\\text{eff}}(x_j, v_j)/T} = p_i(S) \\cdot C \\cdot \\sqrt{\\det g(x_i)} \\cdot e^{-H_{\\text{eff}}(x_i, v_i)/T}\n3925: $$\n3926: \n3927: **Velocity thermalization**: On the timescale of spatial cloning dynamics, velocities rapidly thermalize to the Maxwell-Boltzmann distribution (Lemma {prf:ref}`lem-velocity-marginalization` in Appendix A.2). Therefore, for walkers at the same position $x$, the velocity-dependent factors $e^{-H_{\\text{eff}}/T}$ average out, and we can write:\n3928: \n3929: $$\n3930: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot \\sqrt{\\det g(x_j)} = p_i(S) \\cdot \\sqrt{\\det g(x_i)}\n3931: $$\n3932: \n3933: **Mean-field approximation**: In the large-$N$ limit, walkers are distributed according to the spatial marginal $\\rho_{\\text{spatial}}(x) \\propto \\sqrt{\\det g(x)} \\exp(-U_{\\text{eff}}(x)/T)$. For a sum over $j$ weighted by $P_{\\text{comp}}(i|j; S)$ (which depends on the swarm distribution), the geometric factors at different positions satisfy:\n3934: \n3935: $$\n3936: \\frac{1}{|\\mathcal{A}|} \\sum_{j \\in \\mathcal{A}} \\sqrt{\\det g(x_j)} \\xrightarrow{N \\to \\infty} \\langle \\det g \\rangle := \\frac{1}{|\\mathcal{A}|} \\sum_{k \\in \\mathcal{A}} \\sqrt{\\det g(x_k)}\n3937: $$\n3938: \n3939: where the convergence holds by the law of large numbers applied to the spatial marginal.\n3940: \n3941: Dividing both sides of the flux balance by $\\sqrt{\\det g(x_i)}$ and using the mean-field approximation:\n3942: \n3943: $$\n3944: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot \\frac{\\sqrt{\\det g(x_j)}}{\\sqrt{\\det g(x_i)}} = p_i(S)\n3945: $$\n3946: \n3947: **Weighted average convergence**: Define the selection-weighted average:\n3948: \n3949: $$\n3950: \\langle f \\rangle_{i,S} := \\frac{\\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot f(x_j)}{\\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S)}\n3951: $$\n3952: \n3953: For sufficiently smooth functions $f$, standard mean-field theory (McKean-Vlasov propagation of chaos; see Sznitman *Topics in propagation of chaos*, 1991, §3) gives:\n3954: \n3955: $$\n3956: \\mathbb{E}_{X \\sim \\pi_{\\text{QSD}}}[\\langle f \\rangle_{i,S}] \\xrightarrow{N \\to \\infty} \\int_{\\mathcal{X}} f(x) \\rho_{\\text{spatial}}(x) \\, dx\n3957: $$\n3958: \n3959: with variance $\\text{Var}[\\langle f \\rangle_{i,S}] = O(1/N)$. Applying this with $f(x) = \\sqrt{\\det g(x)}$ and using concentration of measure, the weighted average converges to the spatial mean $\\langle \\det g \\rangle$ with high probability. Therefore:\n3960: \n3961: $$\n3962: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot \\sqrt{\\det g(x_j)} \\approx \\left[\\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S)\\right] \\cdot \\langle \\det g \\rangle\n3963: $$\n3964: \n3965: which gives:\n3966: \n3967: $$\n3968: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\approx p_i(S) \\cdot \\frac{\\langle \\det g \\rangle}{\\sqrt{\\det g(x_i)}}\n3969: $$\n3970: \n3971: Rearranging gives the flux balance condition:\n3972: \n3973: $$\n3974: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) = p_i(S) \\cdot \\sqrt{\\frac{\\det g(x_i)}{\\langle \\det g \\rangle}}\n3975: $$",
      "metadata": {},
      "section": "## 13. Companion Selection Flux Balance at Stationarity",
      "references": [
        "thm-qsd-spatial-riemannian-volume",
        "lem-velocity-marginalization"
      ],
      "raw_directive": "3849: :::\n3850: \n3851: :::{prf:proof}\n3852: **Strategy**: We show that at stationarity, the detailed balance condition for the cloning operator implies this flux balance through the Riemannian volume measure.\n3853: \n3854: **Part 1: Stationary Master Equation**\n3855: \n3856: At the QSD, the probability flux into and out of any configuration must balance. For the cloning operator, this reads:\n3857: \n3858: $$\n3859: \\sum_{X'} T_{\\text{clone}}(X \\to X') \\pi_{\\text{QSD}}(X) = \\sum_{X'} T_{\\text{clone}}(X' \\to X) \\pi_{\\text{QSD}}(X')\n3860: $$\n3861: \n3862: Focus on transitions where walker $i$ is replaced. The incoming flux (walker $i$ is created by some $j$ cloning from $k$) equals the outgoing flux (walker $i$ clones and is replaced).\n3863: \n3864: **Part 2: Spatial Marginal and Factorization**\n3865: \n3866: From Theorem {prf:ref}`thm-qsd-spatial-riemannian-volume` in Appendix A.1, the spatial marginal of QSD is:\n3867: \n3868: $$\n3869: \\rho_{\\text{spatial}}(x) \\propto \\sqrt{\\det g(x)} \\exp(-U_{\\text{eff}}(x)/T)\n3870: $$\n3871: \n3872: In the mean-field limit $N \\to \\infty$, the QSD factorizes as:\n3873: \n3874: $$\n3875: \\pi_{\\text{QSD}}(X) \\approx \\prod_{i=1}^N \\rho_1(x_i, v_i)\n3876: $$\n3877: \n3878: where $\\rho_1(x, v) \\propto \\sqrt{\\det g(x)} \\exp(-H_{\\text{eff}}(x,v)/T)$ is the single-particle density.\n3879: \n3880: **Part 3: Explicit Form of Single-Particle Density**\n3881: \n3882: From Part 2, the single-particle density at walker $i$'s state $(x_i, v_i)$ is:\n3883: \n3884: $$\n3885: \\rho_1(x_i, v_i) = C \\cdot \\sqrt{\\det g(x_i)} \\cdot \\exp(-H_{\\text{eff}}(x_i, v_i)/T)\n3886: $$\n3887: \n3888: where $C$ is a normalization constant. The key point: the **geometric factor $\\sqrt{\\det g(x_i)}$ is already present** in the stationary density.\n3889: \n3890: **Part 4: Cloning Flux Computation with Geometric Factors**\n3891: \n3892: The **outgoing flux** from walker $i$ (rate at which walker $i$ is replaced by cloning):\n3893: \n3894: $$\n3895: \\Gamma_{\\text{out}}(i) = p_i(S) \\cdot \\rho_1(x_i, v_i) = p_i(S) \\cdot C \\cdot \\sqrt{\\det g(x_i)} \\cdot e^{-H_{\\text{eff}}(x_i, v_i)/T}\n3896: $$\n3897: \n3898: where $p_i(S) = \\mathbb{E}_{c \\sim P_{\\text{comp}}}[\\text{clip}(S_i(c)/p_{\\max})]$ is the total cloning probability for walker $i$.\n3899: \n3900: The **incoming flux** to position $x_i$ (rate at which other walkers clone to create a new walker near $x_i$):\n3901: \n3902: $$\n3903: \\begin{align}\n3904: \\Gamma_{\\text{in}}(i) &= \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot \\rho_1(x_j, v_j) \\cdot K_{\\text{clone}}(x_j \\to x_i) \\\\\n3905: &\\approx \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot \\rho_1(x_j, v_j)\n3906: \\end{align}\n3907: $$\n3908: \n3909: where the second line uses the **local cloning approximation**: $K_{\\text{clone}}(x_j \\to x_i) \\approx \\delta(x_i - x_j)$ in the continuum limit (see justification below).\n3910: \n3911: **Crucially**, $\\rho_1(x_j, v_j)$ includes the factor $\\sqrt{\\det g(x_j)}$ from Part 3:\n3912: \n3913: $$\n3914: \\Gamma_{\\text{in}}(i) \\approx \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot C \\cdot \\sqrt{\\det g(x_j)} \\cdot e^{-H_{\\text{eff}}(x_j, v_j)/T}\n3915: $$\n3916: \n3917: **Justification of local cloning**: The cloning kernel $K_{\\text{clone}}(x_j \\to x_i) \\propto \\exp(-\\|x_i - x_j\\|^2/2\\sigma_{\\text{clone}}^2)$ has width $\\sigma_{\\text{clone}}$ much smaller than the typical distance over which $g(x)$ varies. In the continuum limit $N \\to \\infty$ with inter-particle spacing $O(N^{-1/d})$, the kernel converges weakly to $\\delta(x_i - x_j)$, making cloning effectively local.\n3918: \n3919: **Part 5: Stationarity and Geometric Balance**\n3920: \n3921: At stationarity, $\\Gamma_{\\text{in}}(i) = \\Gamma_{\\text{out}}(i)$. Using the explicit forms from Part 4:\n3922: \n3923: $$\n3924: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot C \\cdot \\sqrt{\\det g(x_j)} \\cdot e^{-H_{\\text{eff}}(x_j, v_j)/T} = p_i(S) \\cdot C \\cdot \\sqrt{\\det g(x_i)} \\cdot e^{-H_{\\text{eff}}(x_i, v_i)/T}\n3925: $$\n3926: \n3927: **Velocity thermalization**: On the timescale of spatial cloning dynamics, velocities rapidly thermalize to the Maxwell-Boltzmann distribution (Lemma {prf:ref}`lem-velocity-marginalization` in Appendix A.2). Therefore, for walkers at the same position $x$, the velocity-dependent factors $e^{-H_{\\text{eff}}/T}$ average out, and we can write:\n3928: \n3929: $$\n3930: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot \\sqrt{\\det g(x_j)} = p_i(S) \\cdot \\sqrt{\\det g(x_i)}\n3931: $$\n3932: \n3933: **Mean-field approximation**: In the large-$N$ limit, walkers are distributed according to the spatial marginal $\\rho_{\\text{spatial}}(x) \\propto \\sqrt{\\det g(x)} \\exp(-U_{\\text{eff}}(x)/T)$. For a sum over $j$ weighted by $P_{\\text{comp}}(i|j; S)$ (which depends on the swarm distribution), the geometric factors at different positions satisfy:\n3934: \n3935: $$\n3936: \\frac{1}{|\\mathcal{A}|} \\sum_{j \\in \\mathcal{A}} \\sqrt{\\det g(x_j)} \\xrightarrow{N \\to \\infty} \\langle \\det g \\rangle := \\frac{1}{|\\mathcal{A}|} \\sum_{k \\in \\mathcal{A}} \\sqrt{\\det g(x_k)}\n3937: $$\n3938: \n3939: where the convergence holds by the law of large numbers applied to the spatial marginal.\n3940: \n3941: Dividing both sides of the flux balance by $\\sqrt{\\det g(x_i)}$ and using the mean-field approximation:\n3942: \n3943: $$\n3944: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot \\frac{\\sqrt{\\det g(x_j)}}{\\sqrt{\\det g(x_i)}} = p_i(S)\n3945: $$\n3946: \n3947: **Weighted average convergence**: Define the selection-weighted average:\n3948: \n3949: $$\n3950: \\langle f \\rangle_{i,S} := \\frac{\\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot f(x_j)}{\\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S)}\n3951: $$\n3952: \n3953: For sufficiently smooth functions $f$, standard mean-field theory (McKean-Vlasov propagation of chaos; see Sznitman *Topics in propagation of chaos*, 1991, §3) gives:\n3954: \n3955: $$\n3956: \\mathbb{E}_{X \\sim \\pi_{\\text{QSD}}}[\\langle f \\rangle_{i,S}] \\xrightarrow{N \\to \\infty} \\int_{\\mathcal{X}} f(x) \\rho_{\\text{spatial}}(x) \\, dx\n3957: $$\n3958: \n3959: with variance $\\text{Var}[\\langle f \\rangle_{i,S}] = O(1/N)$. Applying this with $f(x) = \\sqrt{\\det g(x)}$ and using concentration of measure, the weighted average converges to the spatial mean $\\langle \\det g \\rangle$ with high probability. Therefore:\n3960: \n3961: $$\n3962: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\cdot \\sqrt{\\det g(x_j)} \\approx \\left[\\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S)\\right] \\cdot \\langle \\det g \\rangle\n3963: $$\n3964: \n3965: which gives:\n3966: \n3967: $$\n3968: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) \\approx p_i(S) \\cdot \\frac{\\langle \\det g \\rangle}{\\sqrt{\\det g(x_i)}}\n3969: $$\n3970: \n3971: Rearranging gives the flux balance condition:\n3972: \n3973: $$\n3974: \\sum_{j \\neq i} P_{\\text{comp}}(i|j; S) \\cdot p_j(S) = p_i(S) \\cdot \\sqrt{\\frac{\\det g(x_i)}{\\langle \\det g \\rangle}}\n3975: $$\n3976: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 14,
        "chapter_file": "chapter_14.json",
        "section_id": "## 13. Companion Selection Flux Balance at Stationarity"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-27",
      "title": null,
      "start_line": 4010,
      "end_line": 4072,
      "header_lines": [],
      "content_start": 4011,
      "content_end": 4071,
      "content": "4011: \n4012: :::{prf:proof}\n4013: **Step 1: Stratonovich SDE Form**\n4014: \n4015: The Geometric Gas Langevin dynamics (Chapter 1.4, Definition {prf:ref}`def-d-kinetic-operator-adaptive`) is:\n4016: \n4017: $$\n4018: dx_i = v_i \\, dt, \\quad dv_i = \\mathbf{F}_{\\text{total}}(x_i, v_i) \\, dt + \\Sigma_{\\text{reg}}(x_i) \\circ dW_i - \\gamma v_i \\, dt\n4019: $$\n4020: \n4021: The $\\circ dW_i$ notation indicates **Stratonovich interpretation** of the stochastic integral.\n4022: \n4023: **Step 2: Stationary Distribution for Stratonovich Langevin**\n4024: \n4025: For a Stratonovich Langevin equation:\n4026: \n4027: $$\n4028: dX = b(X) \\, dt + \\sigma(X) \\circ dW\n4029: $$\n4030: \n4031: the stationary distribution satisfies the **Stratonovich Fokker-Planck equation** (Graham, 1977):\n4032: \n4033: $$\n4034: 0 = -\\nabla \\cdot (b \\rho) + \\frac{1}{2} \\nabla \\cdot \\nabla \\cdot (D \\rho)\n4035: $$\n4036: \n4037: where $D = \\sigma \\sigma^T$ is the diffusion tensor.\n4038: \n4039: By detailed balance, the stationary density is:\n4040: \n4041: $$\n4042: \\rho \\propto (\\det D)^{-1/2} \\exp\\left( -\\int_0^x b \\cdot dX / T \\right)\n4043: $$\n4044: \n4045: For our system with $b = -\\nabla U_{\\text{eff}}$ (after velocity marginalization):\n4046: \n4047: $$\n4048: \\rho \\propto (\\det D)^{-1/2} e^{-U_{\\text{eff}}/T} = \\sqrt{\\det g} \\, e^{-U_{\\text{eff}}/T}\n4049: $$\n4050: \n4051: **Step 3: Comparison with Itô Interpretation**\n4052: \n4053: If we incorrectly used **Itô calculus**, the stationary distribution would be:\n4054: \n4055: $$\n4056: \\rho_{\\text{Itô}} \\propto e^{-U_{\\text{eff}}/T}\n4057: $$\n4058: \n4059: **missing** the $\\sqrt{\\det g}$ factor.\n4060: \n4061: **Step 4: Velocity Marginalization**\n4062: \n4063: The full QSD on $(x, v)$ space factors (approximately, after fast velocity thermalization) as:\n4064: \n4065: $$\n4066: \\pi_{\\text{QSD}}(x, v) \\approx \\rho_{\\text{spatial}}(x) \\cdot \\rho_{\\text{Maxwell}}(v \\mid x)\n4067: $$\n4068: \n4069: where $\\rho_{\\text{Maxwell}}(v \\mid x)$ is the Maxwell-Boltzmann distribution at temperature $T = 1/\\gamma$.\n4070: \n4071: Integrating out velocities yields the spatial marginal stated in the theorem.",
      "metadata": {},
      "section": "## Appendix A: Supporting Theorems",
      "references": [
        "def-d-kinetic-operator-adaptive"
      ],
      "raw_directive": "4010: :::\n4011: \n4012: :::{prf:proof}\n4013: **Step 1: Stratonovich SDE Form**\n4014: \n4015: The Geometric Gas Langevin dynamics (Chapter 1.4, Definition {prf:ref}`def-d-kinetic-operator-adaptive`) is:\n4016: \n4017: $$\n4018: dx_i = v_i \\, dt, \\quad dv_i = \\mathbf{F}_{\\text{total}}(x_i, v_i) \\, dt + \\Sigma_{\\text{reg}}(x_i) \\circ dW_i - \\gamma v_i \\, dt\n4019: $$\n4020: \n4021: The $\\circ dW_i$ notation indicates **Stratonovich interpretation** of the stochastic integral.\n4022: \n4023: **Step 2: Stationary Distribution for Stratonovich Langevin**\n4024: \n4025: For a Stratonovich Langevin equation:\n4026: \n4027: $$\n4028: dX = b(X) \\, dt + \\sigma(X) \\circ dW\n4029: $$\n4030: \n4031: the stationary distribution satisfies the **Stratonovich Fokker-Planck equation** (Graham, 1977):\n4032: \n4033: $$\n4034: 0 = -\\nabla \\cdot (b \\rho) + \\frac{1}{2} \\nabla \\cdot \\nabla \\cdot (D \\rho)\n4035: $$\n4036: \n4037: where $D = \\sigma \\sigma^T$ is the diffusion tensor.\n4038: \n4039: By detailed balance, the stationary density is:\n4040: \n4041: $$\n4042: \\rho \\propto (\\det D)^{-1/2} \\exp\\left( -\\int_0^x b \\cdot dX / T \\right)\n4043: $$\n4044: \n4045: For our system with $b = -\\nabla U_{\\text{eff}}$ (after velocity marginalization):\n4046: \n4047: $$\n4048: \\rho \\propto (\\det D)^{-1/2} e^{-U_{\\text{eff}}/T} = \\sqrt{\\det g} \\, e^{-U_{\\text{eff}}/T}\n4049: $$\n4050: \n4051: **Step 3: Comparison with Itô Interpretation**\n4052: \n4053: If we incorrectly used **Itô calculus**, the stationary distribution would be:\n4054: \n4055: $$\n4056: \\rho_{\\text{Itô}} \\propto e^{-U_{\\text{eff}}/T}\n4057: $$\n4058: \n4059: **missing** the $\\sqrt{\\det g}$ factor.\n4060: \n4061: **Step 4: Velocity Marginalization**\n4062: \n4063: The full QSD on $(x, v)$ space factors (approximately, after fast velocity thermalization) as:\n4064: \n4065: $$\n4066: \\pi_{\\text{QSD}}(x, v) \\approx \\rho_{\\text{spatial}}(x) \\cdot \\rho_{\\text{Maxwell}}(v \\mid x)\n4067: $$\n4068: \n4069: where $\\rho_{\\text{Maxwell}}(v \\mid x)$ is the Maxwell-Boltzmann distribution at temperature $T = 1/\\gamma$.\n4070: \n4071: Integrating out velocities yields the spatial marginal stated in the theorem.\n4072: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix A: Supporting Theorems"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-123",
      "title": null,
      "start_line": 4106,
      "end_line": 4136,
      "header_lines": [],
      "content_start": 4107,
      "content_end": 4135,
      "content": "4107: \n4108: :::{prf:proof}\n4109: **Velocity Relaxation Rate**\n4110: \n4111: From the kinetic operator with friction coefficient $\\gamma$, velocities relax exponentially:\n4112: \n4113: $$\n4114: \\langle v(t) v(0) \\rangle \\sim e^{-\\gamma t}\n4115: $$\n4116: \n4117: Thus $\\tau_v = \\gamma^{-1}$.\n4118: \n4119: **Spatial Diffusion Time**\n4120: \n4121: The effective diffusion coefficient for positions is $D_{\\text{eff}} \\sim T/\\gamma = \\gamma^{-1} \\cdot T$. For a characteristic length scale $L$, the diffusion time is:\n4122: \n4123: $$\n4124: \\tau_x \\sim \\frac{L^2}{D_{\\text{eff}}} = \\frac{L^2 \\gamma}{T}\n4125: $$\n4126: \n4127: Taking $L = \\epsilon_c = \\sqrt{T/\\gamma}$, we get $\\tau_x \\sim \\gamma^{-1}$.\n4128: \n4129: **Separation Ratio**\n4130: \n4131: For typical parameters with $\\gamma \\gg T/L^2$, we have:\n4132: \n4133: $$\n4134: \\frac{\\tau_v}{\\tau_x} = \\frac{T}{\\gamma L^2} \\ll 1\n4135: $$",
      "metadata": {},
      "section": "## Appendix A: Supporting Theorems",
      "references": [],
      "raw_directive": "4106: :::\n4107: \n4108: :::{prf:proof}\n4109: **Velocity Relaxation Rate**\n4110: \n4111: From the kinetic operator with friction coefficient $\\gamma$, velocities relax exponentially:\n4112: \n4113: $$\n4114: \\langle v(t) v(0) \\rangle \\sim e^{-\\gamma t}\n4115: $$\n4116: \n4117: Thus $\\tau_v = \\gamma^{-1}$.\n4118: \n4119: **Spatial Diffusion Time**\n4120: \n4121: The effective diffusion coefficient for positions is $D_{\\text{eff}} \\sim T/\\gamma = \\gamma^{-1} \\cdot T$. For a characteristic length scale $L$, the diffusion time is:\n4122: \n4123: $$\n4124: \\tau_x \\sim \\frac{L^2}{D_{\\text{eff}}} = \\frac{L^2 \\gamma}{T}\n4125: $$\n4126: \n4127: Taking $L = \\epsilon_c = \\sqrt{T/\\gamma}$, we get $\\tau_x \\sim \\gamma^{-1}$.\n4128: \n4129: **Separation Ratio**\n4130: \n4131: For typical parameters with $\\gamma \\gg T/L^2$, we have:\n4132: \n4133: $$\n4134: \\frac{\\tau_v}{\\tau_x} = \\frac{T}{\\gamma L^2} \\ll 1\n4135: $$\n4136: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix A: Supporting Theorems"
      }
    },
    {
      "directive_type": "proof",
      "label": "unlabeled-proof-179",
      "title": null,
      "start_line": 4162,
      "end_line": 4172,
      "header_lines": [],
      "content_start": 4163,
      "content_end": 4171,
      "content": "4163: \n4164: :::{prf:proof}\n4165: The companion selection mechanism introduces a bias factor in the transition probabilities. In the large-$N$ limit, by saddle-point approximation, this bias function factorizes as:\n4166: \n4167: $$\n4168: g(X) = \\exp\\left( \\sum_{i=1}^N \\log \\sqrt{\\det g(x_i)} + O(1/\\sqrt{N}) \\right) = \\prod_{i=1}^N \\sqrt{\\det g(x_i)} \\cdot \\left(1 + O(1/\\sqrt{N})\\right)\n4169: $$\n4170: \n4171: Combining with the bare stationary distribution $\\propto \\prod_i e^{-\\beta H_{\\text{eff}}(x_i, v_i)}$ yields the stated Riemannian Gibbs form.",
      "metadata": {},
      "section": "## Appendix A: Supporting Theorems",
      "references": [],
      "raw_directive": "4162: :::\n4163: \n4164: :::{prf:proof}\n4165: The companion selection mechanism introduces a bias factor in the transition probabilities. In the large-$N$ limit, by saddle-point approximation, this bias function factorizes as:\n4166: \n4167: $$\n4168: g(X) = \\exp\\left( \\sum_{i=1}^N \\log \\sqrt{\\det g(x_i)} + O(1/\\sqrt{N}) \\right) = \\prod_{i=1}^N \\sqrt{\\det g(x_i)} \\cdot \\left(1 + O(1/\\sqrt{N})\\right)\n4169: $$\n4170: \n4171: Combining with the bare stationary distribution $\\propto \\prod_i e^{-\\beta H_{\\text{eff}}(x_i, v_i)}$ yields the stated Riemannian Gibbs form.\n4172: ",
      "_registry_context": {
        "stage": "directives",
        "document_id": "18_emergent_geometry",
        "chapter_index": 15,
        "chapter_file": "chapter_15.json",
        "section_id": "## Appendix A: Supporting Theorems"
      }
    }
  ]
}