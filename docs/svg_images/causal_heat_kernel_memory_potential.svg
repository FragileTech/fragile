<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 520" width="1000" height="520">
  <title>Causal Heat Kernel and Memory Potential</title>
  <desc>Diagram showing trajectory samples filtered by a causal heat kernel to produce the causal memory potential and force.</desc>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#334155" />
    </marker>
    <linearGradient id="blockBlue" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#EFF6FF;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#DBEAFE;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="blockSlate" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#F8FAFC;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E2E8F0;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="blockGreen" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ECFDF3;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#DCFCE7;stop-opacity:1" />
    </linearGradient>
  </defs>

  <rect width="1000" height="520" fill="#F8FAFC" />

  <text x="500" y="34" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="20" font-weight="600" fill="#0F172A" text-anchor="middle">Causal heat kernel and memory potential</text>
  <text x="500" y="56" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="13" fill="#64748B" text-anchor="middle">Spatial smoothing from H_tau is gated by the causal mask J^-</text>

  <!-- Trajectory box -->
  <rect x="60" y="150" width="220" height="220" rx="14" fill="url(#blockSlate)" stroke="#CBD5E1" />
  <text x="170" y="178" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="12" fill="#334155" text-anchor="middle">Trajectory gamma(t')</text>
  <line x1="95" y1="330" x2="95" y2="200" stroke="#94A3B8" stroke-width="2" marker-end="url(#arrowhead)" />
  <line x1="95" y1="330" x2="230" y2="330" stroke="#94A3B8" stroke-width="2" marker-end="url(#arrowhead)" />
  <text x="85" y="210" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="10" fill="#64748B">t</text>
  <text x="235" y="346" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="10" fill="#64748B">z</text>

  <path d="M110 310 C140 290, 160 250, 190 230 C210 215, 230 205, 245 195" fill="none" stroke="#2563EB" stroke-width="3" />
  <circle cx="125" cy="300" r="4" fill="#10B981" />
  <circle cx="150" cy="270" r="4" fill="#10B981" />
  <circle cx="175" cy="245" r="4" fill="#10B981" />
  <circle cx="205" cy="225" r="4" fill="#10B981" />
  <text x="110" y="210" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="10" fill="#059669">reward flux alpha(t')</text>

  <!-- Causal heat kernel -->
  <rect x="330" y="190" width="260" height="120" rx="14" fill="url(#blockGreen)" stroke="#86EFAC" />
  <text x="460" y="220" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="12" fill="#065F46" text-anchor="middle">Causal heat kernel</text>
  <text x="460" y="240" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="11" fill="#065F46" text-anchor="middle">H_tau(z,z') * M_causal</text>
  <text x="460" y="260" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="11" fill="#065F46" text-anchor="middle">(light cone J^-)</text>

  <!-- Potential and force -->
  <rect x="650" y="170" width="260" height="80" rx="14" fill="url(#blockBlue)" stroke="#93C5FD" />
  <text x="780" y="200" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="12" fill="#1E3A8A" text-anchor="middle">Psi_mem^causal(z,t)</text>
  <text x="780" y="220" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="11" fill="#1E3A8A" text-anchor="middle">Integral over J^-</text>

  <rect x="650" y="270" width="260" height="70" rx="14" fill="url(#blockSlate)" stroke="#CBD5E1" />
  <text x="780" y="300" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="12" fill="#334155" text-anchor="middle">Memory force</text>
  <text x="780" y="320" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="11" fill="#334155" text-anchor="middle">f_mem^causal = -G^-1 grad Psi</text>

  <!-- Arrows -->
  <line x1="280" y1="260" x2="330" y2="250" stroke="#334155" stroke-width="2" marker-end="url(#arrowhead)" />
  <line x1="590" y1="250" x2="650" y2="210" stroke="#334155" stroke-width="2" marker-end="url(#arrowhead)" />
  <line x1="780" y1="250" x2="780" y2="270" stroke="#334155" stroke-width="2" marker-end="url(#arrowhead)" />

  <!-- Integration note -->
  <rect x="330" y="330" width="260" height="45" rx="10" fill="#F1F5F9" stroke="#CBD5E1" />
  <text x="460" y="358" font-family="system-ui, -apple-system, Segoe UI, sans-serif" font-size="11" fill="#475569" text-anchor="middle">Integrate reward flux over causal past only</text>
</svg>
