<svg xmlns="http://www.w3.org/2000/svg" width="980" height="320" viewBox="0 0 980 320">
  <defs>
    <style>
      .title { font: 600 18px "IBM Plex Sans", Arial, sans-serif; fill: #1f2933; }
      .label { font: 600 12px "IBM Plex Sans", Arial, sans-serif; fill: #1f2933; }
      .small { font: 11px "IBM Plex Sans", Arial, sans-serif; fill: #334e68; }
      .center { text-anchor: middle; dominant-baseline: middle; }
      .box { fill: #ffffff; stroke: #cbd2d9; stroke-width: 1.2; }
      .head-b { fill: #e8f0fe; stroke: #2e86ab; stroke-width: 1.3; }
      .head-a { fill: #e8f4f2; stroke: #2a9d8f; stroke-width: 1.3; }
      .head-o { fill: #fff4e6; stroke: #f6ae2d; stroke-width: 1.3; stroke-dasharray: 6 3; }
      .bank { fill: #f5f7fa; stroke: #1f2933; stroke-width: 1.1; }
      .note { fill: #ffffff; stroke: #cbd2d9; stroke-width: 1.1; }
      .arrow { stroke: #1f2933; stroke-width: 1.3; fill: none; marker-end: url(#arrow); }
    </style>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#1f2933" />
    </marker>
  </defs>

  <text x="32" y="34" class="title">GeodesicCrossAttention: BAOAB Attention Block</text>

  <rect x="20" y="140" width="120" height="70" rx="10" class="box" />
  <text x="80" y="162" class="label center">State</text>
  <text x="80" y="178" class="small center">(z_t, p_t)</text>

  <rect x="160" y="140" width="120" height="70" rx="10" class="head-b" />
  <text x="220" y="158" class="label center">B head 1</text>
  <text x="220" y="174" class="small center">kick</text>
  <text x="220" y="190" class="small center">delta p</text>

  <rect x="300" y="140" width="120" height="70" rx="10" class="head-a" />
  <text x="360" y="158" class="label center">A head 1</text>
  <text x="360" y="174" class="small center">drift</text>
  <text x="360" y="190" class="small center">delta z</text>

  <rect x="440" y="140" width="120" height="70" rx="10" class="head-o" />
  <text x="500" y="156" class="label center">O step</text>
  <text x="500" y="172" class="small center">OU (closed form)</text>
  <text x="500" y="188" class="small center">optional learned head</text>

  <rect x="580" y="140" width="120" height="70" rx="10" class="head-a" />
  <text x="640" y="158" class="label center">A head 2</text>
  <text x="640" y="174" class="small center">drift</text>
  <text x="640" y="190" class="small center">delta z</text>

  <rect x="720" y="140" width="120" height="70" rx="10" class="head-b" />
  <text x="780" y="158" class="label center">B head 2</text>
  <text x="780" y="174" class="small center">kick</text>
  <text x="780" y="190" class="small center">delta p</text>

  <rect x="860" y="140" width="120" height="70" rx="10" class="box" />
  <text x="920" y="162" class="label center">State</text>
  <text x="920" y="178" class="small center">(z_{t+1}, p_{t+1})</text>

  <rect x="160" y="70" width="120" height="40" rx="8" class="bank" />
  <text x="220" y="92" class="small center">Gradient bank</text>

  <rect x="300" y="70" width="120" height="40" rx="8" class="bank" />
  <text x="360" y="92" class="small center">Transport bank</text>

  <rect x="440" y="70" width="120" height="40" rx="8" class="bank" />
  <text x="500" y="92" class="small center">Noise bank</text>

  <rect x="580" y="70" width="120" height="40" rx="8" class="bank" />
  <text x="640" y="92" class="small center">Transport bank</text>

  <rect x="720" y="70" width="120" height="40" rx="8" class="bank" />
  <text x="780" y="92" class="small center">Gradient bank</text>

  <rect x="120" y="235" width="740" height="50" rx="10" class="note" />
  <text x="490" y="258" class="small center">Each head uses CovariantAttention: Wilson lines + tau(z) + geometric Q</text>

  <line x1="140" y1="175" x2="160" y2="175" class="arrow" />
  <line x1="280" y1="175" x2="300" y2="175" class="arrow" />
  <line x1="420" y1="175" x2="440" y2="175" class="arrow" />
  <line x1="560" y1="175" x2="580" y2="175" class="arrow" />
  <line x1="700" y1="175" x2="720" y2="175" class="arrow" />
  <line x1="840" y1="175" x2="860" y2="175" class="arrow" />

  <line x1="220" y1="110" x2="220" y2="140" class="arrow" />
  <line x1="360" y1="110" x2="360" y2="140" class="arrow" />
  <line x1="500" y1="110" x2="500" y2="140" class="arrow" />
  <line x1="640" y1="110" x2="640" y2="140" class="arrow" />
  <line x1="780" y1="110" x2="780" y2="140" class="arrow" />
</svg>
